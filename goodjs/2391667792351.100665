!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("wafer-image",[],t):"object"==typeof exports?exports["wafer-image"]=t():(e.wafer=e.wafer||{},e.wafer.wafers=e.wafer.wafers||{},e.wafer.wafers["wafer-image"]=t())}("undefined"!=typeof self?self:this,function(){return r={"./src/controller.js":function(e,t,r){"use strict";function m(e,t,r){r&&e.setAttribute("srcset",r),e.src=t}function i(e,t,r){var o=e.getAttribute(r);o&&(e.setAttribute(t,o),e.removeAttribute(r))}Object.defineProperty(t,"__esModule",{value:!0});function a(e,t,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);return void 0!==o?"value"in o?o.value:void 0!==(o=o.get)?o.call(r):void 0:null===(e=Object.getPrototypeOf(e))?void 0:a(e,t,r)}var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},o=function(e,t,r){return t&&g(e.prototype,t),r&&g(e,r),e},s=window.wafer,c=s.constants,s=s.utils,y=s.bindEvent,l=s.convertNodeListToArray,u=s.each,f=s.isNodeName,v=s.unbindEvent,p=c.ATTR_PREFIX,c=window.wafer.controllers.WaferLazyController,b=window.wafer.base,o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,c),o(d,[{key:"nativeLazyLoadElement",value:function(e){var t,r,o,a,s=this._getImageMetaWithType(e),n=s.type;n&&(t=(a=this._options).src,r=a.srcset,o=a.nativeClass,a=a.selector,e.setAttribute("loading","lazy"),e.classList.remove(a.replace(".","")),e.classList.add(o),e.removeAttribute(t),e.removeAttribute(r),"picture"===n&&u(l(e.parentNode.getElementsByTagName("source")),function(e){i(e,"srcset",r)}),this._addEventsToElement(e,e,"native",s))}},{key:"loadElement",value:function(e){var t,r,o,a;!this._shouldLoadElement(e)||(r=(t=this._getImageMetaWithType(e)).type)&&(o=this._options.srcset,a=new Image,"picture"===r&&u(l((a=e).parentNode.getElementsByTagName("source")),function(e){i(e,"srcset",o)}),this._addEventsToElement(e,a,"default",t))}},{key:"_itemLoaded",value:function(e){a(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"_itemLoaded",this).call(this,e);var t=this._options.srcset;e.removeAttribute(t)}},{key:"_addEventsToElement",value:function(r,o,e,t){function a(){"native"!==e?("image"===l||"picture"===l?m(r,n,i):r.style.backgroundImage='url("'+n+'")',s._itemLoaded(r)):r.classList.add(p),v(o,"error",d),v(o,"load",a)}var s=this,n=t.elemSrc,i=t.elemSrcset,c=t.fallbackSrc,l=t.type,t=this._options,u=t.error,f=t.errorClass,p=t.successClass,d=function e(){u&&u(r,"invalid");var t=r.getAttribute("data-wf-add-error-to-parent");(t=Number(t)||0)&&r.parentNode.classList.add(f),c&&(r.classList.add("wafer-img-fallback"),r.src=c),b.emitError({elem:r,meta:{src:n,srcset:i},name:"WaferImage",stack:{}}),v(o,"error",e),v(o,"load",a)};y(o,"error",d),y(o,"load",a),m(o,n,i)}},{key:"_getImageMetaWithType",value:function(e){var t=this._options,r=t.isRetina,o=t.separator,a=t.src,s=t.srcset,n=e.getAttribute(a),t=e.getAttribute(p+"fallback-src");if(n){a=n.split(o),n=a[r&&1<a.length?1:0],o=e.getAttribute(s),r=e.tagName.toLowerCase(),a="img"===r,s=e.parentNode,s=s&&f(s,"picture");if(a||void 0===e.src)return s?{elemSrc:n,elemSrcset:o,fallbackSrc:t,type:"picture"}:{elemSrc:n,elemSrcset:o,fallbackSrc:t,type:a?"image":r}}return{}}}]),d);function d(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).root,t=void 0===e?document:e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d);var r=d.prototype.configs,o=r.nativeClass,a=r.selector,s=r.separator,e=r.srcset,r=r.successClass,r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,{root:t,selector:a,successClass:r}));return r._options=n({},r._options,{defaultOffsetX:0,defaultOffsetY:500,nativeClass:o,separator:s,srcset:e}),r.sync(),r}function g(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}o.prototype.configs={selector:".wafer-img",separator:"|",srcset:"data-wf-srcset",nativeClass:"wafer-img-native",successClass:"wafer-img-loaded",allowPrefetch:!0},t.default=o,e.exports=t.default},"./src/entry.js":function(e,t,r){"use strict";function o(){return e=r("./src/controller.js"),a=e&&e.__esModule?e:{default:e};var e}var a;Object.defineProperty(t,"__esModule",{value:!0}),t.default=new(a||o()).default({selector:(a||o()).default.prototype.configs.selector}),e.exports=t.default}},a={},o.m=r,o.c=a,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="https://s.yimg.com/aaq/wf/",o(o.s="./src/entry.js");function o(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}var r,a});
