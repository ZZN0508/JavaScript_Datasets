var Modulr=function(t,n){return t.Modulr||n}(window,function(){function s(t,n){return"function"==typeof t?t.apply(t,n):t}function d(t){var n=t.split("."),e=window[n.shift()],o=!1;if(void 0!==e&&(o=!0,0<n.length))for(;0<n.length;)if(void 0===(e=e[n.shift()])){o=!1;break}return o}function e(){var t=window.location.pathname.split("/");return t.pop(),t=t.join("/")+"/",o()+t}function o(){var t=window.location;return t.protocol+"//"+(t.host||t.hostname)}function i(t,n){return[t=P(t),n=P(S(n))].join("/")}function p(t){var n=t,e=window.location.protocol;return n=0!==t.indexOf("http")?e+(0!==t.indexOf("//")?"//":"")+t:n}function j(t){for(var n=[],e=0;e<t.length;e++)n.push(t[e]);return n}function k(t,n,e,o){t.detachEvent&&!Y?o&&t.detachEvent(o,n):t.removeEventListener(e,n,!1)}function S(t){return"/"===t.charAt(0)?t.slice(1):t}function P(t){return"/"===t.charAt(t.length-1)?t.slice(0,t.length-1):t}function h(t){return t=t||!1,"[object Array]"===Object.prototype.toString.call(t)}function A(){var n=Array.prototype.slice.call(arguments);n.unshift(r);try{return window.console.log.apply(window.console,n)}catch(t){window.console.log(n.join(" | "))}}function C(){var t=Array.prototype.slice.call(arguments);throw t.unshift(r),new Error(t.join(" "))}function O(t){var e=[],o=null;this.then=this.resolve=function(t){return"function"==typeof t&&e.push(t),this},this.reject=function(t){"function"==typeof t&&(o=t)},t(function(){if(e)for(var t=Array.prototype.slice.call(arguments);0<e.length;){var n=e.shift();data=n.apply(n,t)}},function(t){var n;o&&(n=Array.prototype.slice.call(arguments),o.apply(o,n))})}function L(){function t(){for(U=!0;0<z.length;)z.shift()()}W?W(t):t()}var t,n,q={},Q={},_={},D={},F={},I={},N={},G=[],T=[],R={},U=!1,z=[],W=null,B=null,H=[],r="[Modulr]";t=function(){U||L()},window.addEventListener?window.addEventListener("load",t,!1):window.attachEvent?window.attachEvent("onload",t):(n=window.onload,window.onload=function(){n(),t()});function X(g){function a(t){g.baseDomain=p(g.baseDomain)||o(),g.baseUrl=g.baseUrl||e();!function(t){{var n;g.masterFile?(n=c(g.masterFile),!(-1<T.indexOf(n))&&-1===G.indexOf(n)?(G.push(n),w(n,null,function(){T.push(n),t()})):t()):t()}}(function(){r(g.packages,function(){t()})})}function v(t){if(g.paths)for(var n in g.paths)t=t.replace(n,g.paths[n]);return t.replace(/\/\//g,"/").replace(/^\//,"")}function y(t){return E[t]||!1}function x(t){var n,e=!1;return-1<t.indexOf(":")&&(t=(n=t.split(":"))[0]||!1,n=n[1]||!1,"getInstance"===t&&n?e={type:"instance",context:n}:t&&n&&(e={type:"module",context:t,id:n})),e}function r(t,o){if(t){function n(t){for(var n in t)N[n]||(N[n]=t[n]),i.push({uid:n,src:t[n]})}var i=[];if(h(t))for(var e=0;e<t.length;e++){var r=t[e];"string"==typeof r&&N[r]?i.push({uid:r,src:N[r]}):"object"!=typeof r||h(r)?C("cannot find package named:",r):n(r)}else n(t);function a(){var t,n,e;0===i.length?o():(n=(t=i.shift()).uid,e=c(t.src),q[n]?a():F[e]?(I[e]||(I[e]=[]),I[e].push(function(){a()})):(F[e]=n,w(e,n,function(){a(),I[e]&&function(t){for(var n=I[t];0<n.length;)n.shift()();delete I[t]}(e)},"instance")))}a()}else o()}function c(t){var n=t;return n=0!==t.indexOf("http")?0===t.indexOf("//")?p(t):g.baseDomain+("/"!==t.charAt(0)?"/":"")+t:n}function m(t){return!(!g.shim||!g.shim[t])}function u(t){return window[t.split(".")[0]]}function w(t,n,e,o,i){i=i||{};var r,a=!1,c=document.createElement("script"),u=[b||"",t].join("||"),f=i.noCacheString||null,l=function(t){for(var n=H,e=null,o=0;o<n.length;o++){var i=n[o];if("object"==typeof i&&i.regex instanceof RegExp&&i.regex.test(t)){e=i;break}}return e}(t),s=!(!l||!0!==l.noStore)||(!0===f?null:i.noStore),d=l&&"string"==typeof l.param?l.param:i.queryParam,p=function(t){if(!a&&"load"===t.type||Z.test((t.currentTarget||t.srcElement).readyState)){for(a=!0;0<D[u].length;)D[u].shift()();delete D[u],k(c,p,"load","onreadystatechange"),k(c,h,"error")}},h=function(){C("error loading script:",t)};return n&&c.setAttribute(o?"data-modulr-loaded-inst":"data-modulr-module",n),c.setAttribute("data-modulr-context",b),_[u]?(D[u].push(function(){e(n)}),0):(_[u]=!0,D[u]=[function(){e(n)}],c.type="text/javascript",c.charset="utf-8",c.async=!0,!c.attachEvent||c.attachEvent.toString&&c.attachEvent.toString().indexOf("[native code")<0||Y?(c.addEventListener("load",p,!1),c.addEventListener("error",h,!1)):c.attachEvent("onreadystatechange",p),c.src=(o=i=t,l&&s&&d?o=i+(-1<i.indexOf("?")?"&":"?")+(d?d+"=":"")+(new Date).getTime():(g&&g.cacheParam||B)&&!f&&(d=d||("string"==typeof g.cacheParam?g.cacheParam:B?"v":""),r=s?(new Date).getTime():B||(r=(s=new Date).getSeconds(),[s.getFullYear(),s.getMonth()+1,s.getDate(),s.getHours(),s.getMinutes()].join("")+(r<=30?30:1)),o=i+(-1<i.indexOf("?")?"&":"?")+(d?d+"=":"")+r),o),void document.getElementsByTagName("head")[0].appendChild(c))}(g=g||{}).context=g.instance||g.context||"_",g.wait="boolean"!=typeof g.wait||g.wait;var t,n,b=g.context;if(n=/[^A-Za-z0-9_\-\.]/g.test(t=b),"string"==typeof t&&!n||C("invalid context:",b),q[b])return A("WARNING: attempt to instantiate the same context:",b,"\n. No configuration changes, returning instance instead.."),q[b].instance;q[b]={instance:this,stack:{}};var E=q[b].stack,f=!1,M=this;M.version="2.0.1",M.getConfig=function(){return g},M.getInstance=function(t){return q[t]?q[t].instance:null},M.setExecuteListener=function(t){W||"function"!=typeof t||(W=t)},M.getLoadedScripts=function(){var t,n={};for(t in _){var e=t.split("||"),o=e[0],e=e[1]||"";o&&e&&(n[o]||(n[o]=[]),n[o].push(e))}return n},M.define=function(t,n,e){0<(o="string"==typeof(o=t)?o.replace(/\s+/gi,""):"").length&&"require"!==o&&"define"!==o&&"exports"!==o||C("invalid id:",t),2!==arguments.length||h(n)||(e=n,n=[]);var o=x(t=v(t));o?q[o.context]?q[o.context].instance.define(o.id,n,e):(Q[o.context]||(Q[o.context]=[]),Q[o.context].push({ext:o,deps:n,factory:e})):E[t]||(E[t]={executed:!1,exports:{},deps:n=n||[],factory:e})},M.require=function(o,i){return"string"==typeof o?(n=null,e="module",(r=x(t=v(t=o)))?"module"===r.type?n=q[r.context].stack[r.id]:"instance"===r.type&&(n=q[r.context].instance,e="instance"):n=E[t],"module"===e&&(n&&!n.executed&&C("module not yet executed:",t),n=n?void 0!==n.factory?n.factory:n.exports:null),n):h(o)?new O(function(n){function t(){f?e():(f=!0,a(function(){e()}))}var e=function(){l.get(null,o,function(t){"function"==typeof i?s(i,t):n.apply(n,t)})};!g.wait||U?t():z.push(t)}):void 0;var t,n,e,r},M.config=function(t){if(t.context||t.instance){for(var n=new X(t),e=["config","getInstance","loadPackageList","setGlobalCacheParam","setGlobalCacheCond","setExecuteListener"],o=0;o<e.length;o++){var i=e[o];n[i]&&delete n[i]}return n.loadPackage=function(t,n){"function"!=typeof n&&C("loadPackage() requires a callback!"),h(t)||"object"!=typeof t?C("cannot load package list."):r(t,n.apply(n,M.require))},n}return f?(A('WARNING: Instance "'+t.instance+'" already exists! no configuration changes, returning instance instead..'),M.getInstance(t.instance)):void(g=t)},M.execModule=function(t,n){var e=y(t);return"function"==typeof n&&void(e?e.executed?n(l.getModuleFactory(e)):l.execModule(null,null,t,function(t){n(t)}):n(null))},M.loadPackageList=function(t){if(h(t)||"object"!=typeof t)C("cannot load package list.");else for(var n in t)N[n]||(N[n]=t[n])},M.setGlobalCacheParam=function(t){"string"!=typeof t&&"number"!=typeof t||(B=t)},M.setGlobalCacheCond=function(t){Array.isArray(t)&&(H=H.concat(t))},M.getGlobalCacheParam=function(){return B},M.getPackageListInfo=function(){return{master:G,instances:N}},M.setReady=function(){L()},M.loadScript=function(t,n){w(t,null,function(){"function"==typeof n&&n()})},function(){if(Q[b])for(var t=q[b].instance;0<Q[b].length;){var n=Q[b].shift();t.define(n.ext.id,n.deps,n.factory)}}(),function(){if(g.shim){var t,n=[];for(t in g.shim)n.push({id:t,info:g.shim[t]});for(;0<n.length;)!function(t){var n=t.id,e=t.info,t=(c(e.src),e.deps||[]);M.define(n,t,function(){return u(e.exports)})}(n.shift())}}();var l=new function(){var h=this;h.get=function(f,t,l){var s,d=[];t?s=j(t):f&&E[f]&&(s=j(E[f].deps));var p=function(){var t,n,e,o,i,r,a,c,u;0===s.length?l(d):(n=y(t=v(s.shift())),(o=x(t))?"module"===o.type?(r=function(t){d.push(void 0!==t?t:null),p()},i=(c=(i=t).split(":"))[0]||!1,u=c[1]||!1,i&&u&&q[i]?(a=q[i].instance,q[i].stack[u]?a.execModule(u,function(t){r(t)}):a.require([u],function(){a.execModule(u,function(t){r(t)})})):(A(["Not initialized >> CONTEXT:",i,"| module:",u].join(" ")),r(null))):"instance"===o.type&&(d.push((o=o.context,q[o]?q[o].instance:void C("Error getting instance:",o))),p()):"require"===t?(d.push(M.require),p()):"define"===t?(d.push(M.define),p()):"exports"===t?(d.push(E[f].exports),p()):n&&!m(t)?n.executed?(d.push(h.getModuleFactory(n)),p()):h.execModule(null,null,t,function(t){d.push(t),p()}):m(t)?(n=g.shim[t],h.loadShim(t,n,function(t){d.push(t),p()})):w(e=h.getModulePath(t),t,function(){h.execModule("load",e,t,function(t){d.push(t),p()})}))};p()},h.loadShim=function(t,n,e){var o=c(n.src),i=y(t);d(n.exports)?(i.executed=!0,i.factory=u(n.exports),e(i.factory)):R[o]?R[o].push(function(){h.execModule("shim",null,t,function(t){e(t)})}):(R[o]=[function(){h.execModule("shim",null,t,function(t){e(t)})}],w(o,t,function(){d(n.exports)?function(t){if(R[t])for(;0<R[t].length;)R[t].shift()()}(o):C("shim export not found for:",t)},null,{noCacheString:n.noCacheString||null,noStore:n.noStore||null,queryParam:n.queryParam||null}))},h.execModule=function(t,n,e,o){var i=y(e);i?i.executed?o(h.getModuleFactory(i)):(h._execQueue||(h._execQueue={}),h._execQueue[e]||(h._execQueue[e]=[]),i.executing?h._execQueue[e].push(o):(i.executing=!0,h._execQueue[e].push(o),h.get(e,i.deps,function(t){i.factory=s(i.factory,t),i.executed=!0,i.executing=!1,h.runCallbackQueue(e,h.getModuleFactory(i))}))):(A("loading external source:",n),o({id:e,src:n,type:"external-script"}))},h.runCallbackQueue=function(t,n){for(var e=h._execQueue[t]||[];0<e.length;)e.shift()(n)},h.getModuleFactory=function(t){return null!==t.factory?t.factory:t.exports},h.getModulePath=function(t){return i([P(g.baseDomain||o()),S(g.baseUrl||e())].join("/"),t)+".js"}}}var Y="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),Z=/^(complete|loaded)$/;return new X}());
