!function(e,t){var s,n;"function"==typeof t&&(s=/iPad|(?!Android.*Mobile)Android/.test(e.navigator.userAgent),(n=function(e){this.$menu=t(e),this.itemSelector=this.$menu.attr("data-item")||this.defaults.selectors.item,this.submenuSelector=this.$menu.attr("data-submenu")||this.defaults.selectors.submenu,this.submenuDirection=this.$menu.attr("data-submenuDirection")||this.defaults.submenuDirection,this.activeMenuClassName=this.$menu.attr("data-activeMenuClassName")||this.defaults.activeMenuClassName,this.$submenus=this.$items=this.$window=void 0,this.degreesBegin="right"===this.submenuDirection?-80:0,this.currentY=this.currentX=this.prevY=this.prevX=0,this.menuIsLocked=this.cursorIsOnMenu=!1,this.currentIndex=-1}).prototype={defaults:{selectors:{item:".category-menu__item",submenu:".category-menu__sub-menu"},activeMenuClassName:"is-active",submenuDirection:"right-bottom"},getElements:function(){this.$items=this.$menu.find(this.itemSelector),this.$submenus=this.$items.find(this.submenuSelector),s?this.bindTouchEvent():this.bindMouseEvents()},bindMouseEvents:function(){var s=this;this.$menu.bind("mouseenter.menu",function(){var e,t;s.cursorIsOnMenu||(s.cursorIsOnMenu=!0,s.prevX=s.currentX,s.prevY=s.currentY,s.menuMouseEnterID=setInterval(function(){e=s.currentX-s.prevX,t=s.currentY-s.prevY,Math.abs(e)+Math.abs(t)<3||s.checkDirection(s.degreesBegin,60,e,t)?s.menuIsLocked=!0:s.menuIsLocked=!1,s.prevX=s.currentX,s.prevY=s.currentY},20))}).bind("mouseleave.menu",function(){s.cursorIsOnMenu=!1,s.menuIsLocked=!1,clearInterval(s.menuMouseEnterID),s.hideSubMenu()}).bind("mousemove.menu",function(e){s.currentX=e.pageX,s.currentY=e.pageY}),this.$items.each(function(e){s.$items.eq(e).bind("mousemove.item",function(){s.menuIsLocked||s.showSubMenu(e)})})},bindTouchEvent:function(){var n=this;this.$items.each(function(e){var t=n.$items.eq(e),s=n.$submenus.eq(e);t.bind("click",function(){s.is(":visible")?(n.$items.removeClass(n.activeMenuClassName),n.$submenus.hide()):(n.$items.removeClass(n.activeMenuClassName),t.addClass(n.activeMenuClassName),n.$submenus.hide(),s.show())})}),t("body").bind("touchstart",function(){n.$items.removeClass(n.activeMenuClassName),n.$submenus.hide()}),this.$menu.bind("touchstart",function(e){e.stopPropagation()})},checkDirection:function(e,t,s,n){return e<=(s=180*Math.atan2(n,s)/Math.PI)&&s<=t},showSubMenu:function(e){this.currentIndex!==e&&(this.currentIndex=e,this.$items.removeClass(this.activeMenuClassName).eq(e).addClass(this.activeMenuClassName),this.$submenus.hide().eq(e).show(),this.menuIsLocked=!0)},hideSubMenu:function(){this.$items.removeClass(this.activeMenuClassName),this.$submenus.hide(),this.currentIndex=-1}},t(".RJSCategoryMenu, .js-category-menu").each(function(e,t){new n(t).getElements()}))}(window,window.jQuery);
