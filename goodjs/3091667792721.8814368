YUI.add("attribute-core",function(_,t){function i(t,i,e){this._yuievt=null,this._initAttrHost(t,i,e)}_.State=function(){this.data={}},_.State.prototype={add:function(t,i,e){(this.data[t]||(this.data[t]={}))[i]=e},addAll:function(t,i){var e,a=(a=this.data[t])||(this.data[t]={});for(e in i)i.hasOwnProperty(e)&&(a[e]=i[e])},remove:function(t,i){t=this.data[t];t&&delete t[i]},removeAll:function(e,t){t?_.each(t,function(t,i){this.remove(e,"string"==typeof i?i:t)},this):(t=this.data,e in t&&delete t[e])},get:function(t,i){t=this.data[t];if(t)return t[i]},getAll:function(t,i){var e,a,s=this.data[t];if(i)a=s;else if(s)for(e in a={},s)s.hasOwnProperty(e)&&(a[e]=s[e]);return a}};var f=_.Object,c=_.Lang,A=".",l="value",h="lazyAdd",d="added",a="_bypassProxy",g="initValue",s="lazy",v=i.INVALID_VALUE={};i._ATTR_CFG=["setter","getter","validator",l,"valueFn","writeOnce","readOnly",h,a],i.protectAttrs=function(t){if(t)for(var i in t=_.merge(t))t.hasOwnProperty(i)&&(t[i]=_.merge(t[i]));return t},i.prototype={_initAttrHost:function(t,i,e){this._state=new _.State,this._initAttrs(t,i,e)},addAttr:function(t,i,e){var a,s,r=this._state,n=r.data;return h in(i=i||{})&&(e=i[h]),s=r.get(t,d),e&&!s?r.data[t]={lazy:i,added:!0}:s&&!i.isLazyAdd||((s=l in i)&&(a=i.value,i.value=void 0),i.added=!0,i.initializing=!0,n[t]=i,s&&this.set(t,a),i.initializing=!1),this},attrAdded:function(t){return!!this._state.get(t,d)},get:function(t){return this._getAttr(t)},_isLazyAttr:function(t){return this._state.get(t,s)},_addLazyAttr:function(t,i){var e=this._state;(i=i||e.get(t,s))&&(e.data[t].lazy=void 0,i.isLazyAdd=!0,this.addAttr(t,i))},set:function(t,i,e){return this._setAttr(t,i,e)},_set:function(t,i,e){return this._setAttr(t,i,e,!0)},_setAttr:function(t,i,e,a){var s,r,n,l,h=!0,d=this._state,o=this._stateProxy,u=this._tCfgs;return-1!==t.indexOf(A)&&(t=(n=(r=t).split(A)).shift()),u&&u[t]&&this._addOutOfOrder(t,u[t]),(s=d.data[t]||{}).lazy&&(s=s.lazy,this._addLazyAttr(t,s)),u=void 0===s.value,o&&t in o&&!s._bypassProxy&&(u=!1),d=s.writeOnce,o=s.initializing,u||a||(d&&(h=!1),s.readOnly&&(h=!1)),(h=!o&&!a&&"initOnly"===d?!1:h)&&(u||(l=this.get(t)),n&&(void 0===(i=f.setValue(_.clone(l),n,i))&&(h=!1)),h&&(!this._fireAttrChange||o?this._setAttrVal(t,r,l,i,e,s):this._fireAttrChange(t,r,l,i,e,s))),this},_addOutOfOrder:function(t,i){var e={};e[t]=i,delete this._tCfgs[t],this._addAttrs(e,this._tVals)},_getAttr:function(t){var i,e=t,a=this._tCfgs;return-1!==t.indexOf(A)&&(t=(i=t.split(A)).shift()),a&&a[t]&&this._addOutOfOrder(t,a[t]),(a=this._state.data[t]||{}).lazy&&(a=a.lazy,this._addLazyAttr(t,a)),t=this._getStateVal(t,a),t=(a=(a=a.getter)&&!a.call?this[a]:a)?a.call(this,t,e):t,t=i?f.getValue(t,i):t},_getStateVal:function(t,i){var e=this._stateProxy;return i=i||(this._state.getAll(t)||{}),e&&t in e&&!i._bypassProxy?e[t]:i.value},_setStateVal:function(t,i){var e=this._stateProxy;e&&t in e&&!this._state.get(t,a)?e[t]=i:this._state.add(t,l,i)},_setAttrVal:function(t,i,e,a,s,r){var n,l=!0,h=r||this._state.data[t]||{},d=h.validator,o=h.setter,u=h.initializing,_=this._getStateVal(t,h),r=i||t;return d&&((d=!d.call?this[d]:d)&&(!(n=d.call(this,a,r,s))&&u&&(a=h.defaultValue,n=!0))),!d||n?(o&&((o=!o.call?this[o]:o)&&((s=o.call(this,a,r,s))===v?u?a=h.defaultValue:l=!1:void 0!==s&&(a=s))),l&&(i||a!==_||c.isObject(a)?(g in h||(h.initValue=a),this._setStateVal(t,a)):l=!1)):l=!1,l},setAttrs:function(t,i){return this._setAttrs(t,i)},_setAttrs:function(t,i){for(var e in t)t.hasOwnProperty(e)&&this.set(e,t[e],i);return this},getAttrs:function(t){return this._getAttrs(t)},_getAttrs:function(t){for(var i,e={},a=!0===t,s=0,r=(t=!t||a?f.keys(this._state.data):t).length;s<r;s++)i=t[s],a&&this._getStateVal(i)==this._state.get(i,g)||(e[i]=this.get(i));return e},addAttrs:function(t,i,e){return t&&(this._tCfgs=t,this._tVals=i?this._normAttrVals(i):null,this._addAttrs(t,this._tVals,e),this._tCfgs=this._tVals=null),this},_addAttrs:function(t,i,e){var a,s,r,n=this._tCfgs,l=this._tVals;for(a in t)t.hasOwnProperty(a)&&(s=t[a],s.defaultValue=s.value,r=this._getAttrInitVal(a,s,l),void 0!==r&&(s.value=r),n[a]&&(n[a]=void 0),this.addAttr(a,s,e))},_protectAttrs:i.protectAttrs,_normAttrVals:function(t){var i,e,a,s,r;if(!t)return null;for(r in i={},t)t.hasOwnProperty(r)&&(-1!==r.indexOf(A)?(a=r.split(A),s=a.shift(),e=e||{},s=e[s]=e[s]||[],s[s.length]={path:a,value:t[r]}):i[r]=t[r]);return{simple:i,complex:e}},_getAttrInitVal:function(t,i,e){var a,s,r,n,l,h,d=i.value,o=i.valueFn,u=!1,_=i.readOnly;if(!_&&e&&((i=e.simple)&&i.hasOwnProperty(t)&&(d=i[t],u=!0)),o&&!u&&((o=!o.call?this[o]:o)&&(d=o.call(this,t))),!_&&e&&(a=e.complex)&&a.hasOwnProperty(t)&&null!=d)for(s=0,r=(h=a[t]).length;s<r;++s)n=h[s].path,l=h[s].value,f.setValue(d,n,l);return d},_initAttrs:function(t,i,e){t=t||this.constructor.ATTRS;var a=_.Base,s=_.BaseCore,a=a&&_.instanceOf(this,a),s=!a&&s&&_.instanceOf(this,s);!t||a||s||this.addAttrs(_.AttributeCore.protectAttrs(t),i,e)}},_.AttributeCore=i},"3.12.0",{requires:["oop"]});
