!function(){var e=function(t){var i;return function(e){return i||t(i={exports:{},parent:e},i.exports),i.exports}},l=e(function(e,t){"use strict";var o=i(u),r=i(a({})),d=i(n({}));function i(e){return e&&e.__esModule?e:{default:e}}t.initialise=function(){window.addEventListener("message",function(e){if(!o.default.isInternal()&&e.origin.match(/eip\.telegraph\.co\.uk/)&&c(e.data)){var t="string"==typeof e.data?JSON.parse(e.data):e.data;if(t.id&&t.index){o.default.info("Telegraph has received a new message from particle",t);var i=document.querySelector("[particle-id='"+t.id+"'],[particle-index='"+t.index+"']"),n="generic";switch(document.querySelectorAll("meta[name='tmgads.businessSegment']")[0]&&(n=document.querySelectorAll("meta[name='tmgads.businessSegment']")[0].content),t.type){case"ready":o.default.info(t.id+" ("+t.index+") - Ready"),i.style.display="block";break;case"resize":r.default.update(i,t);break;case"tmg":d.default.tmgModel(t);break;case"window":d.default.windowModel(t);break;case"cookie":d.default.cookieModel(t);break;case"subscribe":window.location.href="https://secure.telegraph.co.uk/customer/secure/checkout/?productId=nyytq4zthbvwsoliojugwyzzmyzha3dt&offerId=freetrial1-website-monthly-PC259&campaignId=839X&icid="+n+"_genericsub_generic_generic_particle_"+t.id+"&redirectTo="+encodeURIComponent(window.location.href);break;case"register":window.location.href="https://secure.telegraph.co.uk/customer/secure/register?redirectTo="+encodeURIComponent(window.location.href)+"&q=registration&icid="+n+"_genericreg_generic_generic_particle_"+t.id;break;case"login":window.location.href="https://secure.telegraph.co.uk/secure/login/?ICID="+n+"_genericreg_generic_generic_particle_"+t.id+"&redirectTo="+encodeURIComponent(window.location.href);break;case"app-redirect":window.location.pathname=t.data.urlPath;break;default:o.default.info("Legacy particle message received, please update before July 2021",t)}}}if(o.default.isInternal()&&e.origin.match(/telegraph\.co\.uk/)&&c(e.data)){var a=JSON.parse(e.data);if(a.id===window.particleData.id&&a.index===window.particleData.i)switch(o.default.info("Particle has received a new message from the telegraph",a),a.type){case"tmg":o.default.info("New TMG variable data received",a),window.dispatchEvent(new CustomEvent("particleDataEvent",{detail:a}));break;case"window":o.default.info("New WINDOW variable data received",a),window.dispatchEvent(new CustomEvent("particleDataEvent",{detail:a}));break;case"cookie":o.default.info("New COOKIE received",a),window.dispatchEvent(new CustomEvent("particleDataEvent",{detail:a}))}}})},t.sendFromParticle=function(e,t){o.default.info("Particle ("+window.particleData.id+" ["+window.particleData.i+"]) is sending a message the telegraph"),window.parent.postMessage(JSON.stringify({id:window.particleData.id,index:window.particleData.i,type:e,data:t}),"*")},t.sendFromTelegraph=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=document.querySelector('[particle-index="'+n+'"][particle-id="'+i+'"]');o.default.info("Telegraph is sending a message to particle "+i+" (INDEX "+n+")"),a.contentWindow.postMessage(JSON.stringify({id:i,index:n,type:e,data:t}),"*")};var c=function(e){try{JSON.parse(e)}catch(e){return!1}return!0}}),n=e(function(e,t){"use strict";var n=u&&u.__esModule?u:{default:u},a=l({});function o(e,t){if(void 0===e)return!1;var i=t.indexOf(".");return-1<i?o(e[t.substring(0,i)],t.substr(i+1)):e[t]}t.tmgModel=function(e){n.default.info("New tmg factory request",e.data),(0,a.sendFromTelegraph)("tmg",{property:e.data.property,value:!0===e.data.isFunction?o(window.tmg,e.data.property)():o(window.tmg,e.data.property)},e.id,e.index)},t.windowModel=function(e){n.default.info("New window factory request",e.data),(0,a.sendFromTelegraph)("window",{property:e.data.property,value:!0===e.data.isFunction?o(window,e.data.property)():o(window,e.data.property)},e.id,e.index)},t.cookieModel=function(e){var t,i;n.default.info("New cookie factory request",e.data),(0,a.sendFromTelegraph)("cookie",{name:e.data.cookieName,value:(t=e.data.cookieName,i={},document.cookie.split(";").forEach(function(e){var t=(e=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,a=!1,o=void 0;try{for(var r,d=e[Symbol.iterator]();!(n=(r=d.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&d.return&&d.return()}finally{if(a)throw o}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(t=e.split("="),2))[0],e=e[1];i[t.trim()]=e}),i[t])},e.id,e.index)}}),a=e(function(e,t){"use strict";var i=l({}),n=o(u),a=o(s);function o(e){return e&&e.__esModule?e:{default:e}}t.initialise=function(){window.addEventListener("orientationchange",r),window.addEventListener("resize",r),window.addEventListener("load",r),n.default.info("Initialising resize for ",window.particleData.id);var e=document.getElementById("particle");new ResizeObserver(function(e){r(window.count)}).observe(e)};var r=(0,a.default)(function(){var e=document.getElementById("particle");(0,i.sendFromParticle)("resize",{height:e.offsetHeight,width:e.offsetWidth})},200);t.update=function(e,t){500<t.data.height&&250<t.data.height-500&&("true"===e.getAttribute("data-widget-expandable")||"true"===e.getAttribute("data-widget-expandable"))?d(t.id,t.index,e,t.data.height+"px"):(e.style.height=t.data.height+"px",c(t.data.id,e))};var d=function(e,t,i,n){var a=document.querySelectorAll(".more-"+e)[0],o=void 0,r=void 0;a?"none"===a.parentNode.style.display&&(i.style.height=n):(i.style.height="500px",(o=document.createElement("div")).innerHTML='<span class="show-more-button load-more__button article-body-image-caption more-'+e+'"> Show more </span>',o.classList.add("more-wrapper"),(r=document.createElement("link")).href="https://cf.eip.telegraph.co.uk/particle-embed/css/particle-more.css",r.type="text/css",r.rel="stylesheet",i.parentNode.insertBefore(o,i.nextSibling),o.appendChild(r));for(var d=document.querySelectorAll(".more-"+e)[0].cloneNode();document.querySelectorAll(".more-"+e)[0].firstChild;)d.appendChild(document.querySelectorAll(".more-"+e)[0].lastChild);document.querySelectorAll(".more-"+e)[0].parentNode.replaceChild(d,document.querySelectorAll(".more-"+e)[0]),document.querySelectorAll(".more-"+e)[0].addEventListener("click",function(){i.style.height=n,document.querySelector(".more-wrapper").style.display="none"},{once:!0})},c=function(e){(e=document.querySelectorAll(".more-"+e)[0])&&e.parentNode.remove()}}),u={},o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};u.info=function(){for(var e,t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];-1!==r().indexOf("logsWontShow")&&(window.particleData&&window.particleData.i?"object"===(void 0===i?"undefined":o(i))&&Array.isArray(i)?(e=console).log.apply(e,["%c[PARTICLES] "+i.map(function(){return"%o"}).join(""),"color: #FFD700"].concat(i)):console.log("%c[PARTICLES] %o","color: #FFD700",i):"object"===(void 0===i?"undefined":o(i))&&Array.isArray(i)?(e=console).log.apply(e,["%c[PARTICLES] "+i.map(function(){return"%o"}).join(""),"color: #4682B4"].concat(i)):console.log("%c[PARTICLES] %o","color: #4682B4",i))},u.error=function(e){console.error("%c[PARTICLES] "+e,"color: #FF0000")},u.isInternal=function(){return window.particleData&&null!==window.particleData.i&&void 0!==window.particleData.i};var r=function(){return"logsWillShow"+Math.random()},s={};Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(n,a){var o=void 0;return function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];clearTimeout(o),o=setTimeout(function(){return n.apply(void 0,t)},a)}};var t={},i=l({});t.initialise=function(){document.addEventListener("click",function(e){var t=e.target.getAttribute("href");!t||-1===t.indexOf("//telegraph.co.uk")&&-1===t.indexOf("www.telegraph.co.uk")||(e.preventDefault(),t=new URL(t),(0,i.sendFromParticle)("app-redirect",{urlPath:t.pathname+t.search}))})};var d={},c=l({});d.initialise=function(){window.getTmg=function(e,t){return(0,c.sendFromParticle)("tmg",{property:e,isFunction:t})},window.getWindow=function(e,t){return(0,c.sendFromParticle)("window",{property:e,isFunction:t})},window.parentCookie=function(e){return(0,c.sendFromParticle)("cookie",{cookieName:e})}},(e={}).initialise=function(){var t=0;function i(){var t,i,e=document.getElementById("particle").offsetHeight,n=(t=null,location.search.substr(1).split("&").forEach(function(e){"prefill"===(i=e.split("="))[0]&&(t=decodeURIComponent(i[1]))}),t);e!==window.widgetHeight&&(widgetHeight=e,window.parent.postMessage(JSON.stringify({prefill:n,height:widgetHeight,id:document.querySelector("html").getAttribute("data-widget-id")}),"*"),window.parent.postMessage({sentinel:"amp",type:"embed-size",height:Math.max(100,widgetHeight)},"*"))}window.widgetHeight=0,document.addEventListener("mousedown",function(){window.parent.postMessage(JSON.stringify({event:"click",id:document.querySelector("html").getAttribute("data-widget-id")}),"*")},!0),["resize","orientationchange","load"].forEach(function(e){window.addEventListener(e,function(){clearTimeout(t),t=setTimeout(i,250)},!1)}),i(),window.getTmg=function(e,t){window.parent.postMessage(JSON.stringify({id:document.querySelector("html").getAttribute("data-widget-id"),tmg:!0,property:e,isFunction:t}),"*")},window.parentCookie=function(e){window.parent.postMessage(JSON.stringify({id:document.querySelector("html").getAttribute("data-widget-id"),cookie:!0,cookieName:e}),"*")},window.addEventListener("message",function(e){var t;if(e.origin.match(/telegraph\.co\.uk/))try{if((t="string"==typeof e.data?JSON.parse(e.data):e.data).channelId)for(var i=document.querySelectorAll("[data-widget-section]"),n=0,a=i.length;n<a;n++)i[n].dataset.widgetSection=t.channelId}catch(e){}}),window.onload=function(){window.parent.postMessage(JSON.stringify({analyticsEvent:{id:document.querySelector("html").getAttribute("data-widget-id"),model:{id:document.querySelector("html").getAttribute("data-widget-id"),title:document.getElementById("particle").getAttribute("data-widget-title"),type:document.getElementById("particle").getAttribute("data-widget-type"),version:document.getElementById("particle").getAttribute("data-widget-version"),action:"load"}}}),"*")}};var p=y(l({})),w=y(u),f=y(a({})),g=y(t),m=y(d),h=y(e);function y(e){return e&&e.__esModule?e:{default:e}}window.initialise=function(){window.particleData=window.particleData||{},window.location.search&&window.location.search.split("?")[1].split("&").forEach(function(e){return window.particleData[e.split("=")[0]]=e.split("=")[1]}),window.particleData.i?(window.particleData.height=0,p.default.initialise(),m.default.initialise(),w.default.info("Particle is initialising",window.particleData.id),window.addEventListener("load",v)):(w.default.info("Loading legacy helper methods"),h.default.initialise())};var v=function(){w.default.info('Particle loaded | ID: "'+window.particleData.id+'" INDEX: '+window.particleData.i),document.querySelectorAll("[data-widget-section]").forEach(function(e){e.dataset.widgetSection=window.particleData.channel}),p.default.sendFromParticle("ready",{}),f.default.initialise(),"true"===window.particleData.isapp&&g.default.initialise()};initialise()}();
