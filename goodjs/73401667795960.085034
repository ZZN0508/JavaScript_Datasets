var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.SIMPLE_FROUND_POLYFILL=!1,$jscomp.ISOLATE_POLYFILLS=!1,$jscomp.FORCE_POLYFILL_PROMISE=!1,$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,i){return e==Array.prototype||e==Object.prototype||(e[t]=i.value),e},$jscomp.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var i=e[t];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")},$jscomp.global=$jscomp.getGlobal(this),$jscomp.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE,$jscomp.polyfills={},$jscomp.propertyToPolyfillSymbol={},$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(e,t){var i=$jscomp.propertyToPolyfillSymbol[t];return null!=i&&void 0!==(i=e[i])?i:e[t]};$jscomp.polyfill=function(e,t,i,n){t&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(e,t,i,n):$jscomp.polyfillUnisolated(e,t,i,n))},$jscomp.polyfillUnisolated=function(e,t,i,n){for(i=$jscomp.global,e=e.split("."),n=0;n<e.length-1;n++){var a=e[n];if(!(a in i))return;i=i[a]}(t=t(n=i[e=e[e.length-1]]))!=n&&null!=t&&$jscomp.defineProperty(i,e,{configurable:!0,writable:!0,value:t})},$jscomp.polyfillIsolated=function(e,t,i,n){var a=e.split(".");e=1===a.length,n=a[0],n=!e&&n in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var s=0;s<a.length-1;s++){var r=a[s];if(!(r in n))return;n=n[r]}a=a[a.length-1],null!=(t=t(i=$jscomp.IS_SYMBOL_NATIVE&&"es6"===i?n[a]:null))&&(e?$jscomp.defineProperty($jscomp.polyfills,a,{configurable:!0,writable:!0,value:t}):t!==i&&(void 0===$jscomp.propertyToPolyfillSymbol[a]&&(i=1e9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[a]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(a):$jscomp.POLYFILL_PREFIX+i+"$"+a),$jscomp.defineProperty(n,$jscomp.propertyToPolyfillSymbol[a],{configurable:!0,writable:!0,value:t})))},$jscomp.polyfill("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},"es6","es3"),$jscomp.polyfill("Array.prototype.includes",function(e){return e||function(e,t){var i=this,n=(i=i instanceof String?String(i):i).length;for((t=t||0)<0&&(t=Math.max(t+n,0));t<n;t++){var a=i[t];if(a===e||Object.is(a,e))return!0}return!1}},"es7","es3"),$jscomp.checkStringArgs=function(e,t,i){if(null==e)throw new TypeError("The 'this' value for String.prototype."+i+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+i+" must not be a regular expression");return e+""},$jscomp.polyfill("String.prototype.includes",function(e){return e||function(e,t){return-1!==$jscomp.checkStringArgs(this,e,"includes").indexOf(e,t||0)}},"es6","es3");var EBGInfra=EBGInfra||{declareNamespace:function(e){var t=window.EBG;e=e.split(".");for(var i=0;i<e.length;i++)var n=e[i],t=t[n]||(t[n]={})},declareClass:function(e,t){return e.prototype.constructor=e,t&&(e.__superClass=t,e.__basePrototypePending=!0,EBG._resolveInheritance(e)),e},runTimed:function(e,t,i,n){return setTimeout(function(){t.apply(e,i)},n)},setInterval:function(e,t,i,n){return setInterval(function(){t.apply(e,i)},n)},clearInterval:function(e){clearInterval(e)},sequence:function(){function c(e){if(e.count--,0<=e.count)return EBG.runTimed(this,c,[e],e.interval),e.tfunc.apply(e.context,e.args);EBG.isFunc(e.callback)&&e.callback.apply(e.cbContext,e.cbArgs),h[e.index]=null}var h=[];return function(e,t,i,n,a,s,r,o,d,E){if(EBG.isFunc(t)){var l;e:{for(l=0;l<h.length;l++)if(h[l]&&h[l].func==t)break e;l=!1}return s=EBG.isNumber(s)?s:a,E=E||{},EBG.isFunc(o)&&!EBG.isDefined(E.trailing)&&(E.trailing=!1),e={context:e,func:t,tfunc:!1===l?this.throttle(t,s,E):h[l].tfunc,args:i||[],count:n,interval:a,cbContext:r,callback:o,cbArgs:d||[]},t=h.push(e)-1,h[t].index=t,c(e)}return!1}}(),debounce:function(t,i,n){function a(){var e=(new Date).getTime()-d;e<i&&0<=e?s=setTimeout(a,i-e):(s=null,n||(E=t.apply(o,r),s||(o=r=null)))}var s,r,o,d,E;return function(){o=this,r=arguments,d=(new Date).getTime();var e=n&&!s;return s=s||setTimeout(a,i),e&&(E=t.apply(o,r),o=r=null),E}},throttle:function(i,n,a){var s,r,o,d=null,E=0;a=a||{};function l(){E=!1===a.leading?0:(new Date).getTime(),d=null,o=i.apply(s,r),d||(s=r=null)}return function(){var e=(new Date).getTime();E||!1!==a.leading||(E=e);var t=n-(e-E);return s=this,r=arguments,t<=0||n<t?(d&&(clearTimeout(d),d=null),E=e,o=i.apply(s,r),d||(s=r=null)):d||!1===a.trailing||(d=setTimeout(l,t)),o}},_resolveInheritance:function(e){if(e.__basePrototypePending){var t=e.__superClass;EBG._resolveInheritance(t);var i,t=t.prototype,n=e.prototype;for(i in t)n[i]=n[i]||t[i];delete e.__basePrototypePending}},callSuperConstructor:function(e,t,i){return(e=e.__superClass)&&(i?e.apply(t,i):e.apply(t)),t},callSuperFunction:function(e,t,i,n){var a;(e=e.__superClass)&&(a=e.prototype[i]);try{if(a)return n?a.apply(t,n):a.apply(t)}catch(e){}},typeOf:function(e){var t=typeof e;if("object"==t){if(!e)return"function"==t&&void 0===e.call?"object":"null";if(e instanceof Array||!(e instanceof Object)&&"[object Array]"==Object.prototype.toString.call(e)||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if(!(e instanceof Object||"[object Function]"!=Object.prototype.toString.call(e)&&(void 0===e.call||void 0===e.propertyIsEnumerable||e.propertyIsEnumerable("call"))))return"function"}return t},isFunc:function(e){return"function"==EBG.typeOf(e)},isDefined:function(e){return"undefined"!=EBG.typeOf(e)},notNull:function(e){return null!=e},isDefinedNotNull:function(e){return this.isDefined(e)&&this.notNull(e)},hasValue:function(e){return null!=e&&"undefined"!=EBG.typeOf(e)},hasOwnValue:function(e,t,i){for(var n in e)if(e.hasOwnProperty(n))if(i&&EBG.isFunc(e[n].toLowerCase)){if(e[n].toLowerCase()===t.toLowerCase())return!0}else if(e[n]===t)return!0;return!1},objMatch:function(e,t){if(e&&!t||!e&&t)return!1;for(var i in e){switch(!0){case!EBG.isDefined(t[i]):var n=!1;break;case e[i]===t[i]:case EBG.isElementOrNode(e[i]):n=e[i]===t[i];break;case EBG.isObj(e[i]):case EBG.isArray(e[i]):n=EBG.objMatch(e[i],t[i]);break;default:n=!1}if(!n)return!1}return!0},isObj:function(e){return"object"==EBG.typeOf(e)},isArray:function(e){return"array"==EBG.typeOf(e)},isBool:function(e){return"boolean"==EBG.typeOf(e)},isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},isNode:function(e){var t=e&&e.ownerDocument&&(e.ownerDocument.defaultView||e.ownerDocument.parentwindow);return!t||"object"!=typeof t.Node&&"function"!=typeof t.Node?e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName:e instanceof t.Node},isElement:function(e){var t=e&&e.ownerDocument&&(e.ownerDocument.defaultView||e.ownerDocument.parentwindow);return!t||"object"!=typeof t.HTMLElement&&"function"!=typeof t.HTMLElement?e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName:e instanceof t.HTMLElement},isElementOrNode:function(e){return this.isElement(e)||this.isNode(e)},format:function(e){for(var t=1;t<arguments.length;t++)e=e.replace(new RegExp("\\{"+(t-1)+"\\}","gi"),""+arguments[t]);return e},throwEx:function(e){throw{name:"",message:e}},mergeObj:function(e,t,i){for(var n in i=!!i,e)!e.hasOwnProperty(n)||t.hasOwnProperty(n)&&!i||(t[n]=e[n])},cloneObj:function(e,t,i){if(i=i||1,!EBG.isObj(e))return null;var n,a={};for(n in e)e.hasOwnProperty(n)&&(t&&EBG.isElementOrNode(e[n])||EBG.isDefinedNotNull(e[n])&&e[n]==e[n].self?a[n]=e[n]:a[n]=EBG.isObj(e[n])&&i<=4?EBG.cloneObj(e[n],null,i+1):e[n]);return a},combinePaths:function(e,t){return t=t||"",(e=e||"")&&"/"!=e[e.length-1]&&t&&"/"!=t[0]&&(e+="/"),t&&(e+=t),e},px:function(e){return 0<e.toString().search("%")?e:EBG.format("{0}px",e)},indexOfArray:function(e,t){for(var i=0;i<e.length;i++)if(e[i]==t)return i;return-1},filterObject:function(e,t,i){if("function"!=typeof t)throw new TypeError;var n,a,s={};for(n in e)e.hasOwnProperty(n)&&(a=e[n],t.call(i||window,a,n,e)&&(s[n]=a));return s},filterArray:function(e,t,i){var n=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var a,s=[],r=0;r<n;r++)r in e&&(a=e[r],t.call(i||window,a,r,e)&&s.push(a));return s},isGlobalDef:function(a,b){var c=void 0!==window[a];return b&&c&&(c=eval(a+"=="+b)),c},getPageUrl:function(e){try{return e&&e.location&&e.location.href?e.location.href:null}catch(e){return null}},_isXMLHttpRequestSupported:function(e){var t=(t=window.XMLHttpRequest?new XMLHttpRequest:null)&&EBG.isBool(t.withCredentials);return t=EBG.isMRAID()?!!e:t},htmlDecode:function(e){return this.helperDiv=this.helperDiv||document.createElement("div"),this.helperDiv.innerHTML=e,this.helperDiv.textContent},htmlEncode:function(e){return this.helperDiv=this.helperDiv||document.createElement("div"),this.helperDiv.textContent=e,this.helperDiv.innerHTML},getDataFromRemoteServer:function(e,i,n,t,a){if(!e||EBG.isOfflineDemo)return!1;t=!EBG.isBool(t)||t,a=!!EBG.isBool(a)&&a;var s,r,o=!1;try{this._isXMLHttpRequestSupported(!0)?((s=new XMLHttpRequest).open("GET",e,t),o=!0,t&&(s.onreadystatechange=function(){4==s.readyState&&(200==s.status?i.call(n,a?s.responseXML:s.responseText):i.call(n))}),s.send(),t||i.call(n,a?s.responseXML:s.responseText)):window.XDomainRequest&&t&&((r=new XDomainRequest).onerror=function(){i.call(n)},r.ontimeout=function(){i.call(n)},r.onload=function(){try{var e,t;a?(9===document.documentMode?e=(new window.DOMParser).parseFromString(r.responseText,"text/xml"):((t=document.createElement("div")).innerHTML="<xml>"+r.responseText+"</xml>",document.body.appendChild(t),e=t.firstChild.XMLDocument,document.body.removeChild(t)),i.call(n,e)):i.call(n,r.responseText)}catch(e){i.call(n)}},r.onprogress=function(){},r.open("get",e),r.send(),o=!0)}catch(e){o=!1}return o},isPercentage:function(e){return"string"==typeof e&&(/\d+%/.test(e)&&EBG.isNumber(parseInt(e)))},getTime:function(){var e=(new Date).getTime()/1e3;return function(){return(new Date).getTime()/1e3-e}}(),getObjKeys:function(e){if(e=e||{},Object.keys)return Object.keys(e);var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push(t);return i},serializeObject:function(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push(t+"="+e[t]);return i.join("&")},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},getTopAccessibleWindow:function(){if((s=window).location.ancestorOrigins){for(var t=window,i=window,e=s.location.ancestorOrigins,n=!1,a=0;a<e.length;a++){var s=s.parent,r=document.createElement("a");r.href=e[a],r=r.hostname,"null"!==e[a]&&(window.location.origin===e[a]||""===window.location.hostname&&""===r)?(i=s,n||(t=s)):n=!0}return function(e){return"boolean"!=typeof e||e?t:i}}try{if(!s.top.document.domain&&""!==s.parent.document.domain)throw new DOMException;s=s.top}catch(e){try{for(s=window;s!==s.parent&&s.self!==s.parent;)!s.parent.document.domain&&""!==s.parent.document.domain||(s=s.parent)}catch(e){}}return function(){return s}}(),getBigScript:function(t){return function(){var e=t.currentScript||(e=t.getElementsByTagName("script"))[e.length-1];return e}}(document),valueFromPath:function(e,t,i){t=t.split(".");for(var n=0;n<t.length;n++)e=e[t[n]];return EBG.isObj(e)&&i?EBG.cloneObj(e):e},isMRAID:function(){return window.mraid&&EBG.isFunc(mraid.getVersion)}};EBG=window.EBG||{},EBGInfra.mergeObj(EBGInfra,EBG,!1),EBG.declareNamespace("Logging"),EBG.Logging.LoggerLevels={NONE:0,ERROR:1,INFO:2,WARN:3,DEBUG:4},EBG.Logging.Logger=function(e){this._level=e,this.startNestingGroupNames=[],this.endNestingGroupNames=[],this._stringFilters=[],this._fGroupFilter=!1,this._maxIndent=15},EBG.Logging.Logger.prototype={setLevel:function(e){this._level=e},setFilter:function(e,t){"string"==EBG.typeOf(e)&&(e=[e]),this._fGroupFilter=!EBG.isDefined(t)||t,this._stringFilters=e},debug:function(e){this._reportToLog(EBG.Logging.LoggerLevels.DEBUG,arguments)},info:function(e){this._reportToLog(EBG.Logging.LoggerLevels.INFO,arguments)},warn:function(e){this._reportToLog(EBG.Logging.LoggerLevels.WARN,arguments)},error:function(e){this._reportToLog(EBG.Logging.LoggerLevels.ERROR,arguments)},exception:function(e,t){e="string"!==t?EBG.format("Exception in {0}. message: {1}",e,t.message):EBG.format("Exception in: {0}. message: {1}",e,t),t.stack&&(e+=EBG.format(" stack: {0}",t.stack)),this._reportToLog(EBG.Logging.LoggerLevels.ERROR,[e])},startGroup:function(e){this._supportNesting()&&this._passesFilter(e)&&this.startNestingGroupNames.push(e)},endGroup:function(){this._supportNesting()&&0<this.endNestingGroupNames.length&&window.console.groupEnd(this.endNestingGroupNames.pop())},_consoleAvailable:function(){return void 0!==window.console},_supportNesting:function(){return!!this._consoleAvailable()&&void 0!==window.console.group},_supportErrorMessage:function(){return void 0!==window.console.error},_supportInfoMessage:function(){return void 0!==window.console.info||void 0!==window.opera},_supportWarnMessage:function(){return void 0!==window.console.warn||void 0!==window.opera},_supportObjectView:function(){return void 0!==window.console.dir||void 0!==window.opera},_callConsoleFunction:function(e,t){var i=!1;switch(e){case EBG.Logging.LoggerLevels.INFO:this._supportInfoMessage()&&(window.console.info(t),i=!0);break;case EBG.Logging.LoggerLevels.WARN:this._supportWarnMessage()&&(window.console.warn(t),i=!0);break;case EBG.Logging.LoggerLevels.ERROR:this._supportErrorMessage()&&(consoleFunction=window.console.error(t),i=!0)}i||window.console.log(t)},_resetNesting:function(){for(var e=0;e<=this._maxIndent;e++)this.endGroup();console.warn("Reset log group nesting. MaxIndent = "+this._maxIndent)},_passesFilter:function(e){var t=!1;if(0==this._stringFilters.length)t=!0;else for(var i=0;i<this._stringFilters.length;i++)if(-1<e.indexOf(this._stringFilters[i])){t=!0;break}return t},_reportToLog:function(e,t){if(this._level>=e&&this._consoleAvailable()){var i=t[0];if("[object String]"!==Object.prototype.toString.call(i)?this._supportObjectView()||(i=i.toString()):i=EBG.format.apply(null,t),void 0===window.opera){for(;this.startNestingGroupNames.length;)window.console.group(this.startNestingGroupNames[0]),this.endNestingGroupNames.push(this.startNestingGroupNames.shift());(this._passesFilter(i)||this._fGroupFilter&&0<this.endNestingGroupNames.length)&&this._callConsoleFunction(e,i),this.endNestingGroupNames.length>this._maxIndent&&this._resetNesting()}else this._passesFilter(i)&&opera.postError(i)}}},EBG.declareClass(EBG.Logging.Logger,null),EBG.log=EBG.log||new EBG.Logging.Logger(EBG.Logging.LoggerLevels.NONE),function(r,o){var d;(o=o||{fn:{},extend:function(){for(var e=arguments[0],t=1,i=arguments.length;t<i;t++){var n,a=arguments[t];for(n in a)e[n]=a[n]}return e}}).fn.pm=function(){return this},r.EBG&&!EBG.pm?(o.pm=EBG.pm=function(e){d.send(e)},o.pm.bind=EBG.bind=function(e,t,i,n,a){d.bind(e,t,i,n,a)},o.pm.unbind=EBG.unbind=function(e,t){d.unbind(e,t)},o.pm.dispatch=function(e,t,i,n){d._dispatch({data:JSON.stringify({data:t,type:e}),source:i,target:n,origin:null})},o.pm.__dispatch=o.pm.dispatch,o.pm.origin=EBG.pm.origin=null,d={send:function(e){var t,i=(e=o.extend({},d.defaults,e)).target;e.target&&e.type&&(t={data:e.data,type:e.type},e.success&&(t.callback=d._callback(e.success)),e.error&&(t.errback=d._callback(e.error)),"postMessage"in i&&!e.hash&&(d._bind(),i.postMessage(JSON.stringify(t),e.origin||"*")))},bind:function(e,t,i,n,a,s){"postMessage"in r&&!s&&(d._bind(n),(n=d.data("listeners.postmessage"))||d.data("listeners.postmessage",n={}),(s=n[e])||(n[e]=s=[]),s.push({fn:t,origin:a||o.pm.origin,bindObj:i}))},unbind:function(e,t){var i=d.data("listeners.postmessage");if(i&&e)if(t){var n=i[e];if(n){for(var a=[],s=0,r=n.length;s<r;s++){var o=n[s];o.fn!==t&&a.push(o)}i[e]=a}}else delete i[e]},data:function(e,t){return void 0===t?d._data[e]:d._data[e]=t},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){for(var e=[],t=0;t<32;t++)e[t]=d._CHARS[0|32*Math.random()];return e.join("")},_callback:function(e){var t=d.data("callbacks.postmessage");t||d.data("callbacks.postmessage",t={});var i=d._random();return t[i]=e,i},_bind:function(e){d.data("listening.postmessage")||((e=e||r).addEventListener?e.addEventListener("message",d._dispatch,!1):r.attachEvent&&e.attachEvent("onmessage",d._dispatch),d.data("listening.postmessage",1))},_dispatch:function(t){var i={};try{i=JSON.parse(t.data)}catch(e){return}if(i.type){var e=(d.data("callbacks.postmessage")||{})[i.type];if(e)e(i.data);else for(var n=0,a=(e=(d.data("listeners.postmessage")||{})[i.type]||[]).length;n<a;n++){var s=e[n];if(s.origin&&t.origin!==s.origin)i.errback&&d.send({target:t.source,data:{message:"postmessage origin mismatch",origin:[t.origin,s.origin]},type:i.errback});else try{var r=s.bindObj?s.fn.apply(s.bindObj,[i.data,t]):s.fn(i.data,t);i.callback&&d.send({target:t.source,data:r,type:i.callback})}catch(e){i.errback&&d.send({target:t.source,data:e,type:i.errback})}}}}},o.extend(d,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:!1}})):o.pm=EBG.pm}(this,"undefined"==typeof jQuery?null:jQuery),"JSON"in window&&window.JSON||(JSON={}),function(){function a(e){return e<10?"0"+e:e}function b(t){return e.lastIndex=0,e.test(t)?'"'+t.replace(e,function(e){var t=h[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function c(e,t){var i=f,n=t[e];switch(n&&"object"==typeof n&&"function"==typeof n.toJSON&&(n=n.toJSON(e)),typeof(n="function"==typeof k?k.call(t,e,n):n)){case"string":return b(n);case"number":return isFinite(n)?String(n):"null";case"boolean":case"null":return String(n);case"object":if(!n)return"null";f+=g;var a=[];if("[object Array]"===Object.prototype.toString.apply(n)){var s=n.length;for(e=0;e<s;e+=1)a[e]=c(e,n)||"null";return t=0===a.length?"[]":f?"[\n"+f+a.join(",\n"+f)+"\n"+i+"]":"["+a.join(",")+"]",f=i,t}if(k&&"object"==typeof k)for(s=k.length,e=0;e<s;e+=1){var r=k[e];"string"==typeof r&&(t=c(r,n))&&a.push(b(r)+(f?": ":":")+t)}else for(r in n)Object.hasOwnProperty.call(n,r)&&(t=c(r,n))&&a.push(b(r)+(f?": ":":")+t);return t=0===a.length?"{}":f?"{\n"+f+a.join(",\n"+f)+"\n"+i+"}":"{"+a.join(",")+"}",f=i,t}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,g,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,i){var n;if(g=f="","number"==typeof i)for(n=0;n<i;n+=1)g+=" ";else"string"==typeof i&&(g=i);if((k=t)&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw Error("JSON.stringify");return c("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(l,m){function p(e,t){var i,n,a=e[t];if(a&&"object"==typeof a)for(i in a)Object.hasOwnProperty.call(a,i)&&(void 0!==(n=p(a,i))?a[i]=n:delete a[i]);return m.call(e,t,a)}if(d.lastIndex=0,d.test(l)&&(l=l.replace(d,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(l.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return l=eval("("+l+")"),"function"==typeof m?p({"":l},""):l;throw new SyntaxError("JSON.parse")})}(),EBG.declareNamespace("API"),EBG.API.InjectionMethod={APPEND:"append",INSERT_BEFORE:"insertBefore",INSERT_AFTER:"insertAfter",FIRST_CHILD:"firstChild",LAST_CHILD:"lastChild"},EBG.API.BrowserTypes={NON_SUPPORTED:0,IE:1,FF:2,NN:3,SAFARI:4,CHROME:5,AOL:6,OPERA:7,EDGE:8},EBG.API.PlatformTypes={NON_SUPPORTED:0,WIN_95:1,WIN_98:2,WIN_2000:3,WIN_XP:4,WIN_ME:5,WIN_NT:6,MAC:7,WIN_VISTA:8,WIN_7:9,IPHONE:10,IPAD:11,IPOD:12,ANDROID_2_TAB:13,ANDROID_3_TAB:14,WIN_10:15,ANDROID_5_TAB:16,ANDROID_2_MOBILE:17,ANDROID_3_MOBILE:18,WIN_MOBILE_7:19,ANDROID_4_TAB:20,ANDROID_4_MOBILE:21,WIN_8:22,MAC_NEW:23,MAC_YOSEMITE:24,ANDROID_5_MOBILE:25,CROS:26,FBAN:27,SMART_TV:28,UBUNTU:29,LINUX:30,ANDROID_1:31,ANDROID_6_MOBILE:32,ANDROID_6_TAB:33,Mac_El_Capitan:34,Mac_Sierra:35,ANDROID_7_MOBILE:36,ANDROID_7_TAB:37,ANDROID_8_MOBILE:39,ANDROID_8_TAB:40,ANDROID_9_MOBILE:41,ANDROID_9_TAB:42,ANDROID_10_MOBILE:43,ANDROID_10_TAB:44,ANDROID_11_MOBILE:45,ANDROID_11_TAB:46},EBG.API.DeviceTypes={DESKTOP:0,MOBILE:1,TABLET:2,UNKNOWN:3},EBG.API.EventNames={INAPP_IMPRESSION:"INAPP_IMPRESSION",CREATE_AD:"CREATE_AD",CREATE_ADAPTOR:"CREATE_ADAPTOR",ADAPTOR_MODULES_READY:"ADAPTOR_MODULES_READY",CREATE_INT_MGR:"CREATE_INT_MGR",CREATE_ANIM_MGR:"CREATE_ANIM_MGR",CREATE_POSITIONING_HELPER:"CREATE_POSITIONING_HELPER",CREATE_GEOMETRY_HELPER:"CREATE_GEOMETRY_HELPER",SHOW_AD:"SHOW_AD",ADD_CREATIVES:"ADD_CREATIVES",ADD_INTERACTION:"ADD_INTERACTION",ADD_EYE_DIV:"ADD_EYE_DIV",ADD_HTML5_MAIN_CREATIVE:"ADD_HTML5_MAIN_CREATIVE",ADD_HTML5_PANEL_CREATIVE:"ADD_HTML5_PANEL_CREATIVE",ADD_EMPTY_BANNER_CREATIVE:"ADD_EMPTY_BANNER_CREATIVE",ADD_BANNER_IMAGE_CREATIVE:"ADD_BANNER_IMAGE_CREATIVE",ADD_BANNER_DEFAULT_IMAGE_CREATIVE:"ADD_BANNER_DEFAULT_IMAGE_CREATIVE",ADD_BANNER_PRELOAD_IMAGE_CREATIVE:"ADD_BANNER_PRELOAD_IMAGE_CREATIVE",ADD_BANNER_DEFAULT_FLASH_CREATIVE:"ADD_BANNER_DEFAULT_FLASH_CREATIVE",ADD_BANNER_RICH_FLASH_CREATIVE:"ADD_BANNER_RICH_FLASH_CREATIVE",ADD_FLOATING_INTRO_CREATIVE:"ADD_FLOATING_INTRO_CREATIVE",ADD_FLOATING_REMINDER_CREATIVE:"ADD_FLOATING_REMINDER_CREATIVE",ADD_FLOATING_MINISITE_CREATIVE:"ADD_FLOATING_MINISITE_CREATIVE",ADD_PANEL_RICH_FLASH_CREATIVE:"ADD_PANEL_RICH_FLASH_CREATIVE",SHOW_BANNER_RICH_FLASH_CREATIVE:"SHOW_BANNER_RICH_FLASH_CREATIVE",SHOW_PANEL_RICH_FLASH_CREATIVE:"SHOW_PANEL_RICH_FLASH_CREATIVE",SHOW_PANEL_CREATIVE:"SHOW_PANEL_CREATIVE",SHOW_REMINDER:"SHOW_REMINDER",SHOW_MINISITE:"SHOW_MINISITE",PAGE_LOAD:"PAGE_LOAD",COLLECT_TIMERS:"COLLECT_TIMERS",PAGE_UNLOAD:"PAGE_UNLOAD",AD_UNLOAD:"AD_UNLOAD",PAGE_BEFORE_UNLOAD:"PAGE_BEFORE_UNLOAD",PAGE_HIDE:"PAGE_HIDE",PAGE_RESIZE:"PAGE_RESIZE",PAGE_SCROLL:"PAGE_SCROLL",PAGE_FOCUS:"PAGE_FOCUS",PAGE_FOCUSIN:"PAGE_FOCUSIN",PAGE_FOCUSOUT:"PAGE_FOCUSOUT",PAGE_BLUR:"PAGE_BLUR",PAGE_HIDDEN:"PAGE_HIDDEN",PAGE_VISIBLE:"PAGE_VISIBLE",INTERACTION_REPORT_REMOTE_SERVERS:"INTERACTION_REPORT_REMOTE_SERVERS",START_TIMER:"START_TIMER",STOP_TIMER:"STOP_TIMER",UPDATE_TIMER:"UPDATE_TIMER",HANDLE_COUNTER_INTERACTION:"HANDLE_COUNTER_INTERACTION",HANDLE_TIMER_INTERACTION:"HANDLE_TIMER_INTERACTION",DEFAULT_CLICK:"DEFAULT_CLICK",EXPAND:"EXPAND",COLLAPSE:"COLLAPSE",USER_INTERACTION:"USER_INTERACTION",MOUSE_OVER:"MOUSE_OVER",MOUSE_OUT:"MOUSE_OUT",MOUSE_MOVE:"MOUSE_MOVE",MODULE_LOAD:"MODULE_LOAD",USER_INITIATED_VIDEO:"USER_INITIATED_VIDEO",DWELL_UNIQUE:"DWELL_UNIQUE",DWELL_VIDEO_START:"DWELL_VIDEO_START",DWELL_VIDEO_STOP:"DWELL_VIDEO_STOP",CREATIVE_CONTAINER_READY:"CREATIVE_CONTAINER_READY",RICH_FLASH_PLAYED:"RICH_FLASH_PLAYED",REPLAY_AD:"REPLAY_AD",BANDWITH_DETECTED:"BANDWITH_DETECTED",FULL_SCREEN_START:"FULL_SCREEN_START",FULL_SCREEN_END:"FULL_SCREEN_STOP",ANIMATE_PANEL:"ANIMATE_PANEL",CLOSE_AD:"CLOSE_AD",OPEN_PAGE:"OPEN_PAGE",MAX_AD_DURATION:"MAX_AD_DURATION",FLASH_IN_FRAME_TWO:"FLASH_IN_FRAME_TWO",SHOW_HIDE_ELEMENTS:"SHOW_HIDE_ELEMENTS",DEFAULT_IMPRESSION:"DEFAULT_IMPRESSION",AIE_LOADED:"AIE_LOADED",INIT_MANAGERS:"INIT_MANAGERS",MOUSE_MOVE_NEEDED:"MOUSE_MOVE_NEEDED",VISIBILITY_CHECK:"VISIBILITY_CHECK",VISIBILITY_HIDDEN:"VISIBILITY_HIDDEN",AD_START:"AD_START",ELEMENT_LOADED:"ELEMENT_LOADED",AD_STACKING:"AD_STACKING",SCREEN_ORIENTATION:"SCREEN_ORIENTATION",PORTRAIT:"PORTRAIT",LANDSCAPE:"LANDSCAPE",CHANGE_PANEL_POSITION:"CHANGE_PANEL_POSITION",PANEL_FREQUENCY_LOADED:"PANEL_FREQUENCY_LOADED",THROTTLED:"THROTTLED",FLASH_DETECTED:"FLASH_DETECTED",ANIMATION:"ANIMATION",RESIZE_PANEL:"RESIZE_PANEL",MESSAGE_CREATIVE:"MESSAGE_CREATIVE",ELEMENT_HIDDEN:"ELEMENT_HIDDEN",ELEMENT_SHOWN:"ELEMENT_SHOWN",DEVICE_MOTION:"DEVICE_MOTION",DEVICE_ORIENTATION:"DEVICE_ORIENTATION",INSTREAM_SEND_IMPRESSION:"INSTREAM_SEND_IMPRESSION",IMPRESSION_SENT:"IMPRESSION_SENT"},EBG.API.EbEventNames={PAGE_LOAD:EBG.API.EventNames.PAGE_LOAD,SCREEN_ORIENTATION:EBG.API.EventNames.SCREEN_ORIENTATION,VISIBILITY:EBG.API.EventNames.VISIBILITY_CHECK,EXPAND:EBG.API.EventNames.EXPAND,COLLAPSE:EBG.API.EventNames.COLLAPSE,DEVICE_MOTION:EBG.API.EventNames.DEVICE_MOTION,DEVICE_ORIENTATION:EBG.API.EventNames.DEVICE_ORIENTATION},EBG.VideoInteraction={STARTED:"ebVideoStarted",PERCENT_25_PLAYED:"eb25Per_Played",PERCENT_50_PLAYED:"eb50Per_Played",PERCENT_75_PLAYED:"eb75Per_Played",FULLPLAY:"ebVideoFullPlay",MUTE:"ebVideoMute",UNMUTE:"ebVideoUnmute",PAUSE:"ebVideoPause",REPLAY:"ebVideoReplay",UNMUTED:"ebVideoUnmuted",FULLSCREEN_START:"ebFSStart",FULLSCREEN_END:"ebFSEnd",FULLSCREEN_MUTE:"ebFSVideoMute",FULLSCREEN_PAUSE:"ebFSVideoPause",SLIDER_DRAGGED:"ebSliderDragged",VIDEO_PLAY_DURATION:"ebVideoPlayDuration",VIDEO_ASSET_DURATION:"ebVideoAssetDuration",FULLSCREEN_DURATION:"ebFSVideoPlayDuration",FULLSCREEN_ASSET_DURATION:"ebFSVideoAssetDuration",USER_INITIATED_VIDEO:"ebUserInitiatedVideo",SKIP:"ebSkip",VIDEO_START:"AdVideoStart",FIRST_POINT:"AdVideoFirstQuartile",MID_POINT:"AdVideoMidpoint",THIRD_POINT:"AdVideoThirdQuartile",VIDEO_COMPLETE:"AdVideoComplete"},EBG.VideoQuartiles=[EBG.VideoInteraction.STARTED,EBG.VideoInteraction.PERCENT_25_PLAYED,EBG.VideoInteraction.PERCENT_50_PLAYED,EBG.VideoInteraction.PERCENT_75_PLAYED,EBG.VideoInteraction.FULLPLAY],EBG.ReportImpressionType={SERVER:0,DELAYED:1,CLIENT:2},EBG.EBMessage={SDK_BRIDGE_LOADED:"sdkBridgeLoaded",MRAID_LOADED:"mraidLoaded",REQ_INIT:"reqInit",INIT:"ebInit",INITDONE:"ebInitDone",GET_ENVIROMENT:"ebGetEnvironment",SHOW_DEFAULT_IMAGE:"ebShowDefaultImage",CLICKTHROUGH:"ebclickthrough",NOTIFIED_INTERACTION:"ebNotifiedInteraction",VERSION_TRACKING_IMPRESSION:"ebversiontrackingimpression",USER_ACTION_COUNTER:"ebCIUserActionCounter",AUTOMATIC_EVENT_COUNTER:"ebCIAutomaticEventCounter",START_TIMER:"ebCIStartTimer",UPDATE_TIMER:"ebUpdateTimer",STOP_TIMER:"ebCIStopTimer",START_VIDEO_TIMER:"ebStartVideoTimer",STOP_VIDEO_TIMER:"ebendvideotimer",VIDEO_INTERACTION:"ebVideoInteraction",VIDEO_INIT:"ebVideoInit",VIDEO_LOAD:"ebVideoLoad",INIT_VIDEO_LOADER:"ebInitVideoLoader",VIDEO_FS_OPEN:"ebVideoFSOpen",VIDEO_FS_CLOSE:"ebVideoFSClose",VIDEO_FS_AUTO_CLOSE:"ebVideoFSAutoClose",START_VIDEO:"ebtStartVideo",STOP_VIDEO:"ebtStoptVideo",UPDATE_VIDEO_DURATION:"ebtUpdateVideoDuration",FULL_SCREEN_OPEN:"ebFullScreenOpen",FULL_SCREEN_CLOSE:"ebFullScreenClose",FULL_SCREEN_AUTO_CLOSE:"ebFullScreenAutoClose",MOUSE_MOVE:"ebMouseMove",PAGE_LOAD:"ebPageLoad",TRIGGER_AD_START:"ebTriggerAdStart",INIT_EXPANSION_PARAMS:"ebInitExpansionParams",RESET_COLLAPSE_TIMER:"ebResetCollapseTimer",NEW_SE:"ebNewSE",EXPAND:"ebExpandPanel",EXPAND_DONE:"ebExpandDone",COLLAPSE:"ebCollapsePanel",COLLAPSE_DONE:"ebCollapseDone",NOTIFY_INTERACTION_MONITOR:"NotifyInteractionMonitor",HIDE_INTRO:"ebHideIntro",INTRO_FULL_PLAY:"ebIntroFullPlay",KEEP_AD_OPREN:"ebKeepAdOpen",GO_TO_MINISITE:"ebGoToMiniSite",UPDATE_CLICK:"ebUpdateClick",DOCUMENT_LOADED:"ebDocumentLoaded",PLAY_VIDEO_ON_NATIVE_PLAYER:"playVideoOnNativePlayer",CREATE_CALENDAR_EVENT:"createCalendarEvent",STORE_PICTURE:"storePicture",SDK_DATA_CHANGE:"sdkDataChange",SDK_EVENT:"sdkEvent",ADAPTOR_READY:"adaptorReady",SWIPE:"ebSwipe",DISPOSE:"ebDispose",SET_RESIZE_PROPS:"ebResizeProperties",RESIZE:"ebResize",SET_EXPAND_PROPS:"ebExpandProperties",SET_ORIENTATION_PROPS:"ebOrientationProperties",CLOSE:"ebClose",CLOSE_AD:"ebclosead",SET_STATE:"ebSetstate",RESET_STATE:"ebResetstate",REQ_MOUSE_MOVE:"ebReqMouseMove",ANIMATION:"ebAnimation",VISIBILITY:"ebVisibility",PANEL_FREQUENCY:"ebPanelFrequency",HIDE_ELEMENT:"ebHideElement",SHOW_ELEMENT:"ebShowElement",ACKNOWLEDGE:"ebAcknowledge",SEND_IMP:"sendImp",UPDATE_VISIBILITY_ASSET:"ebUpdateVisibilityAsset"},EBG.DurationInteraction={TIMER:"Timer",AGGREGATE:"Aggregate"},EBG.Animation={Easing:{linear:"linear",easeInQuad:"easeInQuad",easeOutQuad:"easeOutQuad",easeInOutQuad:"easeInOutQuad",easeInCubic:"easeInCubic",easeOutCubic:"easeOutCubic",easeInOutCubic:"easeInOutCubic",easeInQuart:"easeInQuart",easeOutQuart:"easeOutQuart",easeInOutQuart:"easeInOutQuart",easeInQuint:"easeInQuint",easeOutQuint:"easeOutQuint",easeInOutQuint:"easeInOutQuint"},TransitionEasing:{ease:"ease",linear:"linear",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out"}},EBG.INNERIFRAMEMessage={LOADED:"ebInnerIframeLoaded",INIT:"ebInitInnerIframe",VERIFY:"ebVerifyInnerIframe",EBO:"ebO",GLOBALPARAMS:"ebGlobalParams",CONTINUE_SENDING:"ContinueSending",NOT_LASTMSG:"NotLastMsg",LASTMSG:"LastMsg",ADCONFIG_REQUEST:"AdConfig_Request",SECRET_TAGS:"Secret_Tags"},EBG.FS={EB_VERSION_TRACKING_IMPRESSION:"ebversiontrackingimpression",EB_CLICKTHROUGH:"ebclickthrough",EB_CREATIVE_EVENT_SUBSCRIPTION:"ebcreativeaddhdr",EB_CI_USER_ACTION_COUNTER:"ebciuseractioncounter",EB_CI_AUTOMATIC_EVENT_COUNTER:"ebciautomaticeventcounter",EB_VIDEO_INTERACTION:"ebvideointeraction",EB_START_TIMER:"ebstarttimer",EB_END_TIMER:"ebendtimer",EB_CI_START_TIMER:"ebcistarttimer",EB_CI_STOP_TIMER:"ebcistoptimer",EB_UPDATE_TIMER:"ebupdatetimer",EB_START_VIDEO_TIMER:"ebstartvideotimer",EB_STOP_VIDEO_TIMER:"ebendvideotimer",EB_PAGE_LOAD:"ebpageload",EB_COMMAND:"ebcommand",EB_MSG:"ebmsg",EB_EXPAND_PANEL:"ebexpandpanel",EB_COLLAPSE_PANEL:"ebcollapsepanel",EB_SET_STATE:"ebsetstate",EB_RESET_STATE:"ebresetstate",EB_MOUSE_TRACKER:"ebmousetracker",EB_MOUSE_MOVE:"ebmousemove",EB_TEST_DC:"ebtestdc",EB_CLOSE_AD:"ebclosead",EB_REPLAY_AD:"ebreplayad",EB_REPLAY_EXP:"ebreplayexp",EB_LOAD_RICH_BANNER:"ebloadrichbanner",EB_SHOW_RICH_BANNER:"ebshowrichbanner",EB_INIT_VIDEO_LOADER:"ebinitvideoloader",EB_HIDE_INTRO:"ebhideintro",EB_INTRO_FULL_PLAY:"ebintrofullplay",EB_KEEP_AD_OPREN:"ebkeepadopen",EB_GO_TO_MINISITE:"ebgotominisite",EB_VIDEO_LOAD:"ebvideoload",EB_VIDEO_LOAD_AND_PLAY:"ebvideoloadandplay",EB_FULL_SCREEN_OPEN:"ebfullscreenopen",EB_FULL_SCREEN_CLOSE:"ebfullscreenclose",EB_FULL_SCREEN_AUTO_CLOSE:"ebfullscreenautoclose",EB_VIDEO_FS_OPEN:"ebvideofsopen",EB_VIDEO_FS_CLOSE:"ebvideofsclose",EB_VIDEO_FS_AUTO_CLOSE:"ebvideofsautoclose",EB_START_VIDEO:"ebtstartvideo",EB_STOP_VIDEO:"ebtstopvideo",EB_UPDATE_VIDEO_DURATION:"ebtupdatevideoduration",EB_GET_JS_VAR:"ebgetjsvar",EB_GET_ALL_JS_VARS:"ebgetalljsvars",EB_SET_JS_VAR:"ebsetjsvar",EB_INIT_SE:"ebinitse",EB_SET_SE_PROXY:"ebsetseproxy",EB_SE_EXPAND_STARTED:"ebseexpandstarted",EB_SE_RETRACT_STARTED:"ebseretractstarted",EB_SE_RETRACT_FINISHED:"ebseretractfinished",EB_NOTIFICATION:"notification",EB_VIDEO_ACTIVE_MODE:"ebvideoactivemode"},EBG.ActionType={USER:"user",AUTO:"auto"},EBG.ExpBaseInteractions={PANELS_VIEWED:"ebPanelsViewed",AUTO_SHOW:"autoshow",DURATION:"duration"},EBG.SingleExpInteractions=EBG.ExpBaseInteractions,EBG.orientation={Both:"BOTH",Landscape:"LANDSCAPE",Portrait:"PORTAIT"},EBG.adTypes={RichBannerHtml5:"Html5Banner",PoliteBannerHtml5:"Html5PoliteBanner",SEBannerHtml5:"Html5SEBanner",ExpBannerHtml5:"Html5ExpBanner",DynamicExpBannerHtml5:"Html5DynamicExpBanner",StdBanner:"StdBanner",Banner:"Banner",SingleExpBanner:"SingleExpBanner",ExpBanner:"ExpBanner",VisibilityAd:"Visibility",FloatingAd:"FloatingAd",FloatingAdWithRem:"FloatingAdWithReminder",TrackingAd:"Tracking",StdBannerHtml5:"Html5StdBanner",WallpaperAd:"WallpaperAd",Image:"Image",Html5InstreamBanner:"Html5InstreamBanner",FourthParty:"4thParty"},EBG.adParts={BANNER:"banner",PANEL:"panel",DEFAULTBANNER:"defaultBanner",RICHBANNER:"richBanner"},EBG.WindowTarget={BLANK:"_blank",SELF:"_self",PARENT:"_parent",TOP:"_top"},EBG.Const={OUTER_DIV:"eyeDiv",DATACAPTURE:"/BurstingPipe/BurstingDataCapturePipe.asp",AKAMAIFCS_PLUID_9:"rtmp://flv.stream.atwola.com/flash/flv/mm",AKAMAIFCS_PLUID_43:"rtmp://eyeblaster.fcod.msecnd.net/vod/a10061/e1",AKAMAIFCS_PLUID_42_45:"rtmp://cp57388.edgefcs.net/ondemand",AKAMAI_DEFAULT:"rtmp://cp16207.edgefcs.net/ondemand",SHOW_HIDE_FLAG:"data-ebhidingoverlappingelement",SHOW_HIDE_BACKUP:"data-ebvisibilitybackup"},EBG.PanelPositionType={PAGE_RELATIVE_PERCENTAGE:0,BANNER_RELATIVE_PIXELS:1,PAGE_RELATIVE_PIXELS:2,VIEWPORT_RELATIVE_PERCENTAGE:3,VIEWPORT_RELATIVE_PIXELS:4},EBG.PanelCorner={TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_LEFT:3,BOTTOM_RIGHT:4},EBG.AnimationType={NONE:"none",LINEAR:"linear",EASE_OUT:"easeout",EASE_OUT_SNAP:"easeoutsnap"},EBG.ExpandCollapseMethod={CLIP:"clip",RESIZE:"resize"},EBG.AnimationDefaults={easeOutCoefficient:.1,stepTime:10,linearSteps:50,snapThreshold:10,animationType:EBG.AnimationType.NONE,snap:!1,checkShowHideOnEachStep:!1,hideAssetAfterExpand:!1,removeAssetAfterExpand:!1,hideAssetAfterCollapse:!0,removeAssetAfterCollapse:!0,method:EBG.ExpandCollapseMethod.ExpBanner,endAnimationHideAsset:!1,endAnimationRemoveAsset:!1},EBG.AnimationPushDownDefaults={easeOutCoefficient:.1,stepTime:50,linearSteps:20,snapThreshold:10,animationType:EBG.AnimationType.LINEAR,snap:!1,method:EBG.ExpandCollapseMethod.RESIZE,checkShowHideOnEachStep:!1,hideAssetAfterExpand:!1,removeAssetAfterExpand:!1,hideAssetAfterCollapse:!0,removeAssetAfterCollapse:!0,method:EBG.ExpandCollapseMethod.ExpBanner,endAnimationHideAsset:!1,endAnimationRemoveAsset:!1},EBG.AnimProps={easeOutCoefficient:"easeOutCoefficient",snapThreshold:"snapThreshold",method:"method",endAnimationHideAsset:"endAnimationHideAsset",endAnimationRemoveAsset:"endAnimationRemoveAsset"},EBG.AnimDefaultProps={stepTime:"stepTime",linearSteps:"linearSteps",animationType:"animationType"},EBG.AnimNonDefaultPanelValues={animationType:EBG.AnimationType.NONE,stepTime:0,linearSteps:1},EBG.AnimExpansionProps={hideAssetAfterExpand:"hideAssetAfterExpand",removeAssetAfterExpand:"removeAssetAfterExpand"},EBG.AnimCollapseProps={hideAssetAfterCollapse:"hideAssetAfterCollapse",removeAssetAfterCollapse:"removeAssetAfterCollapse"},EBG.ProtectedElementIds=["ebAd","eyeDiv","ebDefault","ebRich","ebDiv"],EBG.VisibilityMode={DEFAULT_MODE:"defaultMode",BASIC_MODE:"basicMode",ENHANCED_MODE:"enhancedMode"},EBG.AcCertProgram={IAB_EU:0,NAI_US:1},EBG.AcIconPosition={TopRight:0,TopLeft:1,BottomRight:2,BottomLeft:3},EBG.PreloadType={DefaultImg:0,PreloadImg:1,DefaultFlash:2},EBG.ThrottleStates={LOAD:"load",THROTTLE:"throttle",RESUME:"resume",PAUSE:"pause",POLLED:"polled"},EBG.WebEnvironment={BROWSER:0,ANDROID_MOBILE_BROWESR:1,ANDROID_WEB_VIEW:2,IOS_MOBILE_BROWSER:3,IOS_WEB_VIEW:4,OTHER_MOBILE_BROWSER:5,OTHER_WEB_VIEW:6,ANDROID_UNKNOWN:97,IOS_UNKNOWN:98,UNKNOWN:99},EBG.Purposes={COOKIES:1,MEASUREMENTS:7,DEBUG:10},EBG.SDK_STATES=EBG.SDK_STATES||{},EBG.SDK_STATES.API={DEFAULT:"SDKdefault",EXPANDED:"SDKexpanded",LOADING:"SDKloading",RESIZED:"SDKresized"},EBG.SDK_EVENTS=EBG.SDK_EVENTS||{},EBG.SDK_EVENTS.API={STATE_CHANGE:"SDKstateChange",ERROR:"SDKerror",READY:"SDKready",VIEWABLE_CHANGE:"SDKviewableChange",SIZE_CHANGE:"SDKsizeChange",RESIZE_PROPS_CHANGE:"SDKresizePropsChange",EXPAND_PROPS_CHANGE:"SDKexpandPropsChange",WINDOW_SIZE_CHANGE:"windowSizeChange"},EBG.SDK_BRIDGE_EVENTS={SESSION_START:"sessionStart",GEOMETRY_CHANGE:"geometryChange"},EBG.declareNamespace("Adaptors"),EBG.Adaptors.TagNames={DIV:"div",IFRAME:"iframe",IMG:"img",SCRIPT:"script",OBJECT:"object",EMBED:"embed",SPAN:"span",A:"a",BODY:"body"},EBG.Adaptors.InjectionMethod=EBG.API.InjectionMethod,EBG.Adaptors.WindowProp={top:"top",left:"left",location:"location",menubar:"menubar",width:"width",height:"height"},EBG.Adaptors.MoreSupportedEvent={visibilitychange:1,mozvisibilitychange:1,msvisibilitychange:1,webkitvisibilitychange:1},EBG.Adaptors.StdWebAdaptor=function(){this._setEvents()},EBG.Adaptors.StdWebAdaptor._walkUpIframes=function(e,t,i,n){var a=(i=i||window).location.origin||i.location.protocol+"//"+i.location.host,s=i,r=!1,o="";n=!!n;try{if(i.location.ancestorOrigins)for(e&&e.call(s),o=0;o<i.location.ancestorOrigins.length;o++){if(0==o&&"null"==a&&(a=i.location.ancestorOrigins[0]),s=s.parent,r=!1,i.location.ancestorOrigins[o]==a)try{r=!0}catch(e){r=!1}if(r)e&&e.call(s);else{try{t&&t.call(s)}catch(e){}if(!n)break}}else for(e&&e.call(s);s!==s.parent;){s=s.parent,o=null;try{o=s.location.origin||s.location.protocol+"//"+s.location.host,"null"!=a&&"about://"!=a||(a=o)}catch(e){}if(o===a)e&&e.call(s);else{try{t&&t.call(s)}catch(e){}if(!n)break}}}catch(e){}},EBG.Adaptors.StdWebAdaptor._getTopAccessibleWindow=function(e){var t=window;return EBG.Adaptors.StdWebAdaptor._walkUpIframes(function(){t=this},null,window,!("boolean"!=typeof e||e)),t},EBG.Adaptors.StdWebAdaptor.onEnvEvent=function(){EBG.adaptor._handleEvent.apply(EBG.adaptor,arguments)},EBG.Adaptors.StdWebAdaptor.prototype={_environmentEvents:{},_logicalEvents:{},_subscribedEvents:{},_subscribedEventsOnElement:[],_listener:null,_listenerBinding:null,_loadedModules:{},walkUpIframes:EBG.Adaptors.StdWebAdaptor._walkUpIframes,getTopAccessibleWindow:EBG.Adaptors.StdWebAdaptor._getTopAccessibleWindow,initInnerModules:function(e,t,i,n,a,s){this.browser||(this.browser=new EBG.Adaptors.Browser(e,t,i,n,a,s)),this.flash||(this.flash=EBG.Adaptors.FlashDetector?new EBG.Adaptors.FlashDetector:null)},registerSpecialBrowserEvents:function(){},loadModule:function(e,t,i,n){if(!e||!t||!t.modulesDir)return!1;var a=this;t=0==e.indexOf("http")?e:t.modulesDir+e+".js",e=e.toLowerCase();var s,r=new EBG.Events.Event(EBG.Events.EventNames.MODULE_LOAD);r.dispatcher=this,r.eventData={name:e},r.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.dispatchEvent(r)||(this._loadedModules[e]?i&&this._loadedModules[e].callback.push({func:i,binding:n||window}):(this._loadedModules[e]={loading:!0,loaded:!1,scriptWin:window,callback:i?[{func:i,binding:n||window}]:[]},(s=document.createElement("script")).type="text/javascript",s.async=!0,s.readyState?s.onreadystatechange=function(){"loaded"!==s.readyState&&"complete"!==s.readyState||(s.onreadystatechange=null,a._handleModuleLoaded(e))}:s.onload=function(){a._handleModuleLoaded(e)},s.src=t,(EBG.getBigScript().parentElement||document.getElementsByTagName("html")[0]).appendChild(s),EBG.scripts=EBG.scripts||[],EBG.scripts.push(s)),this._loadedModules[e].loaded&&EBG.runTimed(this,function(){this._handleModuleLoaded(e)},[],0))},_handleModuleLoaded:function(e){var t=this._loadedModules[e];t.loading=!1,t.loaded=!0;var i=new EBG.Events.Event(EBG.Events.EventNames.MODULE_LOAD);if(i.dispatcher=this,i.eventData={name:e},i.timing=EBG.Events.EventTiming.ONTIME,!EBG.eventMgr.dispatchEvent(i)){e=t.callback.length;for(var n=0;n<e;n++){var a=t.callback.shift();a.func.apply(a.binding,[t.scriptWin])}i.timing=EBG.Events.EventTiming.AFTER,EBG.eventMgr.dispatchEvent(i)}},copy:function(e){for(var t in this._subscribedEvents)this._subscribedEvents.hasOwnProperty(t)&&(this._removeEventListener(window,this._environmentEvents[t].name,EBG.Adaptors.StdWebAdaptor.onEnvEvent),e.subscribeToEvent(t));for(t=0;t<this._subscribedEventsOnElement.length;t++){var i,n,a,s=this._subscribedEventsOnElement[t];s&&(i=s.elementId,n=s.eventName,s=s.callback,(a=this.getElementById(i))&&(this._removeEventListener(a,n,s),e.subscribeToEventOnElement(n,i,s)))}e.flash=this.flash||null},intMonitorExist:function(){return EBG.isPreview&&(top.ebHandleFsCommandsPrev||top.ebHandleEventMonitor)&&!EBG.isTestMode},notifyIntMonitor:function(e){top.ebHandleFsCommandsPrev&&top.ebHandleFsCommandsPrev(e.command,e.args,e.objName,e.adId,e.elapsedTime),top.ebHandleEventMonitor&&top.ebHandleEventMonitor({name:e.command,args:e.args,objName:e.objName,adId:e.adId,elapsedTime:e.elapsedTime})},hasEvent:function(e){return e=!!this._environmentEvents[e],EBG.log.endGroup(),e},generateElementId:function(e,t){return EBG.format("eb{0}_{1}",e,t)},_getTags:function(e,t){EBG.isGlobalDef("JSON")&&JSON.stringify(e);var i="";if(t&&e.tagName==EBG.Adaptors.TagNames.SCRIPT&&e.text&&!e.attributes)t.push(e);else{if(i="",e.attributes&&(this._setObjDefaultAttributes(e),i=this._getObjAttributesStr(e)),i=EBG.format("<{0} {1}>",e.tagName,i),e.innerHTML&&(i+=e.innerHTML),e.text&&(i+=e.text),e.params&&(i+=this._getObjParamsStr(e)),e.children)for(var n=0;n<e.children.length;n++)i+=this._getTags(e.children[n],t);i+=EBG.format("</{0}>",e.tagName)}return EBG.log.endGroup(),i},writeReportingIFrame:function(e,t,i){this.inject({tagName:EBG.Adaptors.TagNames.IFRAME,attributes:{id:e,src:t,style:{width:"0px",height:"0px"},frameborder:0}},EBG.Adaptors.InjectionMethod.APPEND,this.getElementById(i))},writeScript:function(e,t,i){try{this.inject({tagName:EBG.Adaptors.TagNames.SCRIPT,attributes:{id:e,name:e,src:t}},EBG.Adaptors.InjectionMethod.APPEND,this.getElementById(i))}catch(e){}},inject:function(e,t,i){if(i&&e){var n=i.ownerDocument,a=!1;if(EBG.isElementOrNode(e))n=e,a=!0;else if(n=n.createElement(e.tagName),e.attributes)for(var s in this._setObjDefaultAttributes(e),e.attributes)EBG.isObj(e.attributes[s])?this.setStyleToElem(n,e.attributes[s]):n.setAttribute(s,e.attributes[s]);switch(t){case EBG.Adaptors.InjectionMethod.INSERT_BEFORE:i.parentNode.insertBefore(n,i);break;case EBG.Adaptors.InjectionMethod.INSERT_AFTER:i.nextSibling?i.parentNode.insertBefore(n,i.nextSibling):i.parentNode.appendChild(n);break;case EBG.Adaptors.InjectionMethod.FIRST_CHILD:i.firstChild?i.insertBefore(n,i.firstChild):i.appendChild(n);break;default:i.appendChild(n)}if(a)return n;if(a="",e.innerHTML&&(a=e.innerHTML),s=[],e.children)for(var r=0;r<e.children.length;r++){var o=e.children[r];a+=EBG.adaptor._getTags(o,s),o.meta&&1==o.meta.isChromePowerSaver&&this._resizeAfterPaint(o.attributes.id,o.meta.origWidth,o.meta.origHeight)}for(a&&(n.innerHTML=a),e.text&&(n.text=e.text),r=0;r<s.length;r++)this.inject(s[r],t,i);return n}},addInlineDOM:function(e,t){this.inject(e,EBG.Adaptors.InjectionMethod.APPEND,this.getElementById(t))},setInnerHtml:function(e,t){e&&(e.innerHTML=t)},setStyleToElem:function(e,t,i){if(e&&"object"==typeof t)if(i){for(var n in t)if(t.hasOwnProperty(n))if(void 0===e.style[n]){i=["Webkit","Moz","ms","O"];for(var a=window.getComputedStyle?window.getComputedStyle(e,null):e.style,s=0;s<i.length;s++){var r=i[s]+EBG.capitalize(n);if(void 0!==a[r]){e.style[r]=t[n];break}}}else e.style[n]=t[n]}else for(n in t)t.hasOwnProperty(n)&&(e.style[n]=t[n])},getStyleOfElem:function(e){if(e)return e.style},setListener:function(e,t){this._listener=e,this._listenerBinding=t,EBG.log.endGroup()},hasHiddenParent:function(e){if(!e)return!1;for(var t="none"==window.getComputedStyle(e).display;(e=e.parentElement)&&!(t="none"==window.getComputedStyle(e).display););return t},subscribeToEvent:function(e,t){var i,n,a=this.getDisplayWin(),s=this.getPageWin();this.hasEvent(e)&&(this._subscribedEvents[e]||(n=(i=this._environmentEvents[e]).inCurWin?window:this.getPageWin(),t&&(n=n.document),this._logicalEvents[i.name].signInAllWindows&&this.serving&&this.serving.detectServingMode(!0)===EBG.Adaptors.ServingMode.FRIENDLY_IFRAME&&a!==s?(this._addEventListener(s,i.name,EBG.Adaptors.StdWebAdaptor.onEnvEvent),this._addEventListener(a,i.name,EBG.Adaptors.StdWebAdaptor.onEnvEvent)):this._addEventListener(n,i.name,EBG.Adaptors.StdWebAdaptor.onEnvEvent),this._subscribedEvents[e]={})),EBG.log.endGroup()},subscribeToEventOnElement:function(e,t,i){var n=!1,a="string"==typeof t?this.getElementById(t,this.getDisplayWin()):t;a||(n=!0);for(var s=this._subscribedEventsOnElement.length,r=0;r<s;r++)if(this._subscribedEventsOnElement[r]&&this._subscribedEventsOnElement[r].elementId==t&&this._subscribedEventsOnElement[r].eventName==e){n=!0;break}n||(this._addEventListener(a,e,i),this._subscribedEventsOnElement[s]={elementId:t,eventName:e,callback:i}),EBG.log.endGroup()},unsubscribeFromEventOnElement:function(e,t,i){var n="string"==typeof t?this.getDisplayWin().document.getElementById(t):t;if(n){for(var a=this._subscribedEventsOnElement.length,s=-1,r=0;r<a;r++)if(this._subscribedEventsOnElement[r]&&this._subscribedEventsOnElement[r].elementId==t&&this._subscribedEventsOnElement[r].eventName==e&&this._subscribedEventsOnElement[r].callback==i){s=r;break}0<=r&&(this._removeEventListener(n,e,i),this._subscribedEventsOnElement[s]=null)}EBG.log.endGroup()},_addEventListener:function(e,t,i){"load"==t&&this.isPageLoaded()?setTimeout(function(){i({type:"load"})},5):window.addEventListener?e.addEventListener(t,i,!1):window.attachEvent&&e.attachEvent("on"+t,i)},_removeEventListener:function(e,t,i){window.removeEventListener?e.removeEventListener(t,i,!1):window.detachEvent&&e.detachEvent("on"+t,i)},_checkIfPropExist:function(e,t){return e&&0<=e?EBG.format(", {0}={1}",t,e):""},openPage:function(e,t){var i=EBG.WindowTarget.BLANK,n="";return t&&(i=t.target,t.xPos||t.yPos||t.width||t.height)&&(n="titlebar=1,resizable=1,scrollbars=1,directories=0,toolbar=1,status=1"+this._checkIfPropExist(t.yPos,EBG.Adaptors.WindowProp.top),n+=this._checkIfPropExist(t.xPos,EBG.Adaptors.WindowProp.left),n+=this._checkIfPropExist(t.showAddressBar,EBG.Adaptors.WindowProp.location),n+=this._checkIfPropExist(t.showMenuBar,EBG.Adaptors.WindowProp.menubar),n+=this._checkIfPropExist(t.width,EBG.Adaptors.WindowProp.width),n+=this._checkIfPropExist(t.height,EBG.Adaptors.WindowProp.height)),!(t=window.open(e,i,n))&&(i=document.createElement("a"),n=((n=EBG&&EBG.getBigScript?EBG.getBigScript():null)?n.parentElement:null)||document.body)&&(i.setAttribute("id","SZMK_BRD_Anchortag"),i.setAttribute("href",e),i.setAttribute("target","_blank"),n.appendChild(i),i.click(),n.removeChild(i)),EBG.log.endGroup(),t},reportBeacon:function(e){navigator&&EBG.isFunc(navigator.sendBeacon)&&navigator.sendBeacon(e)},reportToRemoteServerUsingImage:function(){var i=[];return function(e){for(var t=0;t<i.length;t++)if(i[t]===e)return;this.ReportingImg=new Image,this.ReportingImg.src=e,i.push(e),EBG.log.endGroup()}}(),getDataFromRemoteServer:function(e,t,i,n,a){return EBG.getDataFromRemoteServer(e,t,i,n,a)},reportToRemoteServer:function(e,t,i,n){if(e&&!EBG.isOfflineDemo){var a;t=!!t,"POST"==(n=n||this.getRequestMethod(e))&&(e=(a=e.split("?"))[0],a=a[1]);var s,r=!1;try{if(this.browser.isSafari()&&"POST"==n){var o=document.createElement("iframe");o.style.display="none",o.style.width="0px",o.style.height="0px",document.body.appendChild(o),(o=o.contentWindow||o.contentDocument.document||o.contentDocument).document.open(),o.document.write(this.getIframeFormScript(e,a)),o.document.close(),r=!0}else if(EBG._isXMLHttpRequestSupported()){var d=new XMLHttpRequest;d.open(n,e,t),d.setRequestHeader("Content-type","text/plain"),!t&&this.browser.isFF()||(d.withCredentials=!0);try{d.send(a)}catch(e){if(t)throw e}r=!0}else window.XDomainRequest&&!i&&t&&((s=new XDomainRequest).open(n,e),s.send(a),r=!0)}catch(e){r=!1}r||this.reportToRemoteServerUsingImage(e),EBG.log.endGroup()}},getIframeFormScript:function(e,t){return'<script>var e=document.createElement("form"),t="'+t+'".split("&");e.setAttribute("method","post"),e.setAttribute("action","'+e+'");for(var i=0;i<t.length;++i){var a=t[i].substr(0,t[i].indexOf("=")),r=t[i].substr(t[i].indexOf("=")+1),m=document.createElement("input");m.setAttribute("type","hidden"),m.setAttribute("name",a),m.setAttribute("value",r),e.appendChild(m)}e.submit();<\/script>'},getElementById:function(e,t){var i=null;if(t=t||this.getDisplayWin(),EBG.isDefinedNotNull(e)&&!(i=t.document.getElementById(e))){t=this.findAllShadowRoots(t);for(var n=0;n<t.length&&!(i=t[n].querySelector("#"+e));n++);}return i},findAllShadowRoots:function(e){var a=[];return!this.browser.isIE()&&e&&e.document&&e.document.body&&"function"==typeof e.document.body.attachShadow&&function e(t){t=t.querySelectorAll("*");for(var i,n=0;n<t.length;n++)t[n].shadowRoot&&(i=t[n].shadowRoot,a.includes(i)||(a.push(i),e(i)))}(e.document),a},supportsPageLoadEvents:function(){return!(this.browser.isOpera()&&this.browser.getVersion()<14||this.browser.isIE()&&this.browser.getVersion()<7||EBG.isMRAID())},getHostName:function(e){return(e||this.getDisplayWin()).location.hostname},getDomain:function(e){return(e||this.getDisplayWin()).document.domain},getDisplayWin:function(){return window},getPageWin:function(){return window},getResolution:function(){var e=0;switch(window.screen.width){case 640:e=1;break;case 800:e=2;break;case 1024:e=4;break;case 1152:e=8;break;case 1280:e=16;break;case 1600:e=32;break;case 1400:e=64;break;case 1920:e=128;break;case 1680:e=256;break;case 1366:e=512;break;case 1440:e=1024;break;case 1360:e=2048;break;case 768:e=4096;break;case 1093:e=8192;break;case 960:e=16384;break;case 2560:e=32768}return e},inInnerIframe:function(){return!1},inPlacementIframe:function(){return!1},_setEvents:function(){this.supportsPageLoadEvents&&(this._setEvent(EBG.Events.EventNames.PAGE_LOAD,"load"),this._setEvent(EBG.Events.EventNames.PAGE_UNLOAD,"unload",!0),this._setEvent(EBG.Events.EventNames.PAGE_BEFORE_UNLOAD,"beforeunload",!0),this._setEvent(EBG.Events.EventNames.PAGE_HIDE,"pagehide",!0)),this._setEvent(EBG.Events.EventNames.PAGE_RESIZE,"resize"),this._setEvent(EBG.Events.EventNames.SCREEN_ORIENTATION,"orientationchange"),this._setEvent(EBG.Events.EventNames.MOUSE_MOVE,"mousemove",!1,["clientX","clientY","pageX","pageY","view"],!0)},_setEvent:function(e,t,i,n,a){if(this._environmentEvents[e]={name:t,inCurWin:i||!1},this._logicalEvents[t]={name:e,signInAllWindows:a},n)for(this._logicalEvents[t].attr=[],e=0;e<n.length;e++)this._logicalEvents[t].attr[e]=n[e]},isPageLoaded:function(){return!!this._isPageLoaded||(this._isPageLoaded=EBGInfra.isDefined(window.gEBMainWindow)&&EBGInfra.isDefined(gEBMainWindow.EBP)&&gEBMainWindow.EBP.isPageLoaded,!this._isPageLoaded&&this.getPageWin().document.readyState&&(this._isPageLoaded="complete"==this.getPageWin().document.readyState),EBG.adaptor._isPageLoaded,EBG.adaptor._isPageLoaded)},_handleEvent:function(e){var t,i=this._logicalEvents[e.type].name;switch(i){case EBG.Events.EventNames.PAGE_LOAD:this._isPageLoaded=!0;break;case EBG.Events.EventNames.PAGE_RESIZE:EBG.adaptor.inInnerIframe()&&this.serving.rehidePlacementIframe();break;case EBG.Events.EventNames.SCREEN_ORIENTATION:return this._handleOrientationEvent(),void EBG.log.endGroup();case EBG.Events.EventNames.DEVICE_MOTION:return this._handleDeviceMotionEvent(e),void EBG.log.endGroup();case EBG.Events.EventNames.DEVICE_ORIENTATION:return this._handleDeviceOrientationEvent(e),void EBG.log.endGroup();case EBG.Events.EventNames.PAGE_BEFORE_UNLOAD:if(this.browser.isIE()&&this._isPageLoaded)return void EBG.log.endGroup()}i&&(t=new EBG.Events.Event(i),EBGInfra.isDefinedNotNull(this._logicalEvents[e.type].attr)&&this._prepareLogicalEventData(t,e,this._logicalEvents[e.type].attr),EBG.isFunc(this._listener)&&this._listener.call(this._listenerBinding,t)),i==EBG.Events.EventNames.PAGE_UNLOAD&&this.dispose(),EBG.log.endGroup()},dispose:function(){for(var e in this._subscribedEvents){var t;this._subscribedEvents.hasOwnProperty(e)&&(t=this._environmentEvents[e].name,e=this._environmentEvents[e].inCurWin?window:this.getPageWin(),this._removeEventListener(e,t,EBG.Adaptors.StdWebAdaptor.onEnvEvent),this._logicalEvents[t].signInAllWindows&&(e=e==this.getPageWin()?this.getDisplayWin():this.getPageWin(),this._removeEventListener(e,t,EBG.Adaptors.StdWebAdaptor.onEnvEvent)))}try{EBG.adaptor._removeEventListener(EBG.adaptor.getPageWin(),"focus",EBG.adaptor._updateFocused),EBG.adaptor.browser.getVersion()<10&&EBG.adaptor._removeEventListener(EBG.adaptor.getPageWin().document,"focusin",EBG.adaptor._updateFocused)}catch(e){}this._removeEventListener(this.getDisplayWin(),"resize",EBG.adaptor.updateScrollBarWidth)},_handleOrientationEvent:function(){},_handleDeviceMotionEvent:function(){},_handleDeviceOrientationEvent:function(){},_prepareLogicalEventData:function(e,t,i){try{e.eventData={};for(var n=0;n<i.length;n++)e.eventData[i[n]]=t[i[n]]}catch(e){}},_getDefaultAttributes:function(e){var t={};return e.toLowerCase()===EBG.Adaptors.TagNames.IFRAME&&(t={marginheight:"0px",marginwidth:"0px",frameborder:"0",scrolling:"no"},this.browser.isChrome()&&(t.allow="autoplay")),t},_getDefaultStyle:function(e){var t={border:"0px",padding:"0px",margin:"0px"};return e.toLowerCase()===EBG.Adaptors.TagNames.DIV&&EBG.mergeObj({top:"0px",left:"0px",overflow:"visible",fontSize:"0px",lineHeight:"0px",textAlign:"left"},t,!0),t},_setObjDefaultAttributes:function(e){var t=this._getDefaultAttributes(e.tagName);EBG.mergeObj(e.attributes,t,!0),t.style=this._getDefaultStyle(e.tagName),e.attributes.style&&EBG.mergeObj(e.attributes.style,t.style,!0),e.attributes=t},_getObjParamsStr:function(e){var t,i="";for(t in e=e.params)e.hasOwnProperty(t)&&(i+=EBG.format("<PARAM name='{0}' value='{1}'>",t,e[t]));return i},_getObjAttributesStr:function(e){var t,i="";for(t in e=e.attributes)if(e.hasOwnProperty(t)){var n=e[t];if(EBG.isObj(n)){var a,s,r=n,n="";for(a in r)r.hasOwnProperty(a)&&(s=r[a],"textAlign"==a&&(a="text-align"),n+=EBG.format("{0}:{1}; ",a,s))}if(n)try{n=n.toString().replace(/"/gi,"&quot;"),i+=EBG.format(' {0}="{1}"',t,n)}catch(e){}}return i},_resizeAfterPaint:function(t,i,n){i&&n&&EBG.runTimed(this,function(){var e=this.getElementById(t);this.setElemStyle(e,"width",i),this.setElemStyle(e,"height",n)},[],50)},handleEvent:function(e){this._handleEvent(e)},setElemStyle:function(e,t,i){e&&t&&i&&(e.style[t]=i)},getPositioningById:function(e,t,i){return e=this.getElementById(e),this.getPositioningByElement(e,t,i)},getPositioningByElement:function(e,t,i){return(e=e&&e.getBoundingClientRect?e.getBoundingClientRect():null)?(t=this.getScrollLeftTop(t,i),{X:Math.floor(e.left)+t.X,Y:Math.floor(e.top)+t.Y}):null},getScrollLeftTop:function(e,t){t=(e=this._getCurrentWindow(e,t)).document;var i,n={X:{0:"XOffset",1:"Left"},Y:{0:"YOffset",1:"Top"}};for(i in n)n[i]=e["page"+n[i][0]]||(t.documentElement?t.documentElement["scroll"+n[i][1]]:t.documentElement["page"+n[i][0]])||(t.body?t.body["scroll"+n[i][1]]:0);return n},_getCurrentWindow:function(e,t){try{var i=e?this.getDisplayWin():top;return EBG.log.endGroup(),i}catch(e){EBG.log.endGroup()}},getRequestMethod:function(e){return!(this.browser.isIE()&&6==this.browser.getVersion()||this.isInApp())&&2e3<e.length?"POST":"GET"},removeElement:function(e){var t;"string"==EBG.typeOf(e)?t=this.getElementById(e):EBG.isElementOrNode(e)&&(t=e),t&&(t.parentNode.removeChild(t),t.removeNode&&t.removeNode(!0))},getBrowserLanguage:function(){var e="en-US";return void 0!==navigator.language?e=navigator.language:void 0!==navigator.userLanguage&&(e=navigator.userLanguage),EBG.log.endGroup(),e},appendChildElement:function(e,t){e&&t&&this.getElementById(e).appendChild(t)},getMaxZIndex:function(e){if(this.browser.isIE()&&this.browser.getVersion()<8)return 10001;var t=0;if(e){var i,n=this.getStyleOfElem(e);for(i in n&&n.zIndex&&(t=n.zIndex),e.childNodes)i&&e.childNodes[i]&&(n=this.getMaxZIndex(e.childNodes[i]),t=n<t?t:n)}return t},isSafeFrame:function(){return!(!window.$sf||!$sf.ext)},isInApp:function(){return!!window.mraid},isSkype:function(){try{return!!(window.$WLXRmAd||!window.location.ancestorOrigins&&window.parent&&window.parent.$WLXRmAd)}catch(e){return!1}},isAMP:function(){var e=!1;return doIfAccessible=function(){e=e||!(!this.context||!this.context.reportRenderedEntityIdentifier)},this.walkUpIframes(doIfAccessible),e},isReady:function(){return!0},hasLayoutViewport:function(){return document.documentElement.clientWidth>window.innerWidth},getBoundingClientRect:function(e,t){if(!e||e.id&&!this.getElementById(e.id))return null;t=t||{};var i,n,a,s,r=e.getBoundingClientRect();if((r={width:Math.round(r.width),height:Math.round(r.height),top:Math.round(r.top),left:Math.round(r.left),bottom:Math.round(r.bottom),right:Math.round(r.right)}).width=EBG.isNumber(r.width)?r.width:r.right-r.left,r.height=EBG.isNumber(r.height)?r.height:r.bottom-r.top,this.browser.isAndroid()&&this.hasLayoutViewport()&&(r.top-=window.pageYOffset,r.left-=window.pageXOffset,r.bottom-=window.pageYOffset,r.right-=window.pageXOffset),t.clip)try{var o,d=this.getComputedStyle(e).getPropertyValue("clip"),E=/rect\((.*?)px(.*?)px(.*?)px(.*?)px\)/g.exec(d);if(E){for(d=1;d<E.length;d++)E[d]=parseFloat(E[d].replace(",",""));0!=E[1]+E[2]+E[3]+E[4]&&((o={top:r.top+E[1],left:r.left+E[4]}).right=Math.min(o.left+(E[2]-E[4]),r.right),o.bottom=Math.min(o.top+(E[3]-E[1]),r.bottom),o.width=o.right-o.left,o.height=o.bottom-o.top,r=o)}}catch(e){}return t.relativeToTop&&(n=i=0,E=this.getElementWindow(e),s=a=1,EBG.adaptor.walkUpIframes(function(){var e;this.frameElement&&(e=this.frameElement.getBoundingClientRect(),a*=e.width/this.innerWidth,s*=e.height/this.innerHeight,i+=e.top,n+=e.left)},null,E),r.top+=i,r.left+=n,r.bottom+=i,r.right+=n,r.width*=a,r.height*=s,r.left*=a,r.right*=a,r.top*=s,r.bottom*=s),t.relativeToWindow&&(e=(E=this.getElementWindow(e)).pageXOffset||E.document.documentElement.scrollLeft,t=E.pageYOffset||E.document.documentElement.scrollTop,r.top+=t,r.left+=e,r.bottom+=t,r.right+=e),r},getElementWindow:function(e){return e?(e=e.ownerDocument).defaultView||e.parentWindow||window:null},getComputedStyle:window.getComputedStyle?function(e,t){return(this.getElementWindow(e)||window).getComputedStyle(e,t)}:function(i,e){return(e={}).el=i,e.getPropertyValue=function(e){var t=/(\-([a-z]){1})/g;return t.test(e="float"==e?"styleFloat":e)&&(e=e.replace(t,function(e,t,i){return i.toUpperCase()})),i.currentStyle[e]||i.style[e]||null},e},createImageElement:function(e){var t=document.createElement("img");if(!e)return t;if(e=e.attributes){var i,n=e.style;for(i in n&&EBG.mergeObj({border:"0px",padding:"0px",margin:"0px"},n,!0),e)if(e.hasOwnProperty(i))if("style"==i){var a,s="";for(a in n)n.hasOwnProperty(a)&&(s+=EBG.format("{0}:{1}; ",a,n[a]));t.style.cssText+=s}else t.setAttribute(i,e[i])}return t},isPageVisible:function(e){var t,i;return this.isAMP()?i=EBG.AMPUtil&&EBG.AMPUtil._AMPObj:!(i=!(t=this._getVisibilityEventHidden())||!document[t])||!this.browser.isIE()||t&&"msHidden"!=t||this.serving.detectServingMode(!0)==EBG.Adaptors.ServingMode.IFRAME||(i=i&&(this.focused||e)),i},_getVisibilityEventHidden:function(){var e=null;return void 0!==document.hidden?e="hidden":void 0!==document.mozHidden?e="mozHidden":void 0!==document.msHidden?e="msHidden":void 0!==document.webkitHidden&&(e="webkitHidden"),e},getObjKeys:function(e){if(e=e||{},Object.keys)return Object.keys(e);var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push(t);return i},hasParentElement:function(e,t){for(e=EBG.isElementOrNode(e)?e:this.getElementById(e),t=EBG.isElementOrNode(t)?t:this.getElementById(t);e&&e.parentElement;){if(e.parentElement===t)return!0;e=e.parentElement}return!1},headlessTests:function(){var g,p;return function(h,e){function u(e){g=0===e.movementX&&0===e.movementY?1:0}var t;navigator.permissions?navigator.permissions.query({name:"notifications"}).then(function(e){p=~~("denied"===Notification.permission&&"prompt"===e.state?1:0)}):p="undefined",t=EBG.adaptor.getDisplayWin().document.getElementsByTagName("body")[0],g=t&&t.addEventListener&&null!==e&&(e==EBG.Adaptors.ServingMode.SCRIPT||e==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME||e==EBG.Adaptors.ServingMode.TOPMOST_FRIENDLY_IFRAME)?(t.addEventListener("mousemove",u),1):"undefined",setTimeout(function(){(e=EBG.adaptor.getDisplayWin().document.getElementsByTagName("body")[0])&&e.removeEventListener&&e.removeEventListener("mousemove",u);var e=~~/headless/i.test(window.navigator.userAgent),t=~~navigator.webdriver,i=EBG.adaptor.browser.isChrome()?~~!window.chrome:"undefined",n=EBG.adaptor.browser.isMobile()?"undefined":~~(navigator.plugins&&0===navigator.plugins.length),a=window.PluginArray&&navigator.plugins?(a=PluginArray.prototype===navigator.plugins.__proto__,0<navigator.plugins.length&&(a&=Plugin.prototype===navigator.plugins[0].__proto__),a?0:1):"undefined",s=0===(navigator.mimeTypes&&navigator.mimeTypes.length)?1:0,r=window.MimeTypeArray&&navigator.mimeTypes?(r=MimeTypeArray.prototype===navigator.mimeTypes.__proto__,0<navigator.mimeTypes.length&&(r&=MimeType.prototype===navigator.mimeTypes[0].__proto__),r?0:1):"undefined",o=~~!navigator.language||navigator.languages&&0===navigator.languages.length?1:0,d=function(){if(!document.createElement("canvas").getContext)return"undefined";if(e=document.createElement("canvas").getContext("webgl")){var e,t=e.getExtension("WEBGL_debug_renderer_info");return e.getParameter(t.UNMASKED_VENDOR_WEBGL)+"|"+(e=e.getParameter(t.UNMASKED_RENDERER_WEBGL))}return"undefined"}(),E=p,l=0===(l=EBG.adaptor.getDisplayWin()).outerHeight&&0===l.outerWidth?1:0,c=navigator.connection?navigator.connection.rtt:void 0;e={h_ua:e,h_webdrv:t,h_ischrm:i,h_noplgin:n,h_plgpro:a,h_nomime:s,h_mimepro:r,h_nolang:o,h_wgl:d,h_pd:E,h_ow:l,h_crtt:void 0===c?"undefined":0===c?1:0,h_mm:g},EBG.DataPipeManager&&EBG.dataPipeMgr.getPipe(h).send(EBG.DataProfile.DEBUG,e)},1e3)}}()},EBG.declareClass(EBG.Adaptors.StdWebAdaptor,null),EBG.Adaptors.WebAdaptor=function(){EBG.callSuperConstructor(EBG.Adaptors.WebAdaptor,this),EBG.adaptor&&!ebO.ffs.CFF_assignNewAdapter&&EBG.adaptor.copy(this),EBG.log.endGroup()},EBG.Adaptors.WebAdaptor.prototype={_previousWidth:-1,_previousHeight:-1,_screenOrientation:"",scrollBarWidth:0,_isReady:!1,focused:!1,_loadedModules:[],_init:function(){this._sendReady()},isReady:function(){return this._isReady},isSDKDefined:function(){return!1},_addEventListener:function(e,t,i){EBG.callSuperFunction(EBG.Adaptors.WebAdaptor,this,"_addEventListener",[e,t,i]),!this.browser.isChrome()||this.serving.detectServingMode(!0)!==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME||"beforeunload"!=t&&"unload"!=t||top.addEventListener(t,i,!1)},_removeEventListener:function(e,t,i){EBG.callSuperFunction(EBG.Adaptors.WebAdaptor,this,"_removeEventListener",[e,t,i]),!this.browser.isChrome()||this.serving.detectServingMode(!0)!==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME||"beforeunload"!=t&&"unload"!=t||top.removeEventListener(t,i,!1)},updateScrollBarWidth:function(){ebO.ffs.CFF_assignNewAdapter?this.scrollBarWidth=this.getScrollerWidth():EBG.adaptor.scrollBarWidth=EBG.adaptor.getScrollerWidth()},initInnerModules:function(e,t,i,n,a,s){EBG.callSuperFunction(EBG.Adaptors.WebAdaptor,this,"initInnerModules",[e,t,i,n,a,s]),this.updateScrollBarWidth(),this.serving||(this.serving=EBG.Adaptors.ServingMgr?new EBG.Adaptors.ServingMgr:null),ebO.ffs.CFF_assignNewAdapter?this._addEventListener(this.getDisplayWin(),"resize",this.updateScrollBarWidth.bind(this)):this._addEventListener(this.getDisplayWin(),"resize",EBG.adaptor.updateScrollBarWidth)},_pageResizeHandler:function(e){this._handleOrientationEvent()},_handleOrientationEvent:function(){this._checkOrientationEvent(),EBG.runTimed(this,this._checkOrientationEvent,[],300)},_checkOrientationEvent:function(){var e;this.browser.isMobile()&&this._isOrientationChange()&&(this._setScreenOrientation(),(e=new EBG.Events.Event(EBG.Events.EventNames.SCREEN_ORIENTATION)).dispatcher=this,e.eventData={screenOrientation:this._screenOrientation},EBG.eventMgr.dispatchEvent(e))},_handleDeviceMotionEvent:function(e){function t(e){var t,i={};for(t in e)i[t]=e[t];return i}var i=new EBG.Events.Event(EBG.Events.EventNames.DEVICE_MOTION);i.dispatcher=this,i.eventData={acceleration:t(e.acceleration),accelerationIncludingGravity:t(e.accelerationIncludingGravity),rotationRate:t(e.rotationRate),timeStamp:e.timeStamp},EBG.eventMgr.dispatchEvent(i)},_handleDeviceOrientationEvent:function(e){var t=new EBG.Events.Event(EBG.Events.EventNames.DEVICE_ORIENTATION);t.dispatcher=this,t.eventData={absolute:e.absolute,alpha:e.alpha,beta:e.beta,gamma:e.gamma},EBG.eventMgr.dispatchEvent(t)},registerSpecialBrowserEvents:function(){this.browser.isIE()&&(this._addEventListener(this.getPageWin(),"focus",this._updateFocused),this.browser.getVersion()<10&&(this._addEventListener(this.getPageWin().document,"focusout",this._updateFocusOut),this._addEventListener(this.getPageWin().document,"focusin",this._updateFocused)),this.focused=this.focused||"undefined"!=typeof gEBMainWindow&&void 0!==gEBMainWindow.EBP&&gEBMainWindow.EBP.focused),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_RESIZE,this._pageResizeHandler,this)),this._updateInitialOrientationValues()},_updateInitialOrientationValues:function(){var e;this.browser.isMobile()&&(e=ebO.ffs.CFF_assignNewAdapter?this.serving._getTopFriendlyIframe(this.getDisplayWin()):EBG.adaptor.serving._getTopFriendlyIframe(EBG.adaptor.getDisplayWin()),this._setScreenOrientation(e))},_updateFocusOut:function(){EBG.runTimed(EBG.adaptor,function(){var e;EBG.adaptor.getPageWin().screenTop>-2*EBG.adaptor.getPageWin().screen.availHeight||((e=new EBG.Events.Event(EBG.Events.EventNames.PAGE_HIDDEN)).dispatcher=EBG.adaptor,EBG.eventMgr.dispatchEvent(e))},[],50)},_updateFocused:function(){EBG.adaptor.focused=!0;var e=new EBG.Events.Event(EBG.Events.EventNames.PAGE_VISIBLE);e.dispatcher=EBG.adaptor,EBG.eventMgr.dispatchEvent(e);try{EBG.adaptor._removeEventListener(EBG.adaptor.getPageWin(),"focus",EBG.adaptor._updateFocused),EBG.adaptor.browser.getVersion()<10&&EBG.adaptor._removeEventListener(EBG.adaptor.getPageWin().document,"focusin",EBG.adaptor._updateFocused)}catch(e){}},_setEvents:function(){EBG.callSuperFunction(EBG.Adaptors.WebAdaptor,this,"_setEvents",[]),this._setEvent(EBG.Events.EventNames.PAGE_SCROLL,"scroll"),this._setEvent(EBG.Events.EventNames.PAGE_FOCUS,"focus"),this._setEvent(EBG.Events.EventNames.PAGE_BLUR,"blur");var e=this._getVisibilityEventName();void 0!==document.addEventListener&&void 0!==e&&(this._setEvent(EBG.Events.EventNames.PAGE_HIDDEN,e,!0),this._setEvent(EBG.Events.EventNames.PAGE_VISIBLE,e,!0)),this._setEvent(EBG.Events.EventNames.DEVICE_MOTION,"devicemotion",!1,["acceleration","accelerationIncludingGravity","rotationRate","timeStamp"],!0),this._setEvent(EBG.Events.EventNames.DEVICE_ORIENTATION,"deviceorientation",!1,["absolute","alpha","beta","gamma"],!0)},initServingMode:function(e,t,i){switch(t=t||!1,e){case EBG.Adaptors.ServingMode.INNER_IFRAME:this.serving.setServingMode(EBG.Adaptors.ServingMode.INNER_IFRAME);break;case-1:this.serving.detectServingMode(!1);break;case 0:(!EBG.isPreview||EBG.isPreview&&EBG.isTestMode)&&i==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME&&!t?this.serving.setServingMode(EBG.Adaptors.ServingMode.FRIENDLY_IFRAME):EBG.isPreview||i!=EBG.Adaptors.ServingMode.IFRAME||t?t&&this.serving.setServingMode(EBG.Adaptors.ServingMode.SCRIPT):this.serving.setServingMode(EBG.Adaptors.ServingMode.TOPMOST_FRIENDLY_IFRAME);break;case 1:case 2:this.serving.setServingMode(EBG.Adaptors.ServingMode.IFRAME)}EBG.log.endGroup()},addPlaceHolder:function(e){this.inInnerIframe()&&(this.inject(e,EBG.Adaptors.InjectionMethod.INSERT_BEFORE,this.serving.placementIframe),this.serving.hidePlacementIframe())},getPageWin:function(){return this.serving&&this.serving.pageWin?this.serving.pageWin:window},getDisplayWin:function(){return this.serving&&this.serving.displayWin?this.serving.displayWin:window},_getDocument:function(){return this.getDisplayWin().document},inInnerIframe:function(){return this.serving&&this.serving.placementIframe},inPlacementIframe:function(){return this.serving&&this.serving.servingMode===EBG.Adaptors.ServingMode.IFRAME},setElemAttribute:function(e,t,i){e[t]=i},getClipTag:function(e,t,i,n){return EBG.format("rect({0}px {1}px {2}px {3}px)",e,t,i,n)},clipIframeParent:function(){return!(!EBG.adaptor.browser.isChrome()&&!EBG.adaptor.browser.isSafari())},clip:function(e,t,i,n,a){e.style.clip=this.getClipTag(t,i,n,a),EBG.log.endGroup()},unclip:function(e){e.style.clip="rect(auto auto auto auto)",EBG.log.endGroup()},expand:function(e,t){e.id,JSON.stringify(t),this.setElemStyle(e,"left",EBG.px(-t.x)),this.setElemStyle(e,"top",EBG.px(-t.y)),this.setElemStyle(e,"width",EBG.px(t.width)),this.setElemStyle(e,"height",EBG.px(t.height)),this.unclip(e),EBG.log.endGroup()},collapse:function(e,t,i){e.id,JSON.stringify(t),JSON.stringify(i),t=this.getClipParams(t,i),this.clip(e,t.top,t.right,t.bottom,t.left),EBG.log.endGroup()},resize:function(e,t,i){this.setElemStyle(e,"width",EBG.px(t)),this.setElemStyle(e,"height",EBG.px(i))},getClipParams:function(e,t){return{top:e.y,right:e.x+t.width,bottom:e.y+t.height,left:e.x}},getCurrentStyleAttr:function(e,t){var i=null;try{i=e.currentStyle?e.currentStyle[t]:e.ownerDocument.defaultView.getComputedStyle(e,null).getPropertyValue(t)}catch(e){}return!i&&"embed"==e.tagName.toLowerCase()&&e.parentNode&&"object"==e.parentNode.tagName.toLowerCase()&&(i=(e=e.parentNode).currentStyle?e.currentStyle[t]:e.ownerDocument.defaultView.getComputedStyle(e,null).getPropertyValue(t)),EBG.log.endGroup(),i},getViewPortMetrics:function(e,t,i){return this.getWindowViewPortMetrics()},getWindowViewPortMetrics:function(e){try{var t,i=(e=e||this.getDisplayWin()).document,n={Height:0,Width:0},a=i.documentMode;this.serving.servingMode==EBG.Adaptors.ServingMode.INNER_IFRAME&&this.updateScrollBarWidth(),!this.browser.isIE()||5!=a&&this.browser.isStrictType(i)?this.browser.isIE()||window.ebO&&ebO.ffs&&ebO.ffs.CFF_MobCSSPixels&&this.canHaveLayoutViewport()?(n.Width=i.documentElement.clientWidth,n.Height=i.documentElement.clientHeight):(n.Width=e.innerWidth,n.Height=e.innerHeight,"hidden"!=i.body.style.overflow&&((i.body.offsetWidth>n.Width||i.body.scrollWidth>n.Width||0<e.scrollMaxX)&&(n.Height-=this.scrollBarWidth),t=i.body.scrollHeight||i.documentElement.scrollHeight,(i.body.offsetHeight>n.Height||t>n.Height||0<e.scrollMaxY)&&(n.Width-=this.scrollBarWidth))):(n.Width=i.body.clientWidth,n.Height=i.body.clientHeight),EBG.log.endGroup()}catch(e){EBG.log.endGroup()}return n},getPageMetrics:function(e){try{var t=(e||this.getDisplayWin()).document;return(e={Height:0,Width:0}).Height=Math.max(t.body.scrollHeight,t.documentElement.scrollHeight,t.body.offsetHeight,t.documentElement.offsetHeight,t.body.clientHeight,t.documentElement.clientHeight),e.Width=Math.max(t.body.scrollWidth,t.documentElement.scrollWidth,t.body.offsetWidth,t.documentElement.offsetWidth,t.body.clientWidth,t.documentElement.clientWidth),EBG.log.endGroup(),e}catch(e){}EBG.log.endGroup()},saveInitialScrollBarState:function(e){e.EBG=e.EBG||{};var t=e.document;e.EBG._scrollBarsInitialState=null!=e.EBG._scrollBarsInitialState?e.EBG._scrollBarsInitialState:t.body.style.overflow},showScrollBars:function(e){e=e||this.getDisplayWin(),this.saveInitialScrollBarState(e),e.document.body.style.overflow="auto"},hideScrollBars:function(e){e=e||this.getDisplayWin(),this.saveInitialScrollBarState(e),e.document.body.style.overflow="hidden"},restoreScrollBarsState:function(e){var t=(e=e||this.getDisplayWin()).document;null!=e.EBG._scrollBarsInitialState&&(t.body.style.overflow=e.EBG._scrollBarsInitialState)},_getCurrentWindow:function(e,t){try{var i=(e=this.serving.servingMode==EBG.Adaptors.ServingMode.INNER_IFRAME||t==EBG.Adaptors.ServingMode.IFRAME&&this.browser.isFF()?!0:e)?this.getDisplayWin():top;return EBG.log.endGroup(),i}catch(e){EBG.log.endGroup()}},getPositioningById:function(e,t,i,n){return t=this.serving.servingMode==EBG.Adaptors.ServingMode.INNER_IFRAME||t,e=this.getElementById(e),this.getPositioningByElement(e,t,i,n)},getIframePosition:function(){var e={X:0,Y:0};return EBG.adaptor.serving.detectServingMode(!0)==EBG.Adaptors.ServingMode.IFRAME&&void 0!==this.getDisplayWin().mozInnerScreenX&&(e.X=this.getDisplayWin().mozInnerScreenX,e.Y=this.getDisplayWin().mozInnerScreenY),e},getPositioningByElement:function(e,t,i,n){if(!e)return null;t=!(this.serving.servingMode!=EBG.Adaptors.ServingMode.INNER_IFRAME&&!EBG.isPreview)||t;var a=e.getBoundingClientRect?e.getBoundingClientRect():null;return a?(e=Math.round(a.left),a=Math.round(a.top),EBG.isDefined(n)&&n||(t=this.getScrollLeftTop(t,i))&&(e+=t.X,a+=t.Y),{X:e,Y:a}):null},getScrollLeftTop:function(e,t){return e=t==EBG.Adaptors.ServingMode.IFRAME||e,EBG.callSuperFunction(EBG.Adaptors.WebAdaptor,this,"getScrollLeftTop",[e,t])},getBodyPositioning:function(e){var t=this.getDisplayWin(),i=this.isCurrWin();return e=!(e=EBG.adaptor.getPositioningByElement(t.document.body,!i,e))?{X:0,Y:0}:e},isCurrWin:function(){return this.getDisplayWin()===this.getPageWin()},getScrollerWidth:function(){try{if(ebO.ffs.CFF_assignNewAdapter){if(this.browser._platform==this.browser._platformTypes.IPAD||this.browser._platform==this.browser._platformTypes.IPHONE)return EBG.log.endGroup(),0;var e=this.getDisplayWin().document}else{if(EBG.adaptor.browser._platform==EBG.adaptor.browser._platformTypes.IPAD||EBG.adaptor.browser._platform==EBG.adaptor.browser._platformTypes.IPHONE)return EBG.log.endGroup(),0;e=EBG.adaptor.getDisplayWin().document}var t,i,n,a=null,s=null;return(a=e.createElement("div")).style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.style.width="100px",a.style.height="50px",a.style.overflow="auto",(s=e.createElement("div")).style.width="100%",s.style.height="200px",a.appendChild(s),e.body.appendChild(a),i=s.offsetWidth,e.body.removeChild(e.body.lastChild),a.style.overflow="hidden",e.body.appendChild(a),t=s.offsetWidth,e.body.removeChild(e.body.lastChild),n=t-i||0,EBG.log.endGroup(),n}catch(e){EBG.log.endGroup()}},canHaveLayoutViewport:function(){var e=EBG.adaptor.getDisplayWin().document.head.getElementsByTagName("meta"),t=EBG.adaptor.browser.isMobile();if(t){for(var i=0;i<e.length;i++)"viewport"===e[i].name&&(n=e[i]);if(n)for(e=n.content.split(","),i=0;i<e.length;i++){var n=e[i].split("=")[0].trim&&e[i].split("=")[0].trim(),a=e[i].split("=")[1]&&e[i].split("=")[1].trim&&e[i].split("=")[1].trim();"user-scalable"==n&&"0"==a&&(t=!1)}}return t},_handleEvent:function(e){var t,i=this._logicalEvents[e.type].name;switch(i){case EBG.Events.EventNames.PAGE_HIDDEN:case EBG.Events.EventNames.PAGE_VISIBLE:i=this.isPageVisible()?EBG.Events.EventNames.PAGE_VISIBLE:EBG.Events.EventNames.PAGE_HIDDEN;break;default:return EBG.callSuperFunction(EBG.Adaptors.WebAdaptor,this,"_handleEvent",[e]),void EBG.log.endGroup()}i&&(t=new EBG.Events.Event(i),EBGInfra.isDefinedNotNull(this._logicalEvents[e.type].attr)&&this._prepareLogicalEventData(t,this._logicalEvents[e.type].eventData,this._logicalEvents[e.type].attr),EBG.isFunc(this._listener)&&this._listener.call(this._listenerBinding,t)),i==EBG.Events.EventNames.PAGE_UNLOAD&&this.dispose(),EBG.log.endGroup()},_isOrientationChange:function(){var e=EBG.adaptor.serving._getTopFriendlyIframe(EBG.adaptor.getDisplayWin());return(e.innerWidth!==this._previousWidth||e.innerHeight!=this._previousHeight)&&this._screenOrientation!==(e.innerHeight>=e.innerWidth?EBG.Events.EventNames.PORTRAIT:EBG.Events.EventNames.LANDSCAPE)},_setScreenOrientation:function(e){e=e||EBG.adaptor.serving._getTopFriendlyIframe(EBG.adaptor.getDisplayWin()),this._screenOrientation=e.innerHeight>=e.innerWidth?EBG.Events.EventNames.PORTRAIT:EBG.Events.EventNames.LANDSCAPE,this._previousWidth=e.innerWidth,this._previousHeight=e.innerHeight},getScreenOrientation:function(e){return"boolean"==typeof e&&!e||this._setScreenOrientation(),this._screenOrientation},_sendReady:function(){this._isReady=!0;var e=new EBG.Events.Event(EBG.EBMessage.ADAPTOR_READY);e.dispatcher=this,e.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.dispatchEvent(e)||(e.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.dispatchEvent(e))},getMouseCoordinates:function(e){var t={mouseX:0,mouseY:0};return e&&(EBG.adaptor.browser.isIE()?(t.mouseX=e.clientX||0,t.mouseY=e.clientY||0):(t.mouseX=e.pageX||0,t.mouseY=e.pageY||0),t.view=e.view),t},_getVisibilityEventName:function(){var e=null;return this.isAMP()&&EBG.AMPUtil&&void 0!==EBG.AMPUtil._AMPObj?e="amp:visibilitychange":void 0!==document.hidden?e="visibilitychange":void 0!==document.mozHidden?e="mozvisibilitychange":void 0!==document.msHidden?e="msvisibilitychange":void 0!==document.webkitHidden&&(e="webkitvisibilitychange"),e}},EBG.declareClass(EBG.Adaptors.WebAdaptor,EBG.Adaptors.StdWebAdaptor),EBG.Adaptors=EBG.Adaptors||{},EBG.Adaptors.Browser=function(e,t,i,n,a,s){this.set(e,t,i,n,a,s)},EBG.Adaptors.Browser.prototype={_platform:0,_browserType:0,_browserVer:0,_browserCode:0,_deviceType:0,_browserTypes:EBG.API.BrowserTypes,_platformTypes:EBG.API.PlatformTypes,_deviceTypes:EBG.API.DeviceTypes,_browserInApp:0,set:function(e,t,i,n,a,s){e=e||this._platformTypes.NON_SUPPORTED,t=t||this._browserTypes.NON_SUPPORTED,i=i||0,n=n||0,a=a||this._browserTypes.NON_SUPPORTED,s=s||0,this._platformTypes,this._platform=e,this._browserTypes,this._browserType=t,this._browserVer=i,this._browserCode=a,this._deviceType=n,this._browserInApp=s},getVersion:function(){return this._browserVer},getDocumentMode:function(){return window.document.documentMode},isIE:function(){return this._browserType==this._browserTypes.IE||this._browserType==this._browserTypes.AOL},isEdge:function(){return this._browserType==this._browserTypes.EDGE},isStrictType:function(e){var t=!1;return t=this.isIE()?e?"CSS1Compat"==e.compatMode:"CSS1Compat"==document.compatMode:t},isFF:function(){return this._browserType==this._browserTypes.FF},isSafari:function(){return this._browserType==this._browserTypes.SAFARI},isChrome:function(){return this._browserType==this._browserTypes.CHROME},isOpera:function(){return this._browserType==this._browserTypes.OPERA},isMac:function(){return this._platform==this._platformTypes.MAC||this._platform==this._platformTypes.MAC_NEW||this._platform==this._platformTypes.MAC_YOSEMITE||this._platform==this._platformTypes.Mac_El_Capitan||this._platform==this._platformTypes.Mac_Sierra},isInApp:function(){var e=this.getEnvironment();return-1!=[2==this._browserInApp,1==this._browserInApp,e===EBG.WebEnvironment.ANDROID_WEB_VIEW,e===EBG.WebEnvironment.IOS_WEB_VIEW].indexOf(!0)},inAppEnv:function(){var e=this.getEnvironment();return[2==this._browserInApp,1==this._browserInApp,e===EBG.WebEnvironment.ANDROID_WEB_VIEW,e===EBG.WebEnvironment.IOS_WEB_VIEW].indexOf(!0)},isMobile:function(){var e=!1;return e=this._deviceType==this._deviceTypes.MOBILE||this._deviceType==this._deviceTypes.TABLET?!0:e},isiOS:function(){for(var e in this._platformTypes)if(this._platformTypes[e]==this._platform&&e.match(/iphone|ipad|ipod/i))return!0;return!1},isiPad:function(){for(var e in this._platformTypes)if(this._platformTypes[e]==this._platform&&e.match(/ipad/i))return!0;return!1},isAndroid:function(){for(var e in this._platformTypes)if(this._platformTypes[e]==this._platform&&0<=e.indexOf("ANDROID"))return!0;return!1},isAndroidNative:function(){return this.isAndroid()&&this.isSafari()},isThirdPartyAllowed:function(){return!this.isSafari()||this.isMobile()},isSpotify:function(){var e=navigator.userAgent||navigator.vendor||window.opera||"";return this.isChrome()&&e.match(/spotify/i)},getEnvironment:function(){var e=navigator.userAgent||navigator.vendor||window.opera;if(EBG.adaptor.browser.isiOS()){var t=window.navigator&&window.navigator.standalone;return e.match(/safari/i)||t?EBG.WebEnvironment.IOS_MOBILE_BROWSER:EBG.WebEnvironment.IOS_WEB_VIEW}return EBG.adaptor.browser.isAndroid()?e.match(/wv/)||e.match(/version/i)?EBG.WebEnvironment.ANDROID_WEB_VIEW:EBG.adaptor.browser.isChrome()||EBG.adaptor.browser.isFF()?EBG.WebEnvironment.ANDROID_MOBILE_BROWESR:EBG.WebEnvironment.ANDROID_UNKNOWN:EBG.adaptor.browser.isMobile()?EBG.adaptor.browser.isIE()?EBG.WebEnvironment.OTHER_MOBILE_BROWSER:EBG.WebEnvironment.UNKNOWN:EBG.WebEnvironment.BROWSER}},EBG.Adaptors.ServingMode={SCRIPT:"SCRIPT",IFRAME:"IFRAME",FRIENDLY_IFRAME:"FRIENDLY_IFRAME",INNER_IFRAME:"INNER_IFRAME",TOPMOST_FRIENDLY_IFRAME:"TOPMOST_FRIENDLY_IFRAME"},EBG.Adaptors.ServingMgr=function(){this.displayWin=window,this.servingMode=EBG.Adaptors.ServingMode.SCRIPT},EBG.Adaptors.ServingMgr.prototype={displayWin:null,pageWin:null,placementIframe:null,_placementIframeAttr:null,servingMode:null,ebO:null,setDisplayWin:function(e){this.displayWin=e},setPageWin:function(){var e=this.detectServingMode(!0);switch(this.servingMode){case EBG.Adaptors.ServingMode.SCRIPT:switch(e){case EBG.Adaptors.ServingMode.SCRIPT:this.pageWin=window;break;case EBG.Adaptors.ServingMode.FRIENDLY_IFRAME:this.pageWin=top;break;case EBG.Adaptors.ServingMode.IFRAME:case EBG.Adaptors.ServingMode.INNER_IFRAME:this.pageWin=this.displayWin}break;case EBG.Adaptors.ServingMode.FRIENDLY_IFRAME:this.pageWin=top;break;case EBG.Adaptors.ServingMode.IFRAME:case EBG.Adaptors.ServingMode.TOPMOST_FRIENDLY_IFRAME:case EBG.Adaptors.ServingMode.INNER_IFRAME:this.pageWin=this.displayWin}},setServingMode:function(a){this.servingMode=a;var b=null;switch(a){case EBG.Adaptors.ServingMode.TOPMOST_FRIENDLY_IFRAME:b=this._getTopFriendlyIframe();break;case EBG.Adaptors.ServingMode.INNER_IFRAME:case EBG.Adaptors.ServingMode.FRIENDLY_IFRAME:b=top;break;case EBG.Adaptors.ServingMode.SCRIPT:return this.setDisplayWin(window),void this.setPageWin()}EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_UNLOAD,this._restorePlacementIframe,this)),b&&(EBG.isGlobalDef("gstrEbDisplayPos")&&(a="parent."+gstrEbDisplayPos,b=eval(a)),this.setDisplayWin(b),this.setPageWin(),b!==window&&this._findPlacementIframe()),EBG.log.endGroup()},detectServingMode:function(e){try{var t=EBG.Adaptors.ServingMode.SCRIPT,i=window;if(EBG.adaptor.walkUpIframes(function(){i!=this&&(t=EBG.Adaptors.ServingMode.FRIENDLY_IFRAME)},function(){t=EBG.Adaptors.ServingMode.IFRAME}),e)return EBG.log.endGroup(),t;this.setServingMode(t)}catch(e){}EBG.log.endGroup()},detectServingEnvironment:function(e){e=EBG.isDefinedNotNull(e)?e:this.detectServingMode(!0),this.servingMode==EBG.Adaptors.ServingMode.INNER_IFRAME&&(e=EBG.Adaptors.ServingMode.INNER_IFRAME);var t=this._getTopFriendlyIframe(window);return e=window!=t&&t!=top?EBG.Adaptors.ServingMode.TOPMOST_FRIENDLY_IFRAME:e},_getTopFriendlyIframe:function(e){return e=e||window,EBG.adaptor.isSafeFrame()?e:(EBG.adaptor.walkUpIframes(function(){t=this},null,e),t);var t},_restorePlacementIframe:function(){this._placementIframeAttr&&(EBGInfra.mergeObj(this._placementIframeAttr,this.placementIframe,!0),EBGInfra.mergeObj(this._placementIframeAttr.style,this.placementIframe.style,!0)),EBG.log.endGroup()},hidePlacementIframe:function(){var e=this.placementIframe;this._placementIframeAttr||(this._placementIframeAttr={width:e.width,height:e.height},this._placementIframeAttr.style={width:EBG.adaptor.getCurrentStyleAttr(e,"width"),height:EBG.adaptor.getCurrentStyleAttr(e,"height"),visibility:EBG.adaptor.getCurrentStyleAttr(e,"visibility"),border:EBG.adaptor.getCurrentStyleAttr(e,"border")}),e.style.visibility="hidden",e.width=e.height=0,e.style.width=e.style.height=e.style.border="0px",EBG.log.endGroup()},rehidePlacementIframe:function(){this._placementIframeAttr&&this.hidePlacementIframe()},_findPlacementIframe:function(){function e(){if(this==a){s=!0;var e=a.document.getElementsByTagName(EBG.Adaptors.TagNames.IFRAME);if("function"==typeof Array.from)for(var t,e=Array.from(e),i=EBG.adaptor.findAllShadowRoots(this),n=0;n<i.length;n++)t=Array.from(i[n].querySelectorAll(EBG.Adaptors.TagNames.IFRAME)),e=e.concat(t);for(n=0;n<e.length;n++)e[n].contentWindow==r&&(o=e[n])}else s||(r=this)}var a=this.displayWin,s=!1,r=window,o=null;EBG.Adaptors.StdWebAdaptor._walkUpIframes(e,e,r,!0),this.placementIframe=o,EBG.log.endGroup()}},EBG.Adaptors.FlashDetector=function(){this._init(),this._customScript=!!window.ebAdCS},EBG.Adaptors.FlashDetector.prototype={version:0,checkingBlock:!1,checkedBlock:!1,isBlocked:null,_flashPlayerVersion:null,_detectionPixelTimeout:null,_throttleTimeout:null,_detectionPixelTimeoutDuration:2e3,_init:function(){var e=-1;try{e=new ActiveXObject("Shockwaveflash.Shockwaveflash.7").GetVariable("$version"),e=this._splitFlashMajorMinorVersions(e),e=Number(e)}catch(e){}if(-1==e)try{var t,i,n,a=0,s=0,r=0;null!=navigator.plugins&&0<navigator.plugins.length&&((t=navigator.mimeTypes)&&t["application/x-shockwave-flash"]&&t["application/x-shockwave-flash"].enabledPlugin&&t["application/x-shockwave-flash"].enabledPlugin.description&&(a=(n=(i=t["application/x-shockwave-flash"].enabledPlugin.description.split(" "))[2].split("."))[0],s=n[1],""==(r=i[3])&&(r=i[4]),0<(r=isNaN(r[0])?r.substring(1):r).indexOf("d")&&(r=r.substring(0,r.indexOf("d")))),e=Number(a+"."+s+r))}catch(e){}isNaN(e)||(this.version=e),EBG.log.endGroup()},_splitFlashMajorMinorVersions:function(e){if(e)return e=e.split(" ")[1].split(","),EBG.format("{0}.{1}{2}",e[0],e[1],e[2])},_handlePixelMessage:function(e){clearTimeout(this._detectionPixelTimeout),this._detectionPixelTimeout=null,this.flashPlayerVersion=e,this.isBlocked=!1,EBG.runTimed(this,this._dispatchFlashDetected,[],10)},_handleDetectionPixelTimeout:function(e){var t=EBG.adaptor.browser.isFF()||EBG.adaptor.isPageVisible(),i=EBG.adaptor.hasHiddenParent(EBG.adaptor.getElementById("ebFlashDetection"));t&&e&&!i?(this.checkedBlock=!0,this.checkingBlock=!1,(e=EBG.adaptor.getDisplayWin()).EBG&&e.EBG!=EBG&&e.EBG.adaptor.flash&&EBG.isDefinedNotNull(e.EBG.adaptor.flash.flashPlayerVersion)&&(this.flashPlayerVersion=e.EBG.adaptor.flash.flashPlayerVersion),this.isBlocked=!this.flashPlayerVersion,this._dispatchFlashDetected(),clearTimeout(this._detectionPixelTimeout),this._detectionPixelTimeout=null):(clearTimeout(this._detectionPixelTimeout),this._detectionPixelTimeout=EBG.runTimed(this,this._handleDetectionPixelTimeout,[t],this._detectionPixelTimeoutDuration))},_dispatchFlashDetected:function(){this.checkedBlock=!0,this.checkingBlock=!1;var e=new EBG.Events.Event(EBG.Events.EventNames.FLASH_DETECTED);e.dispatcher=this,e.eventData={isBlocked:this.isBlocked,versionStr:this.flashPlayerVersion,versionInt:this.version},EBG.eventMgr.dispatchEvent(e),EBG.adaptor.removeElement("ebFlashDetectionDiv")},_buildRenderPixelJson:function(){var e={play:"true",resId:"ebFlashDetection",resPath:ebBigS+"/Res/Assets/Pixel"+EBG.flashPixelVer+"/pixel.swf",unique:0,wmode:"opaque",tagName:EBG.Adaptors.TagNames.OBJECT,attributes:{id:"ebFlashDetection",dir:"ltr",name:"ebFlashDetection",style:{position:"absolute",textAlign:"left",width:"1px",height:"1px"},codebase:EBG.format("{0}download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#",EBG.protocol),version:"9,0,0,0"},params:{play:"true",wmode:"opaque",menu:"false",flashVars:"id=ebFlashDetection",allowScriptAccess:"always",allowFullScreen:"true"}};return this.isSupportShockwave()?(e.attributes.type="application/x-shockwave-flash",e.attributes.data=e.resPath):(e.attributes.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",e.params.movie=e.resPath),e},_createScriptTag:function(){var e=EBG.format("function {0}(args)","DoFS_FlashDetectionPixel");return e+=EBG.format("{ try{ if(!args||args=='null')args=''; return {0}(args);}catch(e){if(window.mmFSExceptionAlert)mmFSExceptionAlert('Command: '+command+'\\nargs: '+args.toString()+'\\n\\nexception in DoFS func:\\n'+e.message)}}","EBG.adaptor.flash._handlePixelMessage"),{tagName:EBG.Adaptors.TagNames.SCRIPT,text:e}},_handleThrottleEvent:function(e){e&&e.state&&(e.elemId,e.state==EBG.ThrottleStates.THROTTLE||e.state==EBG.ThrottleStates.PAUSE?this._setThrottleState(e):e.state==EBG.ThrottleStates.RESUME?(clearTimeout(this._throttleTimeout),this._setThrottleState(e)):e.state==EBG.ThrottleStates.LOAD&&e.elemId&&e.id&&this._verifyThrottleDetectLocation(e))},_verifyThrottleDetectLocation:function(e){var t,i,n,a,s;e.elemId&&e.id&&(t=EBG.adaptor.getBoundingClientRect(EBG.adaptor.getElementById(e.elemId)),i=EBG.adaptor.getElementById(e.id),n=EBG.adaptor.getBoundingClientRect(i),t&&n&&EBG.isNumber(t.width)&&EBG.isNumber(n.width)&&(0==t.width||0==t.height?EBG.runTimed(this,this._verifyThrottleDetectLocation,[e],30):(EBG.serializeObject(t)!=EBG.serializeObject(n)&&(a=parseInt(i.style.marginTop,10),s=parseInt(i.style.marginLeft,10),i.style.marginTop=EBG.px(a-(n.top-t.top)),i.style.marginLeft=EBG.px(s-(n.left-t.left)),i.style.width=EBG.px(t.width),i.style.height=EBG.px(t.height)),this._customScript&&(t=(t=e.adUId&&EBG.ads[e.adUId])&&t._CCs&&t._CCs[e.elemId])&&EBG.RichFlashPanelCC&&t instanceof EBG.RichFlashPanelCC&&EBG.runTimed(this,this._verifyThrottleDetectLocation,[e],250))))},_setThrottleState:function(e){var t,i;e.adUId&&(t=new EBG.Events.Event(EBG.Events.EventNames.THROTTLED),i=e.adUId.split("_")[1],t.dispatcher={_adConfig:{rnd:i,uid:e.adUId}},t.eventData=e,EBG.eventMgr.dispatchEvent(t))},removeThrottleDetectionSwf:function(e){EBG.adaptor.removeElement("ebFlashThrottleDetection_"+e)},isSupportShockwave:function(){var e=!0;return e=EBG.adaptor.browser.isIE()&&EBG.adaptor.browser.getVersion()<11||10<EBG.adaptor.browser.getVersion()&&EBG.adaptor.getDisplayWin().document.documentMode<9?!1:e},doFlashBlockDetection:function(e){this.checkingBlock=!0;var t={tagName:EBG.Adaptors.TagNames.DIV,attributes:{id:"ebFlashDetectionDiv",style:{width:"0px",height:"0px"}},children:[this._buildRenderPixelJson(),this._createScriptTag()]};EBG.adaptor.inInnerIframe()?EBG.adaptor.inject(t,EBG.Adaptors.InjectionMethod.INSERT_BEFORE,EBG.adaptor.serving.placementIframe):e&&EBG.adaptor.getElementById(e)&&EBG.adaptor.addInlineDOM(t,e),this._detectionPixelTimeout=EBG.runTimed(this,this._handleDetectionPixelTimeout,[],this._detectionPixelTimeoutDuration)}},EBG.declareNamespace("Events"),EBG.Events.EventTiming={BEFORE:"BEFORE",ONTIME:"ONTIME",AFTER:"AFTER",ONTIME_AND_AFTER:"ONTIME_AND_AFTER"},EBG.Events.EventNames=EBG.API.EventNames,EBG.Events.EbEventNames=EBG.API.EbEventNames,EBG.Events.EventSubscription=function(e,t,i){this.eventName=e,this.callback=t,this.callbackBinding=i||null},EBG.Events.EventSubscription.prototype={dispatcherFilters:null,timing:EBG.Events.EventTiming.ONTIME,isElementEvent:!1,elementId:"",isDocumentEvent:!1,isValid:function(){return EBG.isFunc(this.callback)&&(!this.callbackBinding||EBG.isObj(this.callbackBinding))},toString:function(){return EBG.format("EventSubscription: eventName={0}, timing={1}, callback={2}, callbackBinding={3}, dispatcherFilters={4}",this.eventName,this.timing,EBG.typeOf(this.callback),EBG.typeOf(this.callbackBinding),EBG.typeOf(this.dispatcherFilters))}},EBG.declareClass(EBG.Events.EventSubscription,null),EBG.Events.Event=function(e){this.name=e,this.creationTime=+new Date},EBG.Events.Event.prototype={dispatcher:null,eventData:null,timing:null,toString:function(){return EBG.format("Event: name={0}, creationTime={1}, dispatcher={2}, eventData={3}",this.name,this.creationTime,EBG.typeOf(this.dispatcher),EBG.typeOf(this.eventData))}},EBG.declareClass(EBG.Events.Event,null),EBG.Events.EventManager=function(){var e,t;if(EBG.Adaptors&&EBG.Adaptors.StdWebAdaptor?EBG.Adaptors.StdWebAdaptor._walkUpIframes(function(){this.EBG&&this.EBG.eventMgr&&this.EBG.eventMgr._scriptWin&&!this.EBG.eventMgr._scriptWin.closed&&(t=this.EBG.eventMgr)},null,window,!0):(e=EBG.getTopAccessibleWindow(!1))&&e.EBG&&e.EBG.eventMgr&&(t=e.EBG.eventMgr),t)return t;this._subscriptions={},this._dispatchedEvents={},this._trackedEvents[EBG.Events.EventNames.ADD_CREATIVES]=!0},EBG.Events.EventManager.prototype={_subscriptions:{},_dispatchedEvents:{},_trackedEvents:{},_scriptWin:window,subscribeToEvent:function(e){if(e.isValid())if(e.isElementEvent)EBG.adaptor&&EBG.adaptor.subscribeToEventOnElement(e.eventName,e.elementId,e.callback);else{var t,i=this._subscriptions[e.eventName]=this._subscriptions[e.eventName]||{};for(t in EBG.Events.EventTiming)EBG.Events.EventTiming.hasOwnProperty(t)&&(i[t]=i[t]||[]);-1==this._getSubscriptionId(e,i[e.timing])&&(i[e.timing].push(e),EBG.adaptor&&EBG.adaptor.hasEvent(e.eventName)&&EBG.adaptor.subscribeToEvent(e.eventName,e.isDocumentEvent)),EBG.log.endGroup()}else EBG.log.endGroup()},unsubscribeFromEvent:function(e){var t;e&&e.isValid()?e.isElementEvent?EBG.adaptor&&EBG.adaptor.unsubscribeFromEventOnElement(e.eventName,e.elementId,e.callback):(this._subscriptions[e.eventName]&&this._subscriptions[e.eventName][e.timing]&&(t=this._subscriptions[e.eventName][e.timing],-1!=(e=this._getSubscriptionId(e,t))&&(t[e]=null)),EBG.log.endGroup()):EBG.log.endGroup()},dispatchEvent:function(e){switch(e.timing){case EBG.Events.EventTiming.BEFORE:case EBG.Events.EventTiming.ONTIME:case EBG.Events.EventTiming.AFTER:e.name,e.timing;var t=this._dispatchEventByTiming(e,e.timing);break;case EBG.Events.EventTiming.ONTIME_AND_AFTER:t=(t=this._dispatchEventByTiming(e,EBG.Events.EventTiming.ONTIME))||this._dispatchEventByTiming(e,EBG.Events.EventTiming.AFTER);break;default:t=(t=(t=this._dispatchEventByTiming(e,EBG.Events.EventTiming.BEFORE))||this._dispatchEventByTiming(e,EBG.Events.EventTiming.ONTIME))||this._dispatchEventByTiming(e,EBG.Events.EventTiming.AFTER)}return EBG.log.endGroup(),t},attachToAdaptor:function(){EBG.adaptor.setListener(this.dispatchEvent,this)},_trackEvent:function(e){e&&this._trackedEvents[e.name]&&(this._dispatchedEvents[e.name]||(this._dispatchedEvents[e.name]={}),this._dispatchedEvents[e.name][e.timing]||(this._dispatchedEvents[e.name][e.timing]=[]),this._dispatchedEvents[e.name][e.timing].length<10&&this._dispatchedEvents[e.name][e.timing].push(e))},getDispatchedEvents:function(e){return this._dispatchedEvents[e.name]?this._dispatchedEvents[e.name][e.eventTiming]:null},_dispatchEventByTiming:function(e,t){if(t.toString(),this._trackEvent(e),!(i=this._subscriptions[e.name]))return EBG.log.endGroup(),!1;t=i[t];for(var i=!1,n=0;n<t.length;n++){var a=t[n];if(a){a=this._dispatchEventToSubscription(e,a);if(EBG.isBool(a)&&!a){i=!0;break}}}return EBG.log.endGroup(),i},_dispatchEventToSubscription:function(e,t){try{var i=t.dispatcherFilters;if(EBG.isObj(i))for(var n in i)if(i.hasOwnProperty(n)){var a=i[n],s=!0,r=n.split(".");if(d=e.dispatcher)for(var o=0;o<r.length;o++){var d=d[r[o]],E=o==r.length-1;if(!d||E&&d!==a){s=!1;break}}if(!s)return EBG.log.endGroup(),null}}catch(e){}if(i=null,n=t.callback,EBG.isFunc(n)){a=[e];try{i=n.apply(t.callbackBinding,a),e.name}catch(e){}}return EBG.log.endGroup(),i},_getSubscriptionId:function(e,t){for(var i=0;i<t.length;i++)if(t[i]&&t[i].callback===e.callback&&t[i].callbackBinding===e.callbackBinding&&t[i].isDocumentEvent===e.isDocumentEvent&&this._compareFilters(t[i].dispatcherFilters,e.dispatcherFilters))return i;return-1},_compareFilters:function(e,t){if(!EBG.isObj(e))return!EBG.isObj(t);if(!EBG.isObj(t))return!1;for(var i in e)if(e.hasOwnProperty(i)){if(!t.hasOwnProperty(i))return!1;if(e[i]!==t[i])return!1}for(i in t)if(t.hasOwnProperty(i)&&!e.hasOwnProperty(i))return!1;return!0}},EBG.declareClass(EBG.Events.EventManager,null),EBG.eventMgr=EBG.eventMgr||new EBG.Events.EventManager,EBG.declareNamespace("Interactions"),EBG.Interactions.SystemInts={CLICK:"_eyeblaster",AD_DURATION:"ebAdDuration",REPLAY:"ebReplay",CLOSE:"ebClose",CLOSE_REM:"ebRemClose",DEFAULT_CLICK:"ebDefaultClick",USER_INTERACTION:"ebUserInteraction",UNIQUE_VIDEO_STARTED:"ebUniqueVideoStarted",DWELL_TIME:"ebDwellTime",DWELL_UNIQUE:"ebUniqueDwell",RICH_FLASH_PLAYED:"ebRichFlashPlayed",INT_DURATION:"ebIntDuration",VISIBILITY_RECORDABLE:"VsR",VISIBILITY_AGENCY_RECORDABLE:"VsRAg",VISIBILITY_ADVERTISER_RECORDABLE:"VsRAd",VISIBILITY_ADVERTISER:"VsAd",VISIBILITY_AGENCY:"VsAg",VISIBILITY_IAB:"VsIAB",VISIBILITY_ADVERTISER_DURATION:"VsAdDu",VISIBILITY_AGENCY_DURATION:"VsAgDu",VISIBILITY_AVG_AD_SURFACE:"VsAvSu",VISIBILITY_AVG_SCREEN_SHARE:"VsAvSc",REM_DURATION:"ebRemDuration",INTRO_FULL_PLAY:"ebFullPlay",REM_FULL_PLAY:"ebRemFullPlay",SWIPE:"ebSwipe",AD_START:"AdStart",AD_STACKING:"AdStacking",ACTUAL_SIZE:"ActualSize",MULTI_BURN:"MultiBurn",AD_COLLISION:"AdCollision",AD_CAROUSEL:"AdCarousel",AD_PARAMS:"AdParams",PLAYER_PARAMS:"plparams",VER_URL:"verURL",END_OF_SESSION:"eos"},EBG.Interactions.Categories={SYSTEM:2,VIDEO:1,CUSTOM:0},EBG.Interactions.InitiationTypes={AUTO:"auto",USER:"user"},EBG.Interactions.InteractionTypes={COUNTER:"Counter",TIMER:"Timer"},EBG.Interactions.checkURL=function(e){return 0<e.indexOf("://")||0===e.indexOf("//")?e:"https://"+EBG.adaptor.getHostName()+e},EBG.Interactions.RemoteServersData=function(){},EBG.Interactions.RemoteServersData.prototype={networkUrl:null,agencyUrl:null},EBG.declareClass(EBG.Interactions.RemoteServersData,null),EBG.Interactions.InteractionData=function(e,t,i,n){this.reportingName=e,this.adUId=t,this.category=i,this.assetID=n},EBG.Interactions.InteractionData.prototype={initiationType:EBG.Interactions.InitiationTypes.AUTO,category:EBG.Interactions.Categories.SYSTEM,isPanel:!1},EBG.declareClass(EBG.Interactions.InteractionData,null),EBG.Interactions.CounterInteractionData=function(e,t,i,n){EBG.callSuperConstructor(EBG.Interactions.CounterInteractionData,this,[e,i,t,n]),this.remoteServers=new EBG.Interactions.RemoteServersData},EBG.Interactions.CounterInteractionData.prototype={reportImmediately:!1,countAsClick:!1,remoteServers:null,clickURL:null,numLeftToReport:10,state:null},EBG.declareClass(EBG.Interactions.CounterInteractionData,EBG.Interactions.InteractionData),EBG.Interactions.TimerInteractionData=function(e,t,i){this.reportingName=e,EBG.callSuperConstructor(EBG.Interactions.TimerInteractionData,this,[e,i,t])},EBG.Interactions.TimerInteractionData.prototype={value:0,startTime:0,idleDuration:0},EBG.declareClass(EBG.Interactions.TimerInteractionData,EBG.Interactions.InteractionData),EBG.Interactions.AggregationInteractionData=function(e,t,i){this.reportingName=e,EBG.callSuperConstructor(EBG.Interactions.AggregationInteractionData,this,[e,i,t])},EBG.Interactions.AggregationInteractionData.prototype={value:0,isPlaying:!1},EBG.declareClass(EBG.Interactions.AggregationInteractionData,EBG.Interactions.InteractionData),EBG.AutolinaClass=function(){},EBG.AutolinaClass.prototype={_hostname:"localhost:3000",reportType:{INTERACTION:"INTERACTION",THIRDPARTY:"THIRDPARTY",CLICK:"CLICK"},report:function(e,t){e=this._adapt(e,t),navigator.sendBeacon?EBG.adaptor.reportBeacon(e):EBG.adaptor.reportToRemoteServerUsingImage(e)},_adapt:function(e,t){switch(t){case EBG.Autolina.reportType.THIRDPARTY:return ebPtcl+this._hostname+"/3rdparty?url="+encodeURIComponent(e);case EBG.Autolina.reportType.INTERACTION:return ebPtcl+this._hostname+"/interaction?"+e.split("?")[1];case EBG.Autolina.reportType.CLICK:return ebPtcl+this._hostname+"/click?url="+encodeURIComponent(e)}},_GET:function(){var a={x:function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(var e,t=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],i=0;i<t.length;i++)try{e=new ActiveXObject(t[i]);break}catch(e){}return e},get:function(e,t,i){try{var n=a.x();n.open("GET",e,i),n.onreadystatechange=function(){4==n.readyState&&t&&t(n.responseText)}}catch(e){}}};return a.get}()},EBG.declareNamespace("Utilities.InteractionUtil"),EBG.dynamicTokens={tp_deviceadvid:"ebaddid",tp_deviceidfaraw:"ebidfar",tp_deviceidfasha1:"ebidfas1",tp_deviceidfasha2:"ebidfas2",tp_deviceidfamd5:"ebidfam",tp_devicegaid:"ebgaid",tp_devicewaid:"ebwaid",tp_appname:"ebappname",tp_appid:"ebappid",tp_mobilelat:"ebmblat",tp_mobilelong:"ebmblong"},EBG.Utilities.InteractionUtil=function(){},EBG.Utilities.InteractionUtil.prototype={getBannerRedirectUrl:function(e,t){if(t=t||7850,!e||!e.adConfig)return"";var i={},n=e.adConfig.protocol+EBG.combinePaths(e.adConfig.bsPath,EBG.format("{0}/adServer.bs?cn=brd&PluID={1}&Pos={2}&EyeblasterID={3}",e.adConfig.interactionServer,e.adConfig.pluId,e.adConfig.rnd,e.adConfig.adId));EBGInfra.isDefined(e.adConfig.page)&&e.adConfig.page.length&&(i.Page=e.adConfig.page),EBGInfra.isDefinedNotNull(e.clickVal)&&(i.clk=e.clickVal),e.adConfig.isPreview||e.isClickTag||(i.sct=1),e.adConfig.autolina&&(i.autolina=1),e.adConfig.massVersioning&&((e.adConfig.massVersioning.adVersions||e.adConfig.massVersioning.defaultAdVersion)&&(e.sClickedVersion?i.vid=e.sClickedVersion+"&vcl=1":e.versionToReport&&(i.vid=e.versionToReport)),e.adConfig.massVersioning.targetAudienceId&&(i.ta=e.adConfig.massVersioning.targetAudienceId),(e.adConfig.massVersioning.logDeliveryGroupId||e.adConfig.massVersioning.deliveryGroupId)&&(i.dg=e.adConfig.massVersioning.logDeliveryGroupId||e.adConfig.massVersioning.deliveryGroupId),e.adConfig.massVersioning.versionTargetAudienceId&&(i.tav=e.adConfig.massVersioning.versionTargetAudienceId),e.adConfig.massVersioning.dgTargetAudienceId&&(i.tadg=e.adConfig.massVersioning.dgTargetAudienceId),e.adConfig.massVersioning.originalDeliveryGroupId&&(i.dgo=e.adConfig.massVersioning.originalDeliveryGroupId)),e.fIsDefClick=!!EBG.isBool(e.fIsDefClick)&&e.fIsDefClick,e.fIsDefClick||(i.di=0),EBGInfra.isDefinedNotNull(e.adConfig.sPublisherPlacementId)&&(i.pc=e.adConfig.sPublisherPlacementId),EBGInfra.isDefinedNotNull(e.adConfig.sID)&&(i.sessionid=e.adConfig.sID),e.adConfig.usercookie&&(i.usercookie=e.adConfig.usercookie),EBGInfra.isDefinedNotNull(e.adConfig.optOut)&&(i.OptOut=e.adConfig.optOut),EBGInfra.isDefinedNotNull(e.adConfig.lineId)&&(i.lineid=encodeURIComponent(e.adConfig.lineId)),EBGInfra.isDefinedNotNull(e.adConfig.diAppId)&&(i.diappid=e.adConfig.diAppId),EBGInfra.isDefinedNotNull(e.adConfig.gdpr)&&(i.gdpr=e.adConfig.gdpr),EBGInfra.isDefinedNotNull(e.adConfig.gdprconsent)&&(i.gdpr_consent=e.adConfig.gdprconsent);var a,s,r=e.adConfig.ffs&&e.adConfig.ffs.CFF_SendUndefined;for(a in(!r&&void 0!==e.adConfig.gdprpurposes||r)&&(i.gdprpurposes=e.adConfig.gdprpurposes),e.adConfig.isNXT&&!e.isClickTag&&(i.ctick=+new Date-e.adConfig.handleStartTime),e.adConfig.oURLTokens||(e.adConfig.oURLTokens=this._pairsToObj(e.adConfig.sUrlTokens,"$$")),e.adConfig.oURLTokens)e.adConfig.oURLTokens.hasOwnProperty(a)&&EBG.dynamicTokens[a.toLowerCase()]&&(i[EBG.dynamicTokens[a.toLowerCase()]]=e.adConfig.oURLTokens[a]);if(e.adConfig.ffs&&e.adConfig.ffs.CFF_ClickFlags){for(var o in r=!(a={}),e.adConfig.ffs)e.adConfig.ffs.hasOwnProperty(o)&&"CFF_Clk_"==o.substring(0,8)&&(a[o.substring(8)]=1,r=!0);try{r&&(a=encodeURIComponent(JSON.stringify(a)),i.cff=a)}catch(e){}}for(s in i)i.hasOwnProperty(s)&&(n+="&"+s+"="+i[s]);return o=t-n.length,e.cvurl&&(i.cvurl=encodeURIComponent('"'+e.cvurl.split("|").join('","')+'"')),e.sJumpUrl&&(i.rtu=encodeURIComponent(e.sJumpUrl)),EBGInfra.isDefinedNotNull(e.adConfig.ncu)&&(i.ncu=encodeURIComponent(e.adConfig.ncu)),EBGInfra.isDefinedNotNull(e.adConfig.ebReferrer)&&(i.ebReferrer=encodeURIComponent(e.adConfig.ebReferrer)),(n+=this._capUrls(o,["cvurl","ncu","ebReferrer","rtu"],i)).slice(0,t)},_capUrls:function(e,t,i){for(var n="",a=!0,s=0;a;)for(var a=!1,r=Math.floor(e/t.length),s=r,o=t.length-1;0<=o;--o){var d=t[o];i[d]?(d="&"+d+"="+i[d]).length<=r&&(n+=d,e-=d.length,t.splice(o,1),a=!0):(t.splice(o,1),a=!0)}for(o=0;o<t.length;++o)n+=("&"+t[o]+"="+i[t[o]]).slice(0,s);return n},_pairsToObj:function(e,t){var i,n,a,s={};for(e=unescape(e).split(t),t=0;t<e.length;t++)try{e[t]&&(i=e[t].indexOf("="),n=e[t].substr(0,i),a=e[t].substr(i+1),s[n]=escape(a))}catch(e){}return s}},EBG.declareClass(EBG.Utilities.InteractionUtil,null),EBG.InteractionUtil=EBG.InteractionUtil||new EBG.Utilities.InteractionUtil,EBG.Interactions.Interaction=function(){},EBG.Interactions.Interaction.prototype={unique:1,_escapeInteractionName:function(e){return e=(e=e.toString()).replace(/~|\^|\|/gi,"_"),encodeURIComponent(e)},_buildReportFormat:function(e,t,i,n){n=n||0;var a=EBG.Interactions.InteractionManager.charAdFieldsDelimeter;return e=EBG.format("{0}{2}{1}{3}{1}{4}{1}{5}{6}{7}{8}{9}",EBG.Interactions.InteractionManager.charIntDelimeter,a,this._escapeInteractionName(this.interactionData.reportingName),i,n,e,this.unique,t,this.interactionData.category,this.interactionData.isPanel?1:0),this.interactionData.adConfig&&this.interactionData.adConfig.isNXT&&(e+=a+(+new Date-this.interactionData.adConfig.handleStartTime)),e}},EBG.Interactions.CounterInteraction=function(e){EBG.callSuperConstructor(EBG.Interactions.CounterInteraction,this),this.interactionData=e||new EBG.Interactions.CounterInteractionData,EBG.log.endGroup()},EBG.Interactions.CounterInteraction.prototype={type:EBG.Interactions.InteractionTypes.COUNTER,handle:function(e){var t=this.interactionData,i=!(!(E=t.counterJumpUrlData)||!E.tmpData)&&E.tmpData.isClick,n=!(!E||!E.tmpData)&&E.tmpData.isProductClick,a=!1,s=!0,r="",o=(E&&E.tmpData?E.tmpData.clickUrl:null)||(E?E.jumpUrl:""),d=!!(E&&E.tmpData&&E.tmpData.windowWasOpen),E=!d;return this.interactionData.adConfig.ffs.CFF_openWindowParam&&(E=E&&this.interactionData.adConfig.openWindow),this.shouldReportInteraction()?(this._handleRemoteServers(),t.counterJumpUrlData&&(s=!o||!this._isEBClick(),a=!(!o||!i&&!this._isEBClick()),(t=i||this._isEBClick())?a?E&&this.handleBRDFlow():(i||n)&&this.reportThirdPartyUrls():E&&o&&(o=EBG.Interactions.checkURL(o),this._openOrRedirect(o))),r=s?this._getReportingData(e,a):""):(!d&&o&&(o=EBG.Interactions.checkURL(o),this._openOrRedirect(o)),EBG.isTestMode&&(i||n||this._isEBClick())&&this.reportThirdPartyUrls()),EBG.log.endGroup(),r},reportThirdPartyUrls:function(){var e=this.interactionData.reportingName.toLowerCase()==EBG.Interactions.SystemInts.DEFAULT_CLICK.toLowerCase(),t=this.interactionData.counterJumpUrlData,i=[];if(t&&t.tmpData&&t.tmpData.isClick&&(i=this.interactionData.adConfig.clickTrackingUrls,e||this.interactionData.adConfig.showOnlyImage))for(e=0;e<this.interactionData.adConfig.defaultClickTrackingUrls.length;e++)i[i.length]=this.interactionData.adConfig.defaultClickTrackingUrls[e];if(t&&t.tmpData&&t.tmpData.isProductClick&&t.tmpData.clickedVerUrl)if(this.interactionData.adConfig.ffs.CFF_ReportVer3rdP)for(t=t.tmpData.clickedVerUrl.split("|"),e=0;e<t.length;e++)i[i.length]=t[e];else i[i.length]=t.tmpData.clickedVerUrl;for(e=0;e<i.length;e++)EBG.adaptor.reportToRemoteServerUsingImage(i[e])},shouldReportInteraction:function(){var e=!0;return 0==this.interactionData.numLeftToReport||EBG.isPreview||EBG.isInWorkshop?e=!1:this.interactionData.numLeftToReport--,e},handleBRDFlow:function(){var e=this.interactionData,t=this.interactionData.counterJumpUrlData,i=EBGInfra.isDefinedNotNull(t)&&t.tmpData?t.tmpData.clickUrl:null,n=i||EBGInfra.isDefinedNotNull(t)&&t.jumpUrl;this._isEBClick()&&(i||(n="")),e=e.reportingName.toLowerCase()==EBG.Interactions.SystemInts.DEFAULT_CLICK.toLowerCase(),i=0,t.tmpData.isClick?i=1:t.tmpData.isProductClick&&(i=2),n=""==n?"":EBG.Interactions.checkURL(n),n=this._getBannerRedirectUrl(n,i,e,t.tmpData.clickedVersion),n=EBG.Interactions.checkURL(n),this._openOrRedirect(n)},_openOrRedirect:function(e){-1==this.interactionData.counterJumpUrlData.target.indexOf(EBG.WindowTarget.BLANK)?(this.interactionData.reportImmediately=!0,EBG.runTimed(this,this._openPage,[e,this.interactionData.counterJumpUrlData],1e3)):this._openPage(e,this.interactionData.counterJumpUrlData)},getClickTagUrl:function(e){var t;return e=EBG.isDefined(e)&&""!=e?EBG.Interactions.checkURL(e):void 0,EBG.isPreview?EBG.isInWorkshop?e=EBG.format("ReportPage_{0}.html",HTMLPageVer):4<=(e=this.interactionData.counterJumpUrlData.jumpUrl).length&&"http"!=e.substr(0,4)&&(e=EBG.format("{0}{1}",ebPtcl,e)):(e=this._getBannerRedirectUrl(e,null,null,null,!0,4e3),e=EBG.format("{0}/ReportPage{1}.html?ebReportURL={2}$$ebImpressionID={3}$$ctick={4}",ebBigS,EBG.reportPageVer,escape(e),EBG.Ads.Ad.Fn.getRandFromAdUId(this.interactionData.adConfig.uid),+new Date),this.interactionData.adConfig.Purposes.Cookies||(e+="$$noCookies=1"),EBG.adaptor.browser.isIE()?(t=9<=EBG.adaptor.browser.getVersion()?4096:2048,t-=e.length):t=7850-e.length,e+=t=this._getReportPageTrackingUrls(t)),e},_getReportPageTrackingUrls:function(e){var t="$$ebTURLs=[";if(-1!=e){if(t.length>=e)return"";e-=t.length}for(var i=this.interactionData.adConfig.clickTrackingUrls,n=0;n<i.length;n++){var a=EBG.format('{0}"{1}"',0!=n?",":"",i[n]);if(-1!=e){if(a.length>=e)break;e-=a.length}t+=a}return t+"]"},_openPage:function(d,E){var l,e=E.tmpData.clickedVerUrl?encodeURIComponent('"'+E.tmpData.clickedVerUrl.split("|").join('","')+'"'):"",c=!E.tmpData.clickedVerUrl||EBG.isPreview||EBG.isInWorkshop?d:d+"&cvurl="+e;"POST"===EBG.adaptor.getRequestMethod(c)?(l=E.target,EBG.adaptor.browser.isIE()&&EBG.adaptor.browser.getVersion()<=9||(E.target=E.target&&E.target!=EBG.WindowTarget.BLANK?E.target:"ebReportPage"+parseInt(1e8*Math.random()),EBG.adaptor.openPage("",E)),EBG.runTimed(this,function(){var e=document.createElement("form");e.setAttribute("method","post"),e.setAttribute("action",d.substring(0,c.indexOf("?"))+"?cn=brd&ebReferrer="+encodeURIComponent(this.interactionData.adConfig.ebReferrer)),e.setAttribute("target",E.target),E.target=l;var t,i=this._urlQueryStringToJSON(c);for(t in i){var n=e,a=n.appendChild,s=t,r=unescape(i[t]),o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("name",s),o.setAttribute("value",r),a.call(n,o)}EBG.adaptor.getDisplayWin().document.body.appendChild(e),e.submit()},[],25)):(EBG.Autolina&&EBG.Autolina.report(c,EBG.Autolina.reportType.CLICK),EBG.adaptor.openPage(c,E))},_urlQueryStringToJSON:function(e){var t={},i=e.substring(e.indexOf("?")+1);if(!i)return t;e=[];for(var n=0,a=0;a<i.length;a++)switch(i.charAt(a)){case"&":e.push(i.substring(n,a)),n=a+1;break;case"$":if("="==i.charAt(a-1)&&"$"==i.charAt(a+1))for(a+=2;"$"!=i.charAt(a)||"$"!=i.charAt(a-1);)a++}for(e.push(i.substring(n)),a=0;a<e.length;a++)t[(i=e[a]).substring(0,i.indexOf("="))]=i.substring(i.indexOf("=")+1);return t},_getReportingData:function(e,t){var i=0,n=0;return t||(i=this.interactionData.counterJumpUrlData&&this.interactionData.counterJumpUrlData.tmpData.isClick?1:0,n=this.interactionData.initiationType==EBG.Interactions.InitiationTypes.USER?1:0),t=this.interactionData.value||0,EBG.isObj(t)&&this.interactionData.useInteractionsStrPipe&&(this.interactionData.reportingName==EBG.Interactions.SystemInts.AD_PARAMS&&(t.idx=this.interactionData.numToReport-this.interactionData.numLeftToReport),t=EBG.serializeObject(t)),e=this._buildReportFormat(i,n,t,e),this.unique=0,e},_getBannerRedirectUrl:function(e,t,i,n,a,s){var r,o=this.interactionData.adConfig;return o.massVersioning&&(o.massVersioning.adVersions||o.massVersioning.defaultAdVersion)&&(r=n||EBG.Ads.Ad.Fn.getVersionToReport(o.massVersioning.adVersions)),EBG.InteractionUtil.getBannerRedirectUrl({adConfig:o,sJumpUrl:e,clickVal:t,fIsDefClick:i,sClickedVersion:n,isClickTag:a,versionToReport:r},s)},_handleRemoteServers:function(){if(!EBG.isPreview){if(this.interactionData.remoteServers){var e=this.interactionData.remoteServers,t=new EBG.Events.Event(EBG.Events.EventNames.INTERACTION_REPORT_REMOTE_SERVERS);if(t.dispatcher=this,t.timing=EBG.Events.EventTiming.BEFORE,t.eventData={remoteServers:e},EBG.eventMgr.dispatchEvent(t))return void EBG.log.endGroup();e.networkUrl&&(t=this._replaceRSTokens(e.networkUrl),EBG.adaptor.reportToRemoteServerUsingImage(t)),e.agencyUrl&&(e=this._replaceRSTokens(e.agencyUrl),EBG.adaptor.reportToRemoteServerUsingImage(e))}EBG.log.endGroup()}},_replaceRSTokens:function(e){try{e=(e=e.replace(/\[ebInteraction\]/gi,this.interactionData.reportingName)).replace(/\[ebInteractionNum\]/gi,EBG.intMgr.adsData[this.interactionData.adConfig.uid].numOfInteractions)}catch(e){}return e},_isEBClick:function(){var e=this.interactionData&&this.interactionData.reportingName?this.interactionData.reportingName.toLowerCase():"";return e==EBG.Interactions.SystemInts.CLICK.toLowerCase()||e==EBG.Interactions.SystemInts.DEFAULT_CLICK.toLowerCase()}},EBG.declareClass(EBG.Interactions.CounterInteraction,EBG.Interactions.Interaction),EBG.Interactions.TimerInteraction=function(e){EBG.callSuperConstructor(EBG.Interactions.TimerInteraction,this),this.interactionData=e||new EBG.Interactions.TimerInteractionData,EBG.log.endGroup()},EBG.Interactions.TimerInteraction.prototype={type:EBG.Interactions.InteractionTypes.TIMER,handle:function(e){var t=this.interactionData.value;this.isRunning()&&(this.stop(),this.start());var t=0<(t=this.interactionData.value-t)?t:0,i=(i=this.interactionData.idleDuration/1e3)<=t?i:t;return this.interactionData.value-=i,this.interactionData.idleDuration=0,t=EBG.Interactions.InteractionManager.MAX_AD_DURATION_SEC,this.interactionData.value=this.interactionData.value>t?t:this.interactionData.value,this.interactionData.value=Math.floor(this.interactionData.value),!(this.interactionData.value<=0)&&this._buildReportFormat(0,0,this.interactionData.value,e,0)},start:function(){var e,t=new EBG.Events.Event(EBG.Events.EventNames.START_TIMER);t.dispatcher=this,t.timing=EBG.Events.EventTiming.BEFORE,t.eventData={interaction:this},EBG.eventMgr.dispatchEvent(t)||(this.isRunning()||(e=(new Date).getTime(),this.interactionData.startTime=e,this.interactionData.reportingName,t.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER),EBG.eventMgr.dispatchEvent(t))},stop:function(){var e;this.isRunning()?((e=new EBG.Events.Event(EBG.Events.EventNames.STOP_TIMER)).dispatcher=this,e.timing=EBG.Events.EventTiming.BEFORE,e.eventData={interaction:this},EBG.eventMgr.dispatchEvent(e)||(this.interactionData.value+=this.getElapsedTime()/1e3,this.interactionData.startTime=0,e.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(e))):this.interactionData.value},getElapsedTime:function(){return(new Date).getTime()-this.interactionData.startTime},update:function(e){var t=new EBG.Events.Event(EBG.Events.EventNames.UPDATE_TIMER);t.dispatcher=this,t.timing=EBG.Events.EventTiming.BEFORE,t.eventData={interaction:this},EBG.eventMgr.dispatchEvent(t)||(this.interactionData.value+=e,t.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(t))},clear:function(){this.interactionData.value=0,this.interactionData.startTime=0},increaseIdleDuration:function(e){this.interactionData.reportingName,this.interactionData.idleDuration,this.interactionData.idleDuration+=e},isRunning:function(){return 0<this.interactionData.startTime},isFinished:function(){return 0===this.interactionData.startTime&&0<this.interactionData.value},getValue:function(){return this.interactionData.value},getType:function(){return EBG.DurationInteraction.TIMER}},EBG.declareClass(EBG.Interactions.TimerInteraction,EBG.Interactions.Interaction),EBG.Interactions.IdleManager=function(){this.currentIdleDuration=0,this._startTime=(new Date).getTime(),this.intervalId=EBG.setInterval(this,this._checkIfIdle,[],EBG.Interactions.IdleManager.IDLE_INTERVAL),this._startTime,EBG.log.endGroup()},EBG.Interactions.IdleManager.IDLE_INTERVAL=5e3,EBG.Interactions.IdleManager.prototype={_totalIdleDuration:0,_lastActiveTimeStamp:0,updateIdleDuration:function(){this.currentIdleDuration=0;var e=(new Date).getTime();0!==this._lastActiveTimeStamp&&(this.currentIdleDuration=e-this._lastActiveTimeStamp,this.currentIdleDuration>EBG.Interactions.IdleManager.IDLE_INTERVAL+2e3&&(this._totalIdleDuration+=this.currentIdleDuration,EBG.intMgr.handleAllTimers(EBG.Interactions.InteractionManager.HandleAllTimersOptions.HANDLE_IDLE)))},_checkIfIdle:function(){this.updateIdleDuration(),(this._lastActiveTimeStamp=(new Date).getTime())-this._startTime-this._totalIdleDuration>1e3*EBG.Interactions.InteractionManager.MAX_AD_DURATION_SEC&&(EBG.intMgr.unLoadHandler(),EBG.eventMgr.dispatchEvent(new EBG.Events.Event(EBG.Events.EventNames.MAX_AD_DURATION)),EBG.clearInterval(this.intervalId))}},EBG.declareClass(EBG.Interactions.IdleManager,null),EBG.Interactions.StdInteractionManager=function(){this.adsData=EBG.intMgr?EBG.intMgr.adsData:{},this.adsIntQueues=EBG.intMgr?EBG.intMgr.adsIntQueues:{},this.adDataParamsQueue=EBG.intMgr?EBG.intMgr.adDataParamsQueue:{},EBG.log.endGroup()},EBG.Interactions.StdInteractionManager.prototype={copy:function(e){this.adsIntQueues=e.adsIntQueues,this.adsData=e.adsData,this.adDataParamsQueue=e.adDataParamsQueue},initAdData:function(e,t){var i=e.uid;this.adsData[i],this.adsIntQueues[i]=this.adsIntQueues[i]||[],this.adDataParamsQueue[i]=this.adDataParamsQueue[i]||[],(t=this.adsData[i]={adConfig:e,isUserInteractionOccur:!1,isClickOccur:!1,isProductClicked:{},numOfInteractions:0,delayIntReport:!e.impressionSent&&t,videoState:{},assetsTimers:{}})[EBG.Interactions.InteractionTypes.COUNTER]={},t[EBG.Interactions.InteractionTypes.TIMER]={},t.adConfig.isStdAd||this._addSystemInteractions(e),EBG.log.endGroup()},allowInteractionReport:function(e){this.adsData[e]&&(this.adsData[e].delayIntReport=!1)},addInteraction:function(e,t){t=(EBG.isDefinedNotNull(t)?t:e.interactionData.reportingName).toLowerCase();var i=e.interactionData.adUId,n=new EBG.Events.Event(EBG.Events.EventNames.ADD_INTERACTION);n.eventData=e,n.dispatcher={_adConfig:{rnd:this.adsData[i].adConfig.rnd}},n.timing=EBG.Events.EventTiming.BEFORE;var a=EBG.eventMgr.dispatchEvent(n),s=this.adsData[i];if(!a){if(!s)return;e.interactionData.reportingName,e.type,(s[e.type][t]=e).interactionData.adConfig=this.adsData[i].adConfig}n.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(n),EBG.log.endGroup()},getClickTag:function(e){return(e=this._getCounterInteraction(EBG.Interactions.SystemInts.CLICK,e))?e.getClickTagUrl():""},getClickTarget:function(e){var t="_blank";return t=!EBG.isPreview&&EBG.isInWorkshop&&(e=this._getCounterInteraction(EBG.Interactions.SystemInts.CLICK,e))?e.interactionData.counterJumpUrlData.target:t},handleCloseAdParts:function(e,t){e&&1==e.fClose&&((e=new EBG.Events.Event(EBG.Events.EventNames.CLOSE_AD)).dispatcher={_adConfig:{rnd:EBG.Ads.Ad.Fn.getRandFromAdUId(t)}},e.eventData={closeDueToClickthrough:!0},EBG.eventMgr.dispatchEvent(e))},handleCounterInteraction:function(e,t,i,n,a,s){var r=this._getCounterInteraction(e,t),o=r?r.interactionData:null,d=o?o.counterJumpUrlData:null,E=this.adsData[t],l=E.adConfig.isStdAd;if(s=!EBGInfra.isDefined(s)||s,i=i||o&&o.assetID||0,!l&&o&&(o.initiationType=n?EBG.Interactions.InitiationTypes.USER:o.initiationType,this._handleUserInteraction(t,o),this._handleSpecialInteractions(e,t,i)),r){if((e=new EBG.Events.Event(EBG.Events.EventNames.HANDLE_COUNTER_INTERACTION)).dispatcher={_adConfig:{rnd:EBG.Ads.Ad.Fn.getRandFromAdUId(t)}},e.timing=EBG.Events.EventTiming.BEFORE,e.eventData={interaction:r},EBG.eventMgr.dispatchEvent(e))return;d?(d.tmpData=a,d.tmpData.isClick=o.countAsClick&&!E.isClickOccur,E.isClickOccur=!!d.tmpData.isClick||E.isClickOccur,a=d.tmpData.clickedVersion,d.tmpData.isProductClick=o.countAsClick&&d.tmpData.clickedVersion&&a&&!E.isProductClicked["V_"+a],d.tmpData.isProductClick&&(E.isProductClicked["V_"+a]=!0)):a&&a.value&&(r.interactionData.value=a.value),i=s?r.handle(i):"",E.numOfInteractions++,i&&(this._handleReportData(t,o,i),this._isReportDataInQueue(t,i)||this.reportInteractionQueues()),this.handleCloseAdParts(d,t),e.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(e)}EBG.log.endGroup()},isInteractionExist:function(e,t,i){if(this.adsData[i]&&this.adsData[i][t])return!!this.adsData[i][t][e]},_getCounterInteraction:function(e,t){if(e=e.toLowerCase(),this.adsData[t]&&this.adsData[t][EBG.Interactions.InteractionTypes.COUNTER]&&this.adsData[t][EBG.Interactions.InteractionTypes.COUNTER][e])return this.adsData[t][EBG.Interactions.InteractionTypes.COUNTER][e]}},EBG.declareClass(EBG.Interactions.StdInteractionManager,null),EBG.Interactions.InteractionManager=function(e){EBG.callSuperConstructor(EBG.Interactions.InteractionManager,this),EBG.intMgr&&EBG.intMgr.copy(this),this.idleManager=new EBG.Interactions.IdleManager,this._timedReport=EBG.adaptor.browser.isMobile()?9e4:1e4,this._subscribeToEvents(),EBG.log.endGroup()},EBG.Interactions.InteractionManager.charAdFieldsDelimeter="~",EBG.Interactions.InteractionManager.charIntDelimeter="^",EBG.Interactions.InteractionManager.intStackLength=7,EBG.Interactions.InteractionManager.MAX_AD_DURATION_SEC=900,EBG.Interactions.InteractionManager.INTERACTION_THRESHOLD_SEC=86400,EBG.Interactions.InteractionManager.HandleAllTimersOptions={REPORT:0,PAUSE:1,HANDLE_IDLE:2},EBG.Interactions.InteractionManager.prototype={_isUnloadHandled:!1,_pausedTimers:null,_masterOrdinalNumber:null,_seqTimersReportData:{index:-1,intervals:[5,10,20,40,60,120,240]},startAggregate:function(e,t,i){null==this._masterOrdinalNumber&&(this._masterOrdinalNumber=i),this.startTimer(e,t,i),EBG.log.endGroup()},startTimer:function(e,t,i){var n=this._getTimerInteraction(e,t);if(n){if(n.start(),EBGInfra.isDefined(i)&&EBGInfra.notNull(i))switch(n=this.adsData[t],n=n.assetsTimers[i]||(n.assetsTimers[i]={}),e){case EBG.VideoInteraction.VIDEO_PLAY_DURATION:this._startAssetTimer(n,EBG.VideoInteraction.VIDEO_ASSET_DURATION,t,i);break;case EBG.VideoInteraction.FULLSCREEN_DURATION:this._startAssetTimer(n,EBG.VideoInteraction.FULLSCREEN_ASSET_DURATION,t,i)}EBG.isGlobalDef("JSON")}EBG.log.endGroup()},_handleVideoStarted:function(e,t){var i=new EBG.Events.Event(EBG.Events.EventNames.DWELL_VIDEO_START);i.dispatcher={_adConfig:{rnd:EBG.Ads.Ad.Fn.getRandFromAdUId(e)}},i.eventData={assetId:t},EBG.eventMgr.dispatchEvent(i)},_startAssetTimer:function(e,t,i,n){var a;e[t]||(null!=this._masterOrdinalNumber?(a=new EBG.Interactions.AggregationInteractionData(t,EBG.Interactions.Categories.VIDEO,i),e[t]=new EBG.Interactions.AggregateInteraction(a)):(a=new EBG.Interactions.TimerInteractionData(t,EBG.Interactions.Categories.VIDEO,i),e[t]=new EBG.Interactions.TimerInteraction(a))),e[t].start(),this._handleVideoStarted(i,n)},updateAggregation:function(e,t,i,n){null==this._masterOrdinalNumber&&(this._masterOrdinalNumber=n);var a=this._getTimerInteraction(e,t);if(a&&(this._masterOrdinalNumber==n&&a.update(i),EBGInfra.isDefined(n)&&EBGInfra.notNull(n)))switch(a=this.adsData[t],a=a.assetsTimers[n]||(a.assetsTimers[n]={}),e){case EBG.VideoInteraction.VIDEO_PLAY_DURATION:this._updateAssetAggregation(a,EBG.VideoInteraction.VIDEO_ASSET_DURATION,t,i,n);break;case EBG.VideoInteraction.FULLSCREEN_DURATION:this._updateAssetAggregation(a,EBG.VideoInteraction.FULLSCREEN_ASSET_DURATION,t,i,n)}EBG.log.endGroup()},_updateAssetAggregation:function(e,t,i,n,a){e[t]||(i=new EBG.Interactions.AggregationInteractionData(t,EBG.Interactions.Categories.VIDEO,i),e[t]=new EBG.Interactions.AggregateInteraction(i)),e[t].update(n)},stopAggregate:function(e,t,i){this._masterOrdinalNumber=null,this.stopTimer(e,t,i),EBG.log.endGroup()},stopTimer:function(e,t,i){var n=this._getTimerInteraction(e,t),a=this.adsData[t].assetsTimers,s=!0;if(n){if(EBGInfra.isDefined(i)&&EBGInfra.notNull(i)&&a[i])switch(e){case EBG.VideoInteraction.VIDEO_PLAY_DURATION:a[i][EBG.VideoInteraction.VIDEO_ASSET_DURATION].stop(),s=!this._isRunningVideoAsset(t,!1);break;case EBG.VideoInteraction.FULLSCREEN_DURATION:a[i][EBG.VideoInteraction.FULLSCREEN_ASSET_DURATION].stop()}s&&n.stop(),EBGInfra.isDefined(i)&&EBGInfra.notNull(i)&&((e=new EBG.Events.Event(EBG.Events.EventNames.DWELL_VIDEO_STOP)).dispatcher={_adConfig:{rnd:EBG.Ads.Ad.Fn.getRandFromAdUId(t)}},e.eventData={assetId:i},EBG.eventMgr.dispatchEvent(e))}},clearTimer:function(e,t,i){(i=this._getTimerInteraction(e,t))&&i.clear()},_isRunningVideoAsset:function(e,t){for(var i in e=this.adsData[e].assetsTimers)if(e.hasOwnProperty(i)){var n=t?"ebFSVideoAssetDuration":"ebVideoAssetDuration";if(e[i][n]&&e[i][n].isRunning())return!0}return!1},updateTimer:function(e,t,i,n){e=this._getTimerInteraction(e,t);e&&(e.update(i),EBGInfra.isDefined(n)&&EBGInfra.notNull(n)&&this.adsData[t].assetsTimers[n].update(i))},getTimerValue:function(e,t){return(e=this._getTimerInteraction(e,t))?e.getValue():0},isTimerRunning:function(e,t){return!!(e=this._getTimerInteraction(e,t))&&e.isRunning()},_handleUserInteraction:function(e,t){t.initiationType!=EBG.Interactions.InitiationTypes.USER||this.adsData[e].isUserInteractionOccur||(this.adsData[e].isUserInteractionOccur=!0,(t=new EBG.Events.Event(EBG.Events.EventNames.USER_INTERACTION)).dispatcher={_adConfig:{rnd:EBG.Ads.Ad.Fn.getRandFromAdUId(e)}},EBG.eventMgr.dispatchEvent(t),this._reportUserInteraction(e))},_handlePanelsViewed:function(e,t){t.isPanel&&t.initiationType==EBG.Interactions.InitiationTypes.USER&&this.handleCounterInteraction(EBG.ExpBaseInteractions.PANELS_VIEWED,e)},_handleReportData:function(e,t,i){t.useInteractionsStrPipe?this._handleDataParams(e,t,i):(this.adsIntQueues[e].push(i),e=this.adsIntQueues[e].length>=EBG.Interactions.InteractionManager.intStackLength,(t&&(t.reportImmediately||t.counterJumpUrlData&&t.counterJumpUrlData.tmpData.isClick)||e)&&(t=!t.sync,window.navigator&&navigator.sendBeacon&&!EBG.isMRAID()?this.reportInteractionQueues(t,!1,!0):this.reportInteractionQueues()))},_handleDataParams:function(e,t,i){if(!this.adsData[e].adConfig.Purposes.Measurements){if(t.reportingName==EBG.Interactions.SystemInts.VER_URL)return!1;t.reportingName==EBG.Interactions.SystemInts.PLAYER_PARAMS&&(i=i.replace(/&(bsc|ivp|fs)=-?\d+(\.\d+)?/g,""))}t=this._getAdReportData(e),i=encodeURIComponent(i);var n=this._getPipeParams(e,!1);i=this.adsData[e].adConfig._interactionsStrPipe+"$$"+t+i+"$$"+n,this.adsData[e].delayIntReport?this.adDataParamsQueue[e].push(i):this._reportServer(i,!0)},_handleSpecialInteractions:function(e,t,i){var n=this._getCounterInteraction(e,t);switch(e=n.interactionData,this._handleUserInteraction(t,e),e.reportingName){case EBG.VideoInteraction.STARTED:n.unique&&this._reportUniqueVideoStarted(t),this.adsData[t].isUserInteractionOccur&&this._reportUserInitatedVideo(t,i);break;case EBG.VideoInteraction.FULLSCREEN_START:if(this._isRunningVideoAsset(t,!1))switch(n=this._getTimerInteraction(EBG.VideoInteraction.VIDEO_PLAY_DURATION,t),n=n.getType(),n){case EBG.DurationInteraction.TIMER:this.startTimer(EBG.VideoInteraction.FULLSCREEN_DURATION,t,i),this.stopTimer(EBG.VideoInteraction.VIDEO_PLAY_DURATION,t,i);break;case EBG.DurationInteraction.AGGREGATE:this.startAggregate(EBG.VideoInteraction.FULLSCREEN_DURATION,t,i),this.stopAggregate(EBG.VideoInteraction.VIDEO_PLAY_DURATION,t,i)}break;case EBG.VideoInteraction.FULLSCREEN_END:if(this._isRunningVideoAsset(t,!0))switch(n=this._getTimerInteraction(EBG.VideoInteraction.VIDEO_PLAY_DURATION,t),n=n.getType(),n){case EBG.DurationInteraction.TIMER:this.startTimer(EBG.VideoInteraction.VIDEO_PLAY_DURATION,t,i),this.stopTimer(EBG.VideoInteraction.FULLSCREEN_DURATION,t,i);break;case EBG.DurationInteraction.AGGREGATE:this.startAggregate(EBG.VideoInteraction.VIDEO_PLAY_DURATION,t,i),this.stopAggregate(EBG.VideoInteraction.FULLSCREEN_DURATION,t,i)}break;case EBG.VideoInteraction.FULLPLAY:this.stopTimer(EBG.VideoInteraction.VIDEO_PLAY_DURATION,t,i)}this._handlePanelsViewed(t,e)},handleVideoInteraction:function(e,t,i,n,a){var s,r,o;EBGInfra.isDefined(i)&&EBGInfra.notNull(i)&&((s=this.adsData[t].videoState)[i]||(s[i]=0),r=!0,-1!=(o=EBG.indexOfArray(EBG.VideoQuartiles,e))&&(o==s[i]?(EBG.log.debug(EBG.format("Got VideoInteraction:{0} in the right order ",e)),s[i]++):(EBG.log.warn(EBG.format("Got VideoInteraction:{0} not in the right order - ignored",e)),r=!1)),r&&this.handleCounterInteraction(e,t,i,n,a))},handleAllTimers:function(e,t,i){for(var n in e==EBG.Interactions.InteractionManager.HandleAllTimersOptions.PAUSE&&(this._pausedTimers=[]),(a=new EBG.Events.Event(EBG.Events.EventNames.COLLECT_TIMERS)).dispatcher=this,a.timing=EBG.Events.EventTiming.BEFORE,i&&this.adsData.hasOwnProperty(i)&&(a.eventData={adUId:i}),EBG.eventMgr.dispatchEvent(a),this.adsData)if(this.adsData.hasOwnProperty(n)&&!(i&&i!=n||this.adsData[n].isUnloadHandled)){var a,s=(a=this.adsData[n])[EBG.Interactions.InteractionTypes.TIMER];if(s&&this._handleTimers(s,e,n),a.assetsTimers)for(var r in a.assetsTimers)a.assetsTimers.hasOwnProperty(r)&&this._handleTimers(a.assetsTimers[r],e,n,r);(a=new EBG.Events.Event(EBG.Events.EventNames.COLLECT_TIMERS)).dispatcher=this,a.timing=EBG.Events.EventTiming.ONTIME,i&&(a.eventData={adUId:i}),EBG.eventMgr.dispatchEvent(a),e===EBG.Interactions.InteractionManager.HandleAllTimersOptions.REPORT&&(a=0<=this._seqTimersReportData.index,!(t=!EBG.isBool(t)||t)&&this.adsData[n].adConfig&&navigator&&navigator.sendBeacon&&!EBG.isMRAID()?this.reportInteractionQueues(t,a,!0):this.reportInteractionQueues(t,a))}EBG.log.endGroup()},_handleTimers:function(e,t,i,n){for(var a in e)if(e.hasOwnProperty(a)){var s=e[a];if(s.isRunning()||s.isFinished())switch(t){case EBG.Interactions.InteractionManager.HandleAllTimersOptions.REPORT:var r=new EBG.Events.Event(EBG.Events.EventNames.HANDLE_TIMER_INTERACTION);if(r.dispatcher={_adConfig:{rnd:EBG.Ads.Ad.Fn.getRandFromAdUId(i)}},r.timing=EBG.Events.EventTiming.BEFORE,r.eventData={interaction:s},EBG.eventMgr.dispatchEvent(r))return;(s=s.interactionData.isPanel&&s.interactionData.assetID?s.handle(s.interactionData.assetID):s.handle(n))&&this.adsIntQueues[i].push(s),r.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(r);break;case EBG.Interactions.InteractionManager.HandleAllTimersOptions.PAUSE:s.stop(),this._pausedTimers.push(s);break;case EBG.Interactions.InteractionManager.HandleAllTimersOptions.HANDLE_IDLE:s.increaseIdleDuration(this.idleManager.currentIdleDuration)}}},pauseAllTimers:function(){var e=this.handleAllTimers(EBG.Interactions.InteractionManager.HandleAllTimersOptions.PAUSE,!0);return EBG.log.endGroup(),e},resumeAllTimers:function(){if(null!=this._pausedTimers){for(var e=0;e<this._pausedTimers.length;e++)this._pausedTimers[e].start();this._pausedTimers=null}EBG.log.endGroup()},reportInteractionQueues:function(e,t,i){if(!(EBG.getTime()>EBG.Interactions.InteractionManager.INTERACTION_THRESHOLD_SEC)){e=!EBG.isBool(e)||e,t=!!EBG.isBool(t)&&t;var n,a,s={},r={};for(n in this.adsData)if(this.adsData.hasOwnProperty(n)){var o=this.adsIntQueues[n];if(!this.adsData[n].delayIntReport&&this.adsData[n].adConfig.Purposes.Measurements){for(var d=this.adDataParamsQueue[n];d.length;)this._reportServer(d[0],!0),d.shift();for(;o.length;){for(var d=this._getAdReportData(n),E=this.adsData[n].adConfig._interactionPipe,l=0,c=this._isUnloadHandled||t?o.length:EBG.Interactions.InteractionManager.intStackLength,h=0;h<o.length&&h<c;h++)d+=o[h],l++;for(h=0;h<l;h++)o.shift();this._isUnloadHandled?(""!=(l=s[E]||"")&&(l+="|"),r[E]||(r[E]=this._getPipeParams(n,t)),l+=d,s[E]=l):(d=E+d+this._getPipeParams(n,t),this._reportServer(d,e,i))}}}for(a in s)this._reportServer(a+s[a]+(r[a]||""),e,i)}},_reportServer:function(e,t,i){EBG.isPreview&&!EBG.isGlobalDef("gfEbForceReportInt")||((i=!window.navigator||!EBG.isFunc(navigator.sendBeacon)||EBG.isMRAID()||EBG.adaptor.browser.isiOS()&&!EBG.adaptor.browser.isMac()?!1:i)?EBG.adaptor.reportBeacon(e):EBG.adaptor.reportToRemoteServer(e,t),EBG.Autolina&&EBG.Autolina.report(e,EBG.Autolina.reportType.INTERACTION))},_isReportDataInQueue:function(e,t){var i=!1;e=this.adsIntQueues[e];for(var n=0;n<e.length;n++)if(e[n]===t){i=!0;break}return i},_getPipeParams:function(e,t){var i="",n=this.adsData[e].adConfig.usercookie;return n&&(i+=EBG.format("&usercookie={0}",n)),(n=this.adsData[e].adConfig.optOut)&&(i+=EBG.format("&OptOut={0}",n)),t&&(i+=EBG.format("&iseq={0}",this._seqTimersReportData.index)),EBG.isGlobalDef("gfEbForceReportInt")&&(i+="&pr=1"),i+=EBG.format("&rnd={0}",Math.random()),EBG.adaptor.flash&&(i+=EBG.format("&flv={0}",EBG.adaptor.flash.version)),EBG.isDefined(EBG.adaptor.getResolution)&&(i+=EBG.format("&res={0}",EBG.adaptor.getResolution())),EBGInfra.isDefinedNotNull(this.adsData[e].adConfig.diAppId)&&(i+="&diappid="+this.adsData[e].adConfig.diAppId),i},_getAdReportData:function(e){var t=this.adsData[e].adConfig,i=EBG.Interactions.InteractionManager.charAdFieldsDelimeter;return e=EBG.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}{9}{10}{11}{12}",EBG.Ads.Ad.Fn.getAdIdFromAdUId(e),i,t.page,i,t.pluId,i,t.massVersioning.targetAudienceId,i,t.massVersioning.logDeliveryGroupId,i,EBG.Ads.Ad.Fn.getVersionToReport(t.massVersioning.adVersions),i,this.adsData[e].adConfig.sID),EBG.log.endGroup(),e},_addSystemInteractions:function(e){e=e.uid;var t=new EBG.Interactions.CounterInteractionData(EBG.Interactions.SystemInts.USER_INTERACTION,EBG.Interactions.Categories.SYSTEM,e);t.numLeftToReport=1,t=new EBG.Interactions.CounterInteraction(t),this.addInteraction(t),(t=new EBG.Interactions.CounterInteractionData(EBG.Interactions.SystemInts.UNIQUE_VIDEO_STARTED,EBG.Interactions.Categories.VIDEO,e)).numLeftToReport=1,t=new EBG.Interactions.CounterInteraction(t),this.addInteraction(t),(t=new EBG.Interactions.CounterInteractionData(EBG.Interactions.SystemInts.DWELL_UNIQUE,EBG.Interactions.Categories.SYSTEM,e)).reportImmediately=!0,t.numLeftToReport=1,t=new EBG.Interactions.CounterInteraction(t),this.addInteraction(t),t=new EBG.Interactions.CounterInteractionData(EBG.Interactions.SystemInts.REPLAY,EBG.Interactions.Categories.SYSTEM,e),t=new EBG.Interactions.CounterInteraction(t),this.addInteraction(t),(e=new EBG.Interactions.CounterInteractionData(EBG.Interactions.SystemInts.RICH_FLASH_PLAYED,EBG.Interactions.Categories.SYSTEM,e)).numLeftToReport=1,e=new EBG.Interactions.CounterInteraction(e),this.addInteraction(e)},_reportUserInitatedVideo:function(e,t){this.handleVideoInteraction(EBG.VideoInteraction.USER_INITIATED_VIDEO,e,t)},_reportUserInteraction:function(e){this.handleCounterInteraction(EBG.Interactions.SystemInts.USER_INTERACTION,e)},_reportUniqueVideoStarted:function(e){this.handleCounterInteraction(EBG.Interactions.SystemInts.UNIQUE_VIDEO_STARTED,e)},reportDwellUnique:function(e,t){t&&this.handleCounterInteraction(EBG.Interactions.SystemInts.DWELL_UNIQUE,e,null,!1)},reportRichFlashPlayed:function(e){this.handleCounterInteraction(EBG.Interactions.SystemInts.RICH_FLASH_PLAYED,e)},reportReplay:function(e){this.handleCounterInteraction(EBG.Interactions.SystemInts.REPLAY,e,0,EBG.ActionType.USER)},_getTimerInteraction:function(e,t){if(e=e.toLowerCase(),this.adsData[t]&&this.adsData[t][EBG.Interactions.InteractionTypes.TIMER]&&this.adsData[t][EBG.Interactions.InteractionTypes.TIMER][e])return this.adsData[t][EBG.Interactions.InteractionTypes.TIMER][e]},_subscribeToEvents:function(){var e=EBG.adaptor.supportsPageLoadEvents();e&&(EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_BEFORE_UNLOAD,this.unLoadHandler,this)),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_UNLOAD,this.unLoadHandler,this)),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_HIDE,this.unLoadHandler,this)),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.AD_UNLOAD,this.unLoadHandler,this)),EBG.setInterval(this,this.reportInteractionQueues,[],this._timedReport)),e&&!EBG.adaptor.browser.isMobile()||EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.IMPRESSION_SENT,this._startSequence,this))},_startSequence:function(){this._setNextTimerSeq(!0)},_handleAllTimersSeq:function(){var e=EBG.adaptor.browser.isMobile();EBG.adaptor.supportsPageLoadEvents(),this.reportInteractionQueues(!e),this._pausedTimers||(this.handleAllTimers(EBG.Interactions.InteractionManager.HandleAllTimersOptions.REPORT,!e),this.resumeAllTimers()),this._setNextTimerSeq(!1),EBG.log.endGroup()},_setNextTimerSeq:function(e){(e=void 0!==e&&e?this._seqTimersReportData.index=0:++this._seqTimersReportData.index)<this._seqTimersReportData.intervals.length&&(e=1e3*this._seqTimersReportData.intervals[e],EBG.runTimed(this,this._handleAllTimersSeq,[],e))},unLoadHandler:function(e){if(!EBG.intMgr._isUnloadHandled)if(e&&e.name==EBG.Events.EventNames.AD_UNLOAD){var t=e.dispatcher._adConfig.uid;this.adsData[t].isUnloadHandled||(this.handleCounterInteraction(EBG.Interactions.SystemInts.END_OF_SESSION,t,null,null,null),this.handleAllTimers(EBG.Interactions.InteractionManager.HandleAllTimersOptions.REPORT,!1,t)),this.adsData[t].isUnloadHandled=!0}else{for(t in EBG.intMgr._isUnloadHandled=!0,this.adsData)this.adsData.hasOwnProperty(t)&&!this.adsData[t].isUnloadHandled&&this.handleCounterInteraction(EBG.Interactions.SystemInts.END_OF_SESSION,t,null,null,e?null:{value:1});this.handleAllTimers(EBG.Interactions.InteractionManager.HandleAllTimersOptions.REPORT,!1)}},getAdDuration:function(e){var t=0;return t=(e=this._getTimerInteraction(EBG.Interactions.SystemInts.AD_DURATION,e))?e.getElapsedTime():t}},EBG.declareClass(EBG.Interactions.InteractionManager,EBG.Interactions.StdInteractionManager),EBG.DataProfile={GENERAL:"general",SERVING:"serving",URLS:"urls",USERINFO:"userInfo",PLATFORM:"platform",VISIBILITY:"visibility",FRAUD:"fraud",ERROR:"error",INTERACTION:"interaction",DEBUG:"debug"},EBG.DataPipe=function(e){this._profile=this._completeProfile,this._firstTickDelay=5e3,this._buckets={},this._clientTick=e,this._subscribeToUnloadEvents(),EBG.runTimed(this,this._tick,[],this._firstTickDelay)},EBG.DataPipe.prototype={_data:{general:{}},_tickCount:0,_tickDelay:1,_maxTicks:1,_unloadHandled:!1,_completeProfile:{general:{sid:!0,srcv:!0,dpv:!0,ctick:!0,ctime:!0,tzoff:!0,adid:!0,pid:!0,cid:!0,advid:!0,siteid:!0,AgencyID:!0,src:!0},serving:{frmt:!1,img:!1,prtcl:!1,srvmd:!1,inapp:!1,env:!1,dt:!1,rdi:!1,cimp:!1,cb:!1,aie:!1,size:!1,loc:!1,afma:!1,mraid:!1,fmraid:!1,dmraid:!1,mraidv:!1,bi:!1,wvsb:!1,wvrf:!1,adkit:!1,sf:!1,instream:!1,isplu:!1,cs:!1},urls:{dmn:!1,turl:!1,rurl:!1,pburl:!1,aorg:!1},userInfo:{geo:!1,ip:!1},platform:{os:!1,osv:!1,brsrc:!1,brsrv:!1,brsrt:!1,skype:!1},fraud:{bot:!1,injct:!1,stack:!1},visibility:{vsbp:!1,pct:!1,scrsr:!1,vsr:!1,vsri:!1,uvsr:!1,vsiab:!1,uvsiab:!1},error:{errnum:!1,errmsg:!1,errfunc:!1,errpos:!1,errstack:!1},interaction:{IntrN:!1,IntrT:!1,Usr:!1,ua:!1},debug:{}},createBucket:function(e,t,i){this._buckets[e]={profile:t,url:i}},isBucketExists:function(e){return!!this._buckets[e]},_clear:function(){for(var e in this._profile){var t=void 0;for(t in this._profile[e])!this._profile[e][t]&&this._data[e]&&(this._data[e][t]=null,delete this._data[e][t])}},_post:function(){var a={x:function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(var e,t=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],i=0;i<t.length;i++)try{e=new ActiveXObject(t[i]);break}catch(e){}return e},get:function(e,t,i){try{var n;t&&t.sid&&(e=e+"?json="+JSON.stringify(t),(n=a.x()).open("GET",e,i),n.send(null))}catch(e){}},post:function(e,t,i){try{var n;t&&t.sid&&((n=a.x()).open("POST",e,i),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(JSON.stringify(t)))}catch(e){}}};return window.mraid?a.get:a.post}(),_tick:function(){this._unloadHandled||(++this._tickCount,this.flush(),this._tickCount<this._maxTicks&&(EBG.runTimed(this,this._tick,[],1e3*Math.pow(2,this._tickDelay)),this._tickDelay++))},send:function(e,t,i){if(i=i||{},this._profile[e]){for(var n in this._data[e]=this._data[e]||{},t)if(("debug"==e||n in this._profile[e])&&EBG.isDefinedNotNull(t[n])){if(EBG.isArray(t[n]))for(var a=[],s=0;s<t[n].length;++s)a.push(encodeURIComponent(t[n][s]));else a=encodeURIComponent(t[n]);this._data[e][n]=a}if(i.constant)for(n in this._data[e])this._profile[e][n]=!0;i.flush&&this.flush()}},flush:function(){for(var e in this._buckets)if(this._buckets.hasOwnProperty(e)){var e=this._buckets[e],t=e.profile;if((e=e.url)&&t){this._clientTick&&(this._data.general.ctick=+new Date-this._clientTick);for(var i={},n=0;n<t.length;++n){var a,s=t[n];for(a in this._data[s])i[a]=this._data[s][a]}this._post(e,i,!this._unloadHandled)}}this._clear()},sendNow:function(e,t){for(var i in this._data.general)this._data.general.hasOwnProperty(i)&&(t[i]=this._data.general[i]);t.ctick=+new Date-this._clientTick,this._post(e,t,!this._unloadHandled)},_subscribeToUnloadEvents:function(){EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_BEFORE_UNLOAD,this._unloadHandler,this)),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_UNLOAD,this._unloadHandler,this)),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_HIDE,this._unloadHandler,this))},_unloadHandler:function(){this._unloadHandled||(this._unloadHandled=!0,this._tickCount<this._maxTicks&&(this._tickCount=this._maxTicks,this.flush()))}},EBG.DataPipeManager=function(e){this._clientTick=e},EBG.DataPipeManager.prototype={_pipes:{},createPipe:function(e){var t=new EBG.DataPipe(this._clientTick);t.send(EBG.DataProfile.GENERAL,{sid:e,dpv:2,src:"v2"}),this._pipes[e]=t},getPipe:function(e){return this._pipes[e]||this.createPipe(e),this._pipes[e]},send:function(e,t,i,n){(e=this._pipes[e])&&e.send(t,i,n)}},EBG.declareNamespace("Positioning"),EBG.Positioning.PositionManager=function(){},EBG.Positioning.PositionManager.prototype={isVisibile:function(e,t,i){try{var n=0<this.calculateVisibilityPercentage(e,t,i);return EBG.log.endGroup(),n}catch(e){}},calculateVisibilityPercentage:function(t,e,i,n,a,s,r){try{var o=0,d=!(EBG.adaptor.getDisplayWin()!=top&&r==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME),E=EBG.adaptor.getScrollLeftTop(d,r),l=EBG.adaptor.getViewPortMetrics(d,s,r),c=this.calculateRightBottowCoordinate(E,l.Width,l.Height),h=EBG.adaptor.getPositioningById(t,!d,r);if(null!=h){t={X:0,Y:0};try{!d&&window.frameElement&&(t=EBG.adaptor.getPositioningByElement(window.frameElement,!1,r))}catch(e){t={X:0,Y:0}}h.X+=t.X,h.Y+=t.Y,void 0!==n&&(h.X+=n),void 0!==a&&(h.Y+=a);var u=this.calculateRightBottowCoordinate(h,e,i),g=e*i,p=this.calculateVisibleArea(E,c,h,u),o=g?p/g:0}return EBG.log.endGroup(),o}catch(e){}},calculateRightBottowCoordinate:function(e,t,i){var n={X:0,Y:0};return n.X=e.X+t,n.Y=e.Y+i,n},calculateVisibleArea:function(e,t,i,n){try{var a=0,s=0;return i.Y==n.Y&&i.X==n.X||t.X<=e.X||t.Y<=e.Y?0:(i.X<=e.X&&e.X<=n.X?a=t.X<=n.X?t.X-e.X:n.X-e.X:e.X<=i.X&&i.X<=t.X&&(a=n.X>=t.X?t.X-i.X:n.X-i.X),i.Y<=e.Y&&e.Y<=n.Y?s=t.Y<=n.Y?t.Y-e.Y:n.Y-e.Y:e.Y<=i.Y&&i.Y<=t.Y&&(s=n.Y>=t.Y?t.Y-i.Y:n.Y-i.Y),EBG.log.endGroup(),a*s)}catch(e){}},getFullRectWithClip:function(e,t){var i,n,a,s=EBG.adaptor.getDisplayWin()===EBG.adaptor.getPageWin(),r=null;return e&&(t=EBG.adaptor.getPositioningByElement(e,!s,t),r={width:e.offsetWidth,height:e.offsetHeight},e=e.style.clip,i=s=0,n=r.height,a=r.width,""!=e&&(e=(e=e.substring(e.indexOf("(")+1).replace(/,/g,"").replace(/ /g,"")).split("px"),i=parseInt(e[0]),a=parseInt(e[1]),n=parseInt(e[2]),s=parseInt(e[3])),r.left=t.X+s,r.top=t.Y+i,r.width-=r.width-a,r.width-=s,r.height-=r.height-n,r.height-=i,r.right=r.left+r.width,r.bottom=r.top+r.height),r},isOverlapping:function(e,t,i){return!(!e||0==e.offsetWidth&&0==e.offsetHeight||!t||0==t.offsetWidth&&0==t.offsetHeight)&&(e=EBG.posHelper.getFullRectWithClip(e,i),t=EBG.posHelper.getFullRectWithClip(t,i),!(!e||!t||e.bottom<t.top||e.top>t.bottom||e.right<t.left||e.left>t.right))}},EBG.declareClass(EBG.Positioning.PositionManager,null),EBG.declareNamespace("RichModules"),EBG.RichModules.BasicVisibilityProvider=function(e,t,i){this._resObjId=e,this._res=EBG.adaptor.getElementById(e),this._adConfig=this.adConfig=t,this._options=i||{},this._subscribeToEvents(),this._trackElementLocation()},EBG.RichModules.BasicVisibilityProvider._isAvailable=function(e){return!1},EBG.RichModules.BasicVisibilityProvider.prototype={name:"Basic",_isStarted:!1,_calculateVisibilityPercentage:function(e){return 0},_getViewPortMetrics:function(){return null},_dispatchCheckVisibility:function(e){var t;this._isStarted&&((t=new EBG.Events.Event(EBG.Events.EventNames.VISIBILITY_CHECK)).dispatcher=this,t.eventData=e,EBG.isObj(this._options.customData)&&(t.eventData.customData=this._options.customData),t.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.dispatchEvent(t))},_dispatchVisibilityHidden:function(){var e=new EBG.Events.Event(EBG.Events.EventNames.VISIBILITY_HIDDEN);e.dispatcher=this,e.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.dispatchEvent(e)},_subscribeToEvents:function(){var e=new EBG.Events.EventSubscription(EBG.Events.EventNames.EXPAND,function(e){e.eventData.props&&e.eventData.props.asset.id==this._resObjId&&this._trackElementLocation()},this);e.timing=EBG.Events.EventTiming.ONTIME,e.dispatcherFilters={"_adConfig.rnd":this.adConfig.rnd},EBG.eventMgr.subscribeToEvent(e)},updateResourceObjId:function(e){EBG.elementWatcher&&EBG.elementWatcher.unwatch(null,this._res,this),this._resObjId=e,this._res=EBG.adaptor.getElementById(e),this._trackElementLocation()},_isVisible:function(){return!1},_calculateVisibilityResult:function(){var e={};try{e.assetId=this._resObjId,e.percentage=this._calculateVisibilityPercentage(),e.viewPort=this._getViewPortMetrics()}catch(e){}return e},start:function(){this._isStarted=!0,this._triggerVisibilityCheck();var e=10;!function(){e--&&(this._triggerVisibilityCheck(),EBG.runTimed(this,arguments.callee,[],1e3))}.apply(this)},_trackElementLocation:function(){(this._res=EBG.adaptor.getElementById(this._resObjId))?EBG.elementWatcher&&EBG.elementWatcher.watch(this._res,this._elemWatcherCallback,this,null,{clip:!0,relativeToWindow:!1}):EBG.runTimed(this,this._trackElementLocation,[],500)},_elemWatcherCallback:function(e){this.onElementMoved(),null==e&&this._trackElementLocation()},_triggerVisibilityCheck:function(){var e=this._calculateVisibilityResult();this._dispatchCheckVisibility(e)},onElementMoved:function(){}},EBG.declareClass(EBG.RichModules.BasicVisibilityProvider,null),EBG.declareNamespace("RichModules"),EBG.RichModules.GeometricVisibilityProvider=function(e,t,i){EBG.callSuperConstructor(EBG.RichModules.GeometricVisibilityProvider,this,[e,t,i])},EBG.RichModules.GeometricVisibilityProvider.prototype={name:"Geometric",_focusOnResourceElem:null,_justReceivedFocusOnPage:null,_reachedMaxAdDuration:!1,_calculateVisibilityPercentage:function(e){try{if(!EBG.adaptor.isPageVisible(this.adConfig.isInstream))return 0;e=e||{};var t=this._getAssetRect(e.resourceObjId||this._resObjId),i=this._getViewPortRect();if(t.top+=~~e.offsetY,t.bottom+=~~e.offsetY,t.left+=~~e.offsetX,t.right+=~~e.offsetX,EBG.isDefined(e.width)&&(t.width=e.width,t.right=t.left+e.width),EBG.isDefined(e.height)&&(t.height=e.height,t.bottom=t.top+e.height),this._intersect(t,i)){var n=this._overlap(i,t);return~~((this._visibleRect=n).width*n.height/(t.width*t.height)*100)}return 0}catch(e){return 0}},_getAssetRect:function(e){return e=EBG.isElementOrNode(e)?e:EBG.adaptor.getElementById(e),e=!(e=EBG.adaptor.getBoundingClientRect(e,{clip:!0,relativeToTop:!0}))?{top:0,bottom:0,left:0,right:0,width:0,height:0}:e},_getViewPortMetrics:function(){var e=EBG.adaptor._getCurrentWindow(void 0,this.adConfig.actualServingMode),t=EBG.adaptor.getWindowViewPortMetrics(e);return!EBG.adaptor.browser.isFF()||void 0===e.outerWidth||EBG.adaptor.serving.detectServingMode(!0)!=EBG.Adaptors.ServingMode.IFRAME||void 0!==this.adConfig&&EBG.isDefined(this.adConfig.UiVz)&&this.adConfig.UiVz||EBG.iframeLocation||void 0===this.adConfig||!this.adConfig.aiE||this.adConfig.aiE.iflExists||(t.Width=e.outerWidth,t.Height=e.outerHeight,EBG.isDefined(e.scrollMaxX)&&0<e.scrollMaxX&&EBG.isDefined(EBG.adaptor.scrollBarWidth)&&0<EBG.adaptor.scrollBarWidth&&(t.Height-=EBG.adaptor.scrollBarWidth),EBG.isDefined(e.scrollMaxY)&&0<e.scrollMaxY&&EBG.isDefined(EBG.adaptor.scrollBarHeight)&&0<EBG.adaptor.scrollBarHeight&&(t.Width-=EBG.adaptor.scrollBarHeight)),t},_getViewPortRect:function(){var e=this._getViewPortMetrics();return{top:0,left:0,right:e.Width,bottom:e.Height}},_overlap:function(e,t){var i={top:-1,right:-1,bottom:-1,left:-1};return this._intersect(e,t)&&(i.top=Math.max(e.top,t.top),i.left=Math.max(e.left,t.left),i.right=Math.min(e.right,t.right),i.bottom=Math.min(e.bottom,t.bottom),i.width=i.right-i.left,i.height=i.bottom-i.top),i},_intersect:function(e,t){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)},_isVisible:function(e){e=e||{};var t=EBG.adaptor.getBoundingClientRect(this._res,{clip:!0});return!!this._calculateVisibilityPercentage({resourceObjId:e.resourceObjId||this._resObjId,width:e.width||t.width,height:e.height||t.height,offsetX:e.offsetX||this.adConfig.offsetX,offsetY:e.offsetY||this.adConfig.offsetY,isUIVZ:e.isUIVZ||this.adConfig.UiVz,actualServingMode:e.actualServingMode||this.adConfig.actualServingMode})},_subscribeToEvents:function(){try{EBG.callSuperFunction(EBG.RichModules.GeometricVisibilityProvider,this,"_subscribeToEvents"),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_RESIZE,this._pageResizeHandler,this)),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_SCROLL,this._pageScrollHandler,this)),(!EBG.adaptor._getVisibilityEventName()||EBG.adaptor.browser.isAndroidNative()&&EBG.adaptor.browser.getVersion()<4.4)&&(EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_FOCUS,this._pageFocusHandler,this)),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_BLUR,this._pageBlurHandler,this)),this._subscribeToElementEvents());var e=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_HIDDEN,this._pageHiddenHandler,this);e.isDocumentEvent=!0,EBG.eventMgr.subscribeToEvent(e),(e=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_VISIBLE,this._pageVisibleHandler,this)).isDocumentEvent=!0,EBG.eventMgr.subscribeToEvent(e),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.RICH_FLASH_PLAYED,this.onChange,this))}catch(e){}},_subscribeToElementEvents:function(){var e=this,t=new EBG.Events.EventSubscription("focus",function(){e._resourceFocusHandler()},this);t.isElementEvent=!0,t.elementId=this._resObjId,EBG.eventMgr.subscribeToEvent(t),EBG.adaptor.browser.isIE()&&this.actualServingMode!=EBG.Adaptors.ServingMode.SCRIPT&&((t=new EBG.Events.EventSubscription("blur",function(){e._resourceBlurHandler()},this)).isElementEvent=!0,t.elementId=this._resObjId,EBG.eventMgr.subscribeToEvent(t))},updateResourceObjId:function(e){EBG.callSuperFunction(EBG.RichModules.GeometricVisibilityProvider,this,"updateResourceObjId",[e]),EBG.adaptor._getVisibilityEventName()||this._subscribeToElementEvents()},_pageVisibleHandler:function(){this._triggerVisibilityCheck()},_pageHiddenHandler:function(){var e;this._dispatchVisibilityHidden(),this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&(e=this._getViewPortMetrics(),this._dispatchCheckVisibility({percentage:0,viewPort:e}))},_resourceFocusHandler:function(){this._focusOnResourceElem=!0,EBG.runTimed(this,function(){this._focusOnResourceElem=!1},[],60),this._pageFocusHandler()},_resourceBlurHandler:function(){EBG.runTimed(this,function(){this._justReceivedFocusOnPage||this._focusOnResourceElem||this._pageBlurHandler()},[],30)},_pageFocusHandler:function(){this._justReceivedFocusOnPage=!0,EBG.runTimed(this,function(){this._justReceivedFocusOnPage=!1},[],60),this._triggerVisibilityCheck()},_pageBlurHandler:function(){EBG.runTimed(this,function(){this._justReceivedFocusOnPage||this._getAdHasFocus()||this._pageHiddenHandler()},[],30)},_getAdHasFocus:function(){for(var e=this._getAllAdVisibilityProviders(),t=0;t<e.length;t++)if(e[t]._focusOnResourceElem)return!0;return!1},_getAllAdVisibilityProviders:function(){var e,t=[],i=EBG.ads[this._adConfig.uid];for(e in i)i.hasOwnProperty(e)&&i[e]instanceof EBG.RichModules.VisibilityManager&&i[e]._visibilityProvider&&t.push(i[e]._visibilityProvider);return t},_pageScrollHandler:function(){this._triggerVisibilityCheck()},_pageResizeHandler:function(){var e;this._resizeTimeOut||((e=this)._resizeTimeOut=setTimeout(function(){e._resizeTimeOut=null,e._triggerVisibilityCheck()},100))},_maxAdDurationHandler:function(){this._reachedMaxAdDuration=!0},start:function(){EBG.callSuperFunction(EBG.RichModules.GeometricVisibilityProvider,this,"start")},onElementMoved:function(){EBG.callSuperFunction(EBG.RichModules.GeometricVisibilityProvider,this,"onElementMoved"),this._triggerVisibilityCheck()},onChange:function(){this._triggerVisibilityCheck()},_calculateVisibilityResult:function(){var e=EBG.callSuperFunction(EBG.RichModules.GeometricVisibilityProvider,this,"_calculateVisibilityResult");return e.visibleRect=this._visibleRect,e}},EBG.declareClass(EBG.RichModules.GeometricVisibilityProvider,EBG.RichModules.BasicVisibilityProvider),EBG.RichModules.MouseVisibilityProvider=function(e,t,i){EBG.callSuperConstructor(EBG.RichModules.MouseVisibilityProvider,this,[e,t,i]);try{this._subscribeToEvents(),this._scrollWidth=EBG.adaptor.getScrollerWidth();var n=this.adConfig.displayWin||EBG.adaptor.getDisplayWin();this._screenResolution={width:n.screen.availWidth,height:n.screen.availHeight},this._screenOriginalResolution={width:n.screen.availWidth,height:n.screen.availHeight},this._browserStateSupported()||(this._resolutionBaseScreenSize=this._resolutionToScreenSize(this._screenResolution),this._resourceInitialPosition={top:n.screenTop,left:n.screenLeft});var a=this._getDimensions();this._resourceFullSize=a.width*a.height,this._mouseMoveEventInvoker()}catch(e){e.description}},EBG.RichModules.MouseVisibilityProvider.prototype={name:"Mouse",isTimedBaseVisibility:!0,_isStarted:!1,_resObj:null,_lastViewPort:null,_resourceRect:null,_resourceFullSize:null,_screenResolution:null,_screenOriginalResolution:null,_screenInitialPosition:{top:0,left:0},_resolutionBaseScreenSize:null,_intervalId:null,_calculateVisibilityPercentage:function(){if(!this._isReady)return-1;var e=this._getViewPortRect(),t=this._resourceRect;if(!e||!t)return-1;var i=0;return EBG.adaptor.isPageVisible()&&(i=this._getDimensions(),this._resourceFullSize=i.width*i.height,i=EBG.posHelper.calculateVisibleArea({X:e.left,Y:e.top},{X:e.right,Y:e.bottom},{X:t.left,Y:t.top},{X:t.right,Y:t.bottom})/this._resourceFullSize*100),i},_calcResourceRect:function(e){var t,i;return e=8==EBG.adaptor.browser._browserVer&&8==EBG.adaptor.browser.getDocumentMode()?(t=(i=EBG.adaptor.getElementById(this._resObjId))&&i.getBoundingClientRect?i.getBoundingClientRect():{top:0,left:0},i=e.screenY-(e.clientY-t.top),e.screenX-(e.clientX-t.left)):(i=e.screenY-e.offsetY,e.screenX-e.offsetX),{top:i,left:e,bottom:i+(t=this._getDimensions()).height,right:e+t.width}},_getViewPortRect:function(){var e=null,t=this._getWindowRect();return e=t?{top:t.top<0?0:t.top,left:t.left<0?0:t.left,bottom:t.bottom>this._screenResolution.height?this._screenResolution.height:t.bottom,right:t.right>this._screenResolution.width?this._screenResolution.width:t.right}:e},_getWindowRect:function(){var e,t,i,n=null,a=this.adConfig.displayWin||EBG.adaptor.getDisplayWin();return this._browserStateSupported()?(e=(n=this._isFullScreen(a))?0:6,t=a.screenX+e,n={top:i=a.screenY+70,left:t,bottom:i+a.outerHeight-this._scrollWidth-(n?0:70),right:t+a.outerWidth-this._scrollWidth+e}):this._resolutionBaseScreenSize&&(n={top:(a=this._getUnsupportedWindowTopLeft(a)).top,left:a.left,bottom:a.top+this._resolutionBaseScreenSize.height,right:a.left+this._resolutionBaseScreenSize.width}),n},_getUnsupportedWindowTopLeft:function(e){var t={top:this._screenInitialPosition.top,left:this._screenInitialPosition.left},i=0<e.screenLeft?e.screenLeft:0,n=i-this._resourceInitialPosition.left,a=1+(0<n?this._screenOriginalResolution.width-this._resourceInitialPosition.left%this._screenOriginalResolution.width:this._resourceInitialPosition.left%this._screenOriginalResolution.width);return Math.abs(n)>a&&0<=i&&i<this._screenResolution.width&&(a=(1+Math.floor(Math.abs(Math.abs(n)-a)/this._screenOriginalResolution.width))*this._screenOriginalResolution.width,t.left=n<0?t.left-a:t.left+a),a=1+(0<(n=(e=0<e.screenTop?e.screenTop:0)-this._resourceInitialPosition.top)?this._screenOriginalResolution.height-this._resourceInitialPosition.top%this._screenOriginalResolution.height:this._resourceInitialPosition.top%this._screenOriginalResolution.height),Math.abs(n)>a&&0<=e&&e<this._screenResolution.height&&(a=(1+Math.floor(Math.abs(Math.abs(n)-a)/this._screenOriginalResolution.height))*this._screenOriginalResolution.height,t.top=n<0?t.top-a:t.top+a),t},_isFullScreen:function(e){return!this._browserStateSupported()||e.screenX+e.outerWidth==this._screenOriginalResolution.width},_getViewPortMetrics:function(){var e=this._getViewPortRect();return e?{Width:e.right-e.left,Height:e.bottom-e.top}:null},_isVisible:function(){return!!this._calculateVisibilityPercentage()},_mouseMoveEventInvoker:function(){var n;(this._resObj=this._resObj||EBG.adaptor.getElementById(this._resObjId))&&this._resObj.parentNode&&this._resObj.parentNode.fireEvent?((n=this)._resObj.parentNode.attachEvent("onmousemove",function(e){var t=n._calcResourceRect(e),i=n._getViewPortRect();n._resourceRect||(n._screenInitialPosition.left=Math.floor(e.screenX/n._screenOriginalResolution.width)*n._screenOriginalResolution.width,n._screenInitialPosition.top=Math.floor((50<e.screenY?e.screenY-50:0)/n._screenOriginalResolution.height)*n._screenOriginalResolution.height),n._handleMultipleScreen(e),n._handleRecievedData(t,i)}),this._intervalId=EBG.setInterval(this._resObj.parentNode,function(){this.fireEvent("onmousemove")},[],EBG.RichModules.VisibilityManager.VisibilityCheckInterval)):EBG.runTimed(this,this._mouseMoveEventInvoker,[],EBG.RichModules.VisibilityManager.VisibilityCheckInterval)},_handleMultipleScreen:function(e){var t,i=this._getWindowRect();i&&(e.screenY>this._screenOriginalResolution.height&&(t=i.bottom>e.screenY?i.bottom:e.screenY,this._screenResolution.height<t&&(this._screenResolution.height=t)),e.screenX>this._screenOriginalResolution.width&&(e=i.right>e.screenX?i.right:e.screenX,this._screenResolution.width<e&&(this._screenResolution.width=e)))},_handleRecievedData:function(e,t){this._resourceRect&&!this._checkRectanglesDifferent(this._resourceRect,e,1)&&!this._checkRectanglesDifferent(this._lastViewPort,t,1)||(this._resourceRect=e,this._lastViewPort=t,this._triggerCalculation())},_checkRectanglesDifferent:function(e,t,i){for(var n in e)if(e.hasOwnProperty(n)&&Math.abs(e[n]-t[n])>i)return!0;return!1},_subscribeToEvents:function(){EBG.callSuperFunction(EBG.RichModules.BasicVisibilityProvider,this,"_subscribeToEvents");var e=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_HIDDEN,this._pageHiddenHandler,this);e.isDocumentEvent=!0,EBG.eventMgr.subscribeToEvent(e),(e=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_VISIBLE,this._pageVisibleHandler,this)).isDocumentEvent=!0,EBG.eventMgr.subscribeToEvent(e)},_pageVisibleHandler:function(){this._triggerVisibilityCheck()},_pageHiddenHandler:function(){var e;this._dispatchVisibilityHidden(),this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&(e=this._getViewPortMetrics(),this._dispatchCheckVisibility({percentage:0,viewPort:e}))},_resolutionToScreenSize:function(e){var t={width:e.width,height:e.height};return 1680==e.width&&1050==e.height?t={width:1444,height:806}:1366==e.width&&768==e.height?t={width:1173,height:562}:1360==e.width&&768==e.height?t={width:1167,height:562}:1280==e.width&&1024==e.height?t={width:1097,height:785}:1280==e.width&&960==e.height?t={width:1097,height:730}:1152==e.width&&864==e.height?t={width:985,height:645}:1024==e.width&&768==e.height?t={width:875,height:562}:800==e.width&&600==e.height&&(t={width:680,height:416}),t},_triggerCalculation:function(){var e;(this._isReady||this._isStarted&&this._resourceRect)&&(this._isReady=!0,e=this._calculateVisibilityResult(),this._dispatchCheckVisibility(e))},_getDimensions:function(){if(this.adConfig.width&&this.adConfig.height&&"100%"!=this.adConfig.width&&"100%"!=this.adConfig.height)return{width:this.adConfig.width,height:this.adConfig.height};var e=EBG.adaptor.getElementById(this.adConfig.placeHolderId);return{width:(e=EBG.adaptor.getBoundingClientRect(e)||{width:0,height:0}).width,height:e.height}},_browserStateSupported:function(){return 9<=EBG.adaptor.browser._browserVer&&9<=EBG.adaptor.browser.getDocumentMode()},updateResourceObjId:function(e){this._resObj=null,this._intervalId&&EBG.clearInterval(this._intervalId),EBG.callSuperFunction(EBG.RichModules.MouseVisibilityProvider,this,"updateResourceObjId",[e]),this._mouseMoveEventInvoker()},start:function(){EBG.callSuperFunction(EBG.RichModules.MouseVisibilityProvider,this,"start"),this._isStarted=!0,this._triggerCalculation()}},EBG.declareClass(EBG.RichModules.MouseVisibilityProvider,EBG.RichModules.BasicVisibilityProvider),EBG.declareNamespace("RichModules"),EBG.RichModules.VisibilityManager=function(e,t,i){this._adConfig=this.adConfig=e,this._resObjId=t,this._res=EBG.adaptor.getElementById(t),this.actualServingMode=this.adConfig.actualServingMode,this._averageLastCalcTime=(new Date).getTime(),this._options=i||{},this._isPanel=this._options.isPanel,this._createIntMgrWrapper(),this._dpm=EBG.dataPipeMgr.getPipe(this.adConfig.sID),this.checkVisibilityCounter=0,this._shouldInitialize()&&this._tryInitProvider(),EBG.log.endGroup()},EBG.RichModules.VisibilityManager.ThreholdType={IAB:0,Agency:1,Advertiser:2},EBG.RichModules.VisibilityManager.VisibilityCheckInterval=100,EBG.RichModules.VisibilityManager.prototype={adConfig:null,_resObjId:null,_visibilityData:null,_visRecordable:!1,_lastVisPercentage:0,_lastVisViewPort:null,_lastVisRect:null,_averageVisibility:0,_averageScreenShare:0,_averageAdDuration:0,_averageLastCalcTime:null,_adCoveragePercentage:0,actualServingMode:EBG.Adaptors.ServingMode.SCRIPT,_visibilityProvider:null,_availableVisibilityProviders:"GeometricVisibilityProvider SafeFrameVisibilityProvider IntersectionObserverVisibilityProvider MouseVisibilityProvider GridVisibilityProvider FFVisibilityProvider MraidVisibilityProvider".split(" "),_visibilityProviderName:null,_providersAvailability:{GeometricVisibilityProvider:function(e){var t=!0,i=e.actualServingMode==EBG.Adaptors.ServingMode.IFRAME,n=EBG.Initializer._getAdClass({tn:e.templateName}),a=!n.requiresIframeBust&&!e.UiVz;return e=n.requiresIframeBust&&!EBG.iframeLocation&&e.aiE&&!e.aiE.iflExists,t=i&&(a||e)||EBG.adaptor.isInApp()?!1:t},IntersectionObserverVisibilityProvider:function(e){return window.IntersectionObserver&&!EBG.adaptor.isInApp()||e.actualServingMode==EBG.Adaptors.ServingMode.IFRAME&&window.context&&context.observeIntersection&&EBG.isFunc(context.observeIntersection)&&"Html5ExpBanner"!=e.templateName},FFVisibilityProvider:function(e){return e.actualServingMode==EBG.Adaptors.ServingMode.IFRAME&&EBG.isDefined(window.mozInnerScreenY)&&EBG.isDefined(window.mozInnerScreenX)},GridVisibilityProvider:function(e){e=!1;var t=EBG.adaptor.browser.getDocumentMode()||5;return e=EBG.adaptor.browser.isIE()&&10<t?!0:e},MouseVisibilityProvider:function(e){e=!1;var t=EBG.adaptor.browser.getDocumentMode()||5;return e=EBG.adaptor.browser.isIE()&&t<11&&EBG.adaptor.browser._browserVer<11?!0:e},SafeFrameVisibilityProvider:function(e){return!!EBG.adaptor.isSafeFrame()},MraidVisibilityProvider:function(e){var t=e.actualServingMode==EBG.Adaptors.ServingMode.IFRAME;return!(!EBG.adaptor.isInApp()||t)&&!(e.UiVz=!1)}},_init:function(e){this._visibilityProvider=new(e||window).EBG.RichModules[this._visibilityProviderName](this._resObjId,this._adConfig,this._options),this._dpm.send(EBG.DataProfile.VISIBILITY,{vsbp:this.getVisibilityProviderNum()}),this.adConfig.impressionSent?this._start():((e=new EBG.Events.EventSubscription(EBG.Events.EventNames.IMPRESSION_SENT,this._start,this)).dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd},e.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(e))},_start:function(){this._initializeVisibilityData(),this._subscribeToEvents(),this._visRecordable=!0,this._reportVisibilityRecordable();var e=function(){this._visibilityProvider.start()};this.adConfig.adStarted?e.apply(this):((e=new EBG.Events.EventSubscription(EBG.Events.EventNames.AD_START,e,this)).timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(e))},_createIntMgrWrapper:function(){function e(){}this._intMgrWrapper={};for(var t=["handleCounterInteraction","updateTimer","startTimer","stopTimer","clearTimer"],i=0;i<t.length;i++)this._intMgrWrapper[t[i]]=this._options.muteInteractions?e:function(e){return function(){return EBG.intMgr[e].apply(EBG.intMgr,arguments)}}(t[i])},checkVisibility:function(e){if(e=e?EBG.cloneObj(e):{},EBG.isDefined(e.percentage)&&EBG.isNumber(e.percentage)||(e.percentage=this.calculateVisibilityPercentage()),EBG.isDefinedNotNull(e.percentage)&&0<=e.percentage){"viewPort"in e||(e.viewPort=this.getViewPortMetrics()),this._adCoveragePercentage&&(e.percentage=Math.max(e.percentage-this._adCoveragePercentage,0)),this._res=EBG.adaptor.getElementById(this._resObjId);try{"visible"!=window.getComputedStyle(this._res).getPropertyValue("visibility")?(e.percentage=0,++this.checkVisibilityCounter<=3&&(EBG.runTimed(this,this.checkVisibility,[],500),1==this.checkVisibilityCounter&&EBG.runTimed(this,function(){this.checkVisibilityCounter=0},[],3e3))):this.checkVisibilityCounter=0}catch(e){}for(var t in this._resObjId,this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&this._calculateAverages(e),EBG.RichModules.VisibilityManager.ThreholdType)EBG.RichModules.VisibilityManager.ThreholdType.hasOwnProperty(t)&&this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType[t]]&&this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType[t]].isActive&&this._execCheckVisibility(e.percentage,EBG.RichModules.VisibilityManager.ThreholdType[t])}},updateResourceObjId:function(e){this._visibilityProvider&&e?(this._collectTimersHandler(),this._resObjId=e,this._res=EBG.adaptor.getElementById(e),this._visibilityProvider.updateResourceObjId(e)):e&&(this._resObjId=e,this._res=EBG.adaptor.getElementById(e))},_shouldInitialize:function(){var e=EBG.Initializer._getAdClass({tn:this.adConfig.templateName});return!(this.adConfig.actualServingMode==EBG.Adaptors.ServingMode.IFRAME&&!e.requiresIframeBust&&this.adConfig.UiVz&&!EBG.adaptor.isInApp())&&(!this.adConfig.ffs.CFF_DisableVisInit||this.adConfig.visibility.mode!=EBG.VisibilityMode.DEFAULT_MODE)},_tryInitProvider:function(){(this._visibilityProviderName=this._getVisibilityProvider(this._resObjId,this.adConfig))?(this._adConfig.visibility.isAvailable=!0,EBG.RichModules[this._visibilityProviderName]?this._init():EBG.adaptor.loadModule(this._visibilityProviderName,this._adConfig,this._init,this)):this._adConfig.visibility.isAvailable=!1},_getVisibilityProvider:function(e,t){for(e=0;e<this._availableVisibilityProviders.length;e++){var i=this._availableVisibilityProviders[e];if(this._providersAvailability[i]&&this._providersAvailability[i](t,this))return i}return null},calculateVisibilityPercentage:function(e,t,i,n,a,s,r){var o=0;return EBG.adaptor.isPageVisible(this.adConfig.isInstream)?this._visibilityProvider&&(o=this._visibilityProvider._calculateVisibilityPercentage({resourceObjId:e,width:t,height:i,offsetX:n,offsetY:a,isUIVZ:s,actualServingMode:r})):o=0,o},isVisibile:function(e,t,i){var n=!1;if(EBG.adaptor.isPageVisible(this.adConfig.isInstream)&&this._visibilityProvider)try{var a=!!this._visibilityProvider._isVisible({resourceObjId:e,width:t,height:i});EBG.log.endGroup(),n=a}catch(e){}return n},isIABVisibile:function(){return this.calculateVisibilityPercentage()>=this.adConfig.visibility.iabMinSurface},getViewPortMetrics:function(){var e=null;return e=this._visibilityProvider?this._visibilityProvider._getViewPortMetrics():e},_subscribeToEvents:function(){try{var e=new EBG.Events.EventSubscription(EBG.Events.EventNames.VISIBILITY_CHECK,this._visibilityCheckHandler,this);e.dispatcherFilters={"adConfig.rnd":this.adConfig.rnd},e.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(e),this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&((e=new EBG.Events.EventSubscription(EBG.Events.EventNames.COLLECT_TIMERS,this._collectTimersHandler,this)).timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.subscribeToEvent(e));var t=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_HIDDEN,this._stopTimersHandler,this);t.isDocumentEvent=!this._adConfig.isAMP,EBG.eventMgr.subscribeToEvent(t),t=new EBG.Events.EventSubscription(EBG.Events.EventNames.VISIBILITY_HIDDEN,this._stopTimersHandler,this),EBG.eventMgr.subscribeToEvent(t),(t=new EBG.Events.EventSubscription(this._isPanel?"P":""+EBG.Events.EventNames.AD_STACKING,this._adStackingHandler,this)).dispatcherFilters={"_adConfig.rnd":this.adConfig.rnd},EBG.eventMgr.subscribeToEvent(t),(t=new EBG.Events.EventSubscription(EBG.Events.EventNames.EXPAND,function(e){(e.eventData==this.adConfig.panelName||e.eventData.props&&e.eventData.props.asset.id==this._resObjId||e.eventData.props&&e.eventData.props.panel.id==this._resObjId)&&this.checkVisibility()},this)).dispatcherFilters={"_adConfig.rnd":this.adConfig.rnd},t.timing=EBG.Events.EventTiming.AFTER,EBG.eventMgr.subscribeToEvent(t),t.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.subscribeToEvent(t),(t=new EBG.Events.EventSubscription(EBG.Events.EventNames.ELEMENT_SHOWN,function(){this.checkVisibility()},this)).dispatcherFilters={"_adConfig.rnd":this.adConfig.rnd},t.timing=EBG.Events.EventTiming.AFTER,EBG.eventMgr.subscribeToEvent(t),(t=new EBG.Events.EventSubscription(EBG.Events.EventNames.ELEMENT_HIDDEN,function(){this.checkVisibility()},this)).dispatcherFilters={"_adConfig.rnd":this.adConfig.rnd},t.timing=EBG.Events.EventTiming.AFTER,EBG.eventMgr.subscribeToEvent(t),(t=new EBG.Events.EventSubscription(EBG.Events.EventNames.COLLAPSE,function(e){(e.eventData==this.adConfig.panelName||e.eventData.props&&e.eventData.props.asset.id==this._resObjId||e.eventData.props&&e.eventData.props.panel.id==this._resObjId)&&this.stopMeasureVisibility()},this)).timing=EBG.Events.EventTiming.BEFORE,t.dispatcherFilters={"_adConfig.rnd":this.adConfig.rnd},EBG.eventMgr.subscribeToEvent(t)}catch(e){}},_adStackingHandler:function(e){this._adCoveragePercentage=e.eventData.percentage,this.checkVisibility()},_visibilityCheckHandler:function(e){EBG.isDefined(e)&&EBG.isDefined(e.eventData)&&e.dispatcher===this._visibilityProvider&&this.checkVisibility(e.eventData)},_initializeVisibilityData:function(){this._visibilityData=[],this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType.IAB]={minSurface:this.adConfig.visibility.iabMinSurface,minDuration:this.adConfig.visibility.iabMinDuration,minLargeSurface:this.adConfig.visibility.iabMinLargeSurface,minLargeDuration:this.adConfig.visibility.iabMinLargeDuration,visibilityInteraction:this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_IAB),durationInteraction:null,isActive:this.adConfig.visibility.mode!=EBG.VisibilityMode.DEFAULT_MODE,durationNeeded:!1,timeOutFlag:null,reported:!1},this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType.Agency]={minSurface:this.adConfig.visibility.agencyMinSurface,minDuration:this.adConfig.visibility.agencyMinDuration,visibilityInteraction:this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_AGENCY),durationInteraction:this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_AGENCY_DURATION),isActive:this.adConfig.visibility.mode!=EBG.VisibilityMode.DEFAULT_MODE&&!!this.adConfig.visibility.agencyMinDuration,durationNeeded:this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&!!this.adConfig.visibility.agencyMinDuration,timeOutFlag:null,reported:!1},this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType.Advertiser]={minSurface:this.adConfig.visibility.advertiserMinSurface,minDuration:this.adConfig.visibility.advertiserMinDuration,visibilityInteraction:this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER),durationInteraction:this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_DURATION),isActive:this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&!this._isPanel&&!!this.adConfig.visibility.advertiserMinDuration,durationNeeded:this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&!!this.adConfig.visibility.advertiserMinDuration,timeOutFlag:null,reported:!1}},_adjustPanelIntName:function(e){return this._isPanel?"P"+e:e},_isLargeBanner:function(){var e=EBG.adaptor.getBoundingClientRect(this._res,{clip:!0});return!!e&&242500<=e.width*e.height},_execCheckVisibility:function(e,t){try{var i,n=this._visibilityData[t],a=n.visibilityInteraction==EBG.Interactions.SystemInts.VISIBILITY_IAB,s=!EBG.adaptor.browser.isMobile()&&n.minLargeSurface&&this._isLargeBanner()?(i=n.minLargeSurface,n.minLargeDuration):(i=n.minSurface,n.minDuration);i<=e?(!a||n.reported||this._visibilityProvider.isTimedBaseVisibility||EBG.runTimed(this,this.checkVisibility,[],EBG.RichModules.VisibilityManager.VisibilityCheckInterval),n.reported||n.timeOutFlag?n.reported&&n.durationNeeded&&n.durationInteraction&&(t.toString(),this._intMgrWrapper.startTimer(n.durationInteraction,this.adConfig.uid)):n.timeOutFlag=EBG.runTimed(this,function(){n.timeOutFlag=null,this._intMgrWrapper.handleCounterInteraction(n.visibilityInteraction,this.adConfig.uid),n.durationNeeded&&n.durationInteraction&&(this._intMgrWrapper.updateTimer(n.durationInteraction,this.adConfig.uid,s),this._intMgrWrapper.startTimer(n.durationInteraction,this.adConfig.uid)),a&&!n.reported&&this._handleIABVisibility(),n.reported=!0},[],1e3*s)):(this._stopDurationTimeout(t),n.durationInteraction&&this._stopDurationCounting(t))}catch(e){}},_stopDurationTimeout:function(e){this._visibilityData[e].timeOutFlag&&(clearTimeout(this._visibilityData[e].timeOutFlag),this._visibilityData[e].timeOutFlag=null)},_stopDurationCounting:function(e){this._visibilityData[e].durationNeeded&&this._visibilityData[e].durationInteraction&&(e.toString(),this._intMgrWrapper.stopTimer(this._visibilityData[e].durationInteraction,this.adConfig.uid))},_reportVisibilityRecordable:function(){var e=this.adConfig.visibility.mode==EBG.VisibilityMode.BASIC_MODE||this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE;e&&this.adConfig.visibility.iabMinDuration&&this._intMgrWrapper.handleCounterInteraction(this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_RECORDABLE),this.adConfig.uid),e&&this.adConfig.visibility.agencyMinDuration&&this._intMgrWrapper.handleCounterInteraction(this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_AGENCY_RECORDABLE),this.adConfig.uid),this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&!this._isPanel&&this.adConfig.visibility.advertiserMinDuration&&this._intMgrWrapper.handleCounterInteraction(this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_RECORDABLE),this.adConfig.uid)},_collectTimersHandler:function(e){e&&(e.eventData&&e.eventData.adUId!=this.adConfig.uid||e.dispatcher.adsData&&e.dispatcher.adsData[this.adConfig.uid]&&e.dispatcher.adsData[this.adConfig.uid].isUnloadHandled)||(this._intMgrWrapper.clearTimer(this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_AVG_AD_SURFACE),this.adConfig.uid),this._intMgrWrapper.clearTimer(this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_AVG_SCREEN_SHARE),this.adConfig.uid),this._calculateAverages({percentage:this._lastVisPercentage,viewPort:this._visibilityProvider._getViewPortMetrics()}),this._intMgrWrapper.updateTimer(this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_AVG_AD_SURFACE),this.adConfig.uid,this._averageVisibility),this._intMgrWrapper.updateTimer(this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_AVG_SCREEN_SHARE),this.adConfig.uid,this._averageScreenShare))},_stopTimersHandler:function(){for(var e in EBG.RichModules.VisibilityManager.ThreholdType)EBG.RichModules.VisibilityManager.ThreholdType.hasOwnProperty(e)&&this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType[e]]&&this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType[e]].isActive&&(this._stopDurationTimeout(EBG.RichModules.VisibilityManager.ThreholdType[e]),this._stopDurationCounting(EBG.RichModules.VisibilityManager.ThreholdType[e]))},stopMeasureVisibility:function(){this._collectTimersHandler(),this._lastVisPercentage=0,this._stopTimersHandler()},getVisibilityProviderNum:function(){var e={None:0,Geometric:1,SafeFrame:2,Mouse:3,Grid:4,Flash:5,FF:6,Mraid:7,AddingEye:8,Basic:9,IntersectionObserver:10};return this._visibilityProvider?e[this._visibilityProvider.name]||-1:e.None},_calculateAverages:function(e){var t,i,n=(new Date).getTime()-this._averageLastCalcTime;1e3<n&&0<this._lastVisPercentage?(this._averageVisibility=(this._averageVisibility*this._averageAdDuration+this._lastVisPercentage*n)/(this._averageAdDuration+n),this._lastVisViewPort&&this._lastVisViewPort.Width&&this._lastVisViewPort.Height&&(t=this._lastVisViewPort.Width*this._lastVisViewPort.Height,i=this._lastVisRect||EBG.adaptor.getBoundingClientRect(this._res,{clip:!0,relativeToTop:!0})||{width:0,height:0},this._averageScreenShare=(this._averageScreenShare*this._averageAdDuration+this._lastVisPercentage*(i?i.width*i.height:0)/100/t*100*n)/(this._averageAdDuration+n)),this._averageAdDuration+=n,this._averageVisibility,this._averageScreenShare,this._averageAdDuration):this._lastVisPercentage,this._lastVisPercentage=e.percentage,this._lastVisViewPort=e.viewPort,this._lastVisRect=EBG.adaptor.getBoundingClientRect(this._res,{clip:!0,relativeToTop:!0})||{width:0,height:0},this._averageLastCalcTime=(new Date).getTime()},_handleIABVisibility:function(){EBG.RichModules.VisibilityManager.VisibilityCheckInterval=500}},EBG.declareClass(EBG.RichModules.VisibilityManager,null),EBG.declareNamespace("RichModules"),EBG.RichModules.AdStackingDetector=function(e,t){this._adConfig=e,this._isFriendlyIframe=this._adConfig.actualServingMode==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME||this._adConfig.actualServingMode==EBG.Adaptors.ServingMode.TOPMOST_FRIENDLY_IFRAME&&window.frameElement,this._isPanel=t,this._elementsIds=[],this._validElementParents=[],this._visibilityEvent={},this._placeholderDiv=EBG.adaptor.getElementById(this._adConfig.placeHolderId),this._shouldInitialize()&&(this._validElementParents.push(e.placeHolderId),EBG.Const.OUTER_DIV&&this._validElementParents.push(EBG.Const.OUTER_DIV),(e=new EBG.Events.EventSubscription(EBG.Events.EventNames.VISIBILITY_CHECK,this._handleVisibilityEvent,this)).dispatcherFilters={"adConfig.rnd":this._adConfig.rnd},e.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(e),this._adConfig.adStarted?this._start():((e=new EBG.Events.EventSubscription(EBG.Events.EventNames.AD_START,function(){this._start()},this)).timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(e)))},EBG.RichModules.AdStackingDetector.prototype={_densityFactor:5,_prevPercentage:0,_minThresholdForAdStacking:50,_interactionThreshold:100,_generatePointsGrid:function(e){for(var t=[],i=(e.height-2)/this._densityFactor,n=(e.width-2)/this._densityFactor,a=0;a<=this._densityFactor;a++)for(var s=0;s<=this._densityFactor;s++){var r=n*a,o=i*s,r=Math.max(r,2),o=Math.max(o,2);r=Math.min(r,e.width-2),o=Math.min(o,e.height-2),t.push({x:Math.round(r),y:Math.round(o)})}return t},_handleVisibilityEvent:function(e){~EBGInfra.indexOfArray(this._elementsIds,e.dispatcher._resObjId)&&(this._visibilityEvent=EBG.cloneObj(e.eventData))},_shouldInitialize:function(){if(this._adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&this._adConfig.actualServingMode!=EBG.Adaptors.ServingMode.IFRAME)return this._adConfig.actualServingMode!=EBG.Adaptors.ServingMode.FRIENDLY_IFRAME||window.parent===top},_start:function(){EBG.runTimed(this,this._analyze,[],5),EBG.runTimed(this,this._analyze,[],EBG.RichModules.VisibilityManager.VisibilityCheckInterval/2),EBG.runTimed(this,this._analyze,[],EBG.RichModules.VisibilityManager.VisibilityCheckInterval)},_analyze:function(){if("hidden"!=this._placeholderDiv.style.visibility){var e=this._calculateConcealmentPercentage();if(!this._adStackingReported&&e.adStacked>=this._interactionThreshold&&this._visibilityEvent.percentage>=this._minThresholdForAdStacking&&(EBG.intMgr.handleCounterInteraction((this._isPanel?"P":"")+EBG.Interactions.SystemInts.AD_STACKING,this._adConfig.uid),this._adStackingReported=!0),e.blocked!=this._prevPercentage){this._prevPercentage=e.blocked;var t=new EBG.Events.Event(this._isPanel?"P":""+EBG.Events.EventNames.AD_STACKING);if(t.eventData={intName:(this._isPanel?"P":"")+EBG.Interactions.SystemInts.AD_STACKING,percentage:e.blocked},t.dispatcher=this,t.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.dispatchEvent(t))return;t.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(t)}EBG.runTimed(this,this._analyze,[],EBG.RichModules.VisibilityManager.VisibilityCheckInterval)}},_calculateConcealmentPercentage:function(){var t={blocked:0,adStacked:0};try{if(!this._elementsIds.length)return t;var e=EBG.adaptor.serving._getTopFriendlyIframe(this._adConfig.displayWin||EBG.adaptor.getDisplayWin()),i=EBG.adaptor.getElementById(this._assetId),n=EBG.adaptor.getBoundingClientRect(i,{clip:!0,relativeToTop:!0});if(!i||!i.offsetWidth||!i.offsetHeight||EBG.isDefined(this._visibilityEvent.assetId)&&this._visibilityEvent.assetId!=this._assetId)return t;var a=this._visibilityEvent.visibleRect;if(!(i=a||n)||0==i.width||0==i.height)return t;this._grid=this._generatePointsGrid(i);for(var s=0,r=0,o=0;o<this._grid.length;o++){var d=this._grid[o];d.x+=Math.floor(i.left)+1,d.y+=Math.floor(i.top)+1;var E=e.document.elementFromPoint(d.x,d.y);!E||E.id&&-1!=EBG.indexOfArray(this._elementsIds,E.id)||this._isFriendlyIframe&&E==window.frameElement||this._hasValidParent(E)||this._isElementTransparent(E)||(s++,E.tagName&&"iframe"==E.tagName.toLowerCase()&&r++)}return{blocked:Math.ceil(Math.round(s/this._grid.length*100)*(a?a.width*a.height/(n.width*n.height):1)),adStacked:Math.round(r/this._grid.length*100)}}catch(e){return t}},addElementId:function(e,t){-1==EBGInfra.indexOfArray(this._elementsIds,e)&&this._elementsIds.push(e),t&&(this._assetId=e,this._visibilityEvent={})},_invisibleProperties:{visibility:"hidden",display:"none",opacity:function(e){return 0==+e},"-moz-opacity":function(e){return EBG.adaptor.browser.isFF()&&0==+e},"-khtml-opacity":function(e){return EBG.adaptor.browser.isSafari()&&0==+e},filter:function(e){return EBG.adaptor.browser.isIE()&&EBG.adaptor.browser.getVersion()<10&&-1!=EBG.indexOfArray(["alpha(opacity=0)","progid:DXImageTransform.Microsoft.Alpha(Opacity=0)"],e)},"background-color":function(e,t,i){function n(e){var t=e.replace(/^\s+|\s+$/g,"").match(/^rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i);return t&&0==+t[4]||"transparent"==e}var a=t.innerText||t.textContent,s=EBG.adaptor.browser.isIE()&&EBG.adaptor.browser.getVersion()<9;return i=i.getPropertyValue("color"),n(e)&&-1==EBG.indexOfArray("object canvas video source track iframe embed img".split(" "),t.tagName.toLowerCase())&&(!a||!s&&n(i))}},_isElementTransparent:function(e){var t,i=EBG.adaptor.getComputedStyle(e),n=this._invisibleProperties;for(t in n){var a=i.getPropertyValue(t);if(a)for(var s=EBG.isArray(n[t])?n[t]:[n[t]],r=0;r<s.length;r++)if(EBG.isFunc(s[r])?s[r](a,e,i):a==s[r])return!0}return!1},_hasValidParent:function(e){if(!e)return!1;for(var t=e.id;e.parentElement;){if(e.parentElement.id&&-1!=EBG.indexOfArray(this._validElementParents,e.parentElement.id))return this.addElementId(t,!1),!0;e=e.parentElement}return!1}},EBG.declareClass(EBG.RichModules.AdStackingDetector,null),EBG.declareNamespace("RichModules"),EBG.RichModules.ActualSizeDetector=function(e){this._adConfig=e,this._placeholderDiv=EBG.adaptor.getElementById(this._adConfig.placeHolderId),this._adConfig.impressionSent?this._start():((e=new EBG.Events.EventSubscription(EBG.Events.EventNames.IMPRESSION_SENT,function(){this._start()},this)).timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(e))},EBG.RichModules.ActualSizeDetector.prototype={_start:function(){var t=this,e=function(){var e;EBG.adaptor.isPageLoaded()?t._detect():((e=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_LOAD,function(){t._detect()},t)).dispatcherFilters={"_adConfig.rnd":t._adConfig.rnd},e.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(e))};this._adConfig.adStarted?e():((e=new EBG.Events.EventSubscription(EBG.Events.EventNames.AD_START,e,this)).timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(e))},_detect:function(){var e=[],t=this._placeholderDiv.parentElement,i=EBG.adaptor.generateElementId("BannerDiv",this._adConfig.uid),n=EBG.adaptor.getElementById(i)||this._placeholderDiv.children[0];if(n="DIV"==n.tagName?n&&(n.getElementsByTagName("img")[0]||n.getElementsByTagName("iframe")[0]):n)if(0==(i=EBG.adaptor.getBoundingClientRect(n,{relativeToWindow:!0})).width&0==i.height)EBG.runTimed(this,this._detect,[],100);else{for(;t;)e.push(this._getElementRect(t)),t=t.parentElement;for(e.push(this._getWindowContainerSize(n)),t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);for(e=t,n=0;n<e.length;n++){if(!this._intersect(e[n],i)){i={width:0,height:0};break}i=this._overlap(e[n],i)}EBG.intMgr.handleCounterInteraction(EBG.Interactions.SystemInts.ACTUAL_SIZE,this._adConfig.uid,0,!1,{value:i.width+"x"+i.height})}},_overlap:function(e,t){var i={top:-1,right:-1,bottom:-1,left:-1};return this._intersect(e,t)&&(i.top=Math.max(e.top,t.top),i.left=Math.max(e.left,t.left),i.right=Math.min(e.right,t.right),i.bottom=Math.min(e.bottom,t.bottom),i.width=i.right-i.left,i.height=i.bottom-i.top),i},_intersect:function(e,t){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)},_getElementRect:function(e){return-1==["DIV","IMG"].indexOf(e.tagName.toUpperCase())?null:"hidden"==EBG.adaptor.getComputedStyle(e).overflow?EBG.adaptor.getBoundingClientRect(e,{relativeToWindow:!0}):void 0},_getWindowContainerSize:function(e){if((e=(e=e.ownerDocument).defaultView||e.parentWindow)==top)return null;var t=e.innerWidth;if(e=window.innerHeight,EBG.adaptor.isSafeFrame())try{var i=$sf.ext.geom(),t=i.self.w;e=i.self.h}catch(e){}return{width:i=t,height:e,top:0,left:0,right:i,bottom:e}}},EBG.declareClass(EBG.RichModules.ActualSizeDetector,null),EBG.declareNamespace("RichModules"),EBG.RichModules.Geometry=function(e){EBG.log.endGroup()},EBG.RichModules.Geometry.prototype={_clipRegex:/rect\((.*?)px(.*?)px(.*?)px(.*?)px\)/g,_clipPercentRegex:/rect\(([0-9]+%?)(?:px)?[ ,]?([0-9]+%?)(?:px)?[ ,]?([0-9]+%?)(?:px)?[ ,]?([0-9]+%?)(?:px)?[ ,]?\)/g,getViewport:function(){var e=EBG.adaptor.getWindowViewPortMetrics();return e&&(e.width=e.Width,e.height=e.Height),e},getPercentOfViewportWidth:function(e){return EBG.isNumber(e)||(e=+e.replace(/[^\d\.\-]/g,"")),this.getViewport().Width*e/100},getPercentOfViewportHeight:function(e){return EBG.isNumber(e)||(e=+e.replace(/[^\d\.\-]/g,"")),this.getViewport().Height*e/100},getPercentOfViewport:function(e){EBG.isNumber(e)||(e=+e.replace(/[^\d\.\-]/g,""));var t=EBG.cloneObj(this.getViewport());return t.width=t.Width=t.Width*e/100,t.height=t.Height=t.Height*e/100,t},calculateMaxHeight:function(e,t,i){var n=parseInt(e,10);return EBG.isPercentage(e)&&(n=this.getPercentOfViewportHeight(n)),Math.min(i/t,n)},calculateMaxWidth:function(e,t,i){var n=parseInt(e,10);return EBG.isPercentage(e)&&(n=this.getPercentOfViewportWidth(n)),Math.min(t*i,n)},translateCoords:function(e,t,i){var n,a={},s=["left","top","right","bottom"],r=["width","height","width","height"],o=["X","Y","X","Y"];for(n in e)if(-1<(u=EBG.indexOfArray(s,n))){var d,E,l,c=r[u],h=e[n],u=o[u];switch(t.from!=EBG.PanelPositionType.VIEWPORT_RELATIVE_PERCENTAGE&&t.from!=EBG.PanelPositionType.VIEWPORT_RELATIVE_PIXELS&&t.to!=EBG.PanelPositionType.VIEWPORT_RELATIVE_PERCENTAGE&&t.to!=EBG.PanelPositionType.VIEWPORT_RELATIVE_PIXELS||(i=i||EBG.adaptor.serving.detectServingMode(!0),d=EBG.adaptor.getScrollLeftTop(!1,i)),t.from){case EBG.PanelPositionType.PAGE_RELATIVE_PERCENTAGE:h=e[c]?0<(E=this.getViewport()[c]-e[c])?Math.round(E*h/100):0:this.getViewport()[c]*h/100;break;case EBG.PanelPositionType.BANNER_RELATIVE_PIXELS:e.refElem&&(l=EBG.isElementOrNode(e.refElem)?EBG.adaptor.getBoundingClientRect(e.refElem,{relativeToWindow:!0}):e.refElem),EBG.isDefined(l[n])&&(h+=l[n]);break;case EBG.PanelPositionType.VIEWPORT_RELATIVE_PERCENTAGE:h=e[c]?0<(E=this.getViewport()[c]-e[c])?Math.round(E*h/100):0:this.getViewport()[c]*h/100,"top"==n||"bottom"==n?h+=d.Y:"left"!=n&&"right"!=n||(h+=d.X);break;case EBG.PanelPositionType.VIEWPORT_RELATIVE_PIXELS:"top"==n||"bottom"==n?h+=d.Y:"left"!=n&&"right"!=n||(h+=d.X)}switch(t.to){case EBG.PanelPositionType.VIEWPORT_RELATIVE_PERCENTAGE:e[c]&&(h=0!=(E=this.getViewport()[c]-e[c])?Math.round((h-d[u])/E*100):0);break;case EBG.PanelPositionType.BANNER_RELATIVE_PIXELS:e.refElem&&(l=EBG.isElementOrNode(e.refElem)?EBG.adaptor.getBoundingClientRect(e.refElem,{relativeToWindow:!0}):e.refElem),EBG.isDefined(l[n])&&(h-=l[n]);break;case EBG.PanelPositionType.PAGE_RELATIVE_PERCENTAGE:e[c]&&(h=0!=(E=this.getViewport()[c]-e[c])?Math.round(h/E*100):0);break;case EBG.PanelPositionType.VIEWPORT_RELATIVE_PIXELS:"top"==n?h-=d.Y:"left"==n&&(h-=d.X)}a[n]=h}return a},resolveClipPercentages:function(e,t){if(this._isRectCSS(e)){e=this._getRectCSSValues(e);for(var i=[null,"top","right","bottom","left"],n="rect(",a=1;a<=4;a++){var s=e[a];switch(i[a]){case"top":case"bottom":EBG.isPercentage(s)&&(s=t&&EBG.isNumber(t.height)?(s=+s.replace(/[^\d\.\-]/g,""),t.height*s/100):this.getPercentOfViewportHeight(s));break;case"left":case"right":EBG.isPercentage(s)&&(s=t&&EBG.isNumber(t.width)?(s=+s.replace(/[^\d\.\-]/g,""),t.width*s/100):this.getPercentOfViewportWidth(s))}n=n+(s=Math.round(s))+"px",n=a<4?n+",":n+")"}return n}return null},_isRectCSS:function(e){return this._clipPercentRegex.lastIndex=0,this._clipPercentRegex.test(e)},_getRectCSSValues:function(e){return this._clipPercentRegex.lastIndex=0,this._clipPercentRegex.exec(e)}},EBG.declareNamespace("AdChoice"),EBG.AdChoice.AdChoiceManager=function(e){this._adConfig=e,this._active=e.adChoice.includeMarker,this._iconAdded=!1},EBG.AdChoice.AdChoiceManager.ImageData=function(){this.id=this.iconSrc=""},EBG.AdChoice.AdChoiceManager.IabIconData={en:{icon:"OBA_DEFAULT.png",url:"http://www.youronlinechoices.com/uk/"},"de-at":{icon:"OBA_AUSTRIA.png",url:"http://www.youronlinechoices.com/at/"},"fr-be":{icon:"OBA_BELGIUM_FR.png",url:"http://www.youronlinechoices.com/be-fr/"},"nl-be":{icon:"OBA_BELGIUM_NL.png",url:"http://www.youronlinechoices.com/be-nl/"},bg:{icon:"OBA_BULGARIA.png",url:"http://www.youronlinechoices.com/bg/"},cs:{icon:"OBA_CZECH.png",url:"http://www.youronlinechoices.com/cs/"},da:{icon:"OBA_DENMARK.png",url:"http://www.youronlinechoices.com/den/"},fi:{icon:"OBA_FINLAND.png",url:"http://www.youronlinechoices.com/fi/"},fr:{icon:"OBA_FRANCE.png",url:"http://www.youronlinechoices.com/fr/"},de:{icon:"OBA_GERMANY.png",url:"http://www.youronlinechoices.com/de/"},el:{icon:"OBA_GREEK.png",url:"http://www.youronlinechoices.com/gr/"},hu:{icon:"OBA_HUNGARY.png",url:"http://www.youronlinechoices.com/hu/"},"en-ie":{icon:"OBA_IRELAND.png",url:"http://www.youronlinechoices.com/ie/"},it:{icon:"OBA_ITALY.png",url:"http://www.youronlinechoices.com/it/"},nl:{icon:"OBA_NETHERLANDS.png",url:"http://www.youronlinechoices.com/nl/"},no:{icon:"OBA_NORWAY.png",url:"http://www.youronlinechoices.com/nor/"},pl:{icon:"OBA_POLAND.png",url:"http://www.youronlinechoices.com/pl/"},ro:{icon:"OBA_ROMANIA.png",url:"http://www.youronlinechoices.com/ro/"},sl:{icon:"OBA_SLOVAKIA.png",url:"http://www.youronlinechoices.com/sl/"},es:{icon:"OBA_SPAIN.png",url:"http://www.youronlinechoices.com/es/"},sv:{icon:"OBA_SWEDEN.png",url:"http://www.youronlinechoices.com/se/"},"de-ch":{icon:"OBA_SWITZERLAND_DE.png",url:"http://www.youronlinechoices.com/ch-de/"},"fr-ch":{icon:"OBA_SWITZERLAND_FR.png",url:"http://www.youronlinechoices.com/ch-fr/"},"it-ch":{icon:"OBA_SWITZERLAND_IT.png",url:"http://www.youronlinechoices.com/ch-it/"},"en-gb":{icon:"OBA_UK.png",url:"http://www.youronlinechoices.com/uk/"},hr:{icon:"OBA_DEFAULT.png",url:"http://www.youronlinechoices.com/hr/"},is:{icon:"OBA_DEFAULT.png",url:"http://www.youronlinechoices.com/is/"},lt:{icon:"OBA_DEFAULT.png",url:"http://www.youronlinechoices.com/lt/"},lv:{icon:"OBA_DEFAULT.png",url:"http://www.youronlinechoices.com/lv/"},pt:{icon:"OBA_DEFAULT.png",url:"http://www.youronlinechoices.com/pt/"},sk:{icon:"OBA_DEFAULT.png",url:"http://www.youronlinechoices.com/sk/"}},EBG.AdChoice.AdChoiceManager.NaiIconData={en:{icon:"OBA_DEFAULT.png",url:"http://www.aboutads.info/consumers"}},EBG.AdChoice.AdChoiceManager.IabClosedIconName="OBA.png",EBG.AdChoice.AdChoiceManager.NaiClosedIconName="OBA.png",EBG.AdChoice.AdChoiceManager.VisibilityState={HIDDEN:"hidden",VISIBLE:"visible"},EBG.AdChoice.AdChoiceManager.Position={ABSOLUTE:"absolute",RELATIVE:"relative"},EBG.AdChoice.AdChoiceManager.ImageLoadTimeout=100,EBG.AdChoice.AdChoiceManager.DefaultOffset=-1e3,EBG.AdChoice.AdChoiceManager.prototype={_imgData:null,_imgExpData:null,_iconLocalData:null,_acCloseIconName:null,_spanId:null,_iconsBaseUrl:null,_containerId:null,_assetObjId:null,init:function(){var e;this._active&&(this._iconsBaseUrl=this._getIconsDir(this._adConfig.adChoice.iconPosition),(e=new EBG.Events.EventSubscription(EBG.Events.EventNames.ADD_CREATIVES,this._handleAdChoice,this)).timing=EBG.Events.EventTiming.AFTER,e.dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd},EBG.eventMgr.subscribeToEvent(e),(e=new EBG.Events.EventSubscription(EBG.Events.EventNames.ADD_BANNER_DEFAULT_IMAGE_CREATIVE,this._handleAdChoice,this)).timing=EBG.Events.EventTiming.AFTER,e.dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd},EBG.eventMgr.subscribeToEvent(e),(e=new EBG.Events.EventSubscription(EBG.Events.EventNames.ADD_BANNER_DEFAULT_FLASH_CREATIVE,this._handleAdChoice,this)).timing=EBG.Events.EventTiming.AFTER,e.dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd},EBG.eventMgr.subscribeToEvent(e),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_RESIZE,this._pageResizeHandler,this)),this._adConfig.adChoice.certificationProgram==EBG.AcCertProgram.NAI_US?(this._iconLocalData=this._getIconDataByLanguage(EBG.AdChoice.AdChoiceManager.NaiIconData),this._acCloseIconName=EBG.AdChoice.AdChoiceManager.NaiClosedIconName):(this._iconLocalData=this._getIconDataByLanguage(EBG.AdChoice.AdChoiceManager.IabIconData),this._acCloseIconName=EBG.AdChoice.AdChoiceManager.IabClosedIconName)),EBG.log.endGroup()},_handleAdChoice:function(e){var t;e.eventData&&!e.eventData.isPanel&&(this._assetObjId=e.eventData.assetId),this._iconAdded?(e=EBG.adaptor.getElementById(this._containerId),t=EBG.adaptor.getElementById(this._spanId),EBG.adaptor.removeElement(t),EBG.adaptor.appendChildElement(e.id,t)):(this._iconAdded=!0,this._containerId=this._adConfig.placeHolderId,this._imgData=this._getImageData(),this._imgExpData=this._getExpImageData(),e=this._getAdChoiceUrl(),this._addAdChoiceIcons(this._imgData,this._imgExpData,e),this._subscribeIconToEvents(this._imgData.id,this._imgExpData.id)),EBG.log.endGroup()},hide:function(){var e=EBG.adaptor.getElementById(this._imgData.id),t=EBG.adaptor.getElementById(this._imgExpData.id);e&&(e.style.visibility="hidden"),t&&(t.style.visibility="hidden")},show:function(){var e=EBG.adaptor.getElementById(this._imgData.id),t=EBG.adaptor.getElementById(this._imgExpData.id);e&&(e.style.visibility="visible"),t&&(t.style.visibility="hidden")},_getImageData:function(){var e=new EBG.AdChoice.AdChoiceManager.ImageData;return e.iconSrc=this._iconsBaseUrl+this._acCloseIconName,e.id="acImage_"+this._adConfig.uid,e},_getExpImageData:function(){var e=new EBG.AdChoice.AdChoiceManager.ImageData;return e.iconSrc=this._iconsBaseUrl+this._iconLocalData.icon,e.id="acExpImage_"+this._adConfig.uid,e},_getAdChoiceUrl:function(){return this._adConfig.adChoice.customUrl?unescape(this._adConfig.adChoice.customUrl):this._iconLocalData.url},_getIconDataByLanguage:function(e){var t=EBG.adaptor.getBrowserLanguage().toLowerCase(),i=e[t];return i=(i=!i?e[i=t.split("-")[0]]:i)||e.en},_getIconOffsets:function(e,t,i,n,a,s){var r,o={offsetLeft:EBG.px(EBG.AdChoice.AdChoiceManager.DefaultOffset),offsetTop:EBG.px(EBG.AdChoice.AdChoiceManager.DefaultOffset)};if(this._assetObjId&&(adPos=EBG.adaptor.getPositioningById(this._assetObjId,!0,this._adConfig.actualServingMode)))switch(adPos.X,adPos.Y,a&&s||(r=EBG.adaptor.getElementById(this._assetObjId),r=EBG.adaptor.getBoundingClientRect(r),a=a||r.width,s=s||r.height),acPos=EBG.adaptor.getPositioningById(e,!0,this._adConfig.actualServingMode),acPos.X,acPos.Y,r=EBG.adaptor.getStyleOfElem(EBG.adaptor.getElementById(e)),e=parseInt(r.left)+adPos.X-acPos.X,r=parseInt(r.top)+adPos.Y-acPos.Y,t){case EBG.AcIconPosition.BottomLeft:o.offsetLeft=EBG.px(e),o.offsetTop=EBG.px(r+s-n);break;case EBG.AcIconPosition.BottomRight:o.offsetLeft=EBG.px(e+a-i),o.offsetTop=EBG.px(r+s-n);break;case EBG.AcIconPosition.TopLeft:o.offsetLeft=EBG.px(e),o.offsetTop=EBG.px(r);break;case EBG.AcIconPosition.TopRight:o.offsetLeft=EBG.px(e+a-i),o.offsetTop=EBG.px(r)}return o},_getIconsDir:function(e){var t=this._adConfig.imagesDir+"/AdChoice/";switch(e){case EBG.AcIconPosition.BottomLeft:t+="BottomLeft/";break;case EBG.AcIconPosition.BottomRight:t+="BottomRight/";break;case EBG.AcIconPosition.TopLeft:t+="TopLeft/";break;case EBG.AcIconPosition.TopRight:t+="TopRight/"}return t},_addAdChoiceIcons:function(e,t,i){var n="acImgLinkWrapper_"+this._adConfig.uid;this._spanId="acSpan_"+this._adConfig.uid;var a,s,r=EBG.adaptor.getElementById(this._containerId);r&&(i={tagName:EBG.Adaptors.TagNames.DIV,attributes:{id:this._spanId,style:{position:EBG.AdChoice.AdChoiceManager.Position.ABSOLUTE,zIndex:EBG.adaptor.getMaxZIndex(r)+1}},children:[{tagName:EBG.Adaptors.TagNames.A,attributes:{id:n,target:"_blank",onClick:EBG.format("EBG.adaptor.openPage('{0}');",i),mmskipreplace:1},children:null}]},this._containerId==this._adConfig.placeHolderId?EBG.adaptor.inject(i,EBG.Adaptors.InjectionMethod.APPEND,r):EBG.adaptor.inject(i,EBG.Adaptors.InjectionMethod.INSERT_BEFORE,r),n=EBG.adaptor.getElementById(n))&&(r={tagName:EBG.Adaptors.TagNames.IMG,attributes:{id:e.id,style:{position:EBG.AdChoice.AdChoiceManager.Position.ABSOLUTE,visibility:EBG.AdChoice.AdChoiceManager.VisibilityState.VISIBLE,left:EBG.px(EBG.AdChoice.AdChoiceManager.DefaultOffset),top:EBG.px(EBG.AdChoice.AdChoiceManager.DefaultOffset)}},children:null},EBG.adaptor.inject(r,EBG.Adaptors.InjectionMethod.APPEND,n),r={tagName:EBG.Adaptors.TagNames.IMG,attributes:{id:t.id,style:{position:EBG.AdChoice.AdChoiceManager.Position.ABSOLUTE,visibility:EBG.AdChoice.AdChoiceManager.VisibilityState.HIDDEN,left:EBG.px(EBG.AdChoice.AdChoiceManager.DefaultOffset),top:EBG.px(EBG.AdChoice.AdChoiceManager.DefaultOffset)}},children:null},EBG.adaptor.inject(r,EBG.Adaptors.InjectionMethod.APPEND,n),n=EBG.adaptor.getElementById(e.id),r=EBG.adaptor.getElementById(t.id),a=this,s=function(){EBG.runTimed(a,a._handleImgOnloadEvent,[e.id,0],EBG.AdChoice.AdChoiceManager.ImageLoadTimeout)},i=function(){EBG.runTimed(a,a._handleImgOnloadEvent,[t.id,0],EBG.AdChoice.AdChoiceManager.ImageLoadTimeout)},n&&((s=new EBG.Events.EventSubscription("load",s,this)).isElementEvent=!0,s.elementId=e.id,EBG.eventMgr.subscribeToEvent(s),n.src=e.iconSrc),r&&((s=new EBG.Events.EventSubscription("load",i,this)).isElementEvent=!0,s.elementId=t.id,EBG.eventMgr.subscribeToEvent(s),r.src=t.iconSrc))},_subscribeIconToEvents:function(e,t){function i(){n._handleMouseOverEvent(e,t)}var n=this,a=new EBG.Events.EventSubscription("mouseover",i,this);a.isElementEvent=!0,a.elementId=e,EBG.eventMgr.subscribeToEvent(a),(a=new EBG.Events.EventSubscription("mouseout",i,this)).isElementEvent=!0,a.elementId=t,EBG.eventMgr.subscribeToEvent(a)},_handleMouseOverEvent:function(e,t){e=EBG.adaptor.getElementById(e),t=EBG.adaptor.getElementById(t);var i=EBG.adaptor.getStyleOfElem(e),n=EBG.AdChoice.AdChoiceManager.VisibilityState.VISIBLE,a=EBG.AdChoice.AdChoiceManager.VisibilityState.HIDDEN;i.visibility==EBG.AdChoice.AdChoiceManager.VisibilityState.VISIBLE&&(n=EBG.AdChoice.AdChoiceManager.VisibilityState.HIDDEN,a=EBG.AdChoice.AdChoiceManager.VisibilityState.VISIBLE),i={visibility:a},EBG.adaptor.setStyleToElem(e,{visibility:n}),EBG.adaptor.setStyleToElem(t,i)},_pageResizeHandler:function(){this._handleImgOnloadEvent(this._imgData.id,0),this._handleImgOnloadEvent(this._imgExpData.id,0)},_handleImgOnloadEvent:function(e,t){var i=EBG.adaptor.getElementById(e);imgPos=this._getIconOffsets(e,this._adConfig.adChoice.iconPosition,i.width,i.height,this._adConfig.width,this._adConfig.height),EBGInfra.isDefinedNotNull(t)&&t<10?EBG.runTimed(this,this._rehandleImgOnloadEvent,[e,t],EBG.AdChoice.AdChoiceManager.ImageLoadTimeout):EBG.adaptor.setStyleToElem(i,{left:imgPos.offsetLeft,top:imgPos.offsetTop})},_rehandleImgOnloadEvent:function(e,t){this._handleImgOnloadEvent(e,t+1)}},EBG.declareNamespace("Ads"),EBG.Ads.Ad=function(e){this._adConfig=e,this._dpm=EBG.dataPipeMgr.getPipe(this._adConfig.sID),this._adConfig.isStdAd=this._isStdAd(),this.startTime=(new Date).getTime()/1e3,this.advertiserCounter=0,this._initReportImpression(),this.impressionWaitingStatus={adRender:!1},this._updateURLs(),this._subscribeEventTriggeringURLs(),(EBG.ads[e.uid]=this)._show(),this.placeHolderElement?this._handleMultiBurn():this._subscribeToAdEvent(EBG.Events.EventNames.SHOW_AD,this._handleMultiBurn,EBG.Events.EventTiming.ONTIME),this._sendInitAdInformation(),this._sendCustomFormatInformation(),EBG.log.endGroup()},EBG.Ads.Ad.prototype={resizePlaceHolder:!0,checkingThrottle:!1,_throttleState:null,_throttleTimeoutDuration:1e3,_adConfig:null,_adChoice:null,_cdiReason:0,_showOnlyDefaultImg:!1,_banner:{divId:"",resId:"",width:0,height:0},_hasDefaultImageInteraction:!1,_isStdAd:function(){return!0},_initReportImpression:function(){var e,t;this._adConfig.reportImpressionType==EBG.ReportImpressionType.DELAYED?EBG.adaptor.loadModule("DelayedImpression",this._adConfig,function(e){this.delayedImpressionModule=new(e||window).EBG.Modules.DelayedImpression(this._adConfig),this._handleDelayedImpressionReport()},this):this._adConfig.reportImpressionType==EBG.ReportImpressionType.CLIENT&&(e=this._adConfig.inAppSettings&&this._adConfig.inAppSettings.sdkBridgeEnabled&&!this._adConfig.isInstream?this._handleClientImpressionWaiting:this._handleClientImpression,(t=new EBG.Events.EventSubscription(EBG.Events.EventNames.INAPP_IMPRESSION,e,this)).dispatcherFilters={ebRand:this._adConfig.rnd},t.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(t),(t=new EBG.Events.EventSubscription(EBG.Events.EventNames.ELEMENT_LOADED,e,this)).dispatcherFilters={ebRand:this._adConfig.rnd},t.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(t),(t=new EBG.Events.EventSubscription(EBG.EBMessage.DOCUMENT_LOADED,e,this)).dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd},t.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(t),(t=new EBG.Events.EventSubscription(EBG.Events.EventNames.CREATIVE_CONTAINER_READY,e,this)).dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd},t.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(t))},_handleClientImpressionWaiting:function(e){var t=this._adConfig.inAppSettings||{sdkPurpose:2},i=t.sdkPurpose;if(e.name!==EBG.Events.EventNames.INAPP_IMPRESSION){if(this.ImpressionEvent&&e.name!==this.ImpressionEvent.name)return;this.ImpressionEvent=e,this.impressionWaitingStatus.adRender||(this.impressionWaitingStatus.adRender=!0,!this.adRenderReported&&t.onRender&&(this.adRenderReported=1,this._dpm.sendNow(this._adConfig.dpUrlEvents,{ad_onRender:2,sdk_purpose:i})),t.allowInappReporting||this._handleClientImpression(e))}else e.eventData.hasOwnProperty("sdkTrigger")&&(this.impressionWaitingStatus.sdkTrigger=e.eventData.sdkTrigger),e.eventData.hasOwnProperty("supportsSDK")&&(this.impressionWaitingStatus.supportsSDK=e.eventData.supportsSDK),e.eventData.hasOwnProperty("isViewable")&&(this.impressionWaitingStatus.isViewable=e.eventData.isViewable);t.hasOwnProperty("sdkBridgeLoaded")&&this.impressionWaitingStatus.hasOwnProperty("supportsSDK")&&this.impressionWaitingStatus.adRender&&(t.allowLogging&&this.impressionWaitingStatus.supportsSDK&&!this.sdk_appSupported&&(this.sdk_appSupported=1,this._dpm.sendNow(this._adConfig.dpUrlEvents,{sdk_appSupported:1,sdk_siteSupported:t.reportSiteSupported,sdk_advertiserSupported:t.reportSupportedAdvertiser,sdk_purpose:i})),t.sdkBridgeLoaded&&this.impressionWaitingStatus.supportsSDK&&!this.impressionWaitingStatus.isViewable||(t.allowInappReporting&&!this.vwImpSent&&(this.vwImpSent=1,this._handleClientImpression(this.ImpressionEvent)),t.allowLogging&&!this.adViewReported&&this.impressionWaitingStatus.isViewable&&this._adConfig.dpUrlEvents&&(this.adViewReported=!0,e={ad_onview:1,sdk_purpose:i},this.impressionWaitingStatus.sdkTrigger&&(e.sdk_trigger=this.impressionWaitingStatus.sdkTrigger),this._dpm.sendNow(this._adConfig.dpUrlEvents,e))))},_handleClientImpression:function(e){var t;this._adConfig.impressionSent||(t=this._adConfig.inAppSettings,!this.adRenderReported&&t&&t.allowBridge&&t.onRender&&(this.adRenderReported=1,this._dpm.sendNow(this._adConfig.dpUrlEvents,{ad_onRender:1,sdk_purpose:t.sdkPurpose})),(e.eventData&&e.eventData.adUId?e.eventData.adUId:e.dispatcher&&e.dispatcher._adConfig?e.dispatcher._adConfig.uid:null)==this._adConfig.uid&&(e=e.eventData&&e.eventData.DOMEvent&&e.eventData.DOMEvent.target?e.eventData.DOMEvent.target:e.dispatcher&&e.dispatcher._iframe?e.dispatcher._iframe:e.dispatcher&&e.dispatcher._res?e.dispatcher._res:null,this._dispatchClientImpression(),this._adConfig.impressionTrackingURLs&&this._reportImpressionTrackingURLs(this._adConfig.impressionTrackingURLs),EBG.intMgr.allowInteractionReport(this._adConfig.uid),this._adConfig.ffs.CFF_ReportVPI&&this._adConfig.Purposes.Measurements&&this._adConfig.Purposes.Debug&&(this._adConfig.impData={inapp:0,ioexists:0,target:0,vpicheck:0},window.IntersectionObserver&&(this._adConfig.impData.ioexists=1),e&&(this._adConfig.impData.target=1),EBG.adaptor.browser.isInApp()&&(this._adConfig.impData.inapp=1),EBG.adaptor.browser.isInApp()||this._adConfig.ffs.CFF_ReportVPIAll))&&(this._adConfig.impData.vpicheck=1,window.IntersectionObserver&&e?this._waitForViewportImpression(e):this._dispatchViewportImpression()))},_waitForViewportImpression:function(e){this.observer=new IntersectionObserver(this._handleViewportImpression.bind(this),{threshold:[0]}),this.observer.observe(e)},_handleViewportImpression:function(e){(e=e[0]).isIntersecting&&(this.observer.unobserve(e.target),this._dispatchViewportImpression())},_dispatchViewportImpression:function(){if(this._adConfig.ViewportImpressionSent)return!1;this._adConfig.ViewportImpressionSent=!0,this._adConfig.impData.vpimp=1,this._adConfig.dpUrlEvents&&this._dpm.sendNow(this._adConfig.dpUrlEvents,this._adConfig.impData)},_dispatchClientImpression:function(e){if(this._adConfig.impressionSent||EBG.isPreview)return!1;this._adConfig.impressionSent=!0;var t=+new Date-this._adConfig.handleStartTime;this._dpm.send(EBG.DataProfile.DEBUG,{timeImp:t});var i=EBG.format("{0}{1}/Serving?cn=display&c=40&sessionid={2}&ai={3}&usercookie={4}&oo={5}",EBG.protocol,this._adConfig.bsPath,this._adConfig.sID,this._adConfig.adId,this._adConfig.usercookie,this._adConfig.optOut);e&&(i+="&isBlank=1"),(!(e=this._adConfig.ffs&&this._adConfig.ffs.CFF_SendUndefined)&&void 0!==this._adConfig.gdprpurposes||e)&&(i+="&gdprpurposes="+this._adConfig.gdprpurposes),this._adConfig.defaultImageDisplayed&&this._cdiReason&&(i+="&di=1&dir="+this._cdiReason),(this._adConfig.massVersioning.originalDeliveryGroupId||this._adConfig.massVersioning.deliveryGroupId)&&(i+="&dg="+(this._adConfig.massVersioning.originalDeliveryGroupId||this._adConfig.massVersioning.deliveryGroupId)),this._adConfig.massVersioning.subDeliveryGroupId&&(i+="&sdg="+this._adConfig.massVersioning.subDeliveryGroupId),this._adConfig.diAppId&&(i+="&diappid="+this._adConfig.diAppId),this._adConfig.isNXT&&(i+="&ctick="+t),i+="&ord="+Math.random(),EBG.adaptor.reportToRemoteServer(i,!0),this._dpm.send(EBG.DataProfile.SERVING,{cimp:1}),(t=new EBG.Events.Event(EBG.Events.EventNames.IMPRESSION_SENT)).timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.dispatchEvent(t)},_subscribeEventTriggeringURLs:function(){if(this._adConfig.eventTrackingURLs)for(var e in this._adConfig.eventTrackingURLs=this._eventTrackingURLsAdapter(this._adConfig.eventTrackingURLs),this._adConfig.eventTrackingURLs)this._subscribeToAdEvent(e,this._handleEventTrackingURLs,EBG.Events.EventTiming.ONTIME)},_eventTrackingURLsAdapter:function(t){function e(e){n.ebVideoInteraction=n.ebVideoInteraction||[],n.ebVideoInteraction.push({filter:{"eventData.intName":e},urls:t[i]})}var i,n={};for(i in t)switch(i){case"vidStart":e(EBG.VideoInteraction.STARTED);break;case"vid25Played":e(EBG.VideoInteraction.PERCENT_25_PLAYED);break;case"vid50Played":e(EBG.VideoInteraction.PERCENT_50_PLAYED);break;case"vid75Played":e(EBG.VideoInteraction.PERCENT_75_PLAYED);break;case"vidFullyPlayed":e(EBG.VideoInteraction.FULLPLAY)}return n},_handleEventTrackingURLs:function(e){for(var t=this._adConfig.eventTrackingURLs[e.name],i=0;i<t.length;i++){var n=t[i];if(n.filter)for(var a in n.filter)EBG.valueFromPath(e,a)==n.filter[a]&&this._reportImpressionTrackingURLs(n.urls);else this._reportImpressionTrackingURLs(n.urls)}},_counterInteractionHandler:function(e){try{var t=(t=e.eventData.intName)||EBG.Interactions.SystemInts.CLICK;e.eventData.clickUrl=this._replaceURLTokens(e.eventData.clickUrl),e.eventData.clickedVerUrl=this._replaceURLTokens(e.eventData.clickedVerUrl),EBG.intMgr.handleCounterInteraction(t,this._adConfig.uid,0,null,e.eventData,void 0===e.eventData.handleClickInt||e.eventData.handleClickInt)}catch(e){}EBG.log.endGroup()},_versionTrackingImpressionHandler:function(e){try{e.eventData.impTrackingUrls&&this._reportImpressionTrackingURLs(e.eventData.impTrackingUrls)}catch(e){}EBG.log.endGroup()},_reportImpressionTrackingURLs:function(e){if(!EBG.isPreview||EBG.isTestMode)for(var t=0;t<e.length;t++){var i=e[t];i&&(i=this._replaceURLTokens(i),EBG.Autolina&&EBG.Autolina.report(i,EBG.Autolina.reportType.THIRDPARTY),EBG.adaptor.reportToRemoteServerUsingImage(i),this._adConfig.ffs.CFF_ReportTPUrl&&this._dpm.sendNow(this._adConfig.dpUrlEvents,{tpurl:encodeURIComponent(i)}))}},_show:function(){var e=!this._canShow()||this._adConfig.showOnlyImage;this._adConfig.defaultImageDisplayed=!(!e||!this._adConfig.defaultImagePath);var t=this._adConfig.showOnlyImage;this._verifyPlaceHolder();var i=new EBG.Events.Event(EBG.Events.EventNames.SHOW_AD);i.dispatcher=this,i.timing=EBG.Events.EventTiming.BEFORE,i.eventData={isDefaultImage:this._adConfig.defaultImageDisplayed},EBG.eventMgr.dispatchEvent(i),t!==this._adConfig.showOnlyImage&&(e=!this._canShow()||this._adConfig.showOnlyImage||this._adConfig.showAieDefaultImage),this._calculateTimePageLoaded(),this._subscribeToEvents(),EBG.intMgr.initAdData(this._adConfig,!(!this._adConfig.shouldReportImpression&&!this._adConfig.isInstream)),this._addSystemInteractions(),EBG.AdChoice&&EBG.AdChoice.AdChoiceManager?(this._adChoice=new EBG.AdChoice.AdChoiceManager(this._adConfig),this._adChoice.init()):this._adConfig.AcIncludeMarker&&EBG.adaptor.loadModule("AdChoice",this._adConfig,function(e){this._adChoice=new(e||window).EBG.AdChoice.AdChoiceManager(this._adConfig),this._adChoice.init()},this),(t=EBG.adaptor.getElementById(this._adConfig.placeHolderId))&&this.resizePlaceHolder&&void 0!==this._adConfig.display&&EBG.adaptor.setElemStyle(t,"display",this._adConfig.display),e?(this._dpm.send(EBG.DataProfile.SERVING,{img:1}),this._adConfig.defaultImagePath?(this._adConfig.imageOnly||((e=new EBG.Events.Event(EBG.Events.EventNames.DEFAULT_IMPRESSION)).eventData={impTrackingUrls:this._adConfig.defaultImpTrackingUrls},e.dispatcher=this,e.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.dispatchEvent(e)),this._subscribeToAdEvent(EBG.Events.EventNames.ADD_BANNER_DEFAULT_IMAGE_CREATIVE,this._terminateShow,EBG.Events.EventTiming.AFTER),this._showOnlyDefaultImg=!0,this.checkAndShowDefaultImage(this.showDefaultImage)):this._adConfig.reportImpressionType==EBG.ReportImpressionType.CLIENT?this._dispatchClientImpression(!0):this._adConfig.reportImpressionType==EBG.ReportImpressionType.DELAYED&&this._reportImpression&&this._reportImpression(!0)):(this._showOnlyDefaultImg=!1,this._addVideoInteractions(),this._addCustomInteractions(),this._adConfig.useHtmlConvertor&&this._subscribeToAdEvent(EBG.Events.EventNames.ADD_CREATIVES,this._terminateShow,EBG.Events.EventTiming.AFTER),this._addCreatives(),this._adConfig.useHtmlConvertor||this._terminateShow()),EBG.log.endGroup()},_getAdSize:function(){return{adWidth:EBG.px(this._adConfig.width),adHeight:EBG.px(this._adConfig.height)}},_terminateShow:function(e){var t,i=this.placeHolderElement=EBG.adaptor.getElementById(this._adConfig.placeHolderId);i&&this.resizePlaceHolder&&(t=this._getAdSize(),EBG.adaptor.setElemStyle(i,"width",t.adWidth),EBG.adaptor.setElemStyle(i,"height",t.adHeight),EBG.adaptor.setElemStyle(i,"margin","0px auto")),(i=new EBG.Events.Event(EBG.Events.EventNames.SHOW_AD)).dispatcher=this,i.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,i.eventData={isDefaultImage:!!e},EBG.eventMgr.dispatchEvent(i)},_verifyPlaceHolder:function(){return EBG.adaptor.getElementById(this._adConfig.placeHolderId)||document.body||document.write('<img style="width:0;height:0"></img>'),EBG.adaptor.getElementById(this._adConfig.placeHolderId)},_canShow:function(){return!0},_onPlayHandler:function(){this._adConfig.arrOnPlayEvents&&this._executeEvents(this._adConfig.arrOnPlayEvents),EBG.log.endGroup()},_onDownloadHandler:function(){this._adConfig.arrOnStartDnlEvents&&this._executeEvents(this._adConfig.arrOnStartDnlEvents),EBG.log.endGroup()},_collectUrl:function(){if(!EBG.isPreview&&this._adConfig.shouldCollectUrl)try{var e=top.document.URL;this._adConfig.adId,EBG.adaptor.reportToRemoteServer(EBG.format("{0}{1}/BurstingPipe/adServer.bs?cn=curl&ai={2}&url=$${3}$$",EBG.protocol,this._adConfig.bsPath,this._adConfig.adId,e))}catch(e){}EBG.log.endGroup()},_executeEvents:function(e){for(var t,i,n=0;n<e.length;n++)switch(i=this._replaceURLTokens(e[n].url),e[n].typeId){case 3:t="ebPlayScript"+n,EBG.adaptor.writeScript(EBG.adaptor.generateElementId(t,this._adConfig.uid),i,this._adConfig.placeHolderId);break;case 5:t="ebDnlScript"+n,EBG.adaptor.writeScript(EBG.adaptor.generateElementId(t,this._adConfig.uid),i,this._adConfig.placeHolderId);break;case 4:t="ebPlayIFR"+n,EBG.adaptor.writeReportingIFrame(EBG.adaptor.generateElementId(t,this._adConfig.uid),i,this._adConfig.placeHolderId);break;case 6:t="ebDnlIFR"+n,EBG.adaptor.writeReportingIFrame(EBG.adaptor.generateElementId(t,this._adConfig.uid),i,this._adConfig.placeHolderId);break;default:e[n].typeId,e[n].url}EBG.log.endGroup()},_addSystemInteractions:function(){try{var e,t=this._adConfig.interactions[EBG.Interactions.SystemInts.CLICK];t&&(e=EBG.Interactions.Categories.SYSTEM,this._adConfig.interactions[EBG.Interactions.SystemInts.DEFAULT_CLICK]?this._hasDefaultImageInteraction=!0:this._adConfig.interactions[EBG.Interactions.SystemInts.DEFAULT_CLICK]=EBG.cloneObj(t),this._addCounterInteraction(EBG.Interactions.SystemInts.CLICK,e),this._addCounterInteraction(EBG.Interactions.SystemInts.DEFAULT_CLICK,e));var i=new EBG.Interactions.CounterInteractionData(EBG.Interactions.SystemInts.ACTUAL_SIZE,e,this._adConfig.uid);i.initiationType=EBG.Interactions.InitiationTypes.AUTO,i.numLeftToReport=i.numToReport=1,i.reportImmediately=!0,i.useInteractionsStrPipe=!0;var n=new EBG.Interactions.CounterInteraction(i);EBG.intMgr.addInteraction(n,EBG.Interactions.SystemInts.ACTUAL_SIZE),EBG.Ads.StdBanner&&this instanceof EBG.Ads.StdBanner||EBG.Ads.WallpaperAd&&this instanceof EBG.Ads.WallpaperAd||(this._addCounterInteraction(EBG.Interactions.SystemInts.AD_START,e,!0,1),this._addCounterInteraction(EBG.Interactions.SystemInts.END_OF_SESSION,e,!1,1),this._addCounterInteraction(EBG.Interactions.SystemInts.AD_STACKING,e,!1,1),this._addCounterInteraction(EBG.Interactions.SystemInts.MULTI_BURN,e,!1,1),this._addCounterInteraction(EBG.Interactions.SystemInts.AD_COLLISION,e,!1,1),this._addCounterInteraction(EBG.Interactions.SystemInts.AD_CAROUSEL,e,!1,1),this._adConfig.adParamsEnabled&&this._addCounterInteraction(EBG.Interactions.SystemInts.AD_PARAMS,e,!1,5,null,null,!0),this._adConfig.verUrlEnabled&&this._addCounterInteraction(EBG.Interactions.SystemInts.VER_URL,e,!1,1,null,null,!0))}catch(e){}EBG.log.endGroup()},_addCounterInteraction:function(e,t,i){var n=this._adConfig.interactions[e];(t=new EBG.Interactions.CounterInteractionData(e,t,this._adConfig.uid)).initiationType=n.nInitiated?EBG.Interactions.InitiationTypes.USER:EBG.Interactions.InitiationTypes.AUTO,t.countAsClick=n.fClick,n.agencyURL&&(t.remoteServers.agencyUrl=n.agencyURL),n.networkURL&&(t.remoteServers.networkUrl=n.networkURL),this._adjustClickTarget(e),t.counterJumpUrlData=n,t.reportImmediately=!!i,e=new EBG.Interactions.CounterInteraction(t),EBG.intMgr.addInteraction(e),EBG.log.endGroup()},_addVideoInteractions:function(){},_addCustomInteractions:function(){},_adjustClickTarget:function(e){switch((e=this._adConfig.interactions[e]).target){case 0:var t=EBG.WindowTarget.SELF;break;case 2:t=EBG.WindowTarget.TOP;break;default:t=EBG.WindowTarget.BLANK}e.target=t,EBG.log.endGroup()},_subscribeToEvents:function(){this._adConfig.interactionsToReport&&this._subscribeToAdEvent(EBG.Events.EventNames.ADD_INTERACTION,this._handleInteractionsSubscription,EBG.Events.EventTiming.BEFORE),this._subscribeToAdEvent(EBG.EBMessage.CLICKTHROUGH,this._counterInteractionHandler),this._subscribeToAdEvent(EBG.EBMessage.VERSION_TRACKING_IMPRESSION,this._versionTrackingImpressionHandler),this._subscribeToAdEvent(EBG.Events.EventNames.DEFAULT_IMPRESSION,this._versionTrackingImpressionHandler,EBG.Events.EventTiming.ONTIME),this._subscribeToAdEvent(EBG.Events.EventNames.DEFAULT_CLICK,this._counterInteractionHandler),this._subscribeToAdEvent(EBG.Events.EventNames.ADD_CREATIVES,this._onAddCreativesHandler,EBG.Events.EventTiming.ONTIME),this._subscribeToAdEvent(EBG.Events.EventNames.SHOW_AD,this._onDownloadHandler,EBG.Events.EventTiming.ONTIME),this._subscribeToAdEvent(EBG.Events.EventNames.SHOW_AD,this._onPlayHandler,EBG.Events.EventTiming.AFTER),this._subscribeToAdEvent(EBG.Events.EventNames.SHOW_AD,this._collectUrl,EBG.Events.EventTiming.AFTER),this._subscribeToAdEvent(EBG.Events.EventNames.ADD_CREATIVES,function(){this._actualSizeDetector=new EBG.RichModules.ActualSizeDetector(this._adConfig)},EBG.Events.EventTiming.ONTIME),this._adConfig.adParamsEnabled&&this._subscribeToAdEvent(EBG.Events.EventNames.AD_START,this._reportAdParams,EBG.Events.EventTiming.AFTER),this._subscribeToAdEvent(EBG.EBMessage.NOTIFY_INTERACTION_MONITOR,this._notifyInteractionManager);var e=new EBG.Events.EventSubscription(EBG.Events.EventNames.ELEMENT_LOADED,function(e){e.eventData.adUId==this._adConfig.uid&&this._triggerAdStart()},this);e.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(e),this._subscribeToAdEvent(EBG.Events.EventNames.THROTTLED,this._handleCreativeThrottled),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_UNLOAD,this._unLoadHandler,this)),EBG.log.endGroup()},_handleInteractionsSubscription:function(e){try{var t=e.eventData.interactionData.reportingName;return this._adConfig.interactionsToReport&&this._adConfig.interactionsToReport[t]?!0:!1}catch(e){}},_onAddCreativesHandler:function(e){e&&e.eventData&&e.eventData.creativeType&&e.eventData.creativeType==EBG.Events.EventNames.ADD_BANNER_DEFAULT_IMAGE_CREATIVE||this._checkForCreativeThrottling();try{var t,i;EBG.Initializer._getAdClass({tn:this._adConfig.templateName}).requiresIframeBust&&this._adConfig.actualServingMode!=EBG.Adaptors.ServingMode.SCRIPT||(!(t=e.dispatcher._adConfig.placeHolderId)||(i=(this._adConfig.displayWin||EBG.adaptor.getDisplayWin()).document.getElementById(t))&&(i.style.backgroundImage="",i.onclick=function(){}))}catch(e){}},_checkForCreativeThrottling:function(){for(cc in this._CCs)this._CCs.hasOwnProperty(cc)&&this._CCs[cc].detectThrottling&&(this._CCs[cc].detectThrottling(),this._subscribeToAdEvent(EBG.Events.EventNames.MOUSE_OVER,this._stopPollingForThrottle,EBG.Events.EventTiming.ONTIME))},_stopPollingForThrottle:function(e){var t=!0;if(e&&e.eventData&&e.eventData.target&&e.eventData.target.children){for(var i in this._CCs)this._CCs.hasOwnProperty(i)&&(e.eventData.target.children[i]&&this._CCs[i].stopPollingForThrottle&&this._CCs[i].stopPollingForThrottle(),this._CCs[i].isPollingForThrottle&&1==this._CCs[i].isPollingForThrottle&&(t=!1));t&&((e=new EBG.Events.EventSubscription(EBG.Events.EventNames.MOUSE_OVER,this._stopPollingForThrottle,this)).dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd},e.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.unsubscribeFromEvent(e))}},_updateURLs:function(){for(var e,t=this._adConfig.clickTrackingUrls,i=0;i<t.length;i++)t[i]=this._replaceURLTokens(t[i]);for(e in t=this._adConfig.interactions)t.hasOwnProperty(e)&&(t[e].agencyURL=this._replaceURLTokens(t[e].agencyURL),t[e].networkURL=this._replaceURLTokens(t[e].networkURL),t[e].jumpUrl=this._replaceURLTokens(t[e].jumpUrl))},_handleMultiBurn:function(){this._reportMultiBurn(this._checkMultiBurn())},_checkMultiBurn:function(){var e={isAdCarousel:!1,isAdCollision:!1,isMultiBurn:!1},t=this._adConfig.advertiserId,i=this._adConfig.placementId,n=this._adConfig.uid;try{var a,s=EBG.adaptor.getTopAccessibleWindow(!1);for(a in s.ebAds=s.ebAds||{},s.ebAds){var r,o=s.ebAds[a];if(n!=o._adConfig.uid&&o.placeHolderElement){if(!o.removed)try{0==o.placeHolderElement.getClientRects().length&&(o.removed=!0)}catch(e){o.removed=!0}o.removed?(r=(new Date).getTime()/1e3-o.startTime,!e.isAdCarousel&&10<r&&r<150&&(e.isAdCarousel=!0)):e.isMultiBurn||i!==o._adConfig.placementId?e.isMultiBurn||e.isAdCollision||!t||t!==o._adConfig.advertiserId||(e.isAdCollision=!0):e.isMultiBurn=!0}}}catch(e){}return e},_reportMultiBurn:function(e){e.isMultiBurn?EBG.intMgr.handleCounterInteraction(EBG.Interactions.SystemInts.MULTI_BURN,this._adConfig.uid):e.isAdCollision&&EBG.intMgr.handleCounterInteraction(EBG.Interactions.SystemInts.AD_COLLISION,this._adConfig.uid),e.isAdCarousel&&EBG.intMgr.handleCounterInteraction(EBG.Interactions.SystemInts.AD_CAROUSEL,this._adConfig.uid)},_reportAdParams:function(e){var t,i;EBG.intMgr.isInteractionExist(EBG.Interactions.SystemInts.AD_PARAMS.toLowerCase(),EBG.Interactions.InteractionTypes.COUNTER,this._adConfig.uid)&&(EBG.adaptor.isPageLoaded()?this._adConfig.adParamsEnabled&&(i=this._getServingModeNum(),t=(t=this._getBannerLocation())&&t.X+"x"+t.Y,e=this.visibilityMgr?this.visibilityMgr.getVisibilityProviderNum():0,i={ifr:i,loc:t,size:this._adConfig.width+"x"+this._adConfig.height,cb:this._getAdCodeBase(),env:EBG.adaptor.browser.getEnvironment()},this._adConfig.Purposes.Debug&&(i.vsbp=e),this._adConfig.wurflValue&&(i.bi=this._adConfig.wurflValue),EBG.intMgr.handleCounterInteraction(EBG.Interactions.SystemInts.AD_PARAMS,this._adConfig.uid,0,!1,{value:i})):this._subscribeToAdEvent(EBG.Events.EventNames.PAGE_LOAD,this._reportAdParams))},_calculateTimePageLoaded:function(e){EBG.adaptor.isPageLoaded()?this._adConfig.performance&&this._dpm.send(EBG.DataProfile.DEBUG,{timePage:+new Date-this._adConfig.handleStartTime}):this._subscribeToAdEvent(EBG.Events.EventNames.PAGE_LOAD,this._calculateTimePageLoaded)},_getBannerLocation:function(e){var t,i;return e&&EBG.isNumber(e.X)&&EBG.isNumber(e.Y)&&(i=function(){t=EBG.adaptor.getPositioningByElement(this.frameElement),e.X+=t.X,e.Y+=t.Y},EBG.adaptor.walkUpIframes(function(){this.location.ancestorOrigins?this.location.ancestorOrigins[0]&&this.location.ancestorOrigins[0]==this.location.origin&&this.frameElement&&i.call(this):this.frameElement&&i.call(this)},null,EBG.adaptor.getDisplayWin())),e},_getAdCodeBase:function(e){return e=EBG.isDefined(e)?e:0,e=1==(e=this._showOnlyDefaultImg?0:e)&&this._adConfig.hasConverter&&this._adConfig.useHtmlConvertor?3:e},_getServingModeNum:function(){var e={SCRIPT:0,FRIENDLY_IFRAME:1,IFRAME:2,INNER_IFRAME:3,TOPMOST_FRIENDLY_IFRAME:4};if(!EBG.adaptor.serving)return-1;var t=EBG.adaptor.serving.detectServingEnvironment(this._adConfig.actualServingMode);return EBG.isDefined(e[t])?e[t]:-1},_getTemplateNameNum:function(){return{Html5StdBanner:0,Html5Banner:1,Html5SEBanner:2,Html5ExpBanner:3,Html5PoliteBanner:4,StdBanner:5,Banner:6,SingleExpBanner:7,ExpBanner:8,Visibility:9,FloatingAd:10,FloatingAdWithReminder:11,Tracking:12}[this._adConfig.templateName]||-1},_replaceURLTokens:function(e){var t=this._adConfig;try{if(e&&(e=(e=(e=(e=(e=(e=e.replace(/\[%random%\]/gi,t.rnd)).replace(/\[ebRandom\]/gi,t.rnd)).replace(/\[timestamp\]/gi,t.rnd)).replace(/\[%tp_adid%\]/gi,t.adId)).replace(/\[%tp_flightid%\]/gi,t.placementId)).replace(/\[%tp_campaignid%\]/gi,t.campaignId),t.gdpr&&(e=(e=(e=e.replace(/\[%gdpr%\]/gi,t.gdpr)).replace(/\${gdpr}/gi,t.gdpr)).replace(/{gdpr}/gi,t.gdpr)),t.gdprconsent)){e=(e=e.replace(/\[%gdpr_consent%\]/gi,t.gdprconsent)).replace(/{gdpr_consent}/gi,t.gdprconsent);if(/\${gdpr_consent_(.*?)}/gi.test(e))try{var i=/\${gdpr_consent_(.*?)}/gi.exec(e)[1];i&&-1!=[2,6,8,9,12,15,18,23,25,33,36,37,41,42,44,45,47,50,52,53,58,59,61,65,66,68,72,78,80,88,89,90,93,94,100,109,114,115,120,126,127,128,129,130,133,136,137,138,144,147,153,163,164,167,174,177,192,199,203,205,206,210,213,215,218,223,224,226,228,235,240,243,248,256,262,272,273,277,278,279,280,281,285,294,302,303,304,314,315,318,325,328,350,351,358,368,371,374,387,402,413,415,422,423,424,428,429,436,439,440,447,450,466,467,486,490,491,495,498,502,507,512,516,522,524,530,531,535,543,544,545,546,549,550,553,554,556,559,568,571,580,587,593,602,606,607,609,612,613,618,620,626,628,648,650,652,653,656,657,659,662,663,665,668,674,675,676,681,683,684,686,687,688,690,691,694,699,702,703,707,708,709,711,712,713,714,716,719,720,722,723,725,726,729,731,733,734,735,737,738,740,741,742,743,744,745].indexOf(+i)&&(e=e.replace(/\${gdpr_consent_(.*?)}/gi,t.gdprconsent))}catch(e){}}if(!e||!t.sUrlTokens)return EBG.log.endGroup(),e;for(var n in EBG.isObj(t.objURLTokens)||(t.oURLTokens=this._pairsToObj(t.sUrlTokens,"$$")),t.oURLTokens)t.oURLTokens.hasOwnProperty(n)&&(e=e.replace(new RegExp("\\[%"+n+"%\\]","ig"),t.oURLTokens[n]))}catch(e){EBG.log.endGroup()}return EBG.log.endGroup(),e},_pairsToObj:function(e,t){var i,n,a,s={};for(e=unescape(e).split(t),t=0;t<e.length;t++)try{e[t]&&(i=e[t].indexOf("="),n=e[t].substr(0,i),a=e[t].substr(i+1),s[n]=escape(a))}catch(e){}return s},_subscribeToAdEvent:function(e,t,i){return(e=new EBG.Events.EventSubscription(e,t,this)).dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd},i&&(e.timing=i),EBG.eventMgr.subscribeToEvent(e),e},_getCDIUrl:function(e){var t=e&&e.defaultImagePath?e.defaultImagePath:null,t=EBG.format("{0}{1}/{2}/adServer.bs?cn=cdi&ai={3}&p={4}&pluid={5}&ru={6}&pc={7}&brt={8}&pltype={9}&sessionid={10}&dir={11}&ord={12}",EBG.protocol,this._adConfig.bsPath,this._adConfig.interactionServer,this._adConfig.adId,this._adConfig.page,this._adConfig.pluId,EBG.isDefinedNotNull(t)&&""!=t?t:EBG.combinePaths(this._adConfig.resourcePath,this._adConfig.defaultImagePath),this._adConfig.sPublisherPlacementId,EBG.adaptor.browser._browserCode,EBG.adaptor.browser._platform,this._adConfig.sID,this._cdiReason,this._adConfig.rnd),i=this._adConfig.massVersioning.targetAudienceId;return i&&(t+=EBG.format("&ta={0}",i)),(i=this._adConfig.massVersioning.deliveryGroupId)&&(t+=EBG.format("&dg={0}",i)),e&&e.versionId?t+=EBG.format("&vid={0}",e.versionId):this._adConfig.massVersioning.adVersions&&(e=this._removePrefixFromVersions(),t+=EBG.format("&vid={0}",e)),EBGInfra.isDefinedNotNull(this._adConfig.diAppId)&&(t+="&diappid="+this._adConfig.diAppId),t},_removePrefixFromVersions:function(){var e="";if(t=this._adConfig.massVersioning.adVersions.toString()){for(var e=[],t=t.split(","),i=0;i<t.length;i++){var n=t[i].indexOf("_");e.push(-1==n?t[i]:t[i].substring(0,n))}e=e.join()}return e},buildJSONImgObj:function(e,t){return e=EBG.format(e+"_{0}",this._adConfig.uid),{tagName:EBG.Adaptors.TagNames.IMG,attributes:{id:e,src:t,width:this._adConfig.width,height:this._adConfig.height,style:{width:this._adConfig.width,height:this._adConfig.height},title:this._adConfig.title||"",onload:EBG.format('(function(e) { var event = new EBG.Events.Event(EBG.Events.EventNames.ELEMENT_LOADED);event.dispatcher = this;event.eventData = { DOMEvent: e, elementId: "{0}", adUId:"{1}" };event.timing = EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(event);} )(typeof arguments != "undefined" ? arguments[0] : null);',e,this._adConfig.uid)}}},setImageClick:function(e,t,i,n,a){e.attributes.onclick=EBG.format('EBG.ads["'+this._adConfig.uid+'"].onImageClick("{0}", {1},"{2}", "{3}", "{4}", "{5}")',this._adConfig.uid,t,e.attributes.id,i,n,a),EBG.mergeObj({cursor:"pointer; cursor: hand"},e.attributes.style)},_addDefaultImgRequest:function(){this.checkAndShowDefaultImage(this.showDefaultImage)},checkAndShowDefaultImage:function(e){var t="",i=".xml",n=!0;(EBG.isDefinedNotNull(this._adConfig.svJSON)||EBG.isDefinedNotNull(this._adConfig.sv3CatalogMap)||this._adConfig.massVersioning.versionFullPath)&&(n=!(i=".json")),EBG.isDefinedNotNull(this._adConfig.massVersioning)&&""!=this._adConfig.massVersioning.defaultAdVersion&&""!=this._adConfig.massVersioning.adBasePath&&(t=this._adConfig.massVersioning.defaultAdVersion,t=0<this._adConfig.massVersioning.massVersionFolderDivider?EBG.Ads.Ad.Fn.fixMVPathString(t,this._adConfig.massVersioning.massVersionFolderDivider):t,this._adConfig.massVersioning.versionFullPath&&(t=t.p),t=EBG.combinePaths(this._adConfig.massVersioning.adBasePath,t+i),t=this._adConfig.massVersioning.versionFullPath?EBG.combinePaths("//"+this._adConfig.sHost,t):EBG.combinePaths(this._adConfig.resourcePath,t)),i=n?this._readMassVersionInfo:this._readJsonVersionInfo,t&&EBG.adaptor.getDataFromRemoteServer(t,i,this,!0,n)||e.apply(this)},subscribeToStandardElementEvents:function(e){},showDefaultImage:function(e){var t=(this._adConfig.showOnlyImage||this._cdiReason)&&this._hasDefaultImageInteraction;this._adConfig.showOnlyImage||this._adConfig.imageOnly||this._adConfig.shouldReportImpression?n=e&&e.isValid?e.defaultImagePath:EBG.combinePaths(this._adConfig.resourcePath,this._adConfig.defaultImagePath):(n=e&&e.isValid?this._getCDIUrl(e):this._getCDIUrl(),this._adConfig.massVersioning.adVersions="");var i,n=this.buildJSONImgObj("ebDefaultImg",n),a=(e&&e.isValid&&e.jumpUrl?e:t?this._adConfig.interactions[EBG.Interactions.SystemInts.DEFAULT_CLICK]:this._adConfig.interactions[EBG.Interactions.SystemInts.CLICK]).jumpUrl;a&&this.setImageClick(n,t,a,e&&e.isValid?e.selectedVersion:"",e&&e.isValid?e.thirdPartyClks:""),e&&e.thirdPartyImps&&e.thirdPartyImps.length&&this._reportImpressionTrackingURLs(e.thirdPartyImps),(e=new EBG.Events.Event(EBG.Events.EventNames.ADD_CREATIVES)).dispatcher=this,e.eventData={tagsObj:n,assetId:n.attributes.id,isPanel:!1,creativeType:EBG.Events.EventNames.ADD_BANNER_DEFAULT_IMAGE_CREATIVE},e.timing=EBG.Events.EventTiming.BEFORE,(a=EBG.eventMgr.dispatchEvent(e))||((t=new EBG.Events.Event(EBG.Events.EventNames.ADD_BANNER_DEFAULT_IMAGE_CREATIVE)).eventData={assetId:n.attributes.id},t.dispatcher=this,t.timing=EBG.Events.EventTiming.BEFORE,(a=EBG.eventMgr.dispatchEvent(t))||!(a=EBG.adaptor.getElementById(this._adConfig.placeHolderId)))||(i=EBG.adaptor.createImageElement(n),EBG.adaptor.setInnerHtml(a,""),a.appendChild(i),this._defaultImgResId=n.attributes.id,this.subscribeToStandardElementEvents(this._defaultImgResId),t.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(t),e.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(e),EBG.log.endGroup())},_triggerAdStart:function(e){this._shouldWaitForTriggerAdStart()&&(!EBGInfra.isDefined(e)||e.name!==EBG.EBMessage.TRIGGER_AD_START)||this._adConfig.adStarted||(this._adConfig.adStarted=!0,(e=new EBG.Events.Event(EBG.Events.EventNames.AD_START)).eventData={intName:EBG.Interactions.SystemInts.Ad_START},e.dispatcher=this,e.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.dispatchEvent(e)||(this._shouldFireAdStart()&&EBG.intMgr.handleCounterInteraction(EBG.Interactions.SystemInts.AD_START,this._adConfig.uid),e.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(e)))},_shouldFireAdStart:function(){return this._adConfig.displayVerification||this._adConfig.visibility.mode==EBG.VisibilityMode.BASIC_MODE||this._adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE},_shouldWaitForTriggerAdStart:function(){return!1},_readJsonVersionInfo:function(e){var t,i=JSON.parse(e);e=this._adConfig.massVersioning.defaultAdVersion&&this._adConfig.massVersioning.defaultAdVersion.indexOf&&this._adConfig.massVersioning.defaultAdVersion.indexOf("_"),e=this._adConfig.massVersioning.defaultAdVersion&&this._adConfig.massVersioning.defaultAdVersion.v?this._adConfig.massVersioning.defaultAdVersion.v:-1==e?this._adConfig.massVersioning.defaultAdVersion:this._adConfig.massVersioning.defaultAdVersion.substring(0,e),(e={isValid:!!i.DefaultImage,jumpUrl:i.ClickthroughURL||"",defaultImagePath:i.DefaultImage||"",selectedVersion:e,thirdPartyImps:i.ThirdPartyImpressionURL?this._parseUrlValue(i.ThirdPartyImpressionURL):[],thirdPartyClks:i.ThirdPartyClickthroughURL?this._parseUrlValue(i.ThirdPartyClickthroughURL):[],versionId:i.versionId||0}).isValid&&EBG.isNumber(i.DefaultImage)&&(e.isValid=!1,i=this._adConfig.assets,t="ebMovie"+e.defaultImagePath,EBG.isDefinedNotNull(i[t].dsPath)&&(e.defaultImagePath=EBG.isInWorkshop?i[t].dsPath:EBG.combinePaths(this._adConfig.resourcePath,i[t].dsPath),e.isValid=!0)),(this._showOnlyDefaultImg?this.showDefaultImage:this._showImgAsCreative).apply(this,[e])},_readMassVersionInfo:function(e){var t,i,n,a,s,r,o,d={isValid:!1,jumpUrl:"",defaultImagePath:"",selectedVersion:"",thirdPartyImps:[],thirdPartyClks:[]};try{EBG.isDefined(e)&&null!=e&&(t=e.documentElement.attributes.getNamedItem("productClickThrough"),i=e.documentElement.attributes.getNamedItem("DefaultImage"),n=e.documentElement.attributes.getNamedItem("ThirdPartyImps"),a=e.documentElement.attributes.getNamedItem("ThirdPartyClickThrough"),s=this._adConfig.massVersioning.defaultAdVersion.indexOf("_"),(d={isValid:null!=i&&""!=i.value,jumpUrl:null!=t?t.value:"",defaultImagePath:null!=i?i.value:"",selectedVersion:-1==s?this._adConfig.massVersioning.defaultAdVersion:this._adConfig.massVersioning.defaultAdVersion.substring(0,s),thirdPartyImps:n&&n.value?this._parseUrlValue(n.value):[],thirdPartyClks:a&&a.value?this._parseUrlValue(a.value):[]}).isValid&&EBG.isNumber(d.defaultImagePath)&&(d.isValid=!1,r=this._adConfig.assets,o="ebMovie"+d.defaultImagePath,EBG.isDefinedNotNull(r[o].dsPath)&&(d.defaultImagePath=EBG.isInWorkshop?r[o].dsPath:EBG.combinePaths(this._adConfig.resourcePath,r[o].dsPath),d.isValid=!0))),(this._showOnlyDefaultImg?this.showDefaultImage:this._showImgAsCreative).apply(this,[d])}catch(e){this.showDefaultImage(d)}},_parseUrlValue:function(e){var t=[];e=e.split("");for(var i=0;i<e.length;i++)for(var n=e[i].split("|"),a=0;a<n.length;a++)t.push(n[a]);return t},_sendInitAdInformation:function(){this._adConfig.sendMetricsData&&this._dpm.send(EBG.DataProfile.INTERACTION,{ua:window.navigator.userAgent});var e={frmt:this._getTemplateNameNum(),srvmd:this._getServingModeNum(),prtcl:EBG.protocol},t=this._getBannerLocation();t&&(e.loc=t.X+"x"+t.Y),e.size=this._adConfig.width+"x"+this._adConfig.height,e.cb=this._getAdCodeBase(),this._dpm.send(EBG.DataProfile.SERVING,e)},_sendCustomFormatInformation:function(){if(this._adConfig.hasOwnProperty("CF_DebugData")){var e,t={};for(e in this._adConfig.CF_DebugData)t["cf_"+e]=this._adConfig.CF_DebugData[e];this._dpm.send(EBG.DataProfile.DEBUG,t)}},_switchAssetsAfterThrottle:function(){},_handleCreativeThrottled:function(e){var t;e.eventData&&(e.eventData.state&&e.eventData.state==EBG.ThrottleStates.RESUME?(clearTimeout(this._throttleTimeout),this._throttleState=EBG.ThrottleStates.RESUME):e.eventData.state&&e.eventData.state==EBG.ThrottleStates.POLLED&&e.dispatcher._adConfig.uid==this._adConfig.uid?(this._switchAssetsAfterThrottle(),EBG.adaptor.flash.removeThrottleDetectionSwf(this._adConfig.uid)):this.visibilityMgr&&e.eventData.id&&(this.visibilityMgr.isVisibile()?(t=(t=EBG.adaptor.getElementById(e.eventData.id))&&EBG.adaptor.getBoundingClientRect(t),this._throttleState==EBG.ThrottleStates.THROTTLE&&(!t||0<t.width&&0<t.height)?(this._switchAssetsAfterThrottle(),EBG.adaptor.flash.removeThrottleDetectionSwf(this._adConfig.uid)):this._throttleTimeout=EBG.runTimed(this,this._handleCreativeThrottled,[e],this._throttleTimeoutDuration)):this._subscribeToAdEvent(EBG.Events.EventNames.PAGE_SCROLL,this._checkIfStillThrottled),this._throttleState=EBG.ThrottleStates.THROTTLE))},_checkIfStillThrottled:function(e){e?this.visibilityMgr&&!this._throttleTimeout&&this._throttleState==EBG.ThrottleStates.THROTTLE&&this.visibilityMgr.isVisibile()&&(this._throttleTimeout=EBG.runTimed(this,this._checkIfStillThrottled,[],1e3)):(this._throttleState==EBG.ThrottleStates.THROTTLE&&this.visibilityMgr&&this.visibilityMgr.isVisibile()&&(this._switchAssetsAfterThrottle(),EBG.adaptor.flash.removeThrottleDetectionSwf(this._adConfig.uid),(e=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_SCROLL,this._checkIfStillThrottled,this)).dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd},e.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.unsubscribeFromEvent(e)),clearTimeout(this._throttleTimeout),this._throttleTimeout=null,this._throttleState==EBG.ThrottleStates.RESUME&&((e=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_SCROLL,this._checkIfStillThrottled,this)).dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd},e.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.unsubscribeFromEvent(e)))},dispatchCustomEvent:function(e,t,i,n){return(e=new EBG.Events.Event(e)).dispatcher=n,e.eventData={assetId:t},e.timing=i,EBG.eventMgr.dispatchEvent(e)},_notifyInteractionManager:function(e){var t={};(t=e&&e.eventData?e.eventData:t).elapsedTime="",EBG.intMgr.getAdDuration&&(t.elapsedTime=EBG.intMgr.getAdDuration(this._adConfig.uid)),EBG.adaptor.notifyIntMonitor(e.eventData)},onImageClick:function(e,t,i,n,a,s){try{var r,o=t?new EBG.Events.Event(EBG.Events.EventNames.DEFAULT_CLICK):new EBG.Events.Event(EBG.EBMessage.CLICKTHROUGH);o.eventData=t?{intName:EBG.Interactions.SystemInts.DEFAULT_CLICK}:{intName:EBG.Interactions.SystemInts.CLICK},EBG.isDefined(n)&&(o.eventData.clickUrl=n),EBG.isDefined(a)&&(o.eventData.clickedVersion=a),EBG.isDefined(s)&&(o.eventData.clickedVerUrl=s),o.dispatcher=EBG.ads[e],EBG.eventMgr.dispatchEvent(o),EBG.adaptor.intMonitorExist()&&((r=new EBG.Events.Event(EBG.EBMessage.NOTIFY_INTERACTION_MONITOR)).eventData={command:EBG.EBMessage.CLICKTHROUGH,args:"",objName:i,adId:EBG.Ads.Ad.Fn.getAdIdFromAdUId(e)},EBG.eventMgr.dispatchEvent(r))}catch(e){}},_unLoadHandler:function(){var e=new EBG.Events.Event(EBG.Events.EventNames.AD_UNLOAD);if(e.dispatcher=this,e.timing=EBG.Events.EventTiming.BEFORE,!EBG.eventMgr.dispatchEvent(e)){try{EBG.adaptor.removeElement(this._adConfig.placeHolderId)}catch(e){e.Message}e.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(e)}EBG.log.endGroup()}},EBG.declareClass(EBG.Ads.Ad,null),EBG.Ads.Ad.Fn={getAdIdFromAdUId:function(e){return e.split("_")[0]},getRandFromAdUId:function(e){return e.split("_")[1]},getVersionToReport:function(e){var t=e;return e&&EBG.isArray(e)&&1==e.length?t=e[0]:e&&EBG.isArray(e)?t="m":e.indexOf&&(t=-1<e.indexOf(",")?"m":-1<e.indexOf("_")?e.substr(0,e.indexOf("_")):e),t},getAdVersions:function(e){var t="";e=e.adVersions.split(",");for(var i=0;i<e.length;i++)t&&(t+=","),t+=e[i];return t},fixMVPathString:function(e,t){if(0<t){e=e.split(",");for(var i,n,a="",s="",r=0;r<e.length;r++)n=e[r],i="",EBG.isDefinedNotNull(n.match("_"))&&(i=n.substr(n.indexOf("_"))),n=parseInt(n),a+=s+(n=parseInt(n/t)+i+"/"+n),""==s&&(s=",")}return a},_handlePageResizeOrScroll:function(){}},EBG.declareNamespace("EnableVisibilityUtil"),EBG.EnableVisibilityUtil=function(){},EBG.EnableVisibilityUtil.initVisibilityManager=function(e,t){this.visibilityMgr?this.visibilityMgr.updateResourceObjId(t):this.visibilityMgr=new EBG.RichModules.VisibilityManager(e,t)},EBG.EnableVisibilityUtil.addVisibilityInteractions=function(){var e=EBG.Interactions.Categories.SYSTEM;this._addCounterInteraction(EBG.Interactions.SystemInts.VISIBILITY_RECORDABLE,e,!1,1),this._addCounterInteraction(EBG.Interactions.SystemInts.VISIBILITY_AGENCY_RECORDABLE,e,!1,1),this._addCounterInteraction(EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_RECORDABLE,e,!1,1),this._addCounterInteraction(EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER,e,!1,1),this._addCounterInteraction(EBG.Interactions.SystemInts.VISIBILITY_AGENCY,e,!1,1),this._adConfig.ffs.CFF_SendVsiabImmediately?this._addCounterInteraction(EBG.Interactions.SystemInts.VISIBILITY_IAB,e,!0,1):this._addCounterInteraction(EBG.Interactions.SystemInts.VISIBILITY_IAB,e,!1,1),this._addTimerInteraction(EBG.Interactions.SystemInts.VISIBILITY_AGENCY_DURATION,e),this._addTimerInteraction(EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_DURATION,e),this._addTimerInteraction(EBG.Interactions.SystemInts.VISIBILITY_AVG_AD_SURFACE,e),EBG.adaptor.isInApp()||this._addTimerInteraction(EBG.Interactions.SystemInts.VISIBILITY_AVG_SCREEN_SHARE,e)},EBG.EnableVisibilityUtil.addPanelVisibilityInteractions=function(){var e=EBG.Interactions.Categories.SYSTEM;this._addCounterInteraction("P"+EBG.Interactions.SystemInts.VISIBILITY_RECORDABLE,e,!1,1,!0),this._addCounterInteraction("P"+EBG.Interactions.SystemInts.VISIBILITY_AGENCY_RECORDABLE,e,!1,1,!0),this._addCounterInteraction("P"+EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_RECORDABLE,e,!1,1,!0),this._addCounterInteraction("P"+EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER,e,!1,1,!0),this._addCounterInteraction("P"+EBG.Interactions.SystemInts.VISIBILITY_AGENCY,e,!1,1,!0),this._adConfig.ffs.CFF_SendVsiabImmediately?this._addCounterInteraction("P"+EBG.Interactions.SystemInts.VISIBILITY_IAB,e,!0,1,!0):this._addCounterInteraction("P"+EBG.Interactions.SystemInts.VISIBILITY_IAB,e,!1,1,!0),this._addTimerInteraction("P"+EBG.Interactions.SystemInts.VISIBILITY_AGENCY_DURATION,e,!0),this._addTimerInteraction("P"+EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_DURATION,e,!0),this._addTimerInteraction("P"+EBG.Interactions.SystemInts.VISIBILITY_AVG_AD_SURFACE,e,!0),EBG.adaptor.isInApp()||this._addTimerInteraction("P"+EBG.Interactions.SystemInts.VISIBILITY_AVG_SCREEN_SHARE,e,!0),this._addCounterInteraction("P"+EBG.Interactions.SystemInts.AD_STACKING,e,!1,1,!0)},EBG.declareClass(EBG.EnableVisibilityUtil,null),EBG.Ads.StdBanner=function(e){EBG.callSuperConstructor(EBG.Ads.StdBanner,this,[e]),EBG.log.endGroup()},EBG.Ads.StdBanner.requiresIframeBust=!1,EBG.Ads.StdBanner.prototype={_flashResID:null,_CCs:{},_show:function(){EBG.callSuperFunction(EBG.Ads.StdBanner,this,"_show"),this._shouldCheckIfFlashBlocked()&&EBG.adaptor.flash.doFlashBlockDetection(this._adConfig.placeHolderId)},_subscribeToEvents:function(){try{EBG.callSuperFunction(EBG.Ads.StdBanner,this,"_subscribeToEvents");var e=new EBG.Events.EventSubscription(EBG.Events.EventNames.FLASH_DETECTED,this._handleFlashDetected,this);e.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(e)}catch(e){}EBG.log.endGroup()},_canShow:function(){var e=!1;return this._adConfig.flashResPath?(this._adConfig.flashVer,EBG.adaptor.flash.version,EBG.adaptor.flash.version>=this._adConfig.flashVer&&!EBG.adaptor.flash.isBlocked?e=!0:this._adConfig.hasConverter&&this._adConfig.html5supported?e=this._adConfig.useHtmlConvertor=!0:EBG.adaptor.flash.version<this._adConfig.flashVer?this._cdiReason=2:EBG.adaptor.flash.isBlocked&&(this._cdiReason=6)):this._adConfig.imageOnly=!0,e},_writeCreativeElements:function(){try{var e={resPath:this._adConfig.flashResPath,resId:this._flashResID,width:this._adConfig.width,height:this._adConfig.height,play:"true",wmode:this._adConfig.wmode||"opaque"},t=EBG.adaptor.generateElementId("StdBannerDiv",this._adConfig.uid);this._banner.divId=t;var i={tagName:EBG.Adaptors.TagNames.DIV,attributes:{id:t,dir:"ltr",style:{width:this._adConfig.width,height:this._adConfig.height}},children:this._CCs[this._flashResID].buildCreativeContainerJson(e)};void 0!==this._adConfig.display&&(i.attributes.style.display=this._adConfig.display);var n=new EBG.Events.Event(EBG.Events.EventNames.ADD_CREATIVES);if(n.dispatcher=this,n.eventData={tagsObj:i,assetId:this._flashResID,isPanel:!1,creativeType:EBG.Events.EventNames.ADD_BANNER_DEFAULT_FLASH_CREATIVE},n.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.dispatchEvent(n))return;EBG.adaptor.addInlineDOM(i,this._adConfig.placeHolderId),this._CCs[this._flashResID].checkPlaying(),n.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.dispatchEvent(n),n.timing=EBG.Events.EventTiming.AFTER,EBG.eventMgr.dispatchEvent(n)}catch(e){e.Message}EBG.log.endGroup()},_addConvertorModules:function(){EBG.Modules&&EBG.Modules.ConUtil?(this._writeCreativeElements(),this._CCs[this._flashResID]._convertor.isReady()):EBG.adaptor.loadModule("ConvertorUtil",this._adConfig,function(){this._writeCreativeElements(),this._CCs[this._flashResID]._convertor.isReady()},this)},_addCreatives:function(){this._flashResID=EBG.adaptor.generateElementId("StdBannerFlash",this._adConfig.uid),this._CCs[this._flashResID]=new EBG.FlashCC(this._adConfig),this._adConfig.useHtmlConvertor?this._addConvertorModules():this._writeCreativeElements(),EBG.log.endGroup()},_shouldCheckIfFlashBlocked:function(){var e=!1;return(EBG.adaptor.browser.isFF()||EBG.adaptor.browser.isChrome()&&EBG.adaptor.browser.getVersion()<53||EBG.adaptor.browser.isSafari())&&!EBG.adaptor.browser.isMobile()&&this._adConfig.flashResPath&&-1!=this._adConfig.flashResPath.indexOf(".swf")&&(EBG.adaptor.flash.checkedBlock||EBG.adaptor.flash.checkingBlock||(e=!0)),e},_handleFlashDetected:function(e){e&&e.eventData&&e.eventData.isBlocked&&this._switchAssetsAfterThrottle()},_switchAssetsAfterThrottle:function(){this._adConfig.hasConverter&&this._adConfig.html5supported&&(this._adConfig.useHtmlConvertor=!0),this._adConfig.useHtmlConvertor?(this._defaultImgResId&&EBG.adaptor.getElementById(this._defaultImgResId)?EBG.adaptor.removeElement(this._defaultImgResId):this._preloadImgResId&&EBG.adaptor.getElementById(this._preloadImgResId)?EBG.adaptor.removeElement(this._preloadImgResId):this._banner&&this._banner.divId&&EBG.adaptor.getElementById(this._banner.divId)&&EBG.adaptor.removeElement(this._banner.divId),this._addCreatives()):(this._cdiReason=5,this.showDefaultImage())}},EBG.declareClass(EBG.Ads.StdBanner,EBG.Ads.Ad),EBG.Ads.StdBannerEx=function(e){EBG.callSuperConstructor(EBG.Ads.StdBannerEx,this,[e]),EBG.log.endGroup()},EBG.Ads.StdBannerEx.requiresIframeBust=!1,EBG.Ads.StdBannerEx.prototype={visibilityMgr:null,addCreativesHandler:function(e){this._adConfig.visibility.mode!=EBG.VisibilityMode.BASIC_MODE&&this._adConfig.visibility.mode!=EBG.VisibilityMode.ENHANCED_MODE||!EBG.EnableVisibilityUtil||EBG.EnableVisibilityUtil.initVisibilityManager.apply(this,[this._adConfig,e.eventData.assetId]),this._adStackingDetector||(this._adStackingDetector=new EBG.RichModules.AdStackingDetector(this._adConfig)),this._adStackingDetector.addElementId(e.eventData.assetId,!0)},_subscribeToEvents:function(){var e;EBG.callSuperFunction(EBG.Ads.StdBannerEx,this,"_subscribeToEvents"),this._subscribeToAdEvent(EBG.Events.EventNames.ADD_CREATIVES,this.addCreativesHandler,EBG.Events.EventTiming.ONTIME),this._subscribeToAdEvent(EBG.Events.EventNames.ADD_BANNER_DEFAULT_IMAGE_CREATIVE,this.addCreativesHandler,EBG.Events.EventTiming.ONTIME),this._adConfig.adParamsEnabled&&((e=new EBG.Events.EventSubscription(EBG.Events.EventNames.ELEMENT_LOADED,function(e){e.eventData.adUId==this._adConfig.uid&&((e=new EBG.Events.Event(EBG.Events.EventNames.CREATIVE_CONTAINER_READY)).dispatcher=this,e.eventData=this._flashResID,EBG.eventMgr.dispatchEvent(e))},this)).timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(e))},_addSystemInteractions:function(){EBG.callSuperFunction(EBG.Ads.StdBannerEx,this,"_addSystemInteractions"),EBG.EnableVisibilityUtil&&EBG.EnableVisibilityUtil.addVisibilityInteractions.apply(this)},_addTimerInteraction:function(e,t){e=new EBG.Interactions.TimerInteractionData(e,t,this._adConfig.uid),e=new EBG.Interactions.TimerInteraction(e),EBG.intMgr.addInteraction(e),EBG.log.endGroup()},_addCounterInteraction:function(e,t,i,n,a,s,r){a=EBG.isDefinedNotNull(s)?s:e,a=this._adConfig.interactions[a];var o=new EBG.Interactions.CounterInteractionData(e,EBG.Interactions.Categories.SYSTEM,this._adConfig.uid);a?EBG.callSuperFunction(EBG.Ads.StdBannerEx,this,"_addCounterInteraction",[e,t,i]):(o.initiationType=EBG.Interactions.InitiationTypes.AUTO,o.numLeftToReport=o.numToReport=n||o.numLeftToReport,o.reportImmediately=!!i,o.useInteractionsStrPipe=!!r,e=new EBG.Interactions.CounterInteraction(o),EBG.intMgr.addInteraction(e,s)),EBG.log.endGroup()},_getBannerLocation:function(){for(var e,t=["_defaultResId","_defaultImgResId","_flashResID"],i=0;i<t.length;i++)if(this[t[i]]){e=EBG.adaptor.getPositioningById(this[t[i]],!0,this._adConfig.actualServingMode);break}return EBG.callSuperFunction(EBG.Ads.StdBannerEx,this,"_getBannerLocation",[e])},_getAdCodeBase:function(){return val=1,EBG.callSuperFunction(EBG.Ads.StdBannerEx,this,"_getAdCodeBase",[val])}},EBG.declareClass(EBG.Ads.StdBannerEx,EBG.Ads.StdBanner),EBG.declareNamespace("CreativeContainer"),EBG.CreativeContainer=function(e){this._adConfig=e,EBG.log.endGroup()},EBG.declareClass(EBG.CreativeContainer,null),EBG.declareNamespace("FlashCC"),EBG.FlashCC=function(e){EBG.callSuperConstructor(EBG.FlashCC,this,[e]),this.fs={},this.isPollingForThrottle=!1,this._addSupportedFSCommands(),EBG.log.endGroup()},EBG.FlashCC.prototype={_convertor:null,_createIntMonitorObj:function(e,t){return this._convertor&&EBG.isObj(t)?this._convertor._createIntMonitorObj(e,t):{command:e,args:t,objName:this._flashResID,adId:this._adConfig.adId}},_buildAdditionalResStr:function(){var e,t="",i=this._adConfig.assets;for(e in i)try{var n=i[e],a=EBG.isInWorkshop?n.dsPath:EBG.combinePaths(this._adConfig.resourcePath,n.dsPath),t=EBG.format("{0}{1}{2}={3}",t,t?"&":"",e,a)}catch(e){}return t},_getSmartVersioningFlashVars:function(){var e="",t=void 0!==this._adConfig.isSVSVP&&this._adConfig.isSVSVP,i=this._adConfig.massVersioning.adVersions&&this._adConfig.sv2DisplayMap;return i&&(e=EBG.Ads.Ad.Fn.getAdVersions(this._adConfig.massVersioning),e=0<this._adConfig.massVersioning.massVersionFolderDivider?EBG.Ads.Ad.Fn.fixMVPathString(e,this._adConfig.massVersioning.massVersionFolderDivider):e,e=EBG.format("&ebAdVersions={0}&ebAdMap={1}&ebResPath={2}&ebAdSVBasePath={3}",e,this._adConfig.sv2DisplayMap,EBG.isInWorkshop?"":this._adConfig.resourcePath,this._adConfig.massVersioning.adBasePath)),!this._adConfig.svXML||!t&&i||(t=EBG.isGlobalDef("ebAdXmlPath")&&ebAdXmlPath?ebAdXmlPath:EBG.isInWorkshop?this._adConfig.svXML:EBG.combinePaths(this._adConfig.resourcePath,this._adConfig.svXML),e+=EBG.format("&ebAdXML={0}",t)),e},_getFlashParams:function(){var e=EBG.adaptor.getHostName(),t=EBG.intMgr.getClickTag(this._adConfig.uid),i=EBG.intMgr.getClickTarget(this._adConfig.uid),n=EBG.adaptor.browser.isIE()?"":this._flashResID+"_DoFSCommand",a=EBG.format("ebDomain={0}&ebAdID={1}&clickTag={2}&clickTAG={2}&clicktag={2}&ebFSCmdHandler={3}&TemplateName={9}&clickTARGET={4}&ebFlashID={5}{6}&{7}{8}",e,this._adConfig.adId,escape(t),n,i,this._flashResID,this._getSmartVersioningFlashVars(),this._buildAdditionalResStr(),this._getAdditionalClickTagParams(),this._adConfig.templateName);if(EBG.adaptor.browser.isChrome()&&21<=EBG.adaptor.browser.getVersion()&&!EBG.adaptor.browser.isMac()&&(a=EBG.format("ebDomain={0}&ebAdID={1}&clickTag={2}&clickTAG={2}&clicktag={2}&TemplateName={9}&clickTARGET={4}&ebFlashID={5}{6}&{7}{8}",e,this._adConfig.adId,escape(t),n,i,this._flashResID,this._getSmartVersioningFlashVars(),this._buildAdditionalResStr(),this._getAdditionalClickTagParams(),this._adConfig.templateName)),this._adConfig.additionalFlashVars)for(var s in this._adConfig.additionalFlashVars)this._adConfig.additionalFlashVars.hasOwnProperty(s)&&s&&(a+=EBG.format("&{0}={1}",s.toLowerCase(),this._adConfig.additionalFlashVars[s]));return EBG.log.endGroup(),a},_getAdditionalClickTagParams:function(){var e,t,i,n="";for(e in this._adConfig.interactions)try{!/clicktag\d+/i.test(e)||""!=(i=(t=EBG.intMgr.adsData[this._adConfig.uid][EBG.Interactions.InteractionTypes.COUNTER][e.toLowerCase()])&&""!=t.interactionData.counterJumpUrlData.jumpUrl?t.getClickTagUrl(t.interactionData.counterJumpUrlData.jumpUrl):"")&&(n+=EBG.format("&{0}={1}",e,escape(i)))}catch(e){}return EBG.log.endGroup(),n},_isPowerSaveExist:function(){return EBG.adaptor.browser.isSafari()&&6<=EBG.adaptor.browser.getVersion()&&EBG.adaptor.browser.isMac()},_handleThrottle:function(e){e=e&&e[0].state?e[0].state:"polled";var t=new EBG.Events.Event(EBG.Events.EventNames.THROTTLED);t.dispatcher=this,t.eventData={state:e},EBG.eventMgr.dispatchEvent(t)},_detectThrottling:function(e){this._flashResID;var t,i=EBG.adaptor.getElementById(this._flashResID);EBG.adaptor.browser.isChrome()&&i&&i.title&&"Adobe Flash Player"==i.title?this._handleThrottle():this._isPowerSaveExist()&&i&&"function"!=typeof i.Play?(t=EBG.adaptor.browser.isFF()||EBG.adaptor.isPageVisible(),e?this._handleThrottle():i.tagName==EBG.Adaptors.TagNames.OBJECT&&EBG.runTimed(this,this._detectThrottling,[t],1e3)):i&&this.isPollingForThrottle&&EBG.runTimed(this,this._detectThrottling,[],1e3)},detectThrottling:function(){this._convertor||(this._flashResID,this.isPollingForThrottle||(this.isPollingForThrottle=!0,EBG.runTimed(this,this._detectThrottling,[],1e3)))},stopPollingForThrottle:function(e){this.isPollingForThrottle=!1},buildCreativeContainerJson:function(e){for(var t=["transparent","opaque","window"],i=0;i<3;i++)t[t[i]]=t[i];this._flashResID=e.resId,this.isIMPanel&&0<e.unique&&(e.resPath+="?"+Math.random()),this._src=e.resPath,this._weight=e.weight;var n=EBG.format("EBG.ads['{0}']._CCs['{1}']",this._adConfig.uid,this._flashResID),a=EBG.format("function {0}_DoFSCommand(command,args)",this._flashResID);a+=EBG.format("{ try{ if(!args||args=='null')args='';command = command.replace(/FSCommand:/ig,''); return "+(this.isIMPanel?"document.parentWindow.parent.":"")+"{0}._handleMessage(command,args,'{1}');}catch(e){if(window.mmFSExceptionAlert)mmFSExceptionAlert('Command: '+command+'\\nargs: '+args.toString()+'\\n\\nexception in DoFS func:\\n'+e.message)}}",n,this._flashResID),i={tagName:EBG.Adaptors.TagNames.SCRIPT,text:a+"function ebIsFlashExtInterfaceExist(){return true;}"},a=EBG.format("try{{0}_DoFSCommand(command,args);}catch(e){}",this._flashResID);var a={tagName:EBG.Adaptors.TagNames.SCRIPT,attributes:{for:this._flashResID,event:"FSCommand(command,args)"},text:a},s=-1!=(s=this.getResPath(e.resPath)).toLowerCase().indexOf("http://")||-1!=s.toLowerCase().indexOf("https://")||EBG.isInWorkshop&&-1!=s.toLowerCase().indexOf("file://")?s:EBG.combinePaths(this._adConfig.resourcePath,s),r=this._getFlashParams();if(this._adConfig.useHtmlConvertor&&EBG.Modules.ConUtil)t=EBG.EBMessage.REQ_INIT.toLowerCase(),this.fs[t]={mapEvent:EBG.EBMessage.REQ_INIT},this._convertor=new EBG.Modules.ConUtil(this._adConfig),t=this._convertor.buildIframeObj(r,this._flashResID,e,n);else{if(t={tagName:EBG.Adaptors.TagNames.OBJECT,attributes:{id:this._flashResID,dir:"ltr",name:this._flashResID,style:{textAlign:"left",width:EBG.format("{0}px",e.width),height:EBG.format("{0}px",e.height)},codebase:EBG.format("{0}download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#",EBG.protocol),version:EBG.format("{0},0,0,0",this._getFlashVersion()),title:this._adConfig.title||""},params:{play:e.play,wmode:this.isIMPanel?"opaque":t[e.wmode],menu:"false",flashVars:this._getFlashParams(),allowScriptAccess:"always",allowFullScreen:"true"}},EBG.adaptor.browser.isChrome()&&(t.attributes.style.width=t.attributes.style.height="0px",t.meta={isChromePowerSaver:!0,origWidth:EBG.px(e.width),origHeight:EBG.px(e.height)}),this._isSupportShockwave()?(t.attributes.type="application/x-shockwave-flash",t.attributes.data=s):(t.attributes.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",t.params.movie=s),0<e.unique)return[t,a];if(this._shouldCheckForThrottling(e))return e=this._buildThrottleDetectJson(t,e),n=this._buildThrottleDetectScriptJson(),EBG.ads[this._adConfig.uid].checkingThrottle=!0,[t,i,a,e,n]}return[t,i,a]},_buildThrottleDetectJson:function(e,t){return(e=EBG.cloneObj(e)).attributes.id=e.attributes.name="ebFlashThrottleDetection_"+this._adConfig.uid,e.attributes.style["z-index"]="-1",e.attributes.style.position="relative",e.attributes.style["margin-left"]=EBG.px(-t.width),e.attributes.version="11,2,0,0",e.attributes.title="",e.params.wmode="transparent",e.params.flashVars="id="+e.attributes.id+"&adUId="+this._adConfig.uid+"&elemId="+this._flashResID,e.attributes.data?e.attributes.data=ebBigS+"/Res/Assets/Pixel"+EBG.flashPixelVer+"/ebThrottleDetect.swf":e.params.movie=ebBigS+"/Res/Assets/Pixel"+EBG.flashPixelVer+"/ebThrottleDetect.swf",e},_buildThrottleDetectScriptJson:function(){var e=EBG.format("function {0}(args)","DoFS_ebFlashThrottleDetection_"+this._adConfig.uid);return e+=EBG.format("{ try{ if(!args||args=='null')args=''; return {0}(args);}catch(e){if(window.mmFSExceptionAlert)mmFSExceptionAlert('Command: '+command+'\\nargs: '+args.toString()+'\\n\\nexception in DoFS func:\\n'+e.message)}}","EBG.adaptor.flash._handleThrottleEvent"),{tagName:EBG.Adaptors.TagNames.SCRIPT,text:e}},_isSupportShockwave:function(){var e=!0,t=(t=EBG.adaptor.browser.getDocumentMode())||5;return e=EBG.adaptor.browser.isIE()&&t<11?!1:e},isPlaying:function(){if(!this._flashResID)return!1;var e=EBG.adaptor.getElementById(this._flashResID);if(!e)return!1;if(this._convertor)return this._convertor.getIframeLoaded();try{if(void 0===e.PercentLoaded&&void 0===e.TGetProperty||void 0!==e.PercentLoaded&&100==e.PercentLoaded())return!0;if(void 0!==e.TGetProperty)try{return 1<e.TGetProperty("/",4)}catch(e){}}catch(e){return!0}return!1},checkPlaying:function(){var e;this.isPlaying()?((e=new EBG.Events.Event(EBG.Events.EventNames.ELEMENT_LOADED)).dispatcher=this,e.eventData={DOMEvent:null,elementId:this._flashResID,adUId:this._adConfig.uid},e.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(e)):EBG.runTimed(this,this.checkPlaying,[],50)},getResPath:function(e){return e},_getFlashVersion:function(e){return this._adConfig.flashVer},_handleMessage:function(a,b,c){a=a.replace(/FSCommand:/gi,"");var d=a=a.toLowerCase(),e=b;a==EBG.EBMessage.CLICKTHROUGH&&b&&b.indexOf&&0==b.indexOf("SV2:")&&-1!=b.indexOf(String.fromCharCode(127))&&(e=b.substring(4),d=a+"sv2");var f=this.fs[d];if(f){var g=f.mapEvent||d.toLowerCase(),g=new EBG.Events.Event(g);g.dispatcher=this,g.flashResId=c,c=",";var h=!1;switch(d){case EBG.EBMessage.CLICKTHROUGH:g.eventData={};break;case EBG.EBMessage.CLICKTHROUGH+"sv2":case EBG.FS.EB_SET_JS_VAR:c="";break;case EBG.EBMessage.VERSION_TRACKING_IMPRESSION:h=!0,g.eventData={},g.eventData[f.args[0]]=this._formatUrls(b)}if(f&&f.args&&!h&&(g.eventData={adUId:this._adConfig.uid},0<b.length))for(d=e.split(c),e=0;e<f.args.length;e++)c=f.args[e],h="",e<d.length&&(h='"'==d[e].charAt(0)||"'"==d[e].charAt(0)||"false"==d[e]||"true"==d[e]?eval(d[e]):d[e]),g.eventData[c]=h;if(this._handleIntMonitor(a,b),f){if(f.command)return b=[g.eventData],f.command.call(this,b);f.combinedCommand&&(b=[g.eventData],f.combinedCommand.call(this,b)),EBG.isObj(b)&&this._convertor&&(g.eventData=b,g.eventData.adUId=this._adConfig.uid),EBG.eventMgr.dispatchEvent(g)}}EBG.log.endGroup()},_formatUrls:function(e){var t=[];e=e.split("");for(var i=0;i<e.length;i++)for(var n=e[i].split("|"),a=0;a<n.length;a++)t.push(n[a]);return t},_handleIntMonitor:function(e,t){var i;EBG.adaptor.intMonitorExist()&&((i=new EBG.Events.Event(EBG.EBMessage.NOTIFY_INTERACTION_MONITOR)).eventData=this._createIntMonitorObj(e,t),EBG.eventMgr.dispatchEvent(i))},_addSupportedFSCommands:function(){this.fs[EBG.FS.EB_CLICKTHROUGH]={mapEvent:EBG.EBMessage.CLICKTHROUGH},this.fs[EBG.FS.EB_CLICKTHROUGH+"sv2"]={mapEvent:EBG.EBMessage.CLICKTHROUGH,args:["clickUrl","clickedVersion","clickedVerUrl"]},this.fs[EBG.FS.EB_VERSION_TRACKING_IMPRESSION]={mapEvent:EBG.EBMessage.VERSION_TRACKING_IMPRESSION,args:["impTrackingUrls"]},this.fs[EBG.FS.EB_CREATIVE_EVENT_SUBSCRIPTION]={mapEvent:!1,args:["eventHandler","interAd"],command:this._addCreativeEventSubscription}},_addCreativeEventSubscription:function(e){var t=e[0].eventHandler.split(String.fromCharCode(127));t[0],e[0].interAd;var i=new EBG.Events.EventSubscription(t[0],function(e){this.call("ebCallHandlerWithObj",t[0],e.eventData)},this);e[0].interAd||(i.dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd}),EBG.eventMgr.subscribeToEvent(i)},_shouldCheckForThrottling:function(e){var t=parseInt(e.height);0==(e=parseInt(e.width))&&0==t&&(t=this._adConfig.height,e=this._adConfig.width);var i=!0;return(EBG.adaptor.flash.version<11||!this._adConfig.visibility||!this._adConfig.visibility.mode||this._adConfig.visibility.mode==EBG.VisibilityMode.DEFAULT_MODE||EBG.ads&&EBG.ads[this._adConfig.uid]&&EBG.ads[this._adConfig.uid].checkingThrottle||this._flashResID==EBG.ads[this._adConfig.uid]._defaultResId&&EBG.ads[this._adConfig.uid]._gotRich)&&(i=!1),i=!EBG.adaptor.browser.isChrome()||e<5&&t<5||398<e&&298<t?!1:i}},EBG.FlashCC.FlashProperty={XPOSITION:0,YPOSITION:1,XSCALE:2,YSCALE:3,CURRENTFRAME:4,TOTALFRAMES:5,ALPHA:6,VISIBILITY:7,WIDTH:8,HEIGHT:9,ROTATION:10,TARGET:11,FRAMESLOADED:12,NAME:13,DROPTARGET:14,URL:15},EBG.declareClass(EBG.FlashCC,EBG.CreativeContainer);try{ebO.extensionHooks.splice(0,0,function(e,i){var t;(i.ffs.CFF_ForceGET||i.ffs.CFF_URLThreshold||81==i.pluId)&&((t=new EBG.Events.EventSubscription(EBG.Events.EventNames.CREATE_ADAPTOR,function(e){e.eventData.currentClass.prototype.getRequestMethod=function(e){if(EBG.adaptor.browser.isMobile()&&i.ffs.CFF_ForceGET)return"GET";var t=EBG.adaptor.browser.isMobile()&&i.ffs.CFF_URLThreshold?4e3:2e3;return!(this.browser.isIE()&&6==this.browser.getVersion()||this.isInApp())&&e.length>t?"POST":"GET"}})).timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.subscribeToEvent(t))})}catch(a){a.description,ebO.extensionHooks=tempExtensionHook}EBG.declareNamespace("InAppImpressionManager"),EBG.InAppImpressionManager=function(e){this.adConfig=e.adConfig,this._dpm=EBG.dataPipeMgr.getPipe(e.sid)},EBG.InAppImpressionManager.prototype={init:function(){var e=new EBG.Events.EventSubscription(EBG.EBMessage.SDK_BRIDGE_LOADED,this._loadEventCallBack,this);e.timing=EBG.Events.EventTiming.AFTER,EBG.eventMgr.subscribeToEvent(e),(e=new EBG.Events.EventSubscription(EBG.EBMessage.MRAID_LOADED,this._loadEventCallBack,this)).timing=EBG.Events.EventTiming.AFTER,EBG.eventMgr.subscribeToEvent(e)},_loadEventCallBack:function(e){e.name===EBG.EBMessage.SDK_BRIDGE_LOADED&&(this.sdkState=e.eventData.loaded),e.name===EBG.EBMessage.MRAID_LOADED&&(this.mraidState=e.eventData.loaded),void 0!==this.sdkState&&void 0!==this.mraidState&&(this.sdkState?this.startSession():this._handleDispatchEvent({supportsSDK:!1}))},startSession:function(){var e,t,i;this.sessionStarted||(e=window.ebSDKBridge,this.key=this.adConfig.rnd,e?(t=this._handleSDKMessage.bind(this),i={sessionKey:this.key,mraidStatus:this.mraidState?"supported":"unsupported"},e.addEventListener(EBG.SDK_BRIDGE_EVENTS.SESSION_START,t),e.addEventListener(EBG.SDK_BRIDGE_EVENTS.GEOMETRY_CHANGE,t),e.startSession(i),this.sessionStarted=!0):this._handleDispatchEvent({supportsSDK:!1}))},_handleSDKMessage:function(e){var t;e.sessionKey===this.key&&(this.supportsSDK=this.supportsSDK||e.data.supportsSDK,void 0!==this.supportsSDK)&&(t={supportsSDK:this.supportsSDK},e.data.trigger&&(t.sdkTrigger=e.data.trigger),e.data.isViewable&&(t.isViewable=e.data.isViewable),this._handleDispatchEvent(t),this._handleDebugData(e))},_handleDispatchEvent:function(e){var t=new EBG.Events.Event(EBG.Events.EventNames.INAPP_IMPRESSION);t.dispatcherFilters={ebRand:this.adConfig.rnd},t.timing=EBG.Events.EventTiming.ONTIME,t.eventData=e||{},EBG.eventMgr.dispatchEvent(t)},_handleDebugData:function(e){e.type==EBG.SDK_BRIDGE_EVENTS.SESSION_START&&this._dpm.send(EBG.DataProfile.DEBUG,{sdk_mraidSupport:~~e.data.mraidSupport,sdk_omidSupport:~~e.data.omidSupport,sdk_purpose:this.adConfig.inAppSettings&&this.adConfig.inAppSettings.sdkPurpose})}},EBG.declareClass(EBG.InAppImpressionManager,null),EBG.declareNamespace("Initializer"),EBG.Initializer={initialize:function(){var t=null;try{void 0!==a&&a||((t=EBG.Initializer._getCurrentServerResponse(t)).ffs.CFF_DecodeConfig&&EBG.Initializer._decodeConfiguration(t),EBG.Initializer._initGlobals(t),EBG.Initializer._callExtensionHooks(t),EBG.Initializer._initAdaptor(t),EBG.Initializer._initManagers(t),EBG.Initializer._initDisplayAd(t),EBG.adaptor&&EBG.adaptor.headlessTests&&"function"==typeof EBG.adaptor.headlessTests?EBG.adaptor.headlessTests(t.sid,t.adConfig.actualServingMode):this._dpm&&this._dpm.sendNow(EBG.DataProfile.DEBUG,{invalid_headlessTests:"1"}))}catch(e){var i,n,a="initialize",s="none";e.stack&&(5==(i=e.stack.match(/((.*)@|at (.*) ).*:(\d+:\d+)/)).length?(a=i[2]||i[3],s=i[4]):a=e.stack.replace(/\n/," ").substr(0,100)),EBG.DataPipeManager&&(n=new EBG.DataPipeManager(t.adConfig.handleStartTime||null).getPipe(t.sid)),(i=EBG.protocol+t.lmu+"/lm/evt")&&!n.isBucketExists("evt")&&n.createBucket("evt",["general","platform","serving","error"],i),n.send(EBG.DataProfile.ERROR,{errmsg:e.message,errfunc:a,errpos:s,errstack:e.stack.replace(/\(.*\/|(ccfix)/g,"(").replace(/\n(\s)*/g," || ").substr(0,1e3)})}return t},_initManagers:function(e){var t=new EBG.Events.Event(EBG.Events.EventNames.INIT_MANAGERS);t.eventData={"_adConfig.rnd":e.rnd},t.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.dispatchEvent(t),EBG.Initializer._initInteractionManager(e),EBG.Initializer._initAnimationManager(e),EBG.Initializer._initPositioningHelper(),EBG.Initializer._initGeometryHelper(),EBG.Initializer._initElementWatcher(),t.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(t)},_initDisplayAd:function(t){if(EBG.Initializer._updateAdConfig(t),EBG.Initializer._shouldInitAd(t)){if(this._initDataPipeManager(t),this._sendInitialDataPipeData(t),EBG.isDefined(EBG.adaptor.getDisplayWin().EBG))try{EBGInfra.mergeObj(EBG,EBG.adaptor.getDisplayWin().EBG,!1)}catch(e){EBG.adaptor.getDisplayWin().EBG=EBG}else EBG.adaptor.getDisplayWin().EBG=EBG;t.adConfig.customJSVars&&t.adConfig.customJSVars.mdProgFormatID&&t.adConfig.customJSVars.mdProgEnable||t.adConfig.singleTagProgrammatic?EBG.adaptor.loadModule("ProgrammaticSettingsMgr",t.adConfig,function(e){new(e||window).EBG.Modules.ProgrammaticSettingsMgr(t.adConfig).getSettings(function(){EBG.Initializer._initAd(t)},this)},this):EBG.Initializer._initAd(t)}},_shouldInitAd:function(e){return e.innerIframe||0==e.ifrm||-1==e.ifrm&&EBG.adaptor.serving&&EBG.adaptor.serving.servingMode!=EBG.Adaptors.ServingMode.IFRAME},_getCurrentServerResponse:function(){var e=0,t=EBG.getBigScript();if((t=t&&t.getAttribute("c"))&&window.szmk)var i=window.szmk["c"+t];else for(;e<ebOArr.length;){if((i=ebOArr[e])&&!i.csc&&this._getAdClass(i)){ebOArr.splice(e,1);break}e++}return i},_initGlobals:function(e){var t=navigator.userAgent.toLowerCase(),i=e.adConfig,n=e.bigs||ebBigS;i.handleStartTime=+new Date,EBG.isOfflineDemo=!!window.gEbfOfflineDemo,"/"==e.resPath.charAt(e.resPath.length-1)&&"/"==e.resPath.charAt(e.resPath.length-2)&&(e.resPath=e.resPath.substring(0,e.resPath.length-1)),EBG.resourcePath=e.resPath,i.rnd=e.rnd,i.uid=EBG.format("{0}_{1}",i.adId,i.rnd),i.ffs=e.ffs,i.resourcePath=e.resPath,i.modulesDir=unescape(n)+"Modules"+e.modv+"/",/\/\/./.test(n)?i.bigScriptDomain=n.split("/")[2]:i.bigScriptDomain=n.split("/")[0],i.ffs.CFF_EBPrefix&&(i.bigScriptPrefix=n.substring(n.indexOf(i.bigScriptDomain)+i.bigScriptDomain.length+1,n.indexOf("BurstingCachedScripts"))),EBG.isNumber(e.gdpr)&&(i.gdpr=e.gdpr),/^(\{|\${).*/g.test(e.gdprconsent)||(i.gdprconsent=e.gdprconsent),EBG.sms=i.sms=e.sms||"",EBG.fcsVirtualPath=e.fvp||"",EBG.pluId=e.pi,EBG.dataCapture=EBG.bs=e.bs,EBG.protocol=ebPtcl,EBG.reportPageVer=e.rpv,EBG.html5Ver=e.html5v,EBG.flashPixelVer=e.vfp,EBG.isMSNMessenger=(-1<t.indexOf("msn messenger")||-1<t.indexOf("windows live messenger"))&&window==parent,EBG.isIMBanner=window.gfEbExpBanerIM||window.gfEbExpBannerIM,EBG.isTestMode=!!e.tm,EBG.isPreview=e.pr,EBG.isInWorkshop=window.gEbFlyLocal,void 0!==e.d&&EBG.log.setLevel(e.d),EBG.iframeLocation=e.ifl||window.gstrEbIframeLocation,EBG.minZIndex=e.z||window.gnEbMinZIndex||1e4,EBG.eyeDivRefElement=window.gEbEyeDivRefElement,(e.adConfig&&e.adConfig.isInstream||e.ffs&&e.ffs.CFF_DisableUiVz)&&(e.adConfig.UiVz=!1),EBG.eventMgr=EBG.eventMgr||new EBG.Events.EventManager,(t=EBG.Adaptors.StdWebAdaptor._getTopAccessibleWindow(!1)).ebAds=t.ebAds||{},EBG.ads=t.ebAds,EBG.serverResponses=EBG.serverResponses||{},(t=i.adHtmlPath)&&e.h5mi&&(i.adKitData={paths:{cachedScript:n,nonCachedScript:ebPtcl+e.sms,folderRoot:e.resPath+t.substring(0,t.lastIndexOf("/")+1)},version:e.h5mi.adkitversion})},_initServingMode:function(e){var t=this._getAdClass(e),i=e.adConfig;e.requiresIframeBust=t.requiresIframeBust;var n=EBG.adaptor.serving?EBG.adaptor.serving.detectServingMode(!0):null;if(EBG.adaptor.isSafeFrame())e.ifrm=0,i.UiVz=!1;else if(t.requiresIframeBust)e.innerIframe&&(e.ifrm=EBG.Adaptors.ServingMode.INNER_IFRAME),e.ifrm&&!e.soi||(e.ifrm=0),EBG.adaptor.initServingMode(e.ifrm,!1,n),EBG.adaptor.inPlacementIframe()&&((t=new EBG.Events.EventSubscription(EBG.Events.EventNames.AIE_LOADED,this._handleAieLoad,this)).dispatcherFilters={"_adConfig.rnd":e.rnd},t.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.subscribeToEvent(t),EBG.adaptor.serving.handleAieServing(e));else if(e.ifrm=0,t!=EBG.Ads.StdBanner&&t!=EBG.Ads.StdBannerHtml5){if(EBG.adaptor.initServingMode(e.ifrm,!t.requiresIframeBust,n),n==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME){i.UiVz=!1;try{document.close()}catch(e){}}n==EBG.Adaptors.ServingMode.SCRIPT&&(i.UiVz=!1)}else i.UiVz=!1},_handleAieLoad:function(e){e.eventData.loadDefault&&e.eventData.currentResponse.tn!=EBG.adTypes.VisibilityAd&&(EBG.Initializer._initManagers(e.eventData.currentResponse),EBG.Initializer._initDisplayAd(e.eventData.currentResponse))},_callExtensionHooks:function(e){if(e.extensionHooks)for(;0!==e.extensionHooks.length;)e.extensionHooks.pop().apply(null,[e.adConfig,e])},getRichestAdaptor:function(){return EBG.Adaptors.WebAdaptor||EBG.Adaptors.StdWebAdaptor},getRichestInteractionManager:function(){return EBG.Interactions.InteractionManager||EBG.Interactions.StdInteractionManager},_initAdaptor:function(t){var e=this.getRichestAdaptor(),i=new EBG.Events.Event(EBG.Events.EventNames.CREATE_ADAPTOR);i.eventData={currentClass:e},i.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.dispatchEvent(i),t.ffs.CFF_assignNewAdapter?(e=function(){var e=new i.eventData.currentClass;return e.initInnerModules(t.plt,t.bt,t.bv,t.dt,t.bc,t.bi),e},EBG.adaptor?EBG.adaptor.constructor.toString()!==i.eventData.currentClass.toString()&&(e=e(),EBG.adaptor.copy(e),EBG.adaptor=e):(e=e(),EBG.adaptor=e),i.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(i)):(EBG.adaptor&&EBG.adaptor.constructor.toString()===i.eventData.currentClass.toString()||(e=new i.eventData.currentClass,EBG.adaptor=e),i.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(i),EBG.adaptor.initInnerModules(t.plt,t.bt,t.bv,t.dt,t.bc,t.bi)),this._initServingMode(t),EBG.adaptor.registerSpecialBrowserEvents(),EBG.eventMgr.attachToAdaptor(),this._handleInAppSdks(t,function(){this._dispatchAdaptorReady()},this),e=new EBG.Events.Event(EBG.Events.EventNames.ADAPTOR_MODULES_READY),EBG.eventMgr.dispatchEvent(e),EBG.log.endGroup()},_handleInAppSdks:function(a,s,r){var o={},d=null,E=this,e=a.adConfig.handleStartTime||null,t=a.bigs+"inapp/ia_0_0_1/";EBG.DataPipeManager&&(EBG.dataPipeMgr=new EBG.DataPipeManager(e),E._dpm=EBG.dataPipeMgr.getPipe(a.sid)),loadInAppFlagSettings=function(e,t){var i=e.CFF_InApp_BridgeAdv,n=!!e["CFF_InApp_BridgeAdvOn_"+t],a=!!e["CFF_InApp_BridgeAdvOff_"+t],s=e.CFF_InApp_LogAdv,r=!!e["CFF_InApp_LogAdvOn_"+t],o=!!e["CFF_InApp_LogAdvOff_"+t],d=e.CFF_InApp_ReportAdv,E=!!e["CFF_InApp_ReportAdvOn_"+t];return t=!!e["CFF_InApp_ReportAdvOff_"+t],d=!!(d&&!t||!d&&E),E=!(!e.CFF_InApp_ReportSite||!d),{allowBridge:!(!e.CFF_InApp_BridgeSite||!(i&&!a||!i&&n)),reportSiteSupported:~~e.CFF_InApp_ReportSite,reportSupportedAdvertiser:~~d,allowLogging:!(!e.CFF_InApp_LogSite||!(s&&!o||!s&&r)),allowInappReporting:E,onRender:e.CFF_InAppOnRender,sdkPurpose:E?1:2}};var l=a.adConfig.inAppSettings=loadInAppFlagSettings(a.adConfig.ffs,a.advid);l||(l=a.adConfig.inAppSettings={sdkPurpose:2},E.inAppV2Failure={msg:"inAppSettingsFailure"});var c=function(){E._dpm&&E._dpm.send(EBG.DataProfile.SERVING,{mraidv:window.mraid?mraid.getVersion():"unknown"}),d&&EBG.clearInterval(d),a.adConfig.openWindow=!1;var e,t=EBG.adaptor.getElementById(a.phid);t&&(t.style.visibility="hidden",e=EBG.runTimed(this,function(){t.style.visibility="visible"},[],400));var i=new EBG.Events.EventSubscription(EBG.Events.EventNames.SHOW_AD,function(e){EBG.runTimed(this,function(){e.dispatcher._banner&&e.dispatcher._banner.divId&&(EBG.adaptor.getElementById(e.dispatcher._banner.divId).style.left=EBG.px(0))},[],0)});i.timing=EBG.Events.EventTiming.AFTER,EBG.eventMgr.subscribeToEvent(i),EBG.adaptor.loadModule("MRAIDUtil",a.adConfig,function(){EBG.clearInterval(e),EBG.ads[a.adConfig.uid].MRAIDUtil=new EBG.MRAIDUtil(a.adConfig,s,r)},E)},i=function(e,t){var i=document.createElement("script");i.src=e,i.onload=t,i.onerror=t,EBG.getBigScript().parentElement.appendChild(i),setTimeout(function(){t({type:"timeout"})},1e3)},e=function(){l.sdkBridgeEnabled=!0;function e(e){var t,i;E.loadedFiles.sdkBridge||(t=+new Date,t-=n,E.loadedFiles.sdkBridge=e.type,i=!("load"!==e.type&&"present"!==e.type),l.sdkBridgeLoaded=i,E._dispatchSDKEvent({eventName:EBG.EBMessage.SDK_BRIDGE_LOADED,loaded:i,reason:e.type}),E._dpm.send(EBG.DataProfile.DEBUG,{sdk_bridgeLoadState:E.loadedFiles.sdkBridge,sdk_bridgeLoadTime:t,sdk_purpose:l.sdkPurpose}))}if(window.ebSDKBridge)return e({type:"present"});var n=+new Date;i(t+"sdkBridge.js",e)},n=EBG.adaptor.getTopAccessibleWindow(!1);(-1<navigator.userAgent.toLowerCase().indexOf("afma-sdk")||-1<n.location.href.indexOf("js=afma-sdk"))&&(o.afma=1),a.adConfig&&a.adConfig.customJSVars&&a.adConfig.customJSVars.mdForceDisableMRAID&&(o.dmraid=1),a.inApp&&l?(E.loadedFiles={},!l.allowBridge||!a.nxt||EBG.isPreview&&EBG.isTestMode||(EBG.inAppImpressionManager=new EBG.InAppImpressionManager(a).init(),e()),o.dmraid?this._dispatchSDKEvent({eventName:EBG.EBMessage.MRAID_LOADED,mraidLoaded:!1,loaded:!1,reason:"user_disabled"}):EBG.isMRAID()?(this._dispatchSDKEvent({eventName:EBG.EBMessage.MRAID_LOADED,mraidLoaded:!0,loaded:!0,reason:"present"}),o.mraid=1,c()):function(){o.fmraid=1;var n=+new Date;i("mraid.js",function(e){var t,i;E.loadedFiles.mraid||(t=+new Date,t-=n,E.loadedFiles.mraid=e.type,i="load"===e.type,setTimeout(function(){EBG.isMRAID()&&(o.mraid=1,E._dpm.send(EBG.DataProfile.SERVING,o))},5),E._dispatchSDKEvent({eventName:EBG.EBMessage.MRAID_LOADED,loaded:i,reason:e.type}),i&&c(),a.inApp&&(l=l||{sdkPurpose:2},E._dpm.send(EBG.DataProfile.DEBUG,{sdk_mraidLoadState:E.loadedFiles.mraid,sdk_mraidloadTime:t,sdk_purpose:l.sdkPurpose})))}),d=EBG.runTimed(r,s,[],250)}(),a.mraidObj=o):(this._dispatchSDKEvent({eventName:EBG.EBMessage.MRAID_LOADED,mraidLoaded:!1,loaded:!1,reason:"not_loaded"}),this._dispatchAdaptorReady())},_dispatchSDKEvent:function(e){var t=new EBG.Events.Event(e.eventName);t.timing=EBG.Events.EventTiming.AFTER,t.eventData=e||{},EBG.eventMgr.dispatchEvent(t)},_dispatchAdaptorReady:function(){var e;EBG.adaptor._isReady||(EBG.adaptor._isReady=!0,(e=new EBG.Events.Event(EBG.EBMessage.ADAPTOR_READY)).dispatcher=this,e.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.dispatchEvent(e)||(e.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.dispatchEvent(e)))},_initInteractionManager:function(e){newEvent=new EBG.Events.Event(EBG.Events.EventNames.CREATE_INT_MGR),newEvent.eventData={currentClass:this.getRichestInteractionManager()},newEvent.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.dispatchEvent(newEvent),EBG.intMgr&&EBG.intMgr.constructor.toString()==newEvent.eventData.currentClass.toString()||(e=new newEvent.eventData.currentClass(e),EBG.intMgr=e),newEvent.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(newEvent)},_initAnimationManager:function(e){try{EBG.RichModules&&EBG.RichModules.AnimationManager&&(newEvent=new EBG.Events.Event(EBG.Events.EventNames.CREATE_ANIM_MGR),newEvent.eventData=EBG.RichModules.AnimationManager,newEvent.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.dispatchEvent(newEvent),EBG.animationMgr||(EBG.animationMgr=new newEvent.eventData),!EBG.animator&&EBG.RichModules&&EBG.RichModules.Animator&&(EBG.animator=new EBG.RichModules.Animator(e.adConfig)),newEvent.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(newEvent))}catch(e){}EBG.log.endGroup()},_initDataPipeManager:function(e){var t=e.adConfig||{},i=t.handleStartTime||null;t.dpProfileEvents=["general","platform","serving","error"],t.dpProfileInteractions=["general","serving","platform","interaction"],t.Purposes.Measurements&&t.dpProfileInteractions.push("urls"),t.Purposes.Debug&&(t.dpProfileEvents.push("visibility","debug"),t.dpProfileInteractions.push("visibility","debug")),e.lmu&&(t.dpUrlInteractions=EBG.protocol+e.lmu+"/lm/int",t.dpUrlEvents=EBG.protocol+e.lmu+"/lm/evt",t.dpServer="lm"),EBG.dataPipeMgr=new EBG.DataPipeManager(i),i=EBG.dataPipeMgr.getPipe(e.sid),t.sendMetricsData&&i.createBucket("int",t.dpProfileInteractions,t.dpUrlInteractions),this._reportDebugData(e,i)},_reportDebugData:function(e,i){function t(e){for(var t,i=window;!t;){try{i.frames[e]&&(t=i)}catch(e){}if(i===window.top)break;i=i.parent}return t}var n,a,s=e.adConfig,r=window.__cmp&&"function"==typeof window.__cmp,o=window.__tcfapi&&"function"==typeof window.__tcfapi,d={s_flag:e.ffs.CFF_Shark?1:0,s_nxt:e.nxt?1:0,s_bt:-1<"|5|2|4|8|".indexOf("|"+e.bt+"|")?1:0,s_chromeff:(5==e.bt||2==e.bt)&&-1<"|7|9|10|11|15|16|22|25|32|33|36|37|39|40|41|42|".indexOf("|"+e.plt+"|")&&62<e.bv?1:0,s_ios:4==e.bt&&-1<"|7|10|11|".indexOf("|"+e.plt+"|")&&11<e.bv?1:0,s_edge:8==e.bt&&-1<"|15|19|".indexOf(e.plt)&&17<e.bv?1:0,s_vv:e.ffs.CFF_SharkVV||!window.ebVV?1:0,s_instrm:e.instrm?0:1,s_tn:"StdBanner"==e.tn&&!s.adHtmlPath||"Html5Banner"==e.tn&&e.ffs.CFF_B_Std||"Tracking"==e.tn&&e.ffs.CFF_SharkT?1:0,s_frp:e.adConfig.flashResPath?0:1,s_av:e.av?0:1,s_avd:e.avd?0:1,s_mvfd:e.mvfd?0:1,s_geb:window.gEbBAd?0:1,s_gstr:window.gstrEbPreLoadScripts?0:1,s_ebadcs:!window.ebAdCS||(e.ubss=-1<window.ebAdCS.indexOf("_bskp_"))?1:0,s_ebac:window.ebAC?1:0,s_ope:e.ope?0:1,s_osde:e.osde&&e.osde.length?0:1,s_rspn:s.isResponsive?1:0,s_adpt:s.adaptiveAd?1:0,s_cdiv:s.centerPlaceholderDiv?1:0};d.s_gbt=d.s_chromeff||d.s_ios||d.s_edge,d.liquid=void 0!==s.customJSVars&&(s.customJSVars.hasOwnProperty("mdIsDomainConfigEnabled")&&1==s.customJSVars.mdIsDomainConfigEnabled||s.customJSVars.hasOwnProperty("mdIsProgEnabled")&&1==s.customJSVars.mdIsProgEnabled||s.customJSVars.hasOwnProperty("mdProgEnabled")&&1==s.customJSVars.mdProgEnabled||s.customJSVars.hasOwnProperty("mdProgEnable")&&1==s.customJSVars.mdProgEnable||s.customJSVars.hasOwnProperty("mdcbApplyCustomBehavior")&&1==s.customJSVars.mdcbApplyCustomBehavior)?1:0,s.performance&&(d.timeBigS=s.handleStartTime-s.performance.startTimeBigS,d.timeBS=s.performance.startTimeBigS-s.performance.startTimeBS),e.ffs.CFF_CMPDebug?(d.s_cmp=r?1:0,d.s_cmpi=!r&&t("__cmpLocator")?1:0,d.s_tcf=o?1:0,d.s_tcfi=!o&&t("__tcfapiLocator")?1:0,(n=d.s_tcf||d.s_tcfi?"tcf":d.s_cmp||d.s_cmpi?"cmp":"")?(a=n.toUpperCase()+"Detector",EBG.adaptor.loadModule(a,s,function(){try{var t=new EBG.Adaptors[a]({timeout:1e3,accurateTimeout:e.ffs.CFF_AccurateTimeout?3:0});t.getConsentData(function(e){d["s_"+n+"s"]=e&&e.consentData?e.consentData:0,d["s_"+n+"r"]=t._reason,d["s_"+n+"t"]=t._time,d["s_"+n+"to"]=t._timeoutActualTime,d["s_"+n+"tg"]=t._timeoutTimeGap||-1,i.send(EBG.DataProfile.DEBUG,d)},this)}catch(e){i.send(EBG.DataProfile.DEBUG,d)}},this)):(d.s_cmps=0,d.s_cmpr=0,i.send(EBG.DataProfile.DEBUG,d))):i.send(EBG.DataProfile.DEBUG,d)},_initGeometryHelper:function(){try{var e;EBG.RichModules&&EBG.RichModules.Geometry&&((e=new EBG.Events.Event(EBG.Events.EventNames.CREATE_GEOMETRY_HELPER)).eventData=EBG.RichModules.Geometry,e.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.dispatchEvent(e),EBG.geometry||(EBG.geometry=new e.eventData),e.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(e))}catch(e){}EBG.log.endGroup()},_initElementWatcher:function(){try{EBG.RichModules&&EBG.RichModules.ElementWatcher&&!EBG.elementWatcher&&(EBG.elementWatcher=new EBG.RichModules.ElementWatcher)}catch(e){}EBG.log.endGroup()},_getNumericDataFromFlag:function(e,t){for(var i in e)if(0==i.indexOf(t)&&e[i]){i=parseFloat(i.substr(t.length).replace("_","."));if(!isNaN(i))return i}return 0},_initPositioningHelper:function(){try{EBG.Positioning&&EBG.Positioning.PositionManager&&(newEvent=new EBG.Events.Event(EBG.Events.EventNames.CREATE_POSITIONING_HELPER),newEvent.eventData=EBG.Positioning.PositionManager,newEvent.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.dispatchEvent(newEvent),EBG.posHelper||(EBG.posHelper=new newEvent.eventData),newEvent.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(newEvent))}catch(e){}EBG.log.endGroup()},_initAd:function(t){try{this.inAppV2Failure&&this._dpm.sendNow(t.adConfig.dpUrlEvents,{v2Failure:this.inAppV2Failure.msg});var i=this._getAdClass(t),n=t.adConfig;if(newEvent=new EBG.Events.Event(EBG.Events.EventNames.CREATE_AD),newEvent.eventData={currentClass:i,adConfig:n},newEvent.timing=EBG.Events.EventTiming.BEFORE,newEvent.dispatcher={_adConfig:{rnd:n.rnd,uid:n.uid}},EBG.eventMgr.dispatchEvent(newEvent),new newEvent.eventData.currentClass(n),newEvent.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(newEvent),EBG.adaptor.getDisplayWin().EBG.ads[n.uid]||(EBG.adaptor.getDisplayWin().EBG.ads[n.uid]=EBG.ads[n.uid]),EBG.BWDetection&&window.gEBMainWindow&&gEBMainWindow.EBP&&(gEBMainWindow.EBP.ebBW&&gEBMainWindow.EBP.ebBW.checked?(EBG.BWDetection.speed=gEBMainWindow.EBP.ebBW.speed,EBG.BWDetection.checked=!0):gEBMainWindow.EBP.BW&&gEBMainWindow.EBP.BW.checked&&(EBG.BWDetection.speed=gEBMainWindow.EBP.BW.speed,EBG.BWDetection.checked=!0)),n.pckAssets){for(var a in t=0,n.pckAssets)n.pckAssets.hasOwnProperty(a)&&t++;0<t&&!EBG.BWDetection.checked&&(n.bwApplied=!0,EBG.BWDetection.init()),n.BWD=EBG.BWDetection}}catch(e){a="_initAd",t="none",e.stack&&(5==(i=e.stack.match(/((.*)@|at (.*) ).*:(\d+:\d+)/)).length?(a=i[2]||i[3],t=i[4]):a=e.stack.replace(/\n/," ").substr(0,100)),n.dpUrlEvents&&!this._dpm.isBucketExists("evt")&&this._dpm.createBucket("evt",n.dpProfileEvents,n.dpUrlEvents),this._dpm.send(EBG.DataProfile.ERROR,{errmsg:e.message,errfunc:a,errpos:t,errstack:e.stack.replace(/\(.*\/|(ccfix)/g,"(").replace(/\n(\s)*/g," || ").substr(0,1e3)})}},_getAdClass:function(e){switch(e.tn){case EBG.adTypes.Image:var t=EBG.Ads.ImageEx;break;case EBG.adTypes.RichBannerHtml5:t=EBG.Ads.RichBannerHtml5;break;case EBG.adTypes.PoliteBannerHtml5:t=EBG.Ads.PoliteBannerHtml5;break;case EBG.adTypes.SEBannerHtml5:t=EBG.Ads.SEBannerHtml5;break;case EBG.adTypes.ExpBannerHtml5:t=EBG.Ads.ExpBannerHtml5;break;case EBG.adTypes.StdBannerHtml5:t=EBG.Ads.StdBannerHtml5;break;case EBG.adTypes.StdBanner:t=e.IABBV||e.IABEV?EBG.Ads.StdBannerEx:EBG.Ads.StdBanner;break;case EBG.adTypes.Banner:t=EBG.Ads.RichBanner;break;case EBG.adTypes.SingleExpBanner:t=EBG.Ads.SingleExpBanner;break;case EBG.adTypes.ExpBanner:t=EBG.Ads.ExpBanner;break;case EBG.adTypes.VisibilityAd:t=EBG.Ads.VisibilityAd;break;case EBG.adTypes.FloatingAd:t=EBG.Ads.Floating;break;case EBG.adTypes.FloatingAdWithRem:t=EBG.Ads.FloatingWithReminder;break;case EBG.adTypes.TrackingAd:t=EBG.Ads.TrackingAd;break;case EBG.adTypes.FourthParty:t=EBG.Ads.FourthPartyWithTrackingAd;break;case EBG.adTypes.WallpaperAd:t=EBG.Ads.WallpaperAd;break;case EBG.adTypes.Html5InstreamBanner:t=EBG.Ads.Html5InstreamBanner}return t},_decodeConfiguration:function(e){for(var t=["ncu","p","lid","gdprconsent","dlm"],i=0;i<t.length;i++){var n=t[i];EBG.isDefined(e[n])&&(e[n]=decodeURIComponent(e[n]))}},_updateAdConfig:function(e){var t=e.adConfig,i=e.bigs||ebBigS;t.isNXT=!!e.nxt,t.sHost=window.sHost,t.nonSecureResourcePath=window.ebNSRP,EBG.serverResponses[t.uid]||(EBG.serverResponses[t.uid]=e),t.sUrlTokens=e.ut,t.placeHolderId=e.phid,t.isAsync=!!window.ebAC||!!window.ebAsync,e.element_id&&(t.element_id=e.element_id);var n=EBG.adaptor.getPageWin();if((n=EBG.getPageUrl(n))&&(t.ebReferrer=n),t.html5supported=e.html5Enabled,t.useHtmlConvertor=t.html5supported&&window.ebUseHtml5,t.autolina=e.autolina||0,t.autolina&&EBG.AutolinaClass)try{EBG.Autolina=new EBG.AutolinaClass}catch(e){}if(t.preloadCustomScript=window.ebAdCS,t.actualServingMode=EBG.adaptor.serving?EBG.adaptor.serving.detectServingMode(!0):null,e.ffs.CFF_RemoveUivz&&(EBG.adaptor.focused=t.focused||EBG.adaptor.focused),t._interactionServer=e.is||"BurstingPipe",t._interactionPipe=EBG.combinePaths(EBG.protocol+e.bs,t._interactionServer+"/adServer.bs?cn=int&iv=2&int="),t._interactionsStrPipe=EBG.combinePaths(EBG.protocol+e.bs,t._interactionServer+"/adServer.bs?cn=int&iv=2&interactionsStr="),t.expandDynamic&&(t.showSinglePanel=1),t.clickTrackingUrls||(t.clickTrackingUrls=[]),e.ncu&&(t.clickTrackingUrls.push(e.ncu),t.ncu=e.ncu),t.defaultImpTrackingUrls||(t.defaultImpTrackingUrls=[],t.defaultClickTrackingUrls=[]),e.dctu&&(t.defaultClickTrackingUrls=e.dctu),e.ditu&&(t.defaultImpTrackingUrls=e.ditu),t.delayedImpParams=e.delayedImpParams,t.impressionTrackingURLs=[],e.itu&&0<e.itu.length&&(t.impressionTrackingURLs=e.itu),window.gEbBAd&&(gEbBAd.playRS&&gEbBAd.playRS.strNUrl&&t.impressionTrackingURLs.push(gEbBAd.playRS.strNUrl),gEbBAd.strNImpUrl&&t.impressionTrackingURLs.push(gEbBAd.strNImpUrl)),t.imageOnly=!1,t.page=escape(e.p.replace(/~|\^|\|/gi,"_")),t.massVersioning={targetAudienceId:e.ta&&"-1"!=e.ta?e.ta:"",deliveryGroupId:e.dg&&"-1"!=e.dg?e.dg:"",subDeliveryGroupId:e.sdg&&"-1"!=e.sdg?e.sdg:"",logDeliveryGroupId:e.logdg&&"-1"!=e.logdg?e.logdg:"",adVersions:e.av||"",defaultAdVersion:e.avd||"",adBasePath:e.abp||"",massVersionFolderDivider:e.mvfd||0,versionTargetAudienceId:e.tav&&"-1"!=e.tav?e.tav:"",dgTargetAudienceId:e.tadg&&"-1"!=e.tadg?e.tadg:"",originalDeliveryGroupId:e.dgo&&"-1"!=e.dgo?e.dgo:""},(0<=t.massVersioning.adVersions.indexOf("/")||0<=t.massVersioning.defaultAdVersion.indexOf("/"))&&(t.massVersioning.versionFullPath=!0,t.massVersioning.defaultAdVersion&&(t.massVersioning.defaultAdVersion=JSON.parse(t.massVersioning.defaultAdVersion)),t.massVersioning.adVersions)){t.massVersioning.adVersions=JSON.parse(t.massVersioning.adVersions),t.massVersioning.adVersionsObject=[];for(var a,n=[],s=0;s<t.massVersioning.adVersions.length;s++)a=t.massVersioning.adVersions[s],t.massVersioning.adVersionsObject.push(a),n.push(a.v);t.massVersioning.adVersions=n}if(e.soi&&!e.eb4p&&(t.showOnlyImage=e.soi,t.massVersioning.adVersions=t.massVersioning.defaultAdVersion),EBGInfra.isDefinedNotNull(e.diAppId)&&(t.diAppId=e.diAppId),e.rdi&&(t.reportImpressionType=!0===e.rdi?EBG.ReportImpressionType.DELAYED:e.rdi,t.shouldReportImpression=!0),t.defaultImageReason=e.dir||"",t.mobileSDK=e.sdk||"",t.isOfflineDemo=EBG.isOfflineDemo,void 0===t.openWindow&&(t.openWindow=!0,EBG.adaptor.getDisplayWin()!=EBG.adaptor.getDisplayWin().parent))for(s in t.interactions)if(0===t.interactions[s].target){t.openWindow=!1;break}if(this._updateAdConfigToHandleOpenWindow(e),t.bigSDir=unescape(i),t.imagesDir=unescape(i)+"Res/Images"+e.imgv+"/",t.arrOnStartDnlEvents=e.osde,t.arrOnPlayEvents=e.ope,t.isGeoStrict=0!=e.igs?1:0,t.geoData=e.geo||{},s=e.oo||0,EBG.adaptor.optOut=t.optOut=window.gEbFOptOut||s,EBG.adaptor.histLen=t.histLen=e.hl||30,t.sPublisherPlacementId=e.ppi||"",t.width=t.width||"",t.height=t.height||"",t.adHtmlOptions?(t.width=e.adw||t.width,t.height=e.adh||t.height,t.defaultWidth=e.w||t.width,t.defaultHeight=e.h||t.height,t.adaptiveAd=!0):t.isResponsive?(t.defaultWidth=e.w||t.width,t.defaultHeight=e.h||t.height,t.width="",t.height=""):(t.width=e.w||t.width,t.height=e.h||t.height),t.shouldCollectUrl=e.cu||0,t.sID=e.sid||"",t.dlm=e.dlm||3,t.testImp=!!e.t,t.usercookie=e.usercookie||"",t.visibility={},(s=t.visibility).mode=EBG.VisibilityMode.DEFAULT_MODE,e.IABEV||e.insVis?s.mode=EBG.VisibilityMode.ENHANCED_MODE:e.IABBV&&(s.mode=EBG.VisibilityMode.BASIC_MODE),s.iabMinSurface=e.IABMS,s.iabMinDuration=e.IABMD,s.agencyMinSurface=e.AgMS,s.agencyMinDuration=e.AgMD,s.advertiserMinSurface=e.AdMS,s.advertiserMinDuration=e.AdMD,s.iabMinLargeSurface=30,s.iabMinLargeDuration=e.IABMD,t.isInstreamVisibility=!!e.insVis,t.isInstreamVerification=!!e.insVer,t.displayVerification=!!e.disVer,t.gdprpurposes=e.gdprpurposes,i={},t.gdprpurposes)for(a=0,s=(n=t.gdprpurposes.toString(2)).length-1;0<=s;--s)++a,"1"==n[s]&&(i[a]=1);if(t.Purposes={Cookies:!!i[EBG.Purposes.COOKIES],Measurements:!!i[EBG.Purposes.MEASUREMENTS],Debug:!!i[EBG.Purposes.DEBUG]},t.sendMetricsData=!!e.lcu,t.agencyId=e.agid,t.campaignId=e.campaignId,t.siteId=e.siteId,t.panels)for(var r in s=!1,1==EBG.adaptor.getObjKeys(t.panels).length&&(s=!0),t.panels)t.panels.hasOwnProperty(r)&&(t.panels[r].visibilityIntEnabled=s);t.wurflValue=e.bi,(r=t.interactionsToReport)&&(r[EBG.Interactions.SystemInts.AD_START]=EBG.Interactions.SystemInts.AD_START,r[EBG.Interactions.SystemInts.END_OF_SESSION]=EBG.Interactions.SystemInts.END_OF_SESSION,r[EBG.Interactions.SystemInts.AD_STACKING]=EBG.Interactions.SystemInts.AD_STACKING,r[EBG.Interactions.SystemInts.ACTUAL_SIZE]=EBG.Interactions.SystemInts.ACTUAL_SIZE,r[EBG.Interactions.SystemInts.MULTI_BURN]=EBG.Interactions.SystemInts.MULTI_BURN,r[EBG.Interactions.SystemInts.AD_COLLISION]=EBG.Interactions.SystemInts.AD_COLLISION,r[EBG.Interactions.SystemInts.AD_CAROUSEL]=EBG.Interactions.SystemInts.AD_CAROUSEL,r.visibility&&(r[EBG.Interactions.SystemInts.VISIBILITY_RECORDABLE]=EBG.Interactions.SystemInts.VISIBILITY_RECORDABLE,r[EBG.Interactions.SystemInts.VISIBILITY_AGENCY_RECORDABLE]=EBG.Interactions.SystemInts.VISIBILITY_AGENCY_RECORDABLE,r[EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_RECORDABLE]=EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_RECORDABLE,r[EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER]=EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER,r[EBG.Interactions.SystemInts.VISIBILITY_AGENCY]=EBG.Interactions.SystemInts.VISIBILITY_AGENCY,r[EBG.Interactions.SystemInts.VISIBILITY_IAB]=EBG.Interactions.SystemInts.VISIBILITY_IAB,r[EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_DURATION]=EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_DURATION,r[EBG.Interactions.SystemInts.VISIBILITY_AGENCY_DURATION]=EBG.Interactions.SystemInts.VISIBILITY_AGENCY_DURATION,r[EBG.Interactions.SystemInts.VISIBILITY_AVG_AD_SURFACE]=EBG.Interactions.SystemInts.VISIBILITY_AVG_AD_SURFACE,EBG.adaptor.isInApp()||(r[EBG.Interactions.SystemInts.VISIBILITY_AVG_SCREEN_SHARE]=EBG.Interactions.SystemInts.VISIBILITY_AVG_SCREEN_SHARE))),t.adParamsEnabled=t.displayVerification||t.isInstreamVerification,t.playerParamsEnabled=t.isInstreamVerification,t.verUrlEnabled=t.isInstreamVerification||!!e.verUrl,t.defaultFlashName&&!t.defaultFlashPath&&(t.defaultFlashPath=t.imagesDir+"BannerAssets/"+t.defaultFlashName),t.offsetX=e.offsetX||0,t.offsetY=e.offsetY||0,t.adChoice={},t.adChoice.certificationProgram=e.AcCP,t.adChoice.customUrl=e.CAcURL,t.adChoice.includeMarker=t.AcIncludeMarker,t.adChoice.iconPosition=parseInt(t.AcIconPosition),e.wm&&(t.wmode=e.wm.toLowerCase()),t.pushDownConfig||"none"==e.disp||(t.display=e.disp||"inline"),t.disableAutoExpand=e.dex||0,t.aiE=e.aiE||{},t.appPool=e.appPool||"BurstingPipe",t.interactionServer=e.is||"BurstingPipe",t.advertiserId=e.advid,t.moduleInfo=e.h5mi||{};try{window.gEbBAd&&(gEbBAd.panelsWMode&&(t.panelsWMode=gEbBAd.panelsWMode),gEbBAd.strWmode&&(t.wmode=gEbBAd.strWmode.toLowerCase()))}catch(e){}if(EBG.adaptor.isSafeFrame())for(var o in t.isSafeFrame=!0,t.panels){r=t.panels[o];try{var d=$sf.ext.geom();r.posType!=EBG.PanelPositionType.PAGE_RELATIVE_PERCENTAGE&&r.posType!=EBG.PanelPositionType.VIEWPORT_RELATIVE_PERCENTAGE||(r.xPos=Math.round(r.xPos/100*(d.win.w-r.width)),r.yPos=Math.round(r.yPos/100*(d.win.h-r.height))),r.posType!=EBG.PanelPositionType.BANNER_RELATIVE_PIXELS&&(r.xPos-=d.self.l,r.yPos-=d.self.t)}catch(e){r.xPos=0,r.yPos=0}r.posType=EBG.PanelPositionType.BANNER_RELATIVE_PIXELS}EBG.adaptor.isAMP()&&(t.isAMP=!0,t.expandDynamic=0),EBG.adaptor.isSkype()&&(t.isSkype=!0),t.isInApp=EBG.adaptor.isInApp(),t.locationPolling=this._setLocationPolling(t.locationPolling),e.eb4p&&(t.fourthPartyTag=e.eb4p)},_setLocationPolling:function(e){return e=0<e?(e=Math.min(e,100),Math.max(e,10)):0},_updateAdConfigToHandleOpenWindow:function(e){var t=e.adConfig;t.bsPath=t.dataCapture=e.bs,t.pluId=EBG.pluId,t.protocol=EBG.protocol,EBGInfra.isDefined(e.lid)&&(t.lineId=e.lid),t.isPreview=!!e.pr},_sendInitialDataPipeData:function(e){var t=e.adConfig;this._dpm=EBG.dataPipeMgr.getPipe(t.sID),this._dpm.send(EBG.DataProfile.GENERAL,{srcv:e.scv.substring(1),adid:t.adId,pid:t.placementId,AgencyID:t.agencyId||0,cid:t.campaignId||0,siteid:t.siteId||0,advid:t.advertiserId||0,ctime:+new Date,tzoff:(new Date).getTimezoneOffset()}),this._dpm.send(EBG.DataProfile.PLATFORM,{os:EBG.adaptor.browser._platform,brsrc:EBG.adaptor.browser._browserCode,brsrv:EBG.adaptor.browser._browserVer,brsrt:EBG.adaptor.browser._browserType}),EBG.adaptor.isSkype()&&this._dpm.send(EBG.DataProfile.PLATFORM,{skype:1}),this._dpm.send(EBG.DataProfile.URLS,{dmn:e.dmn});var i={};if(t.Purposes.Debug&&e.mraidObj&&e.inApp&&(i=e.mraidObj),t.reportImpressionType&&(i.rdi=t.reportImpressionType),e.inApp&&(i.inapp=1),t.isInstream&&(i.instream=1),window.$sf&&(i.sf=1),t.preloadCustomScript&&(i.cs=1),e.pi&&(i.isplu=1),e.innerIframe&&(i.aie=1),i.env=EBG.adaptor.browser.getEnvironment(),i.dt=EBG.adaptor.browser._deviceType,i.wvsb=~~(t.isInstreamVisibility||t.visibility.mode!=EBG.VisibilityMode.DEFAULT_MODE),i.wvrf=~~(t.isInstreamVerification||t.displayVerification),t.wurflValue&&(i.bi=t.wurflValue),t.isSafeFrame&&(i.sf=1),this._dpm.send(EBG.DataProfile.SERVING,i),t.sendMetricsData&&(this._dpm.send(EBG.DataProfile.INTERACTION,{IntrN:"metrics",IntrT:2,Usr:t.usercookie}),!window||!window.location||EBG.adaptor.browser.isIE()&&EBG.adaptor.browser.getVersion()<=9||EBG.adaptor.loadModule("URLUtil",t,function(){var e;EBG.URLUtil&&(e=function(e){this._dpm.send(EBG.DataProfile.URLS,{turl:e.top,rurl:e.referrer,aorg:e.aorg})}.bind(this),new EBG.URLUtil(e,{maximumUrlLength:5e3,maximumAorgUrls:3}))},this)),t.ffs.CFF_GlblChk){for(e="doNotInit ebArrModulesToTrigger ebAttrConf ebAttribution ebRD ebRDGlobal ebSafeFrame ebUseHtml5 ebUserIdGuid gEbAd gEbBAd gEbBannerData gEbDisableSmartServeAPI gEbEyeDivRefElement gEbfLoadAsAS2 gEbFlyLocal gEbfNewOfflineDemo gEbfOfflineDemo gEbFOptOut gEbPIT gEbURLTokens gfEbCacheResources gfEbChangeRelativeElements gfEbExpBanerIM gfEbExpBannerIM gfEbForceStreaming gfEbInlineBanner gfEbRemoveScroll gfEbUseCompression gfEbUseHTTPS gfEbUseMozHideIframe gnEbLowBWLimit gnEbMinZIndex gstrAdPrefix gstrEbDisplayPos gstrEbDomain gstrEbIframeLocation gstrEbPreLoadScripts providersData strPage".split(" "),t={dbg:1},i=0;i<e.length;++i)window[e[i]]&&(t[e[i]]=1);if(window.gEbBAd)for(var n in window.gEbBAd)window.gEbBAd.hasOwnProperty(n)&&(t["g_"+n]=1);this._dpm.send(EBG.DataProfile.DEBUG,t)}}};try{var currentResponse=EBG.Initializer.initialize(),vizClone,newEbSrc,newEbSrc,newScript,target,sub;!currentResponse.adConfig.UiVz||currentResponse.requiresIframeBust||!currentResponse.IABBV&&!currentResponse.IABEV||EBG.adaptor.isSafeFrame()||"Visibility"==currentResponse.tn||(vizClone=EBG.cloneObj(currentResponse),vizClone.tn=vizClone.adConfig.templateName="Visibility",vizClone.ifrm=2,vizClone.soi=0,ebOArr[ebOArr.length]=vizClone,newEbSrc=ebSrc.replace(currentResponse.tn,vizClone.tn),newEbSrc=newEbSrc.replace(/ex(debug|_api|)\.js/gi,".js"),newScript=document.createElement("SCRIPT"),newScript.src=newEbSrc,vizClone.ebSrc=newEbSrc,currentResponse.adConfig.adStarted?(target=document.getElementById(vizClone.phid),target&&target.appendChild(newScript)):(sub=new EBG.Events.EventSubscription(EBG.Events.EventNames.AD_START,function(){var e=document.getElementById(vizClone.phid);e&&e.appendChild(newScript)},this),sub.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(sub)))}catch(a){}
