!function(){var e={305:function(e,t){var n;!function(o){"use strict";var r=function(e,t,n){if(!Array.isArray(e))throw new TypeError("each() expects array as first argument");if("function"!=typeof t)throw new TypeError("each() expects function as second argument");if("function"!=typeof n&&(n=Function.prototype),0===e.length)return n(void 0,e);var o=new Array(e.length),r=0,i=!1;e.forEach((function(a,s){t(a,(function(t,a){if(!i)return t?(i=!0,n(t)):(o[s]=a,(r+=1)===e.length?n(void 0,o):void 0)}))}))};void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()},176:function(e){"use strict";e.exports.get=function(e){if(document.cookie&&document.cookie.length){for(var t,n=document.cookie.split(";"),o={},r=0,i=n.length;r<i;r++)o[(t=n[r].replace(/^(\s|\u00A0)+/g,"").split("="))[0]]=decodeURIComponent(t[1]);return e?o[e]:o}},e.exports.set=function(e,t,n){if(void 0!==e&&void 0!==t){var o=(n=n||{}).expires||{};"number"==typeof n.expires&&(o=new Date).setTime(o.getTime()+24*n.expires*60*60*1e3);var r=e+"="+encodeURIComponent(t);return r+=o.toUTCString?"; expires="+o.toUTCString():"",r+=n.path?"; path="+n.path:"",r+=n.domain?"; domain="+n.domain:"",r+=n.samesite?"; samesite="+n.samesite:"",r+=n.secure?"; secure":"",document.cookie=r,r}},e.exports.remove=function(t,n){return(n=n||{}).expires=-1,e.exports.set(t,"",n)}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e,t,o,r="ramblerIdHelper",i="ramblerIdHelperSentry",a="ramblerIdHelperTest",s=[-11,-4e3,-2e3,-2002,-3e3,"need session","invalid login","rate limit exceed","api does not respond","location does not respond"],l=n(305),c=n.n(l),u=n(176),d=function(e){var t,n=null;try{n=JSON.parse(null!==(t=u.get(e))&&void 0!==t?t:"")}catch(e){}return n},p=function(e,t,n){try{u.set(e,JSON.stringify(t),n)}catch(e){}},f=(e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)},function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}),m=function(e){function t(t){var n,o=e.call(this)||this;return o.name="ApiError",o.message=t.message.toString().toLowerCase(),o.code=null!==(n=t.code)&&void 0!==n?n:"unknown",o.details=t.details,o}return f(t,e),t}(Error),h=function(){return(h=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},y="rchainid",v={domain:"."+window.location.hostname.split(".").slice(-2).join("."),path:"/",samesite:"none",secure:!0},b=function(e){if(e){var t=e;e instanceof Error&&(t={message:e.message},"code"in e&&(t.code=e.code,t.details=e.details));var n=e instanceof Error&&"need session"!==e.message?1/24/30:1/24/12;p(y,t,h(h({},v),{expires:n}))}},g="requestStorageAccess"in document&&"function"==typeof document.requestStorageAccess,w=["id.rambler.ru","id.championat.com","idrambler.afisha.ru","rid.eda.ru","id.gazeta.ru","id.lenta.ru","id.moslenta.ru","id.secretmag.ru","id.motor.ru","id.passion.ru","id.wmj.ru","id.letidor.ru","id.ferra.ru","id.quto.ru","id.indicator.ru","id-loyalty.rambler-co.ru","id.eagleplatform.com"],O=function(e){return e.split(".").slice(-2).join(".")},E=function(){var e=window.location.hostname,t=(g?w.filter((function(t){return O(t)===O(e)})):[])[0];return t?"https://"+t:"https://id.rambler.ru"},L="undefined"!=typeof window?null===(t=window.navigator)||void 0===t?void 0:t.userAgent:"",x=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(L),I=/.*(; wv|Version\/\d\.\d|\.0\.0\.0).*/.test(L),R=x||I,C=/IEMobile|Windows Phone/i.test(L),T=/iPhone|iPad|iPod/i.test(L)&&!C,S=/Android/i.test(L)&&!C,A=T||S,j=function(e,t,n){void 0===n&&(n=!1);var o=new XMLHttpRequest;o.withCredentials=n,o.open("get",e,!0),o.onreadystatechange=function(){4===o.readyState&&0!==o.status&&t(null,o.responseText)},o.onerror=function(){t(new m({message:"location does not respond",code:0,details:{method:e}}))},o.send(null)},k=function(){return(Date.now().toString(36)+Math.random().toString(36).slice(2)).slice(0,17)},P=E(),N=function(e,t,n,o){void 0===o&&(o=P);var r=new XMLHttpRequest,i="rid"+k(),a={method:e,params:[t],rpc:"2.0"};r.open("post",o+"/jsonrpc",!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("X-Client-Request-Id",i),r.withCredentials=!0,r.onreadystatechange=function(){var t;if(4===r.readyState&&200===r.status){var o=JSON.parse(r.responseText).result,a=o.status,s=o.error,l=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}(o,["status","error"]);if("OK"!==a||null!=s)if(null!=s){var c=s.errno,u=null===(t=s.strerror)||void 0===t?void 0:t.toLowerCase();n(new m({message:u,code:c,details:{method:e,requestId:i}}))}else n(new m({message:"api failed",code:0,details:{method:e,requestId:i}}));else n(null,l)}},r.onerror=function(){n(new m({message:"api does not respond",code:0,details:{method:e,requestId:i}}))},r.send(JSON.stringify(a))},_=N.bind(null,"Rambler::Id::get_profile_info"),B=N.bind(null,"Rambler::Id::destroy_session"),H=N.bind(null,"Rambler::Id::Aux::get_rsidx"),U=N.bind(null,"Rambler::Id::get_rccid"),M=N.bind(null,"Rambler::Common::get_configuration"),F=N.bind(null,"Rambler::Id::set_rsid_local"),G="get",D=function(e,t,n,o){var r=new XMLHttpRequest,i="rid"+k(),a="https://prime.rambler.ru/api/v3"+t;e===G&&(a+="?"+Object.keys(n).reduce((function(e,t){return e.concat(t+"="+encodeURIComponent(n[t]&&"object"==typeof n[t]?JSON.stringify(n[t]):n[t]))}),[]).join("&")),r.open(e,a,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("X-Client-Request-Id",i),r.onreadystatechange=function(){if(4===r.readyState&&200===r.status){var e=JSON.parse(r.responseText),n=e.success,a=e.error,s=e.result;if(n&&null==a)o(null,s);else{var l=null==a?"UNKNOW_ERROR":a.type+"_"+a.subtype;o(new m({message:"api failed",code:l,details:{requestId:i,method:t}}))}}},r.onerror=function(){o(new m({message:"api does not respond",code:"UNKNOW_ERROR",details:{requestId:i,method:t}}))},r.send(e===G?null:JSON.stringify(n))},W=D.bind(null,G,"/prime/getActiveAdblockInfo"),q=D.bind(null,"post","/prime/createAdblockOrder");!function(e){e.INSTALL="install",e.INSTALLED="installed",e.ERROR="error",e.REGISTER="register",e.LOGIN="login",e.OAUTHLOGIN="oauthlogin",e.LOGOUT="logout",e.CLOSE="close",e.REDIRECT="redirect",e.RESIZE="resize",e.LOADED="loaded"}(o||(o={}));var z,J=function(e,t){var n=document.createElement("script");n.src=e,n.onload=function(){t(null),document.body&&document.body.removeChild(n)},n.onerror=function(){t(new m({message:"script does not loaded"}))},document.body&&document.body.appendChild(n)},Z=function(e){z?e(z):J("https://id.rambler.ru/rambler-id-helper/1.2.0/sentry.js",(function(t){z?e(z):t||(z=window[i],delete window[i],e(z))}))},V=function(e,t){return e+"?"+Object.keys(t).map((function(e){var n=t[e];return n&&"object"==typeof n&&(n=JSON.stringify(n)),e+"="+encodeURIComponent(n)})).join("&")},X=function(){return(X=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},K={width:750,height:450},Y={sberbank:{title:"РЎР±РµСЂ ID",width:1024,height:750},apple:{title:"Apple ID",width:650,height:750},livejournal:{title:"LiveJournal",width:750,height:650},pgumosru:{title:"mos.ru",width:750,height:650},google:{title:"Google",width:650,height:700},instagram:{title:"Instagram",width:750,height:650},webauthn:X({title:"Р­Р»РµРєС‚СЂРѕРЅРЅС‹Р№ РєР»СЋС‡"},K),vkontakte:X({title:"Р’РљРѕРЅС‚Р°РєС‚Рµ"},K),facebook:X({title:"Facebook"},K),odnoklassniki:X({title:"РћРґРЅРѕРєР»Р°СЃСЃРЅРёРєРё"},K),mailru:X({title:"Mail.Ru"},K),twitter:X({title:"Twitter"},K),mail:{title:"РЎ РїРѕРјРѕС‰СЊСЋ РїРѕС‡С‚С‹"},phone:{title:"РџРѕ РЅРѕРјРµСЂСѓ С‚РµР»РµС„РѕРЅР°"},championat:X({title:"Championat"},K)},$=Object.keys(Y).filter((function(e){return"mail"!==e&&"phone"!==e})),Q=function(){return(Q=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},ee=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n},te=function(e,t){e.onload=function(){t(null,e)},e.onerror=function(){t(new m({message:"frame does not loaded"}))}},ne=$.reduce((function(e,t){var n;return X(X({},e),((n={})[t]=Y[t],n))}),{}),oe=function(){return(oe=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},re=function(){function e(){this.listeners={}}return e.prototype.existsListener=function(e,t){return this.listeners[e]&&-1!==this.listeners[e].indexOf(t)},e.prototype.addListener=function(e,t){this.listeners[e]=this.listeners[e]||[],"function"!=typeof t||this.existsListener(e,t)||this.listeners[e].push(t)},e.prototype.removeListener=function(e,t){this.existsListener(e,t)&&this.listeners[e].splice(this.listeners[e].indexOf(t),1)},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.listeners[e]&&this.listeners[e].forEach((function(e){e.apply(void 0,t)}))},e}(),ie=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ae=function(){return(ae=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},se="sberIdNotificationBannerClosed",le="sberIdNotificationBannerCloseCount",ce={path:"/",domain:window.location.hostname.split(".").slice(-2).join(".")},ue=[1/12,1,7,28],de=function(e){function t(t){var n,o,r=e.call(this)||this;return r.onLoginClick=function(){r.emit("click")},r.onCloseClick=function(){var e,t=null!==(e=d(le))&&void 0!==e?e:0;p(se,!0,ae(ae({},ce),{expires:ue[Math.min(t,3)]})),p(le,t+1,ae(ae({},ce),{expires:365})),r.destroy()},r.options=ae(ae({},t),{fontFamily:null!==(n=t.fontFamily)&&void 0!==n?n:"Roboto, sans-serif",position:null!==(o=t.position)&&void 0!==o?o:"right"}),r.container=document.createElement("div"),r.container.style.position="fixed",r.container.style.opacity="0",r.container.style.bottom=A?"0":"30px",r.container.style.background="#fff",r.container.style.border="1px solid #E3E3E3",r.container.style.boxShadow="0px 10px 24px rgba(45, 73, 88, 0.15)",r.container.style.borderRadius=A?"0":"5px",r.container.style.padding="20px",r.container.style.display="flex",r.container.style.width=A?"100%":"auto",r.container.style.boxSizing="border-box",r.container.style.flexDirection="column",r.container.style.fontFamily=r.options.fontFamily,r.container.style.minWidth="320px",r.container.style.transition="opacity 200ms",r.container.style[r.options.position]=A?"0":"30px",r.label=document.createElement("div"),r.label.style.fontSize="15px",r.label.style.lineHeight="18px",r.label.style.color="#767676",r.label.style.marginBottom="16px",r.label.style.fontWeight="600",r.label.textContent="Р’С…РѕРґ РїРѕ РЎР±РµСЂ ID",r.container.appendChild(r.label),r.closeButton=document.createElement("a"),r.closeButton.setAttribute("role","button"),r.closeButton.style.fontSize="0",r.closeButton.style.lineHeight="12px",r.closeButton.style.color="#767676",r.closeButton.style.position="absolute",r.closeButton.style.top="10px",r.closeButton.style.right="10px",r.closeButton.style.cursor="pointer",r.closeButton.style.display="flex",r.closeButton.style.padding="10px",r.closeButton.innerHTML='<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6 4.65094L10.3675 0.282877C10.7431 -0.0927631 11.3485 -0.0942703 11.721 0.27826C12.0961 0.653395 12.0914 1.25686 11.7164 1.63195L7.34886 6L11.7164 10.368C12.0914 10.7431 12.0961 11.3466 11.721 11.7217C11.3485 12.0943 10.7431 12.0928 10.3675 11.7171L6 7.34906L1.63247 11.7171C1.25688 12.0928 0.651469 12.0943 0.278986 11.7217C-0.0960822 11.3466 -0.0914182 10.7431 0.283602 10.368L4.65114 6L0.283602 1.63195C-0.0914182 1.25686 -0.0960822 0.653395 0.278986 0.27826C0.651469 -0.0942703 1.25688 -0.0927631 1.63247 0.282877L6 4.65094Z" fill="currentColor"/></svg>',r.container.appendChild(r.closeButton),r.button=document.createElement("a"),r.button.setAttribute("role","button"),r.button.style.display="flex",r.button.style.alignItems="center",r.button.style.justifyContent="center",r.button.style.textDecoration="none",r.button.style.height="48px",r.button.style.fontSize="16px",r.button.style.fontWeight="400",r.button.style.lineHeight="19px",r.button.style.color="#fff",r.button.style.backgroundColor="#21A038",r.button.style.padding="0 23px",r.button.style.borderRadius="4px",r.button.innerHTML='<svg width="22" height="22" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13 0C16.0927 0 18.9337 1.08103 21.1657 2.88421L18.6371 4.74793C17.0315 3.64848 15.0899 3.00354 13 3.00354C7.48924 3.00354 3.00587 7.48999 3.00587 13.0013C3.00587 18.5126 7.48924 22.9965 13 22.9965C18.5134 22.9965 22.9968 18.5126 22.9968 13.0013C22.9968 12.9118 22.9941 12.8223 22.9924 12.7328L25.7912 10.6699C25.9289 11.4245 26 12.2055 26 13.0013C26 20.1807 20.1795 26 13 26C5.82135 26 0 20.1807 0 13.0013C0 5.81931 5.82135 0 13 0ZM23.2856 5.05241C23.9006 5.84651 24.4262 6.71169 24.8456 7.63565L13.0002 16.3673L8.05093 13.2628V9.52921L13.0002 12.6337L23.2856 5.05241Z" fill="currentColor"/></svg>',r.container.appendChild(r.button),r.buttonText=document.createElement("span"),r.buttonText.style.marginLeft="8px",r.buttonText.textContent=t.displayName?"Р’РѕР№С‚Рё РєР°Рє "+t.displayName:"Р’РѕР№С‚Рё РїРѕ РЎР±РµСЂ ID",r.button.appendChild(r.buttonText),r}return ie(t,e),t.prototype.destroy=function(){var e=this;this.container.style.opacity="0",this.button.removeEventListener("click",this.onLoginClick),this.closeButton.removeEventListener("click",this.onCloseClick),this.emit("destroy"),window.setTimeout((function(){document.body.removeChild(e.container)}),200)},t.prototype.attach=function(){var e=this;this.button.addEventListener("click",this.onLoginClick),this.closeButton.addEventListener("click",this.onCloseClick),document.body.appendChild(this.container),window.setTimeout((function(){e.container.style.opacity="1"}),0)},t}(re),pe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),fe=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n},me=function(e,t){for(var n=0,o=t.length,r=e.length;n<o;n++,r++)e[r]=t[n];return e},he=function(e){function t(){var n=e.call(this)||this;return n.firstPartyOrigin=E(),n.currentTabId=k(),n.listenStorage=function(e){var o=e.data;if(o&&"object"==typeof o){var i=o.emitter,a=o.eventType,s=o.redirectUrl,l=o.data,c=o.frameInfo,u=void 0===c?l||{}:c,d=fe(o,["emitter","eventType","redirectUrl","data","frameInfo"]);i===r&&(!s||"object"!=typeof u||u instanceof Error||(u.redirectUrl=s),t.isAuthEvent(a)?n.emit(a,l,d):n.emit(a,u,s))}},n.storage=document.createElement("iframe"),n.storage.src=n.firstPartyOrigin+"/rambler-id-helper/1.2.0/storage.html",n.storage.style.width="0",n.storage.style.height="0",n.storage.style.border="0",n.storage.style.position="absolute",n.storage.style.left="-9999px",n.storage.setAttribute("aria-hidden","true"),n.storage.onload=function(){var e,t={eventType:o.INSTALL,emitter:r,data:{providerOrigin:window.location.href}};try{null===(e=n.storage.contentWindow)||void 0===e||e.postMessage(t,n.firstPartyOrigin),n.emit(o.INSTALLED)}catch(e){n.emit(o.ERROR,new Error("storage is not installed"))}},n.storage.onerror=function(){n.emit(o.INSTALLED),n.emit(o.ERROR,new Error("storage is not loaded"))},document.body&&document.body.appendChild(n.storage),window.addEventListener("message",n.listenStorage,!1),n}return pe(t,e),t.isAuthEvent=function(e){return Boolean(~t.AUTH_EVENTS.indexOf(e))},t.canPropagateEvent=function(e){return e!==o.ERROR},t.prototype.getBroadcastNodes=function(e){var n=window.opener,o=window.parent,r=t.isAuthEvent(e)?Array.prototype.slice.call(document.getElementsByTagName("iframe")).filter((function(e){return/^https?:\/\/[^/]+\.rambler\.ru\//.test(e.src)})).map((function(e){return e.contentWindow})):[];return[n,o!==window&&o].concat(r).filter(Boolean)},t.prototype.emit=function(e,n,o){for(var i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];var s,l=this,c=l.listeners,u=l.currentTabId,d=l.latestEvent;if(t.canPropagateEvent(e)){var p=o&&"object"==typeof o?o:{},f=p.tabId,m=void 0===f?null:f,h=p.time,y=void 0===h?Date.now():h,v=fe(p,["tabId","time"]);if(y===d)return;var b=!n||"object"!=typeof n||n instanceof Error?{}:n,g=b.silentCurrentTab,w=void 0===g?v.silentCurrentTab:g,O=b.redirectUrl,E=void 0===O?"":O,L=!m||m===u;s=E;var x={emitter:r,eventType:e,time:y,data:n,tabId:m||u};try{var I=this.getBroadcastNodes(e);I.forEach((function(e){e.postMessage(x,"*")}))}catch(e){}if(this.latestEvent=y,L&&w)return}setTimeout((function(){var t,r=me([],null!==(t=c[e])&&void 0!==t?t:[]);r&&r.forEach((function(e){e.apply(void 0,me([n,s||o],i))}))}),10)},t.AUTH_EVENTS=[o.LOGIN,o.OAUTHLOGIN,o.LOGOUT],t}(re),ye=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ve=function(){return(ve=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},be=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n},ge=function(){},we=1===function(e){var t,n=null;try{n=JSON.parse(null!==(t=window.localStorage.getItem("itpRedirectorStageApi"))&&void 0!==t?t:"")}catch(e){}return n}()?"/api/itp/v2/test-redirector":"/api/itp/v2/redirector",Oe=function(e){function t(){var t=e.call(this)||this;return t.Events=o,t.userSession=!1,t.sendError=function(e){~s.indexOf(e.message)||"code"in e&&e.code&&~s.indexOf(e.code)||Z((function(t){t.withScope((function(n){var o=ve(ve({},"code"in e&&{code:e.code}),"details"in e&&e.details);for(var r in o)o.hasOwnProperty(r)&&n.setExtra(r,o[r]);t.captureException(e)}))}))},t.removeCache=function(){delete window.PRIME_SSR_STATUS,function(e,t){try{u.remove("rchainid",t)}catch(e){}}(0,v)},t.redirect=function(e,t){window.location.href=t},t.closeAuth=function(e){void 0===e&&(e=ge);var n=t,o=n.authFrame,r=n.authContainer;if(o){if(o instanceof Window&&"function"==typeof o.close)return o.close(),void("function"==typeof e&&e());r instanceof HTMLElement&&"own"===r.getAttribute("data-id-frame")&&(r.style.zIndex="-1",r.style.transform="translateY(-100vh)",r.style.opacity="0",document.documentElement instanceof HTMLElement&&(document.documentElement.style.overflow="")),"function"==typeof e&&e()}},t.resizeAuth=function(e){var n=e.height,o=t.authContainer;o instanceof HTMLElement&&(o.style.height=n+"px")},t.destroyAuth=function(e){"object"==typeof e&&((null==e?void 0:e.keepWindow)||"registration"===(null==e?void 0:e.on))||t.closeAuth((function(){var e=t,n=e.authFrame,r=e.authContainer;n instanceof HTMLIFrameElement&&r instanceof HTMLElement&&(setTimeout((function(){t.removeListener(o.RESIZE,t.resizeAuth),t.removeListener(o.CLOSE,t.closeAuth),t.removeListener(o.LOGIN,t.destroyAuth),t.removeListener(o.OAUTHLOGIN,t.destroyAuth),t.removeListener(o.REDIRECT,t.redirect)}),0),"embed"!==r.getAttribute("data-id-frame")?document.body&&(document.body.removeChild(r),delete t.authFrame):setTimeout((function(){r.removeChild(n),r.removeAttribute("data-id-frame"),delete t.authFrame}),500))}))},t.registerOnFrameRedirect=t.addListener.bind(t,o.REDIRECT),t.registerOnFrameCloseCallback=t.addListener.bind(t,o.CLOSE),t.registerOnPossibleLoginCallback=t.addListener.bind(t,o.LOGIN),t.registerOnPossibleOauthLoginCallback=t.addListener.bind(t,o.OAUTHLOGIN),t.registerOnPossibleLogoutCallback=t.addListener.bind(t,o.LOGOUT),t.emitLogin=t.emit.bind(t,o.LOGIN),t.emitLogout=t.emit.bind(t,o.LOGOUT),t.addListener(o.LOGIN,t.removeCache),t.addListener(o.OAUTHLOGIN,t.removeCache),t.addListener(o.LOGOUT,t.removeCache),t.addListener(o.ERROR,t.sendError),t}return ye(t,e),Object.defineProperty(t.prototype,"hasTrackingPrevention",{get:function(){return g},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authContainer",{get:function(){var e=null;try{e=this.authFrame instanceof HTMLIFrameElement?this.authFrame.parentElement:null}catch(e){}return e},enumerable:!1,configurable:!0}),t.prototype.push=function(e){void 0===e&&(e=ge),e()},t.prototype.rpc=function(e,t,n){var r=this;void 0===n&&(n=ge),N(e,t,(function(e,t){e&&r.emit(o.ERROR,e),n(e,t)}))},t.prototype.logout=function(e,t){var n=this;void 0===t&&(t=ge),"function"==typeof e&&(t=e,e=void 0),B({},(function(r){r&&n.emit(o.ERROR,r),n.emit(o.LOGOUT,e),t(null,r)}))},t.prototype.getProfileInfo=function(e,t){var n=this;void 0===t&&(t=ge),"function"==typeof e&&(t=e,e={}),_(e,(function(e,r){n.userSession=!!r,e&&n.emit(o.ERROR,e),t(r?r.profile:null,e)}))},t.prototype.getCurrentUserInfo=function(e){void 0===e&&(e=ge),this.getProfileInfo((function(t,n){if(t){var o=t.display.avatar.url;/avatars\.rambler\.ru/.test(o)&&(o=o.replace(/\/default$/,"").replace(/\/get/,"/100x100"));var r={provider:t.display.avatar.provider,iconUrl:t.display.avatar.provider_icon,avatarUrl:o,shortName:t.display.short_name,displayName:t.display.display_name,mailboxExists:"general"===t.__type?1:0};e(r,n)}else e(null,n)}))},t.prototype.createSession=function(e,t){var n=this;void 0===t&&(t=ge),J("https://id.rambler.ru/script/create_session.js?token="+e,(function(e){e?n.emit(o.ERROR,e):t()}))},t.prototype.exportsid=function(e){var t=this;void 0===e&&(e=ge),J("https://id.rambler.ru/script/exportsid.js",(function(n){n?t.emit(o.ERROR,n):e(window.RamblerId)}))},t.prototype.variti=function(e){void 0===e&&(e=ge),e({})},t.prototype.getSessionToken=function(e){var t=this;void 0===e&&(e=ge),H({},(function(n,r){t.userSession=!!r,n&&t.emit(o.ERROR,n),b(null!=n?n:null==r?void 0:r.result.rccid),e(r?r.result:null,n)}))},t.prototype.getDefaultChainId=function(e){var t=this;void 0===e&&(e=ge);var n=function(){var e=d(y);if(!e||"string"==typeof e)return e;var t=e.code,n=e.message,o=e.details;return"details"in e?new m({message:n,code:t,details:o}):new Error(n)}();n instanceof Error?e(null,n):n?e({rccid:n}):U({},(function(n,r){n&&t.emit(o.ERROR,n),b(null!=n?n:null==r?void 0:r.rccid),e(r?{rccid:r.rccid}:null,n)}))},t.prototype.createPropagationWindow=function(){return!this.hasTrackingPrevention||x?null:window.open("https://id.rambler.ru/rambler-id-helper/1.2.0/noop.html","","status=1,toolbar=0,menubar=0,resizable=1,scrollbars=1,width=250px,height=100px,top=100px,left=100px")},t.prototype.propagateSession=function(e,t,n){var r=this;void 0===t&&(t={eventType:o.LOGIN}),void 0===n&&(n=ge);var i=t.eventType,a=void 0===i?o.LOGIN:i,s=t.shortSession,l=void 0!==s&&s,u=t.propagationWindow,d=void 0===u?null:u,p=be(t,["eventType","shortSession","propagationWindow"]);p.keepWindow&&(p.data=p.data||{},p.data.keepWindow=p.keepWindow),this.hasTrackingPrevention?c()(w,(function(e,t){j("https://"+e+"/api/itp/v2/ping",(function(n,o){var r;try{r=JSON.parse(o)}catch(e){}t(null,[e,null==r?void 0:r.response,n])}))}),(function(t,i){var s=i.filter((function(e){return e[0]===w[0]})).map((function(e){return e[1]}))[0],c=[],u=[];i.forEach((function(e){var t=e[0],n=e[1],o=e[2];s&&s===n?c.push(t):u.push(o||new m({message:"ping response wrong",code:0,details:{method:"https://"+t+"/api/itp/v2/ping"}}))})),u.length>0&&Z((function(){u.forEach((function(e){return r.emit(o.ERROR,e)}))}));var f=c[0],h=void 0===f?"https://id.rambler.ru".replace(/^https?:\/\//,""):f,y=c.slice(1),v="https://id.rambler.ru/rambler-id-helper/1.2.0/propagate.html?extra="+encodeURIComponent(JSON.stringify(ve({eventType:a},p))),b="https://"+h+we+"?rsid="+(e||"")+"&setShortCookie="+(l?1:0)+y.map((function(e){return"&to="+e})).join("")+"&back="+encodeURIComponent(v);if(!d)return n(),void(window.location.href=b);var g=function(){r.removeListener(a,g),n()};r.addListener(a,g),d.location.replace(b)})):M({key:"ServerSideDomains"},(function(t,o){var i=t?[]:Object.keys(o.configuration).filter((function(e){return!!o.configuration[e]}));c()(i,(function(t,n){var o=t.split(".").slice(-2).join(".");F({domain:o,id:e},(function(){return n(null)}),"https://"+t)}),(function(){if(p.back&&!p.popup){var e=function(){setTimeout((function(){var t;r.removeListener(a,e),n(),window.location.href=null!==(t=p.back)&&void 0!==t?t:""}),500)};r.addListener(a,e)}else n();r.emit(a,p.data)}))}))},t.prototype.activateCookies=function(e){if(void 0===e&&(e=ge),window.parent!==window)if(p(a,1,{expires:1/24/6,path:"/",domain:".rambler.ru",samesite:"none",secure:!0}),d(a))e();else{var t=window.open("https://id.rambler.ru/rambler-id-helper/1.2.0/cookies.html","","status=1,toolbar=0,menubar=0,resizable=1,scrollbars=1,width=500px,height=300px,top=100px,left=100px"),n=function(o){o.data===a&&(window.removeEventListener("message",n),null==t||t.close(),e())};window.addEventListener("message",n)}else e()},t.prototype.getPrimeSubscription=function(e,t){var n=this;void 0===t&&(t=ge),"function"==typeof e&&(t=e,e={}),this.getSessionToken((function(r,i){var a=!1;if(r&&r.token){var s={params:e,sessionId:r.token};W(s,(function(e,r){e&&n.emit(o.ERROR,e),a=!!r&&!!r.adblockInfoList&&r.adblockInfoList.length>0,t(a,e)}))}else t(a,i)}))},t.prototype.createPrimeSubscriptionOrder=function(e,t){var n=this;void 0===t&&(t=ge);var r=e.code,i=e.cpsEmail,a=e.useForSubscription,s=void 0!==a&&a,l=be(e,["code","cpsEmail","useForSubscription"]);r?i?this.getSessionToken((function(e,a){if(e&&e.token){var c={params:{code:r,useForSubscription:s,paymentCpsEmail:i},sessionId:e.token};q(c,(function(e,a){if(e)return n.emit(o.ERROR,e),void t(null,e);var c=a.shopId,u=a.scId,d=a.orderNumber,p=a.requestSign,f=a.orderAmount,m=a.discountPrice,h=a.tax,y=a.publicName,v=a.publicDescription,b=a.publicPicture;!function(e,t,n){window.RamblerPayment=window.RamblerPayment||[],window.RamblerPayment.push((function(){var o=window.RamblerPayment.buildWidget("PaymentPopup",oe({lang:"ru"},e));void 0!==o&&o.then((function(e){return e.show(),e.initializeOrder(t).then((function(){var t,o=null;e.on("close",(function(){e.destroy(),n(o,t)})),e.on("fail",(function(){o=new Error("payment failed")})),e.on("success",(function(e){t=e}))}))})).catch((function(e){n(e)}))})),J("https://payment.rambler.ru/widget/sdk.js",(function(e){e&&n(e)}))}(l,{order:{shopId:c,scId:u,orderNumber:d,requestSign:p,orderAmount:f,cpsEmail:i,productName:r,paymentAddParams:{rebillingOn:s?1:0}},products:[{offer:{name:y,description:v,picture:b,price:m,tax:h,taxValue:0},count:1,total:{price:m,currencyId:"RUB"}}]},(function(e,r){e&&n.emit(o.ERROR,e),t(r,e)}))}))}else t(null,a)})):t(null,new Error("missing `cpsEmail` in params")):t(null,new Error("missing `code` of product in params"))},t.prototype.getSberIdUserInfo=function(e){void 0===e&&(e=ge),function(e){j("https://online.sberbank.ru/CSAFront/api/oidc/sbid?client_id=fbdea60d-1f60-425f-9917-d2fe53b2ac3f",(function(t,n){e(t,n&&JSON.parse(n))}),!0)}((function(t,n){e(n,t)}))},t.prototype.showSberIdNotificationBanner=function(e){var t=this;(function(){var e;return null!==(e=d(se))&&void 0!==e&&e})()||this.sberIdBanner||this.userSession||this.getSberIdUserInfo((function(n){if(n&&!t.sberIdBanner&&!t.userSession){var r=e.position,i=e.fontFamily,a=be(e,["position","fontFamily"]),s=(((null==n?void 0:n.firstname)||"")+" "+((null==n?void 0:n.surname)||"")).trim();t.sberIdBanner=new de({position:r,fontFamily:i,displayName:s}),t.sberIdBanner.attach();var l=function(){t.openProviderOAuth(ve(ve({},a),{action:"login",provider:"sberbank",provider_sso:Boolean(s)}))},c=function(){var e;null===(e=t.sberIdBanner)||void 0===e||e.destroy()},u=function(){var e,n;null===(e=t.sberIdBanner)||void 0===e||e.removeListener("click",l),null===(n=t.sberIdBanner)||void 0===n||n.removeListener("destroy",u),t.removeListener(o.LOGIN,c),t.removeListener(o.OAUTHLOGIN,c),delete t.sberIdBanner};t.sberIdBanner.addListener("click",l),t.sberIdBanner.addListener("destroy",u),t.addListener(o.LOGIN,c),t.addListener(o.OAUTHLOGIN,c)}}))},t.prototype.redirectToAuth=function(e){void 0===e&&(e={});var t=e.path,n=void 0===t?"/login-20/login":t,o=be(e,["path"]),r=V("https://id.rambler.ru"+n,ve(ve({back:window.location.href},o),!this.userSession&&{session:!1}));window.location.href=r},t.prototype.openAuth=function(e,t){var n=this;void 0===t&&(t=ge),function(e,t,n){var o,r=(t=null!==(o=Q({},t))&&void 0!==o?o:{}).container;delete t.container;var i=t.path,a=void 0===i?"/login-20/login":i,s=ee(t,["path"]),l=r instanceof HTMLElement?"embed":g?"popup":"iframe",c=window.location,u=c.href,d=c.protocol,p=c.host;s.back=u,s.param=l,s.iframeOrigin=d+"//"+p;var f=V("https://id.rambler.ru"+a,s),m=e,h=null;try{h=m instanceof HTMLIFrameElement?m.parentElement:null}catch(e){}"popup"!==l&&m instanceof HTMLIFrameElement&&(null==r||r instanceof HTMLElement&&r===h)?(te(m,n),m.src=f):"popup"===l?(m=window.open(f,"idFrame","status=1,toolbar=0,menubar=0,resizable=1,scrollbars=1,width=800px,height=700px,top=100px,left=100px"),n(null,m)):((m=document.createElement("iframe")).src=f,m.frameBorder="0",m.style.display="none",m.style.width="100%",m.style.height="100%",e=m,te(m,(function(){m instanceof HTMLIFrameElement&&(m.style.display="block"),n(null,m)})),r instanceof HTMLElement?r.setAttribute("data-id-frame","embed"):((r=document.createElement("div")).style.position="fixed",r.style.top="0px",r.style.left="0px",r.style.right="0px",r.style.bottom="0px",r.style.zIndex="-1",r.style.transform="translateY(-100vh)",r.style.opacity="0",r.style.transition="all 250ms",r.style.overflowY="auto",r.style.webkitOverflowScrolling="touch",r.setAttribute("data-id-frame","own")),r.appendChild(m),document.body&&null==r.parentElement&&document.body.appendChild(r))}(this.authFrame,ve(ve({},e),!this.userSession&&{session:!1}),(function(e,r){if(e&&n.emit(o.ERROR,e),r){n.authFrame=r;var i,a=n.authContainer;a instanceof HTMLElement&&("embed"===(i=a.getAttribute("data-id-frame"))&&n.addListener(o.RESIZE,n.resizeAuth),"own"===i&&(a.style.zIndex="10000",a.style.transform="translateY(0)",a.style.opacity="1",document.documentElement instanceof HTMLElement&&(document.documentElement.style.overflow="hidden"))),"embed"!==i&&(n.addListener(o.CLOSE,n.closeAuth),n.addListener(o.LOGIN,n.destroyAuth),n.addListener(o.OAUTHLOGIN,n.destroyAuth)),n.addListener(o.REDIRECT,n.redirect),t()}}))},t.prototype.openProviderOAuth=function(e){!function(e){var t,n,o,r,i,a,s,l=e.targetWindow,c=ee(e,["targetWindow"]);if(null!==(t=(c=Q({},c)).popup)&&void 0!==t||(c.popup=!0),null!==(n=c.on)&&void 0!==n||(c.on="login"),null!==(o=c.back)&&void 0!==o||(c.back=window.location.href),"popup"===c.param&&R){delete c.popup;var u=V("https://id.rambler.ru/oauth-20/",c);return window.location.href=u,void(null==l||l.close())}var d=V("https://id.rambler.ru/oauth-20/",c),p=null!==(i=null===(r=ne[c.provider])||void 0===r?void 0:r.height)&&void 0!==i?i:750,f=null!==(s=null===(a=ne[c.provider])||void 0===a?void 0:a.width)&&void 0!==s?s:450;if(l)return l.location.href=d,l.resizeTo(f,p),void l.focus();window.open(d,"oauthWindow","status=1,toolbar=0,menubar=0,resizable=1,scrollbars=1,width="+f+"px,height="+p+"px,top=100px,left=100px")}(e)},t.prototype.redirectToProviderOAuth=function(e){var t=V("https://id.rambler.ru/oauth-20/",ve({on:"login",back:window.location.href},e));window.location.href=t},t}(he),Ee=function(){if(Array.isArray(window[r])||!window[r]){var e=window[r]||[];window[r]=new Oe,e.forEach((function(e){return e()}))}};document.body?Ee():document.addEventListener("DOMContentLoaded",Ee,!1)}()}();
//# sourceMappingURL=auth_events.js.map