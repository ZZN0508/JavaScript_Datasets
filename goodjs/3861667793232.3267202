YUI.add("type_abu",function(o,e){var t,a=o&&o.Af&&o.Af.rapid,c=o&&o.VideoPlatform&&o.VideoPlatform.API_Events,i={rspns:"nav",elm:"hdln",itc:"0",pkgt:"111"},l={rspns:"nav",elm:"btn",itc:"0",pkgt:"111"},d={t3:"share",slk:"tumblr",elm:"btn",elmt:"sh-tbr",itc:"1",pkgt:"111"},m={t3:"share",slk:"facebook",elm:"btn",elmt:"sh-fb",itc:"1",pkgt:"111"},u={t3:"share",slk:"twitter",elm:"btn",elmt:"sh-tw",itc:"1",pkgt:"111"},E={t3:"share",slk:"mail",elm:"btn",elmt:"sh-eml",itc:"1",pkgt:"111"},A={t3:"ctrl",slk:"unmute",elm:"btn",elmt:"ctrl",itc:"1",pkgt:"111"},p={t3:"ctrl",slk:"full screen on",elm:"btn",elmt:"ctrl",itc:"1",pkgt:"111"},b={t3:"ctrl",slk:"custom-mute",elm:"btn",elmt:"ctrl",itc:"1",pkgt:"111"},f={t3:"ctrl",slk:"resize",elm:"btn",elmt:"ctrl",itc:"1",pkgt:"111"},g=1===o.Object.getValue(YUI,["Env","My","settings","context"]).videoAdBeaconsDisabled;o.Abu={init:function(){var c=this;o.Af.Event.on("video-manager:create_player_instance",function(e){var t,n,a,r,s=null;e&&c.getRapid()&&c.getRapidTracker()&&c.getVpApiEvents()&&(!e.player||(r=e.player,n=(a=e.playerNode)&&a.ancestor&&a.ancestor(".js-video-content"),r&&a&&n))&&(e.videoPlayer&&e.containerNode&&(r=e.videoPlayer,(e=e.containerNode)&&(n=e.one&&e.one(".js-video-content"),s=e.getData&&e.getData("videoBeacons"))),g&&(s={}),n&&r&&r.on&&(t=c.getBaseKeys(n))&&c.attachListeners(r,n,t,s))})},attachListeners:function(e,t,n,a){var r=this,s={};e.on&&e.on(c.UI_INTERACT,function(e){var t={};switch(e&&e.srcElement&&e.srcElement.toLowerCase()){case"startscreen":t=i;break;case"es-rpl":t=l;break;case"btn-sh-tumblr":t=d;break;case"btn-sh-fb":t=m;break;case"btn-sh-twitter":t=u;break;case"btn-sh-email":t=E;break;case"ctrl-mute-btn-off":t=A;break;default:return}t=o.merge(n,t),r.sendVideoBeacon(t)}),e.on(c.PLAYER_FULLSCREEN_CHANGE,function(e){var t;e&&(t=p,t=o.merge(n,t),r.sendVideoBeacon(t))}),(t=t.one(".ui-wrapper"))&&t.delegate&&(t.delegate("click",function(e){var t=b,t=o.merge(n,t);this.sendVideoBeacon(t)},".ui-mute-btn",r),t.delegate("click",function(e){var t=f,t=o.merge(n,t);this.sendVideoBeacon(t)},".ui-expand-btn",r)),a&&(e.on(c.PLAYBACK_START,function(){r.sendAdBeacon("VIDEO_START",a,s)}),e.on(c.PLAYBACK_TIME_UPDATE,function(e,t,n){3<t&&!s.VIDEO_VIEW&&r.sendAdBeacon("VIDEO_VIEW",a,s),30<t&&!s.VIDEO_30_SEC&&r.sendAdBeacon("VIDEO_30_SEC",a,s),.25*n<t&&!s.VIDEO_QUARTILE_25&&r.sendAdBeacon("VIDEO_QUARTILE_25",a,s),.5*n<t&&!s.VIDEO_QUARTILE_50&&r.sendAdBeacon("VIDEO_QUARTILE_50",a,s),.75*n<t&&!s.VIDEO_QUARTILE_75&&r.sendAdBeacon("VIDEO_QUARTILE_75",a,s)}),e.on(c.PLAYBACK_COMPLETE,function(){r.sendAdBeacon("VIDEO_QUARTILE_100",a,s),s={}}))},getBaseKeys:function(e){var t,n;return e&&e.getDOMNode()?("strm"===(t=a.parseYLK&&a.parseYLK(e)).t2&&(n=(n=e.ancestor(".js-stream-content"))&&n.one(".js-stream-item-title"),t.sec=t.t2,t.aid=t.g,t.slk=n&&n.getHTML()||"stream video",e.ancestor(".js-stream-featured-ad")&&(t.sp=1)),t):null},sendVideoBeacon:function(e){t.beaconClick&&t.beaconClick(e.sec,e.slk,parseInt(e.cpos,10),e)},sendAdBeacon:function(e,t,n){var a,r,s;if(e&&!n[e]&&(a=t&&t[e]))for(a=[].concat(a),r=0;r<a.length;r++)(s=a[r])&&(o.Af.Beacon.send(s),n[e]=!0)},getVpApiEvents:function(){return c=c||o.VideoPlatform&&o.VideoPlatform.API_Events},getRapid:function(){return a=a||o.Af.rapid},getRapidTracker:function(){var e=this.getRapid();return t=e.getRapidTracker()}},o.Abu.init()},"0.0.1",{requires:[]});
