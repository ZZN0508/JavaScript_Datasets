(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"7PXg":function(e,t,n){"use strict";n.d(t,"d",function(){return a}),n.d(t,"e",function(){return r}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"a",function(){return c});var t=n("Dcbp"),s=n.n(t),i=s.a.timelineMasonryPostWidth+s.a.timelineMasonryPostSpacing,a=[2*i,3*i,4*i],o=s.a.sidebarWidth+s.a.sidebarMargin,r=a.map(e=>e+o),l=(e,t)=>u(e,!!t),d=e=>u(e,!0),u=(e,t)=>Math.min(2+a.length-1,Math.max(Math.floor((e-(t?o:0))/i),1)),c=(e,t)=>p(e-(t?o:0),l(e,t)-2),p=(e,t)=>t<0?e:a[t]-s.a.timelineMasonryPostSpacing},PreC:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var t=n("pVnL"),s=n.n(t),t=n("lSNA"),i=n.n(t),t=n("mVx/"),a=n.n(t),t=n("q1tI"),o=n.n(t),r=n("4S20");class l extends t.Component{constructor(){super(...arguments),i()(this,"getMatchingBreakpoint",(t,e)=>a()(e,e=>e<=t)),i()(this,"matchedBreakpoint",this.getMatchingBreakpoint(this.props.width,this.props.breakpoints))}shouldComponentUpdate(e){var t=e.width,n=e.breakpoints,e=e.children,n=this.getMatchingBreakpoint(t,n),e=n!==this.matchedBreakpoint||this.props.children!==e;return e&&(this.matchedBreakpoint=n),e}render(){return this.props.children(this.props.width)}}function d(t){return t.width?o.a.createElement(l,t):o.a.createElement(r.b,null,e=>{e=e.width;return o.a.createElement(l,s()({},t,{width:e}))})}},QQ7b:function(e,t,n){"use strict";n.d(t,"b",function(){return g});var u,s=n("Y3SK"),l=n.n(s),i=n("lSNA"),a=n.n(i),o=n("mwIZ"),d=n.n(o),s=n("q1tI"),r=n.n(s),c=n("EilA"),i=n("Dcbp"),o=n.n(i),p=n("pCNn"),i=n("o56e"),h=n("X+AN"),m=n("Qtnd");(n=u=u||{}).Next="next";var b={canFastQueue:!(n.Previous="previous"),canFastReblog:!1,canFastReblogDeprecated:!1},g=-(o.a.desktopHeaderHeightPx+o.a.marginBetweenPosts);class f extends s.Component{constructor(e){super(e),a()(this,"apiHelper",Object(m.a)(this.props.appContext.apiFetch)),a()(this,"blogs",[]),a()(this,"getBlogs",()=>this.blogs),a()(this,"setDefaultFastBlog",n=>{this.blogs.sort((e,t)=>t.name===n.name?1:e.name===n.name?-1:0)}),a()(this,"renderScrollPositionDependentHotkeys",()=>r.a.createElement(c.c,{hotkey:[{key:c.b.J,command:this.scrollToNextElement},{key:c.b.K,command:this.scrollToPreviousElement},{key:c.b.L,command:this.likeVisibleTimelineObject},{key:c.b.R,command:this.reblogVisibleTimelineObject,modifiers:{[c.a.Alt]:!0}},{key:c.b.Q,command:this.queueVisibleTimelineObject,modifiers:{[c.a.Alt]:!0}}]})),a()(this,"enableFastReblog",()=>!this.state.canFastReblog&&this.setState({canFastReblog:!0})),a()(this,"disableFastReblog",()=>this.state.canFastReblog&&this.setState({canFastReblog:!1})),a()(this,"enableFastReblogDeprecated",()=>!this.state.canFastReblogDeprecated&&this.setState({canFastReblogDeprecated:!0})),a()(this,"disableFastReblogDeprecated",()=>this.state.canFastReblogDeprecated&&this.setState({canFastReblogDeprecated:!1})),a()(this,"enableFastQueue",()=>!this.state.canFastQueue&&this.setState({canFastQueue:!0})),a()(this,"disableFastQueue",()=>this.state.canFastQueue&&this.setState({canFastQueue:!1})),a()(this,"isValidElement",e=>!(null==e||!e.ref)),a()(this,"scrollToNextElement",()=>{this.scrollToElement(u.Next)}),a()(this,"scrollToPreviousElement",()=>{this.scrollToElement(u.Previous)}),a()(this,"scrollToElement",e=>{var t=this.props,n=t.scrollContainer,t=t.getPostRefs,s=n||window,t=[...t()];e===u.Previous&&t.reverse();for(var i=n?n.scrollTop:window.scrollY,a=0,o=t;a<o.length;a++){var r=o[a];if(this.isValidElement(r)){var l=r.ref,r=void 0!==(null==(d=l.offsetParent)?void 0:d.offsetTop)?l.offsetParent.offsetTop:0,d=n?l.offsetTop+r:l.offsetTop,r=i-d;if(e===u.Next?Math.round(r)<g:Math.floor(r)>g)return l.focus({preventScroll:!0}),void s.scrollTo({left:0,top:d+g})}}e===u.Next&&(t=(n||document.body).scrollHeight,s.scrollTo({left:0,top:t}))}),a()(this,"scrollToTop",()=>(this.props.scrollContainer||window).scrollTo({behavior:"smooth",left:0,top:0})),a()(this,"likeVisibleTimelineObject",()=>{var e=this.getVisibleTimelineObject().props.timelineObject,t=e.liked,n=e.id,s=e.reblogKey,i=e.placementId,a=e.earnedId,o=this.props,e=o.timelineContext,o=o.appContext.logEvent;this.apiHelper.likePost({id:n,liked:t,reblogKey:s,placementId:i,earnedId:a,logEvent:o,onLikeCallback:e.onLike}).fetch()}),a()(this,"reblogVisibleTimelineObject",()=>this.postVisibleTimelineObject(p.l.Published,this.props.appContext._t("Reblogged!"))),a()(this,"queueVisibleTimelineObject",()=>this.postVisibleTimelineObject(p.l.Queue,this.props.appContext._t("Queued!"))),a()(this,"postVisibleTimelineObject",(a,o)=>{var r=this.getVisibleTimelineObject().props.timelineObject.placementId,e=this.props,t=e.appContext,n=t.getUserInfo,s=t._c,l=t.logEvent,d=e.toastContext.toggleToast,u=this.getVisibleTimelineObject().props.timelineObject;return n().then(e=>{var t=e.name,n=u.blog,s=u.id,i=u.reblogKey,e=u.earnedId;return this.apiHelper.postAPost({selectedBlogName:t,placementId:r,logEvent:l,post:{reblogKey:i,earnedId:e,content:[],state:a,parentTumblelogUuid:n.name,parentPostId:s,id:void 0}}).fetch(()=>(this.setState({fastRebloggedPosts:this.state.fastRebloggedPosts.concat([u.id])}),d(o)))}).catch(()=>d(s("Failed to do action","Failed")))}),a()(this,"getVisibleTimelineObject",()=>{var e,t=this.props.scrollContainer,n=this.props.getPostRefs(),s=t?t.scrollTop:window.scrollY,i=l()(n);try{for(i.s();!(e=i.n()).done;){var a=e.value;if(this.isValidElement(a)){var o=a.ref,r=t?o.offsetTop+d()(o.offsetParent,"offsetTop",0):o.offsetTop;if(Math.round(s-r)<o.clientHeight+g)return a}}}catch(e){i.e(e)}finally{i.f()}}),a()(this,"unsetCanFastAction",()=>this.setState(b)),this.state={canFastReblog:!1,canFastQueue:!1,canFastReblogDeprecated:!1,fastRebloggedPosts:[],setDefaultFastBlog:this.setDefaultFastBlog,getBlogs:this.getBlogs}}componentDidMount(){return window.addEventListener("blur",this.unsetCanFastAction),this.props.appContext.getUserInfo().then(e=>{e=e.blogs;this.blogs=[...void 0===e?[]:e]})}componentWillUnmount(){window.removeEventListener("blur",this.unsetCanFastAction)}render(){var e=this.props,t=e.disabled,n=e.children,s=this.state,i=s.canFastReblog,e=s.canFastQueue,s=s.canFastReblogDeprecated;return r.a.createElement(r.a.Fragment,null,!t&&this.renderScrollPositionDependentHotkeys(),s&&r.a.createElement(c.c,{hotkey:{key:c.b.Alt,command:this.disableFastReblogDeprecated,firesOnKeyUp:!0}}),i&&r.a.createElement(c.c,{hotkey:{key:c.b.E,command:this.disableFastReblog,firesOnKeyUp:!0}}),e&&r.a.createElement(c.c,{hotkey:{key:c.b.W,command:this.disableFastQueue,firesOnKeyUp:!0}}),r.a.createElement(c.c,{hotkey:[{key:c.b.Dot,command:this.scrollToTop},{key:c.b.Alt,modifiers:{[c.a.Alt]:!0},command:this.enableFastReblogDeprecated},{key:c.b.E,command:this.enableFastReblog},{key:c.b.W,command:this.enableFastQueue}]}),r.a.createElement(h.b.Provider,{value:this.state},n))}}t.a=Object(i.b)(f,{appContext:!0,toastContext:!0,timelineContext:!0})},TqU9:function(e,t,n){"use strict";function i(e){var t=e.width,n=void 0===(o=e.margins)?0:o,s=e.maximumNumberOfColumns,i=e.getNumberOfColumns,a=e.masonryProps,o=a.columnWidth,e=a.columnSpacing,e=Math.min(isNaN(Number(s))?100:Number(s),(null==i?void 0:i(t))||Math.floor((t-2*n)/(o+e)));return t?k.a.createElement(w.a,x()({},a,{numberOfColumns:e})):null}function p(e){var t=e.masonryProps,n=e.masonryRendersWithSidebar,s=e.maximumNumberOfColumns,e=Object(l.useCallback)(e=>k.a.createElement(i,{width:e,masonryProps:c()(c()({},t),{},{columnWidth:B.a.timelineMasonryPostWidth,columnSpacing:B.a.timelineMasonryPostSpacing,elementSpacing:B.a.timelineMasonryPostSpacing}),getNumberOfColumns:n?M.c:M.b,maximumNumberOfColumns:s}),[t]);return k.a.createElement(L.a,{breakpoints:n?M.e:M.d},e)}var s=n("pVnL"),x=n.n(s),a=n("3tO9"),c=n.n(a),s=n("lSNA"),o=n.n(s),a=n("ijCd"),C=n.n(a),s=n("44Ds"),r=n.n(s),a=n("UfWW"),d=n.n(a),s=n("k8Y/"),h=n.n(s),a=n("k4Da"),m=n.n(a),s=n("vN+2"),b=n.n(s),a=n("BkRI"),g=n.n(a),l=n("q1tI"),k=n.n(l),u=n("Wwog"),y=n("uaYK"),O=n("kmkp"),E=n("fMdv"),f=n("rqSm"),R=n("s5E+"),v=n("pCNn"),s=n("K8ph"),P=n.n(s),T=n("X+AN"),S=n("yBJ7"),j=n("QQ7b"),a=n("bt0A"),N=n.n(a),F=n("Qtnd"),s=n("o56e"),I=n("gf0f"),w=n("tEbF"),L=n("PreC"),M=n("7PXg"),a=n("Dcbp"),B=n.n(a),Q=n("Jq/n"),A=n("q+ed"),D=n("M3r2"),q=n("g2Yl"),V=n("onkD"),U=n("kItG"),W=n("GMtE");class G extends l.Component{constructor(){var i;super(...arguments),i=this,o()(this,"state",{isSorting:!1}),o()(this,"postRefs",this.props.forwardedPostRefs||[]),o()(this,"apiHelper",Object(F.a)(this.props.appContext.apiFetch)),o()(this,"getTimelineContextValue",Object(u.a)(()=>({onLike:this.onLike,onFollow:this.onFollow,onNotesUpdate:this.onNotesUpdate,onQueueReorder:this.onQueueReorder,onRemoveTimelineObject:this.onRemoveTimelineObject,onPin:this.onPin,onPromote:this.onPromote,onEditTimelineObject:this.onEdit}))),o()(this,"getLoader",r()(e=>k.a.createElement("div",{className:W.a.loader},k.a.createElement(S.b,{centerOrientation:S.a.Horizontal,color:e})))),o()(this,"getEmptyView",r()(e=>k.a.createElement("div",{className:Object(Q.a)({[W.a.noContent]:!0,[W.a.masonryEmptyView]:e===R.f.Masonry})},this.props.appContext._c("String to show when there are no posts in a timeline (e.g., no likes on /likes, no results for /tagged/atagnoonehasused).","No posts available.")))),o()(this,"renderTimelineElements",e=>{var t=e.objects,n=e.refresh,s=e.transformObjects,i=this.props,a=i.displayMode,o=i.isQueue,r=i.maximumNumberOfColumns,l=i.masonryRendersWithSidebar,e=i.setRefreshCallback,d=i.isElementPinnedToMasonryUpperRight;this.transformObjects=s,null==e||e(n);var u=[],n=t.map((e,t)=>(null!=d&&d(e)&&u.push(t),this.renderElement(e,t)));if(a===R.f.Masonry)return k.a.createElement(p,{masonryProps:{pinnedToUpperRightIndexes:u,children:n},maximumNumberOfColumns:r,masonryRendersWithSidebar:l});if(o){var c=k.a.createElement(T.a.Provider,{value:this.getQueueContext(t)},n);return k.a.createElement(D.a,null,e=>e.isMobile?c:k.a.createElement(P.a,{className:"sortableContainer",options:{animation:150,onStart:this.onQueueSortStart,onEnd:this.onQueueSortEnd,draggable:".".concat(U.a.sortDragDropTarget),handle:".".concat(V.a.reorderButton),forceFallback:!0},onChange:b.a},c))}return k.a.createElement("div",{className:a===R.f.Grid?W.a.gridded:null},n)}),o()(this,"renderElement",(e,t)=>{var n="".concat(e.placementId?"".concat(e.placementId,":"):"").concat(e.id).concat(e.isExpandedInGrid?":expanded":"");return k.a.createElement(f.a,{ref:e=>this.postRefs[t]=e,key:n,presentationStyle:this.props.overridePresentationStyle,timelineObject:c()({},e),displayMode:this.props.displayMode,toggleExpandedInGrid:this.toggleExpandedInGrid})}),o()(this,"getManualPaginatorButtonCSS",()=>{var e=this.props,t=e.displayMode,e=e.manualPaginatorButtonCss,t=t===R.f.Grid?W.a.manualPaginatorButtonsGrid:null;return c()(c()({},e),{},{containerClassName:t})}),o()(this,"apiQueueSort",(e,t)=>{var n=e.blogName,s=e.id,i=e.insertAfter,a=e.oldIndex;return n?this.apiHelper.queueReorder(n,s,i).fetch().catch(()=>t(s,a)):(t(s,a),Promise.reject())}),o()(this,"onQueueSortStart",()=>{this.setState({isSorting:!0})}),o()(this,"onQueueSortEnd",e=>{this.setState({isSorting:!1});e=this.getSortParameters(e);this.onQueueReorder(e.id,e.newIndex),this.apiQueueSort(c()({},e),this.onQueueReorder)}),o()(this,"onLike",(t,n)=>{this.transformObjects(e=>e.map(e=>{if(!Object(R.A)(e)||e.id!==t)return e;e=Object(A.b)(e,n);return this.maybeUpdateDockedPost(e),e}))}),o()(this,"onEdit",t=>{this.transformObjects(e=>e.map(e=>Object(R.A)(e)&&e.id===t.id?t:e))}),o()(this,"onPin",(t,n)=>{this.transformObjects(e=>e.map(e=>Object(R.A)(e)?e.id!==t?n&&e.isPinned?c()(c()({},e),{},{isPinned:!1}):e:c()(c()({},e),{},{isPinned:n}):e))}),o()(this,"onFollow",function(n){var s=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];i.transformObjects(e=>e.map(e=>{if(Object(R.A)(e)){var t=Object(A.a)(e,n,s);return i.maybeUpdateDockedPost(t),t}return e}))}),o()(this,"onNotesUpdate",(t,n)=>{this.transformObjects(e=>e.map(e=>{if(!Object(R.A)(e)||e.id!==t)return e;e=Object(A.c)(e,n);return this.maybeUpdateDockedPost(e),e}))}),o()(this,"onPromote",(n,s)=>{this.transformObjects(e=>e.map(e=>{if(Object(R.A)(e)&&e.id===n){var t=Object(A.d)(e,s);return this.maybeUpdateDockedPost(t),t}return e}))}),o()(this,"onQueueReorder",(i,a)=>{this.transformObjects(e=>{var t=e.find(e=>e.id===i);if(void 0===t)return e;var n=m()(e,e=>v.l.Queued===e.state&&v.i.Scheduled===e.queuedState),e=m()(e,e=>v.l.Queued===e.state&&v.i.Queued===e.queuedState),s=e.map((e,t)=>e.scheduledPublishTime),t=e.indexOf(t),e=[...e];return e.splice(a,0,e.splice(t,1)[0]),h()([...n,...e.map((e,t)=>(e.scheduledPublishTime=s[t],e))],e=>e.scheduledPublishTime)})}),o()(this,"onRemoveTimelineObject",e=>{var i,a,o,r,l=e.id,t=e.wasBlogUnfollowed,n=this.props,d=n.isQueue,s=n.displayMode,e=n.doesNotRemoveUnfollowedObjects,u=n.postCountContext.refreshCounts;return e&&t?b.a:(s===R.f.Grid&&(s=Object(f.b)(),this.toggleExpandedInGrid({id:l,hasExpandedVersionBelowIt:!0},s)),this.transformObjects(e=>{a=[...e];var n,t,s=e.find(e=>e.id===l);return void 0===s||(i=e.indexOf(s),r=Object(R.A)(s),(o=[...e]).splice(i,1),r&&d&&s.state===v.l.Queued&&s.queuedState===v.i.Queued&&(n=m()(e,e=>e.state===v.l.Queued&&e.queuedState===v.i.Queued).map((e,t)=>e.scheduledPublishTime),t=m()(o,e=>e.state===v.l.Queued&&e.queuedState===v.i.Scheduled),s=m()(o,e=>e.state===v.l.Queued&&e.queuedState===v.i.Queued),o=h()([...t,...s.map((e,t)=>(e.scheduledPublishTime=n[t],e))],e=>e.scheduledPublishTime)),e[i].animateOut=!0),e}),setTimeout(()=>{this.transformObjects(e=>o),u(),this.postRefs.pop()},N.a.postSlideOutDurationInMs),()=>this.transformObjects(()=>a))}),o()(this,"toggleExpandedInGrid",(d,u)=>{this.props.displayMode===R.f.Grid&&this.transformObjects(e=>{var t=e.findIndex(e=>e.id===d.id);if(-1===t)return e;for(var n=0,s=0;s<e.length&&!(t<=s);s+=1)e[s].isExpandedInGrid&&(n+=1);for(var i=u-(t+n*(u-1))%u,a=t+i,o=t-(u-i);o<a;o+=1){var r=c()({},e[o]);delete r.hasExpandedVersionBelowIt,e[o]=r}var l=e[a]&&e[a].isExpandedInGrid?a+1:a;if(d.hasExpandedVersionBelowIt)return[...e.slice(0,a),...e.slice(l,e.length)];i=c()(c()({},g()(d)),{},{isExpandedInGrid:!0}),l=[...e.slice(0,a),i,...e.slice(l,e.length)];return l[t]=c()(c()({},l[t]),{},{hasExpandedVersionBelowIt:!0}),l})}),o()(this,"getPostRefs",()=>this.postRefs)}componentDidMount(){var e,t;null===(e=(t=this.props.dockableContext).updateDockManagerState)||void 0===e||e.call(t,{timelineContext:this.getTimelineContextValue()})}componentDidUpdate(e){e.displayMode!==this.props.displayMode&&(e={[R.f.Grid]:q.b.TimelineDisplayModeToggleGrid,[R.f.List]:q.b.TimelineDisplayModeToggleList,[R.f.Masonry]:q.b.TimelineDisplayModeToggleMasonry}[this.props.displayMode],this.props.appContext.logEvent({eventName:e}))}render(){var e=this.state.isSorting,t=this.props,n=t.debug,s=t.displayMode,i=t.onPagination,a=t.onPaginationError,o=t.hidesPullToRefresh,r=t.getNextLink,l=t.endpointApiRequest,d=t.getInitialPage,u=t.isObjectOmittedFromRender,c=t.getObjectsFromResponse,p=t.knightRiderLoaderColor,h=t.scrollContainer,m=t.emptyView,b=t.errorView,g=t.isQueue,f=t.prevButtonIsRefresh,v=t.getPrevLink,P=t.updateUrlFromCurrentPageLink,t=t.appContext.endlessScrollingDisabled,m={debug:n,endpointApiRequest:l,scrollContainer:h,errorView:b,onPagination:i,onPaginationError:a,getNextLink:r,getInitialPage:d,getObjectsFromResponse:c,isObjectOmittedFromRender:u,updateUrlFromCurrentPageLink:P,loader:this.getLoader(p),pullToRefresh:!o,lockScrollOnObjectUpdate:g,emptyView:m||this.getEmptyView(s),children:this.renderTimelineElements};return k.a.createElement(I.a.Provider,{value:this.getTimelineContextValue()},k.a.createElement("div",{className:Object(Q.a)({[W.a.timeline]:!0,[W.a.isSorting]:e,[W.a.masonry]:s===R.f.Masonry})},k.a.createElement(j.a,{disabled:C()([R.f.Grid,R.f.Masonry],s),scrollContainer:h&&Object(E.d)(h)?h:void 0,getPostRefs:this.getPostRefs},t?k.a.createElement(O.a,x()({},m,{getPrevLink:v,prevButtonIsRefresh:f,manualPaginatorButtonCss:this.getManualPaginatorButtonCSS()})):k.a.createElement(y.a,x()({},m,{fetchDistance:1600})))))}getQueueContext(e){return{allPosts:e.map(e=>e.id),queuedPosts:m()(e,e=>v.l.Queued===e.state&&v.i.Queued===e.queuedState).map(e=>e.id)}}getSortParameters(s){var i,a,o,r,l=s.item.dataset.id;return this.transformObjects(t=>{var e=m()(t,e=>v.l.Queued===e.state&&v.i.Queued===e.queuedState).map(e=>e.id),n=t.find(e=>e.id===l);return i=null==n?void 0:n.blogName,r=d()(e,e=>t[s.oldIndex].id===e),o=d()(e,e=>t[s.newIndex].id===e),a=t[s.newIndex-1]&&t[s.newIndex-1].id||0,t}),{blogName:i,id:l,insertAfter:a,oldIndex:r,newIndex:o}}maybeUpdateDockedPost(e){var t=this.props.dockableContext,n=t.isMediaDocked,s=t.dockedTimelineObject,t=t.updateDockManagerState;n&&e.id===(null==s?void 0:s.id)&&t({dockedTimelineObject:e})}}o()(G,"defaultProps",{hidesPullToRefresh:!1,displayMode:R.f.List,errorView:null,getNextLink:e=>{var t,n,s;return null==e||null===(t=e.response)||void 0===t||null===(n=t.timeline)||void 0===n||null===(s=n.links)||void 0===s?void 0:s.next}});var H=Object(s.b)(G,{appContext:!0,postCountContext:!0,dockableContext:!0});class K extends l.Component{render(){return k.a.createElement(H,this.props)}}o()(K,"defaultProps",G.defaultProps),t.a=K},kmkp:function(e,t,n){"use strict";var s=n("pVnL"),i=n.n(s),a=n("3tO9"),p=n.n(a),o=n("lSNA"),r=n.n(o),l=n("ijCd"),d=n.n(l),u=n("q1tI"),h=n.n(u),c=n("fMdv"),s=n("SPbr"),m=n("zoQI"),b=n("78v1"),g=n("4S20"),f=n("EilA"),v=n("Jq/n"),a=n("wzEd"),o=n("o56e"),l=n("fSeh"),P=n.n(l),l=n("Dcbp"),x=n.n(l),C=n("mTBy"),k={width:13,height:13},y={href:"DON'T FETCH ME! OH GUY, PLEASE DON'T FETCH ME!"},O={prevNextLinks:[],linkForCurrentPage:y};class E extends s.a{constructor(){super(...arguments),r()(this,"addObjectsToExisting",this.props.getObjectsFromResponse),r()(this,"shouldRenderMainLoader",()=>{var e=this.state,t=e.hasFetchedInitialPage,e=e.loadingNextPage;return!t||e}),r()(this,"preHandleContentFetch",e=>{var t=this.props.updateUrlFromCurrentPageLink,n=this.state.linkForCurrentPage;switch(e){case c.b.Initial:return;case c.b.Refresh:return void(null==t||t());case c.b.Pagination:return void(null==t||t(null==n?void 0:n.href))}}),r()(this,"getHotkeyCommands",()=>{var e=this.state,t=e.prevNextLinks,n=e.nextLink,e=[];return 0!==t.length&&e.push({key:f.b.Left,command:this.onClickPrevious}),n&&e.push({key:f.b.Right,command:this.onClickNext}),e}),r()(this,"renderPaginationButtons",e=>{var t=this.state,n=t.prevNextLinks,s=t.nextLink,i=this.props,a=i.prevButtonIsRefresh,o=i.manualPaginatorButtonCss,r=(o=void 0===o?{}:o).containerClassName,l=o.prevButtonStyle,d=o.nextButtonStyle,u=i.appContext._c,c=u("The label for a button to return to the previous page of results","Previous"),t=u("The label for a button to refresh the contents of a set of posts to show the newest content in it","Latest"),o=u("The label for a button to go to the next page of results","Next"),i=!!n.length,u=i?this.onClickPrevious:this.refresh,n=i?c:t,t=i?{color:P.a.paletteWhite,background:P.a.paletteTransparentWhite65}:{color:P.a.paletteTransparentWhite87,background:"transparent",border:"2px solid ".concat(P.a.paletteTransparentWhite87)};return h.a.createElement("div",{ref:this.setButtonContainerRef,className:Object(v.a)([C.a.manualPaginatorButtons,r])},h.a.createElement(f.c,{hotkey:this.getHotkeyCommands()}),(i||a)&&h.a.createElement(m.a,{label:c,wrapperClassName:Object(v.a)([C.a.manualPaginatorButton,C.a.prev]),wrapperStyle:p()(p()({},t),l),className:C.a.manualPaginatorButtonInner,onClick:u},h.a.createElement(b.d,{size:k,fill:(null==l?void 0:l.color)||t.color}),n),!!s&&h.a.createElement(m.a,{label:o,wrapperClassName:Object(v.a)([C.a.manualPaginatorButton,C.a.next]),wrapperStyle:p()({color:P.a.paletteWhite,background:P.a.paletteAccent},this.getNextButtonStyle(e)),className:C.a.manualPaginatorButtonInner,onClick:this.onClickNext},o,h.a.createElement(b.a,{size:k,fill:d&&d.color||P.a.paletteWhite})))}),r()(this,"onClickPrevious",()=>{var e=this.state,t=e.prevNextLinks,n=e.firstPageInfo,s=e.linkForCurrentPage,i=this.props.updateUrlFromCurrentPageLink,a=t.pop();if(!this.canFetchNextPage(a))return Promise.resolve();if(a===y&&n){e=n.endpointApiRequest,n=n.objects;return this.nextPageApiRequest=e,null==i||i(e.getSearchParams(),!0),this.setState(p()(p()({},O),{},{objects:n,nextLink:s}),this.scrollToBottom),Promise.resolve()}return this.scrollToTop(),new Promise(e=>{this.setState({prevNextLinks:t,objects:[],linkForCurrentPage:a},e)}).then(()=>this.fetchNextPage(a)).then(()=>this.scrollToBottom())}),r()(this,"onClickNext",()=>{var e=this.state,t=e.prevNextLinks,n=e.linkForCurrentPage,s=e.nextLink,i=e.objects,a=this.props.endpointApiRequest;return this.canFetchNextPage(s)&&a?(this.scrollToTop(),new Promise(e=>{this.setState(p()({objects:[],prevNextLinks:[...t,n],linkForCurrentPage:s},n===y&&{firstPageInfo:{objects:i,endpointApiRequest:a}}),e)}).then(()=>this.fetchNextPage())):Promise.resolve()}),r()(this,"setButtonContainerRef",e=>this.setState({buttonsContainerRef:e})),r()(this,"getNextButtonStyle",e=>{var t=this.props,n=t.manualPaginatorButtonCss,s=(n=void 0===n?{}:n).doNotAccountForLowerRightContent,n=n.nextButtonStyle,t=t.messagingContext.offsetToAvoidLowerRightContentPx;if(s)return n;s=this.state.buttonsContainerRef,s=s&&e?e-s.getBoundingClientRect().right:0;return p()(p()({},n),{},{transform:"translateX(-".concat(s<t?t-s+x.a.lowerRightContentEdgeMarginPx:0,"px)")})})}render(){var e=this.props.manualPaginatorButtonCss,e=(e=void 0===e?{}:e).doNotAccountForLowerRightContent;return h.a.createElement(h.a.Fragment,null,super.render(),!this.shouldRenderMainLoader()&&(e?this.renderPaginationButtons():h.a.createElement(g.b,null,e=>{e=e.bodyWidth;return this.renderPaginationButtons(e)})))}getEmptyInitialState(){var e,t,n=null===(e=(t=this.props).getInitialPage)||void 0===e||null===(n=e.call(t))||void 0===n?void 0:n.prevLink;return p()(p()(p()({},super.getEmptyInitialState()),O),n&&{prevNextLinks:[n]})}didChangeEndpoint(e){var t=super.didChangeEndpoint(e)&&(!this.nextPageApiRequest||!(null!==(t=this.props.endpointApiRequest)&&void 0!==t&&t.isEqualTo(this.nextPageApiRequest)));return t&&(this.nextPageApiRequest=null),t}getFetchNextPageRequest(e){return this.nextPageApiRequest=super.getFetchNextPageRequest(e),this.nextPageApiRequest}onPagination(e){super.onPagination(e);var t=e.requestType,n=e.response,e=this.props.getPrevLink,s=null==e?void 0:e(n);this.setState(e=>p()(p()({},d()([c.b.Initial,c.b.Refresh],t)?O:e),!!s&&{prevNextLinks:[s]}))}}r()(E,"defaultProps",p()({},s.b));var R=Object(o.c)(E,{appContext:!0,messagingContext:!0});Object(a.a)(R,"Inner".concat(R.name));class T extends u.Component{render(){return h.a.createElement(R,i()({},this.props,{ref:this.props.forwardedRef}))}}t.a=T},tEbF:function(e,t,n){"use strict";function s(e){var t=e.columns,n=e.columnWidth,s=void 0===(i=e.elementSpacing)?5:i,i=void 0===(i=e.columnSpacing)?s:i,a=e.elementContainerClass,e=e.numberOfColumns,o={width:n?"".concat(n,"px"):"".concat(100/e,"%"),maxWidth:n?"".concat(n,"px"):void 0},r=d()(d()({},o),{},{marginLeft:i}),l={marginTop:s};return h.a.createElement("div",{className:m.a.masonry},t.map((e,s)=>h.a.createElement("div",{key:"column-".concat(s),className:m.a.column,style:0<s?r:o},e.map((e,t)=>{var n=e.element,e=e.tabIndex;return h.a.createElement("div",{tabIndex:e,key:"".concat(s,"-").concat(t),className:a,style:0<t?l:void 0},n)}))))}var i=n("pVnL"),a=n.n(i),i=n("3tO9"),d=n.n(i),i=n("SA+Z"),r=n.n(i),i=n("lSNA"),o=n.n(i),i=n("Qcb2"),l=n.n(i),i=n("Y+p1"),u=n.n(i),i=n("UrOp"),c=n.n(i),p=n("q1tI"),h=n.n(p),m=n("gjv3"),b=e=>{for(var t=e.fromChildren,s=e.numberOfColumns,n=e.offset,i=void 0===n?0:n,e=e.pinnedToUpperRightIndexes,e=void 0===e?[]:e,a=[],o=0;o<s;o+=1)a.push([]);var r=[...t];return e.map((e,t)=>{var n=r[e];r.splice(e,1),r.splice((t+1)*s-1,0,n)}),r.forEach((e,t)=>{a[t%s].push({element:e,tabIndex:t+i})}),a};class g extends p.Component{constructor(){super(...arguments),o()(this,"state",{objectsToLayOut:[],columns:b({fromChildren:p.Children.toArray(this.props.children),numberOfColumns:this.props.numberOfColumns,pinnedToUpperRightIndexes:this.props.pinnedToUpperRightIndexes})}),o()(this,"columnSpacerRefs",[]),o()(this,"addNextObjectToLayOutToColumn",(e,t)=>{var n,s,i,a=this.state.objectsToLayOut,o=p.Children.count(this.props.children);a.length?t<0||(n=(i=r()(a))[0],s=i.slice(1),(i=[...e])[t].push({element:n,tabIndex:o-a.length}),this.setState({columns:i,objectsToLayOut:s})):this.state.columns!==e&&this.setState({columns:e})}),o()(this,"naivelyLayOutObjects",(e,t,n,s)=>{for(var i=[...t],a=this.props.numberOfColumns,o=b({numberOfColumns:a,fromChildren:e,offset:s}),r=Math.max(n,0),l=0;l<a;l+=1){var d=(l+r)%a;i[d]=[...i[d],...o[l]]}return i}),o()(this,"columnsWithoutRemovedChildren",(e,t)=>e.map(e=>e.filter(e=>{e=e.element;return Object(p.isValidElement)(e)&&e.key&&t.indexOf(e.key)<0}))),o()(this,"updateColumnsWithNewProps",(e,s)=>{if(!s.length)return e;var i=s.map(e=>e.key);return e.map(e=>e.map(e=>{var t=e.element,n=e.tabIndex;if(0<=i.indexOf(t.key)){e=s.find(e=>e.key===t.key);if(e)return{tabIndex:n,element:e}}return{element:t,tabIndex:n}}))})}componentDidUpdate(e){var t=this.props,n=t.numberOfColumns,s=t.children,i=t.pinnedToUpperRightIndexes;n===e.numberOfColumns&&0===l()(i,e.pinnedToUpperRightIndexes).length?(t=p.Children.toArray(this.props.children),e=p.Children.toArray(e.children),this.makeLayoutPass(t,e)):this.setState({columns:b({numberOfColumns:n,pinnedToUpperRightIndexes:i,fromChildren:p.Children.toArray(s)}),objectsToLayOut:[]})}render(){var e=this.state.columns.reduce((e,t,n)=>[...e,[...t,{element:h.a.createElement("div",{ref:e=>this.columnSpacerRefs[n]=e,key:"column ".concat(n," bottom spacer")}),tabIndex:-1}]],[]),t=d()({},this.props);return delete t.children,h.a.createElement(s,a()({columns:e},t))}makeLayoutPass(e,s){for(var t=(e,t)=>e.key===t.key,n=c()(s,e,t),i=c()(e,s,t),t=e.reduce((e,t,n)=>{n=s[n];return n&&t&&u()(t.props,n.props)||e.push(t),e},[]),e=this.updateColumnsWithNewProps(this.state.columns,t),a=n.map(e=>e.key),o=-1,r=-1,l=0;l<this.props.numberOfColumns;l+=1){var d=this.columnSpacerRefs[l];!d||((d=d.getBoundingClientRect().top)<r||-1===r)&&(r=d,o=l)}t=o;n.length||i.length?(i=(n=[...this.state.objectsToLayOut.filter(e=>Object(p.isValidElement)(e)&&e.key&&a.indexOf(e.key)<0),...i]).slice(0,Math.ceil(n.length/2)),e=this.columnsWithoutRemovedChildren(e,a),i=this.naivelyLayOutObjects(i,e,t,s.length),n=n.slice(Math.ceil(n.length/2)),this.setState({columns:i,objectsToLayOut:n})):this.addNextObjectToLayOutToColumn(e,t)}}t.a=g}}]);
