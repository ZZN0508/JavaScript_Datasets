!function(f,L){var I=window.jQuery||{},n=L,N=window.document,O=L;f.loginBox=f.loginBox||{},I===window.jQuery?($selectorAll=function(e){var o=[];return I(e).each(function(e,n){o.push(n)}),o},n=!0):$selectorAll=function(e){return document.querySelectorAll(e)},I.LOGIN=I.LOGIN||{},I.LOGIN.isInit=!0,f.loginBox.scope=I.LOGIN;function i(i){var r=document.cookie;return r&&function(){for(var e,n={},o=0,t=(r=r.split("; ")).length;o<t&&!(0<(e=r[o].split("=")).length&&(e[0]===i&&(n.key=e[0],n.value=e[1],n.status=!0),"key"in n));o++);return"key"in n&&n}()}function t(){var e,n,o,t;i("c-login-auto").status&&(n=".csdn.net",o="/",(t=i(e="c-login-auto"))&&!0===t.status&&(e=t.key+"="+t.value+";",(t=new Date).setTime(t.getTime()-1e3),e=e+"expires="+t.toGMTString()+";",n&&(e=e+"domain="+n+";"),o&&(e=e+"path="+o+";"),document.cookie=e)),delete I.LOGIN.options.pvSource}function r(e){e&&e.pvSource&&(I.LOGIN.options.pvSource=e.pvSource,I.LOGIN.options.isClosedMaskArea=e.isClosedMaskArea,I.LOGIN.options.isClosedBtn=e.isClosedBtn,d(I.LOGIN.options)),I.LOGIN.docDom&&(N.body.appendChild(I.LOGIN.oMark),N.body.appendChild(I.LOGIN.docDom),I.LOGIN.appendBox.isCreate=!0)}function a(e){return I.LOGIN.runStatus=I.LOGIN.options[e]?I.LOGIN.options[e]():I.LOGIN.runStatus,I.LOGIN.runStatus}function o(e,n,o){window.addEventListener?e.addEventListener(n,o,!1):e.attachEvent("on"+n,o)}function s(e,n){var o,t,e="start"!==e&&"all"===e?"none":"block";return I.LOGIN.options.pvSource||"block"!==e||I.LOGIN.loginService!==I.LOGIN.recordLoginService&&(I.LOGIN.appendBox.getElementsByTagName("iframe")[0].src=I.LOGIN.recordLoginService,I.LOGIN.loginService=I.LOGIN.recordLoginService),I.LOGIN.appendBox&&(I.LOGIN.markDom.style.display=e,I.LOGIN.appendBox.style.display=e,I.LOGIN.appendBox.status="block"===e||!(I.LOGIN.runStatus=!0)),I.LOGIN.appendBox.status&&n&&n(),e&&(o=I.LOGIN.appendBox.status,(t=window.frames.passport_iframe)&&(t=t.window,I.LOGIN.w=t),(t=t||I.LOGIN.w)&&t.checkPollingTimer&&setTimeout(function(){t.checkPollingTimer(o)},500)),I.LOGIN}function l(){function e(e){if(e=window.event||e,I.LOGIN.appendBox.status)return s(I.LOGIN.isClosedMaskArea?"all":"no-close"),e.cancelBubble?e.cancelBubble=!0:e.stopPropagation(),!1}I.LOGIN.oMark&&!I.LOGIN.oMark.isClick&&(o(I.LOGIN.oMark,"click",e),I.LOGIN.oMark.isClick=!0),I.LOGIN.closeBtn&&I.LOGIN.oMark.isClick&&!I.LOGIN.closeBtn.isCloseClick&&(o(I.LOGIN.closeBtn,"click",e),I.LOGIN.closeBtn.isCloseClick=!0)}var c=function(){var e=N.head,n=e.firstElementChild||e.firstChild,o=document.createElement("style");o.innerText=".login-box{position: fixed;display: none;left: 50%;top: 50%;z-index: 10000;-webkit-transform: translate(-50%, -50%);-ms-transform: translate(-50%, -50%);-o-transform: translate(-50%, -50%);-moz-transform: translate(-50%, -50%);transform: translate(-50%, -50%);background-color: #fff;}.login-mark{position: fixed;top: 0;left: 0;z-index: 9999;background-color: rgba(0, 0, 0, 0.5);width: 100%;height: 100%;display: none;}",e.insertBefore(o,n)},d=f.loginBox.login=function(e){var n,o,t,i,r,a,s,l,c,d,u,p,m={domain:(e=e||{}).domain||"csdn.net",isRedirect:e.isRedirect||!document.createElement("iframe").sandbox,iframeName:e.iframeName||"passport_iframe",isIframe:e.isIframe===L||e.isIframe,frameWidth:e.frameWidth,frameHeight:e.frameHeight,append:e.append||"#passport-box",isClosedBtn:null==e.isClosedBtn||!!e.isClosedBtn,isClosedMaskArea:null==e.isClosedMaskArea||!!e.isClosedMaskArea,from:e.from,service:e.service,loginService:e.loginService,initRun:e.initRun||null,before:e.before||null,after:e.after||null,finished:e.finished||null};if(e.pvSource&&(m.pvSource=e.pvSource),e.isClosedMaskArea&&(m.isClosedMaskArea=e.isClosedMaskArea),!m.loginService)throw new Error("login 处理 control错误！");return I.LOGIN.options=m,I.LOGIN.runStatus=!0,m.isIframe&&(m.initRun&&(I.LOGIN.runStatus=m.initRun()),I.LOGIN.runStatus&&(I.LOGIN.runStatus=(o=(n=m).domain,t=n.from,i=n.append,r=n.isClosedBtn,a=n.isClosedMaskArea,s=n.service,l=n.isRedirect,c=n.loginService,d=n.isIframe,u=n.iframeName,p=n.frameWidth,e=n.frameHeight,(m=document.createElement("div")).className="login-mark",N.domain=o||"csdn.net",t&&(c=c+(-1===c.indexOf("?")?"?from=":"&from=")+t),s&&(c=c+"&service="+s),s=c+="&iframe=true",n.pvSource&&(c=c+"&"+n.pvSource),O=document.createDocumentFragment(),p='<iframe  width="'+p+'" height="'+e+'" name="'+u+'" src="'+c+'" frameborder="0" scrolling="no"></iframe>',(e=document.createElement("div")).id=i.replace(/[#\.]/,""),e.className="login-box",I.LOGIN.appendBox=e,I.LOGIN.markDom=m,I.LOGIN.recordLoginService=s,I.LOGIN.loginService=c,I.LOGIN.isClosedMaskArea=a,d&&(I.LOGIN.appendBox.innerHTML=p,I.LOGIN.iframeName=u,I.LOGIN.iframeDom=I.LOGIN.appendBox.firstElementChild||I.LOGIN.appendBox.firstChild),r&&(cssStyle="display: inline-block; color: #999; font-size: 22px; cursor: pointer; position:absolute; top:2%; right:5%;-moz-user-select:none; -webkit-user-select:none; user-select:none;",closeBtn=document.createElement("span"),closeBtn.style=cssStyle,closeBtn.innerHTML="&times",e.appendChild(closeBtn),I.LOGIN.closeBtn=closeBtn),O&&(O.appendChild(e),I.LOGIN.oMark=m,I.LOGIN.docDom=O),I.LOGIN.isRedirect=l,!0))),f.loginBox},u=function(){I.LOGIN.loginBtn=$selectorAll("[data-bind-login=true]");function n(e){var n=window.event||e,o="true"===this.getAttribute("data-bind-login"),e=this.href;if(!I.LOGIN.runStatus&&o)return console.error("开启loginbox失败!"),!1;!1===I.LOGIN.isRedirect?!0==o&&(I.LOGIN.options.isIframe&&(t(),I.LOGIN.appendBox.isCreate||r(),a("before")&&s(L,function(){a("after")}),l()),n.returnValue?n.returnValue=!1:n.preventDefault()):e||(N.location.href=I.LOGIN.options.loginService)}var e=0;if(!I.LOGIN.loginBtn||I.LOGIN.loginBtn.length<=0)return!1;for(;I.LOGIN.loginBtn[e];)!function(e){e=I.LOGIN.loginBtn[e];o(e,"click",n)}(e),e++},p=function(e){var n,o={domain:"csdn.net",isIframe:!0,frameWidth:410,frameHeight:427,append:"#passportbox",from:encodeURIComponent(window.location.href),isClosedBtn:!0,loginService:"https://passport.csdn.net/account/login"};for(n in e)o[n]=e[n];d(o)};f.loginBox.close=function(){return I.LOGIN.appendBox.status&&s("all"),f.loginBox},f.loginBox.show=function(e){if(console.log("taodawang loginBox show ===>",e),window.csdn&&window.csdn.report)try{var n=I('meta[name="report"]'),o=n.length&&JSON.parse(n.attr("content"));o.spm=o.spm+".3001.5834",console.log("taodawang report loginBox ===>",o),window.csdn.report.reportView(o)}catch(e){}return I.LOGIN.appendBox.isCreate||r(e),I.LOGIN.appendBox.status||(s("start"),l()),f.loginBox};function m(){var e;c(),u(),I.LOGIN.isInit&&(e=g(),p(e))}var G,g=(f.loginBox.support=function(){return I.LOGIN.isRedirect},function(){var e=f&&f.loginBox&&f.loginBox.loginBoxParams;return e||console.warn("login-box has no loginBoxParams"),e||{}}),v=function(e){function n(){t||(t=!0,e&&e())}function o(){try{N.documentElement.doScroll("left")}catch(e){return void setTimeout(o,50)}n()}var t=!1;o(),N.onreadystatechange=function(){"complete"===N.readyState&&(N.onreadystatechange=null,n())}};_ready=function(){var e;n&&I(function(){m()})||(e=m,document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(function(){e&&e()},0):(G=function(){document.removeEventListener("DOMContentLoaded",G,!1),e()},document.addEventListener("DOMContentLoaded",G,!1)):document.attachEvent&&v(e))},_ready()}(window.csdn=window.csdn||{},void 0);
