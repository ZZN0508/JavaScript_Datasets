OK.hooks={},function(){"use strict";OK.hooks.AbstractHook={code:0,activate:OK.fn.empty,deactivate:OK.fn.empty,sinkEvents:function(t,e,n){this.m_handlers=this.m_handlers||{};for(var i=OK.fn.delegate(e,[],n),o=0;o<t.length;o++){var s=t[o],a=this.m_handlers[s]||[];a.push(i),this.m_handlers[s]=a}delete this.m_events},_init:function(t,e,n,i){var o=jQuery;this.params=n,this.fallback=i,this.hookEl=t,this.gwt=e,this.j_hookEl=o(this.hookEl),this.j_hookParentEl=o(this.hookEl.parentNode),this.activate()},_destroy:function(){this.deactivate(),delete this.gwt,delete this.hookEl,delete this.m_handlers,delete this.m_events,delete this.params},_getSinkingEvents:function(){return null==this.m_events&&(this.m_events=OK.util.keys(this.m_handlers)),this.m_events},_getSinkingHandlers:function(){return this.m_handlers},_handleEvent:function(t){for(var e=this.m_handlers[t]||[],n=0;n<e.length;n++)e[n].call(this,t)}}}(),function(){function s(t,e,n){var i="";return n&&("auto"===n||(i=e+": "+t.calcString(n.replace("px",""),"px")+"; ")),i}var a=document.documentElement.classList.contains("small-toolbar")||document.documentElement.classList.contains("smooth-hiding")?48:76,t=Object.create(OK.hooks.AbstractHook);OK.util.extend(t,{activate:function(){this.sinkEvents(["scroll","resize","toggle4Col","dataload","navigate","bannerState"],this.doReflow,this),this.sinkEvents(["resize"],this.doResize,this);var n=this;require(["OK/Smokescreen"],function(t){n.StickyBannerCnt=t.getById("hook_Block_ViewportHeightAwareBanner"),null!=n.StickyBannerCnt&&(n.StickyBannerCntTop=function(){var t=0,e=n.StickyBannerCnt;if(e.offsetParent)for(;t+=e.offsetTop,e=e.offsetParent;);return t}()),n.doReflow(),n.doResize()})},deactivate:function(){},doReflow:function(){},doResize:function(){}});var e=Object.create(t),r=0;OK.util.extend(e,{code:2,doResize:function(){this.WindowHeight=document.body.parentNode.clientHeight},doReflow:function(t){var s=this;require(["OK/Smokescreen"],function(t){var e,n,i,o;null!=t.getById("hook_Block_ViewportHeightAwareBanner")&&s.StickyBannerCnt&&(e={},n=s.StickyBannerCnt.clientHeight,s.StickyBanner=t.getById("hook_Block_StickyBannerContainer"),r!=n&&(e.StickyBannerMinHeight=n+"px",r=n),i=s.StickyBanner.getBoundingClientRect().top,o=12+a,t=document.getElementById("footer").getBoundingClientRect(),i<=o?(e.StickyBannerCntPosition="fixed",n+o+12<t.top?(e.StickyBannerCntTop=o+"px",e.StickyBannerCntBottom="auto"):(e.StickyBannerCntTop="auto",e.StickyBannerCntBottom=s.WindowHeight-t.top+"px")):e.StickyBannerCntPosition="static",s.updateStyle||(s.updateStyle=s._changeStickyBannerStyleInline),s.updateStyle(e))})},applySmokescreen:function(t){this.locator=t;t=document.head.querySelector("#stickyBannerCnt_style");t||((t=document.createElement("style")).id="stickyBannerCnt_style",t=document.head.appendChild(t)),this.StickyBannerStyle=t,this.updateStyle=this._changeStickyBannerStyleSmokescreen},_changeStickyBannerStyleInline:function(t){t.StickyBannerMinHeight&&(this.StickyBanner.style.minHeight=t.StickyBannerMinHeight),t.StickyBannerCntPosition&&(this.StickyBannerCnt.style.position=t.StickyBannerCntPosition),t.StickyBannerCntTop&&(this.StickyBannerCnt.style.top=t.StickyBannerCntTop),t.StickyBannerCntBottom&&(this.StickyBannerCnt.style.bottom=t.StickyBannerCntBottom)},previousSmokescreenStyle:{},_changeStickyBannerStyleSmokescreen:function(t){if(this.locator&&this.StickyBannerStyle){if(this.StickyBanner.removeAttribute("style"),this.StickyBannerCnt.removeAttribute("style"),!function(t,e){var n=Object.getOwnPropertyNames(t),i=Object.getOwnPropertyNames(e);if(n.length===i.length){for(var o=0;o<n.length;o++){var s=n[o];if(t[s]!==e[s])return}return 1}}(t,this.previousSmokescreenStyle)){for(var e=this.StickyBannerStyle.sheet,n=e.cssRules.length-1;0<=n;n--)e.deleteRule(0);var i="";t.StickyBannerMinHeight&&(i=" #"+this.StickyBanner.id+" {"+s(this.locator,"min-height",t.StickyBannerMinHeight)+"}",e.insertRule(i,0)),(t.StickyBannerCntBottom||t.StickyBannerCntTop)&&(i=" #"+this.StickyBannerCnt.id+" {"+s(this.locator,"bottom",t.StickyBannerCntBottom)+s(this.locator,"top",t.StickyBannerCntTop)+"} ",e.insertRule(i,0));var o=this.locator.transform("position-static"),i=this.locator.transform("position-fixed");"static"===t.StickyBannerCntPosition?(this.StickyBannerCnt.classList.remove(i),this.StickyBannerCnt.classList.add(o)):"fixed"===t.StickyBannerCntPosition?(this.StickyBannerCnt.classList.remove(o),this.StickyBannerCnt.classList.add(i)):(this.StickyBannerCnt.classList.remove(o),this.StickyBannerCnt.classList.remove(i)),this.previousSmokescreenStyle=t}}else this._changeStickyBannerStyleInline.apply(t)}}),OK.hooks.StickyBannerHookFactory=function(t){return t.mobile?null:Object.create(e)};var n=Object.create(t);OK.util.extend(n,{activate:function(){t.activate.call(this),this.j_hookParentEl.css("min-height",Math.round(this.j_hookEl.innerHeight())+"px"),this.toolbarHeight=OK.topPanelHeight()},doReflow:function(t){var e,n=this.j_hookEl,i=window.pageYOffset;n.hasClass("sticky_cnt__off")?n.toggleClass("sticky_cnt__on",!1):n.hasClass("sticky_cnt__bottom")?(e=this.j_hookParentEl.offset().top+this.j_hookParentEl.height(),n.toggleClass("sticky_cnt__on",e>window.innerHeight+i)):(e=this.j_hookParentEl.offset().top,n.toggleClass("sticky_cnt__on",e<this.toolbarHeight+i))}}),OK.hooks.StickyPanelHookFactory=function(t){return t.mobile?null:Object.create(n)};var i=Object.create(t);OK.util.extend(i,{activate:function(){t.activate.call(this)},doReflow:function(){$("#facets").trigger("reflow")}}),OK.hooks.PSStickyFiltersHookFactory=function(t){return t.mobile?null:Object.create(i)},OK.hooks.FriendsStreamHookFactory=function(t){return t.mobile?null:new Promise(function(e){require(["OK/FriendsStream"],function(t){e(new t.FriendsStream)})})},require(["OK/banners/moneySave"],function(t){t.onHooksReady()})}(window);
