define("pkg/@alife/refly-mbox/3.1.2/index",["jquery"],function(e){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function o(e,t,n,o,p){p=p||{};var c=a.getConfig(),d=p.type||c.type||"get",m=p.dataType||c.dataType||"jsonp",l=r.extend({namespace:e,widgetId:t,methodName:n,params:JSON.stringify(o)},o);return"post"==d&&"json"==m?i(l,p,"post"):"get"==d&&"json"==m?i(l,p,"get"):"get"==d&&"jsonp"==m?s(l,p):s(l,p)}var r=n(1),a=n(2),i=n(3),s=n(7);e.exports={callService:function(e,t,n,r,a){return o(e,t,n,r,a)},getData:function(e,t,n){if(!e)throw new Error("widgetId\u4e3a\u7a7a\uff01");return o(e,e,"execute",t,n)}}},function(t,n){t.exports=e},function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n(1);e.exports={addHandler:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},removeHandler:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null},isAliDomain:function(e,t){var n=["tmall.com","tmall.hk","taobao.com","taobaocdn.com","tbcdn.cn","1688.com","alibaba.com","aliyun.com","alipay.com","alisoft.com","alimama.com","hitao.com","aliexpress.com","laiwang.com","etao.com","kissyui.com","95095.com","taohua.com","tmall.net","tmall.com.hk","taobao.net","taobao.org","alibaba-inc.com","1688.net","alibaba.net","aliyun.net","alipay.net","alisoft.net","alimama.net","hitao.net","aliexpress.net","laiwang.net","etao.net","alicdn.com","aliimg.com"];"undefined"!=typeof t&&(n=n.concat(t));var o=new RegExp("^http(s)?:\\/\\/[a-z0-9-\\.]*("+n.join("|")+")","i");e+="";var r=e.match(o);return!!r},isAliTestDomain:function(e){if(e||(e=document.location.href),this.isAliDomain(e))return/-test\./.test(e)},parseURL:function(e){var t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol,host:t.hostname,port:t.port,query:t.search,params:function(){for(var e,n={},o=t.search.replace(/^\?/,"").split("&"),r=o.length,a=0;a<r;a++)o[a]&&(e=o[a].split("="),n[e[0]]=decodeURIComponent(e[1]));return n}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}},getConfig:function(){var e={};return window._MboxConfig&&"object"==o(window._MboxConfig)&&(e=r.extend(e,window._MboxConfig)),e}}},function(e,t,n){"use strict";function o(e){return new i({bridgeUrl:e.bridgeUrl})}var r=n(1),a=(n(4),n(2)),i=n(5),s={urlTpl:"//widget"+(a.isAliTestDomain()?"-test":"")+".1688.com/front/getJsonComponent.json?namespace={namespace}&widgetId={widgetId}&methodName={methodName}",dataType:"jsonp",transType:"direct",type:"get"},p={urlTpl:"//widget"+(a.isAliTestDomain()?"-test":"")+".1688.com/front/ajax/getJsonComponent.json?namespace={namespace}&widgetId={widgetId}&methodName={methodName}",csrfUrlTpl:"//widget"+(a.isAliTestDomain()?"-test":"")+".1688.com/front/ajax/getJsonComponent.json?namespace={namespace}&widgetId={widgetId}&methodName={methodName}",bridgeUrl:"//widget"+(a.isAliTestDomain()?"-test":"")+".1688.com/front/ajax/bridge.html?target={target}",dataType:"json",transType:"transport",type:"post"};e.exports=function(e,t,n){var i=a.getConfig(),c=p,d=t.transType||i.transType||c.transType||"transport";t.transType&&(d=t.transType);var m=t.urlTpl||i.urlTpl||c.urlTpl,l=!!t.csrfToken;l||(m=s.urlTpl);var u=m.replace(/\{([\w]+)\}/g,function(t,n){return e[n]||""}),f=a.parseURL(u),g="//"+f.host+(80===f.port||443===f.port?"":":"+f.port)+f.path;if("proxy"==d)return r.extend(t,{dataType:"json",type:n||"post",data:e}),r.ajax(g,t);var h={urlTpl:m,csrfUrlTpl:"//widget"+(a.isAliTestDomain()?"-test":"")+".1688.com/front/ajax/getJsonComponent.json?namespace={namespace}&widgetId={widgetId}&methodName={methodName}",bridgeUrl:"//widget"+(a.isAliTestDomain()?"-test":"")+".1688.com/front/ajax/bridge.html?target={target}"},y={url:g,data:r.extend({},e,{namespace:e.namespace,widgetId:e.widgetId,methodName:e.methodName}),options:{type:n||"post",crsfToken:l}};return o(h).send(y)}},function(e,t){function n(){if(""===document.cookie)return{};for(var e=document.cookie.split("; "),t={},n=0,o=e.length;n<o;n++){var r=e[n].split("=");t[r[0]]=r[1]}return t}function o(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}var r={options:{path:"",domain:"",expires:7,secure:!1,raw:!1},set:function(e,t,n){(arguments.length<3||3==arguments.length&&"undefined"==typeof n)&&(n={});var o=void 0!=n.expires?n.expires:this.options.expires||"",r=typeof o;"string"===r&&""!==o?o=new Date(o):"number"===r&&(o=new Date(+new Date+864e5*o)),""!==o&&"toUTCString"in o&&(o="; expires="+o.toUTCString());var a=n.path||this.options.path;a=a?"; path="+a:"";var i=n.domain||this.options.domain;i=i?"; domain="+i:"";var s="undefined"==typeof n.secure?this.options.secure?"; secure":"":n.secure?"; secure":"",p="undefined"!=typeof n.raw?n.raw:this.options.raw,c=p?function(e){return e}:escape;return p===!0?document.cookie=e+"="+t+o+a+i+s:document.cookie=c(e)+"="+c(t)+o+a+i+s,this},get:function(e,t){t=t||{};var r=n(),a=t.raw?function(e){return e}:unescape;if(o(e)){for(var i={},s=0,p=e.length;s<p;s++){var c=a(e[s]),d=r[c];"undefined"!=typeof d&&(d=a(d)),i[c]=d?d:null}return i}e=a(e);var d=r[e];return"undefined"!=typeof d&&(d=a(d)),d=d?d:null},remove:function(e){if(o(e))for(var t=0,n=e.length;t<n;t++)this.set(e[t],"",{expires:-1});else"string"==typeof e&&this.set(e,"",{expires:-1});return this}};e.exports=r},function(e,t,n){"use strict";function o(){return"brg-"+c++ +(1e4*Math.random()).toFixed(0)}function r(e,t,n){var o=document.createElement("iframe");return t=t.replace("{target}",e),o.name=e,o.src=t,o.style.display="none",o.onload=function(){n.resolve()},o.onerror=function(){n.reject()},document.body.appendChild(o),o}function a(e,t){var n=new p(e,"mbox");return n.addTarget(t.contentWindow,e),n}function i(e){this.name=o(),this.bridgeUrl=e.bridgeUrl||"//astyle.alicdn.com/pkg/@alife/refly-mbox/2.0.5/examples/bridge.html?target={target}",this.defer=s.Deferred(),this.iframe=r(this.name,this.bridgeUrl,this.defer),this.messenger=a(this.name,this.iframe),this.messenger.listen(function(e){try{var t=JSON.parse(e),n=d[t.id];void 0==d[t.id],n&&n.defer&&n.defer.resolve(t.data)}catch(o){}})}var s=n(1),p=n(6),c=0,d={};i.prototype.send=function(e){var t=this,n=o();return e["id"]=n,d[n]={data:e,defer:s.Deferred()},this.defer.then(function(){t.messenger.send(JSON.stringify(e))}),d[n].defer},e.exports=i},function(e,t,n){"use strict";function o(e,t){this.target=e,this.name=t}function r(e,t){this.targets={},this.name=e,this.listenFunc=[],s=t||s,"string"!=typeof s&&(s=s.toString()),this.initListen()}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=(n(1),n(2)),s="[PROJECT_NAME]",p="postMessage"in window;p?o.prototype.send=function(e){this.target.postMessage(s+e,"*")}:o.prototype.send=function(e){var t=window.navigator[s+this.name];if("function"!=typeof t)throw new Error("target callback function is not defined");t(s+e,window)},r.prototype.addTarget=function(e,t){var n=new o(e,t);this.targets[t]=n},r.prototype.initListen=function(){var e=this,t=function(t){var n;if("object"==("undefined"==typeof t?"undefined":a(t))&&t.data){if(n=t.data,!new RegExp("^"+s).test(n))return!1;if(n=n.slice(s.length),!i.isAliDomain(t.origin))throw new Error("invalid message origin")}else n=t;for(var o=0;o<e.listenFunc.length;o++)e.listenFunc[o](n)};p?i.addHandler(window,"message",t):window.navigator[s+this.name]=t},r.prototype.listen=function(e){this.listenFunc.push(e)},r.prototype.clear=function(){this.listenFunc=[]},r.prototype.send=function(e,t){var n,o=this.targets;if(1==arguments.length){t=e;for(n in o)o.hasOwnProperty(n)&&o[n].send(t)}else{if(2!=arguments.length)throw new Error("params are lost.");if("undefined"==typeof e||""==e)throw new Error("target are invalid.");o[e].send(t)}},e.exports=r},function(e,t,n){"use strict";var o=n(1),r=n(4),a=n(2),i=(n(5),{urlTpl:"//widget"+(a.isAliTestDomain()?"-test":"")+".1688.com/front/getJsonComponent.json?namespace={namespace}&widgetId={widgetId}&methodName={methodName}",dataType:"jsonp",transType:"direct",type:"get"});e.exports=function(e,t){var n=i,s=n.urlTpl,p=s.replace(/\{([\w]+)\}/g,function(t,n){return e[n]||""});t.csrfToken&&(e["_tb_token_"]=r.get("_tb_token_"));var c=a.parseURL(p),d="//"+c.host+(80!==c.port&&443!==c.port&&c.port?":"+c.port:"")+c.path;return o.extend(t,{dataType:"jsonp",type:"GET",data:e}),o.ajax(d,t)}}])});;