!function(l){var h="waitForImages";l.waitForImages={hasImageProperties:["backgroundImage","listStyleImage","borderImage","borderCornerImage","cursor"]},l.expr[":"].uncached=function(e){if(!l(e).is('img[src!=""]'))return!1;var r=new Image;return r.src=e.src,!r.complete},l.fn.waitForImages=function(c,s,r){var o,u=0;if(l.isPlainObject(arguments[0])&&(r=arguments[0].waitForAll,s=arguments[0].each,c=arguments[0].finished),c=c||l.noop,s=s||l.noop,r=!!r,!l.isFunction(c)||!l.isFunction(s))throw new TypeError("An invalid callback was supplied.");return this.each(function(){var a=l(this),i=[],e=l.waitForImages.hasImageProperties||[],t=/url\(\s*(['"]?)(.*?)\1\s*\)/g;r?a.find("*").addBack().each(function(){var c=l(this);c.is("img:uncached")&&i.push({src:c.attr("src"),element:c[0]}),l.each(e,function(e,r){var n,a=c.css(r);if(!a)return!0;for(;n=t.exec(a);)i.push({src:n[2],element:c[0]})})}):a.find("img:uncached").each(function(){i.push({src:this.src,element:this})}),o=i.length,(u=0)===o&&c.call(a[0]),l.each(i,function(e,r){var n=new Image;l(n).on("load."+h+" error."+h,function(e){return u++,s.call(r.element,u,o,"load"==e.type),u==o?(c.call(a[0]),!1):void 0}),n.src=r.src})})}}(jQuery);
