(this.$WP=this.$WP||[]).push(["VANuRt",(e,r)=>{"use strict";var S,c,h,m,v,p,f,w,s,u,O,y,b,I,k,g=({options:o,onReady:a,onShowOverlay:t})=>{var[e,r]=S.useState(),[n,l]=S.useState(),[i,s]=S.useState(!1),u="MOBILE"===S.useContext(v).viewportCategory,d=I(),{onSuccess:c,isFullWidthMobile:h}=o,m=S.useCallback(e=>{var r,o=e.resultData||"";o?(null==(o=(e=>{var r={};try{r=JSON.parse(e)}catch(r){return console.error("Error parsing controller result data: "+e),null}return"object"!=typeof r?(console.error("Parsed controller result is not an object."),null):{userId:r.user_id,hasCreatedMember:!!r.hasCreatedMember,hasAcceptedTermsOfUse:!!r.hasAcceptedTermsOfUse,loginProvider:r.loginProvider}})(o))||o.hasCreatedMember,d(null!=o&&o.hasCreatedMember?"CREATE":"LOGIN",null==o?void 0:o.userId,"SUCCESS"),c&&c(o)):c&&c(null),e.jsCallback&&(r=e.jsCallback)&&console.error("Non-empty JSCallback is returned from RegController: "+r)},[c,d]),p=S.useCallback(e=>{100<e&&r(u&&h?"100%":e)},[u,h]),{displayOnShowOverlay:f,onClose:w,onFailure:g}=o,C=S.useCallback(e=>{var e=e,r=(e=>{if(!e)return null;if(!e.origin||0!==e.origin.indexOf("https")||e.origin!==document.location.origin)return null;if(!e.data||!e.data.indexOf||-1===e.data.indexOf("action"))return null;try{var r=JSON.parse(e.data);return r.action?r:null}catch(e){return null}})(e);if((e=e)&&e.origin&&0===e.origin.indexOf("https://smartlock.google.com")&&e.data&&e.data.type&&e.source&&e.source.postMessage({type:"verifyAck",data:e.data.data},"https://smartlock.google.com"),r){var e=r["action"];switch(e){case"successClose":m(r);break;case"reloadWindow":console.error("Unexpected reload window message is received from RegController iframe");break;case"fwdToRelativeUrl":var o=r.url||"";o||console.error("No url specified to forward to."),0!==o.indexOf("/")&&console.error("Cannot forward to absolute url: "+o),window.location=o;break;case"resizeFrame":p(r.width),100<r.height&&l(Math.min(r.height,window.innerHeight));break;case"domReady":s(!0),a&&a();break;case"dismiss":w&&w();break;case"showOverlay":f&&t&&t();break;case"generalError":g&&g()}}},[m,f,t,w,a,p,g]);y("message",C);C=S.useMemo(()=>{var r=o.extraQueryParams||{};Object.keys(r).forEach(e=>{void 0===r[e]&&delete r[e]});var e=new URLSearchParams(Object.assign({flow:o.flow,flowOrigin:o.flowOrigin,pid:""+o.pid,hideNavigation:"true",userRequestedForce:"true",returnTo:"",isLithium:"true"},r));return o.mcid&&e.append("mcid",""+o.mcid),o.locationId&&e.append("locationId",""+o.locationId),o.stateToken&&e.append("stateToken",o.stateToken),void 0!==o.requireSecure&&e.append("requireSecure",""+String(!!o.requireSecure)),"/RegistrationController?"+e.toString()},[o.extraQueryParams,o.flow,o.flowOrigin,o.locationId,o.mcid,o.pid,o.requireSecure,o.stateToken]);return S.createElement("div",{className:O("_8RLaCUf_",{"_1ic0q52-":!u}),style:{width:e,height:n}},S.createElement(b,{className:"_30pzQStV",src:C,title:"regcontroller",style:{width:e,height:n,display:i?"block":"none"}}),S.createElement(k,null))},C=({options:e,closeX:r})=>{var o="MOBILE"===S.useContext(v).viewportCategory,[a,t]=S.useState(!1),n=S.useCallback(()=>{e.displayOnShowOverlay||t(!0)},[e.displayOnShowOverlay]),l=S.useCallback(()=>{t(!0)},[]),i=S.useMemo(()=>S.createElement(g,{options:e,onReady:n,onShowOverlay:l}),[n,e,l]);return S.createElement(s,{onClose:e.onClose,containerProps:{backgroundColor:"transparent",disableBodyScroll:!0},bodyProps:{isFullBleed:!0},enableCloseIcon:a&&r,roundedCorners:!o,hideBoxShadow:e.hideBoxShadow},S.createElement("div",{style:{display:a?"block":"none"}},i),!a&&S.createElement("div",{className:"nUBQ6pZw"},S.createElement(u,{size:"large",variant:"primary"})))},o=()=>{var e=S.useContext(p)["userId"],[r]=S.useContext(f),a=S.useContext(w),t=r.params.geoId||void 0,[o,n]=S.useState({flow:"CORE_COMBINED",flowOrigin:"join",pid:-1}),[l,i]=S.useState({closeX:!0}),s=m(),u=S.useRef(void 0),d=h(()=>S.createElement(C,{options:o,closeX:l.closeX}),{},[o,l]);return{login:S.useCallback(o=>e&&!o.forceLogin?Promise.resolve({userId:e,hasCreatedMember:null}):u.current||(c()?("undefined"!=typeof window&&(window.location=`/RegistrationController?flow=${encodeURIComponent(o.flow||"CORE_COMBINED")}&pid=${encodeURIComponent(String(o.pid||-1))}&returnTo=${encodeURIComponent(r.path)}&fullscreen=true`),new Promise(()=>{})):(u.current=new Promise(r=>{n({flow:o.flow||"CORE_COMBINED",flowOrigin:o.flowOrigin||"join",pid:o.pid||-1,isFullWidthMobile:o.isFullWidthMobile||!1,hideBoxShadow:o.hideBoxShadow||!1,extraQueryParams:o.extraQueryParams||{},displayOnShowOverlay:o.deferShowOverlay,requireSecure:o.requireSecure||!1,locationId:t||-1,onSuccess:e=>{e={userId:(null==e?void 0:e.userId)||null,hasCreatedMember:!(null==e||!e.hasCreatedMember),loginProvider:null==e?void 0:e.loginProvider};o.onSuccess&&o.onSuccess(e),d.close(),u.current=null,a({userId:e.userId}),r(e)},onClose:()=>{s({module:"regoverlay",action:"closed",context:[t||"",o.flow].join("|"),value:o.pid||void 0,nonInteraction:!1}),d.close(),u.current=null,o.onClose&&o.onClose()},onFailure:()=>{o.onFailure&&o.onFailure()}}),i({closeX:!1!==o.closeX}),d.open()}),u.current)),[e,r.path,t,d,a,s]),close:d.close}},a=({flow:e,flowOrigin:r="login",pid:o=-1,isFullWidthMobile:a=!1,forceLogin:t=!1,extraQueryParams:n={},deferShowLogin:l=!0,requireSecure:i=!1,onLoginSuccess:s,onLoginFailure:u,onShowOverlay:d})=>{var c=S.useContext(p)["userId"],h=S.useContext(w);return c&&!t?null:S.createElement(g,{options:{flow:e,flowOrigin:r,pid:o,isFullWidthMobile:a,extraQueryParams:n,displayOnShowOverlay:l,requireSecure:i,onSuccess:e=>{s&&s(),h({userId:(null==e?void 0:e.userId)||null})},onFailure:()=>{u&&u()}},onShowOverlay:d})};return[()=>{e("default",o),e("AuthGate",a)},[e=>S=e,e=>c=e.default,e=>h=e.useVDOMPortal,e=>m=e.useGARecorder,e=>(v=e.Device,p=e.Visitor,f=e.Route,w=e.Authenticate),e=>s=e.default,e=>u=e.LoadingSpinner,e=>O=e.default,e=>y=e.useWindow,e=>b=e.EmbeddedContent,e=>(I=e.useUserAccountSiftTrackingAction,k=e.SiftTrackingIframe)]]},["cDcdfi","SfdMbo","vq6MSq","fsml46","2R4xv2","O8LbtK","V08PS7","jSLlaY","Dg5_-9","m5ZZFI","f9x1OV"]]);
