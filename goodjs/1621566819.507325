!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.dmmma?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).tracertUtil={})}(this,(function(t){"use strict";function e(t,e,n){var r=3>=arguments.length||void 0===arguments[3]||arguments[3];if(t){var o=e||window.document;o.addEventListener?o.addEventListener(t,n,r):o.attachEvent?o.attachEvent("on".concat(t),n):o[t]=n}}function n(t,e,n){var r=3>=arguments.length||void 0===arguments[3]||arguments[3];if(t){var o=e||window.document;o.removeEventListener?o.removeEventListener(t,n,r):o.detachEvent?o.detachEvent("on".concat(t),n):o[t]=n}}function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;e.length>n;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;arguments.length>e;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);e>n;n++)r[n]=t[n];return r}function p(t){"interactive"===document.readyState||"complete"===document.readyState?t():e("DOMContentLoaded",document,t)}function f(t){return"requestIdleCallback"in window?f(t):setTimeout(t)}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={};for(var r in t)if(t.hasOwnProperty(r)){var o=0===r.indexOf(e)?r:e+r;n[o]=t[r]}return n}function h(t,e){var n=t||{};for(var r in e)e.hasOwnProperty(r)&&void 0!==e[r]&&(n[r]=e[r]);return n}function v(t,e){var n="";try{n=RegExp("(?=\\?|\\&|\\b|^)".concat(t,"\\=(.+?)(?=\\&|$)")).exec(e),n=decodeURIComponent(n=n?"".concat(n[1]):"")}catch(t){console.warn(t)}return n}function g(t){var e=window.AlipayJSBridge;return e&&e.startupParams&&e.startupParams[t]}function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.search;if(!t)return"";var n="";return""===(n=v(t,e))&&(n=g(t)),n}function w(t){var e=t||window.navigator.userAgent;if(!RegExp("aliapp\\(".concat("ap"),"i").test(e))return 0;var n=/alipayclient\/(\d+)\.?(\d+)?\.?(\d+)?/i.exec(e),r=0;if(n){var o=n[1]||0,a=n[2]||0,i=n[3]||0;10>+a&&(a="0".concat(a)),10>+i&&(i="0".concat(i)),r=parseFloat("".concat(o,".").concat(a).concat(i))}return r}var b="_TRACERT_COOKIE_";function D(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"^",r=[];if(t instanceof Array)r=t;else if(t instanceof Object)for(e in t)t.hasOwnProperty(e)&&r.push("".concat(e,"=").concat(t[e]));return r.join(n)}function S(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"^";if("string"!=typeof t)return null;var n=t.split(e);if(-1===t.indexOf("="))return n;for(var r,o,a=n.length,i={},c=0;a>c;c++)(r=n[c])&&(i[(o=r.split("="))[0]]=o[1]||"");return i}function A(t,e){var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var r in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,"".concat(t.getFullYear()).substr(4-RegExp.$1.length))),n)RegExp("(".concat(r,")")).test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?n[r]:"00".concat(n[r]).substr("".concat(n[r]).length)));return e}function E(t){return t?encodeURIComponent(t).replace(/'/g,"%27"):t}function x(t){return t?decodeURIComponent(t):""}var O=h,_=D;var T="data-aspm",P="data-aspm-click",C=["A","AREA"];function j(t){var e,n;try{return e=[].slice.call(t)}catch(o){e=[],n=t.length;for(var r=0;n>r;r++)e.push(t[r]);return e}}function L(){return window.performance&&window.performance.timing?!!window.performance.timing.loadEventEnd:"complete"===window.document.readyState}function M(t,e){return t&&t.getAttribute&&t.getAttribute(e)||""}function I(t){return null!==t&&"object"===r(t)&&1===t.nodeType}function B(t){return!(!t||!I(t)||t===document.body||t===document.documentElement)}function k(t){var e=t;if(!B(e))return"";for(var n="";e&&e!==document.body&&!(n=M(e,T));)e=e.parentNode;return n}function N(t){var e=t;if(!B(e))return"null";do{if(C.includes(e.tagName)||e.hasAttribute(P))return e}while((e=e.parentNode)&&e&&e.tagName&&"BODY"!==e.tagName&&e!==document.body&&!M(e,T));return null}function R(t){var e=t;if(!B(e))return"";if(C.includes(e.tagName)||e.hasAttribute(P)||(e=N(e)),!e)return"";var n=M(e,P),r=e.tagName;if(("string"==typeof n||C.includes(r))&&!n){var o=0,a=e;do{I(a)&&r===a.tagName&&o++,a=a.previousSibling}while(a);n=o}return"".concat(n)}function U(t){var e=t&&t.getAttribute?t.getAttribute("data-aspm-param"):"",n={};if(e){var r=e.split("^");if(-1===e.indexOf("="))n=r;else for(var o,a,i=r.length,c=0;i>c;c++)(o=r[c])&&(n[(a=o.split("="))[0]]=a[1]||"")}return n}function q(t){if(!t||!t.hasAttribute)return{};if(!t.hasAttribute("data-aspm-content"))return{};var e=t.getAttribute("data-anewChinfo")||"",n=t.getAttribute("data-new-ascm")||"",r=t.getAttribute("data-ascm")||n;return{param5:"newChinfo=".concat(e,"^scm=").concat(r),newScm:n}}function z(t,e){var n=e||t.getBoundingClientRect(),r=document.documentElement.clientHeight,o=Math.min(r,Math.max(n.top,0));return(Math.max(0,Math.min(n.top+n.height,r))-o)/n.height||1}function F(t){if(!t)return"";for(var e=[];t&&1===t.nodeType;){for(var n=1,r=t.previousSibling;r;)r.localName===t.localName&&n++,r=r.previousSibling;e.unshift("".concat(t.localName.toLowerCase(),"[").concat(n,"]")),t=t.parentNode}return e.length?"/".concat(e.join("/")):""}function H(t){if(!t)return 0;if(0>=t.clientHeight||0>=t.clientWidth)return 0;var e=t.getBoundingClientRect(),n=e.left,r=e.top,o=e.right,a=e.bottom,i=window,c=i.innerHeight,s=i.innerWidth;if(0>a||r>c||0>o||n>s)return 0;var u=Math.max(0,r),l=Math.max(0,n),d=Math.min(c,a);return Math.floor((Math.min(s,o)-l)*(d-u)/((o-n)*(a-r))*100)}function J(t){return t&&t.tagName&&"string"==typeof t.tagName?t.tagName:""}var V="180020010000000339";function G(t,e){console&&console.warn&&console.warn("[Tracker]",t),function(t,e){if(!Y())return;var n=e._v,r=void 0===n?"":n,o={};o.yuyan_id=V,o.code=11,o.msg=function(t){if(!t)return"";return E(t.message||"")}(t),o.d1=function(t){if(!t)return"";return E(t.name||"")}(t),o.d2=function(t){var e=t.stack,n=t.message,r=t.name,o=void 0===r?"":r,a=(void 0===e?"":e).replace(void 0===n?"":n,"");(a=a.replace(o,""))&&a.length&&a.length>250&&(a=a.slice(0,250));return E(a)}(t),o.d3=r||"",o.d4=K(e),o.d5=$(),o.fullURL=function(){if(!location)return"";return E(location&&location.href||"")}(),function(t){var e="https://mdap.alipay.com/loggw/dwcookieLogGet.do";try{var n=Y();n.open("POST",e,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send("data=".concat(t,"&time=").concat((new Date).getTime()))}catch(n){try{(new Image).src="".concat(e,"?data=").concat(t,"&time=").concat((new Date).getTime())}catch(t){console&&console.warn&&console.warn("[Tracker]",t)}}}(["D-AE",A(new Date,"yyyy-MM-dd hh:mm:ss.S"),"","","2","","",X(e),"1000","102023","bmmonitor","2",K(e),"","","","","","","","","","","","","","","","",W(),"","","","","","",Object.keys(o).map((function(t){return"".concat(E(t),"=").concat(E(o[t]))})).join("^")])}(t,e)}function W(){return navigator&&navigator.userAgent?E(navigator.userAgent.replace(/,/g,"-")):""}function X(t){return t?E(t.role_id||t.roleId||t.cUserId||t.backupUserId||t.bucUserId||""):""}function $(){return navigator&&navigator.connection&&navigator.connection.effectiveType?E(navigator.connection.effectiveType):""}function K(t){if(!t)return"";var e=t.spmAPos||"",n=t.spmBPos||"";return e&&n?E("".concat(e,".").concat(n)):""}function Y(){var t=null;try{t=new XMLHttpRequest}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}}}return t}function Q(t){var e={is:!1,name:"",version:""},n=t.match(/AliApp\S+\b\)/gi);e.is=/(T-UA)|(TBIOS)|(WindVane)|(AliApp)/i.test(t);try{e.name=n?n[0].match(/\(\w+-*\w*/)[0].split("(")[1]:"",e.version=n?n[0].match(/(\d+\.*)+/gi)[0]:""}catch(t){}return e}function Z(){var t=window?Q(window.navigator.userAgent):{name:"non-browser"};return["AF","AFW","BK","AM","APHK","KB","Snail"].indexOf(t.name)>-1}var tt={},et="-1",nt=navigator.userAgent||"",rt=navigator.appVersion||"",ot=navigator.vendor||"";function at(t){return Object.prototype.toString.call(t)}var it=[["wp",function(t){return-1!==t.indexOf("windows phone ")?/\bwindows phone (?:os )?([0-9.]+)/:-1!==t.indexOf("xblwp")?/\bxblwp([0-9.]+)/:-1!==t.indexOf("zunewp")?/\bzunewp([0-9.]+)/:"windows phone"}],["ios",function(t){return/\bcpu(?: iphone)? os /.test(t)?/\bcpu(?: iphone)? os ([0-9._]+)/:-1!==t.indexOf("iph os ")?/\biph os ([0-9_]+)/:/\bios\b/}],["yunos",/\baliyunos ([0-9.]+)/],["android",/\bandroid[\/\- ]?([0-9.x]+)?/],["linux","linux"]],ct=[["qq",/\bm?qqbrowser\/([0-9.]+)/],["ie",/\b(?:msie |ie |trident\/[0-9].*rv[ :])([0-9.]+)/],["chrome",/ (?:chrome|crios|crmo)\/([0-9.]+)/],["uc",function(t){return 0>t.indexOf("ucbrowser/")?/\buc\/[0-9]/.test(t)?/\buc\/([0-9.]+)/:0>t.indexOf("ucweb")?/\b(?:ucbrowser|uc)\b/:/\bucweb[\/]?([0-9.]+)?/:/\bucbrowser\/([0-9.]+)/}],["android",function(t){if(-1!==t.indexOf("android"))return/\bversion\/([0-9.]+(?: beta)?)/}],["safari",/\bversion\/([0-9.]+(?: beta)?)(?: mobile(?:\/[a-z0-9]+)?)? safari\//],["webview",/\bcpu(?: iphone)? os (?:[0-9._]+).+\bapplewebkit\b/]];function st(t,e,n){var r="[object Function]"===at(e)?e.call(null,n):e;if(!r)return null;var o={name:t,version:et,codename:""};"android"===t&&(o.type=n.indexOf("Mobi")>-1?"phone":"pad"),"ios"===t&&(o.type=n.indexOf("iPhone")>-1?"phone":"pad");var a=at(r);if(!0===r)return o;if("[object String]"===a){if(-1!==n.indexOf(r))return o}else{if(function(t){return"[object Object]"===at(t)}(r))return r.hasOwnProperty("version")&&(o.version=r.version),o;if(r.exec){var i=r.exec(n);if(i)return o.version=i.length>=2&&i[1]?i[1].replace(/_/g,"."):et,o}}}var ut={name:"na",version:et};function lt(t,e,n,r){var o=ut;!function(t,e,n){for(var r=0,o=t.length;o>r&&!1!==e.call(t,t[r],r);r++);}(e,(function(e){var n=st(e[0],e[1],t);if(n)return o=n,!1})),n.call(r,o.name,o.version)}var dt=function(t){t=(t||"").toLowerCase();var e={};return lt(t,it,(function(t,n){var r=parseFloat(n);e.os={name:t,version:r,fullVersion:n},e.os[t]=r}),e),lt(t,ct,(function(t,n){var r=parseFloat(n);e.browser={name:t,version:r,fullVersion:n},e.browser[t]=r}),e),e};(tt=dt("".concat(nt," ").concat(rt," ").concat(ot))).parse=dt,tt._checkApp=Q,tt.app=tt._checkApp(nt);var pt=tt,ft={},mt={},ht=null;var vt=(ht||(ht=new(function(){function t(){o(this,t)}return i(t,[{key:"getEventSequence",value:function(t,e){return mt[e]||(mt[e]={}),mt[e]&&mt[e][t]?++mt[e][t]:mt[e]?(mt[e][t]=1,mt[e][t]):(mt[e]={},mt[e][t]=1,mt[e][t])}},{key:"getSequence",value:function(t){return ft[t]?++ft[t]:(ft[t]=1,ft[t])}}]),t}())),ht),gt="__tracert_sequence",yt="__tracert_sequence_id",wt="__tracert_event_sequence",bt={http:"http",AlipayJSBridge:"AlipayJSBridge"};Object.freeze(bt);var Dt={autoClick:"autoClick",remoteLog:"remoteLog",pageMonitor:"pageMonitor",reportData:"reportData",semLog:"semLog",handleUEPEvent:"handleUEPEvent",reportUEPData:"reportUEPData"};function St(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=e,o=n._v,a=void 0===o?"":o,i=n._instanceId,c=void 0===i?"":i;return t===Dt.autoClick&&(r.param||(r.param={}),r.param.param4||(r.param.param4={}),r.param.param4=At(r.param.param4,"autoClick",a,c)),t===Dt.remoteLog&&(r.param4||(r.param4=""),r.param4=At(r.param4,r.actionId||"",a,c)),t===Dt.pageMonitor&&(r.param||(r.param={}),r.param=At(r.param,"pageMonitor",a,c)),t===Dt.reportData&&(r.spmDetail||(r.spmDetail={}),r.spmDetail=At(r.spmDetail,"reportData",a,c),r.spmDetail["".concat(wt,"_pageMonitor")]=vt.getEventSequence("pageMonitor",c)),r}function At(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o="string"==typeof t,a=o?S(t):t;return a.sdkVersion=n,a[yt]=r,a[gt]=vt.getSequence(r),a[wt]=vt.getEventSequence(e,r),o?D(a):a}function Et(t){var e=t.tracert,n=t.type,r=t.jsApiType,o=void 0===r?"remoteLog":r,a=t.errorHandler;if(!e)throw Error("request tracert");var i=t.data,c=void 0===i?{}:i,s=e.server,u=e.taskId,l=e.verifyServer;switch(e.debug&&console&&console.log&&console.log(c),n){case bt.http:try{c=function(t,e){var n=e._v,r=void 0===n?"":n,o=e._instanceId,a=t;if(a&&a.length){var i=a[0];"D-AE"===i&&(a[36]=At(a[36],a[9],r,o)),"DW-COOKIE"===i&&(a[8]=At(a[8],a[3],r,o))}return a}(c,e)}catch(t){G(t,e)}xt(s,c,"",e),u&&l&&xt(l,c,u,e);break;case bt.AlipayJSBridge:try{c=St(o,c,e)}catch(t){G(t,e)}Ct(c,o,e,a);break;default:xt(s,c,u,e)}}function xt(t,e,n,r){var o=r.openSendBeacon,a=void 0!==o&&o;if(t)if(!e||e.length&&0===e.length)G(Error("ç©ºæ•°æ®"),r);else if(a&&Pt()){var i=Ot(e,n),c=new Blob([i],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(_t(t,e,r).url,c)}else Tt(t,e,n,r);else G(Error("è¯·é…ç½®TracertæœåŠ¡æŽ¥æ”¶åœ°å€"),r)}function Ot(t,e){return e?"data=".concat(E(t.join()),"&time=").concat((new Date).getTime(),"&taskId=").concat(e):"data=".concat(E(t.join()),"&time=").concat((new Date).getTime())}function _t(t,e,n){var r=n.bizType,o=n.spmAPos,a="",i=pt.os.name;if(i&&"na"!==i||(i="PC"),e&&e.length){var c=e[0];"D-AE"===c&&(a=e[9]),"DW-COOKIE"===c&&(a=e[3])}return{url:"https://collect.alipay.com/dwcookie"===t||"https://loggwpre.alipay.com/dwcookie"===t?"".concat(t,"?biztype=").concat(r,"&eventid=").concat(a,"&productid=").concat(i,"&spmAPos=").concat(o):t,bizType:r,eventid:a,productid:i}}function Tt(t,e,n,r){var o=Y();o&&(o.open("POST",_t(t,e,r).url,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.send(Ot(e,n)))}function Pt(){return!!(navigator&&navigator.sendBeacon&&"function"==typeof navigator.sendBeacon&&Blob&&"function"==typeof Blob)}function Ct(t,e,n,r){try{window&&window.AlipayJSBridge?window.AlipayJSBridge.call(e,t,(function(o){[1,4].indexOf(o.error)>-1&&(r&&r(t,n),G(Error("".concat(e||""," AlipayJSBridge is Empty")),n))})):my&&my.canIUse(e)?my.call(e,t):G(Error("".concat(e||""," AlipayJSBridge is Empty")),n)}catch(e){r&&r(t,n),G(e,n)}}function jt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}Object.freeze(Dt);var Lt="object"==typeof global&&global&&global.Object===Object&&global,Mt="object"==typeof self&&self&&self.Object===Object&&self,It=Lt||Mt||Function("return this")(),Bt=function(){return It.Date.now()},kt=/\s/;var Nt=/^\s+/;function Rt(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&kt.test(t.charAt(e)););return e}(t)+1).replace(Nt,""):t}var Ut=It.Symbol,qt=Object.prototype,zt=qt.hasOwnProperty,Ft=qt.toString,Ht=Ut?Ut.toStringTag:void 0;var Jt=Object.prototype.toString;var Vt=Ut?Ut.toStringTag:void 0;function Gt(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Vt&&Vt in Object(t)?function(t){var e=zt.call(t,Ht),n=t[Ht];try{t[Ht]=void 0;var r=!0}catch(t){}var o=Ft.call(t);return r&&(e?t[Ht]=n:delete t[Ht]),o}(t):function(t){return Jt.call(t)}(t)}function Wt(t){return null!=t&&"object"==typeof t}function Xt(t){return"symbol"==typeof t||Wt(t)&&"[object Symbol]"==Gt(t)}var $t=/^[-+]0x[0-9a-f]+$/i,Kt=/^0b[01]+$/i,Yt=/^0o[0-7]+$/i,Qt=parseInt;function Zt(t){if("number"==typeof t)return t;if(Xt(t))return NaN;if(jt(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=jt(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Rt(t);var n=Kt.test(t);return n||Yt.test(t)?Qt(t.slice(2),n?2:8):$t.test(t)?NaN:+t}var te=Math.max,ee=Math.min;function ne(t,e,n){var r,o,a,i,c,s,u=0,l=!1,d=!1,p=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function f(e){var n=r,a=o;return r=o=void 0,u=e,i=t.apply(a,n)}function m(t){return u=t,c=setTimeout(v,e),l?f(t):i}function h(t){var n=t-s;return void 0===s||n>=e||0>n||d&&t-u>=a}function v(){var t=Bt();if(h(t))return g(t);c=setTimeout(v,function(t){var n=e-(t-s);return d?ee(n,a-(t-u)):n}(t))}function g(t){return c=void 0,p&&r?f(t):(r=o=void 0,i)}function y(){var t=Bt(),n=h(t);if(r=arguments,o=this,s=t,n){if(void 0===c)return m(s);if(d)return clearTimeout(c),c=setTimeout(v,e),f(s)}return void 0===c&&(c=setTimeout(v,e)),i}return e=Zt(e)||0,jt(n)&&(l=!!n.leading,a=(d="maxWait"in n)?te(Zt(n.maxWait)||0,e):a,p="trailing"in n?!!n.trailing:p),y.cancel=function(){void 0!==c&&clearTimeout(c),u=0,r=s=o=c=void 0},y.flush=function(){return void 0===c?i:g(Bt())},y}function re(t,e,n){var r=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return jt(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),ne(t,e,{leading:r,maxWait:e,trailing:o})}var oe={AUTO:"auto",MIX:"mix",MANUAL:"manual"},ae={CLICK:"clicked",EXPOSURE:"exposure",INPUT:"input",SCROLL:"scroll",TOUCH:"touch"},ie=[ae.CLICK,ae.EXPOSURE,ae.INPUT,ae.SCROLL,ae.TOUCH],ce=Object.freeze({__proto__:null,INPUT_TYPE:{NONE:"",TEXT:"text",SELECT:"select",TEXTAREA:"textarea",CHECKBOX:"checkbox",RADIO:"radio"},TAG_NAME:{INPUT:"INPUT",SELECT:"SELECT",TEXTAREA:"TEXTAREA",LABEL:"LABEL"},INPUT_ELEMENT_TYPES:{TEXT:"text",CHECKBOX:"checkbox",RADIO:"radio",PASSWORD:"password",URL:"url",EMAIL:"email",TEL:"tel",FILE:"file",SEARCH:"search",NUMBER:"number",DATETIME:"datetime",DATE:"date",MONTH:"month",WEEK:"week",DATETIME_LOCAL:"datetime-local",RANGE:"range"},COMBINE_TYPE:oe,EVENT_TYPE:ae,EVENT_TYPES:ie}),se=1,ue="__uepElementId",le=[],de=[],pe=re(be,500,{leading:!1});function fe(t){return t?(t[ue]||(t[ue]="".concat(se++)),t[ue]):""}function me(t){if("SELECT"===J(t)){var e=t.options[t.selectedIndex];return e?(e.textContent||"").trim().slice(0,20):""}return(t.textContent||"").trim().slice(0,20)}function he(t,e){switch(t.actionId){case"exposure":return function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).percent;return void 0===e&&(e=t?H(t):100),{state:e>0?"start":"end",percent:e}}(e,t);case"clicked":return function(t){return t?{text:me(t.target||t.srcElement),xPos:t.clientX,yPos:t.clientY,clickable:!0}:null}(e)}return t}function ve(t){var e=q(t);return e&&e.param5?e.newScm||S(e.param5).scm:""}function ge(t,e){Et({tracert:e,type:bt.AlipayJSBridge,data:t,jsApiType:Dt.remoteLog})}function ye(t,e){t.combineEventArray&&t.combineEventArray.forEach((function(n){delete n.uep,n.context=t.context,ge(n,e)}))}function we(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.context;delete t.context,Z()?ye(t,e):Et({tracert:e,type:bt.AlipayJSBridge,data:t,jsApiType:Dt.handleUEPEvent,errorHandler:ye})}function be(){le.length&&(we({eventArray:le,context:this}),this.debug&&console.log("eventArray",le),le.length=0),de.length&&(we({combineEventArray:de,context:this}),this.debug&&console.log("combineEventArray",de),de.length=0)}function De(t,e){delete t.uep,Et({tracert:e,type:bt.AlipayJSBridge,data:t,jsApiType:Dt.reportData})}function Se(){for(var t=0,e={};arguments.length>t;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var Ae=function t(e){function n(t,r,o){var a;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(o=Se({path:"/"},n.defaults,o)).expires){var i=new Date;i.setMilliseconds(i.getMilliseconds()+864e5*o.expires),o.expires=i}o.expires=o.expires?o.expires.toUTCString():"";try{a=JSON.stringify(r),/^[\{\[]/.test(a)&&(r=a)}catch(t){}r=e.write?e.write(r,t):encodeURIComponent(r+"").replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(t+"")).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var c="";for(var s in o)o[s]&&(c+="; "+s,!0!==o[s]&&(c+="="+o[s]));return document.cookie=t+"="+r+c}t||(a={});for(var u=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,d=0;u.length>d;d++){var p=u[d].split("="),f=p.slice(1).join("=");this.json||'"'!==f.charAt(0)||(f=f.slice(1,-1));try{var m=p[0].replace(l,decodeURIComponent);if(f=e.read?e.read(f,m):e(f,m)||f.replace(l,decodeURIComponent),this.json)try{f=JSON.parse(f)}catch(t){}if(t===m){a=f;break}t||(a[m]=f)}catch(t){}}return a}}return n.set=n,n.get=function(t){return n.call(n,t)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(t,e){n(t,"",Se(e,{expires:-1}))},n.withConverter=t,n}((function(){}));function Ee(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=window.localStorage&&window.localStorage.getItem(t)||Ae.get(t,e);if(Ae.get(t,e)&&window.localStorage)try{window.localStorage.setItem(t,n),Ae.remove(t,e)}catch(t){console&&console.warn&&console.warn("localstorage error")}return n}function xe(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||400>e.length||!n.cookie&&window.localStorage)if(window.localStorage)try{window.localStorage.setItem(t,e)}catch(r){Ae.set(t,e,n)}else Ae.set(t,e,n);else console&&console.warn&&console.warn("Tracert cookie set too long")}function Oe(t,e){window.localStorage&&window.localStorage.removeItem(t),Ae.remove(t,e)}var _e=new(function(){function t(){o(this,t)}return i(t,[{key:"set",value:function(){var t=[].slice.call(arguments);2>t.length?this._set(t):this._set(c({},t[0],t[1]),t[2]||{})}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="".concat(b,"_").concat(t),o=Ee(r,e);return n&&Oe(r),o}},{key:"_set",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t&&0!==Object.keys(t).length)for(var n in t)if(t.hasOwnProperty(n)){var r="".concat(b,"_").concat(n);xe(r,t[n],e)}}}]),t}());var Te={parse:function(t){var e=t.split("//"),n=e[0],r=e[1]||"",o=r.split("/")[0],a=o.split(":"),i=a[0],c=a[1]||"",s=r.replace(o,"").split("#"),u=s[0],l=s[1]||"",d=l?"#".concat(l):null,p=u.split("?"),f=p[0],m=p[1]||"",h={protocol:n,slashes:!0,auth:null,host:o,port:c||null,hostname:i,hash:d,search:m?"?".concat(m):null,query:m||null,pathname:f,path:u,href:t,format:function(){return"".concat(h.protocol,"//").concat(h.host).concat(h.path).concat(h.hash||"")}};return h}},Pe=new(function(){function t(){o(this,t),this._iframe=null}return i(t,[{key:"initIframe",value:function(){if(this._iframe)return this._iframe;var t=document.createElement("iframe");t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.left="-100px",t.style.bottom="-100px",t.style.width="-100px",t.setAttribute("src","https://tracert.alipay.com/cross.html"),t.onload=function(){t.style.display="none"};try{document.body.appendChild(t)}catch(t){}return this._iframe=t,t}}]),t}());var Ce=Array.isArray,je=Ut?Ut.prototype:void 0,Le=je?je.toString:void 0;function Me(t){if("string"==typeof t)return t;if(Ce(t))return function(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}(t,Me)+"";if(Xt(t))return Le?Le.call(t):"";var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e}var Ie,Be=It["__core-js_shared__"],ke=(Ie=/[^.]+$/.exec(Be&&Be.keys&&Be.keys.IE_PROTO||""))?"Symbol(src)_1."+Ie:"";var Ne=Function.prototype.toString;var Re=/^\[object .+?Constructor\]$/,Ue=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function qe(t){return!(!jt(t)||(e=t,ke&&ke in e))&&(function(t){if(!jt(t))return!1;var e=Gt(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}(t)?Ue:Re).test(function(t){if(null!=t){try{return Ne.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}function ze(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return qe(n)?n:void 0}var Fe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,He=/^\w*$/;var Je=ze(Object,"create");var Ve=Object.prototype.hasOwnProperty;var Ge=Object.prototype.hasOwnProperty;function We(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Xe(t,e){for(var n,r,o=t.length;o--;)if((n=t[o][0])===(r=e)||n!=n&&r!=r)return o;return-1}We.prototype.clear=function(){this.__data__=Je?Je(null):{},this.size=0},We.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},We.prototype.get=function(t){var e=this.__data__;if(Je){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return Ve.call(e,t)?e[t]:void 0},We.prototype.has=function(t){var e=this.__data__;return Je?void 0!==e[t]:Ge.call(e,t)},We.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Je&&void 0===e?"__lodash_hash_undefined__":e,this};var $e=Array.prototype.splice;function Ke(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Ke.prototype.clear=function(){this.__data__=[],this.size=0},Ke.prototype.delete=function(t){var e=this.__data__,n=Xe(e,t);return n>=0&&(n==e.length-1?e.pop():$e.call(e,n,1),--this.size,!0)},Ke.prototype.get=function(t){var e=this.__data__,n=Xe(e,t);return 0>n?void 0:e[n][1]},Ke.prototype.has=function(t){return Xe(this.__data__,t)>-1},Ke.prototype.set=function(t,e){var n=this.__data__,r=Xe(n,t);return 0>r?(++this.size,n.push([t,e])):n[r][1]=e,this};var Ye=ze(It,"Map");function Qe(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function Ze(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Ze.prototype.clear=function(){this.size=0,this.__data__={hash:new We,map:new(Ye||Ke),string:new We}},Ze.prototype.delete=function(t){var e=Qe(this,t).delete(t);return this.size-=e?1:0,e},Ze.prototype.get=function(t){return Qe(this,t).get(t)},Ze.prototype.has=function(t){return Qe(this,t).has(t)},Ze.prototype.set=function(t,e){var n=Qe(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function tn(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var i=t.apply(this,r);return n.cache=a.set(o,i)||a,i};return n.cache=new(tn.Cache||Ze),n}tn.Cache=Ze;var en,nn,rn,on=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,an=/\\(\\)?/g,cn=(en=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(on,(function(t,n,r,o){e.push(r?o.replace(an,"$1"):n||t)})),e},nn=tn(en,(function(t){return 500===rn.size&&rn.clear(),t})),rn=nn.cache,nn);function sn(t,e){return Ce(t)?t:function(t,e){if(Ce(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Xt(t))||He.test(t)||!Fe.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:cn(function(t){return null==t?"":Me(t)}(t))}function un(t){if("string"==typeof t||Xt(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e}function ln(t,e,n){var r=null==t?void 0:function(t,e){for(var n=0,r=(e=sn(e,t)).length;null!=t&&r>n;)t=t[un(e[n++])];return n&&n==r?t:void 0}(t,e);return void 0===r?n:r}function dn(t){return function(t){return"number"==typeof t||Wt(t)&&"[object Number]"==Gt(t)}(t)&&t!=+t}var pn=function(){function t(){var e=this;o(this,t),this.version="0.0.1",this.isMiniApp=!1,this.isInitSdk=!1,this.customDisplayList={},this.isVisDataMode="true",this.A="",this.B="",this.spmABList=[],this.initCount=0,this.insuranceTime=0,this.otherShowDataDomList=Object.create(null),this.showDataDomList=Object.create(null),this.oldShowDataDomList=!1,this.repeatPoint={},this.scrollTime=Date.now(),this.delayedInit=function(){e.start=!0,e.initSDK(),e.hashChangePage()},this.getAB=function(t){return e.A&&!t||(e.A=e.getA()||""),e.B&&!t||(e.B=e.getB()||""),e.A&&e.B?"".concat(e.A,".").concat(e.B):null},this.getB=function(){return M(document.body,T)||M(document.body,"data-aspm-b")},this.getA=function(){for(var t,e=j(document.getElementsByTagName("meta")),n=e.length,r=0;n>r;r++){var o=e[r],a=M(o,"name"),i=M(o,"content");switch(a){case T:case"data-aspm-a":t=i}if(t)break}return"a1877"===t||"a1180"===t?null:t},this.initSDK=function(){var t=e;t.getAB(!0)?t.changePage(!0):(t.initCount++,6>t.initCount&&setTimeout((function(){t.initSDK()}),666),console.warn("æœªèƒ½èŽ·å–ABä½"))},this.hashChangePage=function(){console.log("å…¼å®¹å®¹å™¨é¢„åŠ è½½");var t=e;window.addEventListener("hashchange",(function(){var e=t.getA(),n=t.getB();t.A===e&&t.B===n||(t.initCount=0,t.initSDK())}))},this.changeAB=function(t,n){t&&n?(e.A=t,e.B=n):console.warn("aï¼Œbä½ä¸å®Œæ•´")},this.changePage=function(t){var n=e;n.startGetData.bind(e)(),t&&n.eventListener()},this.isminiAppDom=function(){document.getElementById("show_data_communication")?e.isMiniApp||(e.isMiniApp=!0,e.miniAppListener()):e.isMiniApp=!1},this.miniAppListener=function(){var t=e,n=document.getElementById("show_data_communication");if(n){var r=ln(n,"textContent");if(r)try{var o=JSON.parse(r);t.setSPMData(o)}catch(t){console.log(t)}new MutationObserver((function(){var e=n.textContent;if(e)try{var r=JSON.parse(e);t.setSPMData(r)}catch(t){console.log(t)}})).observe(n,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["textContent"]})}},this.eventListener=function(){if(!e.isInitSdk){e.isInitSdk=!0;var t=e;window.addEventListener("resize",(function(){t.throttleStartGetData()}),!0),window.addEventListener("touchstart",(function(){t.scrollTime=Date.now(),t.scrollCompensate()}),!0),window.addEventListener("scroll",(function(){t.scrollTime=Date.now(),t.scrollCompensate()}),!0),window.addEventListener("touchmove",(function(){t.scrollTime=Date.now(),t.scrollCompensate()}),!0),document.addEventListener("resume",(function(){t.getAB()&&t.changePage()}),!1);var n=document.body,r={attributes:!0,childList:!0,subtree:!0},o=new MutationObserver((function(e){var a=!1;e&&e.length&&e.length>0&&e.forEach((function(t){"BODY"!==t.target.nodeName&&"TracertWebShowData"!==t.target.id&&(a=!0)})),a&&(o.disconnect(),setTimeout((function(){o.observe(n,r)}),6),t.throttleStartGetData(),t.throttleisMiniAppDom())}));o.observe(n,r),window.requestAnimationFrame(t.idleGetData),t.dispatchReadyEvent()}},this.scrollCompensate=function(){1500>Date.now()-e.scrollTime&&(e.throttleStartGetData(),setTimeout((function(){e.scrollCompensate()}),6))},this.idleGetData=function(t){t||(t=0),setTimeout(t-e.insuranceTime>666?function(){e.insuranceTime=t,window.requestAnimationFrame(e.idleGetData)}:function(){e.throttleLangStartGetData(),e.insuranceTime=t,window.requestAnimationFrame(e.idleGetData)},666)},this.dispatchReadyEvent=function(){window.dispatchEvent(new Event("webShowDataReady"))},this.setSPMData=function(t){jt(t)&&(e.customDisplayList=t||{},e.throttleStartGetData())},this.setSPMDataDom=function(){if("true"===e.isVisDataMode){var t=e.customDisplayList,n=Object.create(null);Object.keys(t).forEach((function(r){var o=t[r];if(!o.unShowCurrent){var a=e.getDomData("".concat(r),o);if(a){var i=e.addDom(a);i&&(n[a.name]=i)}}o.children&&Object.keys(o.children).forEach((function(t){var a=o.children[t],i=e.getDomData("".concat(r,".").concat(t),a);if(i){var c=e.addDom(i);c&&(n[i.name]=c)}}))})),e.otherShowDataDomList=n}},this.startGetData=function(){e.showDataDomList=Object.create(null),e.setSPMDataDom();var t=document.body;e.getData(t.children),e.setDataDom()},this.setDataDom=function(){"true"===e.isVisDataMode?(Object.assign(e.showDataDomList,e.otherShowDataDomList),e.oldShowDataDomList?e.changeShowDataDom():e.createShowDataDom()):e.delShowDataDom()},this.changeShowDataDom=function(){if("true"===e.isVisDataMode){e.setSPMDataDom();var t=document.querySelectorAll("#TracertWebShowData");if(t&&t.length>1)return e.delShowDataDom(),void e.createShowDataDom();var n=t[0];if(n&&n.children&&n.children.length>0){j(n.children).forEach((function(t){var r=t.getAttribute("data-showdataid"),o=e.showDataDomList[r];if(o){var a=o.width,i=o.height,c=o.top;t.style.transform="translate(".concat(o.left,"px, ").concat(c,"px)"),t.style.maxHeight="".concat(i,"px"),t.style.maxWidth="".concat(a,"px"),delete e.showDataDomList[r]}else n.removeChild(t)}));var r=Object.keys(e.showDataDomList);e.showDataDomList&&r.length>0&&r.forEach((function(t){n.appendChild(e.parseDom(e.showDataDomList[t].str))}))}else e.delShowDataDom(),e.createShowDataDom()}},this.createShowDataDom=function(){if("true"===e.isVisDataMode){e.setSPMDataDom();var t=document.createDocumentFragment(),n=document.createElement("div");n.id="TracertWebShowData";var r="";Object.keys(e.showDataDomList).forEach((function(t){r+=e.showDataDomList[t].str})),n.innerHTML=r,t.appendChild(n),document.getElementsByTagName("body")[0].appendChild(t),e.oldShowDataDomList=!0}},this.delShowDataDom=function(){var t=document.querySelectorAll("#TracertWebShowData");t&&t.length>0&&t.forEach((function(t){t&&t.children&&t.children.length>0?j(t.children).forEach((function(e){t.removeChild(e)})):document.body.removeChild(t)}))},this.getShowSpmCPos=function(t){var e=M(t,T)||M(t,"data-spmv")||"";return e?{spm:e}:(e=M(t,"data-aspm-c")||"")?{spm:e,type:"C"}:null},this.getShowSpmDPos=function(t){var e=M(t,"data-spmv")||M(t,P);return e?{spm:e}:(e=M(t,"data-aspm-d"))?{spm:e,type:"D"}:null},this.getRect=function(t){var e=t.getBoundingClientRect(),n=u({},JSON.parse(JSON.stringify(e))),r=window.getComputedStyle(t).zIndex;return n.zIndex=r="auto"===r?null:Number(r)+1,n},this.cName="",this.getData=function(t){"true"===e.isVisDataMode&&j(t).forEach((function(t){if(I(t)){var n=e.getRect(t);if(z(t,n)>0){var r=e.getShowSpmCPos(t);if(r){e.cName=r.spm;var o=e.getDomData("".concat(r.spm),n,r.type);if(o){var a=e.addDom(o);a&&(e.showDataDomList[o.name]?e.repeatPoint[o.name]=1+e.repeatPoint[o.name]||0:e.showDataDomList[o.name]=a)}}var i=e.getShowSpmDPos(t);if(i){var c=e.getDomData("".concat(e.cName,".").concat(i.spm),n,i.type);if(c){var s=e.addDom(c);s&&(e.showDataDomList[c.name]?e.repeatPoint[c.name]=1+e.repeatPoint[c.name]||0:e.showDataDomList[c.name]=s)}}t.children&&e.getData(t.children)}}}))},this.addDom=function(){},this.parseDom=function(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes[0]},this.changeOthenAB=function(t){console.log("changeOthenAB",t)},this.addOtherAB=function(t,n){if(t!==e.A||n!==e.B){var r="".concat(t,".").concat(n);e.spmABList.includes(r)||(e.spmABList.push(r),e.changeOthenAB([r].concat(l(e.spmABList))))}},this.getSPMFullName=function(t,n){var r=null,o=null,a=null,i=null;if(t&&"string"==typeof t){var c=t.split("."),s=c.length;if(n)"C"===n&&(a=t),"D"===n&&("2">s?i=t:(i=c[s-1],a=c[s-2]));else{for(var u=s;u--;0>u){var l=c[u].substring(0,1);"a"===l&&(r||(r=c[u])),"b"===l&&(o||(o=c[u])),"c"===l&&(a||(a=c[u])),"d"===l&&(i||(i=c[u]))}var d=c[s-1];if(d){var p=Number(d);dn(p)||(i=p)}}}r&&o&&e.addOtherAB(r,o);var f=e.A,m=e.B;return f||(f=e.getA()),m||(m=e.getB()),i?{id:"".concat(r||f,".").concat(o||m,".").concat(a,".").concat(i),type:"D"}:{id:"".concat(r||f,".").concat(o||m,".").concat(a),type:"C"}},this.getDomData=function(t,n,r){var o=e.getSPMFullName(t,r);return{rect:n,name:o.id,type:o.type}},this.throttleStartGetData=re(this.startGetData,6),this.throttleLangStartGetData=re(this.startGetData,666),this.throttleisMiniAppDom=re(this.isminiAppDom,600)}return i(t,[{key:"start",value:function(){this.isVisDataMode="true",console.log("start"),L()?this.delayedInit():window.addEventListener("load",this.delayedInit)}},{key:"stop",value:function(){this.isVisDataMode="false",console.log("stop"),this.delShowDataDom()}}]),t}();t.Cookies=Ae,t.CrossIframe=Pe,t.ShowData=pn,t.addEvent=e,t.addMexOption=function(t,e){var n=t||{},r=e||{};if(!r.spmId||"mergeExpose"!==r.actionId)return n;if(3===r.spmId.split(".").length){var o=r.spmId;n[o]||(n[o]={},n[o]=O({},r))}return n},t.addSequence=At,t.addToExObj=function(t,e){var n=t||{},r=e||{};if(!r.spmId||"mergeExpose"!==r.actionId)return null;if(3===r.spmId.split(".").length){var o=r.spmId;n[o]||(n[o]={});var a="";r.param4&&r.param4.rid?(a=r.param4.rid,delete r.param4.rid):a="",n[o][a]||(n[o][a]=[]),n[o][a].push(r.param4)}return n},t.config=ce,t.cookiesPrefix=b,t.dealExtra=m,t.debounce=function(t,e){var n,r=arguments,o=this;return function(){var a=o,i=r;clearTimeout(n),n=setTimeout((function(){n=null,t.apply(a,i)}),e)}},t.decode=x,t.detect=pt,t.encode=E,t.formatExObj=function(t,e){var n=[],o=["fullURL","mBizScenario","mPageState","mPageName","version"];if("object"===r(t))for(var a in t)if(t.hasOwnProperty(a)){var i={};e?i=O(i,e[a]):(i.spmId=a,i.actionId="mergeExpose");var c=[];if(t[a].options)i.param4=_(t[a].options.param4);else{for(var s in t[a])if(t[a].hasOwnProperty(s)){for(var u=[],l=t[a][s],d=0;l.length>d;d++){var p=[],f=l[d];for(var m in f)f.hasOwnProperty(m)&&-1===o.indexOf(m)&&p.push("".concat(m,"|").concat(f[m]));u.push(p.join(";"))}c.push("rid|".concat(s,":").concat(u.join("&")))}i.param4="exposed=".concat(c.join("__"))}n.push(i)}return n},t.getApFloatVersion=w,t.getAttr=M,t.getContentParam=q,t.getDPosDom=N,t.getDomConfig=function(t){var e=t&&t.getAttribute?t.getAttribute("data-aspm-config"):"",n={};if(e){var r=e.split("^");if(-1===e.indexOf("="))n=r;else for(var o,a,i=r.length,c=0;i>c;c++)(o=r[c])&&(n[(a=o.split("="))[0]]=a[1]||"")}return n},t.getDomExpoPercent=H,t.getDomParam=U,t.getHttpObj=Y,t.getHttpSendUrl=_t,t.getMetaPageName=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"pagename",e=j(window.document.getElementsByTagName("meta")),n="",r=0;e.length>r;r++){var o=e[r],a=M(o,"name"),i=M(o,"content");if(i&&a&&a===t){n=i;break}}return n},t.getMetaSpm=function(t){for(var e,n,r,o,a,i=j(t||document.getElementsByTagName("meta")),c=i.length,s=0;c>s;s++){switch(n=M(e=i[s],"name"),r=M(e,"content"),n){case T:a=r;break;case"data-bizType":o=r}if(a&&o)break}var u={};return a&&(u.spmAPos=a),o&&(u.bizType=o),u},t.getNetwork=$,t.getPageMaxZindex=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=l(document.all).map((function(t){return+window.getComputedStyle(t).zIndex||0}));return e.length?Math.max.apply(Math,l(e)):t},t.getSendValue=Ot,t.getSpm=K,t.getSpmBPos=function(){return M(document.body,T)},t.getSpmCPos=k,t.getSpmDPos=R,t.getTagName=J,t.getUA=W,t.getUserId=X,t.getValue=y,t.getValueFromSearch=v,t.getValueFromStartupParams=g,t.getXPath=F,t.inIframe=function(){try{return window.self!==window.top}catch(t){return!0}},t.isDom=I,t.isLoaded=L,t.isViewDom=B,t.isWechat=function(){return"undefined"!=typeof WeixinJSBridge||"undefined"!=typeof QQJSBridge||!(!window.navigator||!(window.navigator.userAgent.toLowerCase().indexOf("micromessenger")>-1||window.navigator.userAgent.toLowerCase().indexOf("qq")>-1||window.navigator.userAgent.toLowerCase().indexOf("toutiaomicroapp")>-1||void 0!==window.navigator.wxuserAgent))},t.jsApiSendBefore=St,t.jsApiTypeEnum=Dt,t.load=p,t.log=function(t){var e=t.params,n=void 0===e?{}:e,r=t.e,o=t.context,a=t.combineType,i=n.actionId,c=void 0===i?n.type:i;if(-1!==ie.indexOf(c)){var s=r?r.target||r.srcElement||r:null,l=n.param4?S(n.param4):null,d=u(u({},he(n,r)),{},{type:c===ae.CLICK?"click":c,timestamp:n.eventTime,xpath:F(s),target:fe(s),spm:n.spmId,scm:n.newScm||n.scm,params:u({},l),bizCode:n.bizType,combineType:a||"manual"});delete n.newScm;var p=g("uepCombineMode");p||delete d.combineType,p&&a!==oe.AUTO?de.push(u(u({},n),{},{uep:d})):le.push(d),be.call(o)}else ge(n,o)},t.logPv=function(t,e){Z()?De(t,e):Et({tracert:e,type:bt.AlipayJSBridge,data:t,jsApiType:Dt.reportUEPData,errorHandler:De})},t.nodeListToArray=j,t.objToStr=D,t.objectAssign=h,t.ownAddEventListener=function(t,r,o){var a=3>=arguments.length||void 0===arguments[3]||arguments[3];return e(t,r,o,a),function(){n(t,r,o,a)}},t.removeEvent=n,t.reportError=G,t.request=Et,t.requestIdleCallback=f,t.requestTypeEnum=bt,t.sendAlipayJSBridge=Ct,t.sendHttpRequest=xt,t.sendXhrPost=Tt,t.spmDPosMarkAttr=P,t.spmDataKey=T,t.storage=_e,t.strToObj=S,t.supportsSendBeacon=Pt,t.throttleLog=function(t){var e=t.params,n=t.event,r=t.context,o=t.combineType,a=n?n.target||n.srcElement||n:null,i=function(t,e){var n=R(t),r="";if(!e.spmAPos||!e.spmBPos||!n)return"";var o=n.split("."),a=!0;switch(o.length){case 1:o.unshift(k(t))}for(var i=0;2>i;i++)if(!o[i]){a=!1;break}return a&&(r=[e.spmAPos,e.spmBPos].concat(o).join(".")),r}(a,r),c=i&&U(a),s=u({timestamp:Date.now(),spm:i,scm:i&&ve(a),params:u({},c),combineType:o,xpath:F(a),target:fe(a)},e);g("uepCombineMode")||delete s.combineType,le.push(s),pe.call(r)},t.timeFormat=A,t.url=Te,t.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},t.visibleProportion=z,Object.defineProperty(t,"__esModule",{value:!0})}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).tracertCore=t(e.tracertUtil)}(this,(function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;t.length>n;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e){return function(e){if(Array.isArray(e))return e}(e)||l(e)||u(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e){return function(e){if(Array.isArray(e))return f(e)}(e)||l(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function u(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);t>n;n++)i[n]=e[n];return i}function d(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var p="object"==typeof global&&global&&global.Object===Object&&global,v="object"==typeof self&&self&&self.Object===Object&&self,h=p||v||Function("return this")(),g=function(){return h.Date.now()},m=/\s/;var y=/^\s+/;function b(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&m.test(e.charAt(t)););return t}(e)+1).replace(y,""):e}var I=h.Symbol,_=Object.prototype,E=_.hasOwnProperty,j=_.toString,x=I?I.toStringTag:void 0;var O=Object.prototype.toString;var P=I?I.toStringTag:void 0;function k(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":P&&P in Object(e)?function(e){var t=E.call(e,x),n=e[x];try{e[x]=void 0;var i=!0}catch(e){}var r=j.call(e);return i&&(t?e[x]=n:delete e[x]),r}(e):function(e){return O.call(e)}(e)}var S=/^[-+]0x[0-9a-f]+$/i,A=/^0b[01]+$/i,w=/^0o[0-7]+$/i,T=parseInt;function C(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&"[object Symbol]"==k(e)}(e))return NaN;if(d(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=d(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=b(e);var n=A.test(e);return n||w.test(e)?T(e.slice(2),n?2:8):S.test(e)?NaN:+e}var L=Math.max,M=Math.min;function R(e,t,n){var i,r,o,a,s,c,l=0,u=!1,f=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var n=i,o=r;return i=r=void 0,l=t,a=e.apply(o,n)}function h(e){return l=e,s=setTimeout(y,t),u?v(e):a}function m(e){var n=e-c;return void 0===c||n>=t||0>n||f&&e-l>=o}function y(){var e=g();if(m(e))return b(e);s=setTimeout(y,function(e){var n=t-(e-c);return f?M(n,o-(e-l)):n}(e))}function b(e){return s=void 0,p&&i?v(e):(i=r=void 0,a)}function I(){var e=g(),n=m(e);if(i=arguments,r=this,c=e,n){if(void 0===s)return h(c);if(f)return clearTimeout(s),s=setTimeout(y,t),v(c)}return void 0===s&&(s=setTimeout(y,t)),a}return t=C(t)||0,d(n)&&(u=!!n.leading,o=(f="maxWait"in n)?L(C(n.maxWait)||0,t):o,p="trailing"in n?!!n.trailing:p),I.cancel=function(){void 0!==s&&clearTimeout(s),l=0,i=c=r=s=void 0},I.flush=function(){return void 0===s?a:b(g())},I}function B(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return d(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),R(e,t,{leading:i,maxWait:t,trailing:r})}var F=document,N=function(e){console&&console.warn&&console.warn("Tracert deprecatedï¼š".concat(e))};return function(){function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,r);var i={autoLogPv:!0,eventType:"click",autoExpo:!1,bizType:"H5behavior",state:"",name:"",logLevel:"2",mdata:{},seedIdPrefix:"",seedIdSuffix:"",spmAPos:"",spmBPos:"",bizScenario:e.getValue("bizScenario")||"",paramPrefix:"",debug:!1,server:"",taskId:"",verifyServer:"",lastClkSpm:"",url:location.href.split(/\?|#|;jsessionid=/)[0],referSPM:"",srcSpm:"",sessionIdKey:"tracert-session-key",seedIdCfg:{pageSeedId:"H5_MTRACKER_AP_PAGE",clkSeedId:"H5_MTRACKER_AP_CLK",calcSeedId:"H5_MTRACKER_AP_CALC",expoSeedId:"H5_MTRACKER_AP_EXPO",syslogSeedId:"H5_MTRACKER_AP_SYSLOG"},_plugins:[],platformType:"",ready:!1,apiCashList:[],timeMap:{},expoOnce:!1,_wap_intervalEx:400,_wap_interval:300,_wap_mgObjIndex:0,_wap_exObjIndex:0,_wap_mgTdObjIndex:0,_expoMergeItvObj:0,hasExpoMerge:!1,fmtedExObjArr:[],fmtedExObj:{},fmtedExOptions:{},cacheExObjArr:[],cacheMrExObjArr:[],expotTimeout:300,expoObj:{},expoType:function(t){e.addEvent("scroll",F,B(t,300,{leading:!1,trailing:!0}))},expoSection:[-.3,.3],_beforeEvObj:{logPv:[],click:[],expo:[],set:[],send:[]},_afterEvObj:{start:[],logPv:[],click:[],expo:[]},_sideEffects:[],_pluginLoadCnt:0,sysInfo:{},_v:"",_instanceId:e.uuid()};e.objectAssign(i,t),e.objectAssign(this,i);var o=window.TracertCmdCache;if(o&&o.length)for(var a=0;o.length>a;a++){var l=[].slice.call(o[a]),u=s(l),f=u[0],d=u.slice(1);this.call.apply(this,[f].concat(c(d)))}this._start()}var o,l,u;return o=r,(l=[{key:"before",value:function(e,t){var n=this._beforeEvObj;if(!n[e])throw Error("ç›®æ ‡æ–¹æ³•ä¸æ”¯æŒè¯¥äº‹ä»¶");if("function"!=typeof t)throw Error("ç›‘å¬å™¨ä¸æ˜¯å‡½æ•°");n[e].push(t)}},{key:"_runBeforeFns",value:function(e,t){var n=this._beforeEvObj[e]||[];if(!n||!n.length)return!0;for(var i=0;n.length>i;i++)if(!1===n[i].call(this,t))return console&&console.debug&&console.debug("Tracert before fns: ".concat(e," stop propagation")),!1;return!0}},{key:"after",value:function(e,t){var n=this._afterEvObj;if(!n[e])throw Error("ç›®æ ‡æ–¹æ³•ä¸æ”¯æŒè¯¥äº‹ä»¶");if("function"!=typeof t)throw Error("ç›‘å¬å™¨ä¸æ˜¯å‡½æ•°");"start"===e&&this.ready?t():n[e].push(t)}},{key:"_runAfterFns",value:function(e,t){var n=this._afterEvObj[e]||[];if(n&&n.length)for(var i=0;n.length>i;i++)n[i].call(this,t)}},{key:"init",value:function(){}},{key:"load",value:function(t){e.load(t)}},{key:"onReady",value:function(e){this.ready?e&&e():document.addEventListener("TracertOnReady",(function(){e&&e()}))}},{key:"_start",value:function(){var t=this,n=function(){t.load((function(){if(!t.ready){if(t.get("_isMain")){var n=e.getMetaSpm();n.spmAPos=t.spmAPos||n.spmAPos,t.spmBPos||(n.spmBPos=e.getSpmBPos()),t.set(n)}t.ready=!0;for(var i=0;t.apiCashList.length>i;i++)t.call.apply(t,t.apiCashList[i]);t._runAfterFns("start"),t.apiCashList=[]}}))};this.pluginReady&&this.started?n():(document.addEventListener("TracertPluginReady",(function(e){t.started&&t._instanceId===e._instanceId&&n()})),document.addEventListener("TracertStart",(function(e){t.pluginReady&&t._instanceId===e._instanceId&&n()})))}},{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.run(e)}},{key:"run",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.set(a(a({},t),{},{started:!0}));var n=document.createEvent("HTMLEvents");n._isMain=!!this._isMain,n._instanceId=this._instanceId,n.initEvent("TracertStart",!0,!0),document.dispatchEvent(n),this.autoLogPv&&this.call("logPv",{combineType:e.config.COMBINE_TYPE.MIX})}},{key:"addSideEffects",value:function(){var e=[].slice.call(arguments);"function"==typeof e[0]&&(this._sideEffects.includes(e)||this._sideEffects.push(e))}},{key:"clearSideEffects",value:function(){if(!this._sideEffects||!this._sideEffects.length)return!0;for(var e=0;this._sideEffects.length>e;e++){var t=this._sideEffects[e],n=t.slice(1);t[0]&&t[0](n)}return!0}},{key:"loadPlugins",value:function(e){if(e&&e.length){this._plugins=e;for(var t=0;e.length>t;t++)this.loadPlugin(e[t])}}},{key:"loadPlugin",value:function(e){var t=this;e&&(window["tracert".concat(e)]&&"function"==typeof window["tracert".concat(e)]||"function"==typeof e)&&("function"==typeof e?e:window["tracert".concat(e)])(this,(function(){if(t._pluginLoadCnt++,t._pluginLoadCnt===t._plugins.length){t.set({pluginReady:!0});var e=document.createEvent("HTMLEvents");e._isMain=!!t._isMain,e._instanceId=t._instanceId,e.initEvent("TracertPluginReady",!0,!0),document.dispatchEvent(e)}}))}},{key:"call",value:function(){var e,t=[].slice.call(arguments);if(!t[0]||"run"!==t[0]&&"start"!==t[0]||this.set({started:!0}),this.ready){if(!this[t[0]]||"function"!=typeof this[t[0]])return console.warn("æœªæ‰¾åˆ°æ–¹æ³•ï¼š".concat(t[0])),null;var n=t.slice(1);n=this.optionsHandle(n),e=this[t[0]].apply(this,n)}else this.apiCashList.push(t);return e}},{key:"optionsHandle",value:function(e){return e&&e.length?(e.forEach((function(e){var t=e;t&&(t.spmid&&(t.spmId=t.spmid),t.seedid&&(t.seedId=t.seedid),t.ucid&&(t.ucId=t.ucid))})),e):e}},{key:"get",value:function(e){return this[e]}},{key:"set",value:function(){var n=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i;this._runBeforeFns("set",r),r.eventName&&e.objectAssign(r,{eventType:r.eventName}),"object"===t(r.mdata)&&(r.mdata=a(a({},this.mdata),r.mdata));var o={};Object.keys(r).forEach((function(t){if(r[t]instanceof Function){var i=r[t];o[t]=function(){try{for(var t=arguments.length,r=Array(t),o=0;t>o;o++)r[o]=arguments[o];return i.apply(n,r)}catch(t){e.reportError(t,n)}}}else o[t]=r[t]})),e.objectAssign(this,o)}},{key:"getSysInfo",value:function(e){return this.sysInfo[e]}},{key:"setSysInfo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t;e.objectAssign(this.sysInfo,n)}},{key:"config",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};N("config å·²åºŸå¼ƒï¼è¯·ä½¿ç”¨ set æ–¹æ³•"),this.set(e)}},{key:"remoteLog",value:function(){}},{key:"logPv",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._runBeforeFns("logPv",e);t&&(this._logPv(e),this._runAfterFns("logPv",e))}},{key:"_logPv",value:function(){}},{key:"report",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.params,i=e.spmId;if(i){var r=i.split("."),o=r[0],s=r[1];o&&s&&this.set({spmAPos:o,spmBPos:s})}"object"===t(n)&&this.set({mdata:a(a({},this.mdata),n)}),this.set({_calledLogPv:!!i}),this.call("logPv")}},{key:"pageState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.set({state:e}),this.call("logPv")}},{key:"pageName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";N("å·²åºŸå¼ƒ"),this.set({name:e})}},{key:"setPageState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.call("pageState",e)}},{key:"time",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="".concat(e),n=this.timeMap;t&&!n[t]&&(n[t]=new Date-0)}},{key:"timeEnd",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="".concat(e),n=this.timeMap;if(!t||!n[t])return"";var i=n[t],r=new Date-0-i;return delete n[t],r}},{key:"_goRemotelog",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.seedId||n.spmId){var i=n.spmId||n.spmid||"",r=i.split("."),o=r.length,a=this.spmAPos,s=this.spmBPos;if(a&&s)switch(o){case 1:case 2:if(""===i)break;if(0!==i.indexOf("c"))break;i=[a,s,i].join(".")}var c={ucId:n.ucId,seedId:n.seedId,spmId:i,actionId:n.actionId,logLevel:n.logLevel||this.logLevel,param4:n.mdata||{}};if(n.type&&(c.type=n.type),n.params&&"object"===t(n.params))if(n.params.length)e.objectAssign(c,{param1:n.params[0]||"",param2:n.params[1]||"",param3:n.params[2]||""});else{var l=n.mdata||{};e.objectAssign(l,n.params),e.objectAssign(c.param4,l)}if(n.timeKey){var u=this.call("timeEnd",n.timeKey);u&&(c.param4.consume=u)}this.call("remoteLog",c)}else console.warn("è¯·å¡«å…¥åŸ‹ç‚¹seedIdæˆ–spmId")}},{key:"info",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._goRemotelog(e)}},{key:"error",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.objectAssign(t,{type:"error",actionId:"exception"}),this._goRemotelog(t)}},{key:"click",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=o.combineType,c=void 0===s?"manual":s,l=o.event,u={spmId:n,extra:i,options:r,currentConfig:o},f=this._runBeforeFns("click",u);if(f){var d=i.extraSpmIds;u.extra.extraSpmIds&&delete u.extra.extraSpmIds;var p=u.spmId.split(":"),v=p[1]?{seedDesc:p[1]}:{};e.objectAssign(v,e.dealExtra(u.extra,this.paramPrefix));var h={param1:this.url,param2:p[0],param4:v,seedId:this.seedIdCfg.clkSeedId,actionId:e.config.EVENT_TYPE.CLICK,spmId:p[0]};if(this.fullLinkAndChInfo){var g=u.extra.newChinfo||"",m=u.extra.entityId||u.extra.scm||"";if(g&&m){var y={param5:"newChinfo=".concat(g,"^scm=").concat(m)};e.objectAssign(u.options,y)}}e.objectAssign(h,u.options),this.set({lastClkSpm:u.spmId}),this.call("remoteLog",a({},h),!0,l,c),d&&d.length&&d.forEach((function(e){t.call("remoteLog",a(a({},h),{},{extraPageId:e}),!0,l,c)})),this._runAfterFns("click",u)}}},{key:"expo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"up",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=o.combineType,s=void 0===a?"manual":a,c=o.event,l={spmId:t,offset:n,extra:i,options:r,currentConfig:o},u=this._runBeforeFns("expo",l);if(u){var f={param1:this.url,param2:l.spmId,param3:l.offset,param4:e.dealExtra(l.extra,this.paramPrefix),seedId:this.seedIdCfg.expoSeedId,actionId:e.config.EVENT_TYPE.EXPOSURE,spmId:l.spmId};if(this.fullLinkAndChInfo){var d=l.extra.newChinfo||"",p=l.extra.entityId||l.extra.scm||"";if(d&&p){var v={param5:"newChinfo=".concat(d,"^scm=").concat(p)};e.objectAssign(f,v),e.objectAssign(l.options,v)}}e.objectAssign(f,r);var h=r&&r.force;this.expoObj=this.expoObj||{},h||!1!==this.expoObj[l.spmId]?(this.expoOnce&&(this.expoObj[l.spmId]=!1),this.call("remoteLog",f,!1,c,s),this._runAfterFns("expo",l)):console.warn("ç‚¹ä½ ".concat(l.spmId," å·²ç»æ›å…‰è¿‡äº†"))}}},{key:"calc",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};N("calc å·²åºŸå¼ƒ");var r={param1:this.url,param2:t,param3:n,param4:e.dealExtra(i,this.paramPrefix),seedId:this.seedIdCfg.calcSeedId,actionId:"timestamp"};this.call("remoteLog",r)}},{key:"expoContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this.expo(e,"up",i,{param5:"newChinfo=".concat(n,"^scm=").concat(t||r),newScm:r})}},{key:"clickContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this.click(e,i,{param5:"newChinfo=".concat(n,"^scm=").concat(t||r),newScm:r})}}])&&i(o.prototype,l),u&&i(o,u),r}()}));
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],e):(t=t||self).tracertMonitor=e(t.tracertUtil)}(this,(function(util){"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread2(t){for(var e=1;arguments.length>e;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach((function(e){_defineProperty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function _objectWithoutPropertiesLoose(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;i.length>n;n++)0>e.indexOf(r=i[n])&&(o[r]=t[r]);return o}function _objectWithoutProperties(t,e){if(null==t)return{};var r,n,o=_objectWithoutPropertiesLoose(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;i.length>n;n++)0>e.indexOf(r=i[n])&&Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}var version="0.1.37",errorCodeEnums={JS:1,REQUEST:2,PROMISEREJECTION:3,ASSETS:4};function getResourceErrorSrc(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.src||t.href;return"img"===t.tagName.toLowerCase()&&0===e.indexOf("data:")&&(e=e.split(",")[0]),e}function getTime(){var t=new Date,e=function(t){return 10>t?"0".concat(t):"".concat(t)};return"".concat(t.getFullYear(),"-").concat(e(t.getMonth()+1),"-").concat(e(t.getDate())," ").concat(e(t.getHours()),":").concat(e(t.getMinutes()),":").concat(e(t.getSeconds()),":").concat(t.getMilliseconds())}function getXPath(t,e){var r=t.id?"".concat(t.id):"",n=t.className?"".concat(t.className):"",o=t.tagName.toLowerCase(),i=r||n,a=[];r&&a.push('[@id="'.concat(r,'"]')),n&&a.push('[@class="'.concat(n,'"]'));var c="".concat(o).concat(i?a.join(""):"");return t.parentNode&&t.parentNode.tagName&&e-1!=0?"".concat(getXPath(t.parentNode,e-1),">").concat(c):c}function safelyPush(t,e,r){var n=r||20;if(!t||!e)return null;n>=r&&r||(r=n),t.push(e);var o=t.length-n;return o>0&&(t=t.slice(o)),t}function generateIdentifier(t){return[t.code,t.uid,t.page,t.msg||""].join("_")}function getUserId(t){return t&&(t.role_id||t.roleId||t.cUserId||t.backupUserId||t.bucUserId)||""}var objectAssign=util.objectAssign,doc=document,docEl=doc.documentElement,startTime=(new Date).getTime(),fieldLenLimt=660,limitFields=["code","msg"],encodeValue=function(t){return encodeURIComponent(t).replace(/'/g,"%27")};function objToStr(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"^",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];if(t instanceof Array)o=t;else if(t instanceof Object){var i=n?encodeValue:function(t){return t};for(e in t)if(t.hasOwnProperty(e)){var a=i(t[e]);o.push("".concat(e,"=").concat(a))}}return o.join(r)}function initSessionId(t){if(!t.sessionId){var e=window.sessionStorage,r=t.sessionIdKey;e||(e={}),e[r]||(e[r]="".concat(util.uuid(),"_").concat(Date.now())),t.set({sessionId:e[r]})}}function getNetwork(){return navigator&&navigator.connection&&navigator.connection.effectiveType?navigator.connection.effectiveType:""}function filterParam(t,e){objectAssign(e,this.mdata||{}),e.title=document.title,e.dom_cnt=document.getElementsByTagName("*").length,e.delay=(new Date).getTime()-startTime,e.scroll_top=docEl.scrollTop+doc.body.scrollTop,e.content_height=Math.max(docEl.clientHeight,docEl.offsetHeight,docEl.scrollHeight),e.last_action=this._lastAction,e.monitorConfigFailed=this._monitorConfigFailed?1:0,e.network=getNetwork(),e.spmId=t;var r=this.refSpm||this.referSPM||"";e.ref=this.refUrl,e.referSPM=r,e.fullURL=this.fullURL||location.href,e.source_appid=this.spmAPos,this._spmId&&(e._spmId=this._spmId),this._refSpm&&(e._refSpm=this._refSpm),this.cOfflineVer&&(e.c_offline_ver=this.cOfflineVer),this.cAppId&&(e.c_app_id=this.cAppId);var n=[version],o=this._v;if(o&&n.push("h5:".concat(o)),e.tracert_ver=n.join(";"),"object"===_typeof(e)){var i=e;for(var a in i)if(i.hasOwnProperty(a)&&"string"==typeof i[a]){0>limitFields.indexOf(a)&&!/^[dmc]\d+$/.test(a)||i[a].length>fieldLenLimt&&(i[a]=i[a].slice(0,fieldLenLimt));var c=i[a].replace(/\s+/g," ");i[a]="fullURL"===a&&c.length>300?c.slice(0,300):c}}return e}function getUA(){return navigator.userAgent?navigator.userAgent.replace(/,/g,"%2C"):""}function packFinalData(t){var e=t.spmId,r=t.seedId,n=t.param4,o=n.__sid||this.sessionId||util.uuid();delete n.__sid;var i=new Date,a=function(t){return 10>t?"0".concat(t):"".concat(t)},c=getUserId(this),s=["D-AE","".concat(i.getFullYear(),"-").concat(a(i.getMonth()+1),"-").concat(a(i.getDate())," ").concat(a(i.getHours()),":").concat(a(i.getMinutes()),":").concat(a(i.getSeconds()),":").concat(i.getMilliseconds()),this.clientId,"","2","",o,c,1e3,r,"H5behavior",this.logLevel,"","","","","","","","","","","","","","".concat(window.innerWidth||"","x").concat(window.innerHeight,"x").concat(window.devicePixelRatio),"","","",getUA(),"","","",objToStr(this.sysInfo),"",""];if(1===n.s3&&1===n.code)s.push(objToStr(n,"^",!0));else{var d=filterParam.call(this,e,n);s.push(objToStr(d,"^",!0))}for(var l=0;s.length>l;l++)"string"==typeof s[l]&&(s[l]=s[l].replace(/,/g,"%2C"));return s}function sendData(t){var e=window.encodeURIComponent;this.debug&&console.log(t),this._httpLog(e(t.join()))}function bridgeLog(t){window.AlipayJSBridge?window.AlipayJSBridge.call("handleLoggingAction",{actionType:"reportEvent",params:{eventId:this.seedIdCfg.exceptionSeedId||this._defaultExceptionSeedId,bizType:"bmmonitor",extData:t||{}}}):this._warn("éžå®¹å™¨çŽ¯å¢ƒï¼Œä¸èƒ½è°ƒç”¨ handleLoggingAction")}function remoteLog(t){this.init(),initSessionId(this);var e=t.param4,r=t.spmId;if(window.AlipayJSBridge&&e&&e.code>10){var n=filterParam.call(this,r,e);for(var o in delete n.__sid,n._ua=getUA(),n.spmId=r,n)n.hasOwnProperty(o)&&"string"==typeof n[o]&&(n[o]=encodeValue(n[o]));bridgeLog.call(this,n)}else{var i=packFinalData.call(this,t);sendData.call(this,i)}}function log(t){try{var e=this._preproccess(t);if(!e)return;if(void 0!==e.sampleRate&&Math.random()>e.sampleRate)return void this._warn("å½“å‰å·²è®¾ç½®é‡‡æ ·çŽ‡ ".concat(e.sampleRate,"ï¼Œæœªè¢«é‡‡é›†"));this._runBeforeFns("send",e);var r=e.bmAppid||this._bmAppId;remoteLog.call(this,{spmId:this.spmAPos&&this.spmBPos?"".concat(this.spmAPos,".").concat(this.spmBPos):"",seedId:this.seedIdCfg.exceptionSeedId||this._defaultExceptionSeedId,param4:_objectSpread2({pid:this.pid||"",bm_appid:r,bm_sid:this._bmSprintId,env:this._env||""},e)})}catch(t){this._warn("Tracert å¼‚å¸¸ä¸ŠæŠ¥å¤±è´¥:",t)}}function getMonitorConfig(t){for(var e=null,r=0;this._monitorConfigs.length>r;r++)this._monitorConfigs[r].code===t.code&&(e=this._monitorConfigs[r]);return e}function filterOptions(t,e){for(var r={},n=0;e.fields.length>n;n++)r[e.fields[n]]=!0;for(var o in t)!r[o]&&/^[dmc]\d+$/.test(o)&&delete t[o];return t}function preproccess(t){if(!t)return!1;if(1===t.code&&1===t.s3)return t;if("function"==typeof this.beforeLog){var e;try{e=this.beforeLog(t)}catch(t){}if(!1===e)return this._warn("å½“å‰ç”±äºŽ beforeLog è¿”å›ž falseï¼Œæœªè¢«é‡‡é›†"),!1;"object"===_typeof(e)&&(t=e)}for(var r=generateIdentifier(_objectSpread2({},t,{uid:getUserId(this),page:this.fullURL||location.href})),n=!1,o=0;this._trackedLogs.length>o;o++)if(this._trackedLogs[o]===r){n=!0;break}if((null==t.oncePerSession?this.oncePerSession:t.oncePerSession)&&n)this._warn("å½“å‰ç”±äºŽ OncePerSession ç­–ç•¥ï¼Œæœªè¢«é‡‡é›†");else{if(this._monitorConfigInited||this._monitorConfigFailed){if(this._monitorConfigFailed)return t;if(void 0!==t.bmAppid&&this._bmAppId!==t.bmAppid)return t;var i=getMonitorConfig.call(this,t);return!!i&&(i.isDeleted||!i.isActive?(this._warn("å½“å‰ç›‘æŽ§é¡¹å·²å…³é—­"),!1):(void 0===t.sampleRate&&(t.sampleRate=i.sampleRate),!n&&this._trackedLogs.push(r),filterOptions(t,i)))}safelyPush(this._cacheLogs,t)}}function handleErrorOptions(t,e){var r=t.target||t.srcElement;if(r)if("unhandledrejection"!==t.type){if(r instanceof HTMLElement){var n=getResourceErrorSrc(r),o=r.tagName.toLowerCase(),i=r.alt,a=void 0===i?"":i;e({code:errorCodeEnums.ASSETS,msg:n||"",s1:o,s2:getXPath(r,5),s3:a})}else t.error&&t.error.stack?this.logError(t.error):e({code:errorCodeEnums.JS,msg:t.message,s3:0})}else{var c=t.reason||{};if(c.message&&c.stack)this.logError(c,{code:errorCodeEnums.PROMISEREJECTION});else{var s=c.message||("string"==typeof c?c:JSON.stringify(c));e({code:errorCodeEnums.PROMISEREJECTION,msg:s})}}}function handleErrorOptions$1(t,e){try{handleErrorOptions.call(this,t,e)}catch(t){this._warn("handleErrorOptions failed",t)}}var win=window;function interfaceRegister(t){var e=!1;if("XMLHttpRequest"in win){var r=win.XMLHttpRequest.prototype,n=r.open;r.open=function(t,e){this.__tracertMonitor__={method:t,url:e||"",status_code:null};for(var r=Array(arguments.length),o=0;r.length>o;++o)r[o]=arguments[o];n.apply(this,r)};var o=r.send;r.send=function(r){var n=this;function i(){if(n.__tracertMonitor__&&4===n.readyState)try{var o=n.__tracertMonitor__.url;if(0===n.status)return;var i=o.split("?")[0],a=o.split("?")[1]||"",c="string"==typeof r?r:JSON.stringify(r),s=n.response+"";s.length>2048&&(s="[too large]");if(200>n.status||n.status>299||e){if(i===t.server)return void t._warn("Tracert ä¸ŠæŠ¥å¼‚å¸¸",c);t.logRequestError({type:"http",status:n.status,url:i,method:n.__tracertMonitor__.method,query:a,data:c,response:s,traceId:t.traceId||""})}}catch(e){t._warn("Tracert æŽ¥å£å¼‚å¸¸ä¸ŠæŠ¥å¤±è´¥:",e)}}if("onreadystatechange"in n&&"function"==typeof n.onreadystatechange){var a=n.onreadystatechange;n.onreadystatechange=function(){for(var t=Array(arguments.length),e=0;t.length>e;++e)t[e]=arguments[e];i.apply(this,t),a.apply(this,t)}}else n.onreadystatechange=i;for(var c=Array(arguments.length),s=0;c.length>s;++s)c[s]=arguments[s];return o.apply(this,arguments)}}if("fetch"in win){var i=win.fetch;win.fetch=function(){for(var r=Array(arguments.length),n=0;r.length>n;++n)r[n]=arguments[n];var o="GET";return r[1]&&r[1].method&&(o=r[1].method.toUpperCase()),i.apply(this,r).then((function(n){return new Promise((function(i){try{var a=r[0],c=a.split("?")[0],s=a.split("?")[1]||"",d=r[1]&&r[1].body||"",l="string"==typeof d?d:JSON.stringify(d);n.clone().text().then((function(r){n.ok&&!e||t.logRequestError({type:"http",status:n.status,url:c,method:o,query:s,data:l,response:(r||"").length>2048?"[too large]":r,traceId:t.traceId||""})})).then((function(){i(n)}),(function(t){i(n)}))}catch(t){i(n)}}))}))}}}function _typeof$1(t){return(_typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;e.length>r;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);t.length>e;e++)r[e]=t[e];return r}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _iterableToArrayLimit(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(n=(a=c.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==c.return||c.return()}finally{if(o)throw i}}return r}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var checkEnv=function(){var t=window.navigator.userAgent,e="";return!!t.match(/iphone|ipad|iPod/gi)&&(e="iOS"),!!t.match(/android/gi)&&(e="Android"),!!t.match(/Firefox/gi)&&(e="Firefox"),!!t.match(/Chrome/gi)&&(e="Chrome"),!t.match(/Chrome/gi)&&!!t.match(/Safari/gi)&&(e="Safari"),!!t.match(/Opera/gi)&&(e="Opera"),!!t.match(/MSIE/gi)&&(e="IE"),e};function checkAndriodSpecial(){return!0}var generateHandler=function(t){switch(t){case"iOS":return{filter:function(t){return 0>t.indexOf("[native code]")&&t.indexOf("@")>=0}};case"Android":return{filter:function(t,e){return e&&0>t.indexOf("nonymous")&&checkAndriodSpecial()}};default:return{filter:function(){return!0}}}};function safeAdd(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function bitRotateLeft(t,e){return t<<e|t>>>32-e}function md5cmn(t,e,r,n,o,i){return safeAdd(bitRotateLeft(safeAdd(safeAdd(e,t),safeAdd(n,i)),o),r)}function md5ff(t,e,r,n,o,i,a){return md5cmn(e&r|~e&n,t,e,o,i,a)}function md5gg(t,e,r,n,o,i,a){return md5cmn(e&n|r&~n,t,e,o,i,a)}function md5hh(t,e,r,n,o,i,a){return md5cmn(e^r^n,t,e,o,i,a)}function md5ii(t,e,r,n,o,i,a){return md5cmn(r^(e|~n),t,e,o,i,a)}function binlMD5(t,e){var r,n,o,i,a;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var c=1732584193,s=-271733879,d=-1732584194,l=271733878;for(r=0;t.length>r;r+=16)n=c,o=s,i=d,a=l,c=md5ff(c,s,d,l,t[r],7,-680876936),l=md5ff(l,c,s,d,t[r+1],12,-389564586),d=md5ff(d,l,c,s,t[r+2],17,606105819),s=md5ff(s,d,l,c,t[r+3],22,-1044525330),c=md5ff(c,s,d,l,t[r+4],7,-176418897),l=md5ff(l,c,s,d,t[r+5],12,1200080426),d=md5ff(d,l,c,s,t[r+6],17,-1473231341),s=md5ff(s,d,l,c,t[r+7],22,-45705983),c=md5ff(c,s,d,l,t[r+8],7,1770035416),l=md5ff(l,c,s,d,t[r+9],12,-1958414417),d=md5ff(d,l,c,s,t[r+10],17,-42063),s=md5ff(s,d,l,c,t[r+11],22,-1990404162),c=md5ff(c,s,d,l,t[r+12],7,1804603682),l=md5ff(l,c,s,d,t[r+13],12,-40341101),d=md5ff(d,l,c,s,t[r+14],17,-1502002290),c=md5gg(c,s=md5ff(s,d,l,c,t[r+15],22,1236535329),d,l,t[r+1],5,-165796510),l=md5gg(l,c,s,d,t[r+6],9,-1069501632),d=md5gg(d,l,c,s,t[r+11],14,643717713),s=md5gg(s,d,l,c,t[r],20,-373897302),c=md5gg(c,s,d,l,t[r+5],5,-701558691),l=md5gg(l,c,s,d,t[r+10],9,38016083),d=md5gg(d,l,c,s,t[r+15],14,-660478335),s=md5gg(s,d,l,c,t[r+4],20,-405537848),c=md5gg(c,s,d,l,t[r+9],5,568446438),l=md5gg(l,c,s,d,t[r+14],9,-1019803690),d=md5gg(d,l,c,s,t[r+3],14,-187363961),s=md5gg(s,d,l,c,t[r+8],20,1163531501),c=md5gg(c,s,d,l,t[r+13],5,-1444681467),l=md5gg(l,c,s,d,t[r+2],9,-51403784),d=md5gg(d,l,c,s,t[r+7],14,1735328473),c=md5hh(c,s=md5gg(s,d,l,c,t[r+12],20,-1926607734),d,l,t[r+5],4,-378558),l=md5hh(l,c,s,d,t[r+8],11,-2022574463),d=md5hh(d,l,c,s,t[r+11],16,1839030562),s=md5hh(s,d,l,c,t[r+14],23,-35309556),c=md5hh(c,s,d,l,t[r+1],4,-1530992060),l=md5hh(l,c,s,d,t[r+4],11,1272893353),d=md5hh(d,l,c,s,t[r+7],16,-155497632),s=md5hh(s,d,l,c,t[r+10],23,-1094730640),c=md5hh(c,s,d,l,t[r+13],4,681279174),l=md5hh(l,c,s,d,t[r],11,-358537222),d=md5hh(d,l,c,s,t[r+3],16,-722521979),s=md5hh(s,d,l,c,t[r+6],23,76029189),c=md5hh(c,s,d,l,t[r+9],4,-640364487),l=md5hh(l,c,s,d,t[r+12],11,-421815835),d=md5hh(d,l,c,s,t[r+15],16,530742520),c=md5ii(c,s=md5hh(s,d,l,c,t[r+2],23,-995338651),d,l,t[r],6,-198630844),l=md5ii(l,c,s,d,t[r+7],10,1126891415),d=md5ii(d,l,c,s,t[r+14],15,-1416354905),s=md5ii(s,d,l,c,t[r+5],21,-57434055),c=md5ii(c,s,d,l,t[r+12],6,1700485571),l=md5ii(l,c,s,d,t[r+3],10,-1894986606),d=md5ii(d,l,c,s,t[r+10],15,-1051523),s=md5ii(s,d,l,c,t[r+1],21,-2054922799),c=md5ii(c,s,d,l,t[r+8],6,1873313359),l=md5ii(l,c,s,d,t[r+15],10,-30611744),d=md5ii(d,l,c,s,t[r+6],15,-1560198380),s=md5ii(s,d,l,c,t[r+13],21,1309151649),c=md5ii(c,s,d,l,t[r+4],6,-145523070),l=md5ii(l,c,s,d,t[r+11],10,-1120210379),d=md5ii(d,l,c,s,t[r+2],15,718787259),s=md5ii(s,d,l,c,t[r+9],21,-343485551),c=safeAdd(c,n),s=safeAdd(s,o),d=safeAdd(d,i),l=safeAdd(l,a);return[c,s,d,l]}function binl2rstr(t){var e,r="",n=32*t.length;for(e=0;n>e;e+=8)r+=String.fromCharCode(t[e>>5]>>>e%32&255);return r}function rstr2binl(t){var e,r=[];for(r[(t.length>>2)-1]=void 0,e=0;r.length>e;e+=1)r[e]=0;var n=8*t.length;for(e=0;n>e;e+=8)r[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return r}function rstrMD5(t){return binl2rstr(binlMD5(rstr2binl(t),8*t.length))}function rstrHMACMD5(t,e){var r,n,o=rstr2binl(t),i=[],a=[];for(i[15]=a[15]=void 0,o.length>16&&(o=binlMD5(o,8*t.length)),r=0;16>r;r+=1)i[r]=909522486^o[r],a[r]=1549556828^o[r];return n=binlMD5(i.concat(rstr2binl(e)),512+8*e.length),binl2rstr(binlMD5(a.concat(n),640))}function rstr2hex(t){var e,r,n="";for(r=0;t.length>r;r+=1)e=t.charCodeAt(r),n+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(15&e);return n}function str2rstrUTF8(t){return unescape(encodeURIComponent(t))}function rawMD5(t){return rstrMD5(str2rstrUTF8(t))}function hexMD5(t){return rstr2hex(rawMD5(t))}function rawHMACMD5(t,e){return rstrHMACMD5(str2rstrUTF8(t),str2rstrUTF8(e))}function hexHMACMD5(t,e){return rstr2hex(rawHMACMD5(t,e))}function md5(t,e,r){return e?r?rawHMACMD5(e,t):hexHMACMD5(e,t):r?rawMD5(t):hexMD5(t)}var ErrorStack=function(){function t(e){_classCallCheck(this,t),this.env=e||checkEnv(),this.stackFilter=generateHandler(this.env).filter}return _createClass(t,[{key:"makeReg",value:function(){switch(this.env){case"iOS":return/(?:\s*)\w+(?=@)|(?:@).*?(?=:\d*:)|(?::)\d*(?=:)|(?::)\d*$/g;default:return null}}},{key:"stackFormatter",value:function(t){var e=t.message,r=[],n="Android"===this.env,o="iOS"===this.env,i=t.stack.split("\n").filter(this.stackFilter);i.shift();var a=i.join("\n"),c=this.makeReg();return c?i.map((function(t){var e=t.match(c);if(e){var i=_slicedToArray(e,4),a=i[0],s=void 0===a?"":a,d=i[1],l=void 0===d?"":d,f=i[2],u=void 0===f?"":f,h=i[3],p=void 0===h?"":h,g=n?s.split(".").reverse()[0]:s,m=o?1:0;r.push("at ".concat(g," (").concat(l.substr(m),":").concat(u.substr(m),":").concat(p.substr(m),")"))}else r.push(t);return null})):r=i,{hash:this.encryptStack(e,r),message:e,stackList:r,stackStr:a}}},{key:"encryptStack",value:function(t,e){var r=[].concat(_toConsumableArray(e.slice(0,6)),_toConsumableArray(e.slice(7,8)),_toConsumableArray(e.slice(9,10)),_toConsumableArray(e.slice(11,12)),_toConsumableArray(e.slice(13,14))).join(";");return md5("".concat(t,":").concat(r))}}]),t}(),STACK_LENGTH_LIMIT=20,ChromeREGEX=/^\s*at .*? ?\(((?:file|https?|blob|chrome-extension|native|eval|<anonymous>).*?)(?::\d+)?(?::\d+)?\)?\s*$/i,GeckoREGEX=/^\s*.*?(?:\(.*?\))?(?:^|@)((?:file|https?|blob|chrome|resource|\[native).*?)(?::\d+)?(?::\d+)?\s*$/i,WinJSREGEX=/^\s*at (?:(?:\[object object\])?.+ )?\(?((?:file|ms-appx|https?|blob):.*?):\d+(?::\d+)?\)?\s*$/i;function parseStack(t){for(var e=t.slice(0,STACK_LENGTH_LIMIT),r=["",""],n={},o=1,i=0;e.length>i;i+=1){var a=ChromeREGEX,c=(e[i]||"").match(a);if(null===c&&(c=(e[i]||"").match(a=GeckoREGEX)),null===c&&(c=(e[i]||"").match(a=WinJSREGEX)),null!==c){var s=c[1],d=n[s];void 0===d&&(n[s]="#".concat(o,"#"),o+=1,d=n[s]),e[i]=e[i].replace(s,d)}}e.length>0&&(r[1]=e.map((function(t){return t.trim()})).join(""));var l="";for(var f in n)n.hasOwnProperty(f)&&(l+="".concat(f,"@").concat(n[f],";"));return l=l.replace(/;$/,""),r[0]=l,r.join("").replace(/\^/g,"").replace(/=/g,"").replace(/,/g,"")}function unParseStack(t){var e=t&&t.split("")||[];if(!e[0]||!e[1])return t;for(var r={},n=e[0].split(";"),o=0;n.length>o;o+=1){var i=n[o]&&n[o].split("@#");r["#".concat(i[1])]=i[0]}return e[1].replace(/#[0-9]+#/g,(function(t){return r[t]||""})).replace(/\u0004/g,"^").replace(/\u0005/g,"=").replace(/\u0006/g,",").split("")}"undefined"==typeof process||_typeof$1(process);var helper={compressStack:function(t){return parseStack(t)},uncompressStack:function(t){return unParseStack(t)}},compressStack=helper.compressStack;function hashDetection(t,e){try{var r=new XMLHttpRequest;r.open("GET","https://dataservice.alipayobjects.com/alertserver/hash/".concat(t),!0),r.send(),r.onreadystatechange=function(){if(4===r.readyState){if(200===r.status||304===r.status)return;e(1)}}}catch(t){this._warn("hash ç›‘æµ‹å¤±è´¥",t)}}var es=new ErrorStack;function logError(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n=r.code||errorCodeEnums.JS,o="";if(t&&t.stack){var i=es.stackFormatter(t),a=i.hash,c=i.stackList;a&&c&&c.length&&hashDetection(a,(function(){e.log({code:errorCodeEnums.JS,s1:a,s2:compressStack(c),s3:1})})),o=a}this.log(_objectSpread2({code:n,msg:t.message,s10:o},r))}catch(t){this._warn("Tracert å¼‚å¸¸ä¸ŠæŠ¥å¤±è´¥:",t)}}function logHttpError(t){var e=t.status,r=t.url,n=t.method,o=t.query,i=t.data,a=t.response,c=t.traceId,s=t.code,d=_objectWithoutProperties(t,["status","url","method","query","data","response","traceId","code"]),l=_objectSpread2({code:s||2,msg:"".concat(n.toUpperCase()," ").concat(r)},d);e&&(l.s1=e),o&&(l.s2=o),i&&(l.s3=i),a&&(l.s4=a),c&&(l.s5=c),this.log(l)}function logRequestError(t){try{if(!t)return;var e=t.type,r=void 0===e?"http":e;"http"===r&&logHttpError.call(this,t)}catch(t){this._warn("Tracert æŽ¥å£å¼‚å¸¸ä¸ŠæŠ¥å¤±è´¥:",t)}}var win$1=window,metaFieldMap={bm_app_id:"_bmAppId",bm_sprint_id:"_bmSprintId",env:"_env"},context={_monitorInited:!1,_monitorConfigInited:!1,_monitorConfigFailed:!1,_defaultExceptionSeedId:"102023",_bmAppId:"",_bmSprintId:"",_cachedHttpLines:[],_env:"",_cacheLogs:[],_trackedLogs:[],_monitorConfigs:[],_lastAction:"0".concat(getTime(),""),log:log,logError:logError,logRequestError:logRequestError,_preproccess:preproccess,_handleErrorOptions:handleErrorOptions$1,_initException:function(t){if(!this._monitorInited){for(var e=util.nodeListToArray(window.document.getElementsByTagName("meta")),r={},n=0,o=0;e.length>o;o++){var i=e[o],a=util.getAttr(i,"name"),c=util.getAttr(i,"content"),s=metaFieldMap[a];s&&c&&!this[s]&&(r[s]=c,n++)}t.TRACERT_ENV&&(r._env=t.TRACERT_ENV),n&&this.set(r),this._monitorInited=!0}},getErrorEventHandler:function(t){return function(e){t.isErrorHandler=!0,t._handleErrorOptions(e,(function(e){t.log(e)}))}},initMonitorConfigs:function(t){var e=t.monitors,r=void 0===e?[]:e;if(!this._disableInterface)for(var n=0;r.length>n;n++){var o=r[n];if(o.code===errorCodeEnums.REQUEST&&o.isActive&&!o.isDeleted){interfaceRegister(this);break}}this.set({_monitorConfigs:r}),this._monitorConfigInited=!0,this._onMonitorConfigInited()},_onMonitorConfigInited:function(){var t=this._cacheLogs;if(t.length){for(var e=0;t.length>e;e++)this.log(t[e]);this._cacheLogs=[]}},_warn:function(){if("object"===_typeof(win$1)&&win$1.console&&"function"==typeof win$1.console.warn&&this.debug){var t=Array.prototype.slice.call(arguments);win$1.console.warn.apply(null,["[Tracert Debug]".concat(t[0])].concat(t.slice(1)))}},_debug:function(){if("object"===_typeof(win$1)&&win$1.console&&"function"==typeof win$1.console.log&&this.debug){var t=Array.prototype.slice.call(arguments);win$1.console.log.apply(null,["[Tracert Debug]".concat(t[0])].concat(t.slice(1)))}}},win$2=window,doc$1=win$2.document;function register(t){try{if(!doc$1)return t.warn("å½“å‰ä¸ºéž web çŽ¯å¢ƒï¼Œä¸æ”¯æŒæŠ¥é”™ç›‘å¬ä¸Žæ’ä»¶ä½¿ç”¨"),this;if(t.isErrorHandler)return void t.warn("é”™è¯¯äº‹ä»¶å·²ç›‘å¬");util.addEvent("error",win$2,t.getErrorEventHandler(t)),util.addEvent("unhandledrejection",win$2,t.getErrorEventHandler(t))}catch(e){t.warn("Tracert åŠ è½½å¼‚å¸¸æ’ä»¶å¤±è´¥")}}function errorHandler(t){this._monitorConfigInited=!0,this._monitorConfigFailed=!0,this._onMonitorConfigInited(),this._warn("Tracert èŽ·å–æœåŠ¡ç«¯é…ç½®å¤±è´¥ï¼š",t)}function addScript(t){var e=this,r=errorHandler.bind(this),n=document.createElement("script");n.src=t,n.onerror=function(t){t.stopPropagation(),r.call(e,t)},document.head.appendChild(n),setTimeout((function(){e._monitorConfigInited||r.call(e,"è¶…æ—¶")}),5e3)}function fetchConfig(Tracert){var onError=errorHandler.bind(Tracert);if(!Tracert._bmAppId)return setTimeout((function(){onError("æ²¡æœ‰ bmAppid")}));var isPre="pre"===Tracert._env,url="https://render.alipay.com/p/alertserver".concat(isPre?"_pre":"","/").concat(Tracert._bmAppId,"_config/index.js");window.AlipayJSBridge?window.AlipayJSBridge.call("httpRequest",{url:url,method:"GET",contentType:"application/json"},(function(res){if(res&&200===res.status)try{eval(res.data)}catch(t){onError(t)}else onError("æœªæ‰¾åˆ°é…ç½®")})):addScript.call(Tracert,url)}function fetchConfig$1(t){try{fetchConfig(t)}catch(t){errorHandler.call(this)}}function send(t,e){t.postMessage(JSON.stringify(e),"*")}var verifyKey="__TRACERT_MONITOR_verify";function verify(t){var e,r=util.CrossIframe.initIframe();util.addEvent("load",r,(function(){send(e=r.contentWindow,{type:"storage",action:"get",key:verifyKey})})),util.addEvent("message",window,(function(r){try{var n=JSON.parse(r.data);if("getStorage"===n.type&&n.key===verifyKey){var o=JSON.parse(n.value)||{};o[t._bmAppId]=1,e&&send(e,{type:"storage",action:"set",key:verifyKey,value:JSON.stringify(o)})}}catch(t){}}))}function setVerify(t){t._bmAppId?util.load((function(){verify(t),setTimeout((function(){alert("è¯·å…³é—­è¯¥é¡µé¢æŸ¥çœ‹éªŒè¯ç»“æžœ"),setTimeout((function(){window.parent&&window.parent.close&&window.parent.close()}))}),100)})):alert("æœªèŽ·å–åˆ°åº”ç”¨ID")}var spliter="",doc$2=document,docEl$1=doc$2.documentElement;function setLastAction(t,e){try{var r=[],n="click"===t.type;r.push(n?1:2);var o=n?"".concat(getXPath(t.target,5)):"";r.push(o),r.push(getTime());var i=n?"".concat(t.x,"x").concat(t.y):"".concat(docEl$1.scrollLeft+doc$2.body.scrollLeft,"x").concat(docEl$1.scrollTop+doc$2.body.scrollTop);r.push(i);var a=t.target&&t.target.innerText,c=a?"".concat(a.slice(0,8)):"";r.push(c),e._lastAction=r.join(spliter)}catch(t){}}function lastAction(t){var e;util.addEvent("scroll",document,(function(r){e||(e=!0,setTimeout((function(){e=!1}),300),setLastAction(r,t))})),util.addEvent("click",document,(function(e){setLastAction(e,t)}))}function getQueries(){for(var t={},e=window.location.search.substring(1).split("&").map((function(t){return t.split("=")})),r=0;e.length>r;r++){var n=e[r];t[n[0]]=n[1]}return t}function handlePreCapture(t){var e=window.g_monitor;if(e){var r=e.listener,n=void 0===r?{}:r,o=e.events,i=void 0===o?[]:o;for(var a in n)n.hasOwnProperty(a)&&(util.removeEvent(a,window,n[a]),delete n[a]);for(var c=0;i.length>c;c++)t._handleErrorOptions(i[c],(function(e){t.log(e)}));e.events=[]}}var throttleWait=0,maxRecordLen=10,cachedHttpLineData=[];function sendHttpRequest(t){try{var e=new XMLHttpRequest;e.open("POST","https://mdap.alipay.com/loggw/dwcookieLogGet.do",!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send("data=".concat(t,"&time=").concat((new Date).getTime()))}catch(e){try{(new Image).src="".concat(this.server,"?data=").concat(t,"&time=").concat((new Date).getTime())}catch(t){this._warn("Tracert é€šè¿‡ IMG ä¸ŠæŠ¥å¤±è´¥.",t)}}}var sendAll=null;function httpLog(t){0===throttleWait?sendHttpRequest(t):(cachedHttpLineData.push(t),sendAll&&sendAll())}function throttle(t){var e=null;return function(){var r=this,n=arguments;function o(){clearTimeout(e),e=null,t.apply(r,n)}maxRecordLen>cachedHttpLineData.length?e||(e=setTimeout((function(){o()}),throttleWait)):o()}}function getHttpLog(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return throttleWait=t,sendAll=throttle((function(){if(cachedHttpLineData.length){var t=cachedHttpLineData.join("$$");cachedHttpLineData=[],sendHttpRequest(t)}})),httpLog}function getInfoFromBridge(t){try{var e=window.AlipayJSBridge;e.call("getUserInfo",(function(e){t.cUserId=e.userId})),e.call("getStartupParams",(function(e){t.cOfflineVer=e.version,e.version&&(t.cAppId=e.appId)}))}catch(e){setTimeout((function(){t._warn("è°ƒç”¨å®¹å™¨æŽ¥å£èŽ·å–ä¿¡æ¯å¤±è´¥",e)}))}}function init(t,e){if(!t._monitorInited&&e&&"object"===_typeof(e)){var r=e.autoCapture,n=void 0===r||r,o=e.httpThrottle,i=void 0===o?{}:o;t.set({_bmAppId:e.bmAppid,_bmSprintId:e.bmSprintId,_disableInterface:!!e.disableInterface,oncePerSession:!!e.oncePerSession,beforeLog:e.beforeLog}),t._httpLog=getHttpLog(i.wait||0);var a=getQueries();t._initException(a),fetchConfig$1(t),window.AlipayJSBridge?getInfoFromBridge(t):document.addEventListener("AlipayJSBridgeReady",(function(){getInfoFromBridge(t)}),!1),"1"===a.TRACERT_VERIFY&&setVerify(t),handlePreCapture(t),n&&register(t),lastAction(t)}}window.hashDetection=hashDetection;var index=function(t,e){return t.set(_objectSpread2({},context)),init(t,t.monitorOptions),t.after("start",(function(){init(t,t.monitorOptions)})),t.before("set",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.monitorOptions;init(t,r)})),e(),t};return index}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).tracertPluginPerformance=t(e.tracertUtil)}(this,(function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;arguments.length>t;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var a=function(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},n.exports),n.exports}((function(e){var t,n;t="undefined"!=typeof self?self:i,n=function(){if("object"==typeof window){var e,t=window,n={0:"navigate",1:"reload",2:"back_forward"},r=["unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart"];return t&&t.performance&&"object"==typeof t.performance&&t.performance.timing?"function"==typeof t.performance.getEntries&&"function"==typeof t.performance.getEntriesByType&&"function"==typeof t.performance.getEntriesByName&&"function"==typeof t.performance.now&&t.performance.timeOrigin?t.performance:e={_entry:function(){for(var e=t.performance.timing,o=e.navigationStart||e.redirectStart||e.fetchStart,i={entryType:"navigation",initiatorType:"navigation",name:t.location.href,startTime:0,duration:e.loadEventEnd?e.loadEventEnd-o:0,redirectCount:t.performance.navigation.redirectCount,type:n[t.performance.navigation.type]},a=0;r.length>a;a++){var c=r[a],f=e[c];i[c]=f?f-o:0}return i}(),timeOrigin:t.performance.timing.navigationStart,getEntries:function(){return[this._entry]},getEntriesByType:function(e){return"navigation"!==e?[]:[this._entry]},getEntriesByName:function(e){return e!==t.location.href?[]:[this._entry]},now:function(){return Date.now()-t.performance.timing.navigationStart}}:e}},e.exports?e.exports=n():t.timing2=n()}));var c=function(e){var t=e.records,n=e.start,r=e.timeout,o=e.load;if(0===t.length)return"number"==typeof r?r:0;"number"==typeof o&&t.forEach((function(e){e.weight=Math.pow(.5,Math.abs(parseFloat(e.t)-o)/1e3)}));var i=t.map((function(e,n){if(0===n)return 0;var r=t[n-1];return e.domCnt===r.domCnt?0:(e.domCnt-r.domCnt)/(e.t-r.t)*("number"==typeof e.weight?e.weight:1)})),a=Math.max.apply(null,i),c=i.indexOf(a);return t[c].t-n},f="number"==typeof __PAINTY_STACK_LIMIT__?__PAINTY_STACK_LIMIT__:100;function u(){return"object"==typeof performance&&"function"==typeof performance.now?performance.now():Date.now()}var d=["connectEnd","connectStart","decodedBodySize","domComplete","domContentLoadedEventEnd","domContentLoadedEventStart","domInteractive","domainLookupEnd","domainLookupStart","duration","encodedBodySize","fetchStart","loadEventEnd","loadEventStart","redirectCount","redirectEnd","redirectStart","requestStart","responseEnd","responseStart","secureConnectionStart","transferSize","type","unloadEventEnd","unloadEventStart","workerStart","firstPaint","firstContentfulPaint","firstMeaningfulPaint"];function s(e,n){if("object"!==t(e)||"function"!=typeof e.getEntriesByType)return[];var r=[],o=e.getEntriesByType("navigation");if(!o||0===o.length)return[];var i=o[0],a=function(e){if("object"!==t(e))return[];var n=e.getEntriesByType("paint"),r={};if(n.length){var o=(n.filter((function(e){return"first-paint"===e.name}))[0]||{}).startTime,i=(n.filter((function(e){return"first-contentful-paint"===e.name}))[0]||{}).startTime;r.firstPaint=parseFloat(o),r.firstContentfulPaint=parseFloat(i)}return r}(e),c={firstMeaningfulPaint:n};return d.forEach((function(e){var t=i[e]||a[e]||c[e];r.push(null==t||"number"==typeof t&&isNaN(t)?"-":"number"==typeof t?parseFloat(t.toFixed(2)):t)})),r}var l=[10240,51200,102400,204800,512e3],m=l.length+1;function p(e){return l.reduce((function(t,n,r){var o=l[r-1]||0,i={name:"imageSizeGroup".concat(r,"Count"),field:"img_".concat(r),val:e.filter((function(e){return n>e.encodedBodySize&&e.encodedBodySize>o})).length};return t.concat(i)}),[]).concat({name:"imageSizeGroup".concat(m,"Count"),field:"img_".concat(m),val:e.filter((function(e){return e.encodedBodySize>l[l.length-1]})).length})}var g=function(e){return"script"===e.initiatorType&&e.name.indexOf(".js")>-1},y=function(e){return"link"===e.initiatorType&&e.name.indexOf(".css")>-1},v=function(e){return"h2"===e.nextHopProtocol},h=function(e){return/^.*font.*\.svg(\?|$|#)/.test(e.name)},b=function(e){return"img"===e.initiatorType||/\.(jpg|jpeg|png|bmp|webp|svg|ico)(\?|$|#)/.test(e.name)&&!h(e)},S=function(e){return"iframe"===e.initiatorType},E=function(e){return"css"===e.initiatorType&&(/\.(ttf|eot|woff)(\?|$|#)/.test(e.name)||h(e))},T=function(e){return e.decodedBodySize>e.encodedBodySize},w=function(e){return e.encodedBodySize>e.transferSize},j=function(e){return e.workerStart},C=function(e){return e.reduce((function(e,t){return e+t.encodedBodySize}),0)};var z=null;function O(t,n){var r={pid:"tracert",msg:t.message,code:n,page:location.href,c1:(t.stack||"").slice(0,500),c2:(t.stack||"").slice(500,1e3),c3:(t.stack||"").slice(1e3,1500)};(new Image).src="//gm.mmstat.com/fsp.1.1?".concat(e.objToStr(r,"&"))}function P(e,r){if("object"===t(r)&&!e.metricsSent)try{var i=r.getEntriesByType("navigation")[0],a=s(r,z),c=function(e,n){if("object"!==t(e))return[];var r=e.getEntriesByType("resource").filter((function(e){return e.startTime&&n>e.startTime}));if(0===r.length)return[];var o=r.filter(g),i=r.filter(y),a=r.filter(b),c=r.filter(E),f=r.filter(S);return{metrics:[{name:"resourceCount",field:"rcnt",val:r.length},{name:"resourceSize",field:"rsize",val:C(r)},{name:"jsCount",field:"jscnt",val:o.length},{name:"jsSize",field:"jssize",val:C(o)},{name:"cssCount",field:"csscnt",val:i.length},{name:"cssSize",field:"csssize",val:C(i)},{name:"imageCount",field:"imgcnt",val:a.length},{name:"imageSize",field:"imgsize",val:C(a)},{name:"fontCount",field:"fontcnt",val:c.length},{name:"fontSize",field:"fontsize",val:C(c)},{name:"iframeCount",field:"iframecnt",val:f.length},{name:"iframeSize",field:"iframesize",val:C(f)},{name:"Http2EnabledCount",field:"h2cnt",val:r.filter(v).length},{name:"compressedResourceCount",field:"crcnt",val:r.filter(T).length},{name:"cachedResourceCount",field:"carcnt",val:r.filter(w).length},{name:"serviceWorkerResourceCount",field:"swrcnt",val:r.filter(j).length}],imageGroupMetrics:p(a)}}(r,i.duration),f=function(e,n){return"object"!==t(e)?[]:e.getEntriesByType("resource").filter((function(e){return["xmlhttprequest","fetch"].indexOf(e.initiatorType)>-1&&n>=e.startTime})).map((function(e){return[e.name.split("?")[0],e.startTime,e.transferSize,Math.round(e.responseStart-e.startTime),e.duration]}))}(r,i.duration);e.send(e.seedIdCfg.perfSeedId,o(o({nav:a.join("_")},(c.metrics||[]).reduce((function(e,t){return o(o({},e),{},n({},t.field,Math.round(t.val)))}),{})),{},{img_group:(c.imageGroupMetrics||[]).map((function(e){return e.val})).join("_"),network:navigator.connection&&navigator.connection.effectiveType||"-",partial:0===i.duration?1:0,ajax:f.map((function(e){return e.join("-")})).join("_"),title:document.title,visible:document.hidden?0:1})),e.metricsSent=!0}catch(e){O(e,12)}}function B(n){if("object"!==t(a))return n;try{!function(e,t){if("object"==typeof window&&"object"==typeof a){"function"==typeof e&&(t=e);var n=[],r=function e(){if("function"==typeof MutationObserver){var t=new MutationObserver((function(){n.push({t:u(),domCnt:document.getElementsByTagName("*").length}),n.length===f&&i()}));return t.observe(document,{childList:!0,subtree:!0}),t.disconnect.bind(t)}var r=setTimeout((function(){n.push({t:u(),domCnt:document.getElementsByTagName("*").length}),n.length===f?i():e()}),200);return function(){clearTimeout(r)}}();if("number"==typeof e)setTimeout(i,e);else{var o=!!navigator.userAgent.match(/iPhone|iPad|iPod/i);window.addEventListener(o?"pagehide":"beforeunload",i)}}function i(){if(r(),"object"==typeof a&&"function"==typeof a.getEntriesByType){var o=a.getEntriesByType("navigation");if(o&&o.length){var i=o[0];t(c({records:n,start:i.startTime,timeout:e,load:i.duration}))}}}}((function(e){z=e})),"function"==typeof a.setResourceTimingBufferSize&&a.setResourceTimingBufferSize(500);var r=!!navigator.userAgent.match(/iPhone|iPad|iPod/i);e.ownAddEventListener(r?"pagehide":"beforeunload",window,(function(){return P.bind(null,n,a)}),!1)}catch(e){O(e,11)}return n}return function(e,t){return B(e),t(),e}}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).tracertPluginClickAndExpo=t(e.tracertUtil)}(this,(function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);t>n;n++)r[n]=e[n];return r}function l(e,t){return window.getComputedStyle(e,t)}Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;n>o;){var i=t[o];if(e.call(r,i,o,t))return i;o++}},configurable:!0,writable:!0});var s=16,d=["deer-analysis-render-container","mocha"],f=[200,50],h=["svg","i","p","iframe","pre"],p=["label","input","button","img","iframe"],v=["svg","iframe","form","table"],m=["ul","header","section","article","aside"];function g(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}function y(e){if(Object&&Object.values)return Object.values(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t}function b(e,t){var n=g(e);if(0!==n.length){for(var r=0;n.length>r;r++)if(5>=Math.abs(n[r]-t))return void e[n[r]]++;e[t]=1}else e[t]=1}function w(e,t){if(!e||!e.children)return[];var n=[].slice.call(e.children)||[];return t?n.filter(t):n}function x(t){var n=e.getTagName(t).toLowerCase();return"div"===n||"span"===n?"span":n}function k(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=w(t,(function(e){return 8!==e.nodeType})),o=r.length;if("ul"===e.getTagName(t).toLowerCase())return!0;if(1>=o&&n>o)return!1;if(o>100)return!1;for(var i="",a=!0,c={},u={},l={},d=0,f=0;o>f;f++){var h=r[f],v=x(h);if(-1!==p.indexOf(v))return!1;if(h.offsetWidth>400&&h.offsetHeight>400)return!1;(s>h.offsetWidth||s>h.offsetHeight)&&d++;var m=Math.max(5,h.offsetWidth);b(c,m);var k=Math.max(5,h.offsetHeight);b(u,k);for(var T=0;h.classList.length>T;T++){var S=h.classList[T];l[S]=(l[S]||0)+1}if(a=i?i===v:a,i=v,!a)return!1}return a&&o/2>d&&-1!==y(l).indexOf(o)&&2>=g(c).length&&g(u).length<=o/2}function T(e){var t={};if(!e.attributes)return{};for(var n=0;e.attributes.length>n;n++){var r=e.attributes[n];t[r.name]=r.value}return t}function S(t){for(;t&&t.childNodes&&t.childNodes.length;){var n=[].slice.call(t.childNodes);if(n.find((function(e){return 3===e.nodeType})))return!0;t=n.filter((function(t){return!!e.getTagName(t)})).sort((function(e,t){return 24>e.offsetWidth?1:e.offsetLeft-t.offsetLeft}))[0]}return!!t&&!![].slice.call(t.childNodes||[]).find((function(e){return 3===e.nodeType}))}for(var O=["div","span","a","p","button","ul","li","ol","img","h1","h2","h3","h4","h5","h6","form"],N={},C=0;16>C;C++)N[O[C]]=C;function j(e){return function(e){var t=e.split(arguments.length>1&&void 0!==arguments[1]?arguments[1]:">");return Array.isArray(t)?t:[t]}(e,">").map((function(e){var t=e.split(":"),n=t[0],r=t[1],o=N.hasOwnProperty(n)?"".concat(N[n].toString(16)):n,i=r?r.replace(/nth-child\((\d+)\)/g,(function(e,t){return"".concat(t)})).replace(/nth-of-type\((\d+)\)/g,(function(e,t){return"t".concat(t)})):"";return"".concat(o).concat(i?"".concat("`").concat(i):"")})).join(">")}function E(e){var t=e.indexOf("\n");return-1!==t&&(e=e.substring(0,t)),e.trim().substring(0,15)}function I(n){if(!n||5===n.nodeType)return"";if(3===n.nodeType)return window.Text&&n instanceof Text?n.wholeText:n;if(!function(e){try{return e instanceof HTMLElement}catch(n){return"object"===t(e)&&1===e.nodeType&&"object"===t(e.style)&&"object"===t(e.ownerDocument)}}(n))return"";switch(e.getTagName(n).toLowerCase()){case"img":return"img:".concat(n.src);case"canvas":return"canvas"}var r=function(e){return e.childNodes||[]}(n),o=w(n),i=T(n);return 0===r.length||function(e){for(var t=0;e.length>t;t++)if(3===e[t].nodeType)return!0;return!1}(r)||0===o.length?n.innerText||i.placeholder||i.alt||l(n,":before").content||l(n,":after").content:I(o[0])}function L(e){var t=I(e);if(t&&"string"==typeof t)return E(t.replace(/\s/g,""));if(!e||w(e).length>3)return"";var n=e.innerText;return n?E(n):3>w(e.parentNode).length?E(L(e.parentNode)):""}function P(e){var t,n=w(e);if(!n||!n.length)return L(e);if(1===n.length)return E(P(n[0]));for(;(t=w(e))&&t.length;)return E(L(e=[].slice.call(t).sort((function(e,t){return 24>e.offsetWidth?1:e.offsetLeft-t.offsetLeft}))[0]));return""}function A(e){var t=l(e);return!t||("SCRIPT"===e.tagName||"none"===t.display||"relative"===t.position&&null===e.offsetParent||"absolute"===t.position&&(5>Math.abs(parseFloat(t.left)+e.offsetWidth)||5>Math.abs(parseFloat(t.top)+e.offsetHeight))||5>e.offsetWidth||5>e.offsetHeight)}function H(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(0===t)return!1;var n=w(e);if(0===n.length)return e.clientHeight>f;for(var r=0;n.length>r;r++){var o=n[r],i=l(o);if(("absolute"===i.position||i.float)&&o.clientHeight>50)return!0;if(H(o,t-1))return!0}return!1}function D(e){var t=e.getAttribute("id");return t&&t.substring(0,10)}function W(e){return e.classList&&e.classList.length?".".concat([].slice.call(e.classList,0,2).join(".")):""}function _(e){return e.id?D(e):W(e)}function M(e){return e.offsetWidth*e.offsetHeight}function R(e){var t=w(e);if(2>t.length||t.length>3)return!1;if(k(e,2))return!1;var n=e.offsetWidth,r=t[0],o=r.offsetWidth,i=r.offsetHeight,a=parseInt(l(r).lineHeight,10)||16;return o>=200&&o>=.9*n&&((!i||i>=a&&4*a>=i)&&!!S(r))}function B(t){var n=t;if(n.__possibleBlock)return!0;if("a"===e.getTagName(t).toLowerCase())return!1;if(function(e){return e.id&&-1!==d.indexOf(e.id)}(n))return!1;if(k(n))return!1;var r=w(n);return!(!r||!r.length)&&(n.offsetWidth>=200&&n.offsetHeight>=50)}function U(e){var t=w(e);if(t.length>200)return!0;for(var n=0;t.length>n;n++)if(T(t[n]).hasOwnProperty("contenteditable"))return!0;return!1}function q(t){var n,r=e.getTagName(t).toLowerCase(),o=t.parentNode;if(k(t.parentNode)&&o.children&&o.children.length){for(var i=0,a=0;o.children.length>a;a++){var c=o.children[a];if(e.getTagName(c).toLowerCase()===r&&i++,c===t)break}return"".concat(r,":nth-of-type(").concat(i,")")}for(var u=0;o.children.length>u;u++)if(o.children[u]===t){n=u+1;break}return"".concat(r,":nth-child(").concat(n,")")}function F(t){if(!t)return!1;var n=window.getComputedStyle(t);return"BODY"!==e.getTagName(t)&&"fixed"===n.position&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e)return!1;var n=e.getBoundingClientRect(),r=window.innerHeight/2,o=50>Math.abs(n.top+n.height/2-r),i=window.innerWidth/2,a=50>Math.abs((n.right-n.left)/2-i);return 1===t?o||a:o&&a}(t)&&function(e){if(!e)return!1;var t=window.getComputedStyle(e);return 50>Math.abs(e.offsetWidth-window.innerWidth)&&50>Math.abs(e.offsetHeight-window.innerHeight)&&("fixed"===t.position||e.offsetParent===document.body)}(t)}function J(e){var t=e.getBoundingClientRect();return 50>=Math.abs(t.width-window.innerWidth)&&(120>=t.height&&t.y<=t.height)}function V(e){var t=e.getBoundingClientRect();return 50>=Math.abs(t.width-window.innerWidth)&&(120>=t.height&&Math.abs(t.bottom-(e.offsetParent||document.body).offsetHeight)<=50)}window.getNodeText=L,window.getFirstNodeText=I,window.getBlockTitle=P,window.possibleBlock=B,window.possibleHeadedBlock=R;var G=["data-node-selector","data-block-selector"];function $(e,t){var n=2>=arguments.length||void 0===arguments[2]||arguments[2],r=t||document.body;if(e===r||e===document.body)return"body";if(n)for(var o=0;2>o;o++)if(e&&e[G[o]])return e[G[o]];var i=e,a=[];do{a.unshift(q(i))}while(i.parentNode&&i.parentNode!==document.body&&i.parentNode!==r&&(i=i.parentNode));return a.join(">")}window._getSelector=$,window._isModal=F;var Y={};function z(e){var t=1>=arguments.length||void 0===arguments[1]||arguments[1];return e.map((function(e){var n=e.node,r=e.selector||$(n,document.body,t);return n["data-block-selector"]=r,{block:n,selector:j(r)}}))}function K(e,t){var n=document.querySelector(e);if(!n||!function(e,t){if(e.contains&&"function"==typeof e.contains)return e.contains(t);var n=t;do{if(e===n)return!0}while(n=n&&n.parentNode);return!1}(n,t)){var r=Y[e];if(r){var o=$(r);return r["data-block-selector"]=o,Y[o]=r,r}return null}return n}function Q(e){var t,n=(t=window.visualViewport)?[t.offsetLeft,t.offsetTop,t.width,t.height]:[0,0,window.innerWidth,window.innerHeight],r=n[1],o=n[0]+n[3],i=e.getBoundingClientRect(),a=i.top,c=i.bottom,u=i.height;return r>=a&&c>=o||a>=r&&o>=c||a>=r&&o-a>=Math.min(300,u/2)||o>=c&&c-r>=Math.min(300,u/2)}function X(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{time:0,cnt:0},r=n.time,o=void 0===r?0:r,i=n.cnt,a=void 0===i?0:i,c={};if(!t)return c;var u=t.exposedTime+o,l=t.exposedCnt+a;return t.empty()&&document.body.contains(t.dom)?c[j($(t.dom))]={time:u,cnt:l,title:t.title,type:t.type,id:D(t.dom),cls:W(t.dom)}:e.objectAssign(c,t.children.reduce((function(t,n){return e.objectAssign(t,X(n,{time:u,cnt:l}))}),c)),c}var Z=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,r=arguments.length>1?arguments[1]:void 0;n(this,e),this.dom=document.body,this.children=[],this.selector="",this.lastExposingTime=0,this.exposedTime=0,this.exposedCnt=0,this.title="",this.type="",this.dom=t,this.type=r,this.title=P(t),this.expo()}return o(e,[{key:"visible",value:function(){return!!this.dom&&(!A(this.dom)&&Q(this.dom))}},{key:"pause",value:function(){this.empty()?this.unexposed(!0):[].concat(this.children.filter((function(e){return e.pause()})))}},{key:"expo",value:function(){if(!this.empty())return[].concat(this.children.filter((function(e){return e.expo()})));var e=this.dom;return this.visible()?(this.exposed(),[e]):(this.unexposed(),[])}},{key:"getExposed",value:function(e){return X(this,e)}},{key:"exposed",value:function(){return this.lastExposingTime?this.exposedTime+=Date.now()-this.lastExposingTime:this.exposedCnt++,this.lastExposingTime=Date.now(),this.exposedTime}},{key:"unexposed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.lastExposingTime){var t=Date.now()-this.lastExposingTime;(e||t>500)&&(this.exposedTime+=t)}return this.lastExposingTime=0,this.exposedTime}},{key:"empty",value:function(){return!this.children.length}},{key:"update",value:function(e){var t=this;e.forEach((function(e){return t.insert(e.node,e.type)})),z(e,!1)}},{key:"contains",value:function(e){return this.dom!==e&&this.dom.contains(e)}},{key:"insert",value:function(t,n){var r=this;if(this.children=this.children.filter((function(e){return r.contains(e.dom)})),!this.children.find((function(e){return e.dom===t}))){var o=this.children.find((function(e){return e.contains(t)}));o?o.insert(t,n):this.children.push(new e(t,n))}}}]),e}();function ee(){return new Z}var te=e.addEvent,ne=e.debounce,re=e.storage,oe=e.getAttr;function ie(t){for(var n,r=[],o=[],i=0;t.length>i;i++){var a=t[i];a&&((n=a).id&&-1!==d.indexOf(n.id)||-1!==h.indexOf(e.getTagName(n).toLowerCase())||A(a)?o.push(a):r.push(a))}return{ordered:r,disorderd:o}}function ae(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t)return[];for(var r=[],o=[],i=ie(t),a=i.ordered,c=i.disorderd,u=0;c.length>u;u++){var l=c[u];H(l)&&(l.__possibleBlock=!0,a.push(l))}a.sort((function(e,t){return M(e)-M(t)}));for(var s=0;a.length>s;s++){var d=a[s],f=w(d);if(oe(d,"data-aspm"))r=r.concat({node:d,type:"spm",selector:oe(d,"data-aspm")});else if(d&&e.getTagName(d)&&-1!==v.indexOf(e.getTagName(d).toLowerCase()))r=r.concat([{node:d,type:"short"}]);else if(U(d))r=r.concat([{node:d,type:"ugc"}]);else if(k(d))r=r.concat([{node:n[0],type:"list"}]);else if(F(d))r=r.concat([{node:d,type:"modal"}]);else if(J(d))r=r.concat([{node:d,type:"header"}]);else if(V(d))r=r.concat([{node:d,type:"footer"}]);else{if(R(d)){var h=function(){var e=ae(f,[d].concat(n)),t=[],o=[];return e.forEach((function(e){"pattern"===e.type?t.push(e):o.push(e)})),r=r.concat(t&&t.length?t.concat(o):[{node:d,type:"pattern"}]),"continue"}();if("continue"===h)continue}if(d.offsetWidth>document.body.offsetWidth)r=r.concat(ae(f,[d].concat(n)));else if(B(d)){if(1===f.length){var p=ae(f,[d].concat(n),!0);r=r.concat(p&&p.length?p:[{node:d,type:"hoist"}]);continue}var m=ae(f,[d].concat(n),!0);m&&m.length?r=r.concat(m):o.push({node:d,type:"stashed"})}else o.push({node:d,type:"stashed"})}}if(r.length>1){for(var g=0,y=n[0]||t[0],b=0;r.length>b;b++)if("list"===r[b].type&&g++,r[b].node===n[0]){if(y.__possibleBlock){r=r.concat([{node:y.parentNode,type:"hoist"}]);break}return[{node:y,type:"merge"}]}if(g>=r.length/2)return[{node:y,type:"hoist"}]}return o.length&&(r=a.length/2>r.length?[{node:n[0]||t[0],type:"end"}]:r.concat(o)),r}window._pickLayout=ae;var ce=function(){function e(t){var r=this;n(this,e),this.layout={},this.expoTree=null,this.paused=!1,this.pause=function(e){e.target!==window&&e.target!==document||r.paused||(r.expoTree.pause(),r.paused=!0)},this.resume=function(){r.paused&&(r.expoTree.expo(),r.paused=!1)},this.restore=function(){var e=r.tracert,t=re.get("exposed",{},!0);if(t){var n=t.split("|"),o=n[0],i=n[1];try{var a=decodeURIComponent(o),c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2500,n=[];for(var r in e)if(e.hasOwnProperty(r)){var o=e[r],i=o.time;n.push({time:i,text:[r,i,"",o.cnt,o.type,o.id,o.cls].join("")})}for(var a=n.sort((function(e,t){return t.time-e.time})),c=[],u=t,l=0;a.length>l;l++){var s=a[l].text,d=void 0===s?"":s;if(d.length>u)break;u-=d.length,c.push(d)}return c.join("")}(JSON.parse(i));a===r.tracert.refUrl&&e.after("start",(function(){e.call("expo","deer_expo","",{expo:c})}))}catch(e){}}},this.timeout=null,this.timeoutLog=function(){r.log(),r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout((function(){return r.log()}),500)},this.log=function(){r.paused||(r.cacheLayout(),r.expoTree.empty()||(r.expoTree.expo(),re.set("exposed","".concat(encodeURIComponent(location.href),"|").concat(JSON.stringify(X(r.expoTree))))))},this.tracert=t,this.expoTree=ee(),this.events()}return o(e,[{key:"events",value:function(){var e=this;te("blur",window,this.pause),te("focus",window,this.resume),te("visibilitychange",document,(function(t){"hidden"===document.visibilityState?e.pause(t):"visible"===document.visibilityState&&e.resume()})),te("scroll",window,ne((function(){return e.log()}),200)),te("beforeunload",window,(function(){e.expoTree.expo();var t=X(e.expoTree);re.set("exposed","".concat(encodeURIComponent(location.href),"|").concat(JSON.stringify(t)))})),this.tracert.before("logPv",(function(){e.restore(),e.expoTree.expo();var t=X(e.expoTree);re.set("exposed","".concat(encodeURIComponent(location.href),"|").concat(JSON.stringify(t))),Y={},e.expoTree=ee(),e.timeoutLog()}))}},{key:"cacheLayout",value:function(){var e=ae([document.body]);return this.expoTree.update(e),this.layout}},{key:"get",value:function(){return this.layout}}]),e}(),ue=e.strToObj;window.isList=k;var le=document&&document.body?.5*document.body.scrollWidth:0;function se(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||!e.length)return null;if(!t||!t.length)return null;if(t.length>e.length-n)return null;var r=Array.isArray(t[0])?t[0]:[t[0]];return r.find((function(t){return e[n].cursor===t}))?1===t.length?0===n?null:e[n-1].node:se(e,t.slice(1),n+1):se(e,t,n+1)}function de(t){var n=t;if(t instanceof SVGElement&&"svg"!==e.getTagName(t).toLowerCase())try{return de(t.ownerSVGElement)}catch(e){return console.debug("Failed to get ownerSVGElement"),{node:parent,type:5}}var r=[];do{if(t.id&&-1!==d.indexOf(t.id))return null;var o=T(t);if(t["data-block"]&&t["data-node-selector"])return{node:t,type:"CACHED",nodeSelector:t["data-node-selector"]};if(o["data-aspm"])break;if(o["data-aspm-click"])return{node:t,nodeSelector:"".concat(o["data-aspm-click"]),spm:!0,type:0};if("a"===e.getTagName(t).toLowerCase())return{node:t,type:1};if(-1===p.indexOf(e.getTagName(t).toLowerCase())){var i=l(t).cursor||"default";r.push({node:t,type:3,cursor:i})}else r.push({node:t,type:2})}while(t.parentNode&&t.parentNode!==document.body&&(t=t.parentNode));for(var a=0;r.length>a;a++){var c=r[a],u=c.type;if(2===u)return{node:c.node,type:u}}var s,f,h,v=se(r,["pointer",["default","auto"]]);return v?{node:v,type:3}:(f=(s=n).offsetWidth,h=s.offsetHeight,-1!==m.indexOf(e.getTagName(s).toLowerCase())||256>f*h||Math.max(f,h)>le||!S(s)&&!l(s).backgroundImage?null:{node:n,type:4})}function fe(e,t,n){var r=t.block,o=t.blockSelector,i=n.node,a=n.nodeSelector,c=n.nodeType,u=n.clickDom,s="";r&&(s=P(r),a=a||$(i,r));var d=L(e),f=u&&u.getAttribute?u.getAttribute("data-aspm-param"):"";return function(e){var t=e.dom,n=e.extraParams,r=e.block,o=e.blockSelector,i=e.blockTitle,a=e.blockId,c=e.node,u=e.nodeId,l=e.nodeSelector,s=e.nodeText,d=e.clickText,f=o||$(r);if(r&&(r["data-block-selector"]=f,Y[o]=r),c){c["data-block"]=f;var h=l||$(c,r);c["data-node-selector"]=h,Y[h]=c}return{dom:t,extraParams:n,node:l||$(c),nodeText:s,nodeId:u,block:(o||$(r)).replace(/\[data-aspm="([\w-]+)"\]/g,(function(e,t){return t})),blockTitle:i,blockId:a,clickText:d}}({dom:e,extraParams:ue(f),clickDom:u,node:i,nodeSelector:a,nodeMeta:{id:_(i),type:c,err:4===i.type&&"pointer"!==l(i).cursor},nodeId:_(i),nodeText:encodeURIComponent(d),block:r,blockTitle:encodeURIComponent(s),blockSelector:o,blockMeta:r?{id:_(r)}:null,clickText:encodeURIComponent(d)})}function he(e){if(!e||e===document.body)return null;var t=de(e);if(!t)return null;var n=t.node,r=t.type,o=t.node;if("CACHED"===r){var i=n["data-block"],a=K(i,n);if(a)return fe(e,{block:a,blockSelector:i},{node:n,nodeSelector:t.nodeSelector,clickDom:o})}var c=t.nodeSelector;if(0===r&&-1!==c.indexOf(".")){var u=c.split("."),l=u[0],s=u[1];return fe(e,{block:document.querySelector('[data-aspm="'.concat(l,'"]')),blockSelector:l},{node:n,nodeSelector:s,nodeType:r,clickDom:o})}for(var d=n,f=!1,h="",p=[];d&&d.parentNode&&d.parentNode!==document.body;){var v=d=d.parentNode,m=T(d);if(m["data-aspm"]){f=!0,h='[data-aspm="'.concat(m["data-aspm"],'"]');break}p.unshift(v)}if(f)return fe(e,{block:d,blockSelector:h},{node:n,nodeSelector:c,nodeType:r,clickDom:o});for(;d=p.pop();)if(d["data-block-selector"]){var g=d["data-block-selector"],y=K(g,d);if(!y)continue;return fe(e,{block:y,blockSelector:g},{node:n,nodeSelector:c||$(n,y),clickDom:o})}var b=function(e){for(var t=e,n=[t];t.parentNode&&t.parentNode!==document.body;){var r=t.parentNode;n.push(r),t=r}return n}(e),w=function(e,t){for(var n=t.length;n>0;n--)for(var r=t[n],o=0;e.length>o;o++){var i=e[o].block;if(i===r)return i}return!1}(z(ae([document.body])),b);return w?fe(e,{block:w,blockSelector:$(w)},{node:n,nodeSelector:c||$(n,w),clickDom:o}):null}var pe,ve,me,ge,ye=window,be="nameStorage:",we=/^([^=]+)(?:=(.*))?$/,xe=encodeURIComponent,ke=decodeURIComponent,Te={},Se={};function Oe(){var e,t=[],n=!0;for(var r in Te)Te.hasOwnProperty(r)&&(n=!1,e=Te[r]||"",t.push(xe(r)+"="+xe(e)));ye.name=n?pe:be+xe(pe)+"?"+t.join("&")}!function(e){if(e&&0===e.indexOf(be)){var t=e.split(/[:?]/);t.shift(),pe=ke(t.shift())||"";for(var n,r,o,i=t.join("").split("&"),a=0,c=i.length;c>a;a++)(n=i[a].match(we))&&n[1]&&(r=ke(n[1]),o=ke(n[2])||"",Te[r]=o)}else pe=e||""}(ye.name),Se.setItem=function(e,t){e&&void 0!==t&&(Te[e]=t+"",Oe())},Se.getItem=function(e){return Te.hasOwnProperty(e)?Te[e]:null},Se.removeItem=function(e){Te.hasOwnProperty(e)&&(Te[e]=null,delete Te[e],Oe())},Se.clear=function(){Te={},Oe()},Se.valueOf=function(){return Te},Se.toString=function(){var e=ye.name;return 0===e.indexOf(be)?e:be+e},me="beforeunload",ge=function(){Oe()},(ve=ye)&&(ve.addEventListener?ve.addEventListener(me,ge,!1):ve.attachEvent&&ve.attachEvent("on"+me,(function(e){ge.call(ve,e)}))),ye.nameStorage=Se;var Ne=Se,Ce=e.url,je="https://render.alipay.com/p/s/deer-analysis-render/index.js?_t=".concat(Date.now()),Ee="https://render.alipay.com/p/s/deer-analysis-render/index.css?_t=".concat(Date.now()),Ie="data-extra-spm",Le=[];function Pe(t){if(t){var n=t.getAttribute(Ie);if(!n)return;var r=function(e){return function(t){t&&e&&(t.extraSpmIdSet||(t.extraSpmIdSet={}),e.split(",").forEach((function(e){t.extraSpmIdSet[e]=!0})))}}(n);e.addEvent("click",t,r),Le.push([t,r])}}function Ae(t){t.refreshExtraClickListeners=function(){Le.forEach((function(t){var n=c(t,2);e.removeEvent("click",n[0],n[1])})),Le=[];for(var t=document.querySelectorAll("[data-extra-spm]"),n=0;t.length>n;n++)Pe(t[n])},t.refreshExtraClickListeners()}var He=e.addEvent,De=e.inIframe;return function(t,n){var r,o=t;if(De()||!window.getComputedStyle||!document.body.classList)return n(),o;function c(n){r||(r=new ce(t,{layout:n}),t.set({_expo:r}),e.load((function(){if(function(e){if(!e)return{};var t=e.split("&");if(!t.length)return{};for(var n={},r=0;t.length>r;r++){var o=(t[r]||"").split("=");n[o[0]]=o[1]||""}return n}(Ce.parse(location.href).query).deer_tracert_token||Ne.getItem("deer_tracert_token")){var e=document.createElement("script");e.type="text/javascript",e.src="".concat(je),document.getElementsByTagName("HEAD").item(0).appendChild(e);var t=document.createElement("link");t.href=Ee,t.rel="stylesheet",t.type="text/css",document.getElementsByTagName("HEAD").item(0).appendChild(t)}})))}return t._layout?c(t._layout):t.before("set",(function(e){e.hasOwnProperty("_layout")&&c(e._layout)})),He("click",document.body,(function(e){var t=he(e.target);t&&setTimeout((function(){var n=e.extraSpmIdSet,r=n?Object.keys(n):[],c=t.node,u=t.nodeText,l=t.nodeId,s=t.block,d=t.blockTitle,f=t.blockId,h=t.extraParams;c&&s&&o.after("start",(function(){o.call("click","".concat(j(s),".").concat(j(c)),function(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({nodeText:u,nodeId:l,blockTitle:d,blockId:f,extraSpmIds:r},h))}))}),0)})),Ae(o),n(),o}}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).tracertPluginClientSession=t(e.tracertUtil)}(this,(function(e){"use strict";var t=e.Cookies,i=e.uuid,n=".alipay.com",r=18e5,o="".concat(e.cookiesPrefix,"_SESSION"),a="tree";function u(){var e=t.get(o)||i();return t.set(o,e,{expires:new Date((new Date).getTime()+r),cookie:!0}),e}var c=e.objectAssign;return function(e,o){var f=e;return u(),f.before("logPv",(function(e){var o=function(e){var o={domain:document.domain&&-1!==document.domain.indexOf(n)?n:null,cookie:!0,expires:new Date((new Date).getTime()+r)},u=function(e,i,n){return t.set(a,[e,i,n].join(""),o),{_trid:i,_trll:n}},c=i();if(!e)return{};var f=t.get(a,o,!0);if(!f)return u(e,c,1);var s=f.split(""),l=s[0],d=s[1],p=s[2];return l!==e?u(l,c,1):u(l,d,parseInt(p,10)+1)}(f.spmAPos),s=u();e.__sid=s,c(e,o)})),o(),f}}));
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).tracertPluginFullfillRef=e(t.tracertUtil)}(this,(function(t){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var r=0;e.length>r;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=t.addEvent,o=t.storage,a=t.nodeListToArray,i=t.getAttr,l=t.url,c=".alipay.com",f=function(){function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tracert=e,this.isAlipayDomain=document.domain&&-1!==document.domain.indexOf(c),this.cookiesDomain=this.isAlipayDomain?c:null,this.tracert.before("logPv",(function(t){t=t||{};var e=r.get(),n=r.getMetaSpmId();n&&r.tracert.set({_spmId:n}),e&&e.metaSpmId&&(t._refSpm=e.metaSpmId,r.tracert.set({_refSpm:t._refSpm})),r.tracert.refUrl&&"-"!==r.tracert.refUrl&&e&&(r.tracert.set({refUrl:e.fullUrl}),r.tracert.referSPM||r.tracert.set({referSPM:e.refSpm}))})),n("click",window.document.body,(function(t){r.cache(t.target)}))}var f,u,s;return f=t,(u=[{key:"getMetaSpmId",value:function(){for(var t=a(window.document.getElementsByTagName("meta")),e="",r=0;t.length>r;r++){var n=t[r],o=i(n,"name"),l=i(n,"content");if(l&&o)switch(o){case"pagename":e=l}}return e?"".concat(this.tracert.spmAPos,".").concat(encodeURIComponent(e)):e}},{key:"cache",value:function(){var t=this.tracert.fullURL||"";t.length>150&&(t=this.tracert.url);var e=[t,"".concat(this.tracert.spmAPos,".").concat(this.tracert.spmBPos),this.getMetaSpmId()];o.set("fullfill_ref",e.join(""),{domain:this.cookiesDomain,cookie:!0})}},{key:"get",value:function(){var t=o.get("fullfill_ref",{domain:this.cookiesDomain},!0);if(!t)return null;var r=t.split(""),n=r[0],a=r[1],i=r[2],c=l.parse(this.tracert.refUrl),f=l.parse(n);return"object"!==e(c)||"object"!==e(f)?null:c.host===f.host?{fullUrl:n,refSpm:a,metaSpmId:i}:null}}])&&r(f.prototype,u),s&&r(f,s),t}();return function(t,e){var r=t,n=new f(r);return r.set({fullfillRef:n}),e(),r}}));
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).tracertPluginTimeOnPage=e(t.tracertUtil)}(this,(function(t){"use strict";function e(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var n=t.addEvent,i=t.storage,s=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pause=function(t){t.target===window&&(n.paused=!0,n._time_consumed+=Date.now()-n._start_timestamp)},this.resume=function(){n.paused&&(n._start_timestamp=Date.now())},this.cache=function(){var t=location.href,e=n.gettimeConsuming();i.set("residual","".concat(encodeURIComponent(t),"|").concat(e))},this._tracert_inst=e,this.paused=!1,this.start(),this.bindEventListeners()}var s,a,r;return s=t,(a=[{key:"start",value:function(){this._start_timestamp=Date.now(),this._time_consumed=0,this.lastClickEle=null,this.lastClickText=""}},{key:"bindEventListeners",value:function(){n("blur",window,this.pause),n("focus",window,this.resume),n("beforeunload",window,this.cache)}},{key:"gettimeConsuming",value:function(){return this.paused?this._time_consumed:this._time_consumed+(Date.now()-this._start_timestamp)}},{key:"getTime",value:function(){var t=i.get("residual",{},!0);if(!t)return null;var e=t.split("|"),n=e[0],s=e[1];try{if(decodeURIComponent(n)===this._tracert_inst.refUrl)return s}catch(t){return null}return null}}])&&e(s.prototype,a),r&&e(s,r),t}();return function(t,e){var n=t;n.before("logPv",(function(t){var e,i=n.timeConsuming.getTime();i&&(t._consume=i),t._title=(e=document.title).length>20?"".concat(e.substring(0,10)).concat(e.substring(e.length-10),"|").concat(e.length-20):e,n.timeConsuming.cache(),n.timeConsuming.start()}));var i=new s(n);return n.set({timeConsuming:i}),e(),n}}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).tracertPluginLayout=t(e.tracertUtil)}(this,(function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}var i=e.addEvent,o=e.storage;function a(e){return e.length>30?e.substr(0,30):e}function c(e){return e===document.body?"body":e.className?".".concat(a(e.className)):a(e.nodeName.toLowerCase())}function f(e){var t;e=e||[];for(var n=0;e.length>n;n++){var r=e[n];r.isLeaf||(r.children&&!(r=f(r.children))||t&&t.area>=r.area||(t=r))}return t}function u(e){e=e||[];for(var t,n,r,i=[],o=0;e.length>o;o++)n=void 0,r=void 0,n=(t=e[o]).offsetWidth,r=t.offsetHeight,"none"!==t.style.display&&Math.min(n,r)>=20&&Math.max(n,r)>=200&&t.children&&t.children.length>0&&i.push(e[o]);return i}function l(e){for(var t=e.node;;){var n=u(t.children),r=n.length;if(r>1)return n.map((function(e){return{node:e,area:e.offsetWidth*e.offsetHeight}}));if(1!==r)return null;t=n[0]}}function h(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=document.body,n=[{node:t,area:t.offsetWidth*t.offsetHeight}],r=1;;){var i=f(n);if(!i)break;var o=l(i);if(o?r-1+o.length>e?(i.children=o.splice(0,e-r+1),r=e):(i.children=o,r+=o.length-1):i.isLeaf=!0,r>=e)break}return n}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=t||[];return e.forEach((function(e){var t="".concat(n,"").concat(c(e.node));r.push(t),e&&e.children&&s(e.children,r,n+1)})),t?null:r.join("")}var d=function(){function e(n){var r=this;t(this,e),this.tracert=n,n.before("logPv",(function(e){var t=r.get();t&&(e._layout=t)})),this.cache(),i("click",document.body,(function(){r.cache()})),i("unload",window,(function(){r.cache()}))}return r(e,[{key:"getLayout",value:function(){return h(1/0)}},{key:"cache",value:function(){if(!this.cached){var e=h();o.set("layout","".concat(location.href,"|").concat(s(e))),this.cached=!0}}},{key:"get",value:function(){this.cached=void 0;var e=o.get("layout",{},!0);if(!e)return null;var t=e.split("|");return t[0]===this.tracert.refUrl?t[1]:null}}]),e}(),v=e.addEvent,g=e.storage,y=function(){function e(n){var r=this;t(this,e),this.tracert=n,this.tracert.before("logPv",(function(e){var t=r.get();t&&(e._clickReferer=t)})),v("click",document.body,(function(e){r.cache(e.target)}))}return r(e,[{key:"cache",value:function(e){var t=this.getText(e),n=this.getSectionHead(e),r="";n&&(r=this.getSectionTitle(n)),g.set("clickReferer","".concat(location.href,"").concat(this.format(t),"").concat(this.format(r)))}},{key:"get",value:function(){var e=g.get("clickReferer",{},!0);if(!e)return null;var t=e.split(""),n=t[2];return t[0]===this.tracert.refUrl?"".concat(t[1],"").concat(n):null}},{key:"getSectionTitle",value:function(e){for(;e&&e.children&&e.children.length;)e=[].slice.call(e.children).sort((function(e,t){return 24>e.offsetWidth?1:e.offsetLeft-t.offsetLeft}))[0];return this.getText(e)}},{key:"getSectionHead",value:function(e){for(;e.parentNode;){var t=e,n=e=e.parentNode,r=n.offsetWidth;if(r>=200&&r<document.body.offsetWidth){var i=n.children;if(i&&i.length){var o=i.length;if(o>=2&&3>=o&&i[0]!==t){var a=i[0],c=a.offsetWidth,f=a.offsetHeight;if(!(200>c||.9*r>c||14>f||f>60))return a}}}}return null}},{key:"getText",value:function(e){if(this.isTooManyChildren(e,3))return"";var t=e.innerText;if(!t){var n=e.parentNode;this.isTooManyChildren(n,3)||(t=n.innerText)}return t}},{key:"format",value:function(e){if(!e)return"";var t=e.length;return t>20?"...".concat(e.substr(t-20)):e}},{key:"isTooManyChildren",value:function(e,t){var n=0,r=function(e){var i=e.children;if(i){var o=i.length;if(t>=(n+=o)&&o)for(var a=0;o>a;a++)if(r(i[a]),n>t)return}};return r(e),n>t}}]),e}();return function(e,t){var n=e,r=new d(n),i=new y(n);return n.set({_layout:r,clickReferer:i}),t(),n}}));
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).tracertPluginAutoLogPv=e(t.tracertUtil)}(this,(function(t){"use strict";function e(t,e){for(var r=0;e.length>r;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=t.url;function n(){return document.body&&document.body.innerText&&document.body.innerText.length||0}var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tracert=e,this.curUrl=e.get("fullURL");var i=this.curUrlObj=r.parse(this.curUrl);this.curDocLen=n();var s=i.hash,a=this.isAnchor(s);a||(i.hash=this.cleanHash(s)),this.tracert.call("set",{url:a?this.curUrl.split(/\?|#/)[0]:i.format()}),this.tracert.call("addSideEffects",this.stop.bind(this)),this.start()}var i,s,a;return i=t,(s=[{key:"start",value:function(){var t=this;this.interval=setTimeout((function(){t.check(),t.start()}),500)}},{key:"stop",value:function(){console.log("stop"),clearTimeout(this.interval),this.interval=void 0}},{key:"check",value:function(){var t=window.location.href,e=this.diff(t);e&&(this.tracert.call("set",{refUrl:this.curUrl,referSPM:"".concat(this.tracert.spmAPos,".").concat(this.tracert.spmBPos),url:e.isHashSinglePage?e.format():t.split(/\?|#/)[0],fullURL:t}),this.tracert.call("logPv",e.isHashSinglePage?{}:{_nohash:1})),this.curUrl=t,this.curUrlObj=e||r.parse(t),this.curDocLen=n()}},{key:"diff",value:function(t){if(t===this.curUrl)return!1;var e=r.parse(t),n=e.hash,i=this.curUrlObj;return e.path===i.path&&function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return JSON.stringify(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})===JSON.stringify(t)}(e.query,i.query)?n!==i.hash&&!this.isAnchor(n)&&(e.isHashSinglePage=!0,e.hash=this.cleanHash(e.hash),e):e}},{key:"isAnchor",value:function(t){return!(!t||"#"===t)&&"/"!==(t=t.substr(1))[0]&&document.getElementById(decodeURI(t))&&5>Math.abs(this.curDocLen-n())}},{key:"cleanHash",value:function(t){if(!t)return t;var e=t.indexOf("?");return-1!==e&&(t=t.substr(0,e)),t}}])&&e(i.prototype,s),a&&e(i,a),t}();return function(t,e){var r=t,n=new i(r);return r.set({monitor:n}),r.before("set",(function(t){if(t&&t.pathName&&r.spmAPos){n.stop();var e=t.pathName,i=r.pathName;r._spmId&&(r._refSpm=r._spmId),r.fullURL=location.href,r._spmId="".concat(r.spmAPos,".").concat(encodeURIComponent(e)),i&&(r.refUrl=r.url,r.referSPM="".concat(r.spmAPos,".").concat(r.spmBPos),r.url=location.href.split(/\?|#|;jsessionid=/)[0],r.spmBPos=t.spmBPos||r.spmBPos,r.call("logPv"))}})),e(),r}}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).tracertWeb=t(e.tracertUtil)}(this,(function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var n=0;t.length>n;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);t>n;n++)i[n]=e[n];return i}var c,f,u,d,l=window,h="nameStorage:",p=/^([^=]+)(?:=(.*))?$/,g=encodeURIComponent,m=decodeURIComponent,y={},v={};function I(){var e,t=[],n=!0;for(var i in y)y.hasOwnProperty(i)&&(n=!1,e=y[i]||"",t.push(g(i)+"="+g(e)));l.name=n?c:h+g(c)+"?"+t.join("&")}!function(e){if(e&&0===e.indexOf(h)){var t=e.split(/[:?]/);t.shift(),c=m(t.shift())||"";for(var n,i,r,o=t.join("").split("&"),a=0,s=o.length;s>a;a++)(n=o[a].match(p))&&n[1]&&(i=m(n[1]),r=m(n[2])||"",y[i]=r)}else c=e||""}(l.name),v.setItem=function(e,t){e&&void 0!==t&&(y[e]=t+"",I())},v.getItem=function(e){return y.hasOwnProperty(e)?y[e]:null},v.removeItem=function(e){y.hasOwnProperty(e)&&(y[e]=null,delete y[e],I())},v.clear=function(){y={},I()},v.valueOf=function(){return y},v.toString=function(){var e=l.name;return 0===e.indexOf(h)?e:h+e},u="beforeunload",d=function(){I()},(f=l)&&(f.addEventListener?f.addEventListener(u,d,!1):f.attachEvent&&f.attachEvent("on"+u,(function(e){d.call(f,e)}))),l.nameStorage=v;var b=v,_=e.load,S=e.CrossIframe;function w(e,t){e.postMessage(JSON.stringify(t),"*")}var P=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.iframe=null,this.iframeLoaded=!1,this.userId=null,this.pending=!1,this.queue=[],this.cachedQuery=[],_((function(){window.addEventListener("message",(function(e){return t.receive(e)}),!1),t.iframe=S.initIframe()}))}var t,i,r;return t=e,(i=[{key:"receive",value:function(e){var t;if(e.data){try{t=JSON.parse(e.data)}catch(e){return}if(t.type)switch(t.type){case"getStorage":for(this.pending=!1;this.queue.length;)(0,this.queue[0])(t),this.queue.shift();break;case"iframOnload":this.iframeOnLoad()}}}},{key:"iframeOnLoad",value:function(){this.iframeLoaded=!0,this.executeCachedQuery()}},{key:"executeCachedQuery",value:function(){if(this.cachedQuery.length)for(var e=0;this.cachedQuery.length>e;e++){var t=a(this.cachedQuery[e]),n=t[0],i=t.slice(1);this[n].apply(this,i)}}},{key:"set",value:function(e,t,n){this.iframeLoaded?(n&&"function"==typeof n&&this.queue.push(n),w(this.iframe.contentWindow,{type:"storage",action:"set",key:e,value:t})):this.cachedQuery.push(["set",e,t,n])}},{key:"get",value:function(e,t){var n=this.iframe.contentWindow;this.iframeLoaded?(t&&"function"==typeof t&&this.queue.push(t),this.pending||(w(n,{type:"storage",action:"get",key:e}),this.pending=!0)):this.cachedQuery.push(["get",e,t])}}])&&n(t.prototype,i),r&&n(t,r),e}(),O=e.isWechat,j="TRACERT_REF_",k={_guid:function(){return e.uuid()},_initCrossStorage:function(e){O()||(e._crossStorage=new P)},_initClientId:function(e){var t=window.localStorage,n=e.sessionIdKey;t&&(t[n]||(t[n]="".concat(this._guid(),"_").concat(Date.now())),e.set({clientId:t[n]}),e._crossStorage&&e._crossStorage.get(n,(function(i){var r=i.value;if(n===i.key){var o=r||t[n];e.set({clientId:o}),r||e._crossStorage.set(n,o),t[n]!==o&&(t[n]=o)}})))},_initChInfo:function(t){if(!t.chInfo){var n=e.getValue("chInfo")||e.getValue("chinfo");n&&t.set({chInfo:n})}},_initVerify:function(t){var n=e.getValue("tracertTaskId"),i=e.getValue("tracertVerifyServer");n&&t.set({taskId:n}),i&&t.set({verifyServer:i})},_initPageId:function(e){if(!e.get("pageId")){var t="".concat(e.spmAPos,".").concat(e.spmBPos,"_").concat(this._guid(),"_").concat(Date.now());e.set({pageId:t})}},_initFromUrlOrStorage:function(t,n){for(var i=0;n.length>i;i++){var r=n[i],o=e.getValue(r)||b.getItem("".concat(j).concat(r));if(o){var a={};a[r]=o,t.set(a)}}},_initRefs:function(e){if(this._initFromUrlOrStorage(e,["referSPM"]),!e.ignoreNameStorage){var t=e._isMain;void 0!==t&&t&&(window.onunload=function(){var t=e.spmAPos&&e.spmBPos?[e.spmAPos,e.spmBPos].join("."):"";console.log("webMain",e._isMain),t&&b.setItem("".concat(j,"referSPM"),t)})}}},C=e.objectAssign,A={eventType:"click",fullURL:location.href,server:"https://collect.alipay.com/dwcookie",openSendBeacon:!1,refUrl:document.referrer||"-",seedIdCfg:{pageSeedId:"10012",clkSeedId:"10032",expoSeedId:"10022",perfSeedId:"10074",exceptionSeedId:"102022"},_v:"web",verifyServer:"https://log.alipay.com/realTimeNonNativeLogCheck/uploadLog.json",init:function(){this._calledInited||(k._initCrossStorage(this),k._initClientId(this),k._initChInfo(this),k._initPageId(this),k._initRefs(this),k._initVerify(this),this._calledInited=!0)},_logPv:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.spmAPos&&this.spmBPos?[this.spmAPos,this.spmBPos].join("."):"",i=document.getElementsByTagName("meta")["extra-page-spm"],r=[null].concat(i&&i.content?i.content.split(","):[]);r.forEach((function(i){e.call("remoteLog",{seedId:e.seedIdCfg.pageSeedId,spmId:n,extraPageId:i,param4:o({},t)})}))},remoteLog:function(e){this.init();var t=this._packFinalData(e);this._send(t)},_packFinalData:function(n){var i=n.spmId,r=n.seedId,o=n.param4,a=n.extraPageId;C(o,this.mdata||{});var s=o.__sid||k._guid();if(delete o.__sid,o.spmId=i,r!==this.seedIdCfg.pageSeedId&&r!==this.seedIdCfg.perfSeedId){var c=this.spmAPos,f=this.spmBPos;switch(i.split(".").length){case 1:if(""===i)break;o.spmId=[c,f,i].join(".");break;case 2:o.spmId=[c,f,i].join(".")}}var u=new Date,d=this.refSpm||this.referSPM||"";o.ref=this.refUrl,o.referSPM=d,this.chInfo&&(o.chInfo=this.chInfo),o.fullURL=this.fullURL,o.source_appid=this.spmAPos,this._spmId&&(o._spmId=this._spmId),this._refSpm&&(o._refSpm=this._refSpm),this.platformType&&(o.mPlatformType=this.platformType),this.bucUserId&&(o.__BUC_ID=this.bucUserId);var l=this.userType;if(!l)switch(l="3",this.spmAPos){case"a385":case"a369":l="2";break;case"a316":l="1"}o.__ut=l;var h=this.role_id||this.roleId||this.backupUserId||(o&&"3"===o.__ut?this.bucUserId:"")||"";if(o.clientID=this.clientId,"object"===t(o)){var p=o;for(var g in p)if(p.hasOwnProperty(g)&&"string"==typeof p[g]){var m=p[g].replace(/,/g,"%2C").replace(/\s+/g," ").replace(/=/g,"%3D");p[g]="fullURL"===g&&m.length>300?m.slice(0,300):m}}for(var y=function(e){return 10>e?"0".concat(e):"".concat(e)},v=["D-AE","".concat(u.getFullYear(),"-").concat(y(u.getMonth()+1),"-").concat(y(u.getDate())," ").concat(y(u.getHours()),":").concat(y(u.getMinutes()),":").concat(y(u.getSeconds()),":").concat(u.getMilliseconds()),this.clientID,"","2","",s,h,1e3,r,this.bizType,this.logLevel,a||this.pageId,"","","","","","","","","","","","","".concat(window.innerWidth||"","x").concat(window.innerHeight,"x").concat(window.devicePixelRatio),"","","",navigator.userAgent,"","","",e.objToStr(this.sysInfo),"","",e.objToStr(o)],I=0;v.length>I;I++)"string"==typeof v[I]&&(v[I]=v[I].replace(/,/g,"%2C"));return v},_send:function(t){e.request({tracert:this,type:e.requestTypeEnum.http,data:t})},send:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"10032",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this._runBeforeFns("send",t),this.remoteLog({spmId:n||"".concat(this.spmAPos,".").concat(this.spmBPos),seedId:e,param4:t})}};return function(e,t){var n=e;return n.set(o({},A)),t(),n}}));
 'use strict'; var win = window; if (!win.Tracert || win.Tracert._isInit || win.Tracert._isRenderInit) { var Tracert = new win.tracertCore(); Tracert.set({ userType: '1', spmAPos: 'a1911', spmBPos: 'b18234' }); Tracert.setSysInfo({ v: '2f39b' }); var plugins = [ win.tracertWeb, win.tracertMonitor, win.tracertPluginPerformance, win.tracertPluginClickAndExpo, win.tracertPluginClientSession, win.tracertPluginFullfillRef, win.tracertPluginTimeOnPage, win.tracertPluginLayout, win.tracertPluginAutoLogPv ]; Tracert.loadPlugins(plugins); win.Tracert = Tracert; } 