!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("heartbeat",[],n):"object"==typeof exports?exports.heartbeat=n():t.heartbeat=n()}(window,function(){return i={},o.m=e=[function(t,n,e){"use strict";function c(){return function(t){for(var n=window.location.search,e=(n="?"===n[0]?n.substring(1):n).split("&"),o=0;o<e.length;o+=1){var i=e[o].split("=");if(i[0]===t)return i[1]}return""}("plid")}function u(){var t=window.location.hostname.includes("co.uk")?-3:-2;return window.location.hostname.split(".").slice(t).join(".")}function o(t,n){for(var n=1<arguments.length&&void 0!==n?n:"",e=document.cookie.split(";"),o=0;o<e.length;o++){var i=e[o].split("=");if(i[0].trim()===t)return decodeURIComponent(i[1])}return n}function i(t,n){var e,o,i,r,a;return 401===t.status?(r=window.location.hostname,a=u(),e=r.replace(".".concat(a),""),o=u(),i=encodeURIComponent(window.location.pathname+window.location.search),r=window.location.port,a=c(),i="https://sso.".concat(o,"/logout?realm=idp&app=").concat(e,"&path=").concat(i,"&to_generic=true"),r&&(i+="&port=".concat(r)),a&&1!=+a&&(i+="&plid=".concat(a)),i=i,window.location.assign(i)):201===t.status&&function(t,n,e,o){o=3<arguments.length&&void 0!==o?o:31536e3,n=encodeURIComponent(n),o="".concat(t,"=").concat(n,";domain=").concat(e,";max-age=").concat(o,";path=/");document.cookie=o}("info_idp_vat_time",Date.now(),n),t}function r(){var t=+o("info_idp_vat_time",0);if(24e4<=Date.now()-t){var t={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({infotoken:"true",realm:"idp"}),credentials:"include"},n=u();return fetch("https://sso.".concat(n,"/v1/api/token/ui_heartbeat"),t).then(function(t){return i(t,n)})}}function a(){var t;window.disableHeartbeat||(t=o("info_idp"))&&function(t){var n=JSON.parse(t);if("basic"===n.auth&&"idp"===n.typ){var e=!0,t=n.plid,n=c();(e=n&&+t!=+n?!1:e)&&(setInterval(r,6e4),r())}}(t)}e.r(n),e.d(n,"handleVatResult",function(){return i}),e.d(n,"checkVat",function(){return r}),e.d(n,"main",function(){return a}),a()}],o.c=i,o.d=function(t,n,e){o.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:e})},o.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},o.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(n,"a",n),n},o.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},o.p="",o(o.s=0);function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}var e,i});
