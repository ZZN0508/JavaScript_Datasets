define(["OK/utils/dom","OK/LogSeen","OK/utils/utils","OK/HookModel"],function(c,e,d,l){function f(a,n,s){var i,o,t=c.firstByClass(a,"comments");t&&(i=t.getAttribute("data-id"),o=t.getAttribute("data-type"),i&&o&&require(["OK/DiscussionManager","jquery"],function(t,e){t.forEachOpened(i,o,function(){e.contains(a,this.element[0])&&this.focusForm(n,s)})}))}return{activate:function(u){u.hasAttribute("data-seen-params")&&e.activate(u),c.byClass(u,"js-scrollToComments").forEach(function(t){var e=parseInt(t.getAttribute("data-scroll-offset")),a=parseInt(t.getAttribute("data-scroll-duration"));t.addEventListener("click",function(){var n,s,i,t,o,r;n=u,s=e,i=a,(r=c.firstByClass(n,"feed-comments-stub"))?(t=r.getAttribute("data-link"),o=l.extractHookId(r.getAttribute("id")),d.ajax({type:"POST",url:t}).done(function(t,e,a){null!=t&&(OK.hookModel.setHookContent(o,t),r.classList.remove("feed-comments-stub"),f(n,s,i))})):f(n,s,i)})})},deactivate:function(t){t.hasAttribute("data-seen-params")&&e.deactivate(t)}}});
