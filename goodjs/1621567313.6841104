define("lofty/ui/tabs/2.0/tabs",["lofty/lang/class","lofty/ui/widget/1.0/widget","lofty/util/template/2.0/tplhandler","jquery","lofty/util/webp/1.0/webp","lofty/util/exposure/1.0/exposure","lofty/util/datalazyload/2.0/datalazyload"],function(e,t,i,s,o,n,l){"use strict";function a(){var e=this.get("effect");"string"==typeof e&&(this.get("el").addClass("fui-tab-effect-"+e),e=c.Effect[e]),this.get("size")&&this.get("el").addClass("fui-tab-l"),e="function"==typeof e?{show:e}:e,e.setup&&e.setup(this),this.effect=e}function r(){var e=this.get("autoPlay");if(e&&!(this.boxes.length<=1)){var t=this,i=this.get("interval"),s=!1,o=!0;this.get("stopWhenHide")||this.get("playWhenCompleteShow")?(t._exposureObj=new n({target:t.get("el"),threshold:0,onlyOnce:!1}),this.get("playWhenCompleteShow")?(t._exposureObj.on("completeShow",function(e){e.is(t.get("el"))&&(o=!1)}),t._exposureObj.on("partShow",function(e){e.is(t.get("el"))&&(o=!0)})):t._exposureObj.on("exposure",function(e){e.is(t.get("el"))&&(o=!1)}),t._exposureObj.on("hide",function(e){e.is(t.get("el"))&&(o=!0)}),t._exposureObj.execute()):o=!1,this.get("el").on("mouseenter",function(){s=!0}).on("mouseleave",function(){s=!1});var l=function(){if(t._pause||o||s)return void(t.loopTimer=setTimeout(l,i));var n=0;if("random"===e)for(;t.index===(n=Math.floor(Math.random()*t.boxes.length)););else{var a=t.index+t.get("step");n=a%t.boxes.length,t.loopAndAnim&&(t.simulateIndex=a)}t._switchTo(n,function(){t.loopTimer2=setTimeout(l,i)})};t.loopTimer=setTimeout(l,i)}}function h(e,t){o.convertSrc(t,function(t){e.attr("src",t)})}function f(e){if(this.get("isLazy")){var t=this;if(e){var i={container:t.get("el"),imgSrcName:t.get("imgSrcName"),threshold:t.get("threshold"),webp:t.get("webp")};i.overflowContainer=t.get("overflowContainer"),t._lazyObj=new l(i)}else t.on("beforeSwitch",function(e){for(var i=t.get("el").find(e.boxSelector).eq(e.index).find("img["+t.get("imgSrcName")+"]"),o=0,n=i.length;n>o;o++){var l=s(i[o]),a=l.attr(t.get("imgSrcName"));t.get("webp")?h(l,a):l.attr("src",a),l.removeAttr(t.get("imgSrcName"))}})}}var c=e(t,{options:{autoPlay:"",stopWhenHide:!1,playWhenCompleteShow:!1,interval:3e3,event:"mouseenter",currentCls:"fui-tab-current",disableCls:"disabled",size:"small",titleSelector:".fui-tab-t",boxSelector:".fui-tab-b",selected:0,effect:"default",overflowContainer:".fui-d-container",isLoop:!0,isLazy:!1,webp:!0,step:1,listenDefault:!1,titleEvtPrevent:!0,imgSrcName:"data-lazyload-src",threshold:10,duration:500,prev:".fui-tab-prev",next:".fui-tab-next",items:[],classPrefix:"fui"},events:{"{options.titleSelector}":{"{options.event}":"onTitleEvent"},"{options.prev}":{click:"prev"},"{options.next}":{click:"next"},"{options.titleSelector} a":{click:function(e){this.get("titleEvtPrevent")&&e.preventDefault()}}},_create:function(){this.render();var e=this;this.index=-1;var t=this.get("selected")||0,i=this.get("el");this.titles=i.find(this.get("titleSelector")),this.boxes=i.find(this.get("boxSelector")),this.prevNode=i.find(this.get("prev")),this.nextNode=i.find(this.get("next")),0!==this.boxes.length&&(a.call(this),r.call(this),this.loopAndAnim=this.get("isLoop")&&this.effect.moveAnim,this.get("listenDefault")?setTimeout(function(){e._switchTo(t)},0):this._switchTo(t))},_switchTo:function(e,t){if(this._maxIndex&&e>this._maxIndex&&(e=this._maxIndex),e!==this.index){var i=this,s={lastIndex:this.index,index:e,element:this.get("el"),duration:this.get("duration"),titles:this.titles,boxes:this.boxes,boxSelector:this.get("boxSelector"),overflowContainer:this.get("el").is(this.get("overflowContainer"))?this.get("el"):this.get("el").find(this.get("overflowContainer")),self:i};this.simulateIndex&&(s.simulateIndex=this.simulateIndex),this.trigger("beforeSwitch",s);var o=this.get("currentCls"),n=this.get("disableCls");this.titles.eq(this.index).removeClass(o);var l=this.get("isLoop");this.titles.eq(e).addClass(o),this.index=e,this.effect.show(s,function(){i.boxes.eq(s.lastIndex).removeClass(o),i.boxes.eq(s.index).addClass(o),l||(i.prevNode.toggleClass(n,0===s.index),i.nextNode.toggleClass(n,s.index===i.boxes.length-1)),t&&t(),i.trigger("switch",s)})}},onTitleEvent:function(e){this.get("titleEvtPrevent")&&e.preventDefault();var t=s(e.currentTarget),i=this.titles.index(t);this.loopAndAnim&&(this.simulateIndex=i),this._switchTo(i)},switchTo:function(e,t){this.loopAndAnim&&(this.simulateIndex=e),this._switchTo(e,t)},prev:function(e){if(e&&e.preventDefault&&e.preventDefault(),this._canClick!==!1){var t=this.index-this.get("step");return t>=0?(this.loopAndAnim&&(this.simulateIndex=t),this._switchTo(t)):this.get("isLoop")?(this.effect.moveAnim&&(this.simulateIndex=t),this._switchTo(this.boxes.length+t)):this.index>0&&this._switchTo(0),this}},next:function(e){if(e&&e.preventDefault&&e.preventDefault(),this._canClick!==!1){var t=this.index+this.get("step");return t<this.boxes.length?(this.loopAndAnim&&(this.simulateIndex=t),this._switchTo(t)):this.get("isLoop")?(this.effect.moveAnim&&(this.simulateIndex=t),this._switchTo(t-this.boxes.length)):this.index<this.boxes.length-1&&this._switchTo(this.boxes.length-1),this}},addTab:function(e,t){return this},removeTab:function(e){return this},getLength:function(){return this.boxes.length},getCurrentIndex:function(){return this.index},pause:function(){this._pause=!0},resume:function(){this._pause=!1},handleTpl:function(){var e={};e.classPrefix=this.get("classPrefix"),e.items=this.get("items")||[],i.process.call(this,e)},tpl:['<div class="{{classPrefix}}-tab">','<div class="{{classPrefix}}-t">','<ul class="{{classPrefix}}-tab-ul">',"{{each items as item}}",'<li class="{{classPrefix}}-tab-t"><a href="#">{{item.label}}</a></li>',"{{/each}}","</ul>","</div>",'<div class="{{classPrefix}}-d-container">','<div class="{{classPrefix}}-d">',"{{each items as item}}",'<div class="{{classPrefix}}-tab-b">{{item.content}}</div>',"{{/each}}","</div>","</div>","</div>"].join(""),end:0,destroy:function(){this._exposureObj&&this._exposureObj.destroy(),this.loopTimer&&clearTimeout(this.loopTimer),this.loopTimer2&&clearTimeout(this.loopTimer2),s(this.get("overflowContainer")).stop(!0),t.prototype.destroy.call(this)}});return c.Effect={"default":{setup:function(e){f.call(e,!1)},show:function(e,t){e.boxes.hide(),e.boxes.eq(e.index).show(),t()}},updown:{moveAnim:!0,setup:function(e){var t=e.get("el").is(e.get("overflowContainer"))?e.get("el"):e.get("el").find(e.get("overflowContainer")),i=t.height(),s=0,o=0,n=e.boxes.length;if(e.get("isLoop")){for(var l=e.boxes.eq(0).parent(),a=e.get("step")-1;a>o;o++){var r=e.boxes.eq(o).clone();r.addClass("_tab_simulate_item_"),l.append(r)}for(;i>s&&n>o;){var h=e.boxes.eq(o),c=h.clone();c.addClass("_tab_simulate_item_"),l.append(c),o++,s+=h.outerHeight(!0)}}else{for(o=n;i>s&&o>0;){o--;var h=e.boxes.eq(o);s+=h.outerHeight(!0)}e._maxIndex=o}f.call(e,!0)},show:function(e,t){e.self._canClick=!1;var i,o=!1,n=!1,l=e.overflowContainer?s(e.overflowContainer):s();e.simulateIndex&&e.simulateIndex!==e.index?(e.simulateIndex<0?(e.simulateIndex=e.index,n=!0):o=!0,i=e.element.find(e.boxSelector).eq(e.simulateIndex)):i=e.boxes.eq(e.index);var a,r=e.overflowContainer;n&&(a=l.scrollTop(),l.stop(!0).scrollTop(e.element.find(e.boxSelector).eq(e.boxes.length+e.lastIndex).offset().top-r.offset().top+a));var h=function(){o&&(a=l.scrollTop(),l.stop(!0).scrollTop(e.boxes.eq(e.simulateIndex-e.boxes.length).offset().top-r.offset().top+a)),t(),e.self._canClick=!0},f=i.offset().top,c=r.offset().top;a=l.scrollTop(),l.stop(!0).animate({scrollTop:f-c+a},e.duration,h)}},leftright:{moveAnim:!0,setup:function(e){var t=e.get("el").is(e.get("overflowContainer"))?e.get("el"):e.get("el").find(e.get("overflowContainer")),i=t.width(),o=0,n=0,l=e.boxes.length;if(e.get("isLoop")){for(var a=e.boxes.eq(0).parent(),r=e.get("step")-1;r>n;n++){var h=e.boxes.eq(n).clone();h.addClass("_tab_simulate_item_"),a.append(h)}for(;i>o&&l>n;){var c=e.boxes.eq(n),d=c.clone();d.addClass("_tab_simulate_item_"),a.append(d),n++,o+=c.outerWidth(!0)}}else{for(n=l;i>o&&n>0;){n--;var c=e.boxes.eq(n);o+=c.outerWidth(!0)}e._maxIndex=n}var u=e.get("el").find(e.get("boxSelector")),x=0,p=u.eq(0).parent();u.each(function(){var e=s(this),t=e.outerWidth(!0);x+=t}),p.addClass("fd-clr").width(x+100),u.css("float","left"),f.call(e,!0)},show:function(e,t){e.self._canClick=!1;var i,o=!1,n=!1,l=e.overflowContainer?s(e.overflowContainer):s();e.simulateIndex&&e.simulateIndex!==e.index?(e.simulateIndex<0?(e.simulateIndex=e.index,n=!0):o=!0,i=e.element.find(e.boxSelector).eq(e.simulateIndex)):i=e.boxes.eq(e.index);var a,r=e.overflowContainer;n&&(a=l.scrollLeft(),l.stop(!0).scrollLeft(e.element.find(e.boxSelector).eq(e.boxes.length+e.lastIndex).offset().left-r.offset().left+a));var h=function(){o&&(a=l.scrollLeft(),l.stop(!0).scrollLeft(e.boxes.eq(e.simulateIndex-e.boxes.length).offset().left-r.offset().left+a)),t(),e.self._canClick=!0},f=i.offset().left,c=r.offset().left;a=l.scrollLeft(),l.stop(!0).animate({scrollLeft:f-c+a},e.duration,h)}},fade:{setup:function(e){f.call(e,!1)},show:function(e,t){return e.boxes.eq(e.index).hasClass(e.self.get("currentCls"))?void t():(e.boxes.hide(),void e.boxes.eq(e.index).fadeIn(e.duration,t))}},intersectFade:{setup:function(e){e.prevNode.css("z-index","3"),e.nextNode.css("z-index","3");var t=e.boxes.eq(0).parent();t.css("position","relative"),e.boxes.css({position:"absolute",left:"0",top:"0"}),e.boxes.not(e.boxes.eq(0)).hide(),f.call(e,!1)},show:function(e,t){var i=e.self;return e.boxes.eq(e.index).hasClass(e.self.get("currentCls"))?void t():(e.boxes.stop(!0).not(e.lastIndex).css({"z-index":1,opacity:0}).hide(),e.boxes.eq(e.lastIndex).css({"z-index":2,opacity:1}).show(),i.tmId&&(clearTimeout(i.tmId),i.tmId=null),e.boxes.eq(e.lastIndex).animate({"z-index":1,opacity:0},e.duration),i.tmId=setTimeout(function(){e.boxes.eq(e.index).show().animate({"z-index":2,opacity:1},e.duration)},.5*e.duration),void t())}}},c});;