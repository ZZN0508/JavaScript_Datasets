(()=>{const t=2e3;let o=!1;class l{static isInterruptionReported(){return o}static detectCardInterrupted(e){if(e)try{l.checkForClashAndReport(e),setTimeout(()=>{l.checkForClashAndReport(e)},t)}catch(e){__trcError(`error in detectCardInterrupted: ${e}`,e)}}static checkForClashAndReport(e){var t;l.isInterruptionReported()||(t=l.getClashingElement(e))&&l.report(t,e)}static getClashingElement(n){const e=n.getBoundingClientRect(),r=TRC.intersections.getPointsOnElement(e,["lt","mt","rt","lm","mm","rm","lb","mb","rb"]);let s=null;return Object.keys(r).some(e=>{var t=r[e],e=document.elementFromPoint(t.targetElementCenterX,t.targetElementCenterY),t=e&&l.isClashingElement(n,e);return t&&(s=e),t}),s}static isClashingElement(e,t){return!l.isRelativeElement(e,t)&&!l.isExcludedElement(t,e)&&l.areOverlapping(e,t)}static isRelativeElement(e,t){return e===t||e.contains(t)||t.contains(e)}static areOverlapping(e,t){var n,r,s=t.getBoundingClientRect(),o=e.getBoundingClientRect();if(r=o,(n=s).bottom<r.top||r.bottom<n.top||n.right<r.left||r.right<n.left)return!1;var l=Math.max(s.top,o.top),t=Math.min(s.bottom,o.bottom),e=Math.max(s.left,o.left),o=Math.min(s.right,o.right);return 2500<=Math.abs((t-l)*(o-e))}static report(e,t){const n=TRC.dom.closest(t,"[data-placement-name]"),r={publisher:{id:TRC.publisherId,type:TRC.listOrigin.getSource(),pageUrl:location.href},page:{scrollY:TRC.dom.getPageVerticalScroll(),viewportWidth:TRC.dom.getWindowWidth()},clashItem:{placement:n&&n.getAttribute("data-placement-name"),id:e.id,class:e.className,xpath:d.xPath(e,!1),url:e.src||e.querySelector("iframe")&&e.querySelector("iframe").src}},s={event_type:"OVERLAY_MEASUREMENT",event_state:"REPORTED",event_value:JSON.stringify(r)};TRCImpl.sendEvent("supply-feature",{d:JSON.stringify(s)},{}),TRC.util.isPercentEnabled(TRCImpl.global,"take-screenshot-on-violation")&&TRC.ModuleLoader.load("screenshot-capture",TRC.screenshotCaputre,function(){TRC.screenshotCaputre.init(document.body,{keepImages:!0})}.trcBind(this)),o=!0}static isExcludedElement(e,t){const n={element:e,rect:e.getBoundingClientRect(),cardRect:t.getBoundingClientRect()};return a.some(e=>{const t=i[e];return t.shouldExclude(n)})}}TRC.CardInterferenceDetector=l;class e{shouldExclude(){return!0}combine(t){return new e.LambdaExcluder(e=>this.shouldExclude(e)||t.shouldExclude(e))}}e.LambdaExcluder=class extends e{constructor(e){super(),this.lambda=e}shouldExclude(e){return this.lambda(e)}};class n extends e{constructor(e){super(),this.selectors=e}shouldExclude({element:t}){return this.selectors.some(e=>null!==TRC.dom.closest(t,e))}}class r extends e{constructor(e){super(),this.patterns=e}shouldExclude({element:t}){return!!t.classList.toString()&&this.patterns.some(e=>0<=t.classList.toString().search(e))}}class s extends e{constructor(e){super(),this.selectors=e}shouldExclude({element:t}){return this.selectors.some(e=>null!==t.querySelector(e))}}class c extends e{constructor(e){super(),this.pattern=e}shouldExclude({element:e}){return 0<=e.textContent.search(this.pattern)}}const a=["exclude-taboola-elements","exclude-website-elements","exclude-sticky-classnames","exclude-social-buttons","exclude-privacy-banners"],i={"exclude-website-elements":new n(["header","footer",'[class*="header"]:not(body)','[class*="footer"]:not(body)',"nav"]),"exclude-taboola-elements":new n(["[class*=trc_]","[class*=tbl-]","[class*=cm-]"]),"exclude-sticky-classnames":new r(["sticky"]).combine(new n([".sticky-header"])),"exclude-social-buttons":new n([".sticky-social",'[class*="social"]:not(body)','[class*="share"]:not(body)']).combine(new s(['[class*="facebook"]','[class*="twitter"]'])).combine(new c(/share/i)),"exclude-privacy-banners":new c(/cookies|privacy/i).combine(new r(["qc-cmp"])),"exclude-zero-height":new e.LambdaExcluder(({rect:e})=>0===e.height)},d={xPath:function(e,t){if(e.nodeType===Node.DOCUMENT_NODE)return"/";const n=[];let r=e;for(;r;){const e=d._xPathValue(r,t);if(!e)break;if(n.push(e),e.optimized)break;r=r.parentNode}return n.reverse(),(n.length&&n[0].optimized?"":"/")+n.join("/")},_xPathValue:function(e,t){let n;var r=d._xPathIndex(e);if(-1===r)return null;switch(e.nodeType){case Node.ELEMENT_NODE:if(t&&e.getAttribute("id"))return new d.Step(`//*[@id="${e.getAttribute("id")}"]`,!0);n=e.localName;break;case Node.ATTRIBUTE_NODE:n=`@${e.nodeName}`;break;case Node.TEXT_NODE:case Node.CDATA_SECTION_NODE:n="text()";break;case Node.PROCESSING_INSTRUCTION_NODE:n="processing-instruction()";break;case Node.COMMENT_NODE:n="comment()";break;default:Node.DOCUMENT_NODE;n=""}return 0<r&&(n+=`[${r}]`),new d.Step(n,e.nodeType===Node.DOCUMENT_NODE)},_xPathIndex:function(t){function n(e,t){return e===t||(e.nodeType===Node.ELEMENT_NODE&&t.nodeType===Node.ELEMENT_NODE?e.localName===t.localName:e.nodeType===t.nodeType||(e.nodeType===Node.CDATA_SECTION_NODE?Node.TEXT_NODE:e.nodeType)===(t.nodeType===Node.CDATA_SECTION_NODE?Node.TEXT_NODE:t.nodeType))}var r=t.parentNode?t.parentNode.children:null;if(!r)return 0;let s;for(let e=0;e<r.length;++e)if(n(t,r[e])&&r[e]!==t){s=!0;break}if(!s)return 0;let o=1;for(let e=0;e<r.length;++e)if(n(t,r[e])){if(r[e]===t)return o;++o}return-1},Step:class{constructor(e,t){this.value=e,this.optimized=t||!1}toString(){return this.value}}}})();
