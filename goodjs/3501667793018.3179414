YUI.add("af-content",function(l,e){"use strict";var t=l.Lang,r=l.Af.Utils,c=l.Af.Config,o=l.Af.Dom,a=l.Mjata.REST.HTTP,s=t.isFunction,u=t.isNumber,p=t.isObject,d=t.isString,m=r.objectGetValue,h="replace_content",f=".js-applet",g="appletsinit";l.namespace("Af").Content={simple:function(e,t,n){return e=l.one(e),n=n||r.noop,e&&t&&t.html?(o.setHTML(e,t.html),t.js&&o.jsAttach(t.js),n(null)):n("invalid param"),this},applet:function(e,t,n,i){return i=i||r.noop,e&&t&&n?(t=l.one(t))?void(d(e)?(o=m(l,e))?this._initApplet(o,n,{node:t,where:h},i):l.onceAfter(g,function(e){this._initApplet(e.applets,n,{node:t,where:h},i)},this):p(e)?this._initApplet(e,n,{node:t,where:h},i):l.onceAfter(g,function(e){this._initApplet(e.applets,n,{node:t,where:h},i)},this)):i("invalid node"):i("invalid param");var o},remoteApplet:function(e,t,n){t=t||{};var i=c.get("context")||{},o=c.get("td")||{},r=l.merge(t.params,{initApplet:0,initStencil:0,m_id:t.type,m_mode:"json"}),s=t.placement&&t.placement.node,p=t.placement&&t.placement.where,a={};return t.type?(s=l.one(s))?(u(p)||(p=p||"replace"),"https:"===window.location.protocol?r.ssl=1:r.ssl=0,!r.site&&i.site&&(r.site=i.site),!r.lang&&i.lang&&(r.lang=i.lang),!r.region&&i.region&&(r.region=i.region),!r.xhr_path&&o.api&&(r.xhr_path=o.api),t.guid&&(r.instance_id=t.guid),o=t.uri||o.remote||"/_remote",u(t.timeout)&&0<t.timeout&&(a.timeout=t.timeout),void this["post"===t.method?"_post":"_get"](e,o,r,s,p,a,n)):n&&n("missing options.placement.node"):n&&n("missing options.type")},_get:function(n,e,t,i,o,r,s){var p=this;e+="?"+l.QueryString.stringify(t),a.get(e,{},r||{},function(e,t){p._parseContent(n,void 0,i,o,s,e,t)})},_post:function(n,e,t,i,o,r,s){var p=this;e+="?m_id="+encodeURIComponent(t.m_id),t.ctrl&&(e+="&ctrl="+encodeURIComponent(t.ctrl)),a.post(e,{},t,r||{},function(e,t){p._parseContent(n,void 0,i,o,s,e,t)})},_parseContent:function(e,t,n,i,o,r,s){if(r)return o&&o(r);if(!s||!s.responseText)return o&&o("empty content");try{t=l.JSON.parse(s.responseText),this._initApplet(e,t,{node:n,where:i},o)}catch(e){return o&&o("invalid json content:"+e.message)}},_initApplet:function(e,t,n,i){return s(e.initApplet)?(n=l.merge({where:"replace"},n),t&&(n.where===h&&(r=(r=l.Node.create(t.html)).one("div.js-applet")||r,t.html=r.getHTML(),n.where="replace"),o=this._insert(t,n)),o?(l.use("stencil",function(e){e=e.Stencil;e&&e.initAll&&e.initAll(o)}),void l.later(5,null,function(){e.initApplet(o,!0),i(null)})):i("missing applet node")):i("missing initApplet()");var o,r},_insert:function(e,t){var n,i;switch(t.node.insert(e.html,t.where),t.where){case"before":n=t.node.previous(f);break;case"after":n=t.node.next(f);break;case"replace":n=t.node.one(f)||t.node;break;default:l.Lang.isNumber(t.where)&&(n=t.node.get("children").item(t.where))}return n&&(i=e.js||e.assets)&&o.jsAttach(i),n},rmp:function(t){l.use("media-rmp",function(e){e.Media.RMP.load(t)})}}},"@VERSION@",{requires:["af-config","af-dom","af-utils","json-parse","mjata-rest-http","node-pluginhost","querystring-stringify"]});
