var b$=b$||{};b$.universal=b$.universal||{},b$.universal.widgets=b$.universal.widgets||{},b$.universal.widgets.StructuredContentWidgetOverlay=function(f){"use strict";define("login-overlay",function(e,n,o){o.exports={loginOverlay:function(t,n,e,i){var l,r;f.ajax({url:e,success:function(e){var n=e;f(t.htmlNode).find(".sme-wh-login-overlay .popup-heading").html(n.overlayTitle)},error:function(e){}});var o=!!document.documentMode;gadgets.pubsub.subscribe("otherLogin",function(e){n==e&&(f(t.htmlNode).find(".sme-wh-login-overlay .cover").show(),f(t.htmlNode).find(".sme-wh-login-overlay .popup-container").addClass("opened"),f("body").addClass("no-scroll"))}),gadgets.pubsub.subscribe("dynamicLoginValue",function(e){l.loginTypes[0].loginUrl=e.loginUrl,a(0,"clearExisting")}),f(t.htmlNode).find(".close-button,.modal-header i.icon-left-open-big").on("click",function(){f(".modal.popup-container").removeClass("opened"),f(t.htmlNode).find(".sme-wh-login-overlay .cover").hide(),f("body").removeClass("no-scroll")}),f(t.htmlNode).find(".sme-wh-login-overlay .cover").on("click",function(){f(this).hide(),f(".modal.popup-container").removeClass("opened"),f("body").removeClass("no-scroll")}),document.onkeydown=function(e){27==e.keyCode&&(f(".modal").removeClass("opened"),f(".cover").hide(),f("body").removeClass("no-scroll"),gadgets.pubsub.publish("overlayClosed"))},f.ajax({url:e,success:function(e){for(var n=(l=e).loginTypes.length,o=0;o<n;o++)r=l.loginTypes[o].wayToLoginSub?'<div><label = "radio inline" class = "link-name"><input type="radio" class="login-rb" name="swlogin" value="'+o+'">'+l.loginTypes[o].wayToLogin+l.loginTypes[o].wayToLoginSub+"</label></div>":'<div><label = "radio inline" class = "link-name"><input type="radio" class="login-rb" name="swlogin" value="'+o+'">'+l.loginTypes[o].wayToLogin+"</label></div>",f(".radio-parent").append(r),f(t.htmlNode).find(".radio-parent div:first-child .login-rb").attr("checked","checked");a(0)},error:function(e){}}),1==o?setInterval(function(){"complete"===document.readyState&&f(".radio-parent input").on("change",function(){f(".login-button-options a").remove(),f(this).is(":checked")&&a(f(this).attr("value"))})},500):f(window).load(function(){f(".radio-parent input").on("change",function(){f(".login-button-options a").remove(),f(this).is(":checked")&&a(f(this).attr("value"))})});function a(e,n){var o,t,r;"clearExisting"==n&&f(".login-button-options").empty(),l.loginTypes[e].loginButtonName&&(o=1==l.loginTypes[e].loginUrlNb?'<a href="'+s+"/login?redirect="+s+l.loginTypes[e].loginUrl+'" class="btn-primary login-url">'+l.loginTypes[e].loginButtonName+"</a>":'<a href="'+l.loginTypes[e].loginUrl+'" class="btn-primary login-url">'+l.loginTypes[e].loginButtonName+"</a>",f(".login-button-options").append(o)),l.loginTypes[e].registerButtonName&&(t=1==l.loginTypes[e].registerUrlNb?'<a href="'+s+"/login?redirect="+s+"/"+l.loginTypes[e].registerUrl+'" class="btn-default register-url">'+l.loginTypes[e].registerButtonName+"</a>":'<a href="'+l.loginTypes[e].registerUrl+'" class="btn-default register-url">'+l.loginTypes[e].registerButtonName+"</a>",f(".login-button-options").append(t)),l.loginTypes[e].knowMorButtonName&&(r=1==l.loginTypes[e].knowMoreUrlNb?'<a href="'+s+"/login?redirect="+s+"/"+l.loginTypes[e].knowMoreUrl+'" class="know-more-url '+l.loginTypes[e].navigationType+'">'+l.loginTypes[e].knowMorButtonName+"</a>":'<a href="'+l.loginTypes[e].knowMoreUrl+'" class="know-more-url '+l.loginTypes[e].navigationType+'">'+l.loginTypes[e].knowMorButtonName+"</a>",f(".login-button-options").append(r)),f(".login-button-options a").each(function(){var e=f(this).attr("href");-1==e.indexOf("http")&&f(this).hasClass("friendly-url")?e=window.location.origin+i+e:-1==e.indexOf("http")&&f(this).hasClass("normal-url")?e=window.location.origin+s+e:-1==e.indexOf("http")?e=window.location.origin+s+e:this.hrefVal=e,f(this).attr("href",e)})}}}});var m="cs",v=window.b$||{},s=v.portal.urlRedirect;return{prefModified:function(e){e.refreshIncludes();var n=f(e.htmlNode);f(".bd-structured-content-widget",n).attr("data-type",e.getPreference("contentType")||"Content")},start:function(l){for(var e,n=[],o=0;o<l.model.preferences.array.length;o++)"templateUrl"==l.model.preferences.array[o].name&&(e=l.model.preferences.array[o].value);var t=l.getPreference("urlContent"),r=v.portal.portalModel.serverURL;if(null!=t){var i=t.indexOf("content"),a=t.slice(i,t.length);t=r+"/"+a}var s=v.portal.portalModel.serverURL+"/static/widgets/%5BBBHOST%5D/widget-hdfc-sme-wholesale-login/media/pop-close.png";f(".close-icon-url").attr("src",s),null==e&&null==e||(n=e.split("/"));var d,c=l.getPreference("contentRef"),p=f(l.htmlNode),u=!1;try{top.bd}catch(e){u=!0}if(!(!window.be||u)&&be.utils.module("top.bd.PageMgmtTree.selectedLink").isMasterPage||"true"===l.model.manageable||""===l.model.manageable||void 0===l.model.manageable){c||p.addClass("bd-empty-structured-content"),f(".bd-structured-content-widget",p).attr("data-type",l.getPreference("contentType")||"Content"),l.addEventListener("preferences-form",function(e){for(var n=v.portal.portalModel.filterPreferences(l.model.preferences.array),o=n.length-1;0<=o;o--)if("Template"==n[o].label)for(var t=l.getPreference("templateList").split(","),r=0,i=0;r<t.length;r++,i++)n[o].inputType.options[i]={label:t[r],value:t[r+1]},r++}),l.addEventListener("bdDrop.enter",function(e){var n=e.detail.info.helper.bdDragData.fileDataArray[0];n.metaData&&n.metaData["cmis:objectTypeId"]&&"bb:structuredcontent"===n.metaData["cmis:objectTypeId"].property?(d=n,p.addClass("bd-over-structured-content")):d=void 0}),l.addEventListener("bdDrop.leave",function(e){p.removeClass("bd-over-structured-content")}),l.addEventListener("bdDrop.drop",function(e){var n=e.detail.info.helper.bdDragData.fileDataArray[0];if(d){if(!l.model.preferences.getByName("contentRef")){var o=v.portal.portalModel.createPreference("contentRef","contentRef",void 0,"");l.model.preferences.add(o)}l.setPreference("urlContent",n.url),l.setPreference("contentRef",[m,"contentRepository"===d.repository?d.repository:"@portalRepository",d.contentUId].join(":")),l.model.save(function(){l.refreshHTML(),p.removeClass("bd-empty-structured-content")}),p.removeClass("bd-over-structured-content")}d=void 0}),window.bd&&window.bd.bindDropEvents&&window.bd.bindDropEvents(l.htmlNode);var g=l.getPreference("section-name");"login-overlay.html"==n[n.length-1]&&require(["login-overlay"],function(e){e.loginOverlay(l,g,t,r)})}}}}(jQuery);