var json_parse=function(){"use strict";function e(){var e,i="";for("-"===r&&s(i="-");"0"<=r&&r<="9";)i+=r,s();if("."===r)for(i+=".";s()&&"0"<=r&&r<="9";)i+=r;if("e"===r||"E"===r)for(i+=r,s(),"-"!==r&&"+"!==r||(i+=r,s());"0"<=r&&r<="9";)i+=r,s();return e=+i,isFinite(e)?e:void o("Bad number")}var i,r,t,a={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:" "},o=function(e){throw{name:"SyntaxError",message:e,at:i,text:t}},s=function(e){return e&&e!==r&&o("Expected '"+e+"' instead of '"+r+"'"),r=t.charAt(i),i+=1,r},n=function(){var e,i,t,n="";if('"'===r)for(;s();){if('"'===r)return s(),n;if("\\"===r)if(s(),"u"===r){for(i=t=0;i<4&&(e=parseInt(s(),16),isFinite(e));i+=1)t=16*t+e;n+=String.fromCharCode(t)}else{if("string"!=typeof a[r])break;n+=a[r]}else n+=r}o("Bad string")},f=function(){for(;r&&r<=" ";)s()},l=function(){switch(f(),r){case"{":return function(){var e,i={};if("{"===r){if(s("{"),f(),"}"===r)return s("}"),i;for(;r;){if(e=n(),f(),s(":"),Object.hasOwnProperty.call(i,e)&&o('Duplicate key "'+e+'"'),i[e]=l(),f(),"}"===r)return s("}"),i;s(","),f()}}o("Bad object")}();case"[":return function(){var e=[];if("["===r){if(s("["),f(),"]"===r)return s("]"),e;for(;r;){if(e.push(l()),f(),"]"===r)return s("]"),e;s(","),f()}}o("Bad array")}();case'"':return n();case"-":return e();default:return("0"<=r&&r<="9"?e:function(){switch(r){case"t":return s("t"),s("r"),s("u"),s("e"),!0;case"f":return s("f"),s("a"),s("l"),s("s"),s("e"),!1;case"n":return s("n"),s("u"),s("l"),s("l"),null}o("Unexpected '"+r+"'")})()}};return function(e,s){return t=e,i=0,r=" ",e=l(),f(),r&&o("Syntax error"),"function"==typeof s?function e(i,t){var n,r,a=i[t];if(a&&"object"==typeof a)for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r=e(a,n),void 0!==r?a[n]=r:delete a[n]);return s.call(i,t,a)}({"":e},""):e}}();window.MiniLoginEmbedder||(window.MiniLoginEmbedder=function(){return this.config={targetId:"alibaba-login-iframe",iframeUrl:"https://passport.alipay.com/littleLogin/littleLogin.htm",appName:"4",appEntrance:"default",lang:"zh_CN",cssLink:"",styleType:"vertical",beforeSubmitBtnHtml:"",afterSubmitBtnHtml:"",bizParams:"",queryStr:"",resizeIframeWidthFix:!1,resizeIframeHeightFix:!1,loginId:null,iframeWidth:250,iframeHeight:250,notLoadSsoView:!1,notKeepLogin:!1,isMobile:!1},this.temp={target:null,iframe:null},this._listeners={},this._hashCodeCounter=0,this._messageType=null,this._bakWindowName=window.name,this._windowNameHash=null,this._windowNameTimer=null,this},window.MiniLoginEmbedder.prototype={merge:function(){for(var e,i={},t=Array.prototype.slice.call(arguments),n=0;e=t[n++];)for(var r in e)i[r]=e[r];return i},json2str:function(e){switch(e.constructor){case Object:var i="{";for(t in e)e[t]&&(i+='"'+t+'":'+arguments.callee(e[t])+",");return(i=","==i.substr(i.length-1)?i.substr(0,i.length-1):i)+"}";case Array:var t,i="[";for(t in e)i+=arguments.callee(e[t])+",";return(i=","==i.substr(i.length-1)?i.substr(0,i.length-1):i)+"]";default:return'"'+e.toString()+'"'}},toQueryPair:function(e,i){return void 0===i?e:e+"="+encodeURIComponent(null===i?"":String(i))},toQueryString:function(e){var i=[];for(t in e){var t,n=e[t=encodeURIComponent(t)];if(n&&n.constructor==Array){for(var r,a=[],s=0,o=n.length;s<o;s++)r=n[s],a.push(this.toQueryPair(t,r));i=i.concat(a)}else i.push(this.toQueryPair(t,n))}return i.join("&")},get:function(e){return"string"==typeof e?document.getElementById(e):e},hasClass:function(e,i){return e.className.match(new RegExp("(\\s|^)"+i+"(\\s|$)"))},addClass:function(e,i){return""===e.className?void(e.className=i):void(this.hasClass(e,i)||(e.className+=" "+i))},removeClass:function(e,i){this.hasClass(e,i)&&(i=new RegExp("(\\s|^)"+i+"(\\s|$)"),e.className=e.className.replace(i," "))},on:function(e,i,t){var n=this.get(e);n.attachEvent?(n["e"+i+t]=t,n[i+t]=function(){n["e"+i+t](window.event)},n.attachEvent("on"+i,n[i+t])):n.addEventListener(i,t,!1)},addEvent:function(e,i){"function"==typeof i&&((this._listeners[e]||(this._listeners[e]={}))[this._toHashCode(i)]=i)},fireEvent:function(e,i){if(this._listeners[e])for(var t in this._listeners[e])this._listeners[e][t].call(this,i)},_toHashCode:function(e){return e._hashCode||(e._hashCode="_"+(this._hashCodeCounter++).toString(32))},_tempOnInit:function(){this.temp.target=this.get(this.config.targetId)},_parseWindowNameData:function(e){e=e.split("[@]").pop().split("[login-iframe-message]");return{origin:e[0],data:e[1]}},init:function(e){this.config=this.merge(this.config,e||{});var i=this;this.config,this.temp,i._tempOnInit(),i._renderIframe(),window.postMessage?(i._messageType="postMessage",i.on(window,"message",function(e){i.messageHanlder.call(i,e)})):(i._messageType="windowName",window.name="",i._windowNameHash="",i._windowNameTimer=setInterval(function(){""!==window.name&&-1!==window.name.indexOf("[login-iframe-message]")&&window.name!=i._windowNameHash&&(i._windowNameHash=window.name,i.messageHanlder(i._parseWindowNameData(window.name)))},50)),this.fireEvent("onInit",{_self:this}),this.free()},messageHanlder:function(e){var i,t=this,n=this.config,r=this.temp;try{i=-1<e.data.indexOf("action")?json_parse(decodeURIComponent(e.data)):""}catch(e){i=""}switch(i.showIframe&&("visible"!==r.iframe.style.visibility&&(r.iframe.style.visibility="visible"),this.fireEvent("onIframeShow",{_self:r.iframe}),t.addClass(r.target,"iframe-show")),i.hideIframe&&("hidden"!==r.iframe.style.visibility&&(r.iframe.style.visibility="hidden"),this.fireEvent("onIframeHide",{_self:r.iframe}),t.removeClass(r.target,"iframe-show")),i.action){case"resizeIframe":if(0==r.iframe.offsetHeight)return;n.resizeIframeWidthFix||(r.iframe.width=i.width),n.resizeIframeHeightFix||(r.iframe.height=i.height),t._bakOriginalIframeWidth||(n.resizeIframeWidthFix||(t._originalIframeWidth=i.width),n.resizeIframeHeightFix||(t._originalIframeHeight=i.height),t._bakOriginalIframeWidth=!0);break;case"redirectLocation":i.redirect&&(top.location.href=i.redirectUrl)}this.fireEvent("onMessage",i)},restoreOriginalWidth:function(){this.iframe.width=this._originalIframeWidth},restoreOriginalHeight:function(){this.iframe.height=this._originalIframeHeight},_renderIframe:function(){var e=this,i=this.config,t=this.temp.target,n=this.temp.iframe=document.createElement("iframe"),r={lang:i.lang,appName:i.appName,appEntrance:i.appEntrance,styleType:i.styleType,bizParams:i.bizParams,notLoadSsoView:i.notLoadSsoView,notKeepLogin:i.notKeepLogin,isMobile:i.isMobile};i.loginId&&(r.loginId=i.loginId),n.id="alibaba-login-box",n.src=i.iframeUrl+"?"+e.toQueryString(r)+e.config.queryStr+"&rnd="+Math.random(),n.width=i.iframeWidth,n.height=i.iframeHeight,n.frameBorder="none",n.scrolling="no",n.style.border="none",e.on(n,"load",function(){e.addClass(t,"iframe-loaded")}),t.appendChild(n),this.fireEvent("afterRenderIframe",{iframe:n})},free:function(){/msie/i.test(navigator.userAgent)&&CollectGarbage()},sleep:function(){"windowName"===_self._messageType&&(clearInterval(_self._windowNameTimer),window.name=this._bakWindowName),this.free()},destory:function(){"windowName"===_self._messageType&&(clearInterval(_self._windowNameTimer),window.name=this._bakWindowName),this.free()}});
