define("lofty/ui/widget/1.0/widget",["lofty/lang/class","lofty/lang/base","jquery"],function(t,n,e){"use strict";function i(){return"fui_widget_"+c++}function o(t,n,i){if("document"===i)e(document).off(n);else if("window"===i)e(window).off(n);else{var o=t.get("el");o.off(n,i)}}function r(t){var n=document.documentElement;return e.contains?e.contains(n,t):!!(16&n.compareDocumentPosition(t))}function s(t,n){return t.replace(/{([^}]+)}/g,function(t,e){for(var i,o=e.split("."),r=n;i=o.shift();)r=r===n.options?n.get(i):r[i];return u(r)?r:""})}var a=t(n,{options:{tpl:"<div></div>",extendTplData:null,container:{value:"body",getter:function(t){return u(t)&&(t=e(t)),t}},el:{getter:function(t){return u(t)&&(t=e(t)),t}}},events:null,init:function(t){this.mixOptions(["tpl","events"]),n.prototype.init.call(this,t||{}),this.buildElement(),this.bindEvent(),this._create()},destroy:function(){this.unbindEvent(),n.prototype.destroy.call(this)},_create:function(t){},render:function(t){t&&this.set("container",t);var n=this.get("el"),e=this.get("container");return e&&!r(n[0])&&n.appendTo(e),this},bindEvent:function(t){t=t||this.get("events");for(var n in t){var i=t[n];for(var o in i){var n=s(n,this),r=s(o,this)+".events-"+this.wId;!function(t,i){var o=function(n){h(t)?t.call(i,n):i[t](n)},s=i.get("el");""===n?s.on(r,o):"document"===n?e(document).on(r,o):"window"===n?e(window).on(r,o):s.on(r,n,o)}(i[o],this)}}return this},unbindEvent:function(t){if(t)for(var n in t){var e=t[n],n=s(n,this);for(var i in e){var r=s(i,this)+".events-"+this.wId;o(this,r,n)}}else{var r=".events-"+this.wId;o(this,r)}return this},buildElement:function(){var t,n="dynamic",o=this.get("tpl");if(this.wId=i(),u(o)?("."===o.charAt(0)||"#"===o.charAt(0)||"body"===o)&&(t=e(o)):t=o,t&&t.length>0&&("SCRIPT"==t[0].nodeName.toUpperCase()?(o=t.html(),this.set("tpl",o)):n="static"),this.set("renderType",n),"static"===n)this.set("el",t);else{var r=e(this.get("el"));if(this.handleTpl(),r&&0!==r.length){var s=this.get("container");s.append(e(this.get("tpl")))}else{var a=this.wId,o=e(this.get("tpl"));o.length>1?o=e('<div id="'+a+'"></div>').append(o):(a=o.attr("id")||this.wId,o.attr("id",a)),this.set("el",o)}}if(!this.get("el"))throw new Error("element is empty!")},mixOptions:function(t){for(var n in t){var e=t[n];this[e]&&this.options&&(this.options[e]=this[e])}},handleTpl:function(){}}),l={}.toString,h=function(t){return"[object Function]"===l.call(t)},u=function(t){return"string"==typeof t},c=0;return a});;