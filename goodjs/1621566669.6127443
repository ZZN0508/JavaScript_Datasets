!function(){"use strict";function t(){var t=Y;if(D&&t.length){Y=[];for(var e=0;e<t.length;e+=1)t[e](A)}}function e(){D||(D=!0,W&&clearInterval(W),t())}function o(t){return D?t(A):Y.push(t),o}function n(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?K[B.call(t)]||"object":typeof t}function i(t){return"function"===n(t)}function r(t){t=t||location.search||location.href;for(var e={},o=/([^\s&?#=\/]+)=([^\s&?#=]+)/g;o.exec(t);){var n=decodeURIComponent(RegExp.$1),i=decodeURIComponent(RegExp.$2.replace("+","%20"));e[n]===undefined?e[n]=i:N(e[n])?e[n].push(i):e[n]=[e[n],i]}return e}function a(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[],o=[];for(var n in t)!function(n){var i=t[n];-1===e.indexOf(n)&&""!==i&&null!=i&&(N(i)||(i=[i]),i.forEach(function(t){o.push(encodeURIComponent(n)+"="+encodeURIComponent(t))}))}(n);return o.join("&")}function s(){}function c(t,e){if(e=e||"YK-Module-CSS",!document.getElementById(e)){var o=document.getElementsByTagName("head")[0],n=document.createElement("link");n.id=e,n.rel="stylesheet",n.href=t;var i=o.getElementsByTagName("style");i.length>0?o.insertBefore(n,i[0]):o.appendChild(n)}}function l(t,e,o,n){"function"==typeof e?(n=o,o=e,e={}):e=e||{};var i=document.createElement("script");for(var r in e)"retry"!==r&&i.setAttribute(r,e[r]);e.crossOrigin&&(e.retry=1,delete e.crossOrigin),i.src=t;var a=document.getElementsByTagName("head")[0],s=!1;i.onload=i.onreadystatechange=function(){s||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(s=!0,i.onload=i.onreadystatechange=null,a.removeChild(i),o&&o())},i.onerror=function(){i.onerror=null,e.retry?(e.retry--,l(t,e,o,n)):n&&n()},a.appendChild(i)}function d(t,e,o){function n(){h.parentNode&&h.parentNode.removeChild(h),window[a]=s,f&&clearTimeout(f)}function i(){window[a]&&n()}"function"==typeof e&&(o=e,e={}),e||(e={});var r=e.prefix||"__jp",a=e.name||r+q++,c=e.param||"callback",l=null!=e.timeout?e.timeout:6e4,d=encodeURIComponent,u=document.getElementsByTagName("script")[0]||document.head,h=void 0,f=void 0;return l&&(f=setTimeout(function(){n(),o&&o(new Error("è¯·æ±‚è¶…æ—¶ï¼Œè¯·é‡è¯•"))},l)),window[a]=function(t){n(),o&&o(t)},t+=(t.indexOf("?")>-1?"&":"?")+c+"="+d(a),t=t.replace("?&","?"),h=document.createElement("script"),h.src=t,u.parentNode.insertBefore(h,u),i}function u(t,e){c(f(t),e)}function h(t,e,o,n){l(f(t),e,o,n)}function f(t){var e=window.YT_STATIC_DOMAIN||"";return e&&-1===t.indexOf(e)&&(t=t.replace("//g.alicdn.com",e)),t}function p(t,e){return Array.isArray(t)?t.map(function(t){return p(t,e)}):$+"//"+(e?V:"")+t}function g(){return X}function m(t){var e=((t||{}).stack||"").split("\n"),o=["","",""],n=void 0,i=void 0,r={};for(i=0;i<e.length;i++){var a=H,s=(e[i]||"").match(a);if(null===s&&(a=Z,s=(e[i]||"").match(a)),null===s&&(a=tt,s=(e[i]||"").match(a)),null!==s){n=s[1];var c=r[n];c===undefined&&(r[n]="#"+i+"#",c=r[n]),e[i]=e[i].replace(n,c)}}if(e.length>0){e.shift();var l="";for(i=0;l.length+(e[i]||"").length<z&&i<e.length;)l+=e[i]+"\n",i++;o[1]=l;for(var d="";d.length+(e[i]||"").length<z&&i<e.length;)d+=e[i]+"\n",i++;o[2]=d}var u="";for(n in r)r.hasOwnProperty(n)&&(u+=n+"@"+r[n]+";");return u=u.replace(/;$/,""),o[0]=u,o}function _(t){return t||""}function w(t,e,o){for(var n in e)e.hasOwnProperty(n)&&(o||t[n]===undefined)&&(t[n]=e[n])}function y(){var t="",e="",o=window.goldlog||{},n=o.spmAb||o.spm_ab;return n&&Array.isArray(n)&&(t=n[0],n[1]&&(e=n[1])),{a:t,b:e}}function v(t){return/^script error\.?$/i.test(t)?"Script error":t}function b(){return window.screen.width+"x"+window.screen.height}function S(t){return[t.type,t.uid,t.page,t.msg||"",t.ajaxurl||""].join("_")}function L(t,e,o){t.addEventListener?t.addEventListener(e,o,!1):t.attachEvent("on"+e,function(){return o.call(t,window.event)})}function E(t){return"object"==typeof t&&null!==t}function k(t){var e={}.toString.call(t);return E(t)&&"[object Error]"===e||"[object Exception]"===e||t instanceof Error}function R(t){if(!(this instanceof R))return new R(t);t=t||{},!1!==t.hotPatch&&this._hotPatch(),!1!==t.global&&"object"==typeof et.__trackerOptions&&w(t,et.__trackerOptions),this.global=null==t.global||!!t.global,this.pid=t.pid,this.sampleRate=t.sampleRate||1,this.uidResolver=t.uidResolver||_,this.userOptions=t,this.requiredFields=t.requiredFields||[],this.releaseResolver=t.releaseResolver||_,this.uaParser=t.uaParser||_,this.beforeLog=t.beforeLog||null,this.msgWhitelist=t.msgWhitelist||t.msgWhiteList||st,this.urlWhitelist=t.urlWhitelist||t.urlWhiteList||ct,this.oncePerSession=t.oncePerSession===undefined||t.oncePerSession,this.consoleDisplay=t.consoleDisplay||!1,this.ignoreScriptError=t.ignoreScriptError||!1,this.ignoredQueries=t.ignoredQueries||[],this.global&&(et.__trackerOptions=t),this._inited=!1,this._tracked=[],this._logWaitingQueue=[],this._plugins=t.plugins||[],this._pos="0,0",this._trackMousePos()}var C=Array.prototype,O=C.slice,F=Object,j=F.prototype,M=String.prototype,P=Function.prototype,T=function(){};window.console||(window.console={log:T,error:T}),M.trim||(M.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),C.filter||(C.filter=function(t,e){for(var o=[],n=0,i=this.length;n<i;n++)n in this&&t.call(e,this[n],n,this)&&o.push(this[n]);return o}),C.forEach||(C.forEach=function(t,e){for(var o=0,n=this.length;o<n;o++)o in this&&t.call(e,this[o],o,this)}),C.some||(C.some=function(t,e){for(var o=0,n=this.length;o<n;o++)if(o in this&&t.call(e,this[o],o,this))return!0;return!1}),C.map||(C.map=function(t,e){for(var o=0,n=this.length,i=new Array(n);o<n;o++)o in this&&(i[o]=t.call(e,this[o],o,this));return i}),C.indexOf||(C.indexOf=function(t,e){var o=this.length;for(e=parseInt(e)||0,e<0&&(e+=o);e<o;e++)if(e in this&&this[e]===t)return e;return-1}),Array.from||(Array.from=function(){return O.call(arguments)}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===j.toString.call(t)}),Date.now||(Date.now=function(){return+new Date}),F.keys||(F.keys=function(t){var e=[],o=void 0;for(o in t)j.hasOwnProperty.call(t,o)&&e.push(o);return e}),F.create||(F.create=function(t){function e(){}return e.prototype=t,new e}),F.assign||(F.assign=function(t){t=F(t);for(var e=arguments.length,o=1;o<e;o++){var n=arguments[o];for(var i in n)F.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}),P.bind||(P.bind=function(t){var e=O.call(arguments,1),o=this,n=function(){},i=function(){return o.apply(this instanceof n?this:t||window,e.concat(O.call(arguments)))};return n.prototype=this.prototype,i.prototype=new n,i});var A=document,x=void 0,I=void 0,W=void 0,D=void 0,Y=[];if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1);else if(window.attachEvent){window.attachEvent("onload",e),I=document.createElement("div");try{x=null===window.frameElement}catch(Lt){}I.doScroll&&x&&window.external&&(W=setInterval(function(){try{I.doScroll(),e()}catch(Lt){}},30))}"complete"===document.readyState&&e();var K={},Q="Boolean Number String Function Array Date RegExp Object".split(" "),U=Object.prototype,B=U.toString;Q.forEach(function(t){K["[object "+t+"]"]=t.toLowerCase()});var N=Array.isArray,q=(/(msie) ([\w.]+)/.exec(navigator.userAgent),0),$="https:",G=window.location.host.match(/\.((youku|tudou|laifeng|soku|jingguan)\.(com|ai))$/),J=G&&G[1]||"youku.com",V="account.",X=p(J,!0),z=500,H=/^\s*at .*? ?\(((?:file|https?|blob|chrome-extension|native|eval|<anonymous>).*?)(?::\d+)?(?::\d+)?\)?\s*$/i,Z=/^\s*.*?(?:\(.*?\))?(?:^|@)((?:file|https?|blob|chrome|resource|\[native).*?)(?::\d+)?(?::\d+)?\s*$/i,tt=/^\s*at (?:(?:\[object object\])?.+ )?\(?((?:file|ms-appx|https?|blob):.*?):\d+(?::\d+)?\)?\s*$/i,et=window,ot=et.document,nt=ot&&ot.documentElement,it=et.navigator,rt=!1,at={JS_ERROR:1},st=null,ct=null,lt=+new Date,dt=et.onerror;R.prototype={log:function(t,e){"object"==typeof t?e=t:"string"==typeof t&&(e=e||{},w(e,{code:1,msg:t})),this._log(e)},captureMessage:function(t,e){return this.log(t,e)},logError:function(t,e){if(!k(t))return this.log(t,e);if(e=e||{},e.c1||e.c2||e.c3)return void this.warn("tracker.logError() ä¸å¯ä¼ å…¥ c1,c2,c3 å­—æ®µï¼Œè¯·æ±‚æœªå‘é€");var o={},n=m(t);o.msg=t.toString(),o.c1=n[0],o.c2=n[1],o.c3=n[2],w(o,e),this._log(o)},captureException:function(t,e){return this.logError(t,e)},config:function(t,e){return"string"==typeof t?(e=e||{},e.pid=t):e=t,w(this,e,!0),w(this.userOptions,e,!0),"object"==typeof et.__trackerOptions&&w(et.__trackerOptions,e,!0),this._checkRequiredFields()&&this._popWaitingQueue(),this},onGlobalError:function(){if(!ot)return this;var t=this;if(this.pid&&!this._inited){if(et.onerror=function(e,o,n,i,r){t._handleError(e,o,n,i,r)},this._plugins.length)for(;this._plugins.length>0;){var e=this._plugins.pop(),o=e[0],n=e[1];o.apply(this,[this].concat(n))}this._inited=!0}return this},offGlobalError:function(){return ot?(et.onerror=dt,this._inited=!1,this._plugins=[],this._tracked=[],this):this},addPlugin:function(t){if(!ot)return this;var e=[].slice.call(arguments,1);return"function"==typeof t&&this._inited?t.apply(this,[this].concat(e)):this._plugins.push([t,e]),this},_handleError:function(t,e,o,n,i){if(dt)try{dt.call(this,t,e,o,n,i)}catch(s){}e=e||"-",o=o||"-",n=n||"-",t=v(t);var r={msg:t,code:at.JS_ERROR};if(!this.ignoreScriptError||"Script error"!==t){if(null!=i&&(1===this.sampleRate||Math.random()<.1)){var a=m(i);r.c1=a[0],r.c2=a[1],r.c3=a[2]}this._log(r)}},_handleMouseDown:function(t){var e=Math.round(t.pageY||t.clientY+ot.body.scrollTop+nt.scrollTop),o=Math.round(t.pageX||t.clientX+ot.body.scrollLeft+nt.scrollLeft);o-=Math.max(nt.clientWidth,nt.offsetWidth,nt.scrollWidth)/2,this._pos=String(o)+","+String(e)},_trackMousePos:function(){var t=this;nt&&L(ot,"mousedown",function(e){t._handleMouseDown(e)})},_log:function(t){if(!ot)return this;if(t=t||{},t.type||t.code||(t.type=1),!t.type&&t.code&&(t.type=t.code),!(t.type===at.JS_ERROR&&Math.random()>(t.sampleRate||this.sampleRate)||null!=t.sampleRate&&Math.random()>t.sampleRate)){if(t=this._enhanceOpitons(t),!t.pid)return void this.warn("æœªé…ç½® pidï¼Œè¯·æ±‚æœªå‘é€");for(var e=S(t),o=!1,n=0;n<this._tracked.length;n++)if(this._tracked[n]===e){o=!0;break}if(!((null==t.oncePerSession?this.oncePerSession:t.oncePerSession)&&o||this.msgWhitelist&&null!==this.msgWhitelist.exec(t.msg)||this.urlWhitelist&&null!==this.urlWhitelist.exec(t.page))){if("function"==typeof this.beforeLog){var i=void 0;try{i=this.beforeLog(t)}catch(Lt){}if(!1===i)return;"object"==typeof i&&(t=i)}if(this._tracked.push(e),this.consoleDisplay&&"object"==typeof et&&et.console&&"function"==typeof et.console.log&&et.console.log("[Tracker] %s",t.msg),!this._checkRequiredFields())return void this._pushWaitingQueue(t);this._createImg(t)}}},_createImg:function(t){(new Image).src="//gm.mmstat.com/"+(t.base||"fsp.1.1")+"?"+a(t,["code","base","sampleRate","oncePerSession"])},_checkRequiredFields:function(){for(var t=0;t<this.requiredFields.length;t++){var e=this.requiredFields[t];if(this.userOptions[e]===undefined)return!1}return!0},_popWaitingQueue:function(){var t=this;if(this._logWaitingQueue&&this._logWaitingQueue.length)for(var e=0;e<this._logWaitingQueue.length;e++){var o=this._logWaitingQueue[e];w(o,t._enhanceOpitonsByUser(t.userOptions),!0),t._createImg(o)}this._logWaitingQueue=[]},_pushWaitingQueue:function(t){this._logWaitingQueue.push(t)},_enhanceOpitonsByUser:function(t){return t.uid||(t.uid=this.uidResolver()),t.pid||(t.pid=this.pid),t.rel||(t.rel=this.releaseResolver()),t.ua||(t.ua=this.uaParser(it?it.userAgent:"")),t},_enhanceOpitons:function(t){t=this._enhanceOpitonsByUser(t),t.page||(t.page=et.location.href.split("?")[0]),t.query||(t.query=a(r(window.location.search),t.ignoredQueries)),t.hash||(t.hash=window.location.hash),t.title||(t.title=ot.title),t.spm_a||(t.spm_a=y().a),t.spm_b||(t.spm_b=y().b),t.scr||(t.scr=b()),t.raw_ua=it?it.userAgent:"",t.delay=parseFloat(((+new Date-lt)/1e3).toFixed(2)),t.tracker_ver=this.VERSION,t.patch_ver=this.PATCH_VERSION||"-";var e=ot.referrer.split("?"),o=e[0],n=2===e.length?a(r(e[1]),t.ignoredQueries):"";return 2===e.length&&n.length>0?t.referrer=o+"?"+n:t.referrer=o,t.last_pos=this._pos,t},warn:function(t){"object"==typeof et&&et.console&&"function"==typeof et.console.warn&&et.console.warn("[Tracker] "+t)},_hotPatch:function(){if(et&&ot){if(rt&&et.__trackerPatch)return;rt=!0;var t=Math.random();if(et.localStorage&&et.localStorage.getItem){var e=et.localStorage.getItem("__tracker_patch__"),o=+new Date;if(e&&o-parseInt(e,10)<432e5)t=e;else{t=o;try{et.localStorage.setItem("__tracker_patch__",o)}catch(Lt){}}}var n=ot.createElement("script");n.src="//g.alicdn.com/fsp/tracker-patch/index.js?"+t,n.async=!0,n.crossOrigin=!0,n.id="tracker-patch",(ot.head||ot.body).appendChild(n);var i=this;et.__trackerPatch=function(){return i}}}};var ut=function(){},ht="//g.alicdn.com/static-es6/login/pc/login/js/main_eba8f3e8.js",ft="//g.alicdn.com/static-es6/login/pc/login/css/main_70d8d4cb.css",pt="//g.alicdn.com/static-es6/login/h5/login/js/main_ee10de6e.js",gt="//g.alicdn.com/static-es6/login/h5/login/css/main_0dade16c.css",mt="//g.alicdn.com/static-es6/login/pc/component/js/main_acec077c.js",_t="//g.alicdn.com/static-es6/login/pc/component/css/main_9bd343ba.css",wt="//g.alicdn.com/static-es6/login/h5/component/js/main_4bd2dedf.js",yt="//g.alicdn.com/static-es6/login/h5/component/css/main_4bd2dedf.css",vt={},bt=!1,St=function(){function t(t){this.config=t=t||{},t.isMobile=t.isMobile||t.template&&t.template.toLowerCase().indexOf("mobile")>-1||!1,t.logoutSuccess=t.logoutSuccess||function(){window.location.reload()},this.loadMode=t.loadMode||t.loadType||t.loginOrLogout||"login",this.loadFail=t.loadFail||t.loadfail||ut,this.loadSuccess=t.loadSuccess||t.loadSucess||ut,this.styleSrc=t.isMobile?gt:ft,this.scriptSrc=t.isMobile?pt:ht,"bind"===this.loadMode&&(this.loadMode="component",this.config.flowName="BindMobile"),"component"===this.loadMode&&(this.styleSrc=t.isMobile?yt:_t,this.scriptSrc=t.isMobile?wt:mt),this.init()}return t.prototype.init=function(){var t=this.config,e=this.loadMode;if(this._loadFail=this._loadError=!1,vt[e]&&(vt[e].destory&&vt[e].destory(),vt[e]=null),"login"===e){if(bt)return;if(bt=!0,this._getConfig("login"),this._loadLogin(function(){vt[e]=new window.loginFrame(t),bt=!1}),!window.YKLoginTracker){(window.YKLoginTracker=new R({pid:"passport-login",sampleRate:.01})).onGlobalError()}}else"component"===e?this._loadComponent(function(){t.initFromLoader=!0,vt[e]=new window.YKComponent(t),i(t.componentDidLoad)&&t.componentDidLoad()}):this._loadLogout(function(){vt[e]=new window.logoutFrame(t)})},t.prototype.buildLoginDom=function(t){var e=this;this._addTask(function(){vt[e.loadMode].buildLoginDom(t)})},t.prototype.buildRegDom=function(t){var e=this;this._addTask(function(){vt[e.loadMode].buildRegDom(t)})},t.prototype.initBindComponent=function(){this.initComponent()},t.prototype.initComponent=function(){var t=this;this._addTask(function(){vt[t.loadMode].getFlowData(t.config.flowName)})},t.prototype.getThirdPartData=function(t){var e=this;this._addTask(function(){vt[e.loadMode].once("configLoaded",function(e){if(i(t)){for(var o=[],n="&protocol="+window.location.protocol,r=e.thirdPartUrlAry&&e.thirdPartUrlAry.length||0,a=0;a<r;a++)o.push({site:e.thirdPartUrlAry[a].site,link:e.thirdPartUrlAry[a].link+"&needRecommend=true"+n});t(o)}}).getCustomConfig()})},t.prototype.closeFrame=function(t){var e=this.loadMode;vt[e]&&vt[e].closeFrame(t)},t.prototype._addTask=function(t){var e=this;this._loadError||(vt[this.loadMode]?i(t)&&t():this._taskTimer=setTimeout(function(){e._addTask(t)},10))},t.prototype._getConfig=function(t){if(!(window.location.host.indexOf("v.youku.com")>-1)){var e=this.config,o=e.accountDomain||g();o=o.replace(/^https?:\/\/|^\/\//i,"");var n="https://"+o+"/getConfig.json",r=n+"?pid="+(e.pid||"")+"&bizType="+(t||"")+"&callback="+encodeURIComponent(e.callbackURL||"");e.configId&&(r+="&configId="+e.configId);var a=void 0;window.YKLoginPreLoadConfig=function(t){window.YKLoginPreLoadConfigResult?i(t)&&t(window.YKLoginPreLoadConfigResult):a=t,window.YKLoginPreLoadConfig=null,window.YKLoginPreLoadConfigResult=null},d(r,{param:"jsonpCallback",prefix:"__jsonp",timeout:5e3},function(t){t instanceof Error&&window.YKLoginTracker&&window.YKLoginTracker.log({code:11,c1:window.location.href,sampleRate:.01,msg:"é¢„åŠ è½½getConfigè¶…æ—¶"}),i(a)?a(t):window.YKLoginPreLoadConfigResult=t})}},t.prototype._loadLogin=function(t){var e=this;u(this.styleSrc,"YT-loginFrameCss"),setTimeout(function(){window.loginFrame?i(t)&&t():h(e.scriptSrc,{crossOrigin:!0},function(){window.loginFrame?(i(t)&&t(),i(e.loadSuccess)&&e.loadSuccess()):e._loadFail?(e._loadError=!0,i(e.loadFail)&&e.loadFail()):(e._loadFail=!0,e._loadLogin(t))})},this._loadFail?0:50)},t.prototype._loadLogout=function(t){var e=this;h("//g.alicdn.com/static-es6/login/public/logout_ecd3bf5b.js",{crossOrigin:!0},function(){window.logoutFrame?(i(t)&&t(),i(e.loadSuccess)&&e.loadSuccess()):e._loadFail?i(e.loadFail)&&e.loadFail():(e._loadFail=!0,e._loadLogout(t))})},t.prototype._loadComponent=function(t){var e=this;u(this.styleSrc,"YT-ComponentCss"),setTimeout(function(){window.YKComponent?i(t)&&t():h(e.scriptSrc,function(){window.YKComponent?(i(t)&&t(),i(e.loadSuccess)&&e.loadSuccess()):e._loadFail?(e._loadError=!0,i(e.loadFail)&&e.loadFail()):(e._loadFail=!0,e._loadComponent(t))})},this._loadFail?0:50)},t.getInstance=function(){return vt[this.loadMode]},t}();St.ready=o,window.YKLoginLoader=window.YKLoginLoader||St,window.YKComponentLoader=window.YKComponentLoader||St,window.getLoginFrame=window.getLoginFrame||St}();