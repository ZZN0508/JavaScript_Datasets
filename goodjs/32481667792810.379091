"use strict";!function(){var v,m,d,y,g,o,c,n={},l=(e.prototype.isReady=function(){return c&&c.isInitiated},e.prototype.hasConsent=function(){return!0},e.prototype.addEventListener=function(e){"ready"===e.event&&this.isReady()?e.handler({api:this}):v.on(e)},e.prototype.triggerSurvey=function(r){var u,d=this,c=!1;void 0!==(null===r||void 0===r?void 0:r.timeout)&&0<r.timeout&&(u=setTimeout(function(){l(!(c=!0)),v.emit("surveyloaded",{available:!1,showed:!1})},r.timeout));var l=function(e,t,n){r&&r.callback&&r.callback(e,t,n)},p={mid:(r=r||{}).mid,bid:r.bid,callback:r.callback,autoRender:void 0===r.autoRender||r.autoRender,force:void 0!==r.force&&r.force,isTest:void 0!==r.isTest&&r.isTest,dtName:r.dtName},e=!1,t=[];if("none"!==m.storage&&y){var n,i=y.state(),o=0,s=0;for(n in i)if(i.hasOwnProperty(n)){var a=i[n];if(!0!==p.isTest&&p.mid===a.mid&&!0===a.isAnswered){e=!0;break}!1===a.isAnswered&&a.nbrOfSurveys<m.survey.max&&Date.now()-a.lastSurvey>1e3*m.survey.interval*60&&(o=Math.max(o,a.lastSurvey),Date.now()-a.lastSurvey<6048e5&&(s+=a.nbrOfSurveys),t.push(a))}(s>=m.survey.maxTot||Date.now()-o<1e3*m.survey.intervalTot*60)&&(e=!0)}if(!0===e)return clearInterval(u),l(!1),void v.emit("surveyloaded",{available:!1,showed:!1});var f=Math.random()<=m.surveyRandomization;p.callback||p.mid||p.isTest||p.force||f?function(e){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=e,t.onload=function(){if(!c){clearTimeout(u);var e=brandmetrics.getModule(-1),t=!1,n=!1,r=!1;if(void 0!==e)for(var i=0,o=e.surveys;i<o.length;i++){var s=o[i];r=!0;var a=d.createSurvey(s);l(!0,s,a),t=!0,p.autoRender&&(a.show(),n=!0)}t||l(!1),v.emit("surveyloaded",{available:r,showed:n})}};e=document.getElementsByTagName("script")[0];if(null==e||null==e.parentNode)throw new Error("can't find script tag");e.parentNode.insertBefore(t,e)}(g.GetConfigUrl(p.mid||null,p.isTest||!1,p.force,p.dtName,t)):f||(clearTimeout(u),v.emit("surveyloaded",{available:!1,showed:!1}),v.emit("surveyloadskipped",p))},e.prototype.createSurvey=function(e){if(void 0===e||void 0===e.measurementId||void 0===e.displayOption)throw new Error("");if(o){var t=o(g,e,v,y||(d?d.storage:void 0));return n[e.measurementId]=t}throw new Error("brandmetrics: This configuration does not support creating surveys.")},e.prototype.addMetadata=function(e){if(void 0===e||void 0===e.name||void 0===e.value||"string"!=typeof e.value)throw new Error("Invalid Argument");g.upsertParam(e.name,e.value)},e.prototype.setDoNotTrack=function(){var e=localStorage;e&&(e.setItem("__bmdnt","true"),e.removeItem("__bm_m"),e.removeItem("__bm_s")),g.postOptout()},e.prototype.triggerExposure=function(e){if(void 0===d)throw new Error("brandmetrics: triggerExposure only works collection is activated.");d.triggerApiExposure(e)},e.prototype.collectAds=function(e){},e.prototype.getState=function(){return y?y.state():void 0},e.prototype.reinitialize=function(){void 0!==d&&d.reinitialize()},e.prototype.addUserIds=function(e){g.ConfigureDefaultParams({uid:{value:e.join(",")}})},e.prototype.getOptions=function(){return m},e.prototype.stop=function(){void 0!==d&&d.stop()},e);function e(e,t,n,r,i){if(m=e,o=r,g=n,v=t,d=i)y=d.storage;else if("ls"===e.storage)try{y=new(brandmetrics.getModule(5))(m,v,!1)}catch(e){y=void 0}}window.brandmetrics.register({id:0,ctor:function(e,t,n,r,i,o,s){var a=new l(e,t,n,r,i),u={bm:a,collection:d,options:e,utils:t,client:n,callback:function(){s(a),v.emit("ready",{api:a})}};switch(o){case 0:c=new(brandmetrics.getModule(19))(u);break;case 1:c=new(brandmetrics.getModule(20))(u);break;default:throw new Error("Failed to start brandmetrics, the mode: "+o+" is not defined.")}c.start()}})}();var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};!function(){function u(i,o){for(var e=0,t=w;e<t.length;e++)!function(e){var t,n,r=(t=e.element,0<(n=o.filter(function(e){return e.element===t})).length&&n[0]);switch(e.status){case 1:r&&1!==r.state?S([e],i,!1):I(e);break;case 0:case 3:r&&1===r.state&&s(e,i)}}(t[e]);a(i.storage,!0)}function o(o,s,a){for(var e,u=!1,d=null,c=null!==(d=s.element instanceof HTMLElement?s.element:0<(e=document.querySelectorAll(g.escapeSelector("#"+s.element))).length?e[e.length-1]:null)?w.filter(function(e){return e.element===d}):[],l=[],t=0,n=v.measurements;t<n.length;t++){var r=function(t){var e=k(t.keys,s.key);if(null!==e){var n,r=function(t,e){var n;if(void 0===e)switch(t.source){case"apn":n=["creativeId"];break;case"gpt":n=["creativeId","lineItemId"];break;case"pbj":n=["dealId"];break;case"ntv":case"api":case"slot":n=["key"];break;case"instant":n=["pid"];break;default:throw Error("Constructing id's from source: "+t.source+" is not implemented.")}else n=e;return n.map(function(e){return t[e]}).join(":")}(s.key,t.uks),i=v.adSlot.hostCollectionConfiguration;if(i&&h&&("all"===i.type||"specified"===i.type&&-1!==i.ids.indexOf(t.id)))return h.transmitBeacon(t.id,r),{value:void 0};e.meta&&!0===e.meta.collect&&s.ad&&b.indexOf(r)<0&&b.push(r),a&&_[r]&&!0===_[r].seen?y.postEvent(13,t.id,void 0,{pid:r}):y.postEvent(12,t.id,void 0,{pid:r}),_[r]||(_[r]={seen:!0,sentTrackingExposure:!1}),void 0===m||null===d?(n=o.storage.updateExp(t.id,r,1,1),y.postEvent(10,t.id,n,{pid:r,first:_[r].sentTrackingExposure?void 0:"true",noel:"true"}),_[r].sentTrackingExposure=!0):(u=!0,(n=w.filter(function(e){return 1===e.status&&e.mid===t.id&&(d===e.element||e.element.id&&d.querySelector(g.escapeSelector("#"+e.element.id))||d.id&&e.element.querySelector(g.escapeSelector("#"+d.id)))})[0])?I(n):(0<c.length&&(n=c.filter(function(e){return e.uid!==r}),S(n,o,!0)),w.push({status:0,mid:t.id,uid:r,element:d}),l.push(d)))}}(n[t]);if("object"==typeof r)return r.value}for(var i=0,p=l;i<p.length;i++){var f=p[i];null===m||void 0===m||m.observe(f)}!u&&0<c.length&&S(c,o,!0)}function n(e){c.clean(v.measurements);for(var t=0,n=e;t<n.length;t++){var r=n[t],i=Math.floor((r.last-r.start)/1e3),o=c.updateExp(r.mid,r.uid,0,i);y.postEvent(11,r.mid,o,{pid:r.uid,ts:i.toString()})}c.setSession([])}function r(){t&&clearInterval(t),t=setInterval(function(){for(var e=0,t=w;e<t.length;e++){var n=t[e];1===n.status&&I(n)}a(c,!1)},1e3)}var d,v,m,y,g,h,c,l=!1,w=[],b=[],_={},S=function(e,r,i){e.forEach(function(e){var t;1===e.status&&(I(e),n=Math.floor((e.last-e.start)/1e3),t=r.storage.updateExp(e.mid,e.uid,0,n),y.postEvent(11,e.mid,t,{pid:e.uid,ts:(n+1).toString()}));var n=w.indexOf(e);i?(null===m||void 0===m||m.unObserve(e.element),w.splice(n,1)):w[n]={status:3,uid:e.uid,mid:e.mid,element:e.element}}),a(r.storage,!0)},s=function(e,t){var n=w.indexOf(e),t=t.storage.updateExp(e.mid,e.uid,1,1);y.postEvent(10,e.mid,t,{pid:e.uid,first:_[e.uid].sentTrackingExposure?void 0:"true"}),_[e.uid].sentTrackingExposure=!0,w[n]=__assign(__assign({},e),{status:1,start:Date.now()-1e3,last:Date.now()})},I=function(e){var t,n=Date.now(),r=g.getIdleTimeout();n-e.last>r+1&&(t=e.last-e.start,e.start=n-t-r),e.last=n},a=function(e,t){var n=w.map(function(e){return 1===e.status?{mid:e.mid,uid:e.uid,start:e.start,last:e.last}:null});e.setSession(n.filter(function(e){return null!==e})),t&&r()},p=function(e,t,n){n=n?2*n:100,e.isReady()?t():setTimeout(function(){return p(e,t,n)},n)},f=function(e){d.forEach(function(e){return e.setActive(!1)}),t&&clearInterval(t),S(w.filter(function(){return!0}),e,!0),n(c.getSession())},E=function(t,n){d.filter(function(e){return e.isReady()}).map(function(e){return e.getDisplayedSlots()}).forEach(function(e){e.forEach(function(e){return o(t,e,n)})}),d.forEach(function(e){return e.setActive(!0)}),r()},t=0,k=function(e,t){for(var n=null,r=0,i=e;r<i.length;r++){var o,s=i[r],a=!0;for(o in s)if(s.hasOwnProperty(o)){if("ntv"===s.source&&"urlPattern"===o||"meta"===o)continue;if(s[o]!=t[o]){a=!1;break}}if(a){n=s;break}}return n},e=(i.prototype.isInitiated=function(){return null!=d&&null!=this.storage},i.prototype.reinitialize=function(){var t=this;f(this),E(this,!1),d.forEach(function(e){e.slotDisplayed(function(e){return o(t,e,!1)})})},i.prototype.start=function(){var i=this;n(c.getSession()),n(c.getAndRemoveOutdatedSessions());for(var e=0,t=d;e<t.length;e++)!function(r){p(r,function(){for(var e=0,t=r.getDisplayedSlots();e<t.length;e++){var n=t[e];o(i,n,!1)}r.slotDisplayed(function(e){return o(i,e,!1)})})}(t[e]);r(),l=!0},i.prototype.stop=function(){f(this)},i.prototype.getState=function(){return this.storage.state()},i.prototype.triggerApiExposure=function(e){var t,n,r;e.key?t={key:{source:"api",key:e.key},element:e.element}:e.mid&&(t={key:{source:"instant",mid:e.mid,pid:e.pid||e.mid},element:e.element},n=e.mid,r=t.key,0<(e=v.measurements.filter(function(e){return e.id===n})).length?(e=e[0],null===k(e.keys,r)&&e.keys.push(r)):v.measurements.push({id:n,keys:[r]})),t&&o(this,t,!1)},i.prototype.endExposure=function(t){var e=w.filter(function(e){return e.element===t});S(e,this,!0)},i);function i(e,t,n,r,i,o){var s,a=this;this.storage=i,c=i,y=t,d=r,h=o,t={collection:this,callback:u,utils:g=n,threshold:(v=e).inview.threshold||1e3},r=brandmetrics.getModule(17),o=brandmetrics.getModule(18),n=brandmetrics.getModule(16),e=brandmetrics.getModule(15),(window.omid3p||window.oo)&&o?s=new o(t):window.mraid&&r?s=new r(t):window.IntersectionObserver&&n?s=new n(t):e&&(s=new e(t)),m=s,g.on({event:"pagestatus",handler:function(e){!function(e,t){if(l)switch(e){case 0:E(t,!0);break;case 1:f(t)}}(e,a)}})}window.brandmetrics.register({id:1,ctor:e})}();var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r};!function(){function i(e){return!0===e?1:2}function t(){function e(e,t,n){e.addEventListener&&e.addEventListener(t,n)}function t(){i||(u("pagestatus",0),i=!0),clearTimeout(r),r=setTimeout(n,a)}function n(){i&&(u("pagestatus",1),i=!1)}var r,i=!0,o=window;e(o,"load",t),e(o,"touchstart",t),e(o,"keypress",t),e(o,"scroll",t),e(o,"pagehide",n),e(o,"beforeunload",n),e(document,"visibilitychange",function(){(document.hidden?n:t)()}),o.IntersectionObserver&&new IntersectionObserver(function(){t()},{threshold:.1}).observe(document.documentElement),t()}function s(e){return Math.abs((e[2]-e[0])*(e[1]-e[3]))}function o(e,t,n){if(0<d.length&&(null===e||e.isReady())){var r=d.shift();try{!function(e,t,n){var r,i,o,s,a,u,d,c;if(null!==e&&!e.isReady())throw new Error("Try to execute commands before initiated");switch(t.cmd=void 0===t.cmd?"":t.cmd.toLowerCase(),t.cmd){case"_loadsurvey":null===(r=e)||void 0===r||r.triggerSurvey(t.val);break;case"_forcesurvey":null===(i=e)||void 0===i||i.triggerSurvey({mid:t.val.mid,force:!0,dtName:t.val.style});break;case"_querysurvey":if(void 0===t.val||void 0===t.val.callback)throw new Error("No callback defined");null===(o=e)||void 0===o||o.triggerSurvey({autoRender:!1,callback:t.val.callback});break;case"_addmetadata":var l=t.val;void 0===l.value&&void 0!==l.val&&(l.value=l.val),null===(s=e)||void 0===s||s.addMetadata(l);break;case"_setdonottrack":null===(a=e)||void 0===a||a.setDoNotTrack();break;case"_triggerexposure":if(void 0===t.val)throw new Error("The command _triggerexposure needs a value.");null===(u=e)||void 0===u||u.triggerExposure(t.val);break;case"_addeventlistener":null!==e?e.addEventListener(t.val):n.on(t.val);break;case"_adduserids":void 0!==t.val&&(null===(d=e)||void 0===d||d.addUserIds(t.val));break;case"_reinitialize":null===(c=e)||void 0===c||c.reinitialize();break;default:throw new Error("unknown cmd")}}(e,r,n)}catch(e){r="Error in command: "+r.cmd+", msg: "+e;throw t.postDiagnostics(r),new Error(r)}o(e,t,n)}}var a=3e4,n=/^#([0-9])/,r=[],u=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];r.forEach(function(e){e.event===t&&e.handler.apply(e,n)})},d=new Array,e=(c.prototype.getPageRect=function(){var e=document.documentElement.scrollLeft||document.body.scrollLeft||window.pageXOffset,t=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset;return[e,t,e+("innerWidth"in window?window.innerWidth:document.body.clientWidth),t+("innerHeight"in window?window.innerHeight:document.body.clientHeight)]},c.prototype.getElementRect=function(e){for(var t=0,n=0,r=e.offsetWidth,i=e.offsetHeight;null!==e.offsetParent;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return[t,n,t+r,n+i]},c.prototype.rectsIntersect=function(e,t){return e[0]<t[2]&&e[2]>t[0]&&e[1]<t[3]&&e[3]>t[1]},c.prototype.rectsRatio=function(e,t){var n,r,i,o=0;return this.rectsIntersect(e,t)&&(n=Math.max(e[0],t[0]),r=Math.min(e[2],t[2]),i=Math.max(e[1],t[1]),e=Math.min(e[3],t[3]),o=s([n,i,r,e])/s(t)),o},c.prototype.inView=function(e){var t=this.getPageRect(),n=this.getElementRect(e),r=s(n)>s(t),e=this.inViewByRatio(this.rectsRatio(t,n)),t=r?i(.25<this.rectsRatio(n,t)):this.inViewByRatio(this.rectsRatio(n,t));return i(1===e||1===t)},c.prototype.inViewByRatio=function(e){return i(.5<=e)},c.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.apply(void 0,__spreadArrays([e],t))},c.prototype.on=function(e){r.push(e)},c.prototype.un=function(e){for(var t=r.length-1;0<=t;t--){var n=r[t];n.event===e.event&&n.handler===e.handler&&r.splice(t,1)}},c.prototype.getIdleTimeout=function(){return a},c.prototype.initProcessing=function(n,r){var i=this;window.brandmetrics.cmd=window.brandmetrics.cmd||window._brandmetrics||[],window._brandmetrics||(window._brandmetrics=window.brandmetrics.cmd),window.brandmetrics.cmd.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return d.push.apply(d,e),o(n,r,i),Array.prototype.push.apply(this,e)},d.push.apply(d,window.brandmetrics.cmd)},c.prototype.process=function(e,t){o(e,t,this)},c);function c(e){this.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},this.escapeSelector=function(e){var t=n.exec(e);return e=t?e.replace(t[0],"#\\3"+t[1]+" "):e},e.idleTimeout&&(a=1e3*e.idleTimeout),t()}window.brandmetrics.register({id:2,ctor:e})}();__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};!function(){function c(e,t){var n,r,i=[];for(n in t=t||{},o)(o.hasOwnProperty(n)&&(0===e.length||0<=e.indexOf(n))||t.hasOwnProperty(n))&&(r=o[n],null!=(r=t[n]||r.value||(void 0!==r.func?r.func():void 0))&&""!==r&&i.push(n+"="+d(r)));return i.join("&")}function l(e){return!(e&&(!t||-1===t.indexOf(e)))}function d(e){return"function"==typeof encodeURIComponent?encodeURIComponent(e):window.escape(e)}function p(e,t){(new Image).src=f.baseUrl+"/"+e+"?"+t}var f,v,t,m,o,e=(n.prototype.GetBaseUrl=function(){return f.baseUrl},n.prototype.GetConfigUrl=function(e,t,n,r,i){void 0===t&&(t=!1),void 0===n&&(n=!1);var o="";if(0<i.length)for(var s=0,a=i;s<a.length;s++)var u=a[s],o=o+(u.uid+";"+u.mid+";"+u.pixels.map(function(e){return e.uid+","+e.exp}).join(";"))+"|";var d=c([],{test:t?"true":void 0,forced:n?"true":void 0,dtname:r,mid:null===e?void 0:e,ms:o,uid:!l(e)||null===(d=m)||void 0===d?void 0:d.join(","),slang:f.language});return f.baseUrl+"/c.js?"+d},n.prototype.GetTemplateUrl=function(e,t,n){e={mid:e};t?e.dtname=t:n&&(e.tpl=n);e=c(["siteid","toploc","test","slang"],e);return(f.cdnUrl||f.baseUrl)+"/s.html?"+e},n.prototype.upsertParam=function(e,t){v[e]=t},n.prototype.postAd=function(e,t,n,r){e=c([],{mid:e,adkey:t}),t=new XMLHttpRequest;t.open("POST",f.baseUrl+"/ac?"+e,!0),t.setRequestHeader("Content-Type","application/json"),t.send(JSON.stringify({content:n,key:r}))},n.prototype.postAnswer=function(e,t,n,r,i,o){var s,a="";void 0!==i&&(s=Math.max.apply(Math,i.pixels.map(function(e){return e.lastexp})),a=i.uid+";"+i.nbrOfSurveys+";"+i.pixels.map(function(e){return e.uid+","+e.exp+","+e.time}).join(";")+";"+s);var u=c([],{test:"true"===(o=o||{}).test?"true":void 0,pid:o.pid,forced:"true"===o.forced?"true":void 0,dtname:o.dtname,mid:e,qdata:t,state:a,meta:function(){var e,t,n=[];for(e in v)!v.hasOwnProperty(e)||null!=(t=v[e])&&""!==t&&n.push(e+"="+d(t));return n.join("&")}(),sname:""!==n?n:void 0,sit:r,uid:!l(e)||null===(u=m)||void 0===u?void 0:u.join(",")});p("a",u)},n.prototype.postDiagnostics=function(e){f.logErrors&&(e=c(["rnd"],{msg:e}),p("diagnostics",e))},n.prototype.postOptout=function(){var e;void 0!==f.siteId&&(e=c(["siteid"]),p("optout",e))},n.prototype.postEvent=function(e,t,u,d){t=function(e,t,n){var r;n=d||{};var i="";if(void 0!==u){for(var o=0,s=0,a=u.pixels;s<a.length;s++)o+=a[s].exp;i=""+o}return c([],{test:"true"===n.test?"true":void 0,forced:"true"===n.forced?"true":void 0,dtname:n.dtname,pid:n.pid,eid:e.toString(),ts:n.ts,state:i,mid:t,uid:!l(t)||null===(r=m)||void 0===r?void 0:r.join(","),first:"true"===n.first?"true":void 0,noel:"true"===n.noel?"true":void 0})}(e,t);p("i",t)},n.prototype.GetRedirectUrl=function(e){e=c([],{siteid:f.siteId,rt:e});return f.baseUrl+"/r?"+e},n.prototype.ConfigureDefaultParams=function(e){o=__assign(__assign({},o),e)},n.prototype.RestrictSingleUserMesurement=function(e){t=e},n.prototype.ConfigureSingleUsers=function(e){m=e},n);function n(e){v={},o={siteid:{value:(f=e).siteId},toploc:{func:function(){return e=document.location.ancestorOrigins&&0<document.location.ancestorOrigins.length?document.location.ancestorOrigins:[window.document.location.href],t=e[e.length-1],(e=document.createElement("a")).href=t,e.host||"";var e,t}},test:{value:f.isTest?"true":void 0},qdata:{},mid:{},pid:{},meta:{},state:{},ms:{},forced:{},msg:{},eid:{},ts:{},rt:{},rnd:{func:function(){return Math.floor(9999001*Math.random()+1e3).toString()}},adkey:{},dtname:{},slang:{value:f.language},sname:{},sit:{},uid:{value:f.userIds?f.userIds.join(","):void 0},tpl:{},first:{},noel:{}}}window.brandmetrics.register({id:3,ctor:e})}();__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};!function(){function i(e){try{if(void 0!==e.data.req&&"get"===e.data.req&&"created"===m){m="requested";var t=e.data.dtname;t&&(d.props||(d.props={}),d.props.dtname=t);var n={key:e.data.key,iframeCss:d.displayOption.iframeCss,url:c.GetTemplateUrl(d.measurementId,t,d.templateId),mid:d.measurementId};return h.push(e.data.key),void e.source.postMessage(n,"*")}var r=e.data.message||e.data;if(!(e.data.origin===c.GetBaseUrl()||"null"===e.origin||e.data.key&&-1!==h.indexOf(e.data.key)))return void("string"==typeof e.data&&-1<e.data.indexOf(d.measurementId)&&c.postDiagnostics("Message origin not expected "+e.origin));var i=function(e){if("string"!=typeof e||-1===e.indexOf(d.measurementId))return null;var t=e.split("|"),n=t[1];switch(n){case"closed":return{mid:t[0],type:n};case"completed":var r,i="true",o="";return 2<t.length&&-1<(r=t[2]).indexOf("closeSurvey")&&(i=r.substring(r.lastIndexOf("=")+1)),3<t.length&&-1<(r=t[3]).indexOf("closeSurveyTimeout")&&(o=r.substring(r.lastIndexOf("=")+1)),{mid:t[0],type:n,closeSurvey:i,closeSurveyTimeout:o};case"rendered":var i=t[2],o=i.substring(i.lastIndexOf("=")+1),s="";return 3<t.length&&(s=(i=t[3]).substring(i.lastIndexOf("=")+1)),{mid:t[0],type:n,size:o,surveyType:s};case"resize":return{mid:t[0],type:n,size:e.substring(e.lastIndexOf("=")+1)};case"answer":s=function(e,t){if(e){for(var n=-1,r=0;r<e.length;r++)if(e[r].substring(0,t.length)===t){n=r;break}if(0<=n){var i=e[n];return i.substring(i.lastIndexOf("=")+1)}}return""}(t,"surveyName");return{mid:t[0],type:n,answer:t[2],surveyName:s};case"redirect":return{target:t[2],type:n};case"updateStyle":return{mid:t[0],type:n,style:e.substring(e.lastIndexOf("=")+1)};case"requestClientSize":return{mid:t[0],type:n};case"surveyinview":return{mid:t[0],type:n,time:parseInt(t[2],10)};default:return null}}(r);if(null===i)return;var o,s=void 0===p?void 0:p.state()[d.measurementId];switch(i.type){case"rendered":"answered"===m||"closed"===m?v.close():"rendered"!==m&&(m="rendered",c.postEvent(1,i.mid,s,d.props),(!i.surveyType||"2"!==i.surveyType&&"3"!==i.surveyType?_:function(t){if(void 0!==t){var e="";for(var n in b)""!==t.style.getPropertyValue(n)&&(e=b[n]);""!==e&&t.addEventListener(e,function(){var e;t.clientWidth<150||t.clientHeight<150?(e=t,w&&e&&(clearTimeout(f),f=void 0,w.unobserve(e))):_(t)},!1)}})(v.element()),v.resize(i.size),l.emit("surveyrendered",{}));break;case"resize":v.resize(i.size);break;case"answer":var a=g?5:y?1:0,u=p?p.updateSrv(d.measurementId,!0):void 0;c.postAnswer(i.mid,i.answer,i.surveyName,a,u,d.props),l.emit("surveyanswered",{});break;case"completed":m="completed",c.postEvent(3,i.mid,s,d.props),"true"===i.closeSurvey&&(o=Number(i.closeSurveyTimeout),!isNaN(o)&&0<o?setTimeout(function(){v.close()},o):v.close());break;case"closed":c.postEvent(4,i.mid,s,d.props),v.close(),l.emit("surveyclosed",{});break;case"redirect":window.location.href=c.GetRedirectUrl(i.target);break;case"updateStyle":v.updateStyle(i.style);break;case"requestClientSize":v.requestClientSize(i.mid);break;case"surveyinview":1===i.time?(s=p?p.updateSrv(d.measurementId,!1):void 0,c.postEvent(2,i.mid,s,d.props),y=!0):1<i.time&&(c.postEvent(5,i.mid,s,d.props),g=!0)}}catch(e){c.postDiagnostics("Error in handleMessage, "+e)}}function o(e,t,n){var r,i;void 0!==window.apntag&&window.apntag.loaded?(r=window.apntag,i={},n?(i[e]=t,r.setKeywords(n,i)):r.anq.push(function(){(i=r.requests?r.requests.keywords:{})[e]=t,r.setPageOpts({keywords:i})})):setTimeout(function(){o(e,t,n)},200)}function s(t,e){var n,r;void 0!==window.googletag&&window.googletag.apiReady?(n=window.googletag,t?(r=n.pubads().getSlots().filter(function(e){return e.getSlotElementId()===t})[0])&&r.setTargeting(e,"yes"):(n.pubads().setTargeting(e,"yes"),n&&n.pubads&&n.pubads().getTargetingKeys)):setTimeout(function(){s(t,e)},200)}function n(e,t){void 0!==window.adhese?window.adhese.registerRequestParameters(e,t):setTimeout(function(){n(e,t)},200)}var d,c,l,p,f,v,m="created",y=!1,g=!1,h=[],w=window.IntersectionObserver?new IntersectionObserver(function(e){.5<=e[0].intersectionRatio&&void 0===f?f=setTimeout(function(){var e;y||(e=p?p.updateSrv(d.measurementId,!1):void 0,c.postEvent(2,d.measurementId,e,d.props),y=!0),f=setTimeout(function(){var e;g||(e=p?p.state()[d.measurementId]:void 0,c.postEvent(5,d.measurementId,e,d.props),g=!0)},4e3)},1e3):void 0!==f&&(clearTimeout(f),f=void 0)},{threshold:[0,.5]}):void 0,b={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"},_=function(e){w&&e&&!g&&w.observe(e)},a=(E.prototype.state=function(){return m},E.prototype.resize=function(){},E.prototype.element=function(){},E.prototype.close=function(){m="closed"},E.prototype.updateStyle=function(){},E.prototype.requestClientSize=function(e){},E.prototype.show=function(){var e=this._dc.targetKey||"brandmetrics-survey",t=this._dc.adSlot;s(t,e)},E),u=(r.prototype.state=function(){return m},r.prototype.resize=function(){},r.prototype.element=function(){},r.prototype.close=function(){m="closed"},r.prototype.updateStyle=function(){},r.prototype.requestClientSize=function(e){},r.prototype.show=function(){var e=this._dc.targetKeyword||"kw",t=this._dc.targetValue||"brandmetrics-survey",n=this._dc.adSlot;o(e,t,n)},r),S=(t.prototype.state=function(){return m},t.prototype.resize=function(){},t.prototype.element=function(){},t.prototype.close=function(){m="closed"},t.prototype.updateStyle=function(){},t.prototype.requestClientSize=function(e){},t.prototype.show=function(){this._dc.targetKeyword&&this._dc.targetValue&&n(this._dc.targetKeyword,this._dc.targetValue)},t),I=(e.prototype.state=function(){return m},e.prototype.resize=function(e){var t,n=null,r=null;0<e.indexOf(",")?(n=(t=e.split(","))[0],r=t[1]):n=e,this._iframe.height=n+"px",r&&(this._iframe.width=r+"px")},e.prototype.element=function(){return this._iframe},e.prototype.close=function(){m="closed",this._iframe.style.display="none"},e.prototype.updateStyle=function(e){for(var t=0,n=e.split(";");t<n.length;t++){var r=n[t];""!==r.trim()&&(r=r.split(":"),this._iframe.style.setProperty(r[0].trim(),r[1].trim()))}},e.prototype.requestClientSize=function(e){this._iframe.contentWindow&&this._iframe.contentWindow.postMessage(e+"|clientsize|"+(e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)+","+e),"*")},e.prototype.show=function(){var e;"block"!==this._iframe.style.display&&null==(e=this._dc.element||function(e){var t=e.selector;if(!t)throw new Error("No targetElement configured");e=(!0===e.onTop?window.top:window).document.querySelectorAll(l.escapeSelector(t));if(e.length<=0)throw new Error("can't find target element: "+t);return e[e.length-1]}(this._dc)).querySelector("iframe[data-bmsurvey]")&&(function(e,t,n){var r=t.offsetWidth;e.style.cssText=n.iframeCss.replace("{{targetwidth}}",r.toString());r=!1;try{("before"===n.injectType?"beforebegin":"after"===n.injectType?"afterend":"prepend"===n.injectType?"afterbegin":"append"===n.injectType?"beforeend":"")&&(t.insertAdjacentElement("beforebegin",e),r=!0)}catch(e){}!1===r&&t.appendChild(e)}(this._iframe,e,this._dc),this._iframe.style.display="block")},e);function e(e){var t,n;this._dc=e,this._iframe=(n=d,e=document.createElement("iframe"),"inject"===n.displayOption.type&&n.displayOption.sandboxProps?e.sandbox.value=n.displayOption.sandboxProps+" allow-scripts":e.sandbox.value="allow-scripts",e.setAttribute("data-bmsurvey",""),e.height="0","inject"===d.displayOption.type&&(t=d.displayOption.displayTypeName),e.style.cssText=d.displayOption.iframeCss,e.src=c.GetTemplateUrl(n.measurementId,t,n.templateId),e.scrolling="no",e)}function t(e){this._dc=e}function r(e){var r=this;this._dc=e,l.on({event:"surveyanswered",handler:function(){var t,n;t=r._dc.targetKeyword||"brandmetrics-survey",(n=window.apntag).anq.push(function(){var e=n.requests?n.requests.keywords:{};delete e[t],n.setPageOpts({keywords:e})})}})}function E(e){var t=this;this._dc=e,l.on({event:"surveyanswered",handler:function(){var e;e=t._dc.targetKey||"brandmetrics-survey",window.googletag&&window.googletag.pubads().clearTargeting(e)}})}window.brandmetrics.register({id:4,ctor:function(e,t,n,r){c=e,l=n,p=r;n=(d=t).displayOption;return v="vpaid"===n.type?(r=brandmetrics.getModule(25),(t=getVPAIDAd().getSlot())&&t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.addEventListener("message",i,!1),new r(n,new I(__assign(__assign({},n),{type:"inject",element:getVPAIDAd().getSlot()})),l)):(("inject"===d.displayOption.type&&!0===d.displayOption.onTop?window.top:window).addEventListener("message",i,!1),"dfp"===n.type?new a(n):"apn"===n.type?new u(n):"adh"===n.type?new S(n):"inject"===n.type?new I(n):{state:function(){return"failed"},resize:function(){},element:function(){},show:function(){},close:function(){},updateStyle:function(){},requestClientSize:function(){}})}})}(),function(){function l(e){if(void 0===e&&(e=!1),u||e){var t=f.getItem(v),n={};try{n=null!=t?p.DeserializeMeasurements(t):{}}catch(e){f.removeItem(v)}m=n}return m}function t(){return u?a+"#"+r:a}var s,p,f,r,v="__bm_m",a="__bm_s",m={},u=!1,i=(o.prototype.calcLength=function(){this.length=Object.keys(this._data).length},o.prototype.getItem=function(e){return this._data.hasOwnProperty(e)?this._data[e]:null},o.prototype.setItem=function(e,t){t=this._data[e]=String(t);return this.calcLength(),t},o.prototype.removeItem=function(e){e=delete this._data[e];return this.calcLength(),e},o.prototype.clear=function(){return this._data={},this.calcLength(),this._data},o.prototype.key=function(e){var t=Object.keys(this._data);return t.length<e?t[e]:null},o),e=(n.prototype.clean=function(e){var n={},r=l(),i=0;for(t in r)!function(t){r.hasOwnProperty(t)&&(i++,void 0!==e.filter(function(e){return e.id===t})[0]&&(n[t]=r[t]))}(t);(0!==e.length&&i-e.length==1||(i-e.length)/i<=.2)&&(r=n);var t,o=Date.now();for(t in r)if(r.hasOwnProperty(t)){for(var s=r[t],a=Math.max(s.created,s.lastSurvey),u=0,d=s.pixels;u<d.length;u++)var c=d[u],a=Math.max(a,c.lastexp);s=o-a;s<o&&24192e5<s&&delete r[t]}m=r,f.setItem(v,p.SerializeMeasurements(r))},n.prototype.state=function(){return l()},n.prototype.updateExp=function(e,t,n,r){var i=l(),o=i[e];void 0===o&&(o={mid:e,uid:s.guid(),isAnswered:!1,lastSurvey:0,nbrOfSurveys:0,created:Date.now(),pixels:[]},i[e]=o);e=o.pixels.filter(function(e){return e.uid===t})[0];return void 0===e&&o.pixels.push(e={uid:t,exp:0,lastexp:0,time:0}),e.exp=e.exp+n,e.time=e.time+r,e.lastexp=Date.now(),f.setItem(v,p.SerializeMeasurements(i)),o},n.prototype.updateSrv=function(e,t){var n=l(),r=n[e];return void 0===r&&(r={mid:e,uid:s.guid(),created:Date.now(),isAnswered:!1,lastSurvey:0,nbrOfSurveys:0,pixels:[]},n[e]=r),!0===t?r.isAnswered=!0:(r.lastSurvey=Date.now(),r.nbrOfSurveys=r.nbrOfSurveys+1),f.setItem(v,p.SerializeMeasurements(n)),r},n.prototype.getTemp=function(){return[]},n.prototype.setTemp=function(e){throw new Error("Method not implemented."+e)},n.prototype.getSession=function(){var e=f.getItem(t());return null!=e?p.DeserializeSessions(e):[]},n.prototype.setSession=function(e){f.setItem(t(),p.SerializeSessions(e))},n.prototype.getAndRemoveOutdatedSessions=function(){var i,o=[];if(u)for(var e=0,t=f.length;e<t;e++)!function(e){var t,n,r=f.key(e);0===(null===(i=r)||void 0===i?void 0:i.indexOf(a+"#"))&&(e=p.DeserializeSessions(f.getItem(r)),t=(new Date).getTime(),n=!0,e.forEach(function(e){t-e.last<3e5&&(n=!1)}),n&&(o.push.apply(o,e),f.removeItem(r)))}(e);return o},n);function n(e,t,n){p=new(brandmetrics.getModule(21)),s=t,u=n;n="__bm_ls_check";try{localStorage.setItem(n,n),localStorage.removeItem(n),f=localStorage}catch(e){f=new i}m=l(!0),r=Math.floor(1e6*Math.random())}function o(){this._data={},this.length=0}window.brandmetrics.register({id:5,ctor:e})}(),function(){function r(e){var t=e;return{key:{source:"gpt",advertiserId:(e=e.getResponseInformation())&&e.advertiserId,campaignId:e&&e.campaignId,creativeId:""+(e&&e.creativeId),lineItemId:""+(e&&e.lineItemId)},element:t.getSlotElementId(),ad:t.getHtml()}}var i={exposedEvent:"slotRenderEnded"},e=(t.prototype.isReady=function(){return!(!window.googletag||!window.googletag.apiReady)},t.prototype.getDisplayedSlots=function(){return window.googletag.pubads().getSlots().filter(function(e){return e.getResponseInformation()}).map(r)},t.prototype.slotDisplayed=function(t){var n=this;window.googletag.pubads().addEventListener(i.exposedEvent,function(e){n.active&&t(r(e.slot))})},t.prototype.setActive=function(e){this.active=e},t);function t(e){this.active=!0,i="gpt"===e.type&&e.conf?e.conf:i}window.brandmetrics.register({id:8,ctor:e})}(),function(){var t,n,r,i=1e3,o=[],s=null,e=(a.prototype.observe=function(e){this.isWatching(e)||(e={element:e,state:r.inView(e)},o.push(e)),null===s&&(s=setInterval(function(){var e;e=o.filter(function(e){var t=r.inView(e.element);return t!==e.state&&(e.state=t,!0)}),t&&t(n,e)},i))},a.prototype.unObserve=function(t){0===(o=o.filter(function(e){return e.element!==t})).length&&null!==s&&(clearInterval(s),s=null)},a.prototype.isWatching=function(t){return 0<o.filter(function(e){return e.element===t}).length},a);function a(e){n=e.collection,t=e.callback,r=e.utils,i=e.threshold}window.brandmetrics.register({id:15,ctor:e})}(),function(){function t(i){var e=s.filter(function(e){var t,n=(t=e.element,0<(r=i.filter(function(e){return e.target===t})).length?r[0]:null);if(n){var r=o.inViewByRatio(n.intersectionRatio);if((r=2===r&&n.isIntersecting&&n.rootBounds&&n.boundingClientRect&&n.rootBounds.height*n.rootBounds.width<n.boundingClientRect.height*n.boundingClientRect.width?o.inView(e.element):r)!==e.state){if(2===r)return void 0!==u[e]&&(clearTimeout(u[e]),delete u[e]),e.state=r,!0;1===r&&2===e.state&&c(e)}}return!1});d(e)}var n,r,o,i,s=[],a=1e3,u={},d=function(e){n&&n(r,e)},c=function(e){e.state=0;var t=setTimeout(function(){0===e.state&&(e.state=1,d([e]))},a);u[e]=t},e=(l.prototype.observe=function(e){var t;this.isWatching(e)||(t={element:e,state:o.inView(e)},s.push(t),1===t.state&&c(t),i.observe(e))},l.prototype.unObserve=function(t){s=s.filter(function(e){return e.element!==t}),i.unobserve(t)},l.prototype.isWatching=function(t){return 0<s.filter(function(e){return e.element===t}).length},l);function l(e){a=e.threshold,r=e.collection,n=e.callback,o=e.utils,i=new IntersectionObserver(t,{threshold:[0,.1,.2,.3,.4,.5]})}window.brandmetrics.register({id:16,ctor:e})}(),function(){function a(e,t){void 0===t&&(t=!0);var n,r,i,o,s=u.options;("auto"===s.startMode.type||"sessionSubsequent"===s.startMode.type&&(o=s.startMode,n="__bmsessionviews",r=1,null!==(i=sessionStorage.getItem(n))&&(r=parseInt(i,10)+1),sessionStorage.setItem(n,r.toString()),r>o.conf.count))&&((o=!function(e){for(var t=window.location.href,n=0,r=e;n<r.length;n++){var i=r[n],i=new RegExp(i);if(t.match(i))return 1}}((null===(o=s.startMode.conf)||void 0===o?void 0:o.excluded)||[]))&&s.startMode.conf&&s.startMode.conf.requiredElement&&(document.querySelector(u.utils.escapeSelector(s.startMode.conf.requiredElement))||(o=!1,t&&setTimeout(function(){a(e,!1)},1e3))),o?e.triggerSurvey():u.utils.emit("surveyloaded",{available:!1,showed:!1}))}var u,e=(t.prototype.start=function(){var e,t=this,n=u.bm,r=u.collection,i=u.callback;this.isInitiated?i():(u.utils.initProcessing(n,u.client),r?(r.start(),(e=function(){r.isInitiated()?(t.isInitiated=!0,u.utils.process(n,u.client),a(n),i()):setTimeout(function(){return e()},100)})()):(this.isInitiated=!0,u.utils.process(n,u.client),a(n),i()))},t);function t(e){this.isInitiated=!1,u=e}window.brandmetrics.register({id:19,ctor:e})}(),function(){var e=(t.prototype.SerializeMeasurements=function(e){for(var t="",n=0,r=0,i=Object.keys(e);r<i.length;r++){var o=i[r];t+=0!==n?"¤":"";var s=e[o];t+=o+"|"+s.isAnswered+"|"+s.lastSurvey+"|"+s.nbrOfSurveys+"|"+s.uid+"|"+s.created;for(var a=0,u=s.pixels;a<u.length;a++){var d=u[a];t+=";"+d.exp+"|"+d.lastexp+"|"+d.time+"|"+d.uid}n++}return t},t.prototype.DeserializeMeasurements=function(e){var n={};if(e&&""!==e)for(var r,t=0,i=e.split("¤");t<i.length;t++)i[t].split(";").forEach(function(e,t){if(e&&""!==e){e=e.split("|");if(0===t){if(5!==e.length&&6!==e.length)throw new Error("The string cannot be deserialized");r={mid:e[0],isAnswered:"true"===e[1].toLowerCase(),lastSurvey:parseInt(e[2],10),nbrOfSurveys:parseInt(e[3],10),uid:e[4],created:6===e.length?parseInt(e[5],10):Date.now(),pixels:[]},n[r.mid]=r}else{if(4!==e.length)throw new Error;e={exp:parseInt(e[0],10),lastexp:parseInt(e[1],10),time:parseInt(e[2],10),uid:e[3]};r.pixels.push(e)}}});return n},t.prototype.SerializeSessions=function(e){var n="";return e.forEach(function(e,t){n+=0!==t?";":"",n+=e.last+"|"+e.mid+"|"+e.start+"|"+e.uid}),n},t.prototype.DeserializeSessions=function(e){var t=[];if(e&&""!==e)for(var n=0,r=e.split(";");n<r.length;n++){var i=r[n].split("|");if(4!==i.length)throw new Error("The string cannot be deserialized");t.push({last:parseInt(i[0],10),mid:i[1],start:parseInt(i[2],10),uid:i[3]})}return t},t);function t(){}window.brandmetrics.register({id:21,ctor:e})}();__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};!function(){function t(e){var t=e.data;"bm"!==t.system||o[t.id]||function(e,t){switch(o[t.id]=!0,t.type){case"beacon":var n=s(e);r.triggerApiExposure({element:n,mid:t.mid,pid:t.pid});n={system:"bm",type:"accept",id:t.id};e.postMessage(n,"*");break;case"beacon_end":r.endExposure(s(e));break;case"query_host":n=__assign(__assign({},i),{system:"bm",type:"query_host_reply",id:t.id});e.postMessage(n,"*");break;default:throw new Error("brandmetrics: Host does not support message- type: "+t.type)}}(e.source,t)}var r,i,o={},s=function(e){for(var t=e;t.parent!==window;)t=t.parent;for(var n=document.getElementsByTagName("iframe"),r=0;r<n.length;r++)if(n[r].contentWindow===t)return n[r]};window.brandmetrics.register({id:26,ctor:function(e){r=e.collection,i=e.options.hostConfiguration||{surveysAtClient:{type:"none"},collectionAtHost:{type:"all"}},window.addEventListener("message",t,!1)}})}();
