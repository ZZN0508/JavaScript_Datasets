var site=window.location.host;firebase.initializeApp({messagingSenderId:"134119817733"});const messaging=firebase.messaging();messaging.usePublicVapidKey("BISugZ384NZ5uOvFRU3krawQktllnzIOVG-0NGfhMXVGzeFnFUCDyl1eCoq2hqGDLoQ7uIOt6Re6jlc2-cOhJGQ");var uuid_c=getCookie("uuid_c"),ukid=getCookie("ukid"),id="null",jixie_id="null",city="null",useragent=navigator.userAgent,uuid=Math.random().toString().replace("0.","");function setCookie(i,e,t){var n=new Date;n.setTime(n.getTime()+24*t*60*60*1e3);n="expires="+n.toUTCString();document.cookie=i+"="+e+";"+n+";path=/"}function getCookie(i){for(var e=i+"=",t=document.cookie.split(";"),n=0;n<t.length;n++){for(var o=t[n];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return null}ukid&&(jixie_id=ukid),uuid_c&&(uuid=uuid_c),-1==document.cookie.indexOf("kgnotif_akuisisi")&&navigator.serviceWorker.register("/kgnotif-tribun-sw.js").then(function(i){messaging.useServiceWorker(i),messaging.requestPermission().then(function(){messaging.getToken().then(function(i){console.log("Token 1",i);try{var e=new XMLHttpRequest;e.open("POST","https://kgn-api.kompas.com/subscribe/kgmedia",!0),e.send(JSON.stringify({uuid:uuid,token:i,site:site,kompasid:id,jixieid:jixie_id,useragent:useragent,city:city})),setCookie("kgnotif_akuisisi","true",36525),setCookie("uuid_c",uuid,36525)}catch(i){console.log(i)}}).catch(function(i){console.log("An error occurred while retrieving token. ",i)})}).catch(function(i){console.log("Unable to get permission to notify.",i)})}),messaging.onMessage(function(t){navigator.serviceWorker.register("/kgnotif-tribun-sw.js"),navigator.serviceWorker.ready.then(function(i){var e={body:(t=JSON.parse(t.data.notification)).body,icon:t.icon,data:{url:t.click_action,id:t.id,cover:t.cover,require_interaction:t.required_interaction,sound:t.sound,action:t.title_action}};t.cover&&(e.image=t.cover),t.title_action&&(e.actions=[{action:"baca-action",title:t.title_action}]),t.required_interaction&&(e.requireInteraction=t.required_interaction),i.showNotification(t.title,e)})});
