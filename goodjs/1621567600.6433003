!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.activeWindow=window,e.topWindow=top},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(5),i=n(0),a=function(){function t(){this.log=null,this.warn=null,this.error=null,this.log=this.logger.bind(this,"log"),this.warn=this.logger.bind(this,"warn"),this.error=this.logger.bind(this,"error")}return t.prototype.getQueryParamByName=function(t){var e,n,o,a,r=i.activeWindow.location.search&&i.activeWindow.location.search.toLowerCase(),d=r&&r.indexOf(t);return-1!==d&&(e=r.indexOf("=",d)+1,n=-1===(o=r.indexOf("&",e))?void 0:o,a=decodeURIComponent(r.slice(e,n))),a},t.prototype.logger=function(t,e){var n="background-color: ",a=i.activeWindow.console&&"function"==typeof i.activeWindow.console.error,r=this.getQueryParamByName("iasdebug"),d=r&&"TRUE"===r.toUpperCase();"log"===t?n+="lightgreen":"error"===t?n+="pink":"warn"===t&&(n+="lightyellow"),a&&d&&(console.log("%cIAS_DEBUG: "+e,n),o.pmLog("DEBUG_adxErrorsLog: IAS_DEBUG: "+e))},t.prototype.isDebugMode=function(){var t=this.getQueryParamByName("iasdebug");return t&&"TRUE"===t.toUpperCase()},t}();e.reporter=new a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),i=n(0),a=n(1);e.start=function(t){try{new o.ADX(t)}catch(t){a.reporter.error(t.message)}},i.activeWindow.__iasADX=window.__iasADX||{},i.activeWindow.__iasADX.start=window.__iasADX.start||e.start,Number(i.activeWindow.__iasADX.anId)&&i.activeWindow.__iasADX.start(i.activeWindow.__iasADX.anId)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=n(4),a=n(1),r=n(6),d=n(7),s=function(){function t(t){var e=this;this.iframesHtmlContents={},this.adxList={},this.setAnId(t),o.topWindow.addEventListener("load",function(){e.onLoadStrongCheck(o.topWindow.googletag.pubads().getSlots())}),o.topWindow.addEventListener("message",function(t){e.setIframesHtmlContents(),o.topWindow.googletag&&o.topWindow.googletag.pubadsReady&&(e.slots=o.topWindow.googletag.pubads().getSlots(),e.updateUnsafeAdSlots(e.slots,e.getIframesHtmlContents()),o.topWindow.googletag.pubads().addEventListener("slotRenderEnded",function(t){t.slot.isBackfill=t.isBackfill,e.matchSlotToHtml(t,e)}))})}return t.prototype.setAnId=function(t){isNaN(Number(t))?a.reporter.error("Invalid an Id passed"):this.anId=Number(t)},t.prototype.getAnId=function(){return this.anId},t.prototype.setIframesHtmlContents=function(){var t=this;o.topWindow.ampInaboxIframes&&o.topWindow.ampInaboxIframes.forEach(function(e){try{(Boolean(e.getAttribute("data-is-safeframe"))||Boolean(e.getAttribute("sandbox")))&&e.name&&t.isIframeContentsValid(e.id,e.name)&&(t.iframesHtmlContents[e.id]=e.name,t.sendIframeSetEvent(e))}catch(t){return!1}})},t.prototype.updateUnsafeAdSlots=function(t,e){var n=JSON.parse(JSON.stringify(e));t.forEach(function(t){var i=["google_ads_iframe_"+t.getSlotId().toString(),"google_ads_iframe"+t.getSlotId().toString()].filter(function(t){return Boolean(o.topWindow.document.getElementById(t))&&!e.hasOwnProperty(t)})[0],r=o.topWindow.document.getElementById(i)||null;if(r&&!Boolean(r.getAttribute("data-is-safeframe")))try{var d=r.contentDocument||r.contentWindow&&r.contentWindow.document;d&&Object.defineProperty(n,i,{value:d.body.textContent,enumerable:!0,writable:!0})}catch(t){a.reporter.warn("Unable to access the unsafe iframe html contents",t)}}),this.iframesHtmlContents=n},t.prototype.sendIframeSetEvent=function(t){var e=document.createEvent("Event");e.initEvent("iframeSet",!0,!0),t.dispatchEvent(e)},t.prototype.isIframeContentsValid=function(t,e){var n=!1;return e.length>2e3&&this.iframesHtmlContents[t]!==e&&(n=!0),n},t.prototype.getIframesHtmlContents=function(){return this.iframesHtmlContents},t.prototype.hasFirewallTag=function(t,e){o.topWindow.document.getElementById(t.getSlotElementId());return/iasScriptUrl/i.test(e)},t.prototype.isAdxAd=function(t,e){if(e)return/https:\/\/pagead2\.googlesyndication\.com\/(pagead|pcs)/.test(t)&&/(securepubads|googleads|adx)\.g\.doubleclick\.net(:\d+)?($|\/)/.test(t);return/(?=https?:\/\/(googleads|adx)\.g\.doubleclick\.net(:\d+)?($|\/)|https?:\/\/(?!adx)ad.*\.doubleclick\.net(:\d+)?($|\/))(((tpc.googlesyndication.com)|(?=.*\bhttps:\/\/pagead2\.googlesyndication\.com\/pagead\/s\/cookie_push(\.html#|_onload\.html#)\b).*$))/im.test(t)},t.prototype.isAmpAdxAd=function(t){var e=/(googleads|adx)\.g\.doubleclick\.net/im.test(t)&&/(<amp-ad|amp4ads|Powered by AMP)/.test(t);return e&&r.adxStats.setStat("ampAdxRegistered",1),e},t.prototype.isPrebidAdx=function(t){return/pagead2\.googlesyndication\.com\/pagead\/gen_204/i.test(t)&&/(googleads|adx)\.g\.doubleclick\.net/i.test(t)},t.prototype.adxGetHtml=function(t,e,n){var o=function(t){return t.length>2e3};return t.iasAdData&&o(t.iasAdData)?{html:t.iasAdData}:t.iasHtml&&o(t.iasHtml)?{html:t.iasHtml}:e&&o(e)?{html:e}:{html:n||""==t.getHtml()?null:t.getHtml(),isGetHtml:!0}},t.prototype.matchSlotToHtml=function(t,e){o.topWindow.pbjs&&o.topWindow.pbjs.onEvent&&o.topWindow.pbjs.getAllWinningBids().concat(o.topWindow.pbjs.getAllPrebidWinningBids()).forEach(function(e){e.adserverTargeting.hb_adid===t.slot.getTargeting("hb_adid")[0]&&(t.slot.iasAdData=e.ad)});function n(){try{var n=e.getIframesHtmlContents(),o=Object.keys(n).find(function(e){return new RegExp(""+t.slot.getSlotId().toString(),"g").test(e)}),i=n[o]?e.adxGetHtml(t.slot,n[o],t.isBackfill):e.adxGetHtml(t.slot,null,t.isBackfill);!i.html||e.hasFirewallTag(t.slot,i.html)||Boolean(t.slot.adxAppendedScript)||(e.isAdxAd(i.html,i.isGetHtml)||e.isAmpAdxAd(i)||t.slot.iasAdData&&e.isPrebidAdx(t.slot.iasAdData))&&(a.reporter.log("IS ADX AD! - "+(o||t.slot.getSlotId().toString())),t.slot.isAdx=!0,e.attachFirewallTag(t.slot,o||"google_ads_iframe_"+t.slot.getSlotId().toString()))}catch(t){a.reporter.warn("Can't match slot to html: "+t)}}-1!==Object.keys(e.iframesHtmlContents).indexOf("google_ads_iframe_"+t.slot.getSlotId().toString())||t.slot.iasAdData?n():o.topWindow.addEventListener("iframeSet",function(){n()})},t.prototype.attachFirewallTag=function(t,e){try{var n=t.getSlotElementId(),r=document.getElementById(n),s=document.getElementById(e)?document.getElementById(e):document.getElementById(n),l=e.replace(/^google_ads_iframe(_|\/|_\/)[0-9]{1,15}/i,"adx"),c=t.getResponseInformation()||{},u=document.createElement("script"),p=(new Date).getTime(),g={width:Number(s.getAttribute("width")),height:Number(s.getAttribute("height"))},m=r.getAttribute("data-google-query-id");if(!g.width||!g.height){var f=s.getBoundingClientRect();g.width=Number(Math.trunc(f.width)),g.height=Number(Math.trunc(f.height))}u.type="text/javascript";var h=document.createTextNode(i.generateTag(this.anId,t.getSlotElementId(),g.width,g.height,c.advertiserId?c.advertiserId:null,l,c.sourceAgnosticLineItemId&&c.lineItemId?c.lineItemId:c.sourceAgnosticLineItemId,c.sourceAgnosticCreativeId&&c.creativeId?c.creativeId:c.sourceAgnosticCreativeId,c.campaignId?c.campaignId:null,p,30));u.setAttribute("id","ias-"+p),o.topWindow.__iasADX.adxList=o.topWindow.__iasADX.adxList||{},(c.creativeId||c.sourceAgnosticCreativeId)&&(u.appendChild(h),d.throttle(this.registerAdxAdToWindowObject.bind(this,m,r,u),100)(),t.adxAppendedScript=!0,t.append=!0),o.topWindow.googletag.pubads().addEventListener("impressionViewable",function(e){t.adxAppendedScript=!1})}catch(t){a.reporter.warn("Can't attach slot to html: "+t)}},t.prototype.registerAdxAdToWindowObject=function(t,e,n){!t||this.adxList.hasOwnProperty(t)&&this.adxList[t]==e||(e.appendChild(n),Object.defineProperty(this.adxList,""+t,{value:e,enumerable:!0,writable:!0}),o.topWindow.__iasADX.adxList=this.adxList,r.adxStats.setStat("adxAdsOnPage",Object.keys(this.adxList).length))},t.prototype.verifyOnloadAdx=function(t,e,n){var o="google_ads_iframe_"+t.getSlotId().toString(),i=this.adxGetHtml(t,this.getIframesHtmlContents()[o],t.isBackfill)||{html:n.innerHTML};t.append||this.hasFirewallTag(t,this.getIframesHtmlContents()[o])||this.hasFirewallTag(t,i.html)||!this.isAdxAd(i.html,i.isGetHtml)&&!this.isAmpAdxAd(i.html)||this.attachFirewallTag(t,o)},t.prototype.onLoadStrongCheck=function(t){var e=this;r.adxStats.setStat("adSlot",t.length);try{t.forEach(function(n){var i=o.topWindow.document.querySelector("div#"+n.getSlotElementId()+" > div");if(i){var a=i.querySelector("iframe");if(a)e.updateUnsafeAdSlots(t,e.getIframesHtmlContents()),e.verifyOnloadAdx(n,a,i);else var r=d.onAppend(i,function(o){o?(a=i.querySelector("iframe"))&&(e.updateUnsafeAdSlots(t,e.getIframesHtmlContents()),e.verifyOnloadAdx(n,a,i),r.disconnect()):setTimeout(function(){r.disconnect()},2e3)})}}),this.onLoadStrongCheck=void 0}catch(t){a.reporter.warn("On load strong check failed",t)}},t}();e.ADX=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1);e.generateTag=function(t,e,n,i,a,r,d,s,l,c,u){var p="//"+(o.reporter.getQueryParamByName("fwserver")||"pixel.adsafeprotected.com")+"/jload?anId="+t+"&campId="+n+"x"+i+"&pubId="+a+"&chanId="+r+"&placementId="+d+"&pubCreative="+s+"&pubOrder="+l+"&cb="+c;return"(function() {\n      var iasScriptUrl, hiddenFrame, hiddenDoc, where, domain;\n      iasScriptUrl = '"+p+"';\n      hiddenFrame = document.createElement('iframe');\n      (hiddenFrame.frameElement || hiddenFrame).style.cssText = \"width: 0; height: 0; border: 0; display: none;\";\n      hiddenFrame.src = 'javascript:false';\n      where = document.getElementById('"+e+'\');\n      where.parentNode.insertBefore(hiddenFrame, where);\n      try {\n          hiddenDoc = hiddenFrame.contentDocument || (hiddenFrame.contentWindow && hiddenFrame.contentWindow.document);\n      } catch (e) {\n          domain = document.domain;\n          hiddenFrame.src = "javascript:var d=document.open();d.domain=\'" + domain + "\';void(0);";\n          hiddenDoc = hiddenFrame.contentDocument || (hiddenFrame.contentWindow && hiddenFrame.contentWindow.document);\n      }\n      if (hiddenDoc) {\n          hiddenDoc.open().write("'+('<body onload=\\"window.__IntegralASUseFIF = true; window.__IntegralASAdRefreshThreshold = '+u+"; var js = document.createElement('script'); js.src = '"+p+"'; document.body.appendChild(js);\\\"></body>")+'");\n          hiddenDoc.close();\n      }\n  })();'}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0);e.pmLog=o.activeWindow.postMessage?function(t){o.topWindow.postMessage(t,"*")}:function(){}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=n(1),a=function(){function t(){this.stats={adxAdsOnPage:0,adSlots:0,noIasNotAdx:0,ampAdxRegistered:0,adxSlotsIndices:[],ampInaBoxLoaded:!1,ampInaBoxLength:0},i.reporter.isDebugMode()&&(o.topWindow.__iasADX=o.topWindow.__iasADX||{},o.topWindow.__iasADX.isDebugMode=!0,o.topWindow.__iasADX.showStats=this.showStats)}return t.prototype.setStat=function(t,e){},t.prototype.getStat=function(t){return this.stats[t]},t.prototype.getStats=function(){return this.stats},t.prototype.showStats=function(){i.reporter.log(this.getStats())},t}();e.adxStats=new a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.throttle=function(t,e){var n;return function(){var o=arguments,i=this;n||(n=!0,t.apply(i,o),setTimeout(function(){return n=!1},e))}},e.onAppend=function(t,e){var n=new MutationObserver(function(t){t.forEach(function(t){t.addedNodes.length&&e(t.addedNodes)})});return n.observe(t,{childList:!0}),n}}]);
//# sourceMappingURL=iasADX.1.0.21.js.map