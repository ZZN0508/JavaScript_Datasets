YUI.add("hermes-template-photo-list-photo",function(i,e){var o=i.Template.Handlebars.revive({1:function(e,t,i,o,n){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(e=e.invokePartial(r(o,"photo-card-overlay-icon"),t,{name:"photo-card-overlay-icon",hash:{type:"video"},data:n,indent:"\t",helpers:i,partials:o,decorators:e.decorators}))?e:""},3:function(e,t,i,o,n){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(n=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"showInteractionBarPlaceholder"):t,{name:"if",hash:{},fn:e.program(4,n,0),inverse:e.noop,data:n,loc:{start:{line:6,column:1},end:{line:8,column:8}}}))?n:"")+'\t<div class="interaction-view"></div>\n'},4:function(e,t,i,o,n){return'\t\t<div class="interaction-view-placeholder"></div>\n'},6:function(e,t,i,o,n){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t<a class="click-target" href="'+e.escapeExpression("function"==typeof(r=null!=(r=r(i,"photoPageUrl")||(null!=t?r(t,"photoPageUrl"):t))?r:e.hooks.helperMissing)?r.call(null!=t?t:e.nullContext||{},{name:"photoPageUrl",hash:{},data:n,loc:{start:{line:11,column:31},end:{line:11,column:47}}}):r)+'" tabindex="0" role="heading" aria-level="3"></a>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){var r,a=null!=t?t:e.nullContext||{},s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(r=s(i,"if").call(a,null!=t?s(t,"isVideo"):t,{name:"if",hash:{},fn:e.program(1,n,0),inverse:e.noop,data:n,loc:{start:{line:1,column:0},end:{line:3,column:7}}}))?r:"")+"\n"+(null!=(r=s(i,"if").call(a,null!=t?s(t,"hasInteraction"):t,{name:"if",hash:{},fn:e.program(3,n,0),inverse:e.program(6,n,0),data:n,loc:{start:{line:5,column:0},end:{line:12,column:7}}}))?r:"")},usePartial:!0,useData:!0}),n={};i.Array.each(["photo-card-overlay-icon"],function(e){var t=i.Template.get("hermes/"+e);t&&(n[e]=t)}),i.Template.register("hermes/photo-list-photo",function(e,t){return(t=t||{}).partials=t.partials?i.merge(n,t.partials):n,o(e,t)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-photo-card-overlay-icon"]}),YUI.add("photo-list-photo-view",function(r){var i=require("hermes-core/type-validator");r.namespace("Views")[this.name]=r.Base.create(this.name,r.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.set("isZombie",!YUI.Env.isServer&&e.requiredToShowOnServer&&this.get("layoutItem")&&!this.get("layoutItem").isAwake),this.onlyShowCurateForOwner=e.onlyShowCurateForOwner,this},loadState:function(){var e=r.URLHelper.getPhotoPage({photoId:this.get("model").getValue("id"),pathAlias:this.get("model").getValue("owner").getValue("pathAlias"),contextSuffix:this.get("contextSuffix")});return this.set("photoPageUrl",e),r.Promise.resolve()},buildContainer:function(){var e,t,i=this.get("container"),o=this.get("layoutItem");return o.isAwake?(this.updateGeometry(),this.setContainerHTML(this.render()),YUI.Env.isServer?(i.setStyles({"background-image":"url("+this.get("photoUrl")+")"}),i.addClass("awake"),this.get("model").getValue("needsInterstitial")&&i.addClass("restricted-image")):(this.get("showLowResImageFirst")&&i.setStyles({backgroundImage:"url("+this.get("model").getValue("sizes").sq.url+")"}).addClass("low-res"),this.downloadCacheAndSetImage())):YUI.Env.isServer?this.set("isZombie",!0):YUI.Env.isServer&&!this.get("isZombie")||(e="",t=r.Node.create(this.get("placeHolderHTML")).set("innerHTML",this.render()),this.get("model").getValue("needsInterstitial")&&(e=" restricted-image"),t.setAttrs({id:i.getAttribute("id"),className:i.getAttribute("class")+e}),this.updateNodeGeometry(o,t),this.serialize(t),this.set("isReallySleeping",!0),this.set("isZombie",!1),this.downloadCacheAndSetImage()),this.get("model").getValue("isVideo")&&this.get("container").addClass("is-video"),this.get("showInteractionBarPlaceholder")&&(1<this.get("model").getValue("aspectRatio")?i.addClass("landscape"):i.addClass("portrait")),this},activate:function(){var e;return this.renderInteractionView().then(function(e){this.fire("activated")}.bind(this)),this.get("showLowResImageFirst")&&((e=this.get("parentContainer").getDOMNode()).addEventListener("transitionend",this.removeTransition),e.addEventListener("webkitTransitionEnd",this.removeTransition)),this.registerEventHandler(this.get("interactionContainer").delegate(["blur","focus"],this.toggleKeyboardFocusStyling.bind(this),"a, .engagement-item")),this},toggleKeyboardFocusStyling:function(e){var t=e.target.ancestor(".interaction-view");t&&t.toggleClass("has-keyboard-focus","focus"===e.type)},setHoverVisible:function(e){var t=this.get("interactionContainer");t&&(e?t.addClass("manual-hover"):t.removeClass("manual-hover"))},render:function(){return this.templates("photo-list-photo")({photoPageUrl:this.get("photoPageUrl"),hasInteraction:!!this.get("interactionViewName")&&!this.appContext.forceServerRender,showInteractionBarPlaceholder:this.get("showInteractionBarPlaceholder"),isVideo:this.get("model").getValue("isVideo")})},removeTransition:function(e){e&&e.target&&e.target.classList&&e.target.classList.contains("photo-list-photo-view")&&e.target.classList.remove("low-res")},downloadCacheAndSetImage:function(){r.fluid.loadImage(this.get("photoUrl"),{timeout:1e3,retry:!0}).then(function(e){this.handleImageLoad(!0,e)}.bind(this),function(e){this.handleImageLoad(!1,e+"?retry="+Date.now())}.bind(this))},handleImageLoad:function(i,e){var t,o=this,n=this.get("isReallySleeping");(t=n?this.deserialize():this.get("container")).setStyle("backgroundImage","url("+e+")"),i||t.setStyle("backgroundColor","#eee"),this.get("model").getValue("needsInterstitial")&&t.addClass("restricted-image"),n?this.serialize(t):r.fluid.chill(function(){var e,t=this.get("container");n||(t.addClass("awake"),setTimeout(function(){(e=o.get("interactionView"))&&e.updateBreakpoints&&e.updateBreakpoints()},0),this.fire(i?"loaded":"loadError"))},this)},updateGeometry:function(e){var t,i=this.get("isReallySleeping");e?this.set("layoutItem",e):e=this.get("layoutItem"),t=i?this.deserialize():this.get("container"),this.updateNodeGeometry(e,t),i&&this.serialize(t)},updateNodeGeometry:function(e,t){YUI.Env.isServer?t.setStyles({transform:"translate("+e.geometry.left+"px, "+e.geometry.top+"px)","-webkit-transform":"translate("+e.geometry.left+"px, "+e.geometry.top+"px)","-ms-transform":"translate("+e.geometry.left+"px, "+e.geometry.top+"px)"}):r.fluid.setStylePrefixed("transform","translate("+e.geometry.left+"px, "+e.geometry.top+"px)",t),t.setStyles({width:e.geometry.width+"px",height:e.geometry.height+"px"})},sleep:function(){var e,t;this.get("isReallySleeping")||(YUI.Env.isServer?this.set("isZombie",!0):(this.get("id"),this.destroyInteractionView(),(t=this.get("container")).removeClass("awake"),this.serialize(t),e=r.Node.create(this.get("placeHolderHTML")),this.get("parentContainer").replaceChild(e,t),this.set("container",e),this.set("isReallySleeping",!0),this.set("isZombie",!1)))},wake:function(){var e,t,i,o=this;this.get("isReallySleeping")&&(this.get("id"),e=this.get("container"),t=this.get("parentContainer"),i=this.deserialize(),t.replaceChild(i,e),this.set("container",i),this.set("isReallySleeping",!1),this.renderInteractionView(),r.fluid.chill(function(){var e;this.get("container").addClass("awake"),setTimeout(function(){(e=o.get("interactionView"))&&e.updateBreakpoints&&e.updateBreakpoints()},0)},this))},isAwake:function(){return!this.get("isReallySleeping")},serialize:function(e){if(YUI.Env.isServer)throw new Error("Impossible to `serialize` on the server (uses sessionStorage). Maybe you meant to call `sleep`?");e&&r.Storage.Instance.set(this.get("storageId"),e.getDOMNode().outerHTML)},deserialize:function(){if(YUI.Env.isServer)throw new Error("Impossible to `deserialize` on the server (uses sessionStorage). Maybe you meant to call `wake`?");var e,t=r.Storage.Instance.get(this.get("storageId"));return t&&(e=r.Node.create(t),this.dematerialize()),e},dematerialize:function(){if(YUI.Env.isServer)throw new Error("Impossible to `dematerialize` on the server (uses sessionStorage).");r.Storage.Instance.remove(this.get("storageId"))},renderInteractionView:function(){var e,t=this,i=this.get("interactionViewName"),o=this.get("interactionView");return i&&!o?(e=this.onlyShowCurateForOwner?this.get("model").getValue("isOwner"):void 0,this.appContext.getView(i,r.merge(this._params,{id:this.get("id"),container:this.get("interactionContainer"),model:this.get("model"),listModelParams:this.get("listModelParams"),photoPageUrl:this.get("photoPageUrl"),isActiveViewAgnostic:this.get("isActiveViewAgnostic"),engagementModelName:this.get("engagementModelName"),layoutWidth:this.get("layoutItem").geometry.width,showCurate:e})).then(function(e){return this.set("interactionView",e),this.registerEventHandler(this.get("interactionView").on("hoverActionOpened",this.setHoverVisible.bind(this,!0))),this.registerEventHandler(this.get("interactionView").on("hoverActionClosed",this.setHoverVisible.bind(this,!1))),e.initialize()}.bind(this)).then(function(e){return setTimeout(function(){t.isAwake()&&e&&e.updateBreakpoints&&e.updateBreakpoints()},0),e})):o?(o.get("container").inDoc()||((e=o.get("container")).addClass("interaction-view"),this.get("interactionContainer")||this.buildContainer(),this.get("container").replaceChild(e,this.get("interactionContainer")),o.normalizedActivate(),setTimeout(function(){o&&o.updateBreakpoints&&o.updateBreakpoints()},0)),r.Promise.resolve(o)):r.Promise.resolve(null)},destroyInteractionView:function(){var e=this.get("interactionView");e&&(e.destroy(),this.set("interactionView",null))},destructor:function(){this.dematerialize()}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(e,t){return i.photoId(e)}},parentSignature:{writeOnce:"initOnly"},storageId:{readOnly:!0,derivedBy:["id","parentSignature"],getter:function(){return this.get("parentSignature")+"-"+this.get("id")}},layoutItem:{validator:function(e,t){return"object"==typeof e&&e.hasOwnProperty("aspectRatio")&&e.hasOwnProperty("geometry")&&"object"==typeof e.geometry&&e.geometry.hasOwnProperty("width")&&e.geometry.hasOwnProperty("height")&&e.geometry.hasOwnProperty("top")&&e.geometry.hasOwnProperty("left")&&e.hasOwnProperty("isAwake")}},photoUrl:{value:"/images/spaceball.gif",getter:function(e,t){var i=this.get("model"),o=this.get("layoutItem"),n={},o=this.get("showInteractionBarPlaceholder")?(1<i.getValue("aspectRatio")?n.height=o.geometry.height-(this.get("interactionBarHeight")||0):n.width=o.geometry.width,i.getSizeToFit(n,{includeSquare:1===o.aspectRatio})):i.getSizeToFit({width:o.geometry.width,height:o.geometry.height},{includeSquare:1===o.aspectRatio});return o.url}},photoPageUrl:{writeOnce:!0,validator:function(e,t){return r.AttributeHelpers.validateString(e)}},model:{value:null},listModelParams:{value:null},parentContainer:{writeOnce:"initOnly"},contextSuffix:{writeOnce:"initOnly",value:null,validator:function(e,t){return r.AttributeHelpers.validateString(e)}},measureAFT:{value:!1,validator:function(e,t){return r.AttributeHelpers.validateBoolean(e)}},isReallySleeping:{value:!1,validator:function(e,t){return r.AttributeHelpers.validateBoolean(e)}},isZombie:{value:!1,validator:function(e,t){return r.AttributeHelpers.validateBoolean(e)}},placeHolderHTML:{value:'<div class="youcansleepwhenyouredead" />',validator:function(e,t){return r.AttributeHelpers.validateString(e)}},showLowResImageFirst:{value:!1,validator:function(e,t){return r.AttributeHelpers.validateBoolean(e)}},interactionViewName:{writeOnce:"initOnly",value:null,validator:function(e,t){return r.AttributeHelpers.validateString(e)}},showInteractionBarPlaceholder:{writeOnce:"initOnly",value:!1,validator:function(e,t){return r.AttributeHelpers.validateBoolean(e)}},interactionBarHeight:{writeOnce:"initOnly",value:null,validator:function(e,t){return r.AttributeHelpers.validateInteger(e)}},engagementModelName:{writeOnce:"initOnly",value:null,validator:function(e,t){return r.AttributeHelpers.validateString(e)}},interactionView:{value:null},interactionContainer:{value:null,getter:function(e,t){return e=!e&&!YUI.Env.isServer?this.get("container").one(".interaction-view"):e}}}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-list-photo","url-helper","attribute-helpers"],optionalRequires:["fluid","storage-helper"],langBundles:["common"]}),YUI.add("photo-list-view",function(c,e){"use strict";var h=require("hermes-core/flog")(e),o={containerWidth:"fullWidth",subtractScrollbarWidth:!1,pageParams:{page:1,perPage:50},parentName:"",subviewMapping:{"photo-models":{name:"photo-list-photo-view",params:null},"photo-lite-models":{name:"photo-list-photo-view",params:null},"set-models":{name:"photo-list-album-view",params:null}},paginateOnScroll:!0,keepAwakeOnScroll:!1,parentContainer:c.config.win,loadMoreMargin:3,relayoutOnResize:!0,recenterOnResize:!1,responsiveRowHeight:!1,maintainScrollPosition:!0,interactionViewName:"photo-list-photo-interaction-view",engagementModelName:"photo-engagement-models",itemFilterFunction:null,injectPhotolistContextParams:null,beaconViews:!0,scrollInterruptParams:null,scrollToWithId:!1,handleCollectionChanged:!1},a={480:.5,800:.75,1280:1,1600:1.25},s=Object.keys(a);c.FlickrView.create(this.name,c.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){var t,i=c.merge(o,e.photoListConfig);if(void 0===i)throw new Error("photo-list-view must be initialized with config params wrapped in a `photoListConfig` object.");if(i.initialItems)this.initialItems=i.initialItems.concat(),i.paginateOnScroll=!1;else{if(void 0===i.modelParams)throw new Error("photo-list-view must be initialized with `modelParams`.");if(void 0===i.modelParams.registryName)throw new Error("photo-list-view must be initialized with `modelParams.registryName`.");if(void 0===i.modelParams.modelIdOrAttributes)throw new Error("photo-list-view must be initialized with `modelParams.modelIdOrAttributes`.");if(void 0===i.modelParams.collectionAttributeName)throw new Error("photo-list-view must be initialized with `modelParams.collectionAttributeName`.")}if(void 0===i.parentName)throw new Error("photo-list-view must be initialized with the `parentName` (the name of the module containing the photolist).");return this.parentName=i.parentName,this.modelParams=i.modelParams,this.pageParams=i.pageParams,this.subviewMapping=i.subviewMapping,this.loadMoreMargin=i.loadMoreMargin,this.relayoutOnResize=i.relayoutOnResize,this.recenterOnResize=i.recenterOnResize,this.responsiveRowHeight=i.responsiveRowHeight,this.contextSuffix=i.contextSuffix,this.initializeWithFirstPage=i.initializeWithFirstPage,!YUI.Env.isServer&&i.beaconViews&&(this.viewBeaconer={beaconer:this.appContext.getViewCounter(),beaconAttribute:i.viewBeaconAttribute||"id",beaconRestrictedAttribute:i.viewBeaconRestrictedAttribute||"needsInterstitial",beaconAlwaysBeacon:i.viewBeaconAlwaysBeacon||!1,beaconIsOwnerAttribute:i.viewBeaconIsOwnerAttribute||"isOwner"}),i.subtractScrollbarWidth?YUI.Env.isServer?this.scrollbarWidth=this.appContext.viewportData.scrollbarWidth:this.scrollbarWidth=c.OverflowHelper.detectScrollbarSize(c.one("body")):this.scrollbarWidth=0,i.layout?(i.layout instanceof c.PhotoListLayout?(h.warn("Passing a PhotoListLayout instance into PhotoListView is deprecated. Instead, send the layout config object, and PhotoListView will create the PhotoListLayout for you."),this.photoListLayout=i.layout):(this.isMobile&&i.mobileLayout&&(0===Object.keys(i.mobileLayout).length&&(i.mobileLayout={targetRowHeight:200,containerPadding:{right:16,left:16},itemSpacing:{horizontal:16,vertical:16}}),i.layout.targetRowHeight=i.mobileLayout.targetRowHeight||i.layout.targetRowHeight,i.layout.containerPadding=c.merge(i.layout.containerPadding||{},i.mobileLayout.containerPadding||{}),i.layout.itemSpacing=c.merge(i.layout.itemSpacing||{},i.mobileLayout.itemSpacing||{})),this.photoListLayout=new c.PhotoListLayout(c.merge(i.layout,{appContext:this.appContext}))),delete i.layout.appContext):this.photoListLayout=new c.PhotoListLayout({appContext:this.appContext}),this.photoListLayout.containerWidth||(YUI.Env.isServer||(t=this.appContext.flapp.get("activeView")),this.appContext.hasClientSideRouted()&&t&&t.name===this.parentName?this.photoListLayout.containerWidth=this.calculateContainerWidth("previousContainerWidth"):(this.explicitContainerWidth=i.containerWidth,this.photoListLayout.containerWidth=this.calculateContainerWidth(this.explicitContainerWidth))),this.baseRowHeight=this.photoListLayout.targetRowHeight,this.responsiveRowHeight&&this.adjustRowHeightToContainerWidth(),this.paginateOnScroll=i.paginateOnScroll,this.paginateOnScroll&&this.photoListLayout.layout&&this.photoListLayout.hasLimitedNumberOfRows()&&h.warn("When photo-list-layout::maxNumRows is specified, photo-list::paginateOnScroll should probably be set to `false`."),this.parentContainer=i.parentContainer,this.keepAwakeOnScroll=i.keepAwakeOnScroll,this.keepAwakeOnScroll&&(this.photoListLayout.sleepTopAndBottom=!1),this.loadingMoreBottom=!1,this.loadingMoreTop=!1,this.lastItemCached=!1,this.firstItemCached=!1,this.itemsMappedToAspectRatios=[],this.lowestPageInView=this.pageParams.page,this.highestPageInView=this.pageParams.page,this.pageParams.viewPageSize&&(this.lastPageInView=this.pageParams.page+Math.ceil(this.pageParams.viewPageSize/this.pageParams.perPage)-1,isNaN(this.lastPageInView)&&h.warn("Error calculating `this.lastPageInView`. Verify values passed for `config.pageParams`.")),this.modelsById={},this.subviewsById={},this.fetchedOnlyInitPage=!1,this.perPageDoubles=0,this.interactionViewName=i.interactionViewName,this.showInteractionBarPlaceholder=i.showInteractionBarPlaceholder||!1,this.interactionBarHeight=i.interactionBarHeight,this.engagementModelName=i.engagementModelName,this.maintainScrollPosition=i.maintainScrollPosition,this.scrollToWithId=i.scrollToWithId,this.handleCollectionChanged=i.handleCollectionChanged,this.itemFilterFunction=i.itemFilterFunction,i.injectPhotolistContextParams&&(this.injectPhotolistContextParams=c.merge(i.injectPhotolistContextParams)),""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),i.scrollInterruptParams&&(this.scrollInterruptParams=i.scrollInterruptParams,this.scrollInterruptState={nextInterrupt:this.scrollInterruptParams.pageCounts[0],numPagesLoaded:0,numInterrupts:0,isInterrupted:!1,footer:null,footerHeight:0}),this.isHidden=i.isHidden,delete e.photoListConfig,this.params=e,this},loadState:function(){var n,r,a=this;return this.initialItems?this.setItems(this.initialItems).then(this.loadStateSubviewsReady.bind(this),function(e){h.error("Error displaying initial items",{err:e})}):(n=c.merge(this.modelParams.fetchParams,this.pageParams),this.paginateOnScroll&&!this.scrollToWithId&&(n.page=2*(this.pageParams.page-1)+1,n.perPage=Math.floor(.5*this.pageParams.perPage),this.fetchedOnlyInitPage=!0),this.appContext.getModel(this.modelParams.registryName,this.modelParams.modelIdOrAttributes,n).then(function(e){var t=e.getValue(a.modelParams.collectionAttributeName),i=t.getList();if(a.set("collectionModel",e),a.lastPageInView)return(r=Math.min(t.getNextIncompletePage(a.pageParams),a.lastPageInView+1))<=a.pageParams.page?t.getPage(n):(o=t.getList().slice((a.pageParams.page-1)*a.pageParams.perPage,(r-1)*a.pageParams.perPage),c.Promise.resolve(o));var o=(n.page||1)*(n.perPage||0);return i.length&&(t.fetchedEnd||i.length>=o)&&!a.initializeWithFirstPage?c.Promise.resolve(i):t.getPage(n)},function(e){h.error("error fetching model",{err:e})}).then(function(e){var t=a.get("collectionModel").getValue(a.modelParams.collectionAttributeName),i=t.getList(),o=t.getFirstItem(),n=t.getLastItem();return e&&e.length?(a.lastPageInView?(a.lowestPageInView=a.pageParams.page,r===a.lastPageInView?a.highestPageInView=r-(Math.floor(a.pageParams.viewPageSize/a.pageParams.perPage)-1):a.highestPageInView=Math.max(a.lowestPageInView,r)):a.initializeWithFirstPage?(a.lowestPageInView=1,a.highestPageInView=1):(a.lowestPageInView=Math.floor(o.index/a.pageParams.perPage)+1,a.highestPageInView=Math.floor(n.index/a.pageParams.perPage)+1),!YUI.Env.isServer&&a.scrollInterruptState&&a.updateScrollInterruptState(a.highestPageInView-1),(t.fetchedEnd&&e.length&&i.length&&e[e.length-1]&&i[i.length-1]&&e[e.length-1].id===i[i.length-1].id||a.highestPageInView>=a.lastPageInView)&&(a.lastItemCached=!0),a.itemFilterFunction&&"function"==typeof a.itemFilterFunction&&(e=e.filter(a.itemFilterFunction)),a.layOutItems(e,"bottom")):c.Promise.resolve(null)},function(e){h.error("Calculate layout and generate subviews",{err:e})}).then(this.loadStateSubviewsReady.bind(this),function(e){h.warn("Error loading items from registry",{err:e,registry:a.modelParams.registryName,modelIdOrAttributes:a.modelParams.modelIdOrAttributes})}))},loadStateSubviewsReady:function(e){this.photoListLayout.getAwakeItems().length,YUI.Env.isServer||this.get("container").hasClass("requiredToShowOnServer")&&this.photoListLayout.containerWidth!==this.retrieveContainerWidth()&&(this._relayoutQueued=!0)},buildContainer:function(){return this.setContainerHTML(""),this.get("container").setStyle("height",this.containerHeight+"px"),this.initialLayoutResponse&&(this.renderSubviews(null,this.initialLayoutResponse),delete this.initialLayoutResponse),this},activate:function(){var e;return this._relayoutQueued&&(this._relayoutQueued=!1,this.initialLayoutResponse?(this.buildContainer(),this.storeContainerWidth(this.photoListLayout.containerWidth)):this.handleResize(null)),!this.paginateOnScroll&&this.keepAwakeOnScroll||(this.handleScroll(),this.parentContainer!==c.config.win&&this.parentContainer instanceof c.Node?this.registerEventHandler(this.parentContainer.on("scroll",this.handleScroll.bind(this))):this.registerEventHandler(c.globalEvents.subscribe("window:scroll",this.handleScroll.bind(this)))),this.relayoutOnResize&&this.registerEventHandler(c.globalEvents.subscribe("window:resize",this.handleResize.bind(this))),!YUI.Env.isServer&&this.maintainScrollPosition?this.photoListLayout.hasLimitedNumberOfRows()||(!(e=this.appContext.getReferrer())||e&&e!==this.appContext.flapp.getPath())&&this.restoreScrollPosition():!YUI.Env.isServer&&this.scrollToWithId&&this.scrollToId(this.scrollToWithId),this.injectPhotolistContextParams&&this.registerEventHandler(this.get("container").delegate("click",this.injectPhotolistContext.bind(this),"a")),this.registerEventHandler(this.get("container").delegate("click",this.subviewExtraToolClicked.bind(this),".extra-tool")),this.registerEventHandler(this.get("container").delegate("key",this.subviewExtraToolClicked.bind(this),"down:13",".extra-tool")),Object.keys(this.subviewMapping).some(function(e){return this.subviewMapping[e]&&"photo-list-tile-view"===this.subviewMapping[e].name}.bind(this))&&this.registerEventHandler(this.get("container").delegate("mouseenter",this.subviewLicenseMouseenter.bind(this),".license")),this.handleCollectionChanged&&this.registerEventHandler(this.get("collectionModel").on("valuesChanged",this.onCollectionModelValuesChanged.bind(this))),this.isHidden&&this.hide(),this.activateSubviews(),this},setItems:function(e,t){var i,o=this;return this.containerHeight=0,this.itemsMappedToAspectRatios=[],this.modelsById={},this.subviewsById={},this.get("collectionModel")&&((i=this.get("collectionModel").getValue(this.modelParams.collectionAttributeName)).fetchedStart?this.firstItemCached=!0:this.firstItemCached=!1,i.fetchedEnd&&!t?this.lastItemCached=!0:this.lastItemCached=!1),this.get("container").setHTML(""),this.photoListLayout.clear(),this.get("showThrobberDuringLoad")&&this.toggleThrobber(!0),this.layOutItems(e,"bottom").then(function(e){o.get("showThrobberDuringLoad")&&o.toggleThrobber(!1)})},getContainingElementData:function(){var e=this.get("container"),t={height:0,scrollLeft:0,scrollTop:0};return t=this.parentContainer!==c.config.win&&this.parentContainer instanceof c.Node?{height:this.parentContainer.get("offsetHeight"),scrollLeft:this.parentContainer.getDOMNode().scrollLeft,scrollTop:this.parentContainer.getDOMNode().scrollTop}:{height:this.appContext.viewportData.getHeight(),scrollLeft:YUI.Env.isServer?0:c.config.win.pageXOffset,scrollTop:YUI.Env.isServer?0:c.config.win.pageYOffset},e&&(t.scrollLeft-=e.get("offsetLeft"),t.scrollTop-=e.get("offsetTop")),t},setContainerScrollTop:function(e){this.parentContainer!==c.config.win&&this.parentContainer instanceof c.Node?this.parentContainer.getDOMNode().scrollTop=e:c.config.win.scrollTo(0,e)},setTargetRowHeight:function(e){return this.photoListLayout.updateTargetRowHeight(e),this.handleResize(null,!0)},getSubview:function(e){return this.subviewsById[e]},handleScroll:function(e){var t,i=this,o=this.get("container"),n=o.get("clientHeight"),r=this.getContainingElementData(),a=r.height,s=r.scrollTop,l=!0;if(!this.isHidden){for(var h in o=o.get("offsetParent").get("offsetTop")-o.get("offsetTop")+n,n=s+a,this.subviewsById){l=!1;break}l||(!this.paginateOnScroll||this.scrollInterruptState&&this.scrollInterruptState.isInterrupted||((!this.lastPageInView||this.highestPageInView<this.lastPageInView)&&o-n<this.loadMoreMargin*a&&this.loadMore("bottom"),!this.lastPageInView&&s<this.loadMoreMargin*a&&1<this.lowestPageInView&&this.loadMore("top")),this.keepAwakeOnScroll||(t=this.photoListLayout.computeWakeSleep(r.scrollTop,r.scrollLeft),this.wakeOrSleepSubviews(t.wakeSleepChangedItems),!YUI.Env.isServer&&this.viewBeaconer&&t.inViewportChangedItems&&this.processInViewportItems(t.inViewportChangedItems)),void 0!==e&&(this.afterScrollTimeoutId&&c.config.win.clearTimeout(this.afterScrollTimeoutId),this.afterScrollTimeoutId=c.config.win.setTimeout(function(){i.paginateOnScroll&&i.storeScrollPosition(),i.paginateOnScroll&&!i.keepAwakeOnScroll&&i.validateWakeSleep(t),delete i.afterScrollTimeoutId},250)))}},handleResize:function(e,t){this.responsiveRowHeight&&this.adjustRowHeightToContainerWidth();var i=this.calculateContainerWidth(),o=this.get("container"),n=this.getContainingElementData(),r={diffType:"relayout",firstPage:this.firstItemCached,lastPage:this.lastItemCached};if(t||i-this.scrollbarWidth!==this.photoListLayout.containerWidth)return this.storeContainerWidth(i),this.photoListLayout.containerWidth=i-this.scrollbarWidth,r=this.photoListLayout.computeLayout(null,n.scrollTop,n.scrollLeft,r),this.containerHeight=r.containerHeight,this.scrollInterruptState&&this.scrollInterruptState.isInterrupted&&this.scrollInterruptState.loadMoreElement&&this.scrollInterruptState.loadMoreElement.setStyle("width",this.photoListLayout.containerWidth+"px"),o.setStyle("height",r.containerHeight+"px"),o=this.updateSubviews(r,"bottom"),this.recenterOnResize&&this.scrollToCenterItem(r.allLayoutItems),o},loadMore:function(t){"search-photos-lite-models"===this.modelParams.registryName&&this.modelParams.fetchParams&&this.modelParams.fetchParams.apiParams&&void 0!==this.modelParams.fetchParams.apiParams.page&&delete this.modelParams.fetchParams.apiParams.page;var i,o=this,n=this.get("collectionModel").getValue(this.modelParams.collectionAttributeName),r=(n.getList(),c.merge(this.modelParams.fetchParams,this.pageParams));"bottom"!==t||this.loadingMoreBottom?"top"!==t||this.loadingMoreTop||(r.page=this.lowestPageInView-1,1<o.lowestPageInView&&(this.loadingMoreTop=!0,n.getPage(r).then(function(e){n.fetchedStart&&e[0].id===n.getList()[0].id&&(o.firstItemCached=!0),o.lowestPageInView=o.lowestPageInView-1,o.layOutItems(e,t).then(function(e){o.loadingMoreTop=!1,o.paginateOnScroll&&(r.page<=0?h.warn("loadMore fetching beyond start of collection; aborting",{params:r}):o.handleScroll())})},function(e){h.error("loadMore page fetch failed",{err:e}),o.toggleThrobber(!1)}))):(this.fetchedOnlyInitPage?(r.page=2*(this.pageParams.page-1)+2,r.perPage=Math.floor(.5*this.pageParams.perPage)):r.page=this.highestPageInView+1,n.fetchedEnd&&this.lastItemCached||(this.loadingMoreBottom=!0,this.scrollInterruptParams&&this.scrollInterruptParams.footerToHideWhileScrolling&&!this.scrollInterruptState.footer&&(this.scrollInterruptState.footer=c.one(this.scrollInterruptParams.footerToHideWhileScrolling),this.scrollInterruptState.footer&&(this.scrollInterruptState.footerHeight=this.scrollInterruptState.footer.get("clientHeight"),this.setFooterDisplay(!1))),this.get("showThrobberDuringLoad")&&this.toggleThrobber(!0),n.getPage(r).then(function(e){i=n.getList(),n.fetchedEnd&&e[e.length-1].id===i[i.length-1].id&&(o.lastItemCached=!0),o.fetchedOnlyInitPage?o.fetchedOnlyInitPage=!1:(r.perPageDoubling&&o.perPageDoubles<r.perPageDoubling&&(o.perPageDoubles++,o.pageParams.perPage*=2,o.highestPageInView=Math.floor(.5*o.highestPageInView),o.lastPageInView=Math.floor(.5*o.lastPageInView)),o.highestPageInView=o.highestPageInView+1),o.highestPageInView>=o.lastPageInView&&(o.lastItemCached=!0),o.itemFilterFunction&&"function"==typeof o.itemFilterFunction&&(e=e.filter(o.itemFilterFunction)),o.layOutItems(e,t).then(function(e){o.loadingMoreBottom=!1,o.paginateOnScroll&&(n.totalItems&&(r.page-1)*r.perPage>n.totalItems?h.warn("loadMore fetching beyond end of collection; aborting",{params:r,total:n.totalItems}):o.handleScroll())}),o.scrollInterruptState&&(o.lastItemCached?o.setFooterDisplay(!0):(o.scrollInterruptState.numPagesLoaded++,o.checkScrollInterruptionState())),o.get("showThrobberDuringLoad")&&o.toggleThrobber(!1)},function(e){h.error("loadMore page fetch failed",{err:e}),o.toggleThrobber(!1)})))},layOutItems:function(e,t,i){if(!e||!e.length)return c.Promise.resolve();var o,n=this.containerHeight,r={},a=this.get("container"),s=this.getContainingElementData();if(e=this.cacheModelsById(e),e=this.itemsToAspectRatios(e),"bottom"===t)this.itemsMappedToAspectRatios=this.itemsMappedToAspectRatios.concat(e),o=e,r.diffType="append",this.lastItemCached&&(r.lastPage=!0);else{if("top"!==t)return void h.warn("Unsupported `layOutItems` direction",{direction:t});this.itemsMappedToAspectRatios=e.concat(this.itemsMappedToAspectRatios),o=e,r.diffType="prepend",this.firstItemCached&&(r.firstPage=!0)}return i&&(r.diffType="relayout",r.diffDirection=t),r=this.photoListLayout.computeLayout(o,s.scrollTop,s.scrollLeft,r),a.setStyle("height",r.containerHeight+"px"),this.containerHeight=r.containerHeight,"top"===t&&this.setContainerScrollTop(this.containerHeight-n),this.updateSubviews(r,t)},updateSubviews:function(t,i){var o,n=this;return this.instantiateSubviews(t.newItems).then(function(e){return e=e.filter(function(e){return!!e}),n.updateSubviewGeometry(t.layoutChangedItems),n.isBuilt?(n.renderSubviews(e,t,i),n.activateSubviews(e),t.wakeSleepChangedItems.length&&(o=t.wakeSleepChangedItems.filter(function(e){return-1===t.newItems.indexOf(e)})).length&&n.wakeOrSleepSubviews(o),t.inViewportChangedItems.length&&n.processInViewportItems(t.inViewportChangedItems)):n.initialLayoutResponse=t,e},function(e){h.error("Error instantiating subviews",{err:e})})},instantiateSubviews:function(e){var r,a=[],s=this,l=this.get("container");e.forEach(function(e){var t,i,o,n;(r=s.modelsById[e.id])?s.subviewsById[e.id]?a.push(c.Promise.resolve(s.subviewsById[e.id])):a.push((t=r,i=e,o=c.merge(s.params,{id:e.id,parentSignature:s.getPhotolistSignature(),model:t,contextSuffix:s.contextSuffix,layoutItem:i,parentContainer:l,interactionViewName:s.interactionViewName,showInteractionBarPlaceholder:s.showInteractionBarPlaceholder,interactionBarHeight:s.interactionBarHeight,engagementModelName:s.engagementModelName}),(n=s.subviewMapping[t.registry.name]).params&&(o=c.merge(o,n.params)).removePoolPhoto&&(o.listModelParams=s.modelParams),s.instantiateSubview(n.name,o).then(function(e){return e.initialize().then(function(e){return s.subviewsById[i.id]=e,s.subviews={},e},function(e){return h.warn("Error in lifecycle of subview",{err:e,view:n.name}),s.photoListLayout.invalidateItem(i.id),null})},function(e){h.warn("Error instantiating subview",{err:e,view:n.name})}))):h.warn("Model missing from cache",{modelId:e.id})});e=c.Promise.all(a);return e.then(function(e){return!YUI.Env.isServer&&s.viewBeaconer&&s.viewBeaconer.beaconer.flushQueue({avoidDuplicates:!0}),e}),e},renderSubviews:function(t,i,e){var o,n,r=this.get("container"),a=this;t||(t=[],i.allLayoutItems.forEach(function(e){e=a.subviewsById[e.id];e&&t.push(e)})),e=e||"bottom",YUI.Env.isServer?(o=t.map(function(e){return e.get("container").get("outerHTML")}),"top"===e?r.setHTML(o.join("")+r.getHTML()):("bottom"===e||h.warn("Unsupported `renderSubviews` direction; appending changed subviews.",{direction:e}),r.setHTML(r.getHTML()+o.join("")))):("top"===e&&t.reverse(),n=YUI.config.doc.createDocumentFragment(),t.forEach(function(e){e&&n.appendChild(e.get("container").getDOMNode())}),"top"===e?r.prepend(n):("bottom"===e||h.warn("Unsupported `renderSubviews` direction; appending changed subviews.",{direction:e}),r.append(n))),e=i.wakeSleepChangedItems.filter(function(e){return-1!==i.newItems.indexOf(e)}),this.updateSubviewGeometry(e),this.keepAwakeOnScroll?(r=i.wakeSleepChangedItems.filter(function(e){return-1!==i.leadingOrphans.indexOf(e)||-1!==i.trailingOrphans.indexOf(e)}),e.forEach(function(e){e.isAwake=!0}),this.wakeOrSleepSubviews(e.concat(r))):this.wakeOrSleepSubviews(i.wakeSleepChangedItems)},updateSubviewGeometry:function(e){var t,i=this;e.forEach(function(e){(t=i.subviewsById[e.id])?t.updateGeometry?t.updateGeometry(e):t.get("container").setStyles({width:e.geometry.width+"px",height:e.geometry.height+"px",transform:"translate("+e.geometry.left+"px, "+e.geometry.top+"px)","-webkit-transform":"translate("+e.geometry.left+"px, "+e.geometry.top+"px)","-ms-transform":"translate("+e.geometry.left+"px, "+e.geometry.top+"px)"}):h.warn("Subview missing from cache for geometry update",{layoutItemId:e.id})})},wakeOrSleepSubviews:function(e){var t,i=this;e.forEach(function(e){(t=i.subviewsById[e.id])?t.wake&&t.sleep?e.isAwake?t.wake():t.sleep():t.get("container").setStyle("display",e.isAwake?"":"none"):h.warn("Subview missing from cache for wake/sleep update",{layoutItemId:e.id})})},processInViewportItems:function(e){var t,i=this;e.forEach(function(e){e.isInViewport&&(t=i.subviewsById[e.id])&&!YUI.Env.isServer&&i.viewBeaconer&&i.viewBeaconer.beaconer&&t.get("model").registry.hasAttribute(i.viewBeaconer.beaconIsOwnerAttribute)&&!t.get("model").getValue(i.viewBeaconer.beaconIsOwnerAttribute)&&(i.viewBeaconer.beaconAlwaysBeacon||t.get("model").registry.hasAttribute(i.viewBeaconer.beaconRestrictedAttribute)&&!t.get("model").getValue(i.viewBeaconer.beaconRestrictedAttribute))&&i.viewBeaconer.beaconer.queue(t.get("model").getValue(i.viewBeaconer.beaconAttribute),c.config.win.document.location.href)})},activateSubviews:function(e){if(!e)for(var t in e=[],this.subviewsById)e.push(this.subviewsById[t]);e.forEach(function(e){e.normalizedActivate()})},removeItems:function(e){var i=this;e.forEach(function(t){i.photoListLayout.invalidateItem(t.id),i.itemsMappedToAspectRatios=i.itemsMappedToAspectRatios.filter(function(e){return e.id!==t.id}),i.modelsById[t.id]&&delete i.modelsById[t.id],i.subviewsById[t.id]&&(i.subviewsById[t.id].destroy({remove:!0}),delete i.subviewsById[t.id])})},onCollectionModelValuesChanged:function(e,t){var i,o,n,r,a,s,l;e[this.modelParams.collectionAttributeName]&&e[this.modelParams.collectionAttributeName].listDiff&&(i=e[this.modelParams.collectionAttributeName].listDiff,!this.loadingMoreBottom&&!this.loadingMoreTop)&&(l=(s=this.get("collectionModel").getValue(this.modelParams.collectionAttributeName)).getList(),i.added.length&&(a=i.added,-1!=(e=l.indexOf(a[0])-1)&&(n=l[e])&&this.modelsById[n.id]&&(o="bottom",s.fetchedEnd&&a[a.length-1].id===l[a.length-1].id&&(this.lastItemCached=!0)),-1!==(n=l.indexOf(a[a.length-1])+1)&&(r=l[n+1])&&this.modelsById[r.id]&&(o="top",s.fetchedStart&&a[0].id===l[0].id&&(this.firstItemCached=!0)),o&&this.layOutItems(a,o,t)),i.removed.length&&(this.removeItems(i.removed),this.handleResize(null,!0)))},toggleThrobber:function(e){var t=this.get("container"),i=this.get("throbberNode");(e=void 0===e?!this.get("isThrobberShowing"):e)?(t.setStyle("height",this.containerHeight+100+"px"),t.setStyle("position","relative"),i&&i.appendTo(t)):(i&&i.remove(),t.setStyle("position","initial")),this._set("isThrobberShowing",e)},checkScrollInterruptionState:function(e){var t;(this.scrollInterruptState||e)&&(this.scrollInterruptState.numPagesLoaded>=this.scrollInterruptState.nextInterrupt?(this.scrollInterruptState.numInterrupts++,t=this.scrollInterruptParams.pageCounts[this.scrollInterruptParams.pageCounts.length-1],this.scrollInterruptState.numInterrupts>=this.scrollInterruptParams.pageCounts.length?"exponential"===this.scrollInterruptParams.repeatMode?this.scrollInterruptState.nextInterrupt+=t*Math.pow(2,this.scrollInterruptState.numInterrupts-this.scrollInterruptParams.pageCounts.length):this.scrollInterruptState.nextInterrupt+=t:this.scrollInterruptState.nextInterrupt+=this.scrollInterruptParams.pageCounts[this.scrollInterruptState.numInterrupts],e||this.interruptScroll()):this.get("container").setStyle("paddingBottom","0px"))},updateScrollInterruptState:function(e){this.scrollInterruptState.numPagesLoaded=e;for(var t=0;t<=e;t++)this.checkScrollInterruptionState(!0)},interruptScroll:function(){this.scrollInterruptState.isInterrupted||(this.scrollInterruptState.isInterrupted=!0,this.scrollInterruptState.loadMoreElement||(this.scrollInterruptState.loadMoreElement=c.Node.create(this.templates("infinite-scroll-load-more")({}))),this.get("container").append(this.scrollInterruptState.loadMoreElement),this.scrollInterruptState.loadMoreElementHeight||(this.scrollInterruptState.loadMoreElementHeight=parseInt(this.scrollInterruptState.loadMoreElement.getComputedStyle("height").replace("px",""),10)+20,this.registerEventHandler(this.scrollInterruptState.loadMoreElement.on("click",this.onLoadMoreClicked.bind(this))),this.scrollInterruptState.loadMoreElement.setStyles({width:this.photoListLayout.containerWidth+"px",bottom:this.photoListLayout.containerPadding.bottom+"px"})),this.setFooterDisplay(!0),this.get("container").setStyle("paddingBottom",this.scrollInterruptState.loadMoreElementHeight+"px"))},onLoadMoreClicked:function(e){var t,i=c.config.win.pageYOffset;this.scrollInterruptState.isInterrupted&&(this.scrollInterruptState.isInterrupted=!1,this.scrollInterruptState.loadMoreElement.remove(),this.setFooterDisplay(!1),this.get("container").setStyle("paddingBottom",this.scrollInterruptState.footerHeight+this.scrollInterruptState.loadMoreElementHeight-100+"px"),this.loadMore("bottom"),t=c.config.win.pageYOffset,c.config.win.scrollBy(0,i-t))},setFooterDisplay:function(e){this.scrollInterruptState.footer&&this.fire("subviewViewEvent","footerDisplayChanged")},cacheModelsById:function(e){if(e&&e.length){var t=this.modelsById,i=[];return e.forEach(function(e){e&&!t[e.id]&&(t[e.id]=e,i.push(e))}),i}},itemsToAspectRatios:function(e){var t=[],i=this.photoListLayout.forceAspectRatio,o=void 0!==i&&!isNaN(i),n=i||1;return e.forEach(function(e){void 0!==e&&t.push({id:e.id,aspectRatio:o?n:e.getValue("aspectRatio")})}),t},calculateContainerWidth:function(e){if("number"==typeof(e=e||this.explicitContainerWidth))return e;var t="previousContainerWidth"===e?this.getContainerWidthFromCache():(YUI.Env.isServer||(this.isActiveAndInDOM()?t=this.get("container").get("clientWidth")-this.scrollbarWidth:(e=this.get("container"),(e=!this.isBuilt||!e?c.one("."+this.parentName):e)&&(t=parseInt(e.getStyle("width"))))),t||this.getContainerWidthFromCache());return t},getContainerWidthFromCache:function(){var e;return(e=this.retrieveContainerWidth())||(e=this.appContext.viewportData.getWidth()-this.scrollbarWidth),this._relayoutQueued=!0,e},adjustRowHeightToContainerWidth:function(e){var t,i,o,n,r;if((e=this.calculateContainerWidth(e))<s[0])i=this.baseRowHeight*a[s[0]];else if(e>s[s.length-1])i=this.baseRowHeight*a[s[s.length-1]];else for(r=0;r<s.length-1;r++)if(0<=(t=(e-(o=s[r]))/((n=s[r+1])-o))&&t<=1){i=this.baseRowHeight*a[o]+t*this.baseRowHeight*(a[n]-a[o]);break}this.photoListLayout.targetRowHeight=i},storeContainerWidth:function(e){var t=this.parentName;t&&this.appContext.viewportData.setContainerWidth(t,e)},retrieveContainerWidth:function(){var e=this.parentName;return e?this.appContext.viewportData.getContainerWidth(e):0},getLayoutItemsOnScreen:function(e){if(YUI.Env.isServer)return[];var t=this.get("container"),i=this.getContainingElementData(),o=i.scrollTop-t.getXY()[1],n=o+i.height;return(e=e||this.photoListLayout.getCurrentLayout())?e.filter(function(e){return e.geometry.top+e.geometry.height>o&&e.geometry.top<n}):[]},scrollToCenterItem:function(e){var t,i,o;this.photoListLayout.hasLimitedNumberOfRows()||0===this.getContainingElementData().scrollTop||(t=this.photoListLayout.getCurrentLayout(),i=this.get("container").getXY()[1],(o=this).layoutItemAtScreenCenter||(t=this.getLayoutItemsOnScreen(t),this.layoutItemAtScreenCenter=t[Math.floor(.5*t.length)]),e.some(function(e){if(e.id===o.layoutItemAtScreenCenter.id)return o.parentContainer!==c.config.win&&o.parentContainer instanceof c.Node?o.parentContainer.getDOMNode().scrollTop=i+e.geometry.top+.5*(e.geometry.height-o.parentContainer.get("offsetHeight")):c.config.win.scrollTo(0,i+e.geometry.top+.5*(e.geometry.height-o.appContext.viewportData.getHeight())),!0}),this.deleteResizeCenterTimeoutId&&c.config.win.clearTimeout(this.deleteResizeCenterTimeoutId),this.deleteResizeCenterTimeoutId=c.config.win.setTimeout(function(){o.layoutItemAtScreenCenter&&(delete o.layoutItemAtScreenCenter,delete o.deleteResizeCenterTimeoutId)},1e3))},storeScrollPosition:function(){var e=this.getLayoutItemsOnScreen();e.length&&c.StorageHelper.setItem(this.getPhotolistSignature(),e[0].id,!0)},restoreScrollPosition:function(){this.scrollToId(null,!0)},scrollToId:function(e,t){var i=this.get("container");e=e||c.StorageHelper.getItem(this.getPhotolistSignature(),!0),(e=this.photoListLayout.getLayoutItem(e))&&(!e.geometry||e.geometry.top-this.photoListLayout.containerPadding.top<=0||(i=i.get("offsetParent")?i.get("offsetParent").get("offsetTop")+i.get("offsetTop"):i.get("offsetTop"),c.one(".global-nav-view")&&!t&&(i-=c.one(".global-nav-view").get("offsetHeight")),c.one(".fluid-subnav")&&!t&&(i-=c.one(".fluid-subnav").get("offsetHeight")),t&&(i+=50),this.setContainerScrollTop(e.geometry.top+i)))},validateWakeSleep:function(e){for(var t,i,o,n=this.photoListLayout.getAwakeItems(),r=e.allLayoutItems.indexOf(n[0]),a=e.allLayoutItems.indexOf(n[n.length-1]),s=[],l=r;l<a;l++)t=e.allLayoutItems[l],(i=this.subviewsById[t.id])&&((o=!(o=!t.isAwake)?i.isAwake?!i.isAwake():0===i.get("container").get("children").size():o)&&t&&(t.isAwake=!0,s.push(t)));s.length&&this.wakeOrSleepSubviews(s)},getPhotolistSignature:function(){var e,t,i,o=0;if(!this.signature){if(YUI.Env.isServer){if(e=this.appContext.request.path,this.appContext.request.query)for(t in this.appContext.request.query)c.config.flickr.routing_params.indexOf(t)<0&&(e+=t+this.appContext.request.query[t]);e=c.flutil.normalizeURIComponents(e)}else e=c.flutil.normalizeURIComponents(c.config.win.location.pathname+c.config.win.location.search);if(this.modelParams)if("string"!=typeof this.modelParams.modelIdOrAttributes)for(t in this.modelParams.modelIdOrAttributes)e+=t+""+this.modelParams.modelIdOrAttributes[t];else e+=this.modelParams.modelIdOrAttributes;for(this.parentName&&(e+=this.parentName),e=(e=e.toLowerCase()).replace(/\W/g,""),i=0;i<e.length;i++)o+=e.charCodeAt(i);this.signature="photolist-"+o.toString(36)}return this.signature},injectPhotolistContext:function(e){var t,i,o,n=e.currentTarget.getAttribute("href"),r=c.URLHelper.PHOTOPAGE_PATTERN.exec(n),a="";r&&5<=r.length&&(t=this.get("collectionModel").getValue(this.modelParams.collectionAttributeName).getList().map(function(e){return e.id}).filter(function(e){return!!e}),i=r[4],-1!==(r=t.indexOf(i))?((i=t.slice(r,r+50)).length<50&&(o=Math.max(0,r-(50-i.length)),i=t.slice(o,r).concat(i)),-1<n.indexOf("#")&&(n=(o=n.split("#"))[0],a="#"+o[1]),i=(n="/"===n.substr(-1)?n.substr(0,n.length-1):n)+"/in/photolist-"+c.URLHelper.generateShortenedPhotolist(i)+a,e.halt(),this.injectPhotolistContextParams&&this.injectPhotolistContextParams.rapidBeaconConfig&&((a={})[this.injectPhotolistContextParams.rapidBeaconConfig.itemIndexKey]=r+1,c.rapidTracker.beacon(this.name,this.injectPhotolistContextParams.rapidBeaconConfig.beaconName,a)),e.metaKey||e.ctrlKey||e.which&&2===e.which?c.config.win.open(i,"_blank"):this.appContext.flapp.navigate(i)):h.warn("Clicked photo id not found in photolist. Aborting photolist injection and passing through to photopage."))},subviewExtraToolClicked:function(e){var t,i,o,n=e.target.getDOMNode(),r=n.dataset.id,a=this.modelsById[r];r&&a&&(n.classList.contains("more-menu")?(i=[],(o=n.dataset.menuItems.split(","))&&(-1<o.indexOf("search-similar")&&i.push({text:this.intlMessage({intlName:"common.SEARCH_FOR_SIMILAR_PHOTOS"}),callback:function(e,t){var i=a.getValue("similaritySearchURL");t.metaKey||t.ctrlKey||t.which&&2===t.which?c.config.win.open(i,"_blank"):this.appContext.flapp.navigate(i)}.bind(this)}),-1<o.indexOf("search-similar-with-term")&&"search-photos-lite-models"===this.modelParams.registryName&&this.modelParams.fetchParams&&this.modelParams.fetchParams.apiParams&&this.modelParams.fetchParams.apiParams.text&&i.push({text:this.intlMessage({intlName:"common.SEARCH_FOR_SIMILAR_PHOTOS_WITH_TERM"}),callback:function(e,t){var i=a.getValue("basicSimilaritySearchURL")+"&text="+this.modelParams.fetchParams.apiParams.text;t.metaKey||t.ctrlKey||t.which&&2===t.which?c.config.win.open(i,"_blank"):this.appContext.flapp.navigate(i)}.bind(this)}),-1<o.indexOf("exclude-people")&&i.push({text:this.intlMessage({intlName:"common.HIDE_PHOTOS_FROM_PERSON"}),callback:function(){this.fire("subviewViewEvent","bigScotch",a.getValue("ownerNsid"),r)}.bind(this)}),-1<o.indexOf("ban-user")&&(t=function(e){this.fire("subviewViewEvent","banUser"+(e?"AndRemove":""),a.getValue("owner").id)},i.push({text:this.intlMessage({intlName:"common.GROUP_BAN_USER"}),callback:t.bind(this,!1)}),i.push({text:this.intlMessage({intlName:"common.GROUP_BAN_USER_REMOVE_PHOTOS"}),callback:t.bind(this,!0)})),-1<o.indexOf("remove-user")&&(t=function(e){this.fire("subviewViewEvent","removeUser"+(e?"AndRemove":""),a.getValue("owner").id)},i.push({text:this.intlMessage({intlName:"common.GROUP_REMOVE_USER"}),callback:t.bind(this,!1)}),i.push({text:this.intlMessage({intlName:"common.GROUP_REMOVE_USER_REMOVE_PHOTOS"}),callback:t.bind(this,!0)}))),i.length&&this.openSubviewMenu(e.target,i,this.subviewsById[r])):n.classList.contains("remove-photo")?(this.fire("subviewViewEvent","photoList:removePhoto",r),n.classList.contains("remove-fave")?this.appContext.getModelRegistry(this.engagementModelName).then(function(e){return e.remoteDelete({photoId:r,userId:this.modelParams.modelIdOrAttributes.id||this.modelParams.modelIdOrAttributes}).then(function(e){this.get("collectionModel").getValue(this.modelParams.collectionAttributeName).remove(a)}.bind(this),function(e){new c.Views.FluidModal({appContext:this.appContext,title:this.intlMessage({intlName:"common.OOPS"}),showActionButton:!0,showCancelButton:!1,textMessage:this.intlMessage({intlName:"common.PHOTO_REMOVE_ERROR"})}).show()}.bind(this))}.bind(this)):n.classList.contains("remove-group-pool")?this.get("collectionModel").removePhotoRemote(r).then(function(e){this.get("collectionModel").getValue(this.modelParams.collectionAttributeName).remove(a)}.bind(this),function(e){new c.Views.FluidModal({appContext:this.appContext,title:this.intlMessage({intlName:"common.OOPS"}),showActionButton:!0,showCancelButton:!1,textMessage:this.intlMessage({intlName:"common.PHOTO_REMOVE_ERROR"})}).show()}.bind(this)):n.classList.contains("remove-showcase-photo")?this.fire("subviewViewEvent","showcase:remove",a,r):n.classList.contains("remove-photosof-you")?this.fire("subviewViewEvent","photosofyou:remove",a,r):n.classList.contains("remove-own-photo")&&this.fire("subviewViewEvent","ownphoto:remove",a,r)):n.classList.contains("big-scotch")&&this.fire("subviewViewEvent","scotch:big",a.getValue("ownerNsid"),r),e.halt())},openSubviewMenu:function(e,t,o){var i,n,r,a,s,l=new c.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,observePageResize:!0,anchorElement:e,positionFixed:!1,preferBottom:!0,dismissOnOverlayClick:!0,closeOnScroll:!0,menuItems:t}),h=this;this.registerEventHandler(l.on("selected",function(e){e&&e.menuItem&&e.menuItem.callback&&e.menuItem.callback(e.menuItem.selected,e.origEvent)})),s=l.on("closeDroparound",function(e){h.detachRegisteredEvent(s),h.detachRegisteredEvent(i),h.detachRegisteredEvent(n),r&&clearTimeout(r),o.setHoverVisible&&o.setHoverVisible(!1)}),this.registerEventHandler(s),l.show(),i=l.get("container").on("mouseleave",function(e){var t;!l||(t=o.get("container"))&&(t=t.getDOMNode().getBoundingClientRect(),(e.clientX<t.left||e.clientX>t.right||e.clientY<t.top||e.clientY>t.bottom)&&l.close())}),this.registerEventHandler(i),n=c.one("document").on("mousemove",c.betterThrottle(function(e){r&&clearTimeout(r),r=setTimeout(function(){a(e)},200)})),this.registerEventHandler(n),a=function(e){var t,i;l&&(i=l.getDroparoundContainer(),(t=o.get("container"))&&i&&(t=t.getDOMNode().getBoundingClientRect(),i=i.getDOMNode().getBoundingClientRect(),!(e.clientX<t.left||e.clientX>t.right||e.clientY<t.top||e.clientY>t.bottom)||e.clientX>i.left&&e.clientX<i.right&&e.clientY>i.top&&e.clientY<i.bottom||l.close()))},o.setHoverVisible&&o.setHoverVisible(!0)},subviewLicenseMouseenter:function(e){var t,i=e.currentTarget&&e.currentTarget.getData("license-type")&&e.currentTarget.getData("license-type").toString();i&&(this.licenseTooltipHoverTimer&&clearTimeout(this.licenseTooltipHoverTimer),this.licenseTooltip&&this.licenseTooltip.close(),this.licenseTooltipHoverTimer=setTimeout(function(){this.licenseTooltip=new c.Views.FluidDroparound({appContext:this.appContext,anchorElement:e.target,showDropArrow:!0,positionFixed:!1,preferBottom:!0,invisibleOverlay:!0,autoSizeToContent:!0,width:300,classList:"license-tooltip",htmlMessage:this.templates("license-detail")({title:"common.LICENSE_TITLE_"+i,body:"common.LICENSE_DESC_"+i})}),this.licenseTooltip.show()}.bind(this),300),t=this.get("container").delegate("mouseleave",function(e){this.licenseTooltip&&this.licenseTooltip.close(),t.detach(),clearTimeout(this.licenseTooltipHoverTimer)}.bind(this),".license"),this.registerEventHandler(t))},show:function(){this.isHidden=!1,this.get("container").setStyle("display","block")},hide:function(){this.isHidden=!0,this.get("container").setStyle("display","none")}},{ATTRS:{showThrobberDuringLoad:{value:!0,validator:function(e,t){return c.AttributeHelpers.validateBoolean(e)}},isThrobberShowing:{readOnly:!0,value:!1},throbberNode:{readOnly:!0,getter:function(e){return YUI.Env.isServer||void 0!==e||(e=c.Node.create('<div style="position: absolute; bottom: 40px; left: 0; right: 0;"><div class="flickr-dots"></div></div>'),this._set("throbberNode",e)),e}}}})},"@VERSION@",{requires:["flickr-view","hermes-template-infinite-scroll-load-more","hermes-template-license-detail","photo-list-layout","photo-list-photo-view","overflow-helper","storage-helper","attribute-helpers","url-helper","paged-collection","fluid-droparound-view","flutil"],optionalRequires:["global-events"],langBundles:["common"]}),YUI.add("hermes-template-photo-selector-photolist-subview",function(i,e){var o=i.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return e.escapeExpression((r(i,"outlet")||t&&r(t,"outlet")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?r(t,"photo-list-view"):t,{name:"outlet",hash:{},data:n,loc:{start:{line:1,column:0},end:{line:1,column:26}}}))},useData:!0}),n={};i.Array.each([],function(e){var t=i.Template.get("hermes/"+e);t&&(n[e]=t)}),i.Template.register("hermes/photo-selector-photolist-subview",function(e,t){return(t=t||{}).partials=t.partials?i.merge(n,t.partials):n,o(e,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]}),YUI.add("photo-selector-photolist-view",function(t){t.namespace("Views")[this.name]=t.Base.create(this.name,t.FlickrView,[],{initializer:function(e){return e.photolistViewClasses&&(e.additionalViewClasses=e.photolistViewClasses),e.photoListConfig=t.merge(e.primaryPhotoListConfig),e.publicOnlyPhotos=e.publicOnlyPhotos,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},buildContainer:function(){return this.setContainerWithTemplate("photo-selector-photolist-subview"),this}})},"@VERSION@",{requires:["flickr-view","photo-list-view","hermes-template-photo-selector-photolist-subview"]}),YUI.add("hermes-template-search-photos-single-row",function(i,e){var o=i.Template.Handlebars.revive({1:function(e,t,i,o,n){var r,a,s=null!=t?t:e.nullContext||{},l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t<h5 class="search-results-header">'+(null!=(r=l(i,"unless").call(s,null!=t?l(t,"loading"):t,{name:"unless",hash:{},fn:e.program(2,n,0),inverse:e.noop,data:n,loc:{start:{line:2,column:35},end:{line:2,column:278}}}))?r:"")+e.escapeExpression("function"==typeof(a=null!=(a=l(i,"title")||(null!=t?l(t,"title"):t))?a:e.hooks.helperMissing)?a.call(s,{name:"title",hash:{},data:n,loc:{start:{line:2,column:278},end:{line:2,column:287}}}):a)+" "+(null!=(r=l(i,"if").call(s,null!=t?l(t,"loading"):t,{name:"if",hash:{},fn:e.program(6,n,0),inverse:e.noop,data:n,loc:{start:{line:2,column:288},end:{line:2,column:348}}}))?r:"")+"</h5>\n"+(null!=(r=l(i,"if").call(s,null!=t?l(t,"loading"):t,{name:"if",hash:{},fn:e.program(8,n,0),inverse:e.program(10,n,0),data:n,loc:{start:{line:3,column:1},end:{line:7,column:8}}}))?r:"")},2:function(e,t,i,o,n){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(n=r(i,"unless").call(null!=t?t:e.nullContext||{},null!=t?r(t,"singleResult"):t,{name:"unless",hash:{},fn:e.program(3,n,0),inverse:e.noop,data:n,loc:{start:{line:2,column:54},end:{line:2,column:267}}}))?n:""},3:function(e,t,i,o,n){var r,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,h=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<a href="'+l("function"==typeof(r=null!=(r=h(i,"viewAll")||(null!=t?h(t,"viewAll"):t))?r:s)?r.call(a,{name:"viewAll",hash:{},data:n,loc:{start:{line:2,column:87},end:{line:2,column:98}}}):r)+'" class="view-more-link"'+(null!=(e=h(i,"if").call(a,null!=t?h(t,"viewAllDataTrack"):t,{name:"if",hash:{},fn:e.program(4,n,0),inverse:e.noop,data:n,loc:{start:{line:2,column:122},end:{line:2,column:187}}}))?e:"")+">"+l((h(i,"intlHTMLMessage")||t&&h(t,"intlHTMLMessage")||s).call(a,{name:"intlHTMLMessage",hash:{count:null!=t?h(t,"total"):t,intlName:"search.VIEW_ALL_COUNT"},data:n,loc:{start:{line:2,column:188},end:{line:2,column:252}}}))+"</a>"},4:function(e,t,i,o,n){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return' data-track="'+e.escapeExpression("function"==typeof(r=null!=(r=r(i,"viewAllDataTrack")||(null!=t?r(t,"viewAllDataTrack"):t))?r:e.hooks.helperMissing)?r.call(null!=t?t:e.nullContext||{},{name:"viewAllDataTrack",hash:{},data:n,loc:{start:{line:2,column:159},end:{line:2,column:179}}}):r)+'"'},6:function(e,t,i,o,n){return'<div class="flickr-dots inline"></div>'},8:function(e,t,i,o,n){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t\t<div style="height: '+e.escapeExpression("function"==typeof(r=null!=(r=r(i,"placeholderHeight")||(null!=t?r(t,"placeholderHeight"):t))?r:e.hooks.helperMissing)?r.call(null!=t?t:e.nullContext||{},{name:"placeholderHeight",hash:{},data:n,loc:{start:{line:4,column:22},end:{line:4,column:43}}}):r)+'px;"></div>\n'},10:function(e,t,i,o,n){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"\t\t"+e.escapeExpression((r(i,"outlet")||t&&r(t,"outlet")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?r(t,"photo-list-view"):t,{name:"outlet",hash:{},data:n,loc:{start:{line:6,column:2},end:{line:6,column:28}}}))+"\n"},compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){var r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(n=r(i,"unless").call(null!=t?t:e.nullContext||{},null!=t?r(t,"emptySearch"):t,{name:"unless",hash:{},fn:e.program(1,n,0),inverse:e.noop,data:n,loc:{start:{line:1,column:0},end:{line:8,column:11}}}))?n:""},useData:!0}),n={};i.Array.each([],function(e){var t=i.Template.get("hermes/"+e);t&&(n[e]=t)}),i.Template.register("hermes/search-photos-single-row",function(e,t){return(t=t||{}).partials=t.partials?i.merge(n,t.partials):n,o(e,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]}),YUI.add("photo-lite-models",function(i){function t(e){t.superclass.constructor.call(this,e)}i.Models[this.name]=t,i.extend(t,i.FlickrModelRegistry,{name:this.name,remote:{update:i.PhotoModelHelper.updateEngagement,addReaction:function(e){return i.ModelUpdaters["flickr-reactions-add"].run(e,this.appContext)},removeReaction:function(e){return i.ModelUpdaters["flickr-reactions-remove"].run(e,this.appContext)}},toggleFave:i.PhotoModelHelper.toggleFave,addAsFave:i.PhotoModelHelper.addAsFave,toggleReaction:function(t,i,o){var e=this.getValue(t,"reactions")[i].count,n=Object.assign({},this.getValue(t,"reactions")),r=Object.assign({},n[i]);return r.didViewerReact=o,r.count=o?e+1:e-1,n[i]=r,this.setValue(t,"reactions",n),"photo-engagement-models"!==this.name&&this.appContext.getModelRegistry("photo-engagement-models").then(function(e){e.exists(t)&&e.toggleReaction(t,i,o)}),this.getValue(t,"reactions")[i]},updateReactionRemote:function(e,t){return i.Promise.resolve({})},getLargestSize:i.PhotoModelHelper.getLargestSize,getSizeToFit:i.PhotoModelHelper.getSizeToFit,getSizeIfExact:i.PhotoModelHelper.getSizeIfExact,isSizeSquare:i.PhotoModelHelper.isSizeSquare,isPhotoSquare:i.PhotoModelHelper.isPhotoSquare,attributes:{owner:{readOnly:!0,isModel:!0,getter:function(e,t){var i=this;return{id:i.getValue(t,"ownerNsid"),getValue:function(e){return"id"===e||"nsid"===e?i.getValue(t,"ownerNsid"):"url"===e?i.getValue(t,"ownerUrl"):i.getValue(t,e)},toJSON:function(){return{id:i.getValue(t,"ownerNsid"),url:i.getValue(t,"ownerUrl"),pathAlias:i.getValue(t,"pathAlias"),username:i.getValue(t,"username"),realname:i.getValue(t,"realname"),displayname:i.getValue(t,"displayname"),nsid:i.getValue(t,"ownerNsid"),ownerUrl:i.getValue(t,"ownerUrl"),isMe:i.getValue(t,"isMe")}},exists:function(e){return!1}}}},pathAlias:i.PersonModelHelper.attributes.pathAlias,username:i.PersonModelHelper.attributes.username,realname:i.PersonModelHelper.attributes.realname,displayname:i.PersonModelHelper.attributes.displayname,nsid:i.PersonModelHelper.attributes.nsid,ownerUrl:i.PersonModelHelper.attributes.url,isMe:i.PersonModelHelper.attributes.isMe,engagement:{readOnly:!0,isModel:!0,getter:function(e,t){var i=this;return{registry:this,getValue:function(e){return i.getValue(t,e)},toJSON:function(){return{ownerNsid:i.getValue(t,"ownerNsid"),isFaved:i.getValue(t,"isFaved"),faveCount:i.getValue(t,"faveCount"),commentCount:i.getValue(t,"commentCount"),canFave:i.getValue(t,"canFave"),reactions:i.getValue(t,"reactions")}},exists:function(e){return!1}}}},ownerNsid:i.PhotoModelHelper.attributes.ownerNsid,isFaved:i.PhotoModelHelper.attributes.isFaved,faveCount:i.PhotoModelHelper.attributes.faveCount,commentCount:i.PhotoModelHelper.attributes.commentCount,canFave:i.PhotoModelHelper.attributes.canFave,title:i.PhotoModelHelper.attributes.title,description:i.PhotoModelHelper.attributes.description,mediaType:i.PhotoModelHelper.attributes.mediaType,license:i.PhotoModelHelper.attributes.license,isVideo:i.PhotoModelHelper.attributes.isVideo,isOwner:i.PhotoModelHelper.attributes.isOwner,sizes:i.PhotoModelHelper.attributes.sizes,descendingSizes:i.PhotoModelHelper.attributes.descendingSizes,ascendingSizes:i.PhotoModelHelper.attributes.ascendingSizes,aspectRatio:i.PhotoModelHelper.attributes.aspectRatio,needsInterstitial:i.PhotoModelHelper.attributes.needsInterstitial,canComment:i.PhotoModelHelper.attributes.canComment,url:i.PhotoModelHelper.attributes.url,rotation:i.PhotoModelHelper.attributes.rotation,similaritySearchURL:i.PhotoModelHelper.attributes.similaritySearchURL,basicSimilaritySearchURL:i.PhotoModelHelper.attributes.basicSimilaritySearchURL,oWidth:{validator:function(e){return i.AttributeHelpers.validateInteger(e)},setter:function(e){return i.AttributeHelpers.coerceInteger(e)},defaultValue:0},oHeight:{validator:function(e){return i.AttributeHelpers.validateInteger(e)},setter:function(e){return i.AttributeHelpers.coerceInteger(e)},defaultValue:0},isPublic:{validator:function(e){return i.AttributeHelpers.validateBoolean(e)},setter:function(e){return i.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},isVisibleByFriends:{validator:function(e){return i.AttributeHelpers.validateBoolean(e)},setter:function(e){return i.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},isVisibleByFamily:{validator:function(e){return i.AttributeHelpers.validateBoolean(e)},setter:function(e){return i.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},reactions:{defaultValue:{like:{id:"like",count:5,didViewerReact:!0,canReact:!0},someOtherReaction:{id:"someOtherReaction",count:3,didViewerReact:!1,canReact:!0}},derivedBy:["canFave"],getter:function(e,t){t=this.getValue(t,"canFave");return e&&e.like&&(e.like.canReact=t,e.like.didViewerReact=!!t&&e.like.didViewerReact),e}}}})},"@VERSION@",{requires:["flickr-model-registry","photo-model-helper","person-model-helper","flickr-favorites-add-updater","flickr-favorites-remove-updater","photo-models","photo-engagement-models","person-models"]});
