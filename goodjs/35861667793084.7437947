!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("JS Ads for Publishers",[],t):"object"==typeof exports?exports["JS Ads for Publishers"]=t():e["JS Ads for Publishers"]=t()}(self,function(){var r={808:function(e,t,r){var n,i;void 0===(n="function"==typeof(n=i=function(){function a(){for(var e=0,t={};e<arguments.length;e++){var r,n=arguments[e];for(r in n)t[r]=n[r]}return t}function c(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function e(d){function o(){}function r(e,t,r){if("undefined"!=typeof document){"number"==typeof(r=a({path:"/"},o.defaults,r)).expires&&(r.expires=new Date(+new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var n=JSON.stringify(t);/^[\{\[]/.test(n)&&(t=n)}catch(e){}t=d.write?d.write(t,e):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var i,s="";for(i in r)r[i]&&(s+="; "+i,!0!==r[i]&&(s+="="+r[i].split(";")[0]));return document.cookie=e+"="+t+s}}function t(e,t){if("undefined"!=typeof document){for(var r={},n=document.cookie?document.cookie.split("; "):[],i=0;i<n.length;i++){var s=n[i].split("="),o=s.slice(1).join("=");t||'"'!==o.charAt(0)||(o=o.slice(1,-1));try{var a=c(s[0]),o=(d.read||d)(o,a)||c(o);if(t)try{o=JSON.parse(o)}catch(e){}if(r[a]=o,e===a)break}catch(e){}}return e?r[e]:r}}return o.set=r,o.get=function(e){return t(e,!1)},o.getJSON=function(e){return t(e,!0)},o.remove=function(e,t){r(e,"",a(t,{expires:-1}))},o.defaults={},o.withConverter=e,o}(function(){})})?n.call(t,r,t,e):n)||(e.exports=n),e.exports=i()}},n={};function X(e){var t=n[e];if(void 0!==t)return t.exports;t=n[e]={exports:{}};return r[e](t,t.exports,X),t.exports}X.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var G={};return function(){"use strict";var i,t;X.r(G),(D=i=i||{}).popunderTriggered="popunderTriggered",D.embeddedAdsLoaded="embeddedAdsLoaded",D.embeddedAdsError="embeddedAdsError",D.embeddedAdsSpotLoaded="embeddedAdsSpotLoaded",D.embeddedAdsSpotFailed="embeddedAdsSpotFailed",D.embeddedAdsSpotDefaultLoaded="embeddedAdsSpotDefaultLoaded",D.embeddedAdsDebuggerUpdate="embeddedAdsDebuggerUpdate",(D=t=t||{})[D.Low=99]="Low",D[D.Medium=550]="Medium",D[D.High=720]="High",D[D.VeryHight=1080]="VeryHight";var s,o,n=X(808);const c={adBaseURL:`${location.protocol}//{ENV}/{METHOD}`,adClassNameContext:"adsbytrafficjunkycontext",cookies:{deliveryServer:{name:"TJDeliveryServer"},env:{name:"TJAdsUrl"}},videoFormats:["video/mp4","video/webm","video/ogg"]};class a{}a.getEnv=e=>{var t=n.get(c.cookies.env.name),r=".trafficjunky.net";return t?`${t}${r}`:e||`ads${r}`},a.getDeliveryServer=()=>n.get(c.cookies.deliveryServer.name),(D=s=s||{}).context_pornstar="context_pornstar",D.context_category="context_category",D.context_tag="context_tag",D.context_page_type="context_page_type",D.info="info",D.category="category",D.search="search",D.site="site",(D=o=o||{}).site_id="site_id",D.hb_guid="hc",D.version="t_version",D.platform="device_type",D.client_ip="clientIP",D.segment="segment",D.custom_param="",D.delivery_server="",D.refresh_times="",D.refresh_delay="",D.retry="",D.bg_color="",D.default_image="",D.default_url="",D.domain_rewrite="",D.fail_url="",D.spot_ssp="",D.spot_new="";class d{createURL(e,t=!1){var r=e.specificParams.domain_rewrite;let n=c.adBaseURL;n=n.replace("{ENV}",a.getEnv(r)),n=n.replace("{METHOD}",this.getMethod(e,t)),t?(n+=`?zone_id=${e.spotId}&redirect=1&format=popunder`,n+=`&clientType=${encodeURIComponent(String(e.specificParams.platform))}`):(n+=`?data=${encodeURIComponent(`[{"spots":[{"zone":${e.spotId}}]}]`)}`,n+="&clientType=mobile"),n+=this.getChannelsParameters(e.channelParams),n+=this.getSpecificParameters(e.specificParams,t);t=a.getDeliveryServer();return t&&(n+=`&delivery-server=${t}`),r&&(n+=`&dm=${encodeURIComponent(r)}`),n+=`&_=${Date.now()}`,e.specificParams.custom_param&&(n+=e.specificParams.custom_param),n}getSpecificParams(e,t){const r=Object.assign(Object.assign({},t),e),n={};for(const e in r)e in o&&(n[e]=r[e]);return n}getChannelParams(e,t){const r=Object.assign(Object.assign({},t),e),n={};for(const e in r)e in s&&(n[e]=r[e]);return n}getAdContextAttributes(){var e=document.querySelector(`meta[name="${c.adClassNameContext}"]`);return e?u.getDataAttributes(e):null}getChannelsParameters(e){let t="";if(!e)return t;for(const r in e)s[r]&&e[r]&&(t+=`&channel[${r}]=${encodeURIComponent(e[r])}`);return t}getSpecificParameters(e,t){let r="";for(const i in e){var n;o[i]&&e[i]&&(n=this.getSpecificParameterValue(e,t,i),r+=`&${o[i]}=${encodeURIComponent(n)}`)}return r}getSpecificParameterValue(e,t,r){return"platform"!==r||t||"pc"!==e[r]?e[r]:"tablet"}getMethod(e,t){return"true"===e.specificParams.spot_ssp?"deep-ssp":t?"ads":"ads_batch"}}class l{static log(e,t){l.logs[e]||(l.logs[e]=[]),t&&(t.logTime=new Date(Date.now())),l.logs[e].push(t);t=JSON.parse(JSON.stringify(this.debug()));window.postMessage({debug:t,name:e,type:i.embeddedAdsDebuggerUpdate},"*")}static getSpots(){var e={};for(const t in l.logs)-1!==[i.embeddedAdsSpotDefaultLoaded,i.embeddedAdsSpotFailed,i.embeddedAdsSpotLoaded].indexOf(t)&&l.populateMapForEvent(t,e);return l.populateSpots(e)}static populateSpots(e){const t={};for(const n in e){t[n]||(t[n]={});var r=e[n][i.embeddedAdsSpotFailed];this.populateSpotsPerRefreshed(t[n],r,"failed");r=e[n][i.embeddedAdsSpotDefaultLoaded];this.populateSpotsPerRefreshed(t[n],r,"default_loaded");r=e[n][i.embeddedAdsSpotLoaded];this.populateSpotsPerRefreshed(t[n],r,"loaded")}return this.formatSpots(t)}static formatSpots(e){const t={};for(const r in e){t[r]=[];for(const n in e[r])t[r].push(e[r][n])}return t}static populateMapForEvent(t,r){for(let e=0;e<l.logs[t].length;e++){var n=l.logs[t][e].ad;r[n.refreshed]||(r[n.refreshed]={}),r[n.refreshed][t]||(r[n.refreshed][t]={}),r[n.refreshed][t][n.uuid]={container:l.logs[t][e].container,spotId:n.spotId}}}static populateSpotsPerRefreshed(e,t,r){if(t)for(const n in t)e[n]={container:t[n].container,spotId:t[n].spotId,status:r}}static getHBSpots(){const t=document.querySelectorAll("script[src*='/ads_batch']");for(let e=0;e<t.length;e++){var r=String(t[e].getAttribute("src")),r=l.getHBSpotsFromScript(r);if(r)return r}return null}static getHBSpotsFromScript(e){try{if(!e||-1===e.indexOf("?"))return null;e=e.substring(e.indexOf("?"));const t=new URLSearchParams(e);if(!t.get("hb"))return null;const r=JSON.parse(t.get("data"))[0].spots,n=[];for(let e=0;e<r.length;e++)n.push(r[e].zone);return n}catch(e){return null}}}l.logs={},l.debug=()=>({context:l.adContextAttributes,events:l.logs,hbSpots:l.getHBSpots(),spots:l.getSpots()});class u{static connectionInfo(){return navigator.connection||navigator.mozConnection||navigator.webkitConnection}static getNearestAvailableQuality(t,e){const r=Number(e);let n=Object.keys(t);return 0===n.length?null:(n=n.filter(e=>"progressive"===t[e].delivery),n=n.filter(e=>{e=t[e];return!!e.type&&["video/mp4","video/webm","video/ogg"].includes(e.type)}),n.sort((e,t)=>{e=Number(e),t=Number(t);return isNaN(e)?1:isNaN(t)?-1:Math.abs(r-e)-Math.abs(r-t)})[0])}}u.createDOMElement=(e,t={})=>{const r=document.createElement(e);for(const e in t)r.setAttribute(e,t[e]);return r},u.getDataAttributes=e=>{const t=[].filter.call(e.attributes,e=>/^data-/.test(e.name)),r={};for(const e in t){var n=null===(i=t[e].name)||void 0===i?void 0:i.replace("data-","").replace(/-/g,"_"),i=null===(i=t[e].value)||void 0===i?void 0:i.trim();i&&n&&(r[n]=u.sanitize(i))}return r},u.isLeftButton=e=>1===(e.which||e.button),u.isAdBlock=()=>{const e=document.createElement("div");e.innerHTML="&nbsp;";let t=!(e.className="adsbox");try{document.body.appendChild(e),t=0===document.getElementsByClassName("adsbox")[0].offsetHeight,document.body.removeChild(e)}catch(e){t=!0}return t||!window.tjEmbeddedAdsLoaded},u.dispatchTjEvent=(e,t)=>{const r=document.createEvent("Event");r.initEvent(e,!1,!0),t&&(r.detail=t),document.dispatchEvent(r),l.log(e,t),e===i.embeddedAdsSpotFailed&&u.sendFailEvent(t)},u.sendFailEvent=e=>{var t=(new d).getAdContextAttributes();if(t&&t.fail_url&&0!==e.status){const r=new XMLHttpRequest;r.open("POST",t.fail_url),r.send(JSON.stringify({pageUrl:window.location.href,retryCounter:e.retried,tjAdData:null!==(t=e.request.response)&&void 0!==t?t:"",tjAdRequestUrl:e.request.url,tjResponseCode:e.request.status,tjResponseTime:e.request.duration,tjZoneID:e.ad.spotId}))}},u.getQuality=()=>{var e=u.connectionInfo();return e?e.downlink<.3?t.Low:e.downlink<.7?t.Medium:t.High:t.Medium},u.sanitize=e=>{const t={"<":"&lt;",">":"&gt;"};return e.replace(/[<>]/gi,e=>t[e])};class h{static dispatchError(e){h.dispatch(i.embeddedAdsError,null,{error:JSON.stringify(e,Object.getOwnPropertyNames(e))})}}h.createInlineStyle=(t,r=!1)=>{let n="";for(const r in t){let e="";";"!==t[r].substr(t[r].length-1)&&(e=";"),n+=`${r}:${t[r]}${e}`}return r&&(n=n.replace(/!important/g,"").replace(/;/g,"!important;")),n},h.getElementByTag=(e,t)=>e.tagName===t.toUpperCase()?e:e.querySelector(t),h.getElementBySpotId=(r,n)=>function(e,o,a,d){return new(a=a||Promise)(function(r,t){function n(e){try{s(d.next(e))}catch(e){t(e)}}function i(e){try{s(d.throw(e))}catch(e){t(e)}}function s(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,i)}s((d=d.apply(e,o||[])).next())})}(void 0,void 0,void 0,function*(){var e=`.${r}[data-source-id="${n}"], .${r}[data-spot-id="${n}"]`;let t=0;for(;!document.querySelector(e);){if(20<t++)return null;yield new Promise(e=>requestAnimationFrame(e))}return document.querySelector(e)}),h.dispatch=(e,t=null,r={})=>{u.dispatchTjEvent(e,h.getEventParams(t,r))},h.getEventParams=(e=null,t={})=>t=e?Object.assign({ad:Object.assign({},e.params),channelParams:e.channelParams,container:e.containerElement,request:Object.assign(Object.assign({},e.request),{duration:Date.now()-Number(e.request.duration)}),specificParams:e.specificParams},t):t,h.getUUID=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)});const p={adClassName:"adsbytrafficjunky",botttomAdName:"tjBottomAd",closeImageURL:`${location.protocol}//static.trafficjunky.com/delivery/img/close.png`,cookies:{bottom:{expiry:48e4,name:"TJBottomClose"},fail:{name:"TJAdsFail"},server:{expiry:36e5,name:"RLBNSERVERID"}},defaults:{bg_color:"transparent",platform:"mobile"},idSync:{scriptUrl:"https://static.trafficjunky.com/invocation/idsync/production/idsync.min.js",sites:["tube8","pornhub","youporn","redtube","xtube"]}};class m{static createURL(e,t=!1){return m.adService.createURL(e,t)}static getSpecificParams(e,t){return m.adService.getSpecificParams(e,t)}static getChannelParams(e,t){return m.adService.getChannelParams(e,t)}static getAdContextAttributes(){var e=m.adService.getAdContextAttributes();return l.adContextAttributes=e}}m.adService=new d;const f={"background-color":"#000000",border:"none",display:"block",margin:"0 auto",overflow:"hidden"},r={border:"none",display:"block",height:"100%",left:"0","margin-left":"auto","margin-right":"auto",position:"absolute",right:"0",top:"0","vertical-align":"middle",width:"100%"},g={overflow:"hidden",position:"relative"},v={"-ms-transform":"translateX(-50%)",bottom:"0px",display:"block",left:"50%",position:"fixed",transform:"translateX(-50%)","z-index":"9999"},y={background:`url(${p.closeImageURL})`,"background-repeat":"no-repeat",cursor:"pointer",height:"20px",position:"absolute",right:"-10px",top:"-10px",width:"20px"},b={overflow:"hidden",position:"relative"},w={left:"0",position:"absolute",top:"0",width:"100%"};class S{}S.fixSrcDoc=e=>{if(!("srcdoc"in document.createElement("iframe"))&&(e="IFRAME"!==e.tagName?e.querySelector("iframe"):e)){const t=e,r=null==t?void 0:t.getAttribute("srcdoc");r&&(null===(e=t.contentWindow)||void 0===e||e.document.open(),null===(e=t.contentWindow)||void 0===e||e.document.write(r),null===(e=t.contentWindow)||void 0===e||e.document.close())}},S.fixMobileVideoAd=e=>{if(!e)return e;var t=e.indexOf('<div class="adtool_video_ad"');return e=-1!==t?`${e.substr(0,t)}\n\t\t\t<script src='//cdn11.contentabc.com/delivery/mobile_video/adtool_mobile_video_player_min.js'><\/script>\n\t\t\t${e.substr(t)}`:e};function A(e,o,a,d){return new(a=a||Promise)(function(r,t){function n(e){try{s(d.next(e))}catch(e){t(e)}}function i(e){try{s(d.throw(e))}catch(e){t(e)}}function s(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,i)}s((d=d.apply(e,o||[])).next())})}class e extends class{constructor(e,t){this.channelParams={},this.specificParams={},this.request={},this.getParams=e=>({height:String(e.height),refreshed:0,spotId:e.source_id?Number(e.source_id):Number(e.spot_id),type:String(e.type),uuid:h.getUUID(),width:String(e.width)}),this.setChannelAndSpecificParams=(e,t)=>{this.specificParams=m.getSpecificParams(e,t),this.channelParams=m.getChannelParams(e,t);for(const e in p.defaults)this.specificParams[e]||(this.specificParams[e]=p.defaults[e])},this.params=this.getParams(e),this.setChannelAndSpecificParams(e,t)}}{constructor(e,t,r){super(t,r),this.createWithDefaultIfFail=(r,e)=>A(this,void 0,void 0,function*(){const t=Number(this.specificParams.retry)||0;this.request.defaultAd=!1;for(let e=0;e<t+1;e++){const t=yield r();if(t)return t;h.dispatch(i.embeddedAdsSpotFailed,this,{retried:e})}return this.createDefaultAd(e)}),this.createDefaultAd=e=>{if(!this.specificParams.default_image||!this.specificParams.default_url)return null;(e=e||Object.assign({height:this.params.height,width:this.params.width},f))["background-color"]=this.specificParams.bg_color;const t=u.createDOMElement("img",{src:this.specificParams.default_image,style:h.createInlineStyle(e)}),r=u.createDOMElement("a",{"data-embeddedadsfallback":"true","data-height":this.params.height,"data-spot-id":this.params.spotId,"data-width":this.params.width,href:this.specificParams.default_url,target:"_blank"});return r.appendChild(t),this.request.defaultAd=!0,r},this.containerElement=e,this.refresh()}refresh(){const t=Number(this.specificParams.refresh_delay),r=Number(this.specificParams.refresh_times);if(t&&r){let e=0;this.interval=window.setInterval(()=>{++e>=r&&window.clearInterval(this.interval),this.params.refreshed++,"function"==typeof this.revert&&this.revert(),this.run()},1e3*t)}}reload(){window.clearInterval(this.interval),"function"==typeof this.revert&&this.revert(),this.run(),this.refresh()}run(){return A(this,void 0,void 0,function*(){if(!this.checkIfCreatable())return!1;this.request.duration=Date.now();var e=yield this.create();if(!e||!document.body.contains(this.containerElement))return"function"==typeof this.revert&&this.revert(),!1;this.insertIntoDOM(e),this.removeInvocationCode(),this.containerElement=e,S.fixSrcDoc(e);e=this.request.defaultAd?i.embeddedAdsSpotDefaultLoaded:i.embeddedAdsSpotLoaded;return h.dispatch(e,this),!0})}checkIfCreatable(){return!(!this.containerElement||!this.containerElement.parentNode)&&document.body.contains(this.containerElement)}insertIntoDOM(e){this.containerElement&&this.containerElement.parentNode&&this.containerElement.parentNode.insertBefore(e,this.containerElement.nextSibling)}removeInvocationCode(){this.containerElement&&this.containerElement.parentNode&&this.containerElement.parentNode.removeChild(this.containerElement)}}class x{static wasClosed(){return Boolean(n.get(p.cookies.bottom.name))}static isTestFail(){return Boolean(n.get(p.cookies.fail.name))}static close(){var e=new Date(Date.now()+p.cookies.bottom.expiry);n.set(p.cookies.bottom.name,"1",{expires:e,secure:!0})}}x.setDeliveryServer=e=>{var t;e&&(t=new Date(Date.now()+p.cookies.server.expiry),n.set(p.cookies.server.name,e,{expires:t,secure:!0}))};class C{static getHBAd(e){const t=window.tjPreloadAds[e.params.spotId],r=x.isTestFail()?null:t.response;return e.request.duration=Date.now()-t.duration,e.request.url=t.url,e.request.status=t.status,e.request.response=t.response,delete window.tjPreloadAds[e.params.spotId],(new z).load(),new Promise(e=>e(r))}static verifyResponse(e,t,r){return t.request.url=r,t.request.status=e.status,t.request.response=e.responseText,!window.XDomainRequest&&200!==e.status||!e.responseText||x.isTestFail()?null:e.responseText}}C.makeRequest=n=>window.tjPreloadAds&&window.tjPreloadAds[n.params.spotId]?C.getHBAd(n):new Promise(e=>{const t=new(window.XDomainRequest||XMLHttpRequest),r=m.createURL({channelParams:n.channelParams,specificParams:n.specificParams,spotId:n.params.spotId});t.onload=t.onerror=t.ontimeout=()=>{e(C.verifyResponse(t,n,r))},t.onprogress=()=>{},t.open("GET",r),t.timeout=1e4,t.send()});function P(e,o,a,d){return new(a=a||Promise)(function(r,t){function n(e){try{s(d.next(e))}catch(e){t(e)}}function i(e){try{s(d.throw(e))}catch(e){t(e)}}function s(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,i)}s((d=d.apply(e,o||[])).next())})}var E,k,D;class j{static create(t,r,n){return P(this,void 0,void 0,function*(){let e=n;return e=e||(yield j.getJSONFromContent(t)),j.createSync(t,r,e)})}static createSync(e,t,r){t=j.createIframe(e,t);return j.inject(t,e,r)}static inject(e,t,r){var n=r;if(!n)return null;r=j.getHTMLfromJSON(n);return r?(t.request.data=n,e.setAttribute("srcdoc",r),e):null}}j.wrap=(e,t,r)=>{const n=j.createIframe(e,r);return n.setAttribute("srcdoc",t.outerHTML),n},j.createIframe=(e,t)=>((t=t||Object.assign({},f))["background-color"]=e.specificParams.bg_color,u.createDOMElement("iframe",{allowtransparency:"true","data-embeddedads":"true","data-spot-id":e.params.spotId,height:e.params.height,marginheight:"0",marginwidth:"0",scrolling:"no",style:h.createInlineStyle(t,!0),width:e.params.width})),j.getJSONFromContent=t=>P(void 0,void 0,void 0,function*(){var e=yield C.makeRequest(t);if(!e)return null;try{return JSON.parse(e)[0]}catch(e){return null}}),j.getHTMLfromJSON=e=>{let t="";return e.full_html?t=e.full_html:e.html&&(t=e.html),S.fixMobileVideoAd(t)};class I{constructor(e,t){this.create=()=>j.createSync(this.baseAd,void 0,this.json),this.baseAd=e,this.json=t}}class _{constructor(e,t){this.lastPlayPos=0,this.currentPlayPos=0,this.bufferingDetected=!1,this.video=e.firstChild,this.mediaFiles=t,this.setQuality(u.getQuality()),1<Object.keys(this.mediaFiles).length&&setInterval(this.checkBuffering,50)}checkBuffering(){this.video&&(this.currentPlayPos=this.video.currentTime,this.isBuffering(.03)&&(this.bufferingDetected=!0),this.isBuffering(.03,!0)&&(this.bufferingDetected=!1),this.lastPlayPos=this.currentPlayPos)}isBuffering(e,t=!1){return!!this.video.paused&&(t?this.bufferingDetected&&this.currentPlayPos>this.lastPlayPos+e:!this.bufferingDetected&&this.currentPlayPos<this.lastPlayPos+e)}setQuality(e){let t=this.mediaFiles[e];if(!t){e=u.getNearestAvailableQuality(this.mediaFiles,e);if(!e)return;t=this.mediaFiles[e]}t&&(this.video.src=t.url)}}class O{getValue(e,t,r=null){let n=null;var i=e.querySelectorAll(t);for(let e=0;e<i.length;e++){const t=i[e],s=this.strip(t.textContent);if(s&&(!r||s!==r)){n=s;break}}return n}strip(e){return e?e.replace("<![CDATA[","").replace("]]>","").trim():null}}(D=E=E||{}).Start="start",D.FirstQuartile="firstQuartile",D.Midpoint="midpoint",D.ThirdQuartile="thirdQuartile",D.Complete="complete",D.Mute="mute",D.Unmute="unmute",D.Pause="pause",D.Resume="resume",D.Fullscreen="fullscreen",D.Skip="skip",D.Click="click",D.Impression="impression";class T extends O{get(e){var t={},r=e.querySelectorAll("TrackingEvents Tracking");for(let e=0;e<r.length;e++){const n=r[e],i=n.getAttribute("event"),s=n,o=this.strip(s.textContent);this.addEventUrl(t,i,o)}return 0!==Object.keys(t).length?t:null}addEventUrl(e,t,r){t&&r&&E[t.charAt(0).toUpperCase()+t.slice(1)]&&(e[t]||(e[t]=[]),e[t].push(r))}}class N extends O{get(e){if(!(e=e.querySelectorAll("VideoClicks")[0]))return null;const t=this.getValue(e,"VideoClicks ClickThrough");if(!t)return null;const r=[],n=e.querySelectorAll("VideoClicks ClickTracking");for(let e=0;e<n.length;e++){const t=n[e],i=this.strip(t.textContent);i&&r.push(i)}return{clickThrough:t,clickTracking:r}}}class M extends O{get(e){const t={},r=e.querySelectorAll("MediaFiles MediaFile");for(let e=0;e<r.length;e++){const n=r[e],i=n,s=this.strip(i.textContent),o=Number(n.getAttribute("height")),a=n.getAttribute("type"),d=a&&c.videoFormats.includes(a);s&&d&&(t[o]={bitrate:Number(n.getAttribute("bitrate")),delivery:n.getAttribute("delivery"),height:o,type:a,url:s,width:Number(n.getAttribute("width"))})}return t}}class L extends O{constructor(){super(...arguments),this.getWithVideoClicksEvents=e=>{e.events||(e.events={});var t=[...t=e.events[E.Click]||[],...e.videoClicks.clickTracking];return e.events[E.Click]=t,e}}get(e){const r=[],n=e.querySelectorAll("Creatives Creative");for(let t=0;t<n.length;t++){let e=n[t];var i=e.getAttribute("AdID");e=e.querySelectorAll("Linear")[0],e&&((i=this.getCreative(e,i))&&r.push(this.getWithVideoClicksEvents(i)))}return r.length?r:null}getCompanion(e){if(!e.querySelector("Creatives Creative CompanionAds Companion"))return null;var t=this.getValue(e,"StaticResource");return t?{clickThrough:this.getValue(e,"CompanionClickThrough"),clickTracking:this.getValue(e,"CompanionClickTracking"),staticRessource:t}:null}getCreative(e,t){var r=(new N).get(e),n=(new M).get(e);return r&&Object.keys(n).length?{duration:this.getValue(e,"Duration"),events:(new T).get(e),id:t,mediaFiles:n,videoClicks:r}:null}}class R extends O{get(e){const t=new L,r=t.get(e),n=t.getCompanion(e);return r?{adSystem:this.getValue(e,"AdSystem"),companion:n,creatives:r}:null}}class q extends I{constructor(){super(...arguments),this.create=()=>{try{var e=this.stringToVAST();if(!e)return null;this.vast=e,this.baseAd.request.data=this.json;var t=this.createVideo(),r=this.createOverlay(),n=this.createWrapper(t,r);return new _(t,this.vast.creatives[0].mediaFiles),j.wrap(this.baseAd,n)}catch(e){return null}},this.getEventScript=(e,t)=>{if(!t)return null;const r=u.createDOMElement("script");return r.innerHTML=`document.getElementById('${e}').onclick = function() { \n\t\t\t\t\t\t\t\tvar xhr = new XMLHttpRequest(); \n\t\t\t\t\t\t\t\txhr.open('GET', '${t}'); \n\t\t\t\t\t\t\t\txhr.send(); \n\t\t\t\t\t\t    };`,r}}createWrapper(e,t){const{width:r,height:n}=this.baseAd.params,i=h.createInlineStyle(Object.assign(Object.assign({},b),{height:n,width:r})),s=u.createDOMElement("div",{style:i});return s.appendChild(e),t&&s.appendChild(t),s}createOverlay(){if(!this.vast.companion)return null;var{staticRessource:e,clickThrough:t,clickTracking:r}=this.vast.companion,e=u.createDOMElement("img",{src:e,style:h.createInlineStyle(w)});if(!t)return e;const n=u.createDOMElement("a",{href:t,id:"overlay",target:"_blank"}),i=this.getEventScript("overlay",r);return n.appendChild(e),i&&n.appendChild(i),n}createVideo(){const e=u.createDOMElement("video",{autoplay:!0,loop:!0,muted:"muted",playsinline:"",preload:"auto",style:"width: 100%"});e.muted=!0,e.volume=0;const{clickThrough:t,clickTracking:r}=this.vast.creatives[0].videoClicks,n=u.createDOMElement("a",{href:t,id:"video",target:"_blank"}),i=this.getEventScript("video",r[0]);return n.appendChild(e),i&&n.appendChild(i),n}stringToVAST(){var e=(new DOMParser).parseFromString(this.json.full_html,"application/xml").querySelectorAll("InLine")[0];return e?(new R).get(e):null}}(D=k=k||{}).AdaptiveVideo="adaptive_video",D.Video="video",D.Iframe="iframe",D.Image="image",D.VideoBanner="video_banner",D.Static="static";class F{constructor(){this.create=(e,t)=>new(t.media_type===k.VideoBanner?q:I)(e,t)}}function B(e,o,a,d){return new(a=a||Promise)(function(r,t){function n(e){try{s(d.next(e))}catch(e){t(e)}}function i(e){try{s(d.throw(e))}catch(e){t(e)}}function s(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,i)}s((d=d.apply(e,o||[])).next())})}class U extends e{constructor(){super(...arguments),this.create=()=>B(this,void 0,void 0,function*(){return yield this.createWithDefaultIfFail(this.getIframeAd)}),this.getIframeAd=()=>B(this,void 0,void 0,function*(){var e=yield j.getJSONFromContent(this);if(!e)return null;const t=(new F).create(this,e);return t?t.create():null})}}function $(e,o,a,d){return new(a=a||Promise)(function(r,t){function n(e){try{s(d.next(e))}catch(e){t(e)}}function i(e){try{s(d.throw(e))}catch(e){t(e)}}function s(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,i)}s((d=d.apply(e,o||[])).next())})}class V extends e{constructor(){super(...arguments),this.createBottomAdElement=()=>$(this,void 0,void 0,function*(){var e=yield this.createWithDefaultIfFail(()=>j.create(this));if(!e)return null;const t=this.createContainer(),r=h.createInlineStyle({height:`${this.params.height}`,width:`${this.params.width}`}),n=u.createDOMElement("div",{style:r});return n.appendChild(this.createCloseButton(t)),n.appendChild(e),t.appendChild(n),t}),this.createCloseButton=e=>{const t=u.createDOMElement("div");return t.setAttribute("style",h.createInlineStyle(y)),t.onclick=()=>{document.body.removeChild(e),x.close()},t},this.createContainer=()=>{const e=u.createDOMElement("div",{id:p.botttomAdName});return e.setAttribute("style",h.createInlineStyle(v)),e}}create(){return $(this,void 0,void 0,function*(){return window.tjBottomAdLoaded=!0,yield this.createBottomAdElement()})}insertIntoDOM(e){document.body.appendChild(e)}checkIfCreatable(){return!x.wasClosed()&&!window.tjBottomAdLoaded&&super.checkIfCreatable()}revert(){delete window.tjBottomAdLoaded}}class H extends e{constructor(){super(...arguments),this.create=()=>function(e,o,a,d){return new(a=a||Promise)(function(r,t){function n(e){try{s(d.next(e))}catch(e){t(e)}}function i(e){try{s(d.throw(e))}catch(e){t(e)}}function s(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,i)}s((d=d.apply(e,o||[])).next())})}(this,void 0,void 0,function*(){const e=Object.assign(Object.assign({},r),{"min-height":`${this.params.height}`}),t=yield this.createWithDefaultIfFail(()=>j.create(this,e),e);return t?this.createResponsiveWrapper(t):null}),this.createResponsiveWrapper=e=>{const t=Number(this.params.width.slice(0,-2)),r=Number(this.params.height.slice(0,-2)),n=Math.floor(r/t*100),i=h.createInlineStyle(Object.assign(Object.assign({},g),{"padding-top":`${n}%`}),!0),s=u.createDOMElement("div",{style:i});return s.appendChild(e),s}}}class J{constructor(){this.create=(e,t,r)=>new("bottom"===t.type?V:"responsive"===t.type?H:U)(e,t,r)}}function W(e,o,a,d){return new(a=a||Promise)(function(r,t){function n(e){try{s(d.next(e))}catch(e){t(e)}}function i(e){try{s(d.throw(e))}catch(e){t(e)}}function s(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,i)}s((d=d.apply(e,o||[])).next())})}class Q{constructor(){this.sync=e=>W(this,void 0,void 0,function*(){if(this.verify(e)&&!window.tjIdSyncSynced){window.tjIdSyncSynced=!0;try{const e=yield this.get();if(!e)return;e.set_TJ_uid().fp_get().sync()}catch(e){}}}),this.get=()=>W(this,void 0,void 0,function*(){return new Promise(e=>{if(window.idsync)return e(window.idsync);const t=document.createElement("script");t.defer=!0,t.src=`${p.idSync.scriptUrl}?v=${this.getCacheVersion()}`,t.onload=t.onerror=()=>e(window.idsync),document.body.insertAdjacentElement("beforeend",t)})}),this.getCacheVersion=()=>{const e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0).getTime()},this.verify=e=>{if(!e)return!1;var t=e.site,e="publisher"===e.invocation_type;return!(-1===p.idSync.sites.indexOf(t)&&!e)&&-1===window.navigator.userAgent.indexOf("MSIE")}}}class z{constructor(){this.idSyncService=new Q,this.preload=()=>{if(window.tjPreloadAds){const t=m.getAdContextAttributes();for(const r in window.tjPreloadAds)"response"in window.tjPreloadAds[r]&&(window.tjPreloadAds[r].loaded||(window.tjPreloadAds[r].loaded=!0,new Promise(()=>function(e,o,a,d){return new(a=a||Promise)(function(r,t){function n(e){try{s(d.next(e))}catch(e){t(e)}}function i(e){try{s(d.throw(e))}catch(e){t(e)}}function s(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,i)}s((d=d.apply(e,o||[])).next())})}(this,void 0,void 0,function*(){var e=yield h.getElementBySpotId(p.adClassName,r);e&&this.run(e,t)}))))}},this.load=()=>{const t=document.getElementsByClassName(p.adClassName),r=m.getAdContextAttributes(),n=[];this.idSyncService.sync(r);for(let e=0;e<t.length;e++){var i=this.run(t[e],r);i&&n.push(i)}return Promise.all(n)},this.reload=e=>{const t=z.ads[e];if(t)for(const e in t)t[e].reload()},this.run=(e,t)=>{var r=u.getDataAttributes(e);if(!this.canCreate(r))return null;e.setAttribute("data-loading","true");const n=(new J).create(e,r,t);return z.ads[n.params.spotId]||(z.ads[n.params.spotId]=[]),z.ads[n.params.spotId].push(n),n.run()},this.verifyAttributes=e=>!(!this.verify(e,["source_id"])&&!this.verify(e,["spot_id"]))&&this.verify(e,["height","width"]),this.verify=(t,r)=>{let n=!0;for(let e=0;e<r.length;e++)t[r[e]]||(n=!1);return n},this.setDeliveryServer=()=>{var e=m.getAdContextAttributes();x.setDeliveryServer(null==e?void 0:e.delivery_server)}}init(){window.tjLoadEmbeddedAds=this.load,window.tjPreloadEmbeddedAds=this.preload,window.tjReloadEmbeddedAdsSpot=this.reload,window.tjDebug=l.debug,this.setDeliveryServer()}canCreate(e){if(e.loading)return!1;if(!this.verifyAttributes(e))return!1;e=e.spot_id;return!(window.tjPreloadAds&&window.tjPreloadAds[e]&&!window.tjPreloadAds[e].loaded)}}z.ads={};(new class{constructor(){this.embeddedAdsService=new z}init(){if(window.tjEmbeddedAdsLoaded)return!1;try{window.tjEmbeddedAdsLoaded=!0,this.sendLoadedEvent(),this.launch()}catch(e){return h.dispatchError(e),!1}return!0}launch(){this.embeddedAdsService.init(),this.embeddedAdsService.preload(),"loading"!==document.readyState?this.embeddedAdsService.load():document.addEventListener("DOMContentLoaded",()=>{try{this.embeddedAdsService.load()}catch(e){h.dispatchError(e)}})}sendLoadedEvent(){let e={};if(void 0!==window.tjEmbeddedAdsDuration){const i=void 0!==window.tjPreloadAds?Object.assign({},window.tjPreloadAds):null;e={duration:Date.now()-window.tjEmbeddedAdsDuration,tjPreloadAds:i}}u.dispatchTjEvent(i.embeddedAdsLoaded,e)}}).init()}(),G});
