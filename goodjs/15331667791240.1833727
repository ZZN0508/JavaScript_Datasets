!function(){var l,t,c,p,e,i,a;void 0!==window.jQuery&&(l=jQuery,(t=function(e,t){var i=this;this.isAppView=/IchibaApp-jp.co.rakuten.superdeal/.test(navigator.userAgent),this.$config=e,this.$sharedConfig=t||l(""),this.priceSourceSelector=this.$config.attr("data-priceSourceSelector")||this.defaults.selectors.priceSource,this.pointBackSourceSelector=this.$config.attr("data-pointBackSourceSelector")||this.defaults.selectors.pointBackSource,this.updatedRateSelector=this.$config.attr("data-updatedRateSelector")||this.defaults.selectors.updatedRate,this.updatedPriceSelector=this.$config.attr("data-updatedPriceSelector")||this.defaults.selectors.updatedPrice,this.startDateSelector=this.$config.attr("data-startDateSelector")||this.defaults.selectors.startDate,this.endDateSelector=this.$config.attr("data-endDateSelector")||this.defaults.selectors.endDate,this.radTableSelector=this.$config.attr("data-radTableSelector")||this.defaults.selectors.radTable,this.radTableConfigSelector=this.$config.attr("data-radTableConfigSelector")||this.defaults.selectors.radTableConfig,this.radTableBodySelector=this.$config.attr("data-radTableBodySelector")||this.defaults.selectors.radTableBody,this.sliderWrapSelector=this.$config.attr("data-sliderWrap")||"",this.sliderType=this.$config.attr("data-sliderType")||"",this.wrapSelector=this.$config.attr("data-wrap")||"",this.itemWrapSelector=this.$config.attr("data-itemWrap")||"",this.itemSelector=this.$config.attr("data-item")||"",this.dateSourceSelector=this.$config.attr("data-dateSource")||"",this.pointUpRate=(e=+i.$config.attr("data-pointUpRate"),t=+i.$sharedConfig.attr("data-pointUpRate"),isNaN(e)?isNaN(t)?0:t:e),this.appRate=function(){if(!i.isAppView)return 0;var e=+i.$config.attr("data-appRate"),t=+i.$sharedConfig.attr("data-appRate");return isNaN(e)?isNaN(t)?0:t:e}(),this.pointUpRate+=this.appRate,this.campaign=function(){if(i.isAppView)return!1;var e=i.$config.attr("data-campaign"),t=i.$sharedConfig.attr("data-campaign");return"true"===e||"false"===e?"true"===e:("true"===t||"false"===t)&&"true"===t}(),this.addOriginalPriceComma="true"===this.$config.attr("data-addOriginalPriceComma"),this.allUpdatedEventTargetSelector=this.$config.attr("data-allUpdatedEventTarget")||"body",this.dateText=this.$config.attr("data-dateText")||this.defaults.texts.date,this.endDate=this.startDate="",this.adsUpdated=0}).prototype={defaults:{selectors:{priceSource:".riSDAdTxtTp > span",pointBackSource:".riSDAdPntBk > span",updatedRate:".percentWrap > .number",updatedPrice:".pntBkPrice",startDate:".riSDAdDateStart",endDate:".riSDAdDateEnd",radTable:".rad-table-existItemDisplay, .radTableContainer",radTableConfig:".rad-table-config, .radConfig",radTableBody:".rad-table-body, .radItemsDisplay"},texts:{date:"#MONTH#月#DATE#日 #HOUR#:#MINUTE#"},events:{SD_ADS_UPDATED:"sdadsupdated",SD_ALL_ADS_UPDATED:"sdalladsupdated"}},initialize:function(){var g=this;this.sliderWrapSelector&&("sp"===this.sliderType?this.initializeSPSlider():"pc"===this.sliderType&&this.initializePCSlider()),this.wrapSelector&&this.itemWrapSelector&&this.itemSelector&&(this.$wraps=l(this.wrapSelector),this.$allUpdatedEventTarget=l(this.allUpdatedEventTargetSelector),this.$wraps.bind("sdadsupdated",function(){++g.adsUpdated===g.$wraps.length&&g.$allUpdatedEventTarget.trigger(g.defaults.events.SD_ALL_ADS_UPDATED)}).each(function(e){var t,i,a=g.$wraps.eq(e),n=a.find(g.itemWrapSelector),r=a.find(g.radTableSelector),o=r.find(g.radTableConfigSelector),s=r.find(g.radTableBodySelector),d=g.wrapSelector+":eq("+e+")",l=g.wrapSelector.replace(/(\s|\.|#|>)/g,"")+e,c="",p="",h=0;0<r.length?r.each(function(e){o.eq(e).attr("event_target",d).attr("event_name",l+e),a.bind(l+e,function(){++h===r.length&&(s.each(function(e){s.eq(e).children().appendTo(n)}),t=n.find(g.itemSelector),g.dateSourceSelector&&(0<(i=0===(i=a.prev(g.dateSourceSelector)).length?a.find(g.dateSourceSelector):i).length&&(c=i.attr("data-startDate"),p=i.attr("data-endDate"))),g.updateItems(a,t,g.pointUpRate,c,p,g.addOriginalPriceComma,g.campaign))})}):(t=n.find(g.itemSelector),!g.dateSourceSelector||0<(i=0===(i=a.prev(g.dateSourceSelector)).length?a.find(g.dateSourceSelector):i).length&&(c=i.attr("data-startDate"),p=i.attr("data-endDate")),g.updateItems(a,t,g.pointUpRate,c,p,g.addOriginalPriceComma,g.campaign))}))},initializeSPSlider:function(){var e,t=this,i=l(this.sliderWrapSelector),a=i.find(".sdBanner"),n=i.find(".sdBannerList > ul"),r=(s=i.find(this.radTableSelector)).find(this.radTableConfigSelector),o=s.find(this.radTableBodySelector),s=this.sliderWrapSelector,d=this.sliderWrapSelector.replace(/(\s|\.|#|>)/g,"");r.attr("event_target",s).attr("event_name",d),i.bind(d,function(){0!==(e=o.children()).length&&(i.show(),t.updateItems(i,e,t.pointUpRate,"","",t.addOriginalPriceComma,t.campaign),n.append(e),(new c).initialize(a))})},initializePCSlider:function(){var e,t=this,i=l(this.sliderWrapSelector),a=i.find(".sdLiquidBanner"),n=i.find(".sdLiquidBanner-list > ul"),r=(s=i.find(this.radTableSelector)).find(this.radTableConfigSelector),o=s.find(this.radTableBodySelector),s=this.sliderWrapSelector,d=this.sliderWrapSelector.replace(/(\s|\.|#|>)/g,"");r.attr("event_target",s).attr("event_name",d),i.bind(d,function(){0!==(e=o.children()).length&&(i.show(),t.updateItems(i,e,t.pointUpRate,"","",t.addOriginalPriceComma,t.campaign),n.append(e),new p(a).initialize())})},updateItems:function(e,a,n,r,o,s,d){var l=this;0<a.eq(0).find("img[data-original]").length&&this.loadLazyLoading(a.find("img")),a.each(function(e){e=a.eq(e),d&&e.addClass("campaign");var t,i=e.find(l.priceSourceSelector);0<i.length&&(t=parseInt(i.html().replace(/円|,/g,""),10)),s&&i.html(l.addDigitComma(t)+"円"),0<(i=e.find(l.pointBackSourceSelector)).length&&(i=parseInt(i.html().replace(/%|％/g,""),10)+n,e.find(l.updatedRateSelector).html(i+""),(t=parseInt(t*i/100,10))&&e.find(l.updatedPriceSelector).html(l.addDigitComma(t))),r&&(t=r.split(/-|:|\s/),i=(i=l.dateText).replace("#MONTH#",t[1]).replace("#DATE#",t[2]).replace("#HOUR#",t[3]).replace("#MINUTE#",t[4]),e.find(l.startDateSelector).html(i)),o&&(t=o.split(/-|:|\s/),i=(i=l.dateText).replace("#MONTH#",t[1]).replace("#DATE#",t[2]).replace("#HOUR#",t[3]).replace("#MINUTE#",t[4]),e.find(l.endDateSelector).html(i))}),e.trigger(this.defaults.events.SD_ADS_UPDATED)},loadLazyLoading:function(t){t.each(function(e){t.eq(e).attr("src",t.eq(e).attr("data-original")).removeAttr("data-original")})},addDigitComma:function(e){return(""+e).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}},c=function(){var i=this;l.extend(i,{settings:{noready:[1,"Int","^[0-1]$"],maxitem:[3,"Int","^[1-9]$"],minitem:[1,"Int","^[1-9]$"],autoresize:[1,"Int","^[0-1]$"],slidespeed:[500,"Range","1,9999"],flickmove:[30,"Range","1,99"],nodisplaywords:["","Str","^.{1,256}$"],noslidewords:["","Str","^.{1,256}$"],noflickwords:["","Str","^.{1,256}$"],slide:[1,"Int","^[0-1]$"],flick:[1,"Int","^[0-1]$"],disablebutton:[1,"Int","^[0-1]$"]},eobj:{banner:null,loading:null,config:null,existItem:null,prototypeItem:null,prevButton:null,nextButton:null,itemsDisplay:null,pageIndicators:null},status:{error:!1},props:{items:[],itemEvents:{},itemPrototype:{html:"",height:0,width:0,identifiers:{banner:["","#BANNER#",""]}}},initialize:function(e){i.eobj.banner=e,i.eobj.loading=i.eobj.banner.find(".sdBannerLoading"),i.eobj.config=i.eobj.banner.find(".sdBannerConfig"),i.eobj.list=i.eobj.banner.find(".sdBannerList"),i.eobj.prototypeItem=i.eobj.banner.find(".sdBannerPrototype"),i.eobj.existItem=i.eobj.banner.find(".sdBannerExistItemDisplay"),i.eobj.itemsDisplay=i.eobj.banner.find(".sdBannerItemsDisplay"),i.eobj.prevButton=i.eobj.banner.find(".sdBannerPrevButton"),i.eobj.nextButton=i.eobj.banner.find(".sdBannerNextButton"),i.eobj.pageIndicators=i.eobj.banner.find(".sdBannerPageIndicators"),0!==i.eobj.list.length&&i.loadSettings()&&(1===i.settings.noready?i.begin():l(function(){i.begin()}))},loadSettings:function(){if(i.settings=l.RJS_Helpers.readAttr(i.eobj.config,i.settings),""!==i.settings.nodisplaywords){var e,t=i.settings.nodisplaywords.split(",");for(e in t)if(navigator.userAgent.match(t[e]))return!1}return 0!==i.settings.slidespeed&&(i.settings.slidespeed/=1e3),i.eobj.config.remove(),!0},begin:function(){i.status.error=!i.getPrototype(),i.getData()},getData:function(){var e=i.eobj.list.find("li",".sdBannerItems");if(0!==e.length)return e.each(function(){i.props.items.push({banner:l(this).html()})}),i.startSlideshow(),!0;i.eobj.banner.remove()},getPrototype:function(){var e=i.eobj.prototypeItem,t=i.props.itemPrototype;return 0!==e.length&&(t.width=e.outerWidth(),t.height=e.outerHeight(),t.html=e.html(),""!==t.html&&(e.remove(),!0))},startSlideshow:function(){i.eobj.existItem.show(),i.eobj.itemsDisplay.RJS_Slideshow(i,{settings:i.settings,itemPrototype:i.props.itemPrototype,eobj:i.eobj,items:i.props.items,itemEvents:i.props.itemEvents,events:{afterFirstRender:i.afterFirstRender,beforeFirstRender:i.beforeFirstRender}})},afterFirstRender:function(){},beforeFirstRender:function(e,t){t.eobj.loading.remove(),t.eobj.itemsDisplay.show()}})},p=function(r){var o=this;l.extend(o,{slideshow:null,settings:{autoslidetime:[7e3,"Range","0,9999"],autoslideflag:["next","Str","^(next|prev)$"],autoslide:[1,"Int","^[0-1]$"],maxitem:[2,"Int","^[1-9]$"],pagespeed:[50,"Range","0,9999"],opacityspeed:[200,"Range","0,9999"],verticalmode:[0,"Int","^[1]$"],autoresize:[1,"Int","^[0-1]$"],pagenumber:[0,"Int","^[0-1]$"],indicator:[1,"Int","^[0-1]$"],indicatoralign:[0,"Int","^[0-1]$"],singlemode:[0,"Int","^[0-1]$"],defaultcontent:[".flashcontent","Str","^[a-zA-Z0-9_-]{3,32}$"]},eobj:{config:r.find(".sdLiquidBanner-config"),frame:r.find(".sdLiquidBanner-frame"),prototypeItem:r.find(".sdLiquidBanner-item"),itemsDisplay:r.find(".sdLiquidBanner-body"),prevButton:r.find(".sdLiquidBanner-prev"),nextButton:r.find(".sdLiquidBanner-next"),backButton:r.find(".sdLiquidBanner-back"),nowPage:r.find(".sdLiquidBanner-nowPage"),maxPage:r.find(".sdLiquidBanner-maxPage"),indicatorDisplay:r.find(".sdLiquidBanner-indicatorArea"),prototypeIndicator:r.find(".prototypeIndicator")},status:{error:!1,isTimeout:!1},props:{items:[],itemPrototype:{html:"",height:0,width:0,identifiers:{banner1:["",/\#BANNER1\#/g,""],banner2:["",/\#BANNER2\#/g,""]}},indicatorPrototype:{html:"",width:0,height:0}},initialize:function(){o.loadSettings(),o.begin()},loadSettings:function(){return o.settings=l.RJS_Helpers.readAttr(o.eobj.config,o.settings),o.eobj.config.remove(),!0},begin:function(){o.status.error=!o.getPrototype(),o.getData()},getData:function(){var e,t=r.find(".sdLiquidBanner-list li"),i=r.find(".liquidBanner-cBanner");if(t.length<1)return!1;if(1===o.settings.singlemode)for(a=t.length,i=0;i<a;i++)o.props.items[i]=[],o.props.items[i].banner1=l(t[i]).html();else{var a=Math.ceil(t.length/2),n=t[0]?l(t[0]).html():"";for(0<i.length&&1==t.length%2&&(n=i.html()),e=i=0;i<a;i++)o.props.items[i]=[],o.props.items[i].banner1=t[e]?l(t[e++]).html():n,o.props.items[i].banner2=t[e]?l(t[e++]).html():n}return o.startSlideshow(),o.eobj.backButton.bind("click",function(e){return e.preventDefault(),o.slideshow.changePage(1),!1}),!0},getPrototype:function(){var e=o.eobj.prototypeItem,t=o.props.itemPrototype;if(0===e.length)return!1;if(t.width=e.outerWidth(),t.height=e.outerHeight(),t.html=e.html(),""===t.html)return!1;if(e.remove(),1==o.settings.indicator){if(e=o.eobj.prototypeIndicator,t=o.props.indicatorPrototype,0===e.length)return!1;if(t.width=e.outerWidth(),t.height=e.outerHeight(),t.html=e.html(),""===t.html)return!1;e.remove()}return!0},startSlideshow:function(){r.find(o.settings.defaultcontent).hide(),o.eobj.frame.show(),o.eobj.itemsDisplay.RJS_Slideshow(o,{settings:o.settings,itemPrototype:o.props.itemPrototype,indicatorPrototype:o.props.indicatorPrototype,eobj:o.eobj,items:o.props.items,events:{beforeFirstRender:o.beforeFirstRender,changePageNumber:1==o.settings.pagenumber&&o.changePageNumber}})},beforeFirstRender:function(e,t){t.eobj.itemsDisplay.show()},changePageNumber:function(e,t,i){i.eobj.nowPage.text(e),i.eobj.maxPage.text(t),1==e?i.eobj.backButton.hide():i.eobj.backButton.show()}})},0!==(e=l("#RJSSDAdsUpdaterConfig")).length&&(i=e.find(".sharedConfig"),(a=e.children().not(".sharedConfig")).each(function(e){new t(a.eq(e),i).initialize()})))}();
