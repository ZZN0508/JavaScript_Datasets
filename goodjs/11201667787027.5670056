define("modules/clean/loggers/device_type",["require","exports","tslib","modules/core/browser_detection"],function(e,t,o,a){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.getDeviceType=t.DeviceType=void 0,a=o.__importStar(a),(o=r=t.DeviceType||(t.DeviceType={})).desktop="desktop",o.mobile="mobile",o.tablet="tablet",t.getDeviceType=function(){return a.is_supported_mobile_browser()?r.mobile:a.is_tablet()?r.tablet:r.desktop}}),define("modules/clean/photos/batching_thumb_store",["require","exports","tslib","modules/clean/photos/thumb_loading/batching_thumb_loader","modules/clean/photos/thumb_loading/generic_thumb_store","modules/constants/request"],function(e,t,o,a,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=o.__importStar(s),t.default=function(e){var t=!(!e||!e.allow_http2)&&e.allow_http2,e=s.IS_HTTP2&&t,t=e?void 0:new a.BatchingThumbLoader;return new r.GenericThumbStore(t,!e)}}),define("modules/clean/photos/thumb_loading/batching_thumb_loader",["require","exports","modules/clean/photos/batch_thumb_loader","modules/clean/photos/thumb_loading/utils"],function(e,t,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BatchingThumbLoader=void 0;var a=(r.prototype.get_request_id=function(){return this.batch_thumb_loader.vend_request_id()},r.prototype.load_image=function(e,t,o,a,r,s){this.batch_thumb_loader.queue_thumb(e,this._thumb_loaded.bind(this,{url:e,request_id:t,success:a,error:r,should_retry:s}),{onrequest:o,request_id:t}),window.setTimeout(this.batch_thumb_loader.flush.bind(this.batch_thumb_loader,10))},r.prototype._thumb_loaded=function(e,t){var o=e.url,a=(e.request_id,e.success),r=e.error,e=e.should_retry;t&&0===t.indexOf("data:")?a(t):s.load_individual_image(o,0,a,r,e)},r.prototype.cancel_thumb=function(e){this.batch_thumb_loader.cancel_thumb(e)},r);function r(){this.batch_thumb_loader=new o.BatchThumbLoader({})}t.BatchingThumbLoader=a}),define("modules/clean/react/takedown_warning",["require","exports","tslib","react","classnames","modules/constants/python","modules/core/i18n"],function(e,t,o,a,r,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TakedownWarning=void 0,a=o.__importDefault(a),r=o.__importDefault(r),t.TakedownWarning=function(e){e=e.takedownType;return a.default.createElement("div",{className:r.default("notify","server-success")},e===s.TakedownRequestTypes.DMCA?n.intl.formatMessage({id:"z8QPs2",defaultMessage:"Certain files in this folder canâ€™t be shared due to a takedown request in accordance with the DMCA. <a>Learn more</a>"},{a:function(e){return a.default.createElement("a",{target:"_top",href:"/help/210"},e)}}):n.intl.formatMessage({id:"KUyXWm",defaultMessage:"Certain files in this folder are unavailable. For more information <a>contact Dropbox support</a>."},{a:function(e){return a.default.createElement("a",{target:"_top",href:"/ticket"},e)}}))},t.TakedownWarning.displayName="TakedownWarning"}),define("modules/clean/react/thumbnail",["require","exports","tslib","classnames","react","modules/clean/photos/batching_thumb_store","spectrum/file_icon/index","modules/constants/python","modules/core/uri","modules/clean/file_store/utils"],function(e,t,o,s,n,a,i,r,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThumbnailIcon=void 0,s=o.__importDefault(s),n=o.__importDefault(n);var c,p=(a=o.__importDefault(a)).default(),o=(c=n.default.Component,o.__extends(d,c),d.prototype.componentDidMount=function(){this.bindThumbStore()},d.prototype.componentWillReceiveProps=function(e){e=e.file.thumbnail_url_tmpl;e!==this.props.file.thumbnail_url_tmpl&&this.setState(this.getStateForTemplateUrl(e))},d.prototype.componentWillUpdate=function(){this.unbindThumbStore()},d.prototype.componentDidUpdate=function(){this.bindThumbStore()},d.prototype.componentWillUnmount=function(){this.unbindThumbStore()},d.prototype.bindThumbStore=function(){var e,t=this;!this.state.isLoading||this.bindingId||(e=this.state.url)&&(this.bindingId=p.bind_url(e,{onSuccess:function(){t.setState({isLoading:!1,src:p.get_thumb(e)})},onError:function(){t.setState({isLoading:!1})}}))},d.prototype.unbindThumbStore=function(){this.bindingId&&(p.unbind_url(this.bindingId),this.bindingId=null)},d.prototype.getStateForTemplateUrl=function(e){var t=null;if(!e)return{isLoading:!1,src:null};e=d.getThumbnailUrl(e);return e&&(t=p.get_thumb(e)),{isLoading:!!e&&!t,src:t,url:e}},d.getThumbnailUrl=function(e){if(e){e=l.URI.parse(e);return e.updateQuery("size","178x178"),e.updateQuery("size_mode",r.THUMBNAIL_SIZE_MODE.EXACT.toString()),e.toString()}},d.prototype.render=function(){var e=this.props,t=e.alt,o=e.file,a=e.iconSize,r=e.className,e=this.state.src;return e?n.default.createElement("img",{alt:t,className:s.default(["icon","thumbnail-image--loaded",r]),src:e,onError:this.handleImageError}):n.default.createElement(i.FileIcon,{className:s.default(["icon","thumbnail-image--failed",r]),path:u.getFilename(o),variant:a})},d.displayName="ThumbnailIcon",d);function d(e){var t=c.call(this,e)||this;return t.bindingId=null,t.handleImageError=function(){t.setState({src:null})},t.state=t.getStateForTemplateUrl(t.props.file.thumbnail_url_tmpl),t}t.ThumbnailIcon=o}),define("modules/clean/auth/common/error",["require","exports","tslib","dompurify","react"],function(e,t,o,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthError=void 0,a=o.__importStar(a);var s,o=(s=(r=o.__importDefault(r)).default.Component,o.__extends(n,s),n.prototype.shouldComponentUpdate=function(e){return this.hasNewError(e.error)},n.prototype.hasNewError=function(e){return!this.hasMatchingErrorMessage(e)||(null==e?void 0:e.clientTimestamp)!==(null===(e=this.props.error)||void 0===e?void 0:e.clientTimestamp)},n.prototype.hasMatchingErrorMessage=function(e){var t;return(null==e?void 0:e.message_html)===(null===(t=this.props.error)||void 0===t?void 0:t.message_html)&&(null==e?void 0:e.message_text)===(null===(e=this.props.error)||void 0===e?void 0:e.message_text)},n.prototype.render=function(){var e=this.props.error;return e&&e.message_html?r.default.createElement("div",{className:"text-input-error-wrapper",dangerouslySetInnerHTML:{__html:a.sanitize(e.message_html)}}):e&&e.message_text?r.default.createElement("div",{className:"text-input-error-wrapper"},r.default.createElement("span",{className:"error-message","aria-live":"polite","aria-atomic":"true"},e.message_text,r.default.createElement("span",{className:"text-input-error-hidden ax-visually-hidden","aria-hidden":"true"},e.clientTimestamp))):r.default.createElement("div",{className:"text-input-error-wrapper"})},n);function n(){return null!==s&&s.apply(this,arguments)||this}t.AuthError=o}),define("modules/clean/auth/common/inputs/checkbox",["require","exports","tslib","dompurify","react","classnames","modules/clean/auth/common/error","modules/clean/auth/common/utils","modules/clean/auth/common/types","dig-components/text_fields","dig-components/controls","dig-components/icons","dig-components/icons/src"],function(e,t,p,l,d,m,g,o,h,u,c,f,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthCheckbox=void 0,l=p.__importStar(l),d=p.__importDefault(d),m=p.__importDefault(m);function S(e){var t=e.label,o=e.htmlFor,e=e.unsafeLabelHTML;return t?d.default.createElement("label",{htmlFor:o,className:"checkbox_label"},d.default.createElement("span",null,t)):e?d.default.createElement("label",{htmlFor:o,className:"checkbox_label"},d.default.createElement("span",{dangerouslySetInnerHTML:{__html:l.sanitize(e)}})):null}function b(e,t){var o=e.name,a=e.error,r=e.label,s=e.onChange,n=e.className,i=e.checked,e=a&&(a.message_text||a.message_html);return d.default.createElement("div",{className:"auth__checkbox-row"},d.default.createElement(u.FormRow,{variant:"control"},d.default.createElement(c.Checkbox,{className:n,name:o,id:t,onChange:s,checked:i,"aria-checked":i}),d.default.createElement(S,{htmlFor:t,label:r})),e&&d.default.createElement(u.FormHelperText,{isInvalid:!0},d.default.createElement(f.UIIcon,{src:_.FailLine,size:"small"}),null!=a&&a.message_html?d.default.createElement("span",{dangerouslySetInnerHTML:{__html:l.sanitize(a.message_html)}}):d.default.createElement("span",null,null==a?void 0:a.message_text)))}var a,r=(a=d.default.Component,p.__extends(s,a),s.prototype.render=function(){var e=this.props,t=e.checked,o=e.className,a=e.disabled,r=e.error,s=e.inline,n=e.label,i=e.maestroStyle,l=e.name,u=e.onChange,c=e.unsafeLabelHTML,e=e.variant;if(e===h.AuthFormVariant.DIG20)return d.default.createElement(b,p.__assign({},this.props));s=m.default("checkbox",e,o,{"checkbox-inline":s}),t=d.default.createElement("input",{type:"checkbox",id:this.id,name:l,checked:t,onChange:u,disabled:a,"aria-checked":t});i&&(t=d.default.createElement("label",{className:"maestro_checkbox",htmlFor:this.id},t,d.default.createElement("span",null)));r=d.default.createElement(g.AuthError,{error:r});return d.default.createElement("div",{className:s},!i&&r,t,d.default.createElement(S,{htmlFor:this.id,label:n,unsafeLabelHTML:c}),i&&r)},s);function s(e){var t=a.call(this,e)||this;return t.id=o.generateId(e.name),t}t.AuthCheckbox=r}),define("modules/clean/auth/common/inputs/text",["require","exports","tslib","classnames","react","dompurify","modules/core/i18n","classnames","modules/clean/auth/common/error","modules/clean/auth/common/types","modules/clean/auth/common/utils","modules/clean/components/password_strength_meter","dig-components/text_fields","dig-components/icons","dig-components/icons/src","modules/clean/react/input_dig"],function(e,t,o,s,i,l,n,u,a,c,r,p,d,m,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthTextField=void 0,s=o.__importDefault(s),i=o.__importDefault(i),l=o.__importStar(l),u=o.__importDefault(u);function f(e){var t=e.error&&(e.error.message_html||e.error.message_text),o=s.default("text-input-input",e.className,{"input-error":!!t,"numeric-input":e.type===c.AuthTextInputType.NUMBER}),a=e.passwordStrengthProps||{},r=n.intl.formatMessage({id:"/uvN/C",defaultMessage:"Good passwords are hard to guess. Use uncommon words or inside jokes, non-standard uPPercasing, creative spelllling, and non-obvious numbers and symbols"});return i.default.createElement("div",{className:"text-input-wrapper"},e.type===c.AuthTextInputType.PASSWORD&&e.measureStrength&&i.default.createElement(p.PasswordStrengthMeter,{password:e.value||"",zxcvbnPostTti:!0,className:e.variant,bubblePosition:a.position,bubbleDescription:a.description||r,bubbleClassName:a.className}),i.default.createElement("input",{id:e.id,type:e.type,className:o,name:e.name,value:e.value,onChange:e.onChange,disabled:e.disabled,autoFocus:e.autoFocus,autoComplete:e.autoComplete?"on":"off","aria-invalid":t?"true":"false",inputMode:e.type===c.AuthTextInputType.NUMBER?"numeric":"text",onKeyDown:e.type===c.AuthTextInputType.NUMBER?function(e){8===e.keyCode||46===e.keyCode||9===e.keyCode||13===e.keyCode||48<=e.keyCode&&e.keyCode<=57||96<=e.keyCode&&e.keyCode<=105||144===e.keyCode||37===e.keyCode||39===e.keyCode||e.preventDefault()}:void 0}),!e.value&&i.default.createElement("label",{htmlFor:e.id},e.placeholder))}function _(e){var t=e.disabled,o=e.name,a=e.placeholder,r=e.error,s=e.onChange,n=e.measureStrength,e=!(!r||!r.message_text&&!r.message_html);return i.default.createElement("div",{className:"auth__input-wrapper"},n?i.default.createElement(h.password,{name:"password",className:u.default("auth__password-input",{"is-invalid":!!e}),measureStrength:!0,placeholder:a,onChange:s}):i.default.createElement(d.TextInput,{disabled:t,isInvalid:!!e,name:o,value:t?a:void 0,onChange:s,placeholder:a,wrapperProps:{className:"auth__input-field"}}),e&&i.default.createElement(d.FormHelperText,{isInvalid:!0},i.default.createElement(m.UIIcon,{src:g.FailLine,size:"small"}),null!=r&&r.message_html?i.default.createElement("span",{dangerouslySetInnerHTML:{__html:l.sanitize(r.message_html)}}):i.default.createElement("span",null,null==r?void 0:r.message_text)))}var S,b=(S=i.default.Component,o.__extends(E,S),E.prototype.render=function(){if(this.props.variant===c.AuthFormVariant.DIG20)return i.default.createElement(_,o.__assign({},this.props));var e=this.props.maestroStyle?null:this.props.className,t=s.default("text-input",this.props.variant,e),e=i.default.createElement(a.AuthError,{error:this.props.error}),t=i.default.createElement("div",{className:t},!this.props.maestroStyle&&e,i.default.createElement(f,{id:this.id,name:this.props.name,onChange:this.props.onChange,value:this.props.value,disabled:this.props.disabled,className:this.props.inputClassName,error:this.props.error,variant:this.props.variant,type:this.props.type,placeholder:this.props.placeholder,measureStrength:this.props.measureStrength,passwordStrengthProps:this.props.passwordStrengthProps,autoComplete:this.props.autoComplete||!1,autoFocus:this.props.autoFocus||!1}),this.props.maestroStyle&&e);if(!this.props.maestroStyle)return t;e=s.default(this.props.className,{"register-form__name-field":"email"!==this.props.type&&"password"!==this.props.type,"register-form__field":"email"===this.props.type||"password"===this.props.type});return i.default.createElement("div",{className:e},this.props.label&&i.default.createElement("label",{className:"register-form__field-label",htmlFor:this.id},this.props.label),t)},E);function E(e){var t=S.call(this,e)||this;return t.id=r.generateId(e.name),t}t.AuthTextField=b}),define("modules/clean/auth/common/stats",["require","exports","tslib","modules/clean/analytics","modules/core/browser","modules/core/browser_detection","modules/core/exception","modules/clean/auth/login/types","modules/clean/metrics/index"],function(e,t,a,o,r,s,n,i,l){"use strict";var u,c;Object.defineProperty(t,"__esModule",{value:!0}),t.AppleUXAnalyticsLogger=t.GoogleUXAnalyticsLogger=t.EmailAuthUXAnalyticsLogger=t.AuthUXAnalyticsLogger=t.AuthAMPLogger=t.AuthType=void 0,r=a.__importStar(r),s=a.__importStar(s),(c=u=t.AuthType||(t.AuthType={})).CREDENTIALS="email",c.GOOGLE="google_auth",c.APPLE="apple_auth";var p=new Set(["form_error","user_exists","access_denied","tfa_required","sso_required","emails_do_not_match_redirect"]),d=new Set(["enable_twofactor_required","emails_do_not_match","emails_do_not_match_redirect","not_verified","email_not_verified","google_login_not_allowed","access_denied","disabled_account","tos_required","sso_required","no_email_in_response","requires_password_on_first_link","apple_login_not_allowed","apple_login_not_allowed_for_teams","user_cancelled_authorize"]);function m(e){return{url:r.get_href(),status:e.status||void 0}}function g(e){return{url:r.get_href(),remember_me:e.remember_me?e.remember_me.toString():void 0,pair_user:e.pair_user?e.pair_user.toString():void 0,err_msg:e.err_msg||void 0}}function h(e,t){return e&&t.has(e)?e:"unknown"}function f(e,t,o){void 0===o&&(o=1);try{l.getMetricsReporter().createStats({ns:"web_auth",name:e},a.__assign(a.__assign({},t),{browser:function(){for(var e="other",t=0,o=[[s.chrome,"chrome"],[s.edge,"edge"],[s.mozilla,"firefox"],[s.msie,"msie"],[s.safari,"safari"]];t<o.length;t++){var a=o[t],r=a[0],a=a[1];if(r){e=a;break}}return e}()})).record(o)}catch(o){n.reportException({err:o,severity:n.SEVERITY.NONCRITICAL,tags:["web_auth_amp_logging","acquisition_eng"],exc_extra:a.__assign({metricName:e},t)})}}function _(e,t){o.UXAnalyticsLogger.log(e,t)}t.AuthAMPLogger={logSignupIntent:function(){f("signup/intent",{},1)},logSignupAttempt:function(e){f("signup/attempt",{authType:e},1)},logSignupResponse:function(e,t,o){"funcaptcha_response"!==o?t?f("signup/success",{authType:e},1):(f("signup/success",{authType:e},0),f("signup/failure",{authType:e,error:h(o,p)},1)):f("signup/failure",{authType:e,error:o},1)},logLoginIntent:function(e){f("login/intent",{loginType:e||"normal"},1)},logLoginAttempt:function(e,t){f("login/attempt",{authType:e,loginType:t||"normal"},1)},logCredentialsLoginResponse:function(e,t){var o=u.CREDENTIALS,e=e||"normal";if("funcaptcha_response"!==t)if(t===i.LoginResponseStatus.OK||t===i.LoginResponseStatus.TWOFACTOR)f("login/success",{authType:o,loginType:e},1);else{var a=void 0;switch(t){case i.LoginResponseStatus.TOS_SIGNATURE_REQUIRED:a="tos_required";break;case i.LoginResponseStatus.SSO:a="sso_required";break;case i.LoginResponseStatus.TWOFACTOR_REQUIRED:a="enable_twofactor_required";break;case i.LoginResponseStatus.RATELIMIT:a="rate_limited";break;case i.LoginResponseStatus.EXPIRED:a="login_expired";break;case i.LoginResponseStatus.PASSWORD_EXPIRED:a="password_expired";break;case i.LoginResponseStatus.PASSWORD_DECRYPTION_ERROR:a="password_descryption_error";break;case i.LoginResponseStatus.ERROR:a="generic_error";break;case"form_error":a=t;break;default:a="unknown"}f("login/success",{authType:o,loginType:e},0),f("login/failure",{authType:o,loginType:e,error:a},1)}else f("login/failure",{authType:o,loginType:e,error:t},1)},logThirdPartyLoginResponse:function(e,t,o,a){t=t||"normal";o||"tfa_required"===a?f("login/success",{authType:e,loginType:t},1):(f("login/success",{authType:e,loginType:t},0),f("login/failure",{authType:e,loginType:t,error:h(a,d)},1))},log2faResponse:function(e,t){e=e||"normal";if(t===i.LoginResponseStatus.OK)f("2fa/success",{loginType:e},1);else{var o=void 0;switch(t){case i.LoginResponseStatus.REQUIRES_ROLE:o="requires_role";break;case i.LoginResponseStatus.EXPIRED:o="twofactor_expired";break;case i.LoginResponseStatus.INVALID_CREDENTIALS:o="invalid_credentials";break;case i.LoginResponseStatus.ERROR:o="generic_error";break;case"u2f_error":case"code_error":o=t;break;default:o="unknown"}f("2fa/success",{loginType:e},0),f("2fa/failure",{loginType:e,error:o},1)}}},t.AuthUXAnalyticsLogger={logSignupModalShown:function(e){_("signup_modal_shown",{url:r.get_href(),kind:e})},logLoginModalShown:function(e){_("login_modal_shown",{url:r.get_href(),kind:e})},logSignupModalDismissed:function(e){_("signup_modal_dismissed",{url:r.get_href(),kind:e})},logLoginModalDismissed:function(e){_("login_modal_dismissed",{url:r.get_href(),kind:e})}},t.EmailAuthUXAnalyticsLogger={logLoginStart:function(){_("email_login_start",{url:r.get_href()})},logSplitSignupContinue:function(){_("email_split_signup_continue",{url:r.get_href()})},logLoginResponse:function(e){switch(e.status){case i.LoginResponseStatus.OK:_("email_login_succeeded",m(e));break;case i.LoginResponseStatus.TWOFACTOR:_("email_login_requires_two_factor",m(e));break;case i.LoginResponseStatus.TWOFACTOR_REQUIRED:case i.LoginResponseStatus.TOS_SIGNATURE_REQUIRED:case i.LoginResponseStatus.EXPIRED:case i.LoginResponseStatus.SSO:_("email_login_redirect",m(e));break;default:_("email_login_failed",m(e))}},logLoginError:function(){_("email_login_failed",{url:r.get_href()})},logSignupStart:function(){_("email_signup_start",{url:r.get_href()})},logSignupResponse:function(){_("email_signup_succeeded",{url:r.get_href()})},logSignupError:function(){_("email_signup_failed",{url:r.get_href()})}},t.GoogleUXAnalyticsLogger={logLoginStart:function(){_("google_login_start",{url:r.get_href()})},logLoginResponse:function(e){e.success?_("google_login_succeeded",g(e)):"tfa_required"===e.err_msg?_("google_login_requires_two_factor",g(e)):_("google_login_failed",g(e))},logSignupStart:function(){_("google_signup_start",{url:r.get_href()})},logSignupResponse:function(e){e.success?_("google_signup_succeeded",g(e)):_("google_signup_failed",g(e))}},t.AppleUXAnalyticsLogger={logLoginStart:function(){_("sia_login_start",{url:r.get_href()})},logLoginResponse:function(e){e.success?_("sia_login_succeeded",g(e)):"tfa_required"===e.err_msg?_("sia_login_requires_two_factor",g(e)):"requires_password_on_first_link"===e.err_msg?_("sia_login_requires_password",g(e)):_("sia_login_failed",g(e))}}}),define("modules/clean/auth/common/types",["require","exports"],function(e,t){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.AuthFormVariant=t.AuthButtonVariant=t.AuthTextInputType=void 0,(o=t.AuthTextInputType||(t.AuthTextInputType={})).EMAIL="email",o.PASSWORD="password",o.TEXT="text",o.NUMBER="number",(o=t.AuthButtonVariant||(t.AuthButtonVariant={})).BIG="big",o.SMALL="small",o.STANDARD="standard",(t=t.AuthFormVariant||(t.AuthFormVariant={})).PAPER_COMPACT="paper-compact",t.SMALL="small",t.STANDARD="standard",t.DIG20="dig20"}),define("modules/clean/auth/login/2fa/authenticator_form",["require","exports","tslib","classnames","react","modules/core/i18n","modules/clean/auth/common/inputs/text","modules/clean/auth/common/types","modules/clean/auth/common/utils","modules/clean/auth/login/2fa/trust_checkbox"],function(e,t,o,a,r,s,n,i,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Authenticator2FAForm=void 0,a=o.__importDefault(a),r=o.__importDefault(r),t.Authenticator2FAForm=function(e){var t=r.default.createElement("button",{className:a.default("mc-button mc-button-primary",{"inline-submit":e.inlineSubmit,"login-button":!e.inlineSubmit}),type:"submit"},s.intl.formatMessage({id:"K57Ot6",defaultMessage:"Enter"}));return r.default.createElement("form",{className:"two-factor-form clearfix 2fa-phone-form",onSubmit:e.onSubmit},e.displayHeader&&r.default.createElement("div",{className:"login-header"},s.intl.formatMessage({id:"FFqVaU",defaultMessage:"Enter Dropbox 2-step verification code"})),r.default.createElement("div",{className:"login-info two-factor-uses-authenticator"},s.intl.formatMessage({id:"sufs69",defaultMessage:"Enter the code generated by your authenticator app."})),r.default.createElement("div",{className:a.default({"inline-input-submit-pair":e.inlineSubmit,"backup-verification-code-form":e.inlineSubmit})},r.default.createElement(n.AuthTextField,{className:"login-text-input inline-input",disabled:!1,error:e.error,maestroStyle:e.maestroStyle,name:"code",onChange:e.onInputChange,value:e.value,placeholder:s.intl.formatMessage({id:"DFLqLE",defaultMessage:"6-digit code"}),type:i.AuthTextInputType.NUMBER,variant:e.variant,autoFocus:!0,autoComplete:!1}),e.inlineSubmit&&t),!e.hideTrustCheckbox&&r.default.createElement(u.TwoFactorTrustCheckbox,{checked:e.trusted,maestroStyle:e.maestroStyle,onChange:e.onInputChange,tooltipPosition:e.trustTooltipPosition,variant:e.variant}),!e.inlineSubmit&&t,!e.hideHelp&&r.default.createElement("div",{className:"two-factor-need-help"},r.default.createElement("a",{href:l.twoFactorRecoveryUrl(e.rememberMe,e.continuationUrl),className:"twofactor_recovery_url"},s.intl.formatMessage({id:"gR0Vz1",defaultMessage:"Having trouble getting a code?"}))))}}),define("modules/clean/auth/login/2fa/email_form",["require","exports","tslib","classnames","react","modules/core/i18n","modules/clean/auth/common/inputs/text","modules/clean/auth/common/types"],function(e,t,o,a,r,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Email2FAForm=void 0,a=o.__importDefault(a),r=o.__importDefault(r),t.Email2FAForm=function(e){var t=r.default.createElement("button",{className:a.default("mc-button mc-button-primary",{"inline-submit":e.inlineSubmit,"login-button":!e.inlineSubmit}),type:"submit"},s.intl.formatMessage({id:"K57Ot6",defaultMessage:"Enter"}));return r.default.createElement("form",{className:"two-factor-form clearfix 2fa-email-form",onSubmit:e.onSubmit},e.displayHeader&&r.default.createElement("div",{className:"login-header"},s.intl.formatMessage({id:"FFqVaU",defaultMessage:"Enter Dropbox 2-step verification code"})),r.default.createElement("div",{className:"login-info two-factor-uses-email"},s.intl.formatMessage({id:"FuPzY9",defaultMessage:"We sent a code to {email} and any devices youâ€™ve linked to this account. Enter the code to continue."},{span:function(e){return r.default.createElement("span",{className:"tfa-email"},e)},email:e.email})),r.default.createElement("div",{className:a.default({"inline-input-submit-pair":e.inlineSubmit,"backup-verification-code-form":e.inlineSubmit})},r.default.createElement(n.AuthTextField,{className:"login-text-input inline-input",disabled:!1,error:e.error,maestroStyle:e.maestroStyle,name:"code",onChange:e.onInputChange,value:e.value,placeholder:s.intl.formatMessage({id:"DFLqLE",defaultMessage:"6-digit code"}),type:i.AuthTextInputType.NUMBER,variant:e.variant,autoFocus:!0,autoComplete:!1}),e.inlineSubmit&&t),!e.inlineSubmit&&t,r.default.createElement("div",{className:"two-factor-need-help"},r.default.createElement("a",{href:"#",onClick:e.onResendCodeClick,className:"resend-two-factor-code two-factor-uses-sms"},s.intl.formatMessage({id:"HTy4qW",defaultMessage:"Resend code"}))))}}),define("modules/clean/auth/login/2fa/phone_form",["require","exports","tslib","classnames","react","modules/core/i18n","modules/clean/auth/common/inputs/text","modules/clean/auth/common/types","modules/clean/auth/common/utils","modules/clean/auth/login/2fa/trust_checkbox"],function(e,t,o,a,r,s,n,i,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Phone2FAForm=void 0,a=o.__importDefault(a),r=o.__importDefault(r),t.Phone2FAForm=function(e){var t=r.default.createElement("button",{className:a.default("mc-button mc-button-primary",{"inline-submit":e.inlineSubmit,"login-button":!e.inlineSubmit}),type:"submit"},s.intl.formatMessage({id:"K57Ot6",defaultMessage:"Enter"}));return r.default.createElement("form",{className:"two-factor-form clearfix 2fa-phone-form",onSubmit:e.onSubmit},e.displayHeader&&r.default.createElement("div",{className:"login-header"},s.intl.formatMessage({id:"FFqVaU",defaultMessage:"Enter Dropbox 2-step verification code"})),r.default.createElement("div",{className:"login-info two-factor-uses-sms"},s.intl.formatMessage({id:"lWPbUP",defaultMessage:"We sent a code to your phone number ending in <span>{last_two_digits}</span>."},{span:function(e){return r.default.createElement("span",{className:"last-two-digits"},e)},last_two_digits:e.lastTwoDigits})),r.default.createElement("div",{className:a.default({"inline-input-submit-pair":e.inlineSubmit,"backup-verification-code-form":e.inlineSubmit})},r.default.createElement(n.AuthTextField,{className:"login-text-input inline-input",disabled:!1,error:e.error,maestroStyle:e.maestroStyle,name:"code",onChange:e.onInputChange,value:e.value,placeholder:s.intl.formatMessage({id:"DFLqLE",defaultMessage:"6-digit code"}),type:i.AuthTextInputType.NUMBER,variant:e.variant,autoFocus:!0,autoComplete:!1}),e.inlineSubmit&&t),!e.hideTrustCheckbox&&r.default.createElement(u.TwoFactorTrustCheckbox,{checked:e.trusted,maestroStyle:e.maestroStyle,onChange:e.onInputChange,tooltipPosition:e.trustTooltipPosition,variant:e.variant}),!e.inlineSubmit&&t,!e.hideHelp&&r.default.createElement("div",{className:"two-factor-need-help"},r.default.createElement("a",{href:"#",onClick:e.onResendCodeClick,className:"resend-two-factor-code two-factor-uses-sms"},s.intl.formatMessage({id:"HTy4qW",defaultMessage:"Resend code"})),r.default.createElement("a",{href:l.twoFactorRecoveryUrl(e.rememberMe,e.continuationUrl),className:"twofactor_recovery_url"},s.intl.formatMessage({id:"gR0Vz1",defaultMessage:"Having trouble getting a code?"}))))}}),define("modules/clean/auth/login/2fa/seckey_form",["require","exports","tslib","react","modules/core/i18n","modules/clean/auth/login/2fa/trust_checkbox","modules/clean/auth/login/types","modules/clean/react/image","modules/clean/react/sprite","modules/clean/static_urls"],function(e,t,o,a,r,s,n,i,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SecKey2FAForm=void 0,a=o.__importDefault(a);function c(){return a.default.createElement(i.Image,{src:u.static_url("/static/images/security_keys/insert-vflkCfC4_.png"),srcHiRes:u.static_url("/static/images/security_keys/insert@2x-vflTxG2RJ.png"),className:"seckey-insert"})}function p(){return a.default.createElement(i.Image,{src:u.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),srcHiRes:u.static_url("/static/images/icons/ajax-loading-small@2x-vflAxdZTP.gif"),className:"seckey-loading-status"})}function d(e){return a.default.createElement("div",{className:"two-factor-seckey-instructions"},a.default.createElement("p",null,a.default.createElement("span",{style:{fontWeight:"bold"}},r.intl.formatMessage({id:"DljPpW",defaultMessage:"Insert your security key to use it"}))," ",e.securityKeyState===n.SecurityKeyState.LOADING&&a.default.createElement(p,null),e.securityKeyState===n.SecurityKeyState.FOUND&&a.default.createElement(m,null)),r.intl.formatMessage({id:"eonxEJ",defaultMessage:"After inserting, tap your key if it has a button or gold disk."}))}function m(){return a.default.createElement(l.Sprite,{group:"web",name:"bulletpoint-check",alt:"",className:"seckey-loading-status"})}t.SecKey2FAForm=function(e){return a.default.createElement("form",{className:"two-factor-form clearfix 2fa-seckey-form"},e.displayHeader&&a.default.createElement("div",{className:"login-header"},r.intl.formatMessage({id:"FFqVaU",defaultMessage:"Enter Dropbox 2-step verification code"})),a.default.createElement("div",{className:"login-info two-factor-uses-u2f"},a.default.createElement(c,null),e.securityKeyState!==n.SecurityKeyState.NOT_FOUND&&a.default.createElement(d,{securityKeyState:e.securityKeyState}),a.default.createElement("div",{className:"text-input"},a.default.createElement("div",{className:"text-input-error-wrapper"})),e.securityKeyState===n.SecurityKeyState.NOT_FOUND&&a.default.createElement("div",{className:"two-factor-seckey-instructions"},a.default.createElement("div",{style:{color:"red"}},a.default.createElement("span",{className:"error-msg"},e.error||r.intl.formatMessage({id:"uqQwD8",defaultMessage:"Key not found."}))),a.default.createElement("button",{className:"button-tertiary two-factor-seckey-retry",onClick:e.onRetry},r.intl.formatMessage({id:"n1zYou",defaultMessage:"Retry"}))),!e.hideTrustCheckbox&&a.default.createElement(s.TwoFactorTrustCheckbox,{checked:e.trusted,maestroStyle:e.maestroStyle,onChange:e.onInputChange,tooltipPosition:e.trustTooltipPosition,variant:e.variant}),a.default.createElement("div",{className:"two-factor-use-phone-instead"},a.default.createElement("a",{href:"#",onClick:e.onChange2FA},e.secondaryTwoFactorType===n.TwoFactorType.SMS?r.intl.formatMessage({id:"cDmyI0",defaultMessage:"Send SMS instead"}):r.intl.formatMessage({id:"yzAIpy",defaultMessage:"Use mobile authenticator instead"})))))}}),define("modules/clean/auth/login/2fa/trust_checkbox",["require","exports","tslib","react","modules/core/browser_detection","modules/core/i18n","modules/clean/auth/common/inputs/checkbox","modules/clean/react/sprite_div","modules/clean/react/tooltip"],function(e,t,o,a,r,s,n,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestOnlyTrustTooltipContent=t.TwoFactorTrustCheckbox=void 0,a=o.__importDefault(a),r=o.__importStar(r),i=o.__importDefault(i),l=o.__importStar(l);function u(){return a.default.createElement("div",{className:"two-factor-trusted-info"},r.is_mobile_or_tablet()?s.intl.formatMessage({id:"UkQZnd",defaultMessage:"Trusted devices will never ask you for a security code again. You should only trust this device if you trust everyone who uses it."}):s.intl.formatMessage({id:"UraGyT",defaultMessage:"Trusted computers will never ask you for a security code again. You should only trust this computer if you trust everyone who uses it."}))}t.TestOnlyTrustTooltipContent=u;function c(e){return a.default.createElement("div",{className:"tooltip-wrapper info-icon"},a.default.createElement(l.Tooltip,{position:l.TooltipPosition[e.position||"TOP"],tooltip_classname:"twofactor-trust-tooltip",tooltip_contents:a.default.createElement(u,null)},a.default.createElement(i.default,{group:"web",name:"info",alt:s.intl.formatMessage({id:"+SX5vq",defaultMessage:"More information"}),text:r.is_mobile_or_tablet()?s.intl.formatMessage({id:"+79s4f",defaultMessage:"Trust this device"}):s.intl.formatMessage({id:"Ey/8Q8",defaultMessage:"Trust this computer"}),spritePosition:"right"})))}t.TwoFactorTrustCheckbox=function(e){return a.default.createElement(n.AuthCheckbox,{className:"remember-me",name:"trusted",checked:e.checked,inline:!0,disabled:!1,maestroStyle:e.maestroStyle,onChange:e.onChange,variant:e.variant,label:a.default.createElement(c,{position:e.tooltipPosition})})}}),define("modules/clean/auth/login/api",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_as_promised_jquery","api_v2/default_user_client","modules/clean/auth/login/types","modules/clean/viewer","modules/core/exception","modules/core/i18n"],function(e,t,s,n,o,i,a,l,r){"use strict";function u(){var e=a.Viewer.get_viewer().get_users()[0];return l.assert(null!=e,"Expect user is logged in when pairing"),new o.DefaultUserApiV2Client(e)}function c(e){var t;return null!==(t=null==e?void 0:e.error)&&void 0!==t&&t[".tag"]?{status:i.LoginResponseStatus.ERROR,html_response:!1,message:e.message}:{status:i.LoginResponseStatus.ERROR,html_response:!1,message:r.intl.formatMessage({id:"vuVMnM",defaultMessage:"Something went wrong."})}}function p(r){return s.__awaiter(this,void 0,Promise,function(){var t,o,a;return s.__generator(this,function(e){switch(e.label){case 0:o=r.login_email,a=r.encrypted_password,l.assert(null!=o&&null!=a,"Expect login email and password not null"),t=u(),o={login_email:o,encrypted_password:a,remember_me:r.remember_me},e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.ns("team").rpc("account_pair_login",o,{})];case 2:return(a=e.sent()).two_factor_request?[2,a.two_factor_request]:[2,a];case 3:return[2,c(e.sent())];case 4:return[2]}})})}function d(r){return s.__awaiter(this,void 0,Promise,function(){var t,o,a;return s.__generator(this,function(e){switch(e.label){case 0:t=r.checkpoint_token,a=r.code,l.assert(null!=t&&null!=a,"Expect checkpoint token and code not null"),o=u(),a={checkpoint_token:t,code:a,remember_me:r.remember_me},e.label=1;case 1:return e.trys.push([1,3,,4]),[4,o.ns("team").rpc("account_pair_two_factor_login",a,{})];case 2:return[2,e.sent()];case 3:return[2,c(e.sent())];case 4:return[2]}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.submitTwoFactorForm=t.retryU2fAuthentication=t.resendTwoFactorCode=t.submitCredentialsForm=t.accountPairTwoFactorLogin=t.accountPairLogin=t.checkSsoState=void 0,n=s.__importStar(n),t.checkSsoState=function(e){return new Promise(function(t){return n.WebRequest({url:"/sso_state",data:{email:e},success:function(e){return t(JSON.parse(e))}})})},t.accountPairLogin=p,t.accountPairTwoFactorLogin=d,t.submitCredentialsForm=function(e,t){var o;switch(e){case"multi":o="/ajax_multi_login";break;case"pairing":o="/team/join/new_pair_login_ajax";break;case"cli_link_nonce":o="/cli_link_nonce";break;case"bidirectional_pair":return p(t);default:o="/ajax_login"}return new Promise(function(a,r){return n.WebRequest({url:o,type:"POST",data:t,success:function(e){a(JSON.parse(e))},error:function(e,t,o){"{"!==o[0]&&-1===o.indexOf(":")?a({status:i.LoginResponseStatus.ERROR,html_response:!1,message:o}):r(JSON.parse(o))}})})},t.resendTwoFactorCode=function(o,a){return new Promise(function(e,t){return n.WebRequest({url:"/twofactor_resend",data:{backup:o,mobile_push:a},success:e,error:t})})},t.retryU2fAuthentication=function(){return new Promise(function(e,t){return n.WebRequest({url:"/account/twofactor/u2f_start_authentication",success:e,error:t})})},t.submitTwoFactorForm=function(e,o){var r;switch(e){case"multi":r="/ajax_multi_verify_code";break;case"pairing":r="/team/join/new_pair_login_ajax";break;case"cli_link_nonce":r="/cli_link_twofactor";break;case"admin":r="/admin/login/twofactor";break;case"bidirectional_pair":return d(o);default:r="/ajax_verify_code"}return new Promise(function(t,a){return n.WebRequest({url:r,type:"POST",data:o,success:function(e){return t(JSON.parse(e))},error:function(e,t,o){return a(JSON.parse(o))}})})}}),define("modules/clean/auth/login/apple_login_button",["require","exports","tslib","react","classnames","modules/core/i18n","modules/clean/auth/login/login_error"],function(e,t,o,r,s,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppleLoginButton=void 0,r=o.__importDefault(r),s=o.__importDefault(s),t.AppleLoginButton=function(e){var t=e.buttonProps||{},o=s.default("auth-apple","button-primary",t.className),a=t.text||n.intl.formatMessage({id:"pTMcB4",defaultMessage:"Sign in with Apple"});return r.default.createElement("div",{className:"login-form-container__apple-div"},r.default.createElement("button",{className:o,onClick:e.onClick,type:"button",disabled:e.disabled||t.disabled,"data-uxa-log":"sia_login_start"},r.default.createElement("div",{className:"sign-in-text"},a)),e.error&&r.default.createElement(i.LoginError,{className:"apple-login-error",message:e.error}))}}),define("modules/clean/auth/login/credentials_form",["require","exports","tslib","classnames","react","modules/core/browser_detection","modules/core/i18n","modules/clean/auth/common/inputs/checkbox","modules/clean/auth/common/inputs/text","modules/clean/auth/common/types","modules/clean/auth/common/captcha","modules/clean/auth/login/login_error","modules/clean/auth/login/google_login_button","modules/clean/auth/login/apple_login_button","modules/clean/auth/login/types","modules/clean/react/image","modules/clean/react/sprite_div","modules/clean/static_urls","modules/clean/react/file_viewer/conversions/conversion_utils"],function(e,t,o,E,y,T,v,w,a,L,C,A,R,F,N,r,s,n,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginCredentialsForm=void 0,E=o.__importDefault(E),y=o.__importDefault(y),s=o.__importDefault(s);function I(e){var t="/forgot",o=e.target;return e.appendEmail&&(t="/forgot?email_from_login="+e.email,o=void 0),y.default.createElement("a",{className:"forgot-password-link",href:t,target:o},e.text||v.intl.formatMessage({id:"ovBgtz",defaultMessage:"Forgot your password?"}))}function M(e){return y.default.createElement("div",{id:"navisite"},y.default.createElement("br",null),y.default.createElement("a",{href:"/navi_redirect/login",target:e.openLinkInNewTab?"_blank":void 0},v.intl.formatMessage({id:"vnuqfB",defaultMessage:"Dropbox NAVI"})))}function k(e){return y.default.createElement("div",{className:"sso-optout"},v.intl.formatMessage({id:"F1g1bb",defaultMessage:"or"})," ",y.default.createElement("a",{href:"#",onClick:e.onClick},v.intl.formatMessage({id:"fRMS5E",defaultMessage:"Log in with Dropbox credentials"})))}function P(){return y.default.createElement("span",{className:"login-loading-indicator ajax-loading"},y.default.createElement(r.Image,{src:n.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),srcHiRes:n.static_url("/static/images/icons/ajax-loading-small@2x-vflAxdZTP.gif")}))}function x(){return y.default.createElement("div",{className:"sso-description"},y.default.createElement(s.default,{group:"web",name:"lock",text:v.intl.formatMessage({id:"WH73xS",defaultMessage:"Single sign-on enabled"})}))}function D(e){return y.default.createElement("div",{className:"credentials-form__fields"},y.default.createElement(a.AuthTextField,{value:e.emailValue,className:E.default("login-text-input","login-email",e.emailProps.className),onChange:e.onInputChange,disabled:e.disabled||e.emailProps.readonly||!1,label:e.emailProps.label||(e.maestroStyle?v.intl.formatMessage({id:"hK3Vsp",defaultMessage:"Email"}):void 0),placeholder:e.emailProps.placeholder||(e.maestroStyle?v.intl.formatMessage({id:"mx5U0y",defaultMessage:"you@mail.com"}):v.intl.formatMessage({id:"hK3Vsp",defaultMessage:"Email"})),error:e.emailError,maestroStyle:e.maestroStyle,name:"login_email",type:L.AuthTextInputType.EMAIL,variant:e.variant}),e.ssoState===N.SsoState.OFF&&y.default.createElement(a.AuthTextField,{value:e.passwordValue,placeholder:e.passwordProps.placeholder||(e.maestroStyle?v.intl.formatMessage({id:"JtdF1I",defaultMessage:"Your password"}):v.intl.formatMessage({id:"i+PJQ7",defaultMessage:"Password"})),name:"login_password",className:E.default("login-text-input","login-password",e.passwordProps.className),error:e.passwordError,inputClassName:"password-input",onChange:e.onInputChange,measureStrength:!1,label:e.passwordProps.label||(e.maestroStyle?v.intl.formatMessage({id:"i+PJQ7",defaultMessage:"Password"}):void 0),maestroStyle:e.maestroStyle,disabled:e.disabled,variant:e.variant,type:L.AuthTextInputType.PASSWORD}))}var i,o=(i=y.default.Component,o.__extends(l,i),l.prototype.render=function(){var e,t,o=this.props.rememberMeProps||{},a=this.props.googleLoginProps,r=this.props.appleLoginProps,s=E.default({clearfix:!this.props.hideRememberMe||!this.props.hideHelp&&T.is_supported_mobile_browser()}),n=this.props.openLinksInNewTab?"_blank":void 0,i=E.default("clearfix","credentials-form","login-form",{"sso-required":this.props.ssoState!==N.SsoState.OFF,"sso-optional":this.props.ssoState===N.SsoState.OPTIONAL}),l=a&&a.positionBelow,u=a&&!a.positionBelow,c=r&&r.positionBelow,p=r&&!r.positionBelow,d=l||c,m=u||p,g=a?y.default.createElement(R.GoogleLoginButton,{buttonProps:a.buttonProps,disabled:this.props.disabled||this.props.isSubmitting,error:this.props.googleLoginError,onClick:this.props.onGoogleLoginClick,variant:this.props.variant}):null,h=r?y.default.createElement(F.AppleLoginButton,{buttonProps:r.buttonProps,disabled:this.props.disabled||this.props.isSubmitting,error:this.props.appleLoginError,onClick:this.props.onAppleLoginClick}):null,f=this.props.hideHelp||this.props.ssoState===N.SsoState.REQUIRED?null:y.default.createElement(I,{email:this.props.emailValue,target:n,appendEmail:void 0===this.props.forgotPasswordProps.appendEmail||this.props.forgotPasswordProps.appendEmail,text:this.props.forgotPasswordProps.text}),_=y.default.createElement("button",{className:E.default("login-button","signin-button","button-primary",this.props.loginButtonProps.className),type:"submit",disabled:this.props.disabled||this.props.isSubmitting||this.props.loginButtonProps.disabled},this.props.ssoState===N.SsoState.OFF&&y.default.createElement("div",{className:"signin-text"},this.props.loginButtonProps.text||v.intl.formatMessage({id:"raLp6W",defaultMessage:"Sign in"})),this.props.ssoState!==N.SsoState.OFF&&y.default.createElement("div",{className:"sso-text"},v.intl.formatMessage({id:"LgJiOW",defaultMessage:"Continue"}))),S=y.default.createElement("div",{className:"hr-label"},y.default.createElement("span",{className:"hr-label__text"},v.intl.formatMessage({id:"F1g1bb",defaultMessage:"or"}))),b=this.props.variant===L.AuthFormVariant.PAPER_COMPACT,a=O.shouldShowSimplifiedModal(),r=this.props.isPaperLogin;return(n=e=e||{})[n.INLINE_WITH_LOGIN_BUTTON=0]="INLINE_WITH_LOGIN_BUTTON",n[n.ON_NEW_LINE=1]="ON_NEW_LINE",n[n.BELOW_FORM=2]="BELOW_FORM",d||b?r&&!b?t=e.BELOW_FORM:b||a?t=e.INLINE_WITH_LOGIN_BUTTON:!d||b||a||(t=e.BELOW_FORM):t=e.ON_NEW_LINE,y.default.createElement("div",{className:"login-form-container--subcontainer"},u&&g,p&&h,m&&!this.props.hideCredentialFields&&S,y.default.createElement("form",{className:i,onSubmit:this.props.onLoginClick,method:"POST"},!this.props.hideCredentialFields&&y.default.createElement(D,{disabled:this.props.disabled,emailError:this.props.emailError,emailProps:this.props.emailProps,emailValue:this.props.emailValue,maestroStyle:this.props.maestroStyle,onInputChange:this.props.onInputChange,passwordError:this.props.passwordError,passwordProps:this.props.passwordProps,passwordValue:this.props.passwordValue,ssoState:this.props.ssoState,variant:this.props.variant}),this.props.loginError&&y.default.createElement(A.LoginError,{message:this.props.loginError}),this.props.supportsCaptcha&&!a&&y.default.createElement(C.Captcha,{ref:this.setCaptchaComponent,email:this.props.emailValue,onSubmit:this.props.onSubmit,onReady:this.props.onCaptchaReady,source:"LOGIN"}),y.default.createElement("div",{className:s},this.props.ssoState!==N.SsoState.OFF&&y.default.createElement(x,null),!this.props.hideRememberMe&&y.default.createElement(w.AuthCheckbox,{checked:this.props.rememberMeValue,className:"remember-me",disabled:o.disabled||this.props.disabled,inline:void 0===o.inline||o.inline,label:o.label||v.intl.formatMessage({id:"ztezCK",defaultMessage:"Remember me"}),maestroStyle:this.props.maestroStyle,name:"remember_me",onChange:this.props.onInputChange,variant:this.props.variant}),t===e.INLINE_WITH_LOGIN_BUTTON&&f,!b&&!this.props.hideCredentialFields&&_,this.props.isSubmitting&&y.default.createElement(P,null),this.props.ssoState===N.SsoState.OPTIONAL&&y.default.createElement(k,{onClick:this.props.onSsoChangeClick}),t===e.ON_NEW_LINE&&y.default.createElement("div",{className:"login-need-help"},f),this.props.showNaviSiteLogin&&y.default.createElement(M,{openLinkInNewTab:this.props.openLinksInNewTab}),b&&_)),d&&!this.props.hideCredentialFields&&!a&&S,l&&g,c&&h,t===e.BELOW_FORM&&y.default.createElement("div",{className:"login-need-help"},f),this.props.supportsCaptcha&&a&&y.default.createElement(C.Captcha,{ref:this.setCaptchaComponent,email:this.props.emailValue,onSubmit:this.props.onSubmit,onReady:this.props.onCaptchaReady,source:"LOGIN"}))},l);function l(){var t=null!==i&&i.apply(this,arguments)||this;return t.setCaptchaComponent=function(e){t.captchaComponent=e},t.getCaptchaResponses=function(){return t.props.supportsCaptcha?C.get_captcha_responses(t.captchaComponent):{}},t.handleCaptchaErrors=function(e){return!!t.props.supportsCaptcha&&C.handle_captcha_errors(t.captchaComponent,e)},t.submitRecaptcha=function(){t.props.supportsCaptcha?t.captchaComponent.getWrappedComponent().submit():t.props.onSubmit()},t}t.LoginCredentialsForm=o}),define("modules/clean/auth/login/form",["require","exports","tslib","classnames","react","modules/core/browser","modules/core/exception","modules/core/html","modules/core/notify","modules/core/uri","modules/clean/auth/common/types","modules/clean/auth/common/utils","modules/clean/auth/login/2fa/authenticator_form","modules/clean/auth/login/2fa/email_form","modules/clean/marketing_tracker","modules/clean/auth/login/2fa/phone_form","modules/clean/auth/login/2fa/seckey_form","modules/clean/auth/login/api","modules/clean/auth/login/credentials_form","modules/clean/auth/login/sso_utils","modules/clean/auth/login/types","modules/clean/react/components/css","modules/core/i18n","modules/clean/profile_services/profile_services_constants","modules/clean/profile_services/profile_services_link","modules/clean/auth/authenticator","modules/clean/security/passwords","modules/clean/auth/common/stats","modules/clean/react/fedramp/fedramp_util"],function(e,t,i,r,l,u,c,p,d,m,g,h,s,n,o,f,_,S,b,E,y,a,T,v,w,L,C,A,R){"use strict";var F;Object.defineProperty(t,"__esModule",{value:!0}),t.TestOnlyLoginStep=t.TestOnlyLoginFormComponent=t.LoginForm=void 0,r=i.__importDefault(r),l=i.__importDefault(l),u=i.__importStar(u),S=i.__importStar(S),v=i.__importDefault(v),L=i.__importStar(L),(O=F=F||{})[O.CREDENTIALS_OR_SSO=0]="CREDENTIALS_OR_SSO",O[O.EMAIL_2FA=1]="EMAIL_2FA",O[O.PHONE_2FA=2]="PHONE_2FA",O[O.AUTHENTICATOR_2FA=3]="AUTHENTICATOR_2FA",O[O.SECKEY_2FA=4]="SECKEY_2FA",t.TestOnlyLoginStep=F;var N,O=(N=l.default.Component,i.__extends(I,N),I.prototype.trackSuccessfulLogin=function(e,t){e!==y.LoginFormEvent.LOGIN_IMMEDIATE_SUCCESS&&e!==y.LoginFormEvent.GOOGLE_LOGIN_SUCCESS&&e!==y.LoginFormEvent.APPLE_LOGIN_SUCCESS||(e=o.getGAEventData(o.MARKETING_LOGIN_EVENT,o.MARKETING_LOGIN_EVENT),o.MarketingTracker.tryPushEvent(o.MARKETING_LOGIN_EVENT,o.EventTypeEnum.Link,e))},I.prototype.handleLoginFormEvent=function(e,t){this.trackSuccessfulLogin(e,t),this.props.onLoginFormEvent&&this.props.onLoginFormEvent(e,t)},I.prototype.componentDidMount=function(){this.setState({shouldDisableForm:!1}),this.props.twoFactorOnlyProps||A.AuthAMPLogger.logLoginIntent(this.props.type),this.props.twoFactorOnlyProps&&this.props.twoFactorOnlyProps.u2fChallenge&&this.state.currentStep===F.SECKEY_2FA&&this.kickOffU2f(this.props.twoFactorOnlyProps.u2fChallenge),this.state.email&&this.ssoChecker.checkSsoState(this.state.email,this.onSsoStateUpdate)},Object.defineProperty(I.prototype,"shouldDisableForm",{get:function(){return!!this.props.disabled||this.state.shouldDisableForm},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"supportsCaptcha",{get:function(){return!this.props.hideCredentialFields&&!["multi","pairing","cli_link_nonce"].includes(this.props.type)},enumerable:!1,configurable:!0}),I.prototype.render=function(){var e,t,o;switch(this.state.currentStep){case F.CREDENTIALS_OR_SSO:o=l.default.createElement(b.LoginCredentialsForm,{ref:this.setCredentialsFormComponent,disabled:this.shouldDisableForm,emailError:this.state.localErrors.email,emailProps:this.props.emailProps||{},emailValue:this.state.email,forgotPasswordProps:this.props.forgotPasswordProps||{},googleLoginError:this.state.localErrors.googleLogin,googleLoginProps:this.props.googleLoginProps,appleLoginError:this.state.localErrors.appleLogin,appleLoginProps:this.props.appleLoginProps,hideCredentialFields:this.props.hideCredentialFields||!1,hideHelp:this.props.hideHelp||!1,hideRememberMe:this.props.hideRememberMe||!1,isPaperLogin:this.props.isPaperLogin||!1,isSubmitting:this.state.isSubmitting,loginButtonProps:this.props.loginButtonProps||{},loginError:this.state.localErrors.login,maestroStyle:this.props.maestroStyle||!1,onGoogleLoginClick:this.onGoogleLoginClick,onAppleLoginClick:this.onAppleLoginClick,onInputChange:this.onInputChange,onLoginClick:this.onLoginClick,openLinksInNewTab:!!this.props.openLinksInNewTab,onSsoChangeClick:this.onSsoChangeClick,onSubmit:this.onCredentialsFormSubmit,onCaptchaReady:this.onCaptchaReady,passwordError:this.state.localErrors.password,passwordProps:this.props.passwordProps||{},passwordValue:this.state.password,rememberMeProps:this.props.rememberMeCheckboxProps||{},rememberMeValue:this.state.rememberMe,showNaviSiteLogin:!!this.props.showNaviSiteLogin,ssoState:this.state.ssoState,supportsCaptcha:this.supportsCaptcha,variant:this.props.variant||g.AuthFormVariant.STANDARD});break;case F.PHONE_2FA:o=l.default.createElement(f.Phone2FAForm,{continuationUrl:this.props.continuationUrl,displayHeader:null!==(e=this.props.twoFactorDisplayHeader)&&void 0!==e&&e,error:this.state.localErrors.twoFactor,hideHelp:this.props.hideHelp||!1,hideTrustCheckbox:this.props.hideRememberMe||!1,inlineSubmit:void 0===this.props.twoFactorSubmitButtonInline||this.props.twoFactorSubmitButtonInline,lastTwoDigits:this.state.lastTwoDigits||"",maestroStyle:this.props.maestroStyle||!1,onInputChange:this.onInputChange,onResendCodeClick:this.resendCode,onSubmit:this.onPhone2FASubmit,rememberMe:this.state.rememberMe,trusted:this.state.trusted,trustTooltipPosition:this.props.twoFactorTrustCheckboxProps&&this.props.twoFactorTrustCheckboxProps.tooltipPosition,value:this.state.twoFactorCode,variant:this.props.variant||g.AuthFormVariant.STANDARD});break;case F.EMAIL_2FA:o=l.default.createElement(n.Email2FAForm,{displayHeader:null!==(e=this.props.twoFactorDisplayHeader)&&void 0!==e&&e,email:this.state.email,error:this.state.localErrors.twoFactor,inlineSubmit:void 0===this.props.twoFactorSubmitButtonInline||this.props.twoFactorSubmitButtonInline,maestroStyle:this.props.maestroStyle||!1,onInputChange:this.onInputChange,onSubmit:this.onPhone2FASubmit,value:this.state.twoFactorCode,variant:this.props.variant||g.AuthFormVariant.STANDARD,onResendCodeClick:this.resendCode});break;case F.AUTHENTICATOR_2FA:o=l.default.createElement(s.Authenticator2FAForm,{continuationUrl:this.props.continuationUrl,displayHeader:null!==(t=this.props.twoFactorDisplayHeader)&&void 0!==t&&t,error:this.state.localErrors.twoFactor,hideHelp:this.props.hideHelp||!1,hideTrustCheckbox:this.props.hideRememberMe||!1,inlineSubmit:void 0===this.props.twoFactorSubmitButtonInline||this.props.twoFactorSubmitButtonInline,maestroStyle:this.props.maestroStyle||!1,onInputChange:this.onInputChange,onSubmit:this.onAuthenticator2FASubmit,rememberMe:this.state.rememberMe,trusted:this.state.trusted,trustTooltipPosition:this.props.twoFactorTrustCheckboxProps&&this.props.twoFactorTrustCheckboxProps.tooltipPosition,value:this.state.twoFactorCode,variant:this.props.variant||g.AuthFormVariant.STANDARD});break;case F.SECKEY_2FA:o=l.default.createElement(_.SecKey2FAForm,{displayHeader:null!==(t=this.props.twoFactorDisplayHeader)&&void 0!==t&&t,error:this.state.localErrors.securityKey,hideTrustCheckbox:this.props.hideRememberMe||!1,maestroStyle:this.props.maestroStyle||!1,onChange2FA:this.switch2FA,onInputChange:this.onInputChange,onRetry:this.onRetryU2f,trusted:this.state.trusted,trustTooltipPosition:this.props.twoFactorTrustCheckboxProps&&this.props.twoFactorTrustCheckboxProps.tooltipPosition,secondaryTwoFactorType:this.state.secondaryTwoFactorType,securityKeyState:this.state.securityKeyState,variant:this.props.variant||g.AuthFormVariant.STANDARD})}var a=r.default("login-form-container",this.props.variant,this.props.className,{"login-form-container--centered":this.props.centered,"login-form-container--maestro":this.props.maestroStyle});return l.default.createElement("div",{className:a},l.default.createElement("div",{className:"regular-login-forms"},o))},I);function I(e){var t,s=N.call(this,e)||this;s.testOnlyGetSsoChecker=function(){return s.ssoChecker},s.setCredentialsFormComponent=function(e){s.credentialsFormComponent=e},s.testOnlyGetCredentialsFormComponent=function(){return s.credentialsFormComponent},s.onInputChange=function(e){var t=e.currentTarget,o={},a=i.__assign({},s.state.localErrors),r=!1;switch(t.name){case"login_email":o.email=t.value,a.email=void 0,r=!0;break;case"login_password":o.password=t.value,a.password=void 0;break;case"remember_me":o.rememberMe=t.checked;break;case"trusted":o.trusted=t.checked;break;case"code":o.twoFactorCode=t.value,a.twoFactor=void 0}o.localErrors=a,s.setState(o,function(){r&&s.ssoChecker.checkSsoState(o.email,s.onSsoStateUpdate)})},s.onSsoStateUpdate=function(e,t){e===s.state.email&&s.setState({ssoState:t})},s.onSsoChangeClick=function(){c.assert(s.state.ssoState===y.SsoState.OPTIONAL,"User can change SSO state only when it is optional",{tags:["react-login-form"]}),s.setState({ssoState:y.SsoState.OFF})},s.generateThirdPartyAuthUrl=function(e,t){t={fname:e.profile.given_name,lname:e.profile.family_name,email:e.profile.email,picture_url:e.profile.picture_url,refresh_token:e.refresh_token,email_sig:e.email_sig,automatic_redirect:t.toString(),cont:s.props.continuationUrl||"/"};return s.props.googleLoginProps&&s.props.googleLoginProps.signupTag&&(t.signup_tag=s.props.googleLoginProps.signupTag),s.props.googleLoginProps&&s.props.googleLoginProps.signupEndpoint&&(t.signup_endpoint=s.props.googleLoginProps.signupEndpoint),String(new m.URI({path:"/third_party_signup"}).updateQuery(t))},s.handleGoogleCallback=function(e){A.AuthAMPLogger.logThirdPartyLoginResponse(A.AuthType.GOOGLE,s.props.type,e.success,e.err_msg),A.GoogleUXAnalyticsLogger.logLoginResponse(e);var t,o,a,r=R.getFedrampRedirectUrlIfApplicable(e.is_fedramp_user||!1,s.props.continuationUrl||"/");e.success?(s.handleLoginFormEvent(y.LoginFormEvent.GOOGLE_LOGIN_SUCCESS),!1!==s.props.canRedirect?(d.Notify.success(T.intl.formatMessage({id:"Ce9FpX",defaultMessage:"Log in successful! Your browser will be redirected in a few seconds."})),u.redirect(r)):e.is_fedramp_user&&!s.props.forceOnLoginSuccess?(r=R.getFedrampRedirectUrlIfApplicable(!0,s.props.continuationUrl||u.get_href()),u.redirect(r)):s.props.onLoginSuccess&&s.props.onLoginSuccess({display_name:e.display_name,id:e.user_id,email:e.profile.email,is_fedramp_user:e.is_fedramp_user})):"emails_do_not_match_redirect"===e.err_msg?(o=(o=s.props.googleLoginProps)&&o.customErrorHandlers)&&o.emailsDoNotMatchRedirect?o.emailsDoNotMatchRedirect(e):(a=s.generateThirdPartyAuthUrl(e,!0),u.redirect(a)):"emails_do_not_match"===e.err_msg?"pairing"!==s.props.type&&s.props.variant===g.AuthFormVariant.STANDARD?(t=s.generateThirdPartyAuthUrl(e,!1),o=T.intl.formatMessage({id:"6AHSKo",defaultMessage:"Oops! We couldnâ€™t find a Dropbox account matching that email. <a>Click here to create one.</a>"},{a:function(e){return l.default.createElement("a",{className:"third-party-signup-link",href:t},e)}}),s.setState({localErrors:i.__assign(i.__assign({},s.state.localErrors),{googleLogin:o})})):e.localized_error?d.Notify.error(e.localized_error):d.Notify.error(T.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})):"tos_required"===e.err_msg?(a=new m.URI({path:"/account/complete_registration_page"}).updateQuery({finish_web_auth:"true",remember_me:e.remember_me.toString(),cont:s.props.continuationUrl||"/"}),u.redirect(a.toString())):"tfa_required"===e.err_msg?(a=new m.URI({path:"/verify_code"}).updateQuery({cont:r,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()}),u.redirect(a.toString())):"enable_twofactor_required"===e.err_msg?(a=new m.URI({path:"/twofactor"}).updateQuery({cont:r,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()}),u.redirect(a.toString())):"not_verified"===e.err_msg?(a=new m.URI({path:"/show_password_form"}).updateQuery({cont:r,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()}),u.redirect(a.toString())):"email_not_verified"===e.err_msg?(a=T.intl.formatMessage({id:"S6RuBm",defaultMessage:"Before you can sign in, youâ€™ll need to verify your account with Google {email}"},{email:e.profile.email}),d.Notify.error(new p.HTML("<span>"+a+"</span>"),30)):(e.localized_error?d.Notify.error(e.localized_error):d.Notify.error(T.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),"google_login_not_allowed"!==e.err_msg&&"sso_required"!==e.err_msg||(s.setState({email:e.profile.email}),s.ssoChecker.checkSsoState(e.profile.email,s.onSsoStateUpdate)))},s.onGoogleLoginClick=function(){s.handleLoginFormEvent(y.LoginFormEvent.GOOGLE_LOGIN_CLICK),s.setState({localErrors:{}}),A.AuthAMPLogger.logLoginAttempt(A.AuthType.GOOGLE,s.props.type),A.GoogleUXAnalyticsLogger.logLoginStart();var e=!!s.props.googleLoginProps&&!1!==s.props.googleLoginProps.popup;(new w.ProfileServicesLinkingHandler).auth_service_login_web(v.default.GOOGLE,s.handleGoogleCallback,"login_form",e?w.AuthWindowOption.POP_UP:w.AuthWindowOption.REDIRECT,s.state.rememberMe,s.props.continuationUrl||"/","pairing"===s.props.type)},s.handleAppleCallback=function(e){A.AuthAMPLogger.logThirdPartyLoginResponse(A.AuthType.APPLE,s.props.type,e.success,e.err_msg),A.AppleUXAnalyticsLogger.logLoginResponse(e);var t,o,a=R.getFedrampRedirectUrlIfApplicable(e.is_fedramp_user||!1,s.props.continuationUrl||"/");e.success?(s.handleLoginFormEvent(y.LoginFormEvent.APPLE_LOGIN_SUCCESS),!1!==s.props.canRedirect?(d.Notify.success(T.intl.formatMessage({id:"ZJmJez",defaultMessage:"Sign in successful! Your browser will be redirected in a few seconds."})),u.redirect(a)):e.is_fedramp_user&&!s.props.forceOnLoginSuccess?(a=R.getFedrampRedirectUrlIfApplicable(!0,s.props.continuationUrl||u.get_href()),u.redirect(a)):s.props.onLoginSuccess&&s.props.onLoginSuccess({display_name:e.display_name,id:e.user_id,email:e.profile.email,is_fedramp_user:e.is_fedramp_user})):"no_email_in_response"===e.err_msg?(t=T.intl.formatMessage({id:"oFA/9f",defaultMessage:"Sign in failed. If youâ€™d like to sign in with Apple again, <a>see how in our help center</a>. You could also sign in with your Dropbox account email and password."},{a:function(e){return'<a href="/help/accounts-billing/settings-sign-in/apple-sign-in-error">'+e+"</a>"}}),d.Notify.error(new p.HTML("<span>"+t+"</span>"),30)):"tfa_required"===e.err_msg?(o=new m.URI({path:"/verify_code"}).updateQuery({cont:a,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()}),u.redirect(o.toString())):"enable_twofactor_required"===e.err_msg?(o=new m.URI({path:"/twofactor"}).updateQuery({cont:a,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()}),u.redirect(o.toString())):"requires_password_on_first_link"===e.err_msg?(o=new m.URI({path:"/show_password_form"}).updateQuery({cont:a,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()}),u.redirect(o.toString())):"emails_do_not_match"===e.err_msg?(t=T.intl.formatMessage({id:"8cKJMG",defaultMessage:"We couldnâ€™t find a Dropbox account matching the email {email}. <a1>Sign up for a new account</a1> or <a2>get help signing in</a2> to an existing account."},{a1:function(e){return'<a href="/individual/plans-comparison?_tk=sia_nomatch_plan_web">'+e+"</a1>"},a2:function(e){return'<a href="/help/accounts-billing/settings-sign-in/sign-in-with-apple?_tk=sia_nomatch_help_web">'+e+"</a2>"},email:e.profile.email}),d.Notify.error(new p.HTML("<span>"+t+"</span>"),30)):(e.localized_error?d.Notify.error(e.localized_error):d.Notify.error(T.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),"apple_login_not_allowed"===e.err_msg&&(s.setState({email:e.profile.email}),s.ssoChecker.checkSsoState(e.profile.email,s.onSsoStateUpdate)))},s.onAppleLoginClick=function(){s.handleLoginFormEvent(y.LoginFormEvent.APPLE_LOGIN_CLICK),s.setState({localErrors:{}}),A.AuthAMPLogger.logLoginAttempt(A.AuthType.APPLE,s.props.type),A.AppleUXAnalyticsLogger.logLoginStart();var e=!!s.props.appleLoginProps&&!1!==s.props.appleLoginProps.popup;(new w.ProfileServicesLinkingHandler).auth_service_login_web(v.default.APPLE,s.handleAppleCallback,"login_form",e?w.AuthWindowOption.POP_UP:w.AuthWindowOption.REDIRECT,s.state.rememberMe,s.props.continuationUrl||"/","pairing"===s.props.type)},s.credentialsFormData=function(){var t=i.__assign(i.__assign({login_email:s.state.email,cont:s.props.continuationUrl,remember_me:s.state.rememberMe},s.credentialsFormComponent.getCaptchaResponses()),s.props.additionalData);if(void 0===s.props.encryptionOptions)return Promise.reject(new Error("Must provide encryption options"));var e=s.state.ssoState===y.SsoState.OFF?s.state.password:"";return C.wrapPassword(e,s.props.encryptionOptions).then(function(e){return t.encrypted_password=e,Promise.resolve(t)})},s.handleLoginSuccess=function(e){if(s.handleLoginFormEvent(y.LoginFormEvent.LOGIN_IMMEDIATE_SUCCESS,{userInfo:e}),!1===s.props.canRedirect)return e.is_fedramp_user&&!s.props.forceOnLoginSuccess?(t=R.getFedrampRedirectUrlIfApplicable(!0,s.props.continuationUrl||u.get_href()),u.redirect(t)):s.props.onLoginSuccess?s.props.onLoginSuccess(e):u.redirect("/");var t=R.getFedrampRedirectUrlIfApplicable(e.is_fedramp_user||!1,s.props.continuationUrl||"/");return u.redirect(t)},s.handleSuccessResponse=function(e){switch(s.setState({isSubmitting:!1}),A.AuthAMPLogger.logCredentialsLoginResponse(s.props.type,e.status),A.EmailAuthUXAnalyticsLogger.logLoginResponse(e),e.status){case y.LoginResponseStatus.ERROR:var t=e.html_response?new p.HTML(e.message):e.message;return d.Notify.error(t);case y.LoginResponseStatus.EXPIRED:return u.redirect(e.cont);case y.LoginResponseStatus.OK:t={id:e.id,email:e.email,display_name:e.display_name,locale:e.locale,is_fedramp_user:e.is_fedramp_user};s.handleLoginSuccess(t);break;case y.LoginResponseStatus.PASSWORD_EXPIRED:return s.setState({localErrors:i.__assign(i.__assign({},s.state.localErrors),{email:{message_text:T.intl.formatMessage({id:"3EEu7s",defaultMessage:"The password of the account associated with this email has expired. Please login to this account and update its password before pairing."})}})});case y.LoginResponseStatus.RATELIMIT:return s.setState({localErrors:i.__assign(i.__assign({},s.state.localErrors),{email:{message_text:T.intl.formatMessage({id:"7k/CMy",defaultMessage:"Youâ€™ve tried to log in too many times. Please try again in a few minutes."})}})});case y.LoginResponseStatus.TWOFACTOR_REQUIRED:case y.LoginResponseStatus.TOS_SIGNATURE_REQUIRED:return u.redirect(e.cont);case y.LoginResponseStatus.TWOFACTOR:e.checkpoint_token&&s.setState({checkpointToken:e.checkpoint_token}),e.use_email_2fa?s.setState({primaryTwoFactorType:y.TwoFactorType.EMAIL,currentStep:F.EMAIL_2FA}):e.u2f_challenge&&L.canUseAuthenticator(s.generateU2fRequest(e.u2f_challenge))?(s.setState({primaryTwoFactorType:y.TwoFactorType.SEC_KEY,currentStep:F.SECKEY_2FA}),e.last_two_digits?s.setState({lastTwoDigits:e.last_two_digits,secondaryTwoFactorType:y.TwoFactorType.SMS}):s.setState({secondaryTwoFactorType:y.TwoFactorType.AUTHENTICATOR}),s.kickOffU2f(e.u2f_challenge)):e.last_two_digits?s.setState({primaryTwoFactorType:y.TwoFactorType.SMS,lastTwoDigits:e.last_two_digits,secondaryTwoFactorType:void 0,currentStep:F.PHONE_2FA}):s.setState({primaryTwoFactorType:y.TwoFactorType.AUTHENTICATOR,lastTwoDigits:void 0,secondaryTwoFactorType:void 0,currentStep:F.AUTHENTICATOR_2FA});break;case y.LoginResponseStatus.SSO:return u.unsafeRedirect(e.sso_url);case y.LoginResponseStatus.PASSWORD_DECRYPTION_ERROR:return u.redirect(e.cont)}},s.handleServerErrors=function(e){var t;A.AuthAMPLogger.logCredentialsLoginResponse(s.props.type,e.funcaptcha_response?"funcaptcha_response":"form_error"),s.credentialsFormComponent.handleCaptchaErrors(e)?setTimeout(function(){s.isCaptchaReady||h.notifyCaptchaNotLoaded()},1e4):(A.EmailAuthUXAnalyticsLogger.logLoginError(),t={},e.login_email?t.email=e.login_email:t.email=void 0,e.login_password?t.password=e.login_password:t.password=void 0,e["failed-login-invalid-email-password"]?t.login=T.intl.formatMessage({id:"kfg1Pg",defaultMessage:"Oops! It looks like you may have forgotten your password. <a>Click here to reset it.</a>"},{a:function(e){return l.default.createElement("a",{href:"/forgot"},e)}}):t.login=void 0,s.setState({localErrors:t}),s.setState({isSubmitting:!1}))},s.onCredentialsFormSubmit=function(){A.EmailAuthUXAnalyticsLogger.logLoginStart(),s.setState({isSubmitting:!0}),s.credentialsFormData().then(function(e){e=S.submitCredentialsForm(s.props.type,e);e.catch(s.handleServerErrors),e.then(s.handleSuccessResponse)}).catch(function(e){var t,o=e.isBrowserNotSupported?(t="user-error",T.intl.formatMessage({id:"rWb8d2",defaultMessage:"Dropbox doesnâ€™t support your browser. For a better experience, upgrade to the latest version of a modern browser like Chrome, Firefox, Edge, or Safari."})):(t="critical",T.intl.formatMessage({id:"dNlIBC",defaultMessage:"There was a problem completing this request."}));c.reportException({err:e,severity:t,tags:["react-login-form"]}),s.setState({isSubmitting:!1}),d.Notify.error(o)})},s.onLoginClick=function(e){e.preventDefault(),A.AuthAMPLogger.logLoginAttempt(A.AuthType.CREDENTIALS,s.props.type),s.handleLoginFormEvent(y.LoginFormEvent.LOGIN_CLICK),s.credentialsFormComponent.submitRecaptcha()},s.handleResendCodeSuccess=function(e){var t;switch(e){case y.TwoFactorResendResponse.OK:return d.Notify.success(T.intl.formatMessage({id:"vdqTup",defaultMessage:"We sent you a code. It may take a few minutes to arrive."}));case y.TwoFactorResendResponse.RATELIMIT:t=T.intl.formatMessage({id:"7k/CMy",defaultMessage:"Youâ€™ve tried to log in too many times. Please try again in a few minutes."});break;case y.TwoFactorResendResponse.UNREACHABLE:t=T.intl.formatMessage({id:"G6HUee",defaultMessage:"We couldnâ€™t reach your phone number. Are you sure itâ€™s correct?"});break;case y.TwoFactorResendResponse.EXPIRED:t=T.intl.formatMessage({id:"l5AyQn",defaultMessage:"Sorry, your phone code has expired. Please log in again."});break;case y.TwoFactorResendResponse.BADCARRIER:t=T.intl.formatMessage({id:"ffjRA4",defaultMessage:"Unfortunately, your carrier isnâ€™t supported at this time."});break;case y.TwoFactorResendResponse.INVALIDNUMBER:t=T.intl.formatMessage({id:"1P05hM",defaultMessage:"That isnâ€™t a valid phone number."});break;case y.TwoFactorResendResponse.NOTAMOBILE:t=T.intl.formatMessage({id:"aI/ARD",defaultMessage:"That phone number doesnâ€™t appear to be a valid mobile number."});break;default:return d.Notify.error(T.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))}s.setState({localErrors:i.__assign(i.__assign({},s.state.localErrors),{twoFactor:{message_text:t}})})},s.resendCode=function(){var e=S.resendTwoFactorCode(null!==(e=null===(e=s.props.additionalData)||void 0===e?void 0:e.backup)&&void 0!==e&&e,null!==(e=null===(e=s.props.additionalData)||void 0===e?void 0:e.mobile_push)&&void 0!==e&&e);e.then(s.handleResendCodeSuccess),e.catch(function(){d.Notify.error(T.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))})},s.handleTwoFactorSuccess=function(e){switch(A.AuthAMPLogger.log2faResponse(s.props.type,e.status),e.status){case y.LoginResponseStatus.OK:s.state.currentStep===F.SECKEY_2FA&&s.setState({securityKeyState:y.SecurityKeyState.FOUND});var t={id:e.id,email:e.email,display_name:e.display_name,locale:e.locale,is_fedramp_user:e.is_fedramp_user};s.handleLoginSuccess(t);break;case y.LoginResponseStatus.ERROR:d.Notify.error(e.message);break;case y.LoginResponseStatus.REQUIRES_ROLE:case y.LoginResponseStatus.EXPIRED:s.setState({localErrors:i.__assign(i.__assign({},s.state.localErrors),{email:{message_text:e.message}}),currentStep:F.CREDENTIALS_OR_SSO});break;case y.LoginResponseStatus.INVALID_CREDENTIALS:s.setState({localErrors:i.__assign(i.__assign({},s.state.localErrors),{password:{message_text:e.message}}),currentStep:F.CREDENTIALS_OR_SSO});break;default:d.Notify.error(T.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))}},s.twoFactorFormData=function(){var e=i.__assign({remember_me:s.state.rememberMe,cont:s.props.continuationUrl,code:s.state.twoFactorCode,trusted:s.state.trusted},s.props.additionalData);return s.state.checkpointToken?i.__assign({checkpoint_token:s.state.checkpointToken},e):e},s.submitTwoFactor=function(){s.setState({isSubmitting:!0});var e=S.submitTwoFactorForm(s.props.type,s.twoFactorFormData());e.then(s.handleTwoFactorSuccess),e.catch(function(e){A.AuthAMPLogger.log2faResponse(s.props.type,e.u2f?"u2f_error":e.code?"code_error":"unknown"),s.state.currentStep===F.SECKEY_2FA&&e.u2f?s.setState({localErrors:i.__assign(i.__assign({},s.state.localErrors),{securityKey:e.u2f.message_text}),securityKeyState:y.SecurityKeyState.NOT_FOUND}):e.code?s.setState({localErrors:i.__assign(i.__assign({},s.state.localErrors),{twoFactor:e.code})}):d.Notify.error(T.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))}),e.finally(function(){s.setState({isSubmitting:!1})})},s.onPhone2FASubmit=function(e){e.preventDefault(),s.submitTwoFactor()},s.onAuthenticator2FASubmit=function(e){e.preventDefault(),s.submitTwoFactor()},s.generateU2fRequest=function(e){for(var t=JSON.parse(e),o={challenge_id:t.challenge_id},a=0,r=Object.keys(L.PROTOCOLS);a<r.length;a++){var s=r[a];o[s]=t[s]&&JSON.parse(t[s])}return o},s.kickOffU2f=function(r){return i.__awaiter(s,void 0,void 0,function(){var t,o,a=this;return i.__generator(this,function(e){switch(e.label){case 0:if(t=this.generateU2fRequest(r),!L.canUseAuthenticator(t))return[3,5];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,L.sign(t)];case 2:return o=e.sent(),this.state.currentStep===F.SECKEY_2FA&&this.setState({twoFactorCode:JSON.stringify(o)},function(){return a.submitTwoFactor()}),[3,4];case 3:return o=e.sent(),this.state.currentStep===F.SECKEY_2FA&&this.setState({securityKeyState:y.SecurityKeyState.NOT_FOUND}),c.assert(!1,"U2F Error - "+o,{tags:["react-login-form","u2f"]}),[3,4];case 4:return[3,5];case 5:return[2]}})})},s.switch2FA=function(){var e;c.assert(s.state.primaryTwoFactorType===y.TwoFactorType.SEC_KEY,"Unexpected two factor choice switch",{tags:["react-login-form"]}),s.state.secondaryTwoFactorType===y.TwoFactorType.SMS?(e=F.PHONE_2FA,s.resendCode()):e=F.AUTHENTICATOR_2FA,s.setState({twoFactorCode:"",primaryTwoFactorType:s.state.secondaryTwoFactorType,secondaryTwoFactorType:void 0,currentStep:e})},s.onRetryU2f=function(){s.setState({securityKeyState:y.SecurityKeyState.LOADING});var e=S.retryU2fAuthentication();e.then(s.kickOffU2f),e.catch(function(){s.setState({securityKeyState:y.SecurityKeyState.NOT_FOUND}),d.Notify.error(T.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))})},s.onCaptchaReady=function(){s.isCaptchaReady=!0},c.assert(!1!==e.canRedirect||!!e.onLoginSuccess,"Need an on login success handler if we cannot redirect the user",{tags:["react-login-form"]}),s.ssoChecker=new E.SsoStateChecker,s.isCaptchaReady=!1;var o=F.CREDENTIALS_OR_SSO,a=void 0,r=void 0,n=void 0;return e.twoFactorOnlyProps&&(!e.twoFactorOnlyProps.u2fChallenge||null!==(t=e.additionalData)&&void 0!==t&&t.backup||!L.canUseAuthenticator(s.generateU2fRequest(e.twoFactorOnlyProps.u2fChallenge))?e.twoFactorOnlyProps.lastTwoDigits?(o=F.PHONE_2FA,a=y.TwoFactorType.SMS,n=e.twoFactorOnlyProps.lastTwoDigits):(o=F.AUTHENTICATOR_2FA,a=y.TwoFactorType.AUTHENTICATOR):(o=F.SECKEY_2FA,a=y.TwoFactorType.SEC_KEY,e.twoFactorOnlyProps.lastTwoDigits?(r=y.TwoFactorType.SMS,n=e.twoFactorOnlyProps.lastTwoDigits):r=y.TwoFactorType.AUTHENTICATOR)),s.state={currentStep:o,email:e.emailProps&&e.emailProps.initialValue||"",isSubmitting:!1,lastTwoDigits:n,localErrors:{},password:"",primaryTwoFactorType:a,secondaryTwoFactorType:r,rememberMe:e.rememberMeCheckboxProps&&e.rememberMeCheckboxProps.checked||!1,securityKeyState:y.SecurityKeyState.LOADING,ssoState:y.SsoState.OFF,trusted:e.twoFactorTrustCheckboxProps&&e.twoFactorTrustCheckboxProps.checked||!1,twoFactorCode:"",checkpointToken:void 0,shouldDisableForm:!0},s}t.TestOnlyLoginFormComponent=O,t.LoginForm=a.requireCssWithComponent(O,["/static/css/components/exp_cards-vfls5BO1G.css","/static/css/components/login_form-vflqjm7yP.css","/static/css/legacy_packages/components-vflwFi1IV.css","/static/css/login_or_register-vfln_xSQk.css","/static/css/scooter/scooter-scoped-vflpl9JSl.css","/static/css/spectrum/index.web-vflmHVRF-.css","/static/css/recaptcha_challenge-vflrcf67y.css","/static/css/recaptcha_v2_challenge-vfl5GXpO2.css"])}),define("modules/clean/auth/login/google_login_button",["require","exports","tslib","react","classnames","modules/core/i18n","modules/clean/auth/common/types","modules/clean/auth/login/login_error","dig-components/buttons","modules/clean/react/image","modules/clean/static_urls"],function(e,t,s,n,i,l,u,c,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleLoginButton=void 0,n=s.__importDefault(n),i=s.__importDefault(i);function p(e){var t=e.onClick,o=e.label,e=e.disabled;return n.default.createElement(a.Button,{className:"setup-button",disabled:e,onClick:t,variant:"outline",size:"large"},n.default.createElement("div",{className:"email-cta-button"},n.default.createElement(r.Image,{className:"email-cta-button__item",src:d}),n.default.createElement("div",{className:"email-cta-button__item"},o)))}var d=o.static_url("/static/images/growth/biz-setup/gmail-vflKoZim9.svg");t.GoogleLoginButton=function(e){var t=e.buttonProps||{},o=i.default("auth-google","button-primary",t.className),a=e.variant&&e.variant===u.AuthFormVariant.DIG20,r=t.text||l.intl.formatMessage({id:"SgtygT",defaultMessage:"Sign in with Google"});return n.default.createElement("div",{className:"login-form-container__google-div"},a?n.default.createElement(p,s.__assign({},e,{label:r})):n.default.createElement("button",{className:o,onClick:e.onClick,type:"button",disabled:e.disabled||t.disabled,"data-uxa-log":"google_login_start"},n.default.createElement("div",{className:"sign-in-text"},r)),e.error&&n.default.createElement(c.LoginError,{className:"google-login-error",message:e.error}))}}),define("modules/clean/auth/login/login_error",["require","exports","tslib","react","classnames"],function(e,t,o,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginError=void 0,a=o.__importDefault(a),r=o.__importDefault(r),t.LoginError=function(e){var t=r.default("c-card","c-card--error",e.className);return a.default.createElement("div",{className:t},e.message)}}),define("modules/clean/auth/login/sso_utils",["require","exports","tslib","modules/clean/auth/login/api","modules/clean/auth/login/types"],function(e,t,o,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SsoStateChecker=void 0,r=o.__importStar(r);var n=/^[^@\s]+@[^@\s]+\.[A-Za-z]{2,}$/;t.SsoStateChecker=function(){var a=this;this.shouldCheckSsoState=function(e){return e.match(n)},this.checkSsoState=function(t,o){a.shouldCheckSsoState(t)?a.CACHE[t]?o(t,a.CACHE[t]):a.INFLIGHT[t]||(a.INFLIGHT[t]=!0,r.checkSsoState(t).then(function(e){switch(e.user_sso_state){case"optional":a.CACHE[t]=s.SsoState.OPTIONAL;break;case"required":a.CACHE[t]=s.SsoState.REQUIRED;break;default:a.CACHE[t]=s.SsoState.OFF}o(t,a.CACHE[t])}).finally(function(){delete a.INFLIGHT[t]})):o(t,s.SsoState.OFF)},this.CACHE={},this.INFLIGHT={}}}),define("modules/clean/auth/login/types",["require","exports"],function(e,t){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.LoginFormEvent=t.TwoFactorResendResponse=t.LoginResponseStatus=t.SsoState=t.SecurityKeyState=t.TwoFactorType=t.LoginRole=void 0,(o=t.LoginRole||(t.LoginRole={})).ROLE_WORK="work",o.ROLE_PERSONAL="personal",o.ROLE_PHOTOS="photos",o.ROLE_BOTH="both",(o=t.TwoFactorType||(t.TwoFactorType={}))[o.EMAIL=0]="EMAIL",o[o.SMS=1]="SMS",o[o.AUTHENTICATOR=2]="AUTHENTICATOR",o[o.SEC_KEY=3]="SEC_KEY",(o=t.SecurityKeyState||(t.SecurityKeyState={}))[o.LOADING=0]="LOADING",o[o.FOUND=1]="FOUND",o[o.NOT_FOUND=2]="NOT_FOUND",(o=t.SsoState||(t.SsoState={})).OFF="off",o.OPTIONAL="optional",o.REQUIRED="required",(o=t.LoginResponseStatus||(t.LoginResponseStatus={})).DEVICE_LIMIT="DEVICE_LIMIT",o.OK="OK",o.SSO="SSO",o.TWOFACTOR="TWOFACTOR",o.TWOFACTOR_REQUIRED="TWOFACTOR_REQUIRED",o.RATELIMIT="RATELIMIT",o.PASSWORD_EXPIRED="PASSWORD_EXPIRED",o.EXPIRED="EXPIRED",o.ERROR="ERROR",o.REQUIRES_ROLE="REQUIRES_ROLE",o.INVALID_CREDENTIALS="INVALID_CREDENTIALS",o.PASSWORD_DECRYPTION_ERROR="PASSWORD_DECRYPTION_ERROR",o.TOS_SIGNATURE_REQUIRED="TOS_SIGNATURE_REQUIRED",(o=t.TwoFactorResendResponse||(t.TwoFactorResendResponse={})).OK="OK",o.RATELIMIT="RATELIMIT",o.UNREACHABLE="UNREACHABLE",o.EXPIRED="EXPIRED",o.BADCARRIER="BADCARRIER",o.INVALIDNUMBER="BADCARRIER",o.NOTAMOBILE="BADCARRIER",(t=t.LoginFormEvent||(t.LoginFormEvent={})).LOGIN_CLICK="LOGIN_CLICK",t.LOGIN_IMMEDIATE_SUCCESS="LOGIN_IMMEDIATE_SUCCESS",t.GOOGLE_LOGIN_CLICK="GOOGLE_LOGIN_CLICK",t.GOOGLE_LOGIN_SUCCESS="GOOGLE_LOGIN_SUCCESS",t.APPLE_LOGIN_CLICK="APPLE_LOGIN_CLICK",t.APPLE_LOGIN_SUCCESS="APPLE_LOGIN_SUCCESS"});
