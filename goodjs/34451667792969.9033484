try{var cX=window.cX=window.cX||{};function cxCCE_callQueueExecute(){try{for(var e=null;e=cX.CCE.callQueue.shift();)try{var t=e[0],i=e.slice(1);cX.callQueue.push(["invoke",function(e,t){return function(){cX.CCE.library[e].apply(cX.CCE.library,t)}}(t,i)])}catch(e){}}catch(e){}}cX.callQueue=cX.callQueue||[],cX.CCE=cX.CCE||{},cX.CCE.callQueue=cX.CCE.callQueue||[],cX.CCE.library||(cX.CCE.library={version:"2.42",ccePushUrl:"https://comcluster.cxense.com/cce/push?callback={{callback}}",prefix:null,persistedQueryId:null,testGroup:-1,testVariant:null,previewTestId:null,previewCampaign:null,previewDiv:null,previewId:null,offerProductId:null,startTime:new Date,visibilityField:"timeHalf",trackTime:.5,noCache:!1,activeSnapPoint:null,snapPoints:[],activeWidgets:[],"__cx-toolkit__":{isShown:!1,data:[]},utmParams:[],sendPageViewEvent:function(e,t,i,n){this.init(null,e,t,this.visibilityField,function(){cX.sendPageViewEvent(i,n)})},init:function(e,t,i,n,r){this.prefix=t,this.persistedQueryId=i;i={};if(e){for(var s=document.getElementsByTagName("script"),c=null,a=0;!c&&a<s.length;++a)s[a]&&s[a].src&&-1<s[a].src.indexOf(e)&&(c=s[a]);c&&c.src&&-1<c.src.indexOf("#")&&(o=c.src.replace(/.*#/,""),i=cX.decodeUrlEncodedNameValuePairs(o))}var o=cX.parseUrlArgs();cX.Object.forEach(o,cX.createDelegate(this,function(e,t){void 0!==e&&t.match(/utm_(source|medium|content|campaign|term)/i)&&this.utmParams.push({key:t,value:e})})),this.testVariant=o.testVariant||i.testVariant||i.ver,this.previewTestId=o.testId||i.testId,this.previewCampaign=o.previewCampaign||i.previewCampaign,this.previewDiv=o.previewDiv||i.previewDiv||"current",this.previewId=o.previewId||i.previewId,this.offerProductId=o.cx_productId||i.cx_productId,this.noCache="1"===o.cx_nocache||"1"===i.cx_nocache,-1===this.testGroup&&(this.testGroup=this.getTestGroup()),this.prefix&&this.persistedQueryId&&cX.setEventAttributes({origin:this.prefix+"-web",persistedQueryId:this.persistedQueryId}),cX.setCustomParameters({ver:this.version,testGroup:this.testGroup}),n&&n.length&&(this.visibilityField=n),this.startTime&&(2<(n=(new Date-this.startTime)/1e3)&&cX.setCustomParameters({loadDelay:n.toFixed(1)}),this.startTime=null),"http:"===location.protocol&&cX.setCustomParameters({insecure:"y"}),this._insertPreview(),this._parseSavedParameter("showTools",o,i)&&(i=this._parseSavedParameter("useLocalToolkit",o,i),this._showTools(i)),r&&r()},_parseSavedParameter:function(e,t,i){try{var n="_cX_"+e,r=void 0!==t[e]||void 0!==i[e],s="1"===t[e]||"1"===i[e];return cX.hasLocalStorage()&&(r?localStorage.setItem(n,s?"1":"0"):s="1"===localStorage.getItem(n)),s}catch(e){}},setVisibilityField:function(e){this.visibilityField=e},setSnapPoints:function(e){var t;this.snapPoints=e,this.activeSnapPoint=this._getSnapPoint(),window.addEventListener("resize",cX.createDelegate(this,function(){clearTimeout(t),t=setTimeout(cX.createDelegate(this,function(){this._renderResizedWidgets()}),200)}),!1)},_getSnapPoint:function(){var e=this.snapPoints;if(!e.length)return"";for(var t=cX.getWindowSize().width,i=0;i<e.length;++i)if(t>=e[i].min)return e[i].name;return e[e.length-1].name},_renderResizedWidgets:function(){var e=this._getSnapPoint();if(e!==this.activeSnapPoint){this.activeSnapPoint=e;for(var t=0;t<this.activeWidgets.length;++t){var i=this.activeWidgets[t];i.context.activeSnapPoint=e,document.getElementById(i.templateId)||this._addTemplate(i.templateId,i.templateContent),cX.renderTemplate(i.templateId,i.targetId,i.data,i.context)}}},getTestGroup:function(){var e=cX.getUserId(),t=-1;if(e&&e.length){for(var i=0,n=0;n<e.length;n++)i=(i<<5)-i+e.charCodeAt(n),i|=0;t=Math.abs(i)%100}else t=Math.floor(100*Math.random());return t},_applyContext:function(r,e){(r=r||{}).context||(r.context={}),r.context.categories||(r.context.categories={}),r.context.parameters||(r.context.parameters=[]);var s={};if(cX.Object.forEach(r.context.categories,function(e,t){var i,n;void 0!==e&&(i=!1,n=t.toLowerCase(),s[n]=e,cX.Array.forEach(r.context.parameters,function(e){i=i||e.key===n}),i||r.context.parameters.push({key:n,value:""+e}))}),r.context.categories=s,cX.Object.forEach(cX.library.m_rawCustomParameters,function(e,t){t&&void 0!==e&&(cX.Object.some(r.context.parameters,function(e){return e.key===t})||(cX.isArray(e)?cX.Array.forEach(e,function(e){r.context.parameters.push({key:t,value:""+e})}):r.context.parameters.push({key:t,value:""+e})))}),cX.Array.forEach(this.utmParams,function(e){r.context.parameters.push({key:e.key,value:""+e.value})}),this.previewId===e.widgetId&&this.previewCampaign&&(r.tag=this.previewCampaign),-1===this.testGroup&&(this.testGroup=this.getTestGroup()),r.context.categories.testgroup=""+this.testGroup,r.context.parameters.push({key:"testgroup",value:""+this.testGroup}),e&&e.targetElementId){var t=document.getElementById(e.targetElementId);if(t){for(var i={},n=[].slice.call(t.querySelectorAll(e&&e.ctrlLinksCss||"a")),c=0;c<n.length;c++){var a=n[c],o=this._getElemLink(a,e&&e.ctrlSpaAttr);a&&o&&(i[o]=null)}var l,u=1;for(l in i)i.hasOwnProperty(l)&&r.context.parameters.push({key:"ctrlUrl"+u++,value:l})}}return this.noCache&&(r.context.uncachedSettings=!0),r},reportTestImpression:function(e,t){},_reportWidgetVisible:function(e,t,i){for(var n=0;n<i.length;++n){var r=i[n];r.click_url&&(r={impressions:[{clickUrl:r.click_url,visibilitySeconds:1}]},r="https://api.cxense.com/public/widget/visibility?callback={{callback}}&json="+encodeURIComponent(cX.JSON.stringify(r)),cX.jsonpRequest(r,function(e){},{synchronous:!1}))}},trackVisibility:function(e,t,i,n){var r=document.getElementById(e);r&&null!==t&&n&&(cX.isAmpIFrame()?cX.trackAmpIFrame({trigger:{on:cX.createDelegate(this,function(e){return e.visibility[this.visibilityField]>=this.trackTime}),callback:cX.createDelegate(this,function(){this._reportWidgetVisible(t,i,n)})}}):((e=r.closest(".cx-visibility-element"))?r=e:(e=r.getElementsByClassName("cx-visibility-element"))&&1===e.length&&(r=e[0]),cX.trackElement({element:r,trigger:{on:cX.createDelegate(this,function(e){return e.visibility[this.visibilityField]>=this.trackTime}),callback:cX.createDelegate(this,function(e){this._reportWidgetVisible(t,i,n)})}})))},_instrumentClickLinks:function(e,t,i,n){var r=e&&e.targetElementId,s=e&&e.ctrlLinksCss||"a",c=e&&e.ctrlSpaAttr,r=document.getElementById(r);if(r)for(var a=[].slice.call(r.querySelectorAll(s)).filter(cX.createDelegate(this,function(e){return this._getElemLink(e,c)})),o=0;o<a.length;++o){var l,u=a[o],d=this._getElemLink(u,c),p=!1;if(n)for(var h=0;h<n.length;++h){var m=n[h];if(m.click_url&&d===m.url){this._ctrlClickTracker(m.click_url,u,c),p=!0;break}}p||(l="cx_testId="+encodeURIComponent(t)+"&cx_testVariant="+encodeURIComponent(i),d+=(d.indexOf("#")<0?"#":"&")+l+"&cx_artPos="+o,c?u.setAttribute(c,d):u.href=d)}},instrumentClickLinks:function(e,t,i){this._instrumentClickLinks({targetElementId:e},t,i)},_getElemLink:function(e,t){return t?e.getAttribute(t):e.href},_updateClickUrls:function(e){if(e)for(var t=0;t<e.length;++t){var i,n,r=e[t];r.click_url&&(this._isEmptyType(r.type)||(i=r.testId||"0",n="ctrl"===r.type?"ctrl":"cx_"+(r.campaign||0),r.click_url+="?cx_testId="+i+"&cx_testVariant="+n+"&cx_artPos="+t,r.tag&&(r.click_url+="&cx_tag="+r.tag),r._type&&(r.click_url+="&cx_type="+r._type),r.offerProductId&&(r.click_url+="&cx_productId="+r.offerProductId)))}},updateRecsClickUrls:function(e,t,i){if(i)for(var n=0;n<i.length;++n){var r=i[n];r.click_url&&(r.click_url+="?cx_testId="+e+"&cx_testVariant="+t+"&cx_artPos="+n,r.tag&&(r.click_url+="&cx_tag="+r.tag))}},_ctrlClickTracker:function(e,t,i){if(!i)return cX.clickTracker(e,t);window.requestAnimationFrame(function(){cX.addEventListener(t,"click",function(){cX.sendSpaRecsClick(e)})})},clickTracker:function(t,i,n){var r;if(t&&t.click_url&&(r=t.click_url),i){var s="cXLinkId"+cX.library._randomString();return window.requestAnimationFrame(function(){var e=document.getElementById(s);e?(cX.addEventListener(e,"mousedown",function(){e.removeAttribute("href")}),cX.addEventListener(e,"touchstart",function(){e.removeAttribute("href")}),cX.addEventListener(e,"click",function(){cX.sendSpaRecsClick(r,function(){i(t,n)})})):console.log("Missing linkId: "+s)}),s}var c=r.indexOf("?");c===r.length-1&&(r=r.substring(0,r.length-1));var a="";n&&cX.Object.forEach(n,function(e,t){void 0!==e&&(a+=(a||0<=c?"&":"?")+t+"="+e)});var e=r.indexOf("#");return 0<=e?r=r.substring(0,e)+a+r.substring(e):r+=a,cX.clickTracker(r)},getDivId:function(e){if(e&&e.length){var t=document.getElementsByClassName(e);if(t&&1===t.length){t=t[0];return t.id&&t.id.length||(t.id=e+"-01"),t.id}}return null},_processResult:function(e,t){var i,n,r;t&&t.length&&(i=t[0],this._isEmptyType(i.type)||(n=i.testId||"0",r="ctrl"===i.type?"ctrl":"cx_"+(i.campaign||0),"ctrl"===i.type&&this._instrumentClickLinks(e,n,r,t),this.trackVisibility(e&&e.targetElementId,n,r,t)))},processCxResult:function(e,t){var i,n=document.getElementById(t);n&&(i=null,n.previousElementSibling&&(i=n.previousElementSibling.id,"template"===n.className&&n.parentNode.removeChild(n)),this.trackVisibility(i||t,e,"cx"))},_isEmptyType:function(e){return 0<=["noImpact","noVisual","free","abTest","piano"].indexOf(e)},_isIgnoredResponse:function(e){return!(e&&e.response&&e.response.items&&e.response.items.length)||this._isEmptyType(e.response.items[0].type)},_addTemplate:function(e,t){var i=document.createElement("div");i.id=e,i.className="template",i.setAttribute("style","display: none;"),i.innerHTML=t,document.body.appendChild(i)},displayResult:function(e,t,i){var n,r,s,c,a;t.response.items&&t.response.items.length&&"ctrl"===t.response.items[0].type||(n=t.response.template,r=t.response.style,c=t.response.head,r&&r.length&&((s=document.createElement("style")).type="text/css",s.styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r)),document.getElementsByTagName("head")[0].appendChild(s)),c&&c.length&&((a=document.createElement("script")).type="text/javascript",a.text=c,document.getElementsByTagName("head")[0].appendChild(a)),c="cx-"+cX.getRandomString()+"-tmp",this._addTemplate(c,n),a=e||c+"-dst",e||((e=document.createElement("div")).id=c+"-dst",e.className="template",e.setAttribute("style","display: none;"),document.body.appendChild(e)),this.snapPoints.length&&((i=i||{}).activeSnapPoint=this._getSnapPoint(),this.activeWidgets.push({templateId:c,targetId:a,data:t,context:i,templateContent:n})),cX.renderTemplate(c,a,t,i))},runCxVersion:function(i,n,e,t,r){var s;e.renderTemplateUrl?(e.insertBeforeElementId=n,e.testId=i,e.testVariant="cx",e.onImpressionResult=cX.createDelegate(this,function(){this.processCxResult(i,n,t),r&&r()})):e.renderFunction?(s=e.renderFunction,e.renderFunction=cX.createDelegate(this,function(e,t){this.updateRecsClickUrls(i,"cx",e.response.items),this.processCxResult(i,n),s(e,t),r&&r(e,t)})):e.renderFunction=cX.createDelegate(this,function(e,t){i&&this.updateRecsClickUrls(i,"cx",e.response.items),this.displayResult(n,e),this.processCxResult(i,n),r&&r(e,t)}),t=this._applyContext(t,e),cX.insertWidget(e,t)},displayWidget:function(e,t,i,n){this.runCxVersion(null,e,t,i,n)},runCtrlVersion:function(e,t,i){this.instrumentClickLinks(t,e,"ctrl"),this.trackVisibility(t,e,"ctrl"),i&&setTimeout(i,1)},runTest:function(e,t,i,n,r,s){"cx"===this.testVariant?this.runCxVersion(e,t,n,r,s):"ctrl"===this.testVariant?this.runCtrlVersion(e,t,s):-1<this.testGroup&&0<i?this.testGroup<100*i?this.runCxVersion(e,t,n,r,s):this.testGroup>100*(1-i)&&this.runCtrlVersion(e,t,s):s&&setTimeout(s,1)},_renderFunction:function(i,e,t,n){if(this._isIgnoredResponse(i)){var r=i.response.items&&0<i.response.items.length&&i.response.items[0];if(r&&r.aid&&"piano"===r.type)cX.loadScript("https://sandbox.tinypass.com/xbuilder/experience/load?aid="+r.aid);else if(r&&"abTest"===r.type)return void this.run({targetElementId:t&&t.targetElementId,widgetId:r.widgetId},null,function(e,t){n(e,t,i)})}else this._updateClickUrls(i.response.items),this.displayResult(t&&t.targetElementId,i),this._processResult(t,i.response.items);this._executeCallback(n,i,e)},render:function(e,t,i,n){this._renderFunction(t,i,{targetElementId:e},n)},_executeCallback:function(e,t,i){var n,r;e&&("function"==typeof e?e(t,i):"string"==typeof e&&(window[e]&&"function"==typeof window[e]?window[e](t,i):(n="cx_"+cX.getRandomString(),(r=document.createElement("script")).type="text/javascript",r.text="function "+n+"(data,context) {("+e+")(data,context);}",document.getElementsByTagName("head")[0].appendChild(r),window[n]&&"function"==typeof window[n]&&window[n](t,i))))},run:function(r,e,s){if(!r.widgetId)throw"Please provide 'widgetId'";var i=s;this["__cx-toolkit__"].isShown&&(this["__cx-toolkit__"].data.push({widget:r.widgetId,params:r,responseData:null,responseContext:null,requestContext:e,isRendered:!1}),i=cX.createDelegate(this,function(e,t){for(var i=this["__cx-toolkit__"].data,n=0;n<i.length;n++)i[n].widget===r.widgetId&&i[n].params.targetElementId===r.targetElementId&&(i[n].isRendered=!0,i[n].responseData=e,i[n].responseContext=t);s(e,t)})),r.renderFunction=cX.createDelegate(this,function(e,t){this._renderFunction(e,t,r,i)}),e=this._applyContext(e,r),cX.insertWidget(r,e)},_runDuplicateRemoval:function(c,a,o){var l;0<c.length&&((l=c.shift()).widgetContext||(l.widgetContext={}),l.widgetContext.context||(l.widgetContext.context={}),l.widgetContext.context.neighborRemovalKeys=a,l.widgetContext.context.neighbors=o,0<c.length?this.run(l.widgetParams,l.widgetContext,cX.createDelegate(this,function(e,t){if(e&&e.response&&e.response.items&&e.response.items.length){for(var i=0;i<e.response.items.length;i++)for(var n=e.response.items[i],r=0;r<a.length;r++){var s=n[a[r]];if(s){-1===o.indexOf(s)&&o.push(s);break}}this._executeCallback(l.widgetCallback,e,t)}this._runDuplicateRemoval(c,a,o)})):this.run(l.widgetParams,l.widgetContext,l.widgetCallback))},runMulti:function(e,t,i){if(t){t=!0===t?["recs-articleid","id"]:cX.isArray(t)?t:[t];this._runDuplicateRemoval(e,t,i||[])}else for(var n=0;n<e.length;n++)this.run(e[n].widgetParams,e[n].widgetContext,e[n].widgetCallback)},insertMaster:function(e,s,c){cX.insertWidget({widgetId:e,renderFunction:cX.createDelegate(this,function(e){if(e&&e.response&&e.response.items&&e.response.items.length){var t=e.response.items[0],i=[];if(t&&t.widgets)for(var n=0;n<t.widgets.length;n++){var r=t.widgets[n];r.widgetId&&r.targetElementId&&i.push({widgetParams:{widgetId:r.widgetId,targetElementId:r.targetElementId},widgetContext:s,widgetCallback:r.callback})}this.runMulti(i,c)}})},s)},_insertPreview:function(){var e;this.previewId&&"current"!==this.previewDiv&&("new"===this.previewDiv&&(e=document.createElement("div"),this.previewDiv="cx_preview_"+cX.getRandomString(),e.setAttribute("id",this.previewDiv),document.body.insertBefore(e,document.body.firstChild)),this.run({widgetId:this.previewId,targetElementId:this.previewDiv}))},_showTools:function(e){if(!0!==this["__cx-toolkit__"].isShown){try{cX.hasLocalStorage()&&localStorage.setItem("cX_lastP1Time","0")}catch(e){}var t,i,n,r,s;this["__cx-toolkit__"].isShown=!0,t=document,i="script",n=(e?"https://local.cxense.com:9001/":"https://rscdn.cxense.com/")+"cxense-toolkit.js",s=r=null,e=c,(r=t.createElement(i)).type="text/java"+i,r.async="async",r.src=n,r.onload=e,(s=t.getElementsByTagName(i)[0]).parentNode.insertBefore(r,s)}function c(){document.body.appendChild(document.createElement("cx-toolkit"))}},setTestGroup:function(e){this.testGroup=e},invoke:function(e){e.apply(window,Array.prototype.slice.call(arguments,1))},sendConversionEvent:function(e,t){e=e||{};var i=(t=t||{}).identities||[];cX.Array.some(i,function(e){return"cx"===e.type})||i.push({id:cX.getUserId(),type:"cx"});var n={events:[Object.assign(e,{eventType:"conversion",productId:e.productId||this.offerProductId,rnd:cX.library._randomString(),prnd:cX.library.m_rnd,siteId:cX.library.m_siteId,userIds:i})]},r=this.ccePushUrl+"&json="+encodeURIComponent(cX.JSON.stringify(n));cX.jsonpRequest(r,function(e){t.callback&&t.callback(e,{url:r,request:n})})}},function(e,t,i,n){(i=e.createElement(t)).type="text/java"+t,i.async="async",i.src="https://cdn.cxense.com/cx.js",(n=e.getElementsByTagName(t)[0]).parentNode.insertBefore(i,n)}(document,"script")),setTimeout(cxCCE_callQueueExecute,25),cX.CCE.callQueue.push=function(){return Array.prototype.push.apply(this,arguments),setTimeout(cxCCE_callQueueExecute,1),this.length},function(){for(var e in cX.CCE.library)cX.CCE.library.hasOwnProperty(e)&&(cX.CCE[e]=cX.CCE.library[e])}(),window.cxTest||(window.cxTest=cX.CCE)}catch(e){console.log(e)}
