!function(o,r){"use strict";window.userTracker={country:null,initialisationComplete:!1,euSubdomain:!1,getUserCountry:function(){return userTracker.country},setUserCountry:function(){var e,t;userTracker.initialisationComplete||(t=sessionStorage.getItem("userCountry"),e=o.cookie("location_is_verified"),t&&void 0!==e&&e?(userTracker.country=t,userTracker.initialisationComplete=!0,o(window).once("locationLoad").trigger("userTracker:load")):(e="http://ip-api.com/json/?fields=countryCode",void 0!==r.apiEndpoint&&r.apiEndpoint&&(e=r.apiEndpoint),(t=new XMLHttpRequest).onreadystatechange=function(){var e;4!==this.readyState||200!==this.status||(e=JSON.parse(this.responseText)).countryCode&&(userTracker.country=e.countryCode,sessionStorage.setItem("userCountry",userTracker.country),userTracker.initialisationComplete=!0,o(window).once("locationLoad").trigger("userTracker:load"),userTracker.verifyLocation(!0))},t.open("GET",e,!0),t.send()),void 0!==r.disableModal&&r.disableModal&&localStorage.setItem("automaticRedirect","accept"))},verifyLocation:function(e){var t="."+document.domain;e?o.cookie("location_is_verified",1,{expires:1,path:"/",domain:t}):o.removeCookie("location_is_verified",{path:"/",domain:t})},executeOnCountryLookup:function(e,t){"function"==typeof e&&(userTracker.initialisationComplete?e(t):o(window).on("userTracker:load",function(){e(t)}))}},userTracker.setUserCountry()}(jQuery,(Drupal,window.drupalSettings)),function(i,e){"use strict";function o(e){var t,o=e[userTracker.getUserCountry()];o?"accept"===(t=localStorage.getItem("automaticRedirect"))?(e=o.to,window.location.href!==e&&(localStorage.getItem("stopRedirect")?console.log("no redirect"):window.location.replace(e))):"decline"===t?i(".block-regional-redirect-block").remove():(r(o),c(o)):i(".block-regional-redirect-block").remove()}const r=function(e){let t=i(".modal-redirect-copy"),o=i(".accept-redirect"),r=i(".cancel-redirect"),c=i(".form-item-remember-choice label");t.once("inject-modal-copy").append(e.modalCopy),c.once("inject-modal-box").text(e.modalBoxText),o.once("inject-accept").val(e.acceptText),r.once("inject-cancel").val(e.cancelText),i(".regional-redirect-wrapper").removeClass("hidden")},c=function(e){let t=i(".accept-redirect"),o=i(".cancel-redirect"),r=i(".modal-redirect-remember"),c=e.to;t.once("accept-redirect-click").click(function(e){e.preventDefault(),r.prop("checked")?localStorage.setItem("automaticRedirect","accept"):localStorage.removeItem("automaticRedirect"),setTimeout(function(){window.location.replace(c)},200)}),o.once("cancel-redirect-click").click(function(e){e.preventDefault(),r.prop("checked")?localStorage.setItem("automaticRedirect","decline"):localStorage.removeItem("automaticRedirect")}),i(".regional-redirect-wrapper").once("modal-injected").trigger("regionRedirect:load").addClass("modal-injected")};e.behaviors.countryRedirects={attach:function(e,t){!function(){if("undefined"===t.disableModal&&!i(".regional-redirect-wrapper").length)return;var e=function(){if(typeof t.crrData!=="undefined"&&t.crrData)return t.crrData;return[]}();userTracker.executeOnCountryLookup(o,e)}()}}}(jQuery,Drupal,window.drupalSettings);
