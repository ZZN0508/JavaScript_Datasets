!function(n,c){if(n.jQuery!==c){jQuery.noConflict();function i(){var o=this;r.extend(o,{config:{ajaxtimer:["3","Range","1,99"],jsonurl:["","Str","^http(s?)+(:\\/\\/[a-zA-Z0-9_\\-\\.]+)(\\.rakuten\\.co\\.jp\\/)+([a-zA-Z0-9_&=\\?\\-\\.\\/]+)$"],maxnum:["5","Range","1,99"],scid_key:["sc-id","Str","^[a-zA-Z0-9_\\-]{3,64}$"],scid_val:["","Str","^[a-zA-Z0-9_\\-]{3,64}$"],scid_seq:["0","Str","^[0-1]$"],sc_impvar:["","Str","^[a-zA-Z0-9_\\-]{3,64}$"],sc_impcode:["","Str","^[a-zA-Z0-9_\\-]{3,64}$"],sc_hovcode:["","Str","^[a-zA-Z0-9_\\-]{3,64}$"]},define:{startTime:0,configClass:"svcAshiatoConfig",serviceIdClass:"svcAshiatoServiceId",labelClass:"svcAshiatoLabel",labelDefault:"default",labelExist:"exist",labelHover:"hover",viewClass:"svcAshiatoView",viewTmpl:"viewTemplate"},vars:{openTimerId:null,serviceNum:0,json:null},eobj:{ashiato:null,config:null,serviceId:null,label:null,labelAll:null,labelDefault:null,labelExist:null,labelHover:null,view:null,labelTmpl:null,viewTmpl:null},status:{isTimeout:!1},initialize:function(e){o.eobj.ashiato=e,o.eobj.config=e.find("."+o.define.configClass),o.eobj.serviceId=e.find("."+o.define.serviceIdClass),o.eobj.label=e.find("."+o.define.labelClass),o.eobj.labelAll=o.eobj.label.children(),o.eobj.labelDefault=o.eobj.label.find("."+o.define.labelDefault),o.eobj.labelExist=o.eobj.label.find("."+o.define.labelExist),o.eobj.labelHover=o.eobj.label.find("."+o.define.labelHover),o.eobj.view=e.find("."+o.define.viewClass),o.define.viewTmpl=o.eobj.ashiato.attr("id")+"_"+o.define.viewTmpl,o.eobj.viewTmpl=e.find("#"+o.define.viewTmpl),0!=o.eobj.labelExist.length&&0!=o.eobj.labelHover.length&&1==o.eobj.viewTmpl.length&&(o.eobj.viewTmpl.template(o.define.viewTmpl),o.define.startTime=(new Date).getTime(),o.config=o.readAttr(o.eobj.config,o.config),o.config.ajaxtimer=1e3*parseInt(o.config.ajaxtimer),o.config.maxnum=parseInt(o.config.maxnum),""!=o.config.jsonurl&&o.getData())},getData:function(){var i=setTimeout(function(){o.status.isTimeout=!0},o.config.ajaxtimer);r.ajax({url:o.config.jsonurl,cache:!0,dataType:"jsonp",timeout:o.config.ajaxtimer,success:function(e){o.status.isTimeout||(clearTimeout(i),"0"==e.code&&"0"!=e.num&&(o.vars.serviceNum=o.remakeServices(e),0<e.services.length&&(o.eobj.labelAll.hide(),o.eobj.labelExist.show(),r.tmpl(o.define.viewTmpl,e,o.templatesOption).appendTo(o.eobj.view),o.setImpression(),o.setLabelEvent())))}})},remakeServices:function(e){var i={};o.eobj.serviceId.find("li").each(function(){var e=r(this).html().split(",");if(""===e[0])return!0;e[1]===c?i[parseInt(e[0])]="":i[parseInt(e[0])]=e[1]});for(var n=e.services.length,t=[],l={},a=0;a<n;a++){var s=e.services[a].serviceid;if(i[s]!==c&&(""!==i[s]?e.services[a].serviceurl=i[s]:""!=o.config.scid_val&&(l[o.config.scid_key]=o.config.scid_val+("0"==o.config.scid_seq?"":"_"+e.services[a].serviceid),e.services[a].serviceurl=o.urlParameter(e.services[a].serviceurl,l)),t.push(e.services[a]),t.length>=o.config.maxnum))break}return e.services=t,e.num=e.services.length,e.num},setLabelEvent:function(){0!=o.eobj.label.length&&o.eobj.ashiato.hover(function(){o.eobj.labelAll.hide(),o.eobj.labelHover.show(),o.eobj.view.show(),o.setTrackingOnce()},function(){o.eobj.labelAll.hide(),o.eobj.labelExist.show(),o.eobj.view.hide()})},templatesOption:{omitStr:function(e,i,n){if(e!==c){for(var t,l,a=0,s="",o=e.length,r=0;r<o;r++){if(i<(a+=(t=escape(l=e.charAt(r))).length<4&&!/%[0|1|8-9|A-F]\w|%7F/.test(t)?1:2))return s+n;s+=l}return""+e}}},setImpression:function(){var e,i;""!=o.config.sc_impvar&&n[o.config.sc_impvar]!==c&&""!=o.config.sc_impcode&&(i="",0<(e=o.vars.serviceNum)&&e<10?i="_0"+e:10<=e&&(i="_"+e),n[o.config.sc_impvar]=o.config.sc_impcode+i)},setTrackingOnce:function(){""!=o.config.sc_hovcode&&"function"==typeof n.s_gi&&(n.s=n.s_gi(n.s_account),n.s.linkTrackVars="prop13",n.s.prop13=""+o.config.sc_hovcode,n.s.tl(o.eobj.label.get(0),"o","top_sbh")),o.setTrackingOnce=function(){}},readAttr:function(e,i){var n,t,l;if(0!=e.length)for(t=(n=e[0].attributes).length-1;0<=t;t--)(l=i[n[t].nodeName.replace(/^data-/,"")])&&(l[0]=o.affirmValue(n[t].nodeValue,l[1],l[2],l[0]));for(t in i)i[t]=i[t][0];return i},affirmValue:function(e,i,n,t){return"Int"!=i&&"Str"!=i||!o.isMatch(e,n)?"Range"==i&&(e=o.isInRange(e,n))?e:t:"Int"==i?parseInt(e):e},isMatch:function(e,i){return!(!e||!RegExp(i).test(e))},isInRange:function(e,i){return e=parseInt(e),i=i.split(",",2),parseInt(i[0])<=e&&e<=parseInt(i[1])&&e},urlParameter:function(e,i,n){var t,l,a,s,o={};if(e&&""!=e){if((e=(e=(n=!1!==n?!0:n)?unescape(e.replace(/\+/g," ")):e).split("?",2))[1])for(a=(l=e[1].split("&")).length,s=0;s<a;s++)o[(t=l[s].split("="))[0]]=t[1];if(!i)return o;if("string"==typeof i)return o[i];for(s in i)o[s]=i[s];for(s in l="",o)l+=s+"="+o[s]+"&";return e[1]=l.slice(0,-1),e=e.join("?"),e=n?encodeURI(e):e}}})}for(var r=jQuery,t=1;;){var e=r("#svcAshiato"+t);if(0==e.length)break;(new i).initialize(e),t++}r(function(){for(;;){var e=r("#svcAshiato"+t);if(0==e.length)break;(new i).initialize(e),t++}})}}(this);
