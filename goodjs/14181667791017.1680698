var clip,spinner,$shrinkLink,$copyButton,$spinner,$shrinkButton;function onCopy(n,e){resetShrinker()}function resetShrinker(){$shrinkLink.val(""),$shrinkLink.removeAttr("disabled"),$copyButton.fadeOut(500,function(){$shrinkButton.fadeIn(500)})}function doShrink(){function t(){alert("There was an error while processing your URL. Please make sure the URL you entered is valid and not an adf.ly link.")}return $.ajax({type:"post",url:"/shortener/shorten",data:{_user_id:AdFly.API_ANONYMOUS.USER_ID,_api_key:AdFly.API_ANONYMOUS.API_KEY,url:$.trim($shrinkLink.val()),csrfToken:$("#shortenIndexCsrfToken").val()},beforeSend:function(n,e){$shrinkLink.val(" "),$shrinkButton.hide(),$spinner.show()},error:function(n,e,r){t()},success:function(n,e,r){if("object"!=typeof n||0!=n.errors.length||1!=n.shorts.length){var o=[];if(0!=n.errors.length){for(var i=0;i<n.errors.length;i++)o.push(n.errors[i].message);alert(o.join("\n"))}else t();$shrinkLink.val(""),$shrinkLink.removeAttr("disabled"),$shrinkButton.show()}else $shrinkLink.val(n.shorts[0].short_url),AdFly.awesomeBrowser()&&ZeroClipboard.detectFlashSupport()?($copyButton.show(),clip.setText(n.shorts[0].short_url),clip.setHandCursor(!0)):($copyButton.hide(),$shrinkButton.show(),$shrinkLink.removeAttr("disabled"));$spinner.hide()}}),!1}$(document).ready(function(){var n;clip=null,AdFly.awesomeBrowser()&&ZeroClipboard.detectFlashSupport()&&((clip=new ZeroClipboard).setHandCursor(!0),clip.glue([$("#shrink_copy")[0]]),clip.on("complete",function(n,e){onCopy(n,e)}),$("#shrink_copy_wrapper").remove()),spinner=AdFly.createSpinner("loading_spinner"),$shrinkLink=$("#shrink_link"),$shrinkButton=$("#shrink_submit"),$copyButton=$("#shrink_copy"),$spinner=$("#loading_spinner"),"#bmlLogin"==window.location.hash&&"undefined"!=typeof bmlUrl&&bmlUrl&&(n="/login?bmlUrl="+encodeURIComponent(bmlUrl),"undefined"!=typeof bmlType&&bmlType&&(n+="&bmlType="+encodeURIComponent(bmlType)),"undefined"!=typeof bmlDomain&&bmlDomain&&(n+="&bmlDomain="+encodeURIComponent(bmlDomain)),"undefined"!=typeof bmlFolder&&bmlFolder&&(n+="&bmlFolder="+encodeURIComponent(bmlFolder)),window.location=n),$("#shrink_link").placeholder(),$("#shrink_submit").click(doShrink),$("#shrink_another").click(resetShrinker)});
