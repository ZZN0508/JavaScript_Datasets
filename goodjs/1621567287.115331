(function webpackUniversalModuleDefinition(e,t){if(typeof exports==="object"&&typeof module==="object")module.exports=t();else if(typeof define==="function"&&define.amd)define([],t);else if(typeof exports==="object")exports["AutoTrack"]=t();else e["AutoTrack"]=t()})(window,function(){return function(n){var r={};function a(e){if(r[e]){return r[e].exports}var t=r[e]={i:e,l:false,exports:{}};n[e].call(t.exports,t,t.exports,a);t.l=true;return t.exports}a.m=n;a.c=r;a.d=function(e,t,n){if(!a.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:n})}};a.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};a.t=function(t,e){if(e&1)t=a(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var n=Object.create(null);a.r(n);Object.defineProperty(n,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n};a.n=function(e){var t=e&&e.__esModule?function n(){return e["default"]}:function r(){return e};a.d(t,"a",t);return t};a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};a.p="";return a(a.s=0)}([function(e,t){var c={trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},includes:function(e,t){return e.indexOf?e.indexOf(t)!==-1:e.join("").indexOf(t)!==-1},isUndefined:function(e){return e===void 0},extend:function(){var e=function(e){var t=Object.prototype.toString;return function(){return t.call(arguments[0])==="[object "+e+"]"}};var s=e("Object");var f=e("Array");var l=e("Boolean");return function d(){var e=0;var t=false;var n;var r;var a;var i;var o;if(l(arguments[0])){e=1;t=arguments[0]}for(o=arguments.length-1;o>e;o--){a=arguments[o-1];i=arguments[o];if(s(i)||f(i)){for(var c in i){n=i[c];if(t&&(s(n)||f(n))){r=s(n)?{}:[];var u=d(t,r,n);a[c]=u}else{a[c]=i[c]}}}else{a=i}}return a}}(),getObjectValue:function(e,t,n){var r=e;var a=t.split(".");var i=a.shift();n=!c.isUndefined(n)?n:null;try{while(r&&i){r=r[i];i=a.shift()}}catch(o){console.log("arr: ",a);console.log(o)}r=r||n;return r},setCookie:function(e,t,n,r,a){var i=new Date;i.setDate(i.getDate()+n);var o="";o=""+e+"="+t+"";if(n){o+=";Expires="+i.toDateString()+""}if(r){o+=";Domain="+r+""}if(a){o+=";path="+a+""}document.cookie=o},getCookie:function(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");if(t=document.cookie.match(n)){return unescape(t[2])}else{return null}},getUrlParamas:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i");var n=window.location.search.substr(1).match(t);if(n!=null){return unescape(n[2])}return null}};var u="mp-include";var s="no-track";if(!Array.prototype.forEach){Array.prototype.forEach=function T(e,t){var n,r;if(this==null){throw new TypeError("this is null or not defined")}var a=Object(this);var i=a.length>>>0;if(typeof e!=="function"){throw new TypeError(e+" is not a function")}if(arguments.length>1){n=t}r=0;while(r<i){var o;if(r in a){o=a[r];e.call(n,o,r,a)}r++}}}if(typeof Object.assign!="function"){Object.assign=function(e){"use strict";if(e==null){throw new TypeError("Cannot convert undefined or null to object")}e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(n!=null){for(var r in n){if(Object.prototype.hasOwnProperty.call(n,r)){e[r]=n[r]}}}}return e}}function l(e){switch(typeof e.className){case"string":return e.className;case"object":return e.className.baseVal||e.getAttribute("class")||"";default:return""}}function f(e,t){var n=document.documentElement?document.documentElement.parentNode:document;t=t||n;if(t.querySelector){return t.querySelectorAll(e)}else if(e.charAt(0)==="#"){return[t.getElementById(e.slice(1))]}else if(e.charAt(0)==="."){if(t.getElementsByClassName){return t.getElementsByClassName(e.slice(1))}else{var r=[];var a=e.slice(1);var i=t.getElementsByTagName("*");for(var o=0,c=i.length;o<c;o++){var u=l(i[o]);for(var s=0,f=u.length;s<f;s++){if(u[s]===a){r.push(i[o]);break}}}return r}}else{return t.getElementsByTagName(e)}}function a(e,t){if(t){t=t.replace(/\w/,function(e){return e.toUpperCase()});return Object.prototype.toString.call(e).slice(8,-1)===t}else{var n=Object.prototype.toString.call(e);return n.slice(8,-1).toLowerCase()}}function r(e,t){if(!e){throw Error("el no exist")}if(t){var n={text:3,element:1};return n[t]===e.nodeType}else{return e.nodeType}}function d(e,t,n){if(e.addEventListener){e.addEventListener(t,n,false)}else if(e.attachEvent){e.attachEvent("on"+t,n)}else{var r=e["on"+t];if(r){e["on"+t]=function(e){n(e);r(e)}}else{e["on"+t]=n}}}function v(e,t){return e&&e.tagName&&e.tagName.toLowerCase()===t.toLowerCase()}function g(n,e){var r=null;if(!e||e.length===0){return true}var a=false;e.forEach(function(t){if(/^#/.test(t)){r=function(e){return e.id===t}}else if(/^\./.test(t)){r=function(e){return c.includes(l(e).split(" "),t.replace(/^\./,""))}}else{r=function(e){return v(e,t)}}var e=r(n,t);if(e){a=e}});return a}function i(e,t){var n=[];if(!g(e,t)){return false}for(var r=e;r.parentNode&&!v(r,"body");r=r.parentNode){n=l(r).split(" ");if(c.includes(n,u)){return true}if(c.includes(n,s)){return false}}var a=e.type||"";if(typeof a==="string"){switch(a.toLowerCase()){case"hidden":return false;case"password":return false}}var i=e.name||e.id||"";if(typeof i==="string"){var o=/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i;if(o.test(i.replace(/[^a-zA-Z0-9]/g,""))){return false}}return true}function o(e,t){if(!e||v(e,"html")||v(e,"body")||!r(e,"element")){return false}var n=e.tagName.toLowerCase();switch(n){case"form":return t.type==="submit";case"input":if(!c.includes(["button","submit"],e.getAttribute("type"))){return t.type==="change"}else{return t.type==="click"}case"select":return t.type==="change";case"textarea":return t.type==="change";default:return t.type==="click"}}function p(e){if(e===null||c.isUndefined(e)){return false}if(typeof e==="string"){e=c.trim(e);var t=/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/;if(t.test((e||"").replace(/[\- ]/g,""))){return false}var n=/(^\d{3}-?\d{2}-?\d{4}$)/;if(n.test(e)){return false}}return true}function m(e){var t="";if(v(e,"input")){t=e.value}else if(e.textContent||e.innerText){t=c.trim(e.textContent||e.innerText).split(/(\s+)/).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}return c.trim(t)}function y(e,t){var n=typeof e.target==="undefined"?e.srcElement:e.target;if(e.type!=="click"){return n}var r=n;if(t){while(!v(n,"body")&&!v(n,"html")&&!g(n,t)){n=n.parentNode}}if(v(n,"body")){n=r}return n}function w(e){var t={};var n=["action","href"];for(var r=0;r<e.attributes.length;r++){var a=e.attributes[r];if(p(a.value)&&c.includes(n,a.name)){t[a.name]=a.value}}return t}function h(e,t){var n=y(e,t.config.clickAreas);if(!i(n,t.config.onlyTrackTags)){return false}if(!o(n,e)){return false}var r=t.setData(n,e);t.track(t.config.eventName,r,t.config.carryBaseData);return true}function b(){try{var e={};var t=document.documentElement?document.documentElement.parentNode:document;if(t){e.title=t.title||"";e.referrer=t.referrer||""}if(navigator){e.lang=navigator.language||"";e.userLanguage=navigator.userLanguage||"";e.browserLanguage=navigator.browserLanguage||""}if(window&&window.location){e.url=window.location.href||"";e.sh=window.screen.height||0;e.sw=window.screen.width||0;e.cd=window.screen.colorDepth||0}if(window.performance){var n=window.performance.timing;e.load=n.loadEventEnd?n.loadEventEnd-n.navigationStart:0;e.domready=n.domContentLoadedEventEnd?n.domContentLoadedEventEnd-n.navigationStart:0;e.blank=n.domLoading-n.navigationStart}for(var r in e){if(!e[r]){delete e[r]}}return e}catch(a){console.log(a);return{}}}function E(e){var t=c.getUrlParamas("__utrace");var n=c.getCookie("__utrace");if(t){c.setCookie("__utrace",t,2e4,"39.net","/");if(n&&n!==t){this.track("new_replace_old_utrace",{old_utrace:n,__utrace:t})}}e.call(this)}function j(e,t){var n="";for(var r in t){if(n!==""){n+="&"}n+=r+"="+encodeURIComponent(t[r])}var a=new Image(1,1);a.src=e+"/1.gif?"+n}function n(e){e=e||{};var t={source:"web"};if(e.additionData){e.additionData=Object.assign(t,e.additionData)}this.config=Object.assign({},{src:"https://wt.39.net",clickAreas:["a"],onlyTrackTags:["a"],listenerEvents:["click"],eventName:"web_event",cancel_view:false,cancel_close:false,carryBaseData:true,additionData:t},e);var n=this;E.call(n,n.init)}n.prototype.init=function k(){var t=this;var n=document.documentElement?document.documentElement.parentNode:document;var r=(new Date).getTime();if(!n){console.log("document not ready yet, trying again in 500 milliseconds...");setTimeout(function(){t.init()},500);return}if(!t.config.cancel_view){var e=b();t.track("web_view",e)}if(!t.config.cancel_close){d(window,"beforeunload",function(){O.lt=(new Date).getTime();O.et=c.getObjectValue(window,"performance.timing.domLoading",0)||(r-O.dt>0?O.dt:r);O.st=O.lt-O.et;O.at=O.st-O.pt;var e=Object.assign({},O,b());t.track("web_close",e)})}a(t.config.listenerEvents,"array")&&t.config.listenerEvents.forEach(function(e){d(n,e,function(e){h(e,t)})})};function D(e){var t=localStorage.getItem("pid")||"";if(t){e["pid"]=t}return e}n.prototype.track=function _(e,t,n){var r=n||n===void 0?Object.assign({},b(),this.config.additionData):this.config.additionData;var a=Object.assign({},{type:e},t,r);a=D(a);j(this.config.src,a)};n.prototype.listener=function(e,t,r,a){var n=f(e);var i=this;for(var o=0;o<n.length;o++){var c=n[o];(function(n){d(n,t,function(){var e=r(n);var t=i.config.carryBaseData&&(a||a===void 0)?Object.assign({},w(n),b(),i.config.additionData,e):Object.assign({},i.config.additionData,e);j(i.config.src,t)})})(c)}};n.prototype.getEl=f;n.prototype.setData=function C(e,t){var n=this.config.carryBaseData?Object.assign({t:(new Date).getTime(),event:t.type,text:m(e)},w(e),b()):{t:(new Date).getTime(),event:t.type,text:m(e)};return n};n.prototype.setUser=function(e){if(e){localStorage.setItem("pid",e)}};var O={et:0,lt:0,at:0,st:0,pt:0,dt:0};function x(){var e=document.documentElement?document.documentElement.parentNode:document;if(!e){console.log("document not ready yet, trying again in 500 milliseconds...");setTimeout(function(){x()},500);return}d(window,"load",function(){!O.dt&&(O.dt=(new Date).getTime())});if(!document.addEventListener){d(e,"readystatechange",function(){O.dt=(new Date).getTime()})}else{d(e,"DOMContentLoaded",function(){O.dt=(new Date).getTime()})}var t=0;d(e,"visibilitychange",function(){if(e.hidden){t=new Date}else{t&&(O.pt+=new Date-t)}})}x();e.exports=n}])});