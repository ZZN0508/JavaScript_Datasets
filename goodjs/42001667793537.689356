YUI.add("hermes-template-tour-tooltip",function(n,t){var i=n.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(t,e,n,i,o){var a=null!=e?e:t.nullContext||{},l=t.hooks.helperMissing,s=t.escapeExpression,r=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="tour-tooltip">\n\t<p class="message">'+s("function"==typeof(t=null!=(t=r(n,"message")||(null!=e?r(e,"message"):e))?t:l)?t.call(a,{name:"message",hash:{},data:o,loc:{start:{line:2,column:20},end:{line:2,column:31}}}):t)+'</p>\n\t<div class="actions">\n\t\t<span class="cta">'+s("function"==typeof(t=null!=(t=r(n,"tooltipCtaText")||(null!=e?r(e,"tooltipCtaText"):e))?t:l)?t.call(a,{name:"tooltipCtaText",hash:{},data:o,loc:{start:{line:4,column:20},end:{line:4,column:38}}}):t)+'</span>\n\t\t<span class="progress">'+s("function"==typeof(t=null!=(t=r(n,"progress")||(null!=e?r(e,"progress"):e))?t:l)?t.call(a,{name:"progress",hash:{},data:o,loc:{start:{line:5,column:25},end:{line:5,column:37}}}):t)+"/"+s("function"==typeof(t=null!=(t=r(n,"total")||(null!=e?r(e,"total"):e))?t:l)?t.call(a,{name:"total",hash:{},data:o,loc:{start:{line:5,column:38},end:{line:5,column:47}}}):t)+"</span>\n\t</div>\n</div>"},useData:!0}),o={};n.Array.each([],function(t){var e=n.Template.get("hermes/"+t);e&&(o[t]=e)}),n.Template.register("hermes/tour-tooltip",function(t,e){return(e=e||{}).partials=e.partials?n.merge(o,e.partials):o,i(t,e)})},"@VERSION@",{requires:["template-base","handlebars-base"]}),YUI.add("hermes-template-new-feature-pulse",function(n,t){var i=n.Template.Handlebars.revive({1:function(t,e,n,i,o){var a=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return" animation-iteration-count: "+t.escapeExpression("function"==typeof(a=null!=(a=a(n,"featurePulseIterationCount")||(null!=e?a(e,"featurePulseIterationCount"):e))?a:t.hooks.helperMissing)?a.call(null!=e?e:t.nullContext||{},{name:"featurePulseIterationCount",hash:{},data:o,loc:{start:{line:14,column:98},end:{line:14,column:128}}}):a)+"; "},3:function(t,e,n,i,o){var a=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return" background-color: "+t.escapeExpression("function"==typeof(a=null!=(a=a(n,"waveOneColor")||(null!=e?a(e,"waveOneColor"):e))?a:t.hooks.helperMissing)?a.call(null!=e?e:t.nullContext||{},{name:"waveOneColor",hash:{},data:o,loc:{start:{line:15,column:75},end:{line:15,column:91}}}):a)+"; "},5:function(t,e,n,i,o){var a=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return" background-color: "+t.escapeExpression("function"==typeof(a=null!=(a=a(n,"waveTwoColor")||(null!=e?a(e,"waveTwoColor"):e))?a:t.hooks.helperMissing)?a.call(null!=e?e:t.nullContext||{},{name:"waveTwoColor",hash:{},data:o,loc:{start:{line:17,column:75},end:{line:17,column:91}}}):a)+"; "},7:function(t,e,n,i,o){var a=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return" background-color: "+t.escapeExpression("function"==typeof(a=null!=(a=a(n,"waveThreeColor")||(null!=e?a(e,"waveThreeColor"):e))?a:t.hooks.helperMissing)?a.call(null!=e?e:t.nullContext||{},{name:"waveThreeColor",hash:{},data:o,loc:{start:{line:19,column:77},end:{line:19,column:95}}}):a)+"; "},compiler:[8,">= 4.3.0"],main:function(t,e,n,i,o){var a,l=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,r=t.escapeExpression,c=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\n\n<div class="new-feature-pulse '+r("function"==typeof(a=null!=(a=c(n,"featurePulseID")||(null!=e?c(e,"featurePulseID"):e))?a:s)?a.call(l,{name:"featurePulseID",hash:{},data:o,loc:{start:{line:13,column:30},end:{line:13,column:48}}}):a)+'" data-pulse-on="'+r("function"==typeof(a=null!=(a=c(n,"featurePulseOn")||(null!=e?c(e,"featurePulseOn"):e))?a:s)?a.call(l,{name:"featurePulseOn",hash:{},data:o,loc:{start:{line:13,column:65},end:{line:13,column:83}}}):a)+"\" >\n    <div class='wave'        style=\""+(null!=(a=c(n,"if").call(l,null!=e?c(e,"featurePulseIterationCount"):e,{name:"if",hash:{},fn:t.program(1,o,0),inverse:t.noop,data:o,loc:{start:{line:14,column:36},end:{line:14,column:137}}}))?a:"")+"\n                                    "+(null!=(a=c(n,"if").call(l,null!=e?c(e,"waveOneColor"):e,{name:"if",hash:{},fn:t.program(3,o,0),inverse:t.noop,data:o,loc:{start:{line:15,column:36},end:{line:15,column:100}}}))?a:"")+"\"></div>\n    <div class='wave delay1' style=\""+(null!=(a=c(n,"if").call(l,null!=e?c(e,"featurePulseIterationCount"):e,{name:"if",hash:{},fn:t.program(1,o,0),inverse:t.noop,data:o,loc:{start:{line:16,column:36},end:{line:16,column:137}}}))?a:"")+"\n                                    "+(null!=(a=c(n,"if").call(l,null!=e?c(e,"waveTwoColor"):e,{name:"if",hash:{},fn:t.program(5,o,0),inverse:t.noop,data:o,loc:{start:{line:17,column:36},end:{line:17,column:100}}}))?a:"")+"\"></div>\n    <div class='wave delay2' style=\""+(null!=(a=c(n,"if").call(l,null!=e?c(e,"featurePulseIterationCount"):e,{name:"if",hash:{},fn:t.program(1,o,0),inverse:t.noop,data:o,loc:{start:{line:18,column:36},end:{line:18,column:137}}}))?a:"")+"\n                                    "+(null!=(a=c(n,"if").call(l,null!=e?c(e,"waveThreeColor"):e,{name:"if",hash:{},fn:t.program(7,o,0),inverse:t.noop,data:o,loc:{start:{line:19,column:36},end:{line:19,column:104}}}))?a:"")+'"></div>\n</div>'},useData:!0}),o={};n.Array.each([],function(t){var e=n.Template.get("hermes/"+t);e&&(o[t]=e)}),n.Template.register("hermes/new-feature-pulse",function(t,e){return(e=e||{}).partials=e.partials?n.merge(o,e.partials):o,i(t,e)})},"@VERSION@",{requires:["template-base","handlebars-base"]}),YUI.add("notifications-panel-view",function(i,t){var n=require("hermes-core/flog")(t);i.namespace("Views")[this.name]=i.Base.create("notifications-panel-view",i.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){this.params=t,this.notificationsHelper=new i.NotificationsHelper(this.appContext),this.selectedTabId="main",this.unreadCounts={main:void 0,admin:void 0},this.seenNotifs={main:!1,admin:!1},this.tourTooltips={tooltipA:{message:this.intlMessage({intlName:"notifications.TIP_SETTINGS"}),target:".notifications-panel .actions .settings-link",nextTooltipId:"tooltipB"},tooltipB:{message:this.intlMessage({intlName:"notifications.TIP_MUTE"}),target:".notifications-panel .notification-item .notification-context-menu-button",nextTooltipId:"tooltipC"},tooltipC:{message:this.intlMessage({intlName:"notifications.TIP_GROUPS"}),target:'.notifications-panel .nav-container .tabs [data-tab-id="admin"]'}}},subviewConfig:{"notifications-list-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerType:"panel"},"notification-banner-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,bannerType:"notif_drop"}},loadState:function(){var n=this,t=[],e=this.appContext.getViewer();return t.push(this.appContext.getModel("person-notifications-models",e.nsid).then(function(t){var e=t.getValue("unseenNotificationCounts");n.notificationsModel=t,n.unreadCounts={main:e.default||0,admin:e.groupsYouAdmin||0},n.unreadCounts.main=100<=n.unreadCounts.main?"99+":n.unreadCounts.main,n.unreadCounts.admin=100<=n.unreadCounts.admin?"99+":n.unreadCounts.admin})),t.push(this.appContext.getModel("person-groups-models",e.nsid).then(function(t){n.personGroupsModel=t})),i.Promise.all(t)},buildContainer:function(){var t=!parseInt(this.appContext.getCookie(i.config.flickr.banners.dismiss_notification_updated_banner_name))&&this.appContext.flipper.isFlipped("enable-notification-banners");parseInt(this.appContext.getCookie(i.config.flickr.banners.dismiss_notification_updated_banner_name))&&this.appContext.reissueCookie(i.config.flickr.banners.dismiss_notification_updated_banner_name,"/"),this.setContainerWithTemplate("notifications-panel",{width:this.params.width,height:this.params.height,unreadCounts:this.unreadCounts,showBanner:t,showAdminTab:0<this.personGroupsModel.getValue("adminCount")})},activate:function(){var t=this,e=this.get("container");return this.tabNodes={},this.listView=this.subviews["notifications-list-view"],this.listView.setAnalyticsLocation("panel"),this.tabContainer=e.one(".tabs"),this.tabNodes.main=this.tabContainer.one('.tab[data-tab-id="main"]'),this.tabNodes.admin=this.tabContainer.one('.tab[data-tab-id="admin"]'),this.scrollContainer=e.one(".list-container"),this.scrollContainer&&(this.scrollContainerHeight=this.scrollContainer.get("clientHeight"),this.registerEventHandler(this.scrollContainer.on("scroll",i.betterThrottle(this.handleScroll.bind(this),100,this,!1)))),this.registerEventHandler(this.tabContainer.delegate("click",this.handleTabClick.bind(this),".tab")),this.registerEventHandler(e.on("click",this.handleAnalyticsClicks.bind(this))),this.listView.setAdditionalApiParams(this.notificationsHelper.getFilterConfig("all").additionalApiParams),this.listView.isActivated?this.loadInitial():this.listView.on("activated",function(){t.loadInitial()}),this.registerEventHandler(this.appContext.flapp.before("navigate",function(t){var e=t.details[0].url,t=this.notificationsModel.getValue("unseenNotificationCounts");e&&(e.match(/^.+(\/notifications)$/)?(this.notificationsModel.setValue("unseenNotificationCounts",Object.assign(t,{total:0})),this.seenNotifs={main:!1,admin:!1}):this.notificationsModel.setValue("unseenNotificationCounts",{}))}.bind(this))),this.registerEventHandler(e.delegate("click",function(t){var e;t.metaKey||t.ctrlKey||t.which&&2===t.which||(t.target,(e=t.target.ancestor("a",!0).getAttribute("href"))&&(t.stopPropagation(),t.preventDefault(),window.location.href=e))}.bind(this),".notification-photo-thumb, .notification-item .headline-container a, .notification-item .info-container a")),this.tourTooltipStart=e.one(".tour-tooltip-start"),this.tourTooltipStart&&this.registerEventHandler(this.tourTooltipStart.on("click",this.handleTourTooltipClick.bind(this))),this},loadInitial:function(){var e=this;return this.listView.loadInitial().then(function(t){return e.tabContainer.removeClass("disabled"),e.listView.appendItems(t)}).then(function(){e.loadTooltipHelper(),e.seenNotifs.main=!0})},handleTabClick:function(t){t=t.target.ancestor(".tab",!0).getAttribute("data-tab-id");this.switchTabs(t)},switchTabs:function(t){var e=this.tabContainer.one('[data-tab-id="'+this.selectedTabId+'"] .count-in-parens');e&&e.set("text",""),t&&this.tabNodes[t]&&t!==this.selectedTabId&&(this.selectedTabId=t,Object.values(this.tabNodes).forEach(function(t){t.removeClass("selected")}),this.tabNodes[t].addClass("selected"),this.loadTab(t))},loadTab:function(t){var e=this;return this.tabContainer.addClass("disabled"),"main"===t?(this.listView.setAdditionalApiParams(this.notificationsHelper.getFilterConfig("all").additionalApiParams),this.seenNotifs.main=!0):"admin"===t&&(this.listView.setAdditionalApiParams(this.notificationsHelper.getFilterConfig("groupsYouAdmin-all").additionalApiParams),this.seenNotifs.admin=!0),this.listView.reload().then(function(){e.tabContainer.removeClass("disabled"),e.loadTooltipHelper()}).catch(function(t){n.error("error reloading notification listing",t)})},handleScroll:function(t){var e=this,n=this.scrollContainer.get("scrollTop"),i=this.scrollContainer.get("scrollHeight");!this.listView.isLoadingMore&&n+this.scrollContainerHeight+100>i&&!this.listView.isAtEnd&&(e.tabContainer.addClass("disabled"),this.listView.loadContinuated().then(function(t){return e.tabContainer.removeClass("disabled"),e.listView.appendItems(t)}))},handleTourTooltipClick:function(){this.tourTooltipHelper.startTooltips()},loadTooltipHelper:function(){var t=this.get("container"),e=Object.assign({},this.tourTooltips);t.one('.tabs .tab[data-tab-id="admin"]')||(e.tooltipB.nextTooltipId=void 0,delete e.tooltipC),t.one(".notifications-empty-state").hasClass("hidden")||(e.tooltipA.nextTooltipId=e.tooltipC?"tooltipC":void 0,delete e.tooltipB),this.tourTooltipHelper=new i.TourTooltipHelper(this.appContext,{tourTooltips:e,viewParams:this.params,container:t,showPulse:!0})},handleAnalyticsClicks:function(t){t=t.target;t.ancestor('.tab[data-tab-id="main"]',!0)?this.beaconAnalytics("Tab Click: main"):t.ancestor('.tab[data-tab-id="admin"]',!0)?this.beaconAnalytics("Tab Click: admin"):t.ancestor(".foot-link",!0)?this.beaconAnalytics("View All Click"):t.ancestor(".settings-link",!0)&&this.beaconAnalytics("Settings Click")},beaconAnalytics:function(t){i.Analytics.setDataLayerProp("notifications.actionType",t),i.Analytics.setDataLayerProp("notifications.location","panel"),i.Analytics.sendClick("","Notifications Feature Action"),i.Analytics.setDataLayerProp("notifications.actionType",""),i.Analytics.setDataLayerProp("notifications.location","")},destroy:function(){if(this.seenNotifs.admin||this.seenNotifs.main){var t={notification_groups:"hermes_2020"};this.seenNotifs.main&&(t.notification_groups+=",default"),this.seenNotifs.admin&&(t.notification_groups+=",groups_you_admin");var e=this.appContext.getViewer();return this.notificationsModel.remoteReadUnseenNotificationCount(Object.assign(t,{id:e.nsid}),this.appContext).then(function(t){n.info("succesfully updated unseenNotificationCount")}).catch(function(t){n.error("error reading unseen notifications")})}}})},"@VERSION@",{requires:["flickr-view","hermes-template-notifications-panel","notifications-helper","notification-banner-view","tour-tooltip-helper","hermes-template-tour-tooltip","hermes-template-new-feature-pulse"],langBundles:["common","notifications","relative-dates"]}),YUI.add("notifications-menu-view",function(a){"use strict";a.namespace("Views")[this.name]=a.Base.create("notifications-menu-view",a.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.pollingFailed=!1,this.shouldFetchNotifs=!0,this.viewer=this.appContext.getViewer(),this.notifFilter=this.appContext.flipper.isFlipped("enable-notifications-2020")?[]:["group_topic_new","user_gallery_comment"].join(","),""===this.get("container").get("innerHTML")&&this.setContainerWithTemplate("notifications-menu"),this},loadState:function(){var e=this;return this.viewer.signedIn?this.appContext.getModel("person-notifications-models",this.viewer.nsid).then(function(t){if(e.set("personNotificationsModel",t),Date.now()-t.getValue("unseenLastFetchedTimestamp")>a.config.flickr.notifications.loading_count_refetch_delay)return t.remoteReadUnseenNotificationCount({id:e.viewer.nsid,filter:e.notifFilter},e.appContext).then(null,function(t){e.pollingFailed=!0})}):a.Promise.resolve()},buildContainer:function(){var t=0;return this.get("personNotificationsModel")&&(t=this.formatCount99(this.get("personNotificationsModel").getValue("unseenNotificationCount"))),this.setContainerWithTemplate("notifications-menu",{unseenNotificationCount:t}),this},activate:function(){var t,e=this,n=e.get("personNotificationsModel");e.unseenBadge=e.get("container").one(".c-notification-unseencount"),e.unseenCount=0,e.notifIcon=e.get("container").one(".c-notification-icon"),this.appContext.flipper.isFlipped("enable-notifications-2020")?0<(t=n.getValue("unseenNotificationCounts")||{}).total?(e.unseenBadge.set("text",e.formatCount99(t.total)),e.unseenBadge.removeClass("hidden")):e.unseenBadge.addClass("hidden"):0===n.getValue("unseenNotificationCount")?e.unseenBadge.addClass("hidden"):e.unseenBadge.removeClass("hidden"),a.on("notifications:closeNotificationsMenuClicked",function(t){e.droparound.close()}),this.registerEventHandler(this.get("container").on("click",e.openMenu.bind(e))),this.registerEventHandler(this.get("container").on("key",e.keyboardToggleMenu.bind(e),"down:13,32")),this.registerEventHandler(this.get("container").on("key",e.enterMenu.bind(e),"down:9,40")),this.viewer.signedIn&&e.pollForUnseenNotifs()},pollForUnseenNotifs:function(){this.pollIntervalId=setInterval(this.readUnseenNotifs.bind(this),a.config.flickr.notifications.polling_delay)},readUnseenNotifs:function(){var n=this,i=n.get("personNotificationsModel");i.remoteReadUnseenNotificationCount({id:n.viewer.nsid,filter:n.notifFilter},n.appContext).then(function(t){var e;n.shouldFetchNotifs=!0,i.setValue("initialNotificationsData",{}),n.appContext.flipper.isFlipped("enable-notifications-2020")?0<(e=i.getValue("unseenNotificationCounts")||{}).total?(n.unseenBadge.set("text",n.formatCount99(e.total)),n.unseenBadge.removeClass("hidden")):n.unseenBadge.addClass("hidden"):t!==n.unseenCount&&(0!==(n.unseenCount=t)?(n.unseenBadge.removeClass("hidden"),n.unseenBadge.set("text",n.formatCount99(t))):n.unseenBadge.addClass("hidden"))},function(t){clearInterval(n.pollIntervalId),n.pollingFailed||(n.pollingFailedTimeoutId=setTimeout(n.pollForUnseenNotifs.bind(n),a.config.flickr.notifications.polling_failure_timeout)),n.pollingFailed=!0})},openMenu:function(){this.revealNotifications()},keyboardToggleMenu:function(t){t.preventDefault(),!this.droparound||this.droparound.isClosed?this.revealNotifications():this.droparound.close()},enterMenu:function(t){var e=t.keyCode;(9!==e||t.shiftKey||"true"!==t.target.getAttribute("aria-expanded"))&&40!==e||(t.preventDefault(),(t=this.droparound.get("container").one("div.notifs-droparound"))&&(t=t.one("a.mail-icon"),this.registerEventHandler(t.on("key",this.enterNotificationsList.bind(this),"down:9,40")),t.focus()))},enterNotificationsList:function(t){var e=t.keyCode;(9!==e||t.shiftKey)&&40!==e||(t.preventDefault(),this.droparound.get("subview").findFocus.call(this,this.droparound.get("container").one("div.notifs-droparound").one("ul").one("li:not(.hidden)")))},revealNotifications:function(){var t,e=this.appContext.viewportData.getWidth(),n=this.appContext.viewportData.getHeight(),i=700<e?"":e-2+"px",o=1e3<n?"800px":n-200+"px";this.appContext.flipper.isFlipped("enable-notifications-2020")?(e=this.get("container").one(".c-notification-icon"),t=Math.min(n-100,800),a.Analytics.sendClick("Notifications Bell: 2020"),t=new a.Views["notifications-panel-view"]({appContext:this.appContext,height:t}),this.droparound=new a.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,anchorOffsetVertical:-4,showDropArrow:!0,contentPadding:0,anchorElement:e,subview:t,observePageResize:!0,positionFixed:!0,autoSizeToContent:!0,preventPageScrollOnScroll:!0,width:450,arrowOffset:60}),this.droparound.show(),0<(e=(e=this.get("personNotificationsModel").getValue("unseenNotificationCounts")).total-e.default)?this.unseenBadge.set("text",this.formatCount99(e)):this.unseenBadge.addClass("hidden")):(a.Analytics.sendClick("Notifications Bell: Legacy"),(t=new a.Views["notifications-view"]({appContext:this.appContext,width:i,listHeight:o,shouldFetchNotifs:this.shouldFetchNotifs,notifFilter:this.notifFilter})).appContext=this.appContext,this.droparound=new a.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,anchorOffsetVertical:-4,showDropArrow:!0,contentPadding:0,classList:"notifs-droparound no-border big-shadow",anchorElement:this.get("container").one(".c-notification-icon"),subview:t,observePageResize:!0,positionFixed:!0,autoSizeToContent:!0,preventPageScrollOnScroll:!0}),this.droparound.show(),this.unseenBadge.addClass("hidden")),this.shouldFetchNotifs=!1},formatCount99:function(t){return 100<=t?"99+":t},destructor:function(){clearInterval(this.pollIntervalId),clearTimeout(this.pollingFailedTimeoutId)}})},"@VERSION@",{requires:["flickr-view","hermes-template-notifications-menu","fluid-droparound-view","notifications-view","notifications-panel-view"],langBundles:["notifications","common"]}),YUI.add("hermes-template-person-card",function(n,t){var i=n.Template.Handlebars.revive({1:function(t,e,n,i,o){var a,l=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"\t\t\t\t\t"+t.escapeExpression(t.lambda(null!=(a=null!=e?l(e,"person"):e)?l(a,"realname"):a,e))+"\n\t\t\t\t\t"+(null!=(a=l(n,"if").call(null!=e?e:t.nullContext||{},null!=e?l(e,"personLocation"):e,{name:"if",hash:{},fn:t.program(2,o,0),inverse:t.noop,data:o,loc:{start:{line:15,column:5},end:{line:15,column:37}}}))?a:"")+"\n"},2:function(t,e,n,i,o){return" - "},4:function(t,e,n,i,o){var a=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(o=a(n,"each").call(null!=e?e:t.nullContext||{},null!=e?a(e,"photostream"):e,{name:"each",hash:{},fn:t.program(5,o,0),inverse:t.noop,data:o,loc:{start:{line:23,column:3},end:{line:29,column:12}}}))?o:""},5:function(t,e,n,i,o){var a=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(o=a(n,"if").call(null!=e?e:t.nullContext||{},null!=e?a(e,"needsInterstitial"):e,{name:"if",hash:{},fn:t.program(6,o,0),inverse:t.program(8,o,0),data:o,loc:{start:{line:24,column:4},end:{line:28,column:11}}}))?o:""},6:function(t,e,n,i,o){var a=null!=e?e:t.nullContext||{},l=t.hooks.helperMissing,s=t.escapeExpression,r=t.lambda,c=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t\t<a href="'+s("function"==typeof(t=null!=(t=c(n,"url")||(null!=e?c(e,"url"):e))?t:l)?t.call(a,{name:"url",hash:{},data:o,loc:{start:{line:25,column:14},end:{line:25,column:21}}}):t)+'" title="'+s("function"==typeof(t=null!=(t=c(n,"title")||(null!=e?c(e,"title"):e))?t:l)?t.call(a,{name:"title",hash:{},data:o,loc:{start:{line:25,column:30},end:{line:25,column:39}}}):t)+'" width="'+s(r(null!=(t=null!=(t=null!=e?c(e,"sizes"):e)?c(t,"sq"):t)?c(t,"width"):t,e))+'" height="'+s(r(null!=(t=null!=(t=null!=e?c(e,"sizes"):e)?c(t,"sq"):t)?c(t,"height"):t,e))+'" style="background: url(https://combo.staticflickr.com/pw/images/spaceball.gif);" data-track="personCardRecentPhotosClick"></a>\n'},8:function(t,e,n,i,o){var a,l=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,r=t.escapeExpression,c=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t\t<a href="'+r("function"==typeof(a=null!=(a=c(n,"url")||(null!=e?c(e,"url"):e))?a:s)?a.call(l,{name:"url",hash:{},data:o,loc:{start:{line:27,column:14},end:{line:27,column:21}}}):a)+'" title="'+r("function"==typeof(a=null!=(a=c(n,"title")||(null!=e?c(e,"title"):e))?a:s)?a.call(l,{name:"title",hash:{},data:o,loc:{start:{line:27,column:30},end:{line:27,column:39}}}):a)+'" style="background: url('+r(t.lambda(null!=(t=null!=(t=null!=e?c(e,"sizes"):e)?c(t,"sq"):t)?c(t,"displayUrl"):t,e))+');" data-track="personCardRecentPhotosClick"></a>\n'},10:function(t,e,n,i,o){var a=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t<span class="tertiary">'+t.escapeExpression((a(n,"intlMessage")||e&&a(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"person.NO_PHOTOS"},data:o,loc:{start:{line:31,column:26},end:{line:31,column:69}}}))+"</span>\n"},compiler:[8,">= 4.3.0"],main:function(t,e,n,i,o){var a,l,s=null!=e?e:t.nullContext||{},r=t.hooks.helperMissing,c=t.escapeExpression,u=t.lambda,p=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\n<div>\n\t<section>\n\t\t<div class="follow-subview">'+c((p(n,"outlet")||e&&p(e,"outlet")||r).call(s,null!=e?p(e,"follow-view"):e,{name:"outlet",hash:{},data:o,loc:{start:{line:4,column:30},end:{line:4,column:52}}}))+'</div>\n\n\t\t<div class="attribution">\n\t\t\t<a href="'+c(u(null!=(a=null!=e?p(e,"personURLS"):e)?p(a,"photostream"):a,e))+'" data-track="personCardAttributionNameClick">\n\t\t\t\t<h3 class="fade-out">'+c(u(null!=(a=null!=e?p(e,"person"):e)?p(a,"username"):a,e))+'</h3>\n\t\t\t</a>\n\t\t</div>\n\t\t<div class="info">\n\t\t\t<span class="secondary realname fade-out">\n'+(null!=(a=p(n,"if").call(s,null!=(a=null!=e?p(e,"person"):e)?p(a,"realname"):a,{name:"if",hash:{},fn:t.program(1,o,0),inverse:t.noop,data:o,loc:{start:{line:13,column:4},end:{line:16,column:11}}}))?a:"")+"\t\t\t\t"+c("function"==typeof(l=null!=(l=p(n,"personLocation")||(null!=e?p(e,"personLocation"):e))?l:r)?l.call(s,{name:"personLocation",hash:{},data:o,loc:{start:{line:17,column:4},end:{line:17,column:22}}}):l)+'\n\t\t\t</span>\n\t\t</div>\n\n\t\t<div class="recent-photos">\n'+(null!=(a=p(n,"if").call(s,null!=e?p(e,"photostream"):e,{name:"if",hash:{},fn:t.program(4,o,0),inverse:t.program(10,o,0),data:o,loc:{start:{line:22,column:2},end:{line:32,column:9}}}))?a:"")+'\t\t</div>\n\t</section>\n</div>\n\n<div class="links secondary">\n\t<a href="'+c(u(null!=(a=null!=e?p(e,"personURLS"):e)?p(a,"sendFlickrMail"):a,e))+'" data-track="personCardMessageClick">'+c((p(n,"intlMessage")||e&&p(e,"intlMessage")||r).call(s,{name:"intlMessage",hash:{intlName:"person.MESSAGE"},data:o,loc:{start:{line:38,column:77},end:{line:38,column:118}}}))+'</a>\n\t<a href="'+c(u(null!=(a=null!=e?p(e,"personURLS"):e)?p(a,"albums"):a,e))+'" data-track="personCardAlbumsClick">'+c((p(n,"intlMessage")||e&&p(e,"intlMessage")||r).call(s,{name:"intlMessage",hash:{intlName:"person.ALBUMS"},data:o,loc:{start:{line:39,column:68},end:{line:39,column:108}}}))+'</a>\n\t<a href="'+c(u(null!=(a=null!=e?p(e,"personURLS"):e)?p(a,"favorites"):a,e))+'" data-track="personCardFavesClick">'+c((p(n,"intlMessage")||e&&p(e,"intlMessage")||r).call(s,{name:"intlMessage",hash:{intlName:"person.FAVES"},data:o,loc:{start:{line:40,column:70},end:{line:40,column:109}}}))+'</a>\n\t<a class="align-right" href="'+c(u(null!=(a=null!=e?p(e,"personURLS"):e)?p(a,"profile"):a,e))+'" data-track="personCardProfileClick">'+c((p(n,"intlMessage")||e&&p(e,"intlMessage")||r).call(s,{name:"intlMessage",hash:{intlName:"common.ABOUT"},data:o,loc:{start:{line:41,column:90},end:{line:41,column:129}}}))+"</a>\n</div>\n"},useData:!0}),o={};n.Array.each([],function(t){var e=n.Template.get("hermes/"+t);e&&(o[t]=e)}),n.Template.register("hermes/person-card",function(t,e){return(e=e||{}).partials=e.partials?n.merge(o,e.partials):o,i(t,e)})},"@VERSION@",{requires:["template-base","handlebars-base"]}),YUI.add("person-card-view",function(n){n.namespace("Views")[this.name]=n.Base.create("person-card-view",n.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.nsid=t.nsid,this.pathAlias=t.pathAlias,this.set("isActiveViewAgnostic",t.isActiveViewAgnostic||!1),""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},subviewConfig:{"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1}},loadState:function(){var e=this,t={contentType:7};return this.nsid?t.id=this.nsid:t.pathAlias=this.pathAlias,new n.FlickrPromise({person:this.appContext.getModel("person-models",t),photostream:this.appContext.getModel("photostream-models",t),personProfile:this.appContext.getModel("person-profile-models",t)}).then(function(t){return e.personModel=t.person,e.personLocation=t.personProfile.getValue("location"),t.photostream.getValue("photoPageList").getPage({page:1,perPage:5}).then(function(t){e.photostreamPhotos=t})},function(t){e.loadingError=!0,1===t.code&&"User not found"===t.message&&(e.badUser=!0)})},buildContainer:function(){var t;return this.loadingError?(t=this.badUser?'<span class="no-user">'+this.intlMessage({intlName:"person.NO_LONGER_ON_FLICKR"})+"</span>":'<span class="error-user">'+this.intlMessage({intlName:"person.ERROR_LOADING"})+"</span>",this.setContainerHTML(t)):(t=this.personModel.toJSON(),this.setContainerWithTemplate("person-card",{person:t,photostream:this.photostreamPhotos.map(function(t){return t.toJSON()}),personLocation:this.personLocation,personURLS:n.URLHelper.generatePersonUrls(this.personModel)})),this},activate:function(){var t=this.get("container"),e=t.one(".follow-view"),n=e.one(".relationship"),e=e.one(".relationship > .is-following"),t=t.one(".attribution");return n?e&&t.addClass("shorter"):t.addClass("full"),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-person-card","url-helper"],langBundles:["person","common"]}),YUI.add("person-menu-view",function(o){var a=require("hermes-core/type-validator");o.namespace("Views")[this.name]=o.Base.create("person-menu-view",o.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.containerSelector=t.containerSelector,this.excludeSelectors=[".no-menu"].concat(t.excludeSelectors||[]),this.personSelector=".avatar.person, .photo-attribution .attribution-icon, .comment-icon.circle-icon a, .show-person-menu",this.dialogCache=[],this.currentDialog,this},loadState:function(){return o.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(""),this},toJSON:function(){return o.merge(this.get("user"))},activate:function(){this.registerEventHandler(o.one(this.containerSelector).delegate("click",this.onClickTarget.bind(this),this.personSelector,this))},onClickTarget:function(t){this.shouldProcessTarget(t.target)&&(t.preventDefault(),t.halt(),t=t.target.ancestor().one(this.personSelector)||t.target.ancestor(this.personSelector)||t.target.ancestor("a"),this.createParamsAndManageState(t),o.rapidTracker.beacon(this.name,"personCardOpened"))},shouldProcessTarget:function(e){return null!==e.ancestor()&&!this.excludeSelectors.some(function(t){return e.ancestor().one(t)||e.ancestor(t)})},createParamsAndManageState:function(t){var e=this.getParams(t);this.createDialog(e,t)},getParams:function(t){var e,n={appContext:this.appContext,isActiveViewAgnostic:!0},i="";return(i=t.getData("person-nsid")||t.ancestor().getData("person-nsid"))||(0===(e=t.getAttribute("href")||t.ancestor().getAttribute("href")).indexOf("/photos")?i=e.replace("/photos/","").replace("/",""):0===e.indexOf("/groups/")&&(i=e.slice(e.lastIndexOf("/")+1))),n.disableRefreshOnRelationshipChange=t.hasClass("no-refresh"),a.nsid(i)?n.nsid=i:n.pathAlias=i,n.signature=i,n},createDialog:function(e,t){var n,i=this;this.fire("open"),o.fire("personMenuOpen",{anchorNode:t}),this.dialogCache.some(function(t){return t.key===e.signature&&(n=t.dialog,!0)}),n?n.set("anchorElement",t.ancestor().hasClass("comment-icon")?t.ancestor():t):((n=new o.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,width:350,autoSizeToContent:!0,observePageResize:!0,anchorElement:t.ancestor().hasClass("comment-icon")?t.ancestor():t,subview:new o.Views["person-card-view"](e)})).on("clickOverlay",function(t){i.nextElClicked=[t.clientX,t.clientY]}),n.on("closeDroparound",function(){setTimeout(function(){var e,t;i.nextElClicked&&((t=document.elementFromPoint(i.nextElClicked[0],i.nextElClicked[1]))&&(e=o.one(t))&&i.personSelector.split(",").some(function(t){return e.hasClass(t.replace(".",""))})&&i.shouldProcessTarget(e)&&i.createParamsAndManageState(e),i.nextElClicked=null)},10)}),10<this.dialogCache.length&&this.dialogCache.shift(),this.dialogCache.push({key:e.signature,dialog:n})),n.on("closeDroparound",function(){o.fire("personMenuClose",{anchorNode:t})}),(this.currentDialog=n).show()},closeDialog:function(){this.currentDialog&&(this.currentDialog.close(),o.fire("personMenuClose"))},destructor:function(){var e=this;this.currentDialog=null,o.Object.each(this.dialogCache,function(t){e.dialogCache[t]&&(e.dialogCache[t].destroy(),e.dialogCache[t]=null)}),this.dialogCache=[]}})},"@VERSION@",{requires:["flickr-promise","flickr-view","fluid-droparound-view","person-card-view"],langBundles:["person","common"]}),YUI.add("hermes-template-group-card",function(n,t){var i=n.Template.Handlebars.revive({1:function(t,e,n,i,o){var a=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(o=a(n,"each").call(null!=e?e:t.nullContext||{},null!=e?a(e,"groupPool"):e,{name:"each",hash:{},fn:t.program(2,o,0),inverse:t.noop,data:o,loc:{start:{line:21,column:3},end:{line:31,column:12}}}))?o:""},2:function(t,e,n,i,o){var a,l=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,r=t.escapeExpression,c=t.lambda,u=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t\n\t\t\t\t<a href="'+r("function"==typeof(a=null!=(a=u(n,"url")||(null!=e?u(e,"url"):e))?a:s)?a.call(l,{name:"url",hash:{},data:o,loc:{start:{line:23,column:13},end:{line:23,column:20}}}):a)+'" title="'+r("function"==typeof(a=null!=(a=u(n,"title")||(null!=e?u(e,"title"):e))?a:s)?a.call(l,{name:"title",hash:{},data:o,loc:{start:{line:23,column:29},end:{line:23,column:38}}}):a)+'" width="'+r(c(null!=(a=null!=(a=null!=e?u(e,"sizes"):e)?u(a,"sq"):a)?u(a,"width"):a,e))+'" height="'+r(c(null!=(a=null!=(a=null!=e?u(e,"sizes"):e)?u(a,"sq"):a)?u(a,"height"):a,e))+'"\n'+(null!=(a=u(n,"if").call(l,null!=e?u(e,"needsInterstitial"):e,{name:"if",hash:{},fn:t.program(3,o,0),inverse:t.program(5,o,0),data:o,loc:{start:{line:24,column:4},end:{line:28,column:11}}}))?a:"")+"\t\t\t\t></a>\n\t\t\t\t\n"},3:function(t,e,n,i,o){return'\t\t\t\t\tclass="restricted"\n'},5:function(t,e,n,i,o){var a=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t\tstyle="background: url('+t.escapeExpression(t.lambda(null!=(t=null!=(t=null!=e?a(e,"sizes"):e)?a(t,"sq"):t)?a(t,"displayUrl"):t,e))+');"\n'},7:function(t,e,n,i,o){var a=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(o=a(n,"if").call(null!=e?e:t.nullContext||{},null!=e?a(e,"canAddPhotos"):e,{name:"if",hash:{},fn:t.program(8,o,0),inverse:t.program(10,o,0),data:o,loc:{start:{line:33,column:3},end:{line:38,column:10}}}))?o:""},8:function(t,e,n,i,o){var a=null!=e?e:t.nullContext||{},l=t.hooks.helperMissing,s=t.escapeExpression,r=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t<p class="tertiary">'+s((r(n,"intlMessage")||e&&r(e,"intlMessage")||l).call(a,{name:"intlMessage",hash:{intlName:"groups.BE_THE_FIRST"},data:o,loc:{start:{line:34,column:24},end:{line:34,column:70}}}))+'</p>\n\t\t\t\t<p class="tertiary"><a href="'+s(t.lambda(null!=(t=null!=e?r(e,"groupURLS"):e)?r(t,"photos"):t,e))+'">'+s((r(n,"intlMessage")||e&&r(e,"intlMessage")||l).call(a,{name:"intlMessage",hash:{intlName:"groups.ADD_SOME_PHOTOS"},data:o,loc:{start:{line:35,column:55},end:{line:35,column:104}}}))+"</a></p>\n"},10:function(t,e,n,i,o){var a=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"\t\t\t\t<p>"+t.escapeExpression((a(n,"intlMessage")||e&&a(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"groups.NO_PHOTOS"},data:o,loc:{start:{line:37,column:7},end:{line:37,column:50}}}))+"</p>\n"},12:function(t,e,n,i,o){var a,l=t.escapeExpression,s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t<a href="'+l(t.lambda(null!=(a=null!=e?s(e,"groupURLS"):e)?s(a,"admin"):a,e))+'">'+l((s(n,"intlMessage")||e&&s(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"groups.ADMIN_LINK_LABEL"},data:o,loc:{start:{line:48,column:31},end:{line:48,column:81}}}))+"</a>\n"},14:function(t,e,n,i,o){var a=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(e=a(n,"if").call(null!=e?e:t.nullContext||{},null!=(e=null!=e?a(e,"group"):e)?a(e,"isModerator"):e,{name:"if",hash:{},fn:t.program(15,o,0),inverse:t.noop,data:o,loc:{start:{line:50,column:2},end:{line:52,column:9}}}))?e:""},15:function(t,e,n,i,o){var a,l=t.escapeExpression,s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t<a href="'+l(t.lambda(null!=(a=null!=e?s(e,"groupURLS"):e)?s(a,"admin"):a,e))+'">'+l((s(n,"intlMessage")||e&&s(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"groups.ADMIN_LINK_LABEL"},data:o,loc:{start:{line:51,column:32},end:{line:51,column:82}}}))+"</a>\n"},compiler:[8,">= 4.3.0"],main:function(t,e,n,i,o){var a,l=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,r=t.escapeExpression,c=t.lambda,u=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\n<div>\n\t<section>\n\t\t<div class="join-subview">\n\n\t\t\t'+r((u(n,"outlet")||e&&u(e,"outlet")||s).call(l,null!=e?u(e,"join-group-view"):e,{name:"outlet",hash:{},data:o,loc:{start:{line:6,column:3},end:{line:6,column:29}}}))+'\n\n\t\t</div>\n\n\t\t<div class="attribution">\n\t\t\t<a href="'+r(c(null!=(a=null!=e?u(e,"groupURLS"):e)?u(a,"about"):a,e))+'">\n\t\t\t\t<h3 class="fade-out">'+r((u(n,"renderTrustedMarkup")||e&&u(e,"renderTrustedMarkup")||s).call(l,null!=(a=null!=e?u(e,"group"):e)?u(a,"title"):a,{name:"renderTrustedMarkup",hash:{},data:o,loc:{start:{line:12,column:25},end:{line:12,column:60}}}))+'</h3>\n\t\t\t</a>\n\t\t</div>\n\t\t<div class="stats">\n\t\t\t<span class="secondary fade-out">'+r((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(l,{name:"intlMessage",hash:{createdYear:null!=e?u(e,"createdYear"):e,intlName:"groups.CREATED_YEAR"},data:o,loc:{start:{line:16,column:36},end:{line:16,column:106}}}))+" - "+r((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(l,{name:"intlMessage",hash:{updatedAgo:null!=e?u(e,"updatedAgo"):e,intlName:"groups.UPDATED_TIME_AGO"},data:o,loc:{start:{line:16,column:109},end:{line:16,column:181}}}))+'</span>\n\t\t</div>\n\n\t\t<div class="recent-photos">\n'+(null!=(a=u(n,"if").call(l,null!=e?u(e,"groupPool"):e,{name:"if",hash:{},fn:t.program(1,o,0),inverse:t.program(7,o,0),data:o,loc:{start:{line:20,column:2},end:{line:39,column:9}}}))?a:"")+'\t\t</div>\n\t</section>\n</div>\n\n<div class="links secondary">\n\t<a href="'+r(c(null!=(a=null!=e?u(e,"groupURLS"):e)?u(a,"photos"):a,e))+'">'+r((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(l,{name:"intlMessage",hash:{intlName:"groups.PHOTOS_LINK_LABEL"},data:o,loc:{start:{line:45,column:32},end:{line:45,column:83}}}))+'</a>\n\t<a href="'+r(c(null!=(a=null!=e?u(e,"groupURLS"):e)?u(a,"discussions"):a,e))+'">'+r((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(l,{name:"intlMessage",hash:{intlName:"groups.DISCUSSIONS_LINK_LABEL"},data:o,loc:{start:{line:46,column:37},end:{line:46,column:93}}}))+"</a>\n"+(null!=(a=u(n,"if").call(l,null!=(a=null!=e?u(e,"group"):e)?u(a,"isAdmin"):a,{name:"if",hash:{},fn:t.program(12,o,0),inverse:t.program(14,o,0),data:o,loc:{start:{line:47,column:1},end:{line:53,column:8}}}))?a:"")+"</div>"},useData:!0}),o={};n.Array.each([],function(t){var e=n.Template.get("hermes/"+t);e&&(o[t]=e)}),n.Template.register("hermes/group-card",function(t,e){return(e=e||{}).partials=e.partials?n.merge(o,e.partials):o,i(t,e)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
