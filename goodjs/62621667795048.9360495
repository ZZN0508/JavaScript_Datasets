function remove_rel_nofollow(){$("a[rel='nofollow']").each(function(){-1<$(this).attr("href").indexOf("5ch.net")&&$(this).removeAttr("rel")})}function disabledButton(t){t.prop("disabled",!0),t.text("èª­ã¿è¾¼ã¿ä¸­")}function redirect(t){window.location.href=t}function removeRedundantPost(){var e=[];$("li.thread").each(function(){var t=$(this).attr("data-board-threadid");-1!=e.indexOf(t)&&$("."+t).last().remove(),e.push(t)})}function alphanumeric(t){return/^[A-Za-z0-9]+$/.test(t)}function addHiddenPost(t){var e=getHiddenList();e.push(t),localStorage.setItem("postsHidden",JSON.stringify(e))}function getHiddenList(){return localStorage.postsHidden?JSON.parse(localStorage.postsHidden):[]}function hidePosts(){getHiddenList().forEach(function(t){$("."+t).hide()})}function clearHidePosts(){getHiddenList().forEach(function(t){$("."+t).show()}),localStorage.setItem("postsHidden",[])}function stickiedIconsButtons(){$("#main-content-box").find("ul").hasClass("threadlist_sticky")&&$(".threadlist_sticky .post_nav_buttons").each(function(){$(this).html(),$(this).prepend($('<i class="fa fa-thumb-tack" title="Sticky"></i>')),$("body").hasClass("moderator")||$("body").hasClass("admin")?$(this).append('<a href="javascript:void(0)" class="unsticky_button">[å›ºå®šã‚’è§£é™¤]</a>'):$(this).find(".post_manage_nav").remove()})}function removeStickyMainBox(){0==$(".threadlist_sticky").html().trim().length&&$(".threadlist_sticky").parent().parent().remove()}function getUrlVars(){var o={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,e,a){o[e]=a}),o}$(document).ready(function(){void 0!==localStorage.nv&&null!==localStorage.nv||($('[data-toggle="popover"]').popover({html:!0,placement:"bottom"}),$('[data-toggle="popover"]').popover("show"),localStorage.setItem("nv",1),$("body").on("click",function(t){$('[data-toggle="popover"]').each(function(){$(this).is(t.target)||0!==$(this).has(t.target).length||0!==$(".popover").has(t.target).length||$(this).popover("hide")})})),$("body").css({position:"fixed",width:"100%"}).delay(200).promise().done(function(){$("body").css("position","relative")});window.location.protocol,window.location.host;var t,e=window.location.pathname,a="/_visible"==e?"visible=true":"visible=false";removeRedundantPost(),hidePosts(),hideFilterKeywords(),remove_rel_nofollow(),stickiedIconsButtons();var o,s,n,r,i,d,l,c,u="pc";("mobile"==(u=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"mobile":u)?$(".ads-item .side-ads-pc"):$(".ads-item .side-ads-mobile")).remove(),$("#more_news_index").length&&(o="",s=(t=window.location.protocol+"//"+window.location.host+"/")+"_ads/"+u+"/repeat_content",n=t+"_pagination?pageno=",u=t,0<window.location.search.length&&(o=window.location.search,n=t+"_pagination"+o+"&pageno=",u=t+o),r="<span id='no_more'><a href='"+(u="/_visible"==e?t+"visible":u)+"'><h3>æ›´æ–°ã—ã¦æ–°ã—ã„æŠ•ç¨¿ã‚’è¡¨ç¤º</h3></a></span>",i=1,d=0,l=$("#more_news_index").offset().top-856.90625,c=!0,$(window).on("scroll resize",function(){var t;$(window).scrollTop()>l&&$("#additional_articles_loaded").val()<1e3&&1==c?(l=$("#more_news_index").offset().top,d+=8,t=n+ ++i+"&"+a,$('<div id="loader_box" align="middle"><div class="loader"></div></div>').insertAfter("#more_news_index"),$("#more_news_index").hide(),$.ajax({url:t,context:document.body,success:function(t){0!=t.length?($(".threadlist").append(t),$("#more_news_index").show(),$("#loader_box").remove(),console.log(s),removeRedundantPost(),hidePosts(),hideFilterKeywords(),remove_rel_nofollow()):($(r).insertAfter(".more-posts"),$(".more-posts").remove())}}),$("#recent_page").val(i),$("#additional_articles_loaded").val(d),c=!c):$(window).scrollTop()<l&&0==c&&(c=!c)}),$(".refresh_button").on("click",function(){redirect("/")}),$("#more_news_index").on("click",function(){d+=8;var t=n+ ++i+"&"+a;$('<div id="loader_box" align="middle"><div class="loader"></div></div>').insertAfter("#more_news_index"),$("#more_news_index").hide(),$.ajax({url:t,context:document.body,success:function(t){0!=t.length?($(".threadlist").append(t),$("#more_news_index").show(),$("#loader_box").remove(),removeRedundantPost(),hidePosts(),hideFilterKeywords(),remove_rel_nofollow()):($("#more_news_index").remove(),redirect("/_visible"==e?e:"/"))}}),$("#recent_page").val(i),$("#additional_articles_loaded").val(d)})),$(document).on("click",".unfollow-button",function(){var t=$(this).attr("data-boardid"),e=$(this),t={board:t};disabledButton(e),$.ajax({type:"POST",url:"/_unfollow_board",data:t,dataType:"text",success:function(t){"OK"===t?(e.removeClass("unfollow-button").addClass("follow-button"),e.prop("disabled",!1),e.text("ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹")):"UA"===t&&redirect("/_login")}})}),$(document).on("click",".follow-button",function(){var t=$(this).attr("data-boardid"),e=$(this),t={board:t};disabledButton(e),$.ajax({type:"POST",url:"/_follow_board",data:t,dataType:"text",success:function(t){"OK"===t?(e.removeClass("follow-button").addClass("unfollow-button"),e.prop("disabled",!1),e.text("ãƒ•ã‚©ãƒ­ãƒ¼")):"ERR_1020"===t?(e.removeClass("unfollow-button").addClass("follow-button"),e.prop("disabled",!1),e.text("ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹"),alert("ã™ã§ã«ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¾ã—ãŸã€‚")):"UA"===t&&redirect("/_login")}})}),$(document).on("click",".follow-button-user",function(){var t=$(this).attr("id"),e=$(this),t={userid:t};disabledButton(e),$.ajax({type:"POST",url:"/_follow_user",data:t,dataType:"text",success:function(t){"OK"===t?(e.removeClass("follow-button-user").addClass("unfollow-button-user"),e.prop("disabled",!1),e.text("ãƒ•ã‚©ãƒ­ãƒ¼")):"ERR_1120"===t?(e.removeClass("unfollow-button-user").addClass("follow-button-user"),e.prop("disabled",!1),e.text("ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹"),alert("ã™ã§ã«ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¾ã—ãŸã€‚")):"NG"===t?(e.removeClass("unfollow-button-user").addClass("follow-button-user"),e.prop("disabled",!1),e.text("ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹"),alert("ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã—ãŸã€‚ç®¡ç†è€…ã«å•ã„åˆã‚ã›ã¦ãã ã•ã„ã€‚")):"UA"===t&&redirect("/_login")}})}),$(document).on("click",".unfollow-button-user",function(){var t=$(this).attr("id"),e=$(this),t={userid:t};disabledButton(e),$.ajax({type:"POST",url:"/_unfollow_user",data:t,dataType:"text",success:function(t){"OK"===t?(e.removeClass("unfollow-button-user").addClass("follow-button-user"),e.prop("disabled",!1),e.text("ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹")):"NG"===t?(e.removeClass("follow-button-user").addClass("unfollow-button-user"),e.prop("disabled",!1),e.text("ãƒ•ã‚©ãƒ­ãƒ¼"),alert("ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã—ãŸã€‚ç®¡ç†è€…ã«å•ã„åˆã‚ã›ã¦ãã ã•ã„ã€‚")):"UA"===t&&redirect("/_login")}})}),$(document).on("click",".fade-buttom-thread-content",function(){$(this).removeClass("fade-buttom-thread-content")}),$(document).on("click",".ban_user",function(){var t=$(this).attr("id"),e=$(this),t={userid:t};disabledButton(e),$.ajax({type:"POST",url:"/_ban_user",data:t,dataType:"text",success:function(t){"OK"===t?(e.removeClass("ban_user").addClass("unban_user"),e.removeClass("btn-info").addClass("btn-danger"),e.prop("disabled",!1),e.text("Unban")):"NG"===t?(alert("ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã—ãŸã€‚ç®¡ç†è€…ã«å•ã„åˆã‚ã›ã¦ãã ã•ã„ã€‚"),e.prop("disabled",!1),e.text("Ban")):redirect("/_login")}})}),$("#search_input").keypress(function(t){"13"!=(t.keyCode||t.which)||""!=(t=$(this).val())&&redirect("/_search?q="+t)}),$("#search_boards_button").on("click",function(){var e,t=$("#search_boad_input").val();""!=t&&alphanumeric(t)&&(t={search_board:t},disabledButton(e=$(this)),$.ajax({type:"POST",url:"/_search_boards",data:t,dataType:"json",success:function(t){""!==t.str&&0<t.total?($(".search-boards-list-box .follow-total").html("ãƒˆãƒ¼ã‚¿ãƒ«ãƒœãƒ¼ãƒ‰æ¤œç´¢: <b>"+t.total+"</b>"),$("#search_boards").html(t.str),$("#search_boards").show()):($(".search-boards-list-box .follow-total").html("æ¿ã‚’è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚åˆ¥ã®æ¿ã‚’æŽ¢ã—ã¦ã¿ã¦ãã ã•ã„ã€‚"),$("#search_boards").hide()),e.prop("disabled",!1),e.text("æ¤œç´¢"),$(".search-boards-list-box").show()}}))}),$("#search_be_user_button").on("click",function(){var e,t=$("#search_be_user_input").val();""!=t&&alphanumeric(t)&&(t={search_be_user:t},disabledButton(e=$(this)),$.ajax({type:"POST",url:"/_search_be_user",data:t,dataType:"json",success:function(t){""!==t.str&&0<t.total?($(".search-be-users-list-box .follow-total").html("ãƒˆãƒ¼ã‚¿ãƒ«ãƒœãƒ¼ãƒ‰æ¤œç´¢: <b>"+t.total+"</b>"),$("#search_be_users").html(t.str),$("#search_be_users").show()):($(".search-be-users-list-box .follow-total").html("BEãƒ¦ãƒ¼ã‚¶ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚åˆ¥ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æ¤œç´¢ã—ã¦ã¿ã¦ãã ã•ã„ã€‚"),$("#search_be_users").hide()),e.prop("disabled",!1),e.text("æ¤œç´¢"),$(".search-be-users-list-box").show()}}))}),$(document).on("click",".sticky_button",function(){var e=$(this).closest("li.thread");e.find(".post_manage_nav").attr("style","display: none;");var t,a,o,s,n=(n=(n=e.get(0).outerHTML).replace('<a href="javascript:void(0)" class="sticky_button">[sticky]</a><a href="javascript:void(0)" class="promote_button">[promote]</a><a href="javascript:void(0)" class="age_button">[age]</a><a href="javascript:void(0)" class="sage_button">[sage]</a>',"")).replace('type="button" class="btn btn-info btn-xs unfollow-button">ãƒ•ã‚©ãƒ­ãƒ¼</button>','type="button" class="btn btn-info btn-xs follow-button">ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹</button>');1==confirm("ã“ã®æŠ•ç¨¿ã‚’å›ºå®šã—ã¾ã™ã‹?")&&(t=$(this).parent().parent().parent().parent().parent().parent().attr("data-board"),a=$(this).parent().attr("manage-post-thread"),o=$(this).parent().attr("manage-post-id"),s=e.attr("data-board-threadid"),s={b:t,th:a,p:o,post_sticky_content:n,board_threadid:s,s:!0},$.ajax({type:"POST",url:"/_mod/sticky",data:s,dataType:"json",success:function(t){t.success&&(e.remove(),$(".threadlist_sticky").prepend(n),stickiedIconsButtons()),alert(t.message)}}))}),$(document).on("click",".promote_button",function(){var t,e;1==confirm("Are you sure you wish to promote this post?")&&(t={b:$(this).parent().parent().parent().parent().parent().parent().attr("data-board"),th:$(this).parent().attr("manage-post-thread"),p:$(this).parent().attr("manage-post-id"),pr:!0},e=$(this),$.ajax({type:"POST",url:"/_mod/promote",data:t,dataType:"json",success:function(t){t.success&&(e.removeClass("promote_button").addClass("demote_button"),e.text("[demote]")),alert(t.message)}}))}),$(document).on("click",".age_button",function(){var t,e;1==confirm("Are you sure you wish to age this post?")&&(t={b:$(this).parent().parent().parent().parent().parent().parent().attr("data-board"),th:$(this).parent().attr("manage-post-thread"),p:$(this).parent().attr("manage-post-id"),a:!0},e=$(this),$.ajax({type:"POST",url:"/_mod/age",data:t,dataType:"json",success:function(t){t.success&&(e.removeClass("age_button").addClass("unage_button"),e.text("[-age]")),alert(t.message)}}))}),$(document).on("click",".sage_button",function(){var t,e;1==confirm("Are you sure you wish to sage this post?")&&(t={b:$(this).parent().parent().parent().parent().parent().parent().attr("data-board"),th:$(this).parent().attr("manage-post-thread"),p:$(this).parent().attr("manage-post-id"),sg:!0},e=$(this),$.ajax({type:"POST",url:"/_mod/sage",data:t,dataType:"json",success:function(t){t.success&&(e.removeClass("sage_button").addClass("unsage_button"),e.text("[-sage]")),alert(t.message)}}))}),$(document).on("click",".flag_post_button",function(){var e=$(this).attr("flag-action"),t=void 0!==getUrlVars().sortby?getUrlVars().sortby:"energy",a=$(this).closest("a[flag-action]"),o=$(this).parent().closest("li[data-board]"),s=$(this).parent().attr("manage-post-thread"),t={board_post_id:o.attr("data-board-threadid"),th:s,flag_post:e,sortby:t};$.ajax({type:"POST",url:"/_mod/flag_post",data:t,dataType:"json",success:function(t){t.success?"visible"==e?(a.html("[å–ã‚Šæ¶ˆã™]"),a.attr("flag-action","invisible"),a.after('<span class="fa fa-check-square"></span>')):"invisible"==e&&(a.html("[æ‰¿èª]"),a.attr("flag-action","visible"),a.next().remove()):alert(t.message)}})}),$(document).on("click",".hide_post",function(){var t=$(this).parent().parent().parent().parent().parent().attr("data-board-threadid");$("."+t).hide(),addHiddenPost(t)}),$(document).on("click","#clear_hide_posts",function(){1==confirm("éžè¡¨ç¤ºã®æŠ•ç¨¿ã‚’æœ¬å½“ã«å†è¡¨ç¤ºã—ã¾ã™ã‹ï¼Ÿ")&&clearHidePosts()}),$(document).on("click",".unsticky_button",function(){var e,t,a,o;1==confirm("å›ºå®šã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ")&&(t=(e=$(this).parent().closest("li[data-board]")).attr("data-board"),o=$(this).parent().find(".post_manage_nav").attr("manage-post-thread"),a=$(this).parent().find(".post_manage_nav").attr("manage-post-id"),o={board_post_id:e.attr("data-board-threadid"),b:t,p:a,th:o,s:!1},$.ajax({type:"POST",url:"/_mod/unsticky",data:o,dataType:"json",success:function(t){t.success?(e.remove(),alert(t.message),removeStickyMainBox()):alert(t.message)}}))}),$(document).on("click",".demote_button",function(){var t,e;1==confirm("Are you sure you wish to demote this posts?")&&(t={b:$(this).parent().closest("li[data-board]").attr("data-board"),th:$(this).parent().attr("manage-post-thread"),p:$(this).parent().attr("manage-post-id"),demote:!0},e=$(this),$.ajax({type:"POST",url:"/_mod/demote",data:t,dataType:"json",success:function(t){t.success&&(e.removeClass("demote_button").addClass("promote_button"),e.text("[promote]")),alert(t.message)}}))}),$(document).on("click",".unage_button",function(){var t,e;1==confirm("Are you sure you wish to -age this posts?")&&(t={b:$(this).parent().closest("li[data-board]").attr("data-board"),th:$(this).parent().attr("manage-post-thread"),p:$(this).parent().attr("manage-post-id"),unage:!0},e=$(this),$.ajax({type:"POST",url:"/_mod/unage",data:t,dataType:"json",success:function(t){t.success&&(e.removeClass("unage_button").addClass("age_button"),e.text("[age]")),alert(t.message)}}))}),$(document).on("click",".unsage_button",function(){var t,e;1==confirm("Are you sure you wish to -sage this posts?")&&(t={b:$(this).parent().closest("li[data-board]").attr("data-board"),th:$(this).parent().attr("manage-post-thread"),p:$(this).parent().attr("manage-post-id"),unsage:!0},e=$(this),$.ajax({type:"POST",url:"/_mod/unsage",data:t,dataType:"json",success:function(t){t.success&&(e.removeClass("unsage_button").addClass("sage_button"),e.text("[sage]")),alert(t.message)}}))}),$(document).on("click",".remove_button",function(){var e,t,a;1==confirm("ãƒ•ãƒ­ãƒ³ãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰å¤–ã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ")&&(e=$(this).parent().closest("li[data-board]"),t=$(this).parent().attr("manage-post-thread"),a={b:(a=e.attr("data-board-threadid").split("-"))[0],th:t,p:a[1]},$(this),$.ajax({type:"POST",url:"/_mod/remove_post",data:a,dataType:"json",success:function(t){t.success&&e.remove(),alert(t.message)}}))}),$(document).on("click",".unhide-post-button",function(){var t=$(this).attr("id").split("_"),e=$(this),t={b:t[0],th:t[1],p:t[2]},a=$("#total_post_deleted").html();1==confirm("Are you sure you want to undo the removal of this post?")&&$.ajax({type:"POST",url:"/_mod/undo_remove_post",data:t,dataType:"json",success:function(t){t.success&&($("#total_post_deleted").html(a-1),e.parent().parent().remove()),alert(t.message)}})}),$(".sortby_option_elem").on("change",function(t){$("option:selected",this);var e=this.value;"none"!=e&&redirect("/?sortby="+e)})});
