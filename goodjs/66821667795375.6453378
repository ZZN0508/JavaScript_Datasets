!function(k){"use strict";var M="tinyscrollbar",x={axis:"y",wheel:!0,wheelSpeed:40,wheelLock:!0,scrollInvert:!1,trackSize:!1,thumbSize:!1};function e(o,t){this.options=k.extend({},x,t),this._defaults=x,this._name=M;var e,i,n,s,c=this,a=o.find(".viewport"),h=o.find(".overview"),u=o.find(".scrollbar"),r=u.find(".track"),d=u.find(".thumb"),m=0,p="x"===this.options.axis,l="ontouchstart"in document.documentElement,S="onwheel"in document||9<=document.documentMode?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",z=p?"width":"height",w=p?"left":"top";function v(t){0<arguments.length&&t?"left"==w?h.stop(!0,!1).animate({left:-c.contentPosition+"px"},200):"top"==w&&h.stop(!0,!1).animate({top:-c.contentPosition+"px"},200):h.css(w,-c.contentPosition),d.css(w,c.contentPosition/c.trackRatio),u.css(z,c.trackSize),r.css(z,c.trackSize),d.css(z,c.thumbSize)}function b(t){k("body").addClass("noSelect"),m=p?t.pageX:t.pageY,c.thumbPosition=parseInt(d.css(w),10)||0,l?(document.ontouchmove=function(t){n=t.targetTouches[0].pageX,s=t.targetTouches[0].pageY,Math.abs(e-n)>=Math.abs(i-s)&&(t.preventDefault(),g(t.touches[0]))},document.ontouchend=P):(k(document).bind("mousemove",g),k(document).bind("mouseup",P),d.bind("mouseup",P))}function f(t){var e;c.contentRatio<1&&(t=-((e=t||window.event)["delta"+c.options.axis.toUpperCase()]||e.detail||-1/3*e.wheelDelta)/40,c.contentPosition-=t*c.options.wheelSpeed,c.contentPosition=Math.min(c.contentSize-c.viewportSize,Math.max(0,c.contentPosition)),o.trigger("move"),d.css(w,c.contentPosition/c.trackRatio),h.css(w,-c.contentPosition),(c.options.wheelLock||c.contentPosition!==c.contentSize-c.viewportSize&&0!==c.contentPosition)&&(e=k.event.fix(e)).preventDefault())}function g(t){var e;c.contentRatio<1&&(t=(e=p?t.pageX:t.pageY)-m,c.options.scrollInvert&&l&&(t=m-e),t=Math.min(c.trackSize-c.thumbSize,Math.max(0,c.thumbPosition+t)),c.contentPosition=t*c.trackRatio,o.trigger("move"),d.css(w,t),h.css(w,-c.contentPosition))}function P(){k("body").removeClass("noSelect"),k(document).unbind("mousemove",g),k(document).unbind("mouseup",P),d.unbind("mouseup",P),document.ontouchmove=document.ontouchend=null}return this.contentPosition=0,this.viewportSize=0,this.contentSize=0,this.contentRatio=0,this.trackSize=0,this.trackRatio=0,this.thumbSize=0,this.thumbPosition=0,this.update=function(t,e){var o=z.charAt(0).toUpperCase()+z.slice(1).toLowerCase();switch(this.viewportSize=a[0]["offset"+o],this.contentSize=h[0]["scroll"+o],this.contentRatio=this.viewportSize/this.contentSize,this.trackSize=this.options.trackSize||this.viewportSize,this.thumbSize=Math.min(this.trackSize,Math.max(0,this.options.thumbSize||this.trackSize*this.contentRatio)),this.trackRatio=this.options.thumbSize?(this.contentSize-this.viewportSize)/(this.trackSize-this.thumbSize):this.contentSize/this.trackSize,u.toggleClass("disable",1<=this.contentRatio),t){case"bottom":this.contentPosition=this.contentSize-this.viewportSize,v();break;case"relative":this.contentPosition=Math.min(Math.max(this.contentSize-this.viewportSize,0),Math.max(0,this.contentPosition)),v();break;default:this.contentPosition=parseInt(t,10)||0,(t||0==t)&&e?v(1):v()}return c},c.update(),function(){l?a[0].ontouchstart=function(t){1===t.touches.length&&(t.stopPropagation(),e=t.targetTouches[0].pageX,i=t.targetTouches[0].pageY,b(t.touches[0]))}:(d.bind("mousedown",b),r.bind("mousedown",g));k(window).resize(function(){c.update("relative")}),c.options.wheel&&window.addEventListener?o[0].addEventListener(S,f,!1):c.options.wheel&&(o[0].onmousewheel=f)}(),c}k.fn[M]=function(t){return this.each(function(){k.data(this,"plugin_"+M)||k.data(this,"plugin_"+M,new e(k(this),t))})}}(jQuery);
