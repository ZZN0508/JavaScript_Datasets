!function(i,o){function t(e){return"[object Array]"===Object.prototype.toString.call(e)}function r(e,n){var r=new Date;r.setTime(r.getTime()+31536e7),r="expires="+r.toUTCString(),o.cookie=e+"="+n+";"+r+";domain="+(r=location.hostname,2<location.hostname.split(".").length&&(r=location.hostname.split(".").reverse().slice(0,2).reverse().join("."),~c.indexOf(r)&&(r=location.hostname.split(".").reverse().slice(0,3).reverse().join("."))),r)+";path=/"}var a={},s={isInitialized:!1,apiUrl:null},c=["msk.ru","com.br"];function p(){if(s.customUserId)return e=function(e,n){for(var r=e;r.length<n;)r+="0";return r}(s.customUserId.replace(/\D/g,""),32);var e,n="iap.uid";return(e=function(e){for(var n=e+"=",r=o.cookie.split(";"),t=0;t<r.length;t++){for(var i=r[t];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(n))return i.substring(n.length,i.length)}return""}(n))&&32===e.length||(e=(""+1e7+-1e3+-4e3+-8e3+-1e11).replace(/1|0/g,function(){return(0|16*Math.random()).toString(16)}).replace(/-/g,""),r(n,e)),e}function u(e,n,r){n.push("uid="+p());var t,n=[s.apiUrl,e,"?",n.join("&")].join("");i.navigator.sendBeacon?(t=new Blob([JSON.stringify(r||{})],{type:"text/plain"}),i.navigator.sendBeacon(n,t)):((t=new XMLHttpRequest).open("POST",n,!0),t.setRequestHeader("Content-Type","application/json"),t.withCredentials=!0,r=JSON.stringify(r),t.send(r))}if(a.push=function(e){try{if(!t(e))throw new TypeError("iapSDK: Push item is not array");var n=e[0],r=e[1];if("function"!=typeof a[n]||"push"===n)throw new ReferenceError("iapSDK: Not found method "+n);a[n](r)}catch(e){console.error(e.message)}},a.init=function(e){if(!(e=e||{}).apiUrl)throw new TypeError("iapSDK: Init must set api url");if(s.isInitialized)throw new Error("iapSDK: SDK already init");s.isInitialized=!0,s.apiUrl=e.apiUrl,s.customUserId=e.customUserId,e.disableAutoHit||a.hit()},a.hit=function(){var e=encodeURIComponent(o.URL),n=encodeURIComponent(o.referrer);u("/tracker/hit",["url="+e,"ref="+n,"sw="+i.screen.width,"sh="+i.screen.height,"rnd="+Math.random()])},a.event=function(e){!function(){if(!s.isInitialized)throw new ReferenceError("iapSDK: SKD not initialized")}();var n={ADD_TO_CART:1,CONFIRM_ATTRIBUTION:2};if(!n[e.event])throw new TypeError("iapSDK: Unknown event type "+e.event);e.data||(e.data={}),e.event=n[e.event],u("/tracker/event",[],{event:e.event,data:e.data})},a.order=function(e){if(!e)throw new ReferenceError("iapSDK: order object undefined");u("/tracker/order",[],e)},a.conversion=function(e){if(!e)throw new ReferenceError("iapSDK: conversion object undefined");var n;"lead"===e.type&&(n={},e.category&&(n.category=e.category),e.brand&&(n.brand=e.brand),e={id:e.id+"",type:e.type,offerAlias:e.offerAlias,coupon:e.coupon,isNewCustomer:e.isNewCustomer,items:[n],comment:e.comment}),u("/tracker/conversion",[],e)},i.iapSDK&&t(i.iapSDK))for(var e=0;e<i.iapSDK.length;e++)a.push(i.iapSDK[e]);i.iapSDK=a}(window,document);