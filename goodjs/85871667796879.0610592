!function(u){u.fn.simplyCountable=function(n){n=u.extend({counter:"#counter",countType:"characters",wordSeparator:" ",maxCount:280,strictMax:!1,countDirection:"down",safeClass:"safe",overClass:"over",thousandSeparator:",",onOverCount:function(){},onSafeCount:function(){},onMaxCount:function(){}},n);var e=this,r=u(n.counter);if(!r.length)return!1;regex=new RegExp("["+n.wordSeparator+"]+");function a(){function a(){return"up"===n.countDirection?o:s}var s,o,t;"words"===n.countType?(s=n.maxCount-u.trim(e.val()).split(regex).length,""===e.val()&&(s+=1)):s=n.maxCount-e.val().length,o=s-2*s+n.maxCount,n.strictMax&&s<=0&&(t=e.val(),(s<0||t.match(new RegExp("["+n.wordSeparator+"]$")))&&n.onMaxCount(a(),e,r),"words"===n.countType?e.val(t.split(regex).slice(0,n.maxCount).join(n.wordSeparator)):e.val(t.substring(0,n.maxCount)),s=0,o=n.maxCount),r.text(function(a){if(n.thousandSeparator)for(var s=(a=a.toString()).length-3;0<s;s-=3)a=a.substr(0,s)+n.thousandSeparator+a.substr(s);return a}(a())),r.hasClass(n.safeClass)||r.hasClass(n.overClass)?s<0&&r.hasClass(n.safeClass)?(r.removeClass(n.safeClass).addClass(n.overClass),n.onOverCount(a(),e,r)):0<=s&&r.hasClass(n.overClass)&&(r.removeClass(n.overClass).addClass(n.safeClass),n.onSafeCount(a(),e,r)):s<0?r.addClass(n.overClass):r.addClass(n.safeClass)}a(),e.keyup(a)}}(jQuery);
