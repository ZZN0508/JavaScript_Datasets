function Marquee(){if(this.ID=document.getElementById(arguments[0]),!this.ID)return alert('您要设置的"'+arguments[0]+'"初始化错误\r\n请检查标签ID设置是否正确!'),void(this.ID=-1);this.Direction=this.Width=this.Height=this.DelayTime=this.WaitTime=this.CTL=this.StartID=this.Stop=this.MouseOver=0,this.Step=1,this.Timer=30,this.DirectionArray={top:0,up:0,bottom:1,down:1,left:2,right:3},"number"!=typeof arguments[1]&&"string"!=typeof arguments[1]||(this.Direction=arguments[1]),"number"==typeof arguments[2]&&(this.Step=arguments[2]),"number"==typeof arguments[3]&&(this.Width=arguments[3]),"number"==typeof arguments[4]&&(this.Height=arguments[4]),"number"==typeof arguments[5]&&(this.Timer=arguments[5]),"number"==typeof arguments[6]&&(this.DelayTime=arguments[6]),"number"==typeof arguments[7]&&(this.WaitTime=arguments[7]),"number"==typeof arguments[8]&&(this.ScrollStep=arguments[8]),this.ID.style.overflow=this.ID.style.overflowX=this.ID.style.overflowY="hidden",this.ID.noWrap=!0,this.IsNotOpera=-1==navigator.userAgent.toLowerCase().indexOf("opera"),7<=arguments.length&&this.Start()}Marquee.prototype.Start=function(){var e,t,i,s;-1!=this.ID&&(this.WaitTime<800&&(this.WaitTime=800),this.Timer<20&&(this.Timer=20),0==this.Width&&(this.Width=parseInt(this.ID.style.width)),0==this.Height&&(this.Height=parseInt(this.ID.style.height)),"string"==typeof this.Direction&&(this.Direction=this.DirectionArray[this.Direction.toString().toLowerCase()]),this.HalfWidth=Math.round(this.Width/2),this.HalfHeight=Math.round(this.Height/2),this.BakStep=this.Step,this.ID.style.width=this.Width+"px",this.ID.style.height=this.Height+"px","number"!=typeof this.ScrollStep&&(this.ScrollStep=1<this.Direction?this.Width:this.Height),(e=this).tempHTML=e.ID.innerHTML,e.Direction<=1?e.ID.innerHTML="<table cellspacing='0' cellpadding='0' style='border-collapse:collapse;'><tr><td>MSCLASS_TEMP_HTML</td></tr><tr><td>MSCLASS_TEMP_HTML</td></tr></table>".replace(/MSCLASS_TEMP_HTML/g,e.ID.innerHTML):0==e.ScrollStep&&0==e.DelayTime?e.ID.innerHTML+=e.ID.innerHTML:e.ID.innerHTML="<table cellspacing='0' cellpadding='0' style='border-collapse:collapse;display:inline;'><tr><td noWrap=true style='white-space: nowrap;word-break:keep-all;'>MSCLASS_TEMP_HTML</td><td noWrap=true style='white-space: nowrap;word-break:keep-all;'>MSCLASS_TEMP_HTML</td></tr></table>".replace(/MSCLASS_TEMP_HTML/g,e.ID.innerHTML),t=this.Timer,i=this.DelayTime,s=this.WaitTime,e.StartID=function(){e.Scroll()},e.Continue=function(){1==e.MouseOver?setTimeout(e.Continue,i):(clearInterval(e.TimerID),e.CTL=e.Stop=0,e.TimerID=setInterval(e.StartID,t))},e.Pause=function(){e.Stop=1,clearInterval(e.TimerID),setTimeout(e.Continue,i)},e.Begin=function(){if(e.ClientScroll=1<e.Direction?e.ID.scrollWidth/2:e.ID.scrollHeight/2,e.Direction<=1&&e.ClientScroll<=e.Height+e.Step||1<e.Direction&&e.ClientScroll<=e.Width+e.Step)return e.ID.innerHTML=e.tempHTML,void delete e.tempHTML;delete e.tempHTML,e.TimerID=setInterval(e.StartID,t),e.ScrollStep<0||(e.ID.onmousemove=function(t){if(0==e.ScrollStep&&1<e.Direction){t=t||window.event;if(window.event){if(!e.IsNotOpera)return void(e.ScrollStep=null);e.EventLeft=t.srcElement.id==e.ID.id?t.offsetX-e.ID.scrollLeft:t.srcElement.offsetLeft-e.ID.scrollLeft+t.offsetX}else e.EventLeft=t.layerX-e.ID.scrollLeft;e.Direction=e.EventLeft>e.HalfWidth?3:2,e.AbsCenter=Math.abs(e.HalfWidth-e.EventLeft),e.Step=Math.round(e.AbsCenter*(2*e.BakStep)/e.HalfWidth)}},e.ID.onmouseover=function(){0!=e.ScrollStep&&(e.MouseOver=1,clearInterval(e.TimerID))},e.ID.onmouseout=function(){0!=e.ScrollStep?(e.MouseOver=0)==e.Stop&&(clearInterval(e.TimerID),e.TimerID=setInterval(e.StartID,t)):0==e.Step&&(e.Step=1)})},setTimeout(e.Begin,s))},Marquee.prototype.Scroll=function(){switch(this.Direction){case 0:if(this.CTL+=this.Step,this.CTL>=this.ScrollStep&&0<this.DelayTime)return this.ID.scrollTop+=this.ScrollStep+this.Step-this.CTL,void this.Pause();this.ID.scrollTop>=this.ClientScroll&&(this.ID.scrollTop-=this.ClientScroll),this.ID.scrollTop+=this.Step;break;case 1:if(this.CTL+=this.Step,this.CTL>=this.ScrollStep&&0<this.DelayTime)return this.ID.scrollTop-=this.ScrollStep+this.Step-this.CTL,void this.Pause();this.ID.scrollTop<=0&&(this.ID.scrollTop+=this.ClientScroll),this.ID.scrollTop-=this.Step;break;case 2:if(this.CTL+=this.Step,this.CTL>=this.ScrollStep&&0<this.DelayTime)return this.ID.scrollLeft+=this.ScrollStep+this.Step-this.CTL,void this.Pause();this.ID.scrollLeft>=this.ClientScroll&&(this.ID.scrollLeft-=this.ClientScroll),this.ID.scrollLeft+=this.Step;break;case 3:if(this.CTL+=this.Step,this.CTL>=this.ScrollStep&&0<this.DelayTime)return this.ID.scrollLeft-=this.ScrollStep+this.Step-this.CTL,void this.Pause();this.ID.scrollLeft<=0&&(this.ID.scrollLeft+=this.ClientScroll),this.ID.scrollLeft-=this.Step}};
