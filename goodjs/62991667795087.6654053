define("lofty/lang/observer",function(){"use strict";function s(t){return"string"==typeof t}function f(t,r){var e;if(n(t))for(;e=t.shift();)r(e);else r(t)}function o(t){this._observer_context=t}var r={}.toString,n=Array.isArray||function(t){return"[object Array]"===r.call(t)},i=Array.prototype.slice;(o.prototype={attach:function(t,n,i){var c;return"[object Function]"===r.call(n)&&(c=this._observer_group||(this._observer_group={}),f(t,function(t){var r,e,o;r=c,e=n,o=i,s(t=t)&&(r[t]||(r[t]=[])).push({listener:e,context:o})})),this},detach:function(t,r,e){var o;return(o=this._observer_group)&&(t?f(t,function(t){!function(t,r,e,o){var n,i;if(s(r)&&(n=t[r]))if(e||o)for(var c=0;c<n.length;)i=n[c],e&&i.listener===e||o&&i.context===o?n.splice(c,1):c++;else delete t[r]}(o,t,r,e)}):delete this._observer_group),this},notify:function(t){var r,e,o;return(r=this._observer_group)&&(e=i.call(arguments,1),o=this,f(t,function(t){!function(t,r,e){var o,n;if(s(r)&&(o=t[r]))for(var i=0,c=o.length;i<c;i++)(n=o[i]).listener.apply(n.context||this._observer_context||this,e)}.call(o,r,t,e)})),this}}).on=o.prototype.attach,o.prototype.off=o.prototype.detach,o.prototype.trigger=o.prototype.notify;var t=new o(window);return t.create=function(t){return new o(t)},t.mixTo=function(t){t=t||{};var r,e=o.prototype;for(r in e)t[r]=e[r];return t},t});
