$(document).ready(function(){var e,r="mccmdealsOfferSetCount";function a(D,S){var e=$("input#AjaxOfferJSON").val();$.getJSON(e,function(e){var r,s=$("input[id='readonlycategories']").val(),o=0;void 0!==s&&null!=s&&""!=s&&(o=(r=s.split(",")).length);for(var i=[],f=[],l=0;l<e.Offers.length;l++)"0"==e.Offers[l].TrendingOfferShow&&f.push(e.Offers[l].OfferId);var a=0;1==o?a=3:2==o?a=2:3==o&&(a=1);for(var t=0;t<o;t++)for(var d=0,n=0;n<e.Offers.length;n++){for(var c=e.Offers[n].Category.split(":"),m=0;m<c.length;m++){var p=e.Offers[n].OfferId;c[m]!=r[t]||i.includes(p)||(i.push(e.Offers[n].OfferId),++d)}if(a==d)break}f.length,i.length;for(var g=0;g<f.length;g++)i.includes(f[g])||i.push(f[g]);for(var v=0;v<=i.length;v++)for(var h=0;h<e.Offers.length;h++)if(e.Offers[h].OfferId==i[v]){$("input#favouriteClass").val(),$("input#offerShareLinkPage").val(),e.Offers[h].Image,e.Offers[h].Rating,e.Offers[h].ImageDescription,e.Offers[h].PromoCodeText,e.Offers[h].PromoCode,e.Offers[h].StartDate,e.Offers[h].Expiry,e.Offers[h].ValidityDescription,e.Offers[h].Url,e.Offers[h].Brand;var u=e.Offers[h].offerViews,O=e.Offers[h].brandLink,b=(e.Offers[h].offerImage,e.Offers[h].smallOfferImage),y=e.Offers[h].EventTrackCode,C=e.Offers[h].offerDesp1,M=e.Offers[h].offerDesp2,k=e.Offers[h].offerDesp3,j=e.Offers[h].offerDesp4;e.Offers[h].categoryName,e.Offers[h].categoryLink,e.Offers[h].OfferId,e.Offers[h].offerTitle;null!=u&&""!=u&&(4==u.length?(u.substr(0,1),u.substr(2,1)):5==u.length?u.substr(1,2):6==u.length?u.substr(1,3):7==u.length&&(u.substr(0,1),u.substr(2,1))),D+="<div class='deal-card' style='height:363px'><div class='deal-inner'><div class='image'><a href='"+O+"'><img src='"+b+"'></img></a></div><div class='offer' style='height:90px'><a href='"+O+"'>"+C+"</a></div><div class='description'>"+M+k+j+"</div><div class='buttons'><a href='"+O+"' rel='"+y+"' class='ic-btn'>Know more</a></div></div></div>",$("div").hasClass("deals-and-more-offers")?S+="<div class='offer'><a href='"+O+"' rel='"+y+"'><img src='"+b+"'><p>"+C+"</p></a></div>":console.log("deals and more offers not visible"),0;break}D+="</div>",S+="</div>",$("#mccmtrendingoffers")&&$("#mccmtrendingoffers").append(D),$("#trendingoffers")&&$("#trendingoffers").append(D),$(".deals-and-more-offers")&&$(".deals-and-more-offers").append(S);s=$.cookie("mccmdealsOfferSetCount");1!=s&&2!=s&&3!=s||$("#deal"+s).css("display","block"),$(".offer-slider").slick({dots:!0,infinite:!0,autoplay:!0,autoplaySpeed:2e3,speed:300,slidesToShow:1,slidesToScroll:1}),$("#trendingoffers .trending-deals-slider").slick({dots:!0,infinite:!0,autoplay:!0,speed:500,slidesToShow:3,slidesToScroll:1,responsive:[{breakpoint:1025,settings:{slidesToShow:2}},{breakpoint:767,settings:{slidesToShow:1,arrows:!1,dots:!0}},{breakpoint:640,settings:{slidesToShow:1,arrows:!1,dots:!0,centerMode:!0,centerPadding:"15px",infinite:!0}}]}),$("#mccmtrendingoffers .trending-deals-slider").slick({dots:!0,infinite:!0,autoplay:!0,speed:500,slidesToShow:3,slidesToScroll:1,responsive:[{breakpoint:1025,settings:{slidesToShow:2}},{breakpoint:767,settings:{slidesToShow:1,arrows:!1,dots:!0}},{breakpoint:640,settings:{slidesToShow:1,arrows:!1,dots:!0,centerMode:!0,centerPadding:"15px",infinite:!0}}]})})}function D(){var e,r,s,o,i,f,l,a=$("#mccmTrendingLivesiteIdVal").val();void 0!==a?null!=a&&""!=a&&(a=a.replace(",","and"),e=[],"undefined"!=typeof FedID&&null!=FedID&&""!=FedID&&(r="mccmCategoryOffers",s=window.location.href,new URL(s).searchParams.get("id"),i=1,null!=(o=a)&&(null==jQuery.cookie(r)?jQuery.cookie(r,o,{path:"/"},{expires:i}):(console.log("Already cookie set"),f=jQuery.cookie(r)+"and",e.push(f+=o),l=e.filter(function(e,r,s){return r==s.indexOf(e)}),jQuery.cookie(r,l,{path:"/"},{expires:i}))))):(console.log("Set Cookie Value fetched"),e=[],"undefined"!=typeof FedID&&null!=FedID&&""!=FedID&&(r="mccmCategoryOffers",s=window.location.href,i=1,null!=(o=new URL(s).searchParams.get("id"))&&(null==jQuery.cookie(r)?jQuery.cookie(r,o,{path:"/"},{expires:i}):(f=jQuery.cookie(r)+"and",e.push(f+=o),l=e.filter(function(e,r,s){return r==s.indexOf(e)}),jQuery.cookie(r,l,{path:"/"},{expires:i})))))}function S(e,r){return(e=e.toLowerCase())<(r=r.toLowerCase())?-1:r<e?1:0}function w(e,l,a){for(var r=$("#AjaxOfferJSON").val(),t=[],s=0;s<e.length;s++)t.push(e[s]);t.length;var d,n=[];$.getJSON(r,function(e){for(var r=e.Offers,s=0;s<r.length;s++)d=r[s].offerViews,n.push(d);for(var o=0;o<r.length;o++)for(var i=0;i<t.length;i++)console.log("mccmCategoryIdVal: "+t[i]),sortedfiltereddata=$.grep(r,function(e,r){return e.LivesiteId!=t[i]}),console.log("sortedfiltereddata data: "+sortedfiltereddata.length),r=sortedfiltereddata;for(var f=0,o=0;o<r.length;o++)if(f<3-t.length){console.log("sortedDefaultUnicaPopularOfferJson[i].LivesiteId: "+r[o].LivesiteId);for(i=0;i<t.length;i++)console.log("mccmCategoryIdVal: "+t[i]),r[o].LivesiteId==t[i]||(console.log("No offer matched"),f+=1);console.log("No existing mccm offers matched."),""!=r[o].offerDesp1&&"undefined"!=r[o].offerDesp1?(r[o].offerDesp1,r[o].offerDesp2):(r[o].offerDesp2,r[o].offerDesp3,r[o].offerDesp4),r[o].offerDesp1,l+="<div class='deal-card' style='height:363px'><div class='deal-inner'><div class='image'><a href='"+r[o].brandLink+"'><img src='"+r[o].smallOfferImage+"'></img></a></div><div class='offer' style='height:90px'><a href='"+r[o].brandLink+"'>"+r[o].offerDesp1+"</a></div><div class='description'>"+r[o].offerDesp2+r[o].offerDesp3+r[o].offerDesp4+"</div><div class='buttons'><a href='"+r[o].brandLink+"' class='ic-btn'>Know more</a></div></div></div>",$("div").hasClass("deals-and-more-offers")?a+="<div class='offer'><a href='"+r[o].brandLink+"'><img src='"+r[o].smallOfferImage+"'><p>"+r[o].offerDesp1+"</p></a></div>":console.log("deals and more offers not visible")}l+="</div>",a+="</div>",$("#mccmtrendingoffers").append(l),$(".deals-and-more-offers").append(a);e=$.cookie("mccmdealsOfferSetCount");1!=e&&2!=e&&3!=e||$("#deal"+e).css("display","block"),$(".offer-slider").slick({dots:!0,infinite:!0,autoplay:!0,autoplaySpeed:2e3,speed:300,slidesToShow:1,slidesToScroll:1}),$("#trendingoffers .trending-deals-slider").slick({dots:!0,infinite:!0,autoplay:!0,speed:500,slidesToShow:3,slidesToScroll:1,responsive:[{breakpoint:1025,settings:{slidesToShow:2}},{breakpoint:767,settings:{slidesToShow:1,arrows:!1,dots:!0}},{breakpoint:640,settings:{slidesToShow:1,arrows:!1,dots:!0,centerMode:!0,centerPadding:"15px",infinite:!0}}]}),$("#mccmtrendingoffers .trending-deals-slider").slick({dots:!0,infinite:!0,autoplay:!0,speed:500,slidesToShow:3,slidesToScroll:1,responsive:[{breakpoint:1025,settings:{slidesToShow:2}},{breakpoint:767,settings:{slidesToShow:1,arrows:!1,dots:!0}},{breakpoint:640,settings:{slidesToShow:1,arrows:!1,dots:!0,centerMode:!0,centerPadding:"15px",infinite:!0}}]})})}null==jQuery.cookie(r)?jQuery.cookie(r,1,{expires:1}):(e=jQuery.cookie(r),1<=(e=parseInt(e))&&e<3&&(e++,jQuery.cookie(r,e,{expires:1})),3<=e&&jQuery.cookie(r,1,{expires:1})),D(),$("body").hasClass("indexPage")&&$("h1.visitedOffer").css("margin","10px 10px -25px 10px"),function(){if(null!=jQuery.cookie("mccmCategoryOffers")){$(".deals-and-more-offers").empty();for(var e=$.cookie("mccmCategoryOffers").split("and"),p=[],r=0;r<e.length;r++)p.push(e[r]);if(0<(l=$("#mccmTrendingCategoryValCount").val())){$(".offerContent").empty();for(var s=$("#unica-popular-offer-json").val(),o=[],r=1;r<=l;r++)o.push($("#mccmTrendingCategory"+r).val());$("#mccmTrendingCategoryVal").val(o);var i=$("#mccmTrendingCategoryVal").val();$(".offerContent").css("display","block"),$(".locate-near-by").css("display","none");var f=$("#mccmTrendingCategoryValCount").val(),g=i.split(","),v=[],h=[],u=[],O=[],b=[],y=[],C=[];0<f?$.getJSON(s,function(e){C=e.UnicaPopularOffers;for(var s=0;s<p.length;s++)filtereddata=$.grep(C,function(e,r){return e.Livesite!=p[s]}),C=filtereddata;for(var r=filtereddata.sort(function(e,r){return S(e.MCCMCategory,r.MCCMCategory)}),o=0;o<r.length;o++)j=r[o].MCCMCategory,u.push(j);$.each(r,function(e,r){-1==$.inArray(r.MCCMCategory,O)&&(O.push(r.MCCMCategory),b.push(r))}),b=JSON.stringify(b),filteredMccmObj=JSON.parse(b);for(var i=0,f=[],l="<div class='trending-deals-slider'>",a="<div class='offer-slider'>",t=0;t<g.length;t++)for(var d=0;d<filteredMccmObj.length;d++)if(M=r[d].Category.split(":"),k=r[d].Livesite.split(":"),g[t]===filteredMccmObj[d].MCCMCategory){i+=1,y.push(g[t]),f.push(filteredMccmObj[d].Livesite);for(var n=0;n<k.length;n++)for(var c=0,m=0;m<M.length;m++)c+=1,v.push(M[m]),h.push(k[n]),1<c||(""!=filteredMccmObj[d].offerDesp1&&"undefined"!=filteredMccmObj[d].offerDesp1?(filteredMccmObj[d].offerDesp1,filteredMccmObj[d].offerDesp2):(filteredMccmObj.offerDesp2,filteredMccmObj[d].offerDesp3,filteredMccmObj[d].offerDesp4),filteredMccmObj[d].offerDesp1,l+="<div class='deal-card' style='height:363px'><div class='deal-inner'><div class='image'><a href='"+filteredMccmObj[d].brandLink+"' ><img src='"+filteredMccmObj[d].smallOfferImage+"'></img></a></div><div class='offer' style='height:90px'><a href='"+filteredMccmObj[d].brandLink+"' >"+filteredMccmObj[d].offerDesp1+"</a></div><div class='description'>"+filteredMccmObj[d].offerDesp2+filteredMccmObj[d].offerDesp3+filteredMccmObj[d].offerDesp4+"</div><div class='buttons'><a href='"+filteredMccmObj[d].brandLink+"' class='ic-btn'>Know more</a></div></div></div>",$("div").hasClass("deals-and-more-offers")?a+="<div class='offer'><a href='"+filteredMccmObj[d].brandLink+"'><img src='"+filteredMccmObj[d].smallOfferImage+"'><p>"+filteredMccmObj[d].offerDesp1+"</p></a></div>":console.log("deals and more offers not visible"))}e=$.cookie("mccmdealsOfferSetCount");1!=e&&2!=e&&3!=e||$("#deal"+e).css("display","block"),$("#mccmTrendingLivesiteIdVal").val(f),D(),0==i?console.log("no mccm offer matched"):1==i?console.log("one mccm offer matched"):2==i?console.log("two mccm offers matched"):3==i?console.log("three mccm offers matched"):console.log("more than three mccm offer matched"),w(f,l,a)}):console.log("no mccm offers found")}else a("<div class='trending-deals-slider'>","<div class='offer-slider'>")}else{var l;if(console.log("Cookie value not found"),$(".deals-and-more-offers").empty(),0<(l=$("#mccmTrendingCategoryValCount").val())){$(".offerContent").empty();for(s=$("#unica-popular-offer-json").val(),o=[],r=1;r<=l;r++)o.push($("#mccmTrendingCategory"+r).val());$("#mccmTrendingCategoryVal").val(o);i=$("#mccmTrendingCategoryVal").val();$(".offerContent").css("display","block"),$(".locate-near-by").css("display","none");var M,k,j,f=$("#mccmTrendingCategoryValCount").val(),g=i.split(","),v=[],h=[],u=[],O=[],b=[],y=[],C=[];0<f?$.getJSON(s,function(e){console.log("success"),console.log("Unica Popular Offers: "+e.UnicaPopularOffers.length);for(var r=e.UnicaPopularOffers.sort(function(e,r){return S(e.MCCMCategory,r.MCCMCategory)}),s=0;s<r.length;s++)j=r[s].MCCMCategory,u.push(j);$.each(r,function(e,r){-1==$.inArray(r.MCCMCategory,O)&&(O.push(r.MCCMCategory),b.push(r))}),b=JSON.stringify(b),console.log(b),filteredMccmObj=JSON.parse(b);for(var o=0,i=[],f="<div class='trending-deals-slider'>",l="<div class='offer-slider'>",a=0;a<g.length;a++){console.log("MCCM ID: "+g[a]);for(var t=0;t<filteredMccmObj.length;t++)if(M=r[t].Category.split(":"),k=r[t].Livesite.split(":"),console.log("LSCS ID: "+filteredMccmObj[t].MCCMCategory),g[a]===filteredMccmObj[t].MCCMCategory){console.log("Matched id: "+g[a]),o+=1,y.push(g[a]),i.push(filteredMccmObj[t].Livesite);for(var d=0;d<k.length;d++)for(var n=0,c=0;c<M.length;c++)n+=1,v.push(M[c]),h.push(k[d]),1<n||(""!=filteredMccmObj[t].offerDesp1&&"undefined"!=filteredMccmObj[t].offerDesp1?(filteredMccmObj[t].offerDesp1,filteredMccmObj[t].offerDesp2):(filteredMccmObj.offerDesp2,filteredMccmObj[t].offerDesp3,filteredMccmObj[t].offerDesp4),filteredMccmObj[t].offerDesp1,f+="<div class='deal-card' style='height:363px'><div class='deal-inner'><div class='image'><a href='"+filteredMccmObj[t].brandLink+"'><img src='"+filteredMccmObj[t].smallOfferImage+"'></img></a></div><div class='offer' style='height:90px'><a href='"+filteredMccmObj[t].brandLink+"'>"+filteredMccmObj[t].offerDesp1+"</a></div><div class='description'>"+filteredMccmObj[t].offerDesp2+filteredMccmObj[t].offerDesp3+filteredMccmObj[t].offerDesp4+"</div><div class='buttons'><a href='"+filteredMccmObj[t].brandLink+"' class='ic-btn'>Know more</a></div></div></div>",$("div").hasClass("deals-and-more-offers")?l+="<div class='offer'><a href='"+filteredMccmObj[t].brandLink+"'><img src='"+filteredMccmObj[t].smallOfferImage+"'><p>"+filteredMccmObj[t].offerDesp1+"</p></a></div>":console.log("deals and more offers not visible"))}}e=$.cookie("mccmdealsOfferSetCount");1!=e&&2!=e&&3!=e||$("#deal"+e).css("display","block"),$("#mccmTrendingLivesiteIdVal").val(i),D(),0==o?console.log("no mccm offer matched"):1==o?console.log("one mccm offer matched"):2==o?console.log("two mccm offers matched"):3==o?console.log("three mccm offers matched"):console.log("more than three mccm offer matched"),w(i,f,l)}):console.log("no mccm offers found")}else a("<div class='trending-deals-slider'>","<div class='offer-slider'>")}}(),$(".offer-slider").slick({dots:!0,infinite:!0,autoplay:!0,autoplaySpeed:2e3,speed:300,slidesToShow:1,slidesToScroll:1}),$("#trendingoffers .trending-deals-slider").slick({dots:!0,infinite:!0,autoplay:!0,speed:500,slidesToShow:3,slidesToScroll:1,responsive:[{breakpoint:1025,settings:{slidesToShow:2}},{breakpoint:767,settings:{slidesToShow:1,arrows:!1,dots:!0}},{breakpoint:640,settings:{slidesToShow:1,arrows:!1,dots:!0,centerMode:!0,centerPadding:"15px",infinite:!0}}]})});
