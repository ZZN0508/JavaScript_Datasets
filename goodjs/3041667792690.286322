YUI.add("io-xdr",function(i,e){function n(e,t,r){return"flash"===t&&(e.c.responseText=decodeURI(e.c.responseText)),"xml"===r&&(e.c.responseXML=i.DataType.XML.parse(e.c.responseText)),e}var r=i.publish("io:xdrReady",{fireOnce:!0}),d={},c={},a=i.config.doc,s=i.config.win,u=s&&s.XDomainRequest;i.mix(i.IO.prototype,{_transport:{},_ieEvt:function(e,t){var r=this,a=e.id,i="timeout";e.c.onprogress=function(){c[a]=3},e.c.onload=function(){c[a]=4,r.xdrResponse("success",e,t)},e.c.onerror=function(){c[a]=4,r.xdrResponse("failure",e,t)},e.c.ontimeout=function(){c[a]=4,r.xdrResponse(i,e,t)},e.c[i]=t[i]||0},xdr:function(e,t,r){var a=this;return"flash"===r.xdr.use?(d[t.id]=r,s.setTimeout(function(){try{t.c.send(e,{id:t.id,uid:t.uid,method:r.method,data:r.data,headers:r.headers})}catch(e){a.xdrResponse("transport error",t,r),delete d[t.id]}},i.io.xdr.delay)):u?(a._ieEvt(t,r),t.c.open(r.method||"GET",e),setTimeout(function(){t.c.send(r.data)},0)):t.c.send(e,t,r),{id:t.id,abort:function(){return!!t.c&&t.c.abort(t.id,r)},isInProgress:function(){return!!t.c&&(e=t.id,u?4!==c[e.id]:e.c.isInProgress(e.id));var e},io:a}},xdrResponse:function(e,t,r){r=d[t.id]||r;var a=this,i=u?c:d,s=r.xdr.use,o=r.xdr.dataType;switch(e){case"start":a.start(t,r);break;case"success":a.success(n(t,s,o),r),delete i[t.id];break;case"timeout":case"abort":case"transport error":t.c={status:0,statusText:e};case"failure":a.failure(n(t,s,o),r),delete i[t.id]}},_xdrReady:function(e,t){i.fire(r,e,t)},transport:function(e){var t,r;"flash"===e.id&&(t=i.UA.ie?e.src+"?d="+(new Date).valueOf().toString():e.src,r=i.id,e=e.uid,r='<object id="io_swf" type="application/x-shockwave-flash" data="'+t+'" width="0" height="0"><param name="movie" value="'+t+'"><param name="FlashVars" value="yid='+r+"&uid="+e+'"><param name="allowScriptAccess" value="always"></object>',e=a.createElement("div"),a.body.appendChild(e),e.innerHTML=r,i.IO.transports.flash=function(){return a.getElementById("io_swf")})}}),i.io.xdrReady=function(e,t){var r=i.io._map[t];i.io.xdr.delay=0,r._xdrReady.apply(r,[e,t])},i.io.xdrResponse=function(e,t,r){var a=i.io._map[t.uid];a.xdrResponse.apply(a,[e,t,r])},i.io.transport=function(e){var t=i.io._map["io:0"]||new i.IO;e.uid=t._uid,t.transport.apply(t,[e])},i.io.xdr={delay:100}},"3.12.0",{requires:["io-base","datatype-xml-parse"]});
