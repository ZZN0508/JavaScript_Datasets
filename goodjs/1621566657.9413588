AdsPlugin=function(){function i(e){window.performance&&performance.mark&&performance.mark(e)}function t(e){i("ad-manager-loaded"),r.dispatchEvent({type:pe,id:"adManagerLoaded"});var t=new google.ima.AdsRenderingSettings;t.disableUi=!0,t.uiElements=[],t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.useStyledLinearAds=!0,(F=e.getAdsManager(p,t)).addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,je),F.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,Ge),F.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,ze),F.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,We),F.addEventListener(google.ima.AdEvent.Type.LOADED,xe),F.addEventListener(google.ima.AdEvent.Type.COMPLETE,Ve),F.addEventListener(google.ima.AdEvent.Type.STARTED,He),F.addEventListener(google.ima.AdEvent.Type.CLICK,qe),F.addEventListener(google.ima.AdEvent.Type.DURATION_CHANGE,Ue),F.addEventListener(google.ima.AdEvent.Type.IMPRESSION,Fe),F.addEventListener(google.ima.AdEvent.Type.LOG,Be),F.addEventListener(google.ima.AdEvent.Type.PAUSED,Oe),F.addEventListener(google.ima.AdEvent.Type.RESUMED,Re),F.addEventListener(google.ima.AdEvent.Type.FIRST_QUARTILE,De),F.addEventListener(google.ima.AdEvent.Type.MIDPOINT,De),F.addEventListener(google.ima.AdEvent.Type.THIRD_QUARTILE,De),F.addEventListener(google.ima.AdEvent.Type.COMPLETE,De),ge&&ke()}function o(e,t,n){return(e=document.createElement(e)).id=t,n.appendChild(e),e}function d(e,t,n,a,i,o,d){var s=document.createElement("button");return s.id=e,s.className=t,s.title=n,(t=document.createElement("span")).className="ads_hiddenElement",t.innerHTML=n,t.setAttribute("aria-hidden","true"),s.appendChild(t),(t=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("width",a),t.setAttribute("height",i),t.setAttribute("viewBox",o),(o=document.createElementNS("http://www.w3.org/2000/svg","use")).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#"+d),t.appendChild(o),s.appendChild(t),s}function s(){Lt(),i("ad-sdk-loaded"),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(q),p=r.requestVideoElement(!0),U=window.Device&&Device.iPhoneOutOfPagePlayback?new google.ima.AdDisplayContainer(L):(google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),new google.ima.AdDisplayContainer(L,p)),(H=new google.ima.AdsLoader(U)).addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,t),H.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,ze),r.listenerObject={playlistLoading:Te,playlistLoaded:be,userPlay:Ie,playing:Se,ended:_e,resize:Ce,fullscreenEnter:Ae,fullscreenExit:he,error:Le,"bbc.smp.plugins.ads.event.updateAdTag":Pe,"bbc.smp.plugins.preview.complete":fe,pluginLoaded:ve};var e=r.playlist;e&&be({playlist:e}),r.addContextMenuItem("AdsPluginHTML","AdsPluginHTML.5.2.3")}var r,l,u,c,g,n,a,p,m,E,y,v,f,A,h,T,L,b,I,S,k,_,C,N,P,w,M,D,O,R,B,x,U,H,F,e=/windows phone/i.test(navigator.userAgent),V=/iPhone/i.test(navigator.userAgent)&&!e,j=/iPod/i.test(navigator.userAgent)&&!e,G=!!(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i)),W=!1,z=!1,Q=[],q="en",K=Number.POSITIVE_INFINITY,Y=function(){},Z=!1,$=!1,X=!1,J=!1,ee=!1,te=!1,ne=!1,ae=!1,ie=!1,oe=!0,de=!1,se=!1,re=!1,le=!1,ue=!1,ce=!1,ge=!1,pe="adsPlugin",me="adError",Ee="adDuration",ye={en:"ADVERTISEMENT",pl:"REKLAMA",da:"REKLAME",nl:"ADVERTENTIE",fi:"MAINOS",fr:"RÃ‰CLAME",de:"ANKÃœNDIGUNG",id:"ADPERTENSI",it:"INSERZIONE",ja:"åºƒå‘Š",nn:"ANNONSE",pt:"PROPAGANDA",es:"RECLAMO",sw:"TANGAZO",sv:"REKLAM"},ve=function(e){-1===e.url.indexOf("dfpAds")&&(Q=r.datastore.get("plugins").slice()),bt()},fe=function(e){(re=!0)!==m.hasAds&&!0!==W||(Z=!0,we())},Ae=function(e){ie=!0,Ke(_,"ads_exitFullScreenButton","Exit Full Screen","22","22","0 0 32 32","fullscreen-return"),a=setTimeout(Ne,510)},he=function(e){ie=!1,Ke(_,"ads_enterFullScreenButton","Enter Full Screen","44","44","0 0 44 44","fullscreen-enter"),a=setTimeout(Ne,510)},Te=function(e){Qe(!0),m=null,de=ue=le=re=ae=ne=te=ee=J=X=$=Z=!1,K=Number.POSITIVE_INFINITY,ce=!1,clearInterval(y),clearInterval(v),clearInterval(n)},Le=function(e){"critical"==e.severity&&Te()},be=function(e){m||!0!==(m=e.playlist).hasAds&&!0!==W||(Z=!0,we())},Ie=function(e){!0===Z&&!1===J&&(i("ad-container-init"),U.initialize(),Me())},Se=function(e){ge=!0,Z&&(J?!X&&F&&ke():(U.initialize(),Me()))},ke=function(){X=!0;try{F.init(L.clientWidth,L.clientHeight,google.ima.ViewMode.NORMAL),F.start()}catch(e){Qe()}},_e=function(e){(ae=!0)===Z&&!1===ne?(oe=!1,Xe(),Je(T),H.contentComplete()):(V||j)&&p.webkitExitFullScreen()},Ce=function(e){Ne()},Ne=function(){F&&F.resize(L.clientWidth,L.clientHeight,ie?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)},Pe=function(e){l=e.data.adTag},we=function(){se&&!re||(r.pauseAt([0]),$||($=!0,Y()))},Me=function(){i("ad-request"),oe=!1,h.style.display="block",Xe(),Je(T),r.datastore.set({name:"adsPlaying",data:!0});var e=new google.ima.AdsRequest;e.adTagUrl=l,e.linearAdSlotWidth=L.clientWidth,e.linearAdSlotHeight=L.clientHeight,e.nonLinearAdSlotWidth=L.clientWidth,e.nonLinearAdSlotHeight=L.clientHeight,H.requestAds(e),r.dispatchEvent({type:pe,id:"adRequest"}),J=!0},De=function(e){r.dispatchEvent({type:pe,id:"adProgress",progress:e.type})},Oe=function(e){Ke(S,"ads_playButton","Play","31","31","0 0 44 44","play"),clearInterval(y),clearInterval(v),ee=!0},Re=function(e){!0===ee&&(Ke(S,"ads_pauseButton","Pause","31","31","0 0 44 44","pause"),y=setInterval(ot,250),f.isSkippable&&0<K&&ce&&(v=setInterval(it,250)),ee=!1)},Be=function(e){e=e.getAdData();e&&e.adError&&("1009"===(e=e.adError).getErrorCode()&&i("ad-empty"),r.dispatchEvent({type:pe,id:me,code:e.getErrorCode(),msg:e.getMessage()}))},xe=function(e){i("ad-loaded");var t=e.getAd();E=parseInt(t.getDuration()),r.dispatchEvent({type:pe,id:Ee,duration:E});e=e.getAdData(),e={adId:e.adWrapperIds[0]||e.adId||"NULL",adQueryId:e.adQueryId,adSystem:e.adSystem,creativeId:e.adWrapperCreativeIds[0]||e.creativeId||"NULL",duration:e.duration,mediaUrl:e.mediaUrl,title:e.title};r.dispatchEvent({type:pe,id:"adData",info:e})},Ue=function(e){0<e.getAd().getDuration()&&(E=parseInt(e.getAd().getDuration()),r.dispatchEvent({type:pe,id:Ee,duration:E}))},He=function(e){i("ad-started"),!0===(f=e.getAd()).isUiDisabled()?(ce=!0,Je(x),B.style.bottom="",B.style.height="100%",G&&Je(O)):(ce=!1,B.style.bottom="0",B.style.height="47px",G&&(et(O),Je(x))),ue=!1,r.dispatchEvent({type:pe,id:"adStarted"}),et(T),nt(),Je(C),-1==S.className.indexOf("ads_pauseButton")&&Ke(S,"ads_pauseButton","Pause","31","31","0 0 44 44","pause"),ot(),y=setInterval(ot,250),f.isSkippable()&&ce?(Ye(),v=setInterval(it,250)):Ze()},Fe=function(e){r.dispatchEvent({type:pe,id:"adImpression"})},Ve=function(e){i("ad-complete"),r.datastore.set({name:"adsPlaying",data:!1}),r.dispatchEvent({type:pe,id:"adEnded"}),Qe()},je=function(e){ue||Qe()},Ge=function(){!1===r.paused&&r.pause()},We=function(e){i("ad-all-complete"),ue||(oe||Qe(),F&&(i("ad-manager-destroy"),F.destroy()),ne=!0,r.datastore.set({name:"adsPlaying",data:!1}),r.dispatchEvent({type:"bbc.smp.plugins.ads.event.AdsPluginExternalEvent.ALL_ADS_COMPLETED"}))},ze=function(e){i("ad-error");var t=e.getError(),n=t.getErrorCode(),a=t.getInnerError(),e=0;a&&a.getErrorCode&&(e=a.getErrorCode()),r.dispatchEvent({type:pe,id:me,code:t.getErrorCode(),msg:t.getMessage()}),n===google.ima.AdError.ErrorCode.AUTOPLAY_DISALLOWED||e===google.ima.AdError.ErrorCode.AUTOPLAY_DISALLOWED?(ue=!0,Qe(),r.stop(),J=!(Z=!0),we()):(Qe(),We())},Qe=function(e){oe||(et(T),vt(),tt(),$e(),et(C),clearInterval(y),clearInterval(v),r.pauseAt([]),e?F&&(i("ad-manager-destroy2"),F.destroy()):ae||r.play(!0),oe=!0)},qe=function(){r.dispatchEvent({type:pe,id:"adClick"}),ee||ht()},Ke=function(e,t,n,a,i,o,d){e.className=t,e.title=n;t=e.getElementsByClassName("ads_hiddenElement")[0];t&&(t.innerHTML=n);n=e.getElementsByTagName("svg")[0];n.setAttribute("width",a),n.setAttribute("height",i),n.setAttribute("viewBox",o);e=e.getElementsByTagName("use")[0];e&&e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#"+d)},Ye=function(){w.style.display="block",M.style.display="block",P.style.display="none"},Ze=function(){w.style.display="none",M.style.display="none",P.style.display="none"},$e=function(){A&&(A.style.display="none",h.style.display="none"),r.updateUiConfig({controls:{enabled:!0},cta:{enabled:!0}})},Xe=function(){r.updateUiConfig({controls:{enabled:!1},cta:{enabled:!1}}),A&&(A.style.display="block",Ne())},Je=function(e){e&&(e.style.display="block")},et=function(e){e&&(e.style.display="none")},tt=function(){B&&(B.style.display="none",R.style.display="none")},nt=function(){B&&(B.style.display="block",R.style.display="block")},at=function(){(T=document.createElement("div")).id="ads_spinner",T.style.width="62px",T.style.height="62px",T.style.marginLeft="-31px",T.style.marginTop="-31px",T.style.top="50%",T.style.left="50%",T.style.display="none";var e=document.createElement("canvas"),t=new Sonic(e);t.width=50,t.height=50,t.colour=u,t.thickness=10,t.draw(),T.appendChild(e),h.appendChild(T)},it=function(){var e=f.getDuration()-F.getRemainingTime();0<(K=Math.ceil(f.getSkipTimeOffset()-e))?D.innerText="Skip ad in "+K:(P.style.display="block",M.style.display="none",clearInterval(v))},ot=function(){var e=F.getRemainingTime();le||E<e&&(E=e,le=!0);var t=(E-e)/E;N.innerHTML=dt(e),b.clientWidth<50||isNaN(t)||(I.style.width=100*t+"%")},dt=function(e){(e=Math.round(e))<0&&(e=0);var t=Math.floor(e/60%60),e=Math.floor(e%60);return[t,e=e<10?"0"+e:e].join(":")},st=function(e,t,n,a){for(var i="object"==typeof t?t:t.split(/\s+/g),o=0;o<i.length;o++)e.addEventListener(i[o],n,a)},rt=function(e){this.style.backgroundColor=u,this.style.fill=c},lt=function(e){this.style.backgroundColor="",this.style.fill=""},ut=function(e){this.style.border="1px solid rgba(255,255,255,1)",this.style.borderRight="0"},ct=function(e){this.style.border="1px solid rgba(255,255,255,0.5)",this.style.borderRight="0"},gt=function(e){e.stopPropagation(),K<=0&&F.skip()},pt=function(e){de||(de=!0,n=setTimeout(function(){de=!1},500),G?("fadedOut"===B.className?yt:vt)():(ee||ht(),F.clicked()))},mt=function(e){G||yt()},Et=function(e){G||vt()},yt=function(){B.className="fadedIn",S.style.pointerEvents="auto",_.style.pointerEvents="auto",P.style.pointerEvents="auto",k.style.pointerEvents="auto"},vt=function(){B.className="fadedOut",S.style.pointerEvents="none",_.style.pointerEvents="none",P.style.pointerEvents="none",k.style.pointerEvents="none"},ft=function(e){de||(de=!0,n=setTimeout(function(){de=!1},500),F.clicked())},At=function(){de||(de=!0,n=setTimeout(function(){de=!1},500),te?(Ke(k,"ads_muteButton","Mute","44","44","0 0 44 44","audio"),F.setVolume(1)):(Ke(k,"ads_unmuteButton","UnMute","44","44","0 0 44 44","mute"),F.setVolume(0)),te=!te)},ht=function(e){de||(de=!0,n=setTimeout(function(){de=!1},500),ee?(Ke(S,"ads_pauseButton","Pause","31","31","0 0 44 44","pause"),F.resume(),y=setInterval(ot,250),f.isSkippable&&0<K&&ce&&(v=setInterval(it,250))):(Ke(S,"ads_playButton","Play","31","31","0 0 44 44","play"),F.pause(),clearInterval(y),clearInterval(v)),ee=!ee)},Tt=function(){de||(de=!0,n=setTimeout(function(){de=!1},500),r.toggleFullscreen())},Lt=function(){clearTimeout(g),r.updateUiConfig({cta:{enabled:!0}})},bt=function(){for(var e=0;e<Q.length;e++)"PreviewPluginHTML"===Q[e].id&&(se=!0)};return{pluginInitialisation:function(e){var t;i("ad-plugin-init"),r=e.playerInterface,a={id:"dfpAds",version:"5.2.3"},t=r.datastore.get("plugins"),Q=t?((t=t.slice()).push(a),t):[a],r.datastore.set({name:"plugins",data:Q.slice()}),bt(),r.listenerObject={pluginLoaded:ve};var n,a=(a=r.datastore.get("AdsPluginParameters"))||{};r.updateUiConfig({cta:{enabled:!1}}),e.loadCSS(a.cssPath||"../css/dfpAds.css"),W=!!a.pretendPlaylistHasAds,l=a.adTag,z=!!a.debug,u=r.settings.ui.colour,c=r.settings.ui.foreColour,Y="function"==typeof a.setupCompanionAds?a.setupCompanionAds:function(){},function(){i("ad-create-ux"),A=o("div","ads_adsUX",r.container),st(A,"mouseenter focus",mt),st(A,"mouseleave blur",Et),L=o("div","ads_adContainer",A),(h=o("div","ads_customUI",A)).style.display="none",at(),(B=o("div","ads_controlsContainer",h)).className="fadedOut",R=o("div","ads_bottomFade",B),x=o("div","ads_clickDiv",h),st(x,"touchend click mouseup",pt),et(x),b=o("div","ads_seekBar",B),(I=o("div","ads_progressBar",b)).style.backgroundColor=u;var e=o("div","ads_buttonBar",B);S=d("ads_playPauseButton","ads_pauseButton","Pause","31","31","0 0 44 44","pause"),st(S,"touchend click mouseup",ht),st(S,"mouseenter focus",rt),st(S,"mouseleave blur",lt),e.appendChild(S),k=d("ads_volumeButton","ads_audioButton","Mute","44","44","0 0 44 44","audio"),st(k,"touchend click mouseup",At),st(k,"mouseenter focus",rt),st(k,"mouseleave blur",lt),e.appendChild(k),_=d("ads_fullScreenButton","ads_enterFullScreenButton","Enter Full Screen","44","44","0 0 44 44","fullscreen-enter"),st(_,"touchend click mouseup",Tt),st(_,"mouseenter focus",rt),st(_,"mouseleave blur",lt),e.appendChild(_),w=o("div","ads_skipContainer",h),P=o("button","ads_skipButton",w),o("div","ads_skipButtonText",P).innerHTML+="Skip Ad";o("div","ads_skipButtonIcon",P);st(P,"touchend click mouseup",gt),st(P,"mouseenter focus",ut),st(P,"mouseleave blur",ct),M=o("div","",w),(D=o("div","ads_skipText",M)).innerHTML+="Skip ad in ",G&&(O=o("div","ads_learnmore",h),st(O,"touchend click mouseup",ft),O.innerHTML+="Learn More",et(O)),C=o("div","ads_countdownText",h),et(C);var t=o("span","",C),e={"en-GB":"en","en-gb":"en","cy-GB":"cy","cy-gb":"cy","gd-GB":"gd","gd-gb":"gd","ga-GB":"ga","ga-gb":"ga","ru-uk":"ru",zh:"zh-hans"};e[q=r.settings.ui.locale.lang]&&(q=e[q]),t.innerHTML=(ye[q]||ye.en)+" ",(N=o("span","",C)).innerHTML="0:00",i("ad-create-ux-complete")}(),g=setTimeout(function(){Lt()},5e3),n=s,i("ad-sdk-load"),window.google&&window.google.ima?n():((a=document.createElement("script")).async=!0,a.type="text/javascript",a.onload=function(){n()},a.src=document.location.protocol+(!0===z?"//imasdk.googleapis.com/js/sdkloader/ima3_debug.js":"//imasdk.googleapis.com/js/sdkloader/ima3.js"),document.getElementsByTagName("head")[0].appendChild(a))},reset:function(){clearTimeout(n),clearTimeout(a),clearTimeout(g),Te()}}}();var runPlugin=function(e,t){return e.register({name:"dfpAds.js"}),AdsPlugin};