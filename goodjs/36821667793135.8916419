System.register(["./common-chunks.system.1976d2aa.js"],function(I){"use strict";var F;return{setters:[function(t){F=t.a5}],execute:function(){function n(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function s(t){return t="string"!=typeof t?String(t):t}function i(e){this.map={},e instanceof i?e.forEach(function(t,e){this.append(e,t)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function r(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function o(r){return new Promise(function(t,e){r.onload=function(){t(r.result)},r.onerror=function(){e(r.error)}})}function t(t){var e=new FileReader;return e.readAsArrayBuffer(t),o(e)}function e(){return this.bodyUsed=!1,this._initBody=function(t){if("string"==typeof(this._bodyInit=t))this._bodyText=t;else if(c&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(f&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(t){if(!p||!ArrayBuffer.prototype.isPrototypeOf(t))throw new Error("unsupported BodyInit type")}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type&&this.headers.set("content-type",this._bodyBlob.type))},c?(this.blob=function(){var t=r(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(t)},this.text=function(){var t,e=r(this);if(e)return e;if(this._bodyBlob)return t=this._bodyBlob,(e=new FileReader).readAsText(t),o(e);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){return r(this)||Promise.resolve(this._bodyText)},f&&(this.formData=function(){return this.text().then(h)}),this.json=function(){return this.text().then(JSON.parse)},this}function a(t,e){var r,n=(e=e||{}).body;if(a.prototype.isPrototypeOf(t)){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new i(t.headers)),this.method=t.method,this.mode=t.mode,n||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=t;if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new i(e.headers)),this.method=(t=(r=e.method||this.method||"GET").toUpperCase(),-1<l.indexOf(t)?t:r),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function h(t){var r=new FormData;return t.trim().split("&").forEach(function(t){var e;t&&(t=(e=t.split("=")).shift().replace(/\+/g," "),e=e.join("=").replace(/\+/g," "),r.append(decodeURIComponent(t),decodeURIComponent(e)))}),r}function u(t,e){e=e||{},this.type="default",this.status=e.status,this.ok=200<=this.status&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof i?e.headers:new i(e.headers),this.url=e.url||"",this._initBody(t)}var c,f,p,l,d;(O="undefined"!=typeof self?self:void 0).fetch||(i.prototype.append=function(t,e){t=n(t),e=s(e);var r=this.map[t];r||(this.map[t]=r=[]),r.push(e)},i.prototype.delete=function(t){delete this.map[n(t)]},i.prototype.get=function(t){t=this.map[n(t)];return t?t[0]:null},i.prototype.getAll=function(t){return this.map[n(t)]||[]},i.prototype.has=function(t){return this.map.hasOwnProperty(n(t))},i.prototype.set=function(t,e){this.map[n(t)]=[s(e)]},i.prototype.forEach=function(r,n){Object.getOwnPropertyNames(this.map).forEach(function(e){this.map[e].forEach(function(t){r.call(n,t,e,this)},this)},this)},c="FileReader"in O&&"Blob"in O&&function(){try{return new Blob,!0}catch(t){return!1}}(),f="FormData"in O,p="ArrayBuffer"in O,l=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],a.prototype.clone=function(){return new a(this)},e.call(a.prototype),e.call(u.prototype),u.prototype.clone=function(){return new u(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},u.error=function(){var t=new u(null,{status:0,statusText:""});return t.type="error",t},d=[301,302,303,307,308],u.redirect=function(t,e){if(-1===d.indexOf(e))throw new RangeError("Invalid status code");return new u(null,{status:e,headers:{location:t}})},O.Headers=i,O.Request=a,O.Response=u,O.fetch=function(e,r){return new Promise(function(n,s){var t=a.prototype.isPrototypeOf(e)&&!r?e:new a(e,r),o=new XMLHttpRequest;o.onload=function(){var t,r,e=1223===o.status?204:o.status;e<100||599<e?s(new TypeError("Network request failed")):(e={status:e,statusText:o.statusText,headers:(t=o,r=new i,(t.getAllResponseHeaders()||"").trim().split("\n").forEach(function(t){var e=t.trim().split(":"),t=e.shift().trim(),e=e.join(":").trim();r.append(t,e)}),r),url:"responseURL"in o?o.responseURL:/^X-Request-URL:/m.test(o.getAllResponseHeaders())?o.getResponseHeader("X-Request-URL"):void 0},t="response"in o?o.response:o.responseText,n(new u(t,e)))},o.onerror=function(){s(new TypeError("Network request failed"))},o.ontimeout=function(){s(new TypeError("Network request failed"))},o.open(t.method,t.url,!0),"include"===t.credentials&&(o.withCredentials=!0),"responseType"in o&&c&&(o.responseType="blob"),t.headers.forEach(function(t,e){o.setRequestHeader(e,t)}),o.send(void 0===t._bodyInit?null:t._bodyInit)})},O.fetch.polyfill=!0);var m=Object.freeze({__proto__:null});function y(t,e){var r={};if(t)for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(r[e?n.toLowerCase():n]=t[n]);return r}var T={DELETE:!0,PATCH:!0,POST:!0,PUT:!0},w={CONNECT:!0,DELETE:!0,GET:!0,OPTIONS:!0,PATCH:!0,POST:!0};function g(t,e){t=new Error(t);return t.response=e,t.status=e.status,t}function b(t,e,r){t.hasOwnProperty(e)||(t[e]=r)}function _(){}function E(t,e){var r=this.timings[0],n=this.lastTiming();this.endTime=n.end=this.getTime(),this.logger(t,{state:e.state||"end",msg:e.msg,index:this.index,url:this.url,receiveTime:n.received-n.start,translateTime:n.translated-n.received,time:n.end-n.start,totalTime:n.end-r.start,retry:this.retry,maxRetries:this.options.maxRetries,status:e.status},{request:this,httpReq:this.httpReq,response:e.response})}function v(t){this.options=t,this.JWT=!1,this._requestIndex=0,this.setListener(),this.setFetch(),this.setGenerateCorrelationID(),this.setGetJWT(),this._translate=t.translate||function(t){return t.json()}}function x(t){return t.json().then(function(t){return t.redirectUrl&&(window.location.href=t.redirectUrl),Promise.resolve()})}var R={enablePerimeterX:!1,perimeterXHandler:x};function P(){return(new Date).getTime()}v.prototype.fetchWrapper=function(s){var o,i,a,t,r,h=this,u=s._options,e=this.options.isClientFetch?(e=s._fetch,u.timeout&&(o=e,i=u.timeout,e=function(){var t=arguments,n=this;return new Promise(function(e,r){o.apply(n,t).then(function(t){a&&(clearTimeout(a),e(t))}).catch(function(t){a&&(clearTimeout(a),r(t))}),a=setTimeout(function(){a=void 0,e({status:408,message:"electrode-fetch: request timed out"})},i)})}),(void 0!==u.enablePerimeterX?!0===u.enablePerimeterX:!0===R.enablePerimeterX)&&(t=e,r=u,e=function(){return t.apply(this,arguments).then(function(e){if(e.status&&408===e.status)return e;var t=e.headers.get("content-type");if(e.status===v.PERIMETERX_HTTP_STATUS&&"string"==typeof t&&t.includes("application/json")){e._perimeterXTriggered=!0;t=e.clone();return r.perimeterXHandler?r.perimeterXHandler(t).then(function(){return e}).catch(function(t){throw g(t,e)}):R.perimeterXHandler(t).then(function(){return e}).catch(function(t){throw g(t,e)})}return e})}),e(s.url,s.options)):s._fetch(s.url,s.options);return e.then(function(t){var e=s.lastTiming();e.received=s.getTime();function r(t){return e.translated=s.getTime(),t}if(h.options.manageJwt&&t.headers&&(null!=(n=t.headers.get("x-csrf-jwt"))&&(h.JWT=n)),200<=t.status&&t.status<300){if(u.rawResponseOnly)return t;var n=function(e,r){function t(t){throw g("electrode-fetch: payload from URL ".concat(e.url," caused translate exception: ").concat(t.message),r)}try{var n=e.translate(r);return n=n.catch?n.catch(t):n}catch(e){return t(e)}}(s,t);return n.then?n.then(r):r(n)}if(!u.noRetry&&((401===t.status||!0===t._perimeterXTriggered)&&s.retry<1||0<u.maxRetries&&s.retry<u.maxRetries))return 401===t.status&&(s.options.headers["x-csrf-jwt"]=t.headers.get("x-csrf-jwt")),s.logFetchEnd("warn",{state:"retry",status:t.status,response:t}),s.retry++,s.timings.push({start:s.getTime()}),h.fetchWrapper(s);throw g('electrode-fetch: URL "'.concat(s.url,'" returned bad status ').concat(t.status),t)})},v.prototype.makeFetchRequest=function(t,e,r){var n=(e=e||{}).getTime||P,s=this._requestIndex++,o=n();return{url:t,_options:e,_fetch:e.fetch||this._fetch,retry:0,index:s,translate:r||this._translate,logFetchEnd:E,logger:e.disableAnalytics?_:this._listener,getTime:n,startTime:o,timings:[{start:o}],lastTiming:function(){return this.timings[this.timings.length-1]},fetchInstance:this}},v.prototype.fetch=function(t,e,r){r=this.makeFetchRequest(t,e,r);return this.makeFetchOptions(r),this.fetchInternal(r)},v.prototype.fetchJSON=function(t,e,r){r=this.makeFetchRequest(t,e,r);return this.makeFetchOptions(r,"application/json"),this.fetchInternal(r)},v.prototype.makeFetchOptions=function(t,e){var r=t.url,n=y(t._options);b(n,"credentials","same-origin");var s=y(n.headers,!0);return n.headers=s,!n.omitCorrelationId&&this._generateCorrelationID&&b(s,"wm_qos.correlation_id",this._generateCorrelationID(r,n)),e&&!n.omitContentType&&(r=n.method,w[r&&r.toUpperCase()]&&b(s,"accept",e),r=n.method,T[r&&r.toUpperCase()]&&b(s,"content-type",e)),n.omitCsrfJwt||s.hasOwnProperty("x-csrf-jwt")||(e=this.JWT||this._getGlobalJWT())&&(s["x-csrf-jwt"]=e),t.options=n},v.prototype.fetchInternal=function(e){return e.logger("info",{state:"start",msg:"start",index:e.index,url:e.url},{request:e,httpReq:e.httpReq}),this.fetchWrapper(e).then(function(t){return e.logFetchEnd("info",{status:t.status,response:t}),t}).catch(function(t){throw e.logFetchEnd("error",{state:"failed",msg:"fetch_fail - ".concat(t.message),status:t.status,response:t.response}),t})},v.prototype.setListener=function(t){this._listener=t||this.options.listener||_},v.prototype.setFetch=function(t){this._fetch=t||this.options.fetch},v.prototype.setGenerateCorrelationID=function(t){this._generateCorrelationID=t||this.options.generateCorrelationID},v.prototype.setGetJWT=function(t){this._getGlobalJWT=t||this.options.getGlobalJWT||_},v.prototype.config=function(t){(R=Object.assign(R,t)).perimeterXHandler||(R.perimeterXHandler=x)},v.PERIMETERX_HTTP_STATUS=412;var O=v;F(m);O=new O({manageJwt:!0,keepAlive:!1,fetch:self.fetch.bind(self),isClientFetch:!0,getGlobalJWT:function(){return window._wml?window._wml.jwt:null}});I("c",{instance:O,config:O.config.bind(O),fetch:O.fetch.bind(O),fetchJSON:O.fetchJSON.bind(O),setListener:O.setListener.bind(O),setFetch:O.setFetch.bind(O),setGenerateCorrelationID:O.setGenerateCorrelationID.bind(O),setGetJWT:O.setGetJWT.bind(O)})}}});
