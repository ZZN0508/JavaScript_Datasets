var HomePage,__awaiter=this&&this.__awaiter||function(e,o,s,c){return new(s=s||Promise)(function(n,t){function a(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(a,r)}i((c=c.apply(e,o||[])).next())})},__generator=this&&this.__generator||function(n,a){function e(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&t[0]?i.return:t[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,t[1])).done)return o;switch(i=0,(t=o?[2&t[0],o.value]:t)[0]){case 0:case 1:o=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(o=0<(o=s.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){s.label=t[1];break}if(6===t[0]&&s.label<o[1]){s.label=o[1],o=t;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(t);break}o[2]&&s.ops.pop(),s.trys.pop();continue}t=a.call(n,s)}catch(e){t=[6,e],i=0}finally{r=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}var r,i,o,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t};!function(e){function a(){if(lazyImages){for(var e=0;e<lazyImages.length;e++)if(function(e){e=e.getBoundingClientRect();return 0<=e.bottom&&0<=e.right&&e.top<=(window.innerHeight||document.documentElement.clientHeight)&&e.left<=(window.innerWidth||document.documentElement.clientWidth)}(lazyImages[e])){for(var t=0;t<lazyImages[e].children.length;t++){var n=lazyImages[e].children[t];n.getAttribute("data-srcset")?(n.srcset=n.getAttribute("data-srcset"),n.removeAttribute("data-srcset")):n.getAttribute("data-src")&&(n.src=n.getAttribute("data-src"),n.removeAttribute("data-src"))}lazyImages[e].style.opacity=1}lazyImages=Array.prototype.filter.call(lazyImages,function(e){for(var t=0;t<e.children.length;t++){var n=e.children[t];if(n.getAttribute("data-srcset")||n.getAttribute("data-src"))return e}}),0===lazyImages.length&&(window.removeEventListener("resize",a),window.cancelAnimationFrame(lazyLoadAnimationId)),lazyLoadAnimationId=window.requestAnimationFrame(a)}}function f(n,a,r){return new Promise(function(e){var t=function(){e(n.register(a,{scope:r})),window.removeEventListener("load",t)};"complete"===document.readyState?t():window.addEventListener("load",t)})}function v(e,t){void 0===t&&(t=!1);e=document.getElementById(e);return e&&e.innerHTML?JSON.parse(t?e.innerHTML.toLowerCase():e.innerHTML):null}var t=(i.prototype.setupFade=function(){var e=this,t=this.$document.find(".fade");window.requestAnimationFrame(function(){return e.fade(t)})},i.prototype.fade=function(e){var t=this;1024<=window.innerWidth?this.lastPosition!==$(".home").scrollTop()&&(e.css("opacity",1-$(".home").scrollTop()/($(".home").height()/2)),this.lastPosition=$(".home").scrollTop()):e.css("opacity",1),window.requestAnimationFrame(function(){return t.fade(e)})},i.prototype.connectScrollButton=function(){this.$document.find("#scroll-button").click(function(){$(".home").animate({scrollTop:.75*$(".home").height()},1e3,"swing")})},i),n=(r.prototype.ForgetAccountClick=function(){var t=this;this.$forgetAccount.click(function(e){e.preventDefault();var r=document.getElementById("personalization-remove-announce");r.textContent=null===(e=v("unauthConfig"))||void 0===e?void 0:e.accountRemovedString,$.ajax({url:"/RemovePersonalizationContent",type:"POST",success:function(e){t.SendAADForget(e).then(function(){window.location.href=window.location.origin||window.location.protocol+"//"+window.location.host})},error:function(e,t,n){var a;r.textContent=null===(a=v("unauthConfig"))||void 0===a?void 0:a.PersonalizedAccountRemoveFailureString}})})},r.prototype.SendAADForget=function(a){return $.Deferred(function(e){var t=""+aadUserForgetUrlFormat+a,n=document.createElement("IFRAME");n.onload=e.resolve,n.setAttribute("src",t),n.id="ISForgetMeIframe",n.style.display="none",document.body.appendChild(n)})},r.prototype.SwitchAccount=function(){var t=this;this.$switchAccountLink.click(function(e){e.preventDefault(),t.$inputEmail.val(""),t.$inputEmail.attr("aria-hidden","false"),t.$lastEmail.hide(),t.$inputEmailWrapper.show(),t.$inputEmail.focus(),t.$signBackInButton.hide(),t.$signInButton.show()})},r.prototype.SignInWithNewEmail=function(){var n=this;this.$signInButton.click(function(){var e=$.trim(n.$inputEmail.val()),t=n.$signInButton.attr("href"),e=n.updateQueryStringParameter(t,e);n.$signInButton.attr("href",e)}),this.$inputEmail.keypress(function(e){13===e.which&&(n.$signInButton.trigger("click"),window.location.href=n.$signInButton.attr("href"))})},r.prototype.CloseNewEmail=function(){var t=this;this.$closeNewEmailButton.click(function(e){e.preventDefault(),t.$lastEmail.show(),t.$inputEmailWrapper.hide(),t.$inputEmail.val(""),t.$switchAccountLink.focus(),t.$signBackInButton.show(),t.$signInButton.hide()})},r.prototype.updateQueryStringParameter=function(e,t){if(e&&t){t=encodeURI("login_hint="+t);return e.replace(/login_hint=(.*?)(?=&|$)/g,t)}},r);function r(e){e.length&&(this.$document=e,this.$forgetAccount=e.find("#personalization-remove-link"),this.$switchAccountLink=e.find("#switch-account-link"),this.$lastEmail=e.find("#last-signed-in-email"),this.$inputEmailWrapper=e.find("#NewEmail"),this.$inputEmail=e.find("#try-different-email"),this.$closeNewEmailButton=e.find("#closeNewEmail"),this.$signBackInButton=e.find("#hero-banner-sign-back-in-to-office-365-link"),this.$signInButton=e.find("#hero-banner-sign-in-to-office-365-link"),this.ForgetAccountClick(),this.SwitchAccount(),this.SignInWithNewEmail(),this.CloseNewEmail())}function i(e){this.$document=e,this.setupFade(),this.connectScrollButton()}e.init=function(){window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(e){clearTimeout(e)}),new t($("#hero-section")),new n($("#personalization-section")),"undefined"!=typeof Promise&&v("unauthServiceWorkerFlight",!0)&&function(){__awaiter(this,void 0,void 0,function(){var t,n,a,r,i,o,s,c,u,l,d,g,p,m;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,12,,13]),"serviceWorker"in window.navigator?(t=v("serviceWorkerConfig"),n=v("sharedClientStartupContext"),p=document.getElementById("cdnDomain"),a=p?p.innerText:"",(r=window.navigator.serviceWorker).controller?[4,r.getRegistration()]:[3,2]):[2];case 1:return o=e.sent(),[3,3];case 2:o=null,e.label=3;case 3:if(i=o,!(t&&n&&t.enabled))return[3,9];for(p=t.scriptUrl,s=t.scope,c="cdnDomain="+a+"&workload=officehome",g=function(e,t){t=t.flights;if(!t)return[];var n=new Set(t.split(","));return e.serviceWorkerAllowedFlights.filter(function(e){return n.has(e)})}(t,n),u=0,l=g;u<l.length;u++)d=l[u],c+="&serviceWorkerFlight="+d;return g=p+"?"+c,i?(m=window.location.origin,p=i.active.scriptURL.toLowerCase()!==(m+g).toLowerCase(),m=i.scope.toLowerCase()!==(m+s).toLowerCase(),p||m?[4,f(r,g,s)]:[3,5]):[3,6];case 4:i=e.sent(),e.label=5;case 5:return[3,8];case 6:return[4,f(r,g,s)];case 7:i=e.sent(),e.label=8;case 8:return[3,11];case 9:return i?[4,i.unregister()]:[3,11];case 10:e.sent(),e.label=11;case 11:return[3,13];case 12:return(m=e.sent())instanceof Error&&m.message&&"the operation is insecure."===m.message.toLowerCase()?[2]:("undefined"!=typeof StandaloneAriaLogger&&StandaloneAriaLogger.Logger&&StandaloneAriaLogger.Logger.LogEvent&&StandaloneAriaLogger.Logger.LogEvent("unauth_generic","ServiceWorkerInstallation_Error",{Error:m&&m.message||"Unknown"}),[3,13]);case 13:return[2]}})})}(),lazyImages=document.getElementsByClassName("lazy"),window.addEventListener("resize",a),lazyLoadAnimationId=window.requestAnimationFrame(a)}}(HomePage=HomePage||{});var behaviorKey,DefaultSignInHandler,awa=awa||{};for(behaviorKey in awa.isInitialized=!1,awa.verbosityLevels={NONE:0,ERROR:1,WARNING:2,INFORMATION:3},awa.behavior={UNDEFINED:0,NAVIGATIONBACK:1,NAVIGATION:2,NAVIGATIONFORWARD:3,APPLY:4,REMOVE:5,SORT:6,EXPAND:7,REDUCE:8,CONTEXTMENU:9,TAB:10,COPY:11,EXPERIMENTATION:12,STARTPROCESS:20,PROCESSCHECKPOINT:21,COMPLETEPROCESS:22,DOWNLOADCOMMIT:40,DOWNLOAD:41,SEARCHAUTOCOMPLETE:60,SEARCH:61,PURCHASE:80,ADDTOCART:81,VIEWCART:82,ADDWISHLIST:83,FINDSTORE:84,CHECKOUT:85,REMOVEFROMCART:86,PURCHASECOMPLETE:87,SIGNIN:100,SIGNOUT:101,SOCIALSHARE:120,SOCIALLIKE:121,SOCIALREPLY:122,CALL:123,EMAIL:124,COMMUNITY:125,VOTE:140,SURVEYINITIATE:141,SURVEYCOMPLETE:142,REPORTAPPLICATION:143,REPORTREVIEW:144,CONTACT:160,REGISTRATIONINITIATE:161,REGISTRATIONCOMPLETE:162,CHATINITIATE:180,CHATEND:181,TRIALSIGNUP:200,TRIALINITIATE:201,PARTNERREFERRAL:220,VIDEOSTART:240,VIDEOPAUSE:241,VIDEOCONTINUE:242,VIDEOCHECKPOINT:243,VIDEOJUMP:244,VIDEOCOMPLETE:245,VIDEOBUFFERING:246,VIDEOERROR:247,VIDEOMUTE:248,VIDEOUNMUTE:249,VIDEOFULLSCREEN:250,VIDEOUNFULLSCREEN:251,VIDEOREPLAY:252,VIDEPLAYERLOAD:253,VIRTUALEVENTJOIN:260,VIRTUALEVENTEND:261,IMPRESSION:280,CLICK:281,RICHMEDIACOMPLETE:282,ADBUFFERING:283,ADERROR:284,ADSTART:285,ADCOMPLETE:286,ADSKIP:287,ADTIMEOUT:288,OTHER:300},awa.behaviorKeys=[],awa.behavior)awa.behaviorKeys.push(behaviorKey);awa.actionType={CLICKLEFT:"CL",CLICKRIGHT:"CR",SCROLL:"S",ZOOM:"Z",RESIZE:"R",KEYBOARDENTER:"KE",KEYBOARDSPACE:"KS",OTHER:"O"},awa.cookie=function(){function i(e){for(var t,n,a=document.cookie.split(";"),r=0;r<a.length;r++){for(t=a[r];" "===t.charAt(0);)t=t.substring(1);if(o((n=t.split("=")).shift())===e)return o(n.join("="))}return null}function o(e){e=decodeURIComponent(e.replace("/+/g"," "));return e=0===e.indexOf('"')?e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"):e}function t(e,t,n){var a=n?((a=new Date).setTime(a.getTime()+864e5*n),"; expires="+a.toUTCString()):"";window.document.cookie=e+"="+t+a+"; path=/;"}return{getCookie:i,getCookieKeyValue:function(e,t){var n,a,r;if((e=i(e))&&t)for(n=e.split("&"),a=0;a<n.length;a++)if((r=n[a].split("="))[0]&&t.toLowerCase()===r[0].toLowerCase())return r[1];return null},setCookie:t,deleteCookie:function(e){t(e,"",-1)}}}(),awa.cv=function(){function n(){return l.concat(".",d.toString())}function t(){var e=n();if(i(e))return e}function e(){var e=n();return!!i(e)&&o(e.length+2)}function a(){return!!i(n())&&o(l.length+1+(d+1+"").length)}function r(e){if(!i(e))return awa.logger.logWarning("Cannot set invalid correlation vector value"),null;var t=e.lastIndexOf(".");return l=e.substr(0,t),d=parseInt(e.substr(t+1),10),n()}function i(e){if(e){var t=e.split(".")[0];if(t)return 16===t.length?(u=1,function(e){if(p.validationPattern.test(e)&&e.length<=p.maxCorrelationVectorLength)return!0}(e)):22===t.length?(u=2,function(e){if(s.validationPattern.test(e)&&e.length<=s.maxCorrelationVectorLength)return!0}(e)):void 0}}function o(e){return 1===u?e<=p.maxCorrelationVectorLength:e<=s.maxCorrelationVectorLength}var s,c,u,l="",d=0,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p={maxCorrelationVectorLength:63,baseLength:16};return p.validationPattern=new RegExp("^["+g+"]{"+p.baseLength.toString()+"}(.[0-9]+)+$"),(s={maxCorrelationVectorLength:127,baseLength:22}).validationPattern=new RegExp("^["+g+"]{"+s.baseLength.toString()+"}(.[0-9]+)+$"),c=s,u=2,{header:"MS-CV",tag:"cV",isInit:function(){return i(n())},canExtend:e,canIncrement:a,getValue:t,setValue:r,init:function(e){return e?r(e):(l=function(){for(var e="",t=0;t<c.baseLength;t++)e+=g.charAt(Math.floor(Math.random()*g.length));return e}(),d=0,t())},extend:function(){if(e())return l=l.concat(".",d.toString()),d=0,n()},increment:function(){if(a())return d+=1,n()},incrementExternal:function(e){var t,n,a,r;if(i(e)){for((t=e.split("."))[(n=t.length)-1]=(parseInt(t[n-1],10)+1).toString(),a="",r=0;r<n;r++)a+=t[r],r<n-1&&(a+=".");if(e=(t[0].length===s.baseLength?s:p).maxCorrelationVectorLength,a.length<=e)return a}},isValid:i,useCv1:function(){c=p},useCv2:function(){c=s}}}(),awa.logger={logError:function(e){awa.consoleVerbosity>=awa.verbosityLevels.ERROR&&console&&console.error&&console.error("JSLL: "+e)},logWarning:function(e){awa.consoleVerbosity>=awa.verbosityLevels.WARNING&&console&&console.warn&&console.warn("JSLL: "+e)},logInformation:function(e){awa.consoleVerbosity>=awa.verbosityLevels.INFORMATION&&console&&console.log&&console.log("JSLL: "+e)}},awa.capabilitiesCheck=function(){if(!JSON||!JSON.stringify)return awa.logger.logError("Unable to write event: the global JSON.stringify method does not exist"),awa.isAvailable=!1},awa.utils=function(){function t(){return e=""===e?window.navigator&&window.navigator.userAgent?window.navigator.userAgent:"":e}function u(e){return"function"==typeof jQuery&&e instanceof jQuery?e[0]:e}function n(e){e=String(e);return e=1===e.length?"0"+e:e}function a(e,t){var n=e;if(n){for(n=u(n);!t(n);)if(!(n=u(n=n.parentNode))||!n.getAttribute)return null;return n}}function r(e){e=e.getAttribute(g);return s(e)||""===e}function i(e){return"A"===e.nodeName}function o(e){for(var t in e)s(e[t])&&("{}"!==JSON.stringify(e[t])||"callback"===t)||delete e[t]}function s(e){return!(null==e||""===e)}function c(){var e,n={},a=!1,t=0,r=arguments.length;for("[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(a=arguments[0],t++),e=function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=a&&"[object Object]"===Object.prototype.toString.call(e[t])?c(!0,n[t],e[t]):e[t])};t<r;t++)e(arguments[t]);return n}var l="",e="",d=window.performance?window.performance.timing:void 0,g="";return{stringifyField:function(t,n){var e;if(n)try{return"{}"===(e=JSON.stringify(n))&&"timing"===t?function(){for(var e,t=["navigationStart","unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"],n="{",a=0;a<t.length;a++)s(e=d[t[a]])&&(n+='"'+t[a]+'":'+e,a<t.length-1&&(n+=","));return n+"}"}():e}catch(e){return n="string"==typeof n?n:"",'{"error": "ERROR: could not stringify {0} {1}"}'.replace("{0}",t).replace("{1}",n)}},getMuidHost:function(e){return{"microsoft.com":"c1.microsoft.com","xbox.com":"c.xbox.com","live.com":"c.live.com","microsoftstore.com":"c.microsoftstore.com","msn.com":"c.msn.com","windows.com":"c.windows.com"}[e]},isOfCorrectType:function(e,t){if("string"===e)return"string"==typeof t||t instanceof String||t instanceof Date;if("bool"===e)return"boolean"==typeof t||t instanceof Boolean;if(!("number"==typeof t||t instanceof Number))return!1;if("uint8"===e){if(t<0||255<t||t%1!=0)return!1}else if("uint16"===e){if(t<0||65535<t||t%1!=0)return!1}else if("uint32"===e){if(t<0||4294967295<t||t%1!=0)return!1}else if("uint64"===e){if(t<0||0x10000000000000000<t||t%1!=0)return!1}else if("int8"===e){if(t<-128||127<t||t%1!=0)return!1}else if("int16"===e){if(t<-32768||32767<t||t%1!=0)return!1}else if("int32"===e){if(t<-2147483648||2147483647<t||t%1!=0)return!1}else if("int64"===e){if(t<-0x8000000000000000||0x8000000000000000<t||t%1!=0)return!1}else if("float"===e){if(t<-3402823e32||3402823e32<t)return!1}else if("double"===e&&(t<-Number.MAX_VALUE||t>Number.MAX_VALUE))return!1;return!0},getOs:function(){var e;return""===l&&(e=t().toLowerCase(),l=-1!==e.indexOf("windows phone")?"WindowsPhone":-1!==e.indexOf("win")?"Windows":-1!==e.indexOf("mac")?"MacOS":-1!==e.indexOf("x11")?"Unix":-1!==e.indexOf("android")?"Android":-1!==e.indexOf("linux")?"Linux":-1!==e.indexOf("webos")?"webOS":-1!==e.indexOf("blackberry")?"BlackBerry":-1!==e.indexOf("ipod")||-1!==e.indexOf("ipad")||-1!==e.indexOf("iphone")?"iOS":-1!==e.indexOf("symbian")?"Symbian":-1!==e.indexOf("nokia")?"Nokia":"Unknown"),l},getUserAgent:t,extractFieldFromObject:function(e,t){var n;return e&&e[t]&&(n=e[t],delete e[t]),n},isElementTrulyVisible:function(e,t){return e=u(e),n=e.getBoundingClientRect(),a=t,r=n.left,i=n.top,o=n.right,s=n.bottom,c=t.left,e=t.top,n=t.right,a=t.bottom,0<Math.max(0,Math.min(o,n)-Math.max(r,c))*Math.max(0,Math.min(s,a)-Math.max(i,e));var n,a,r,i,o,s,c},dateToISOString:function(e){return e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+"T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"},extend:c,returnDomObjectIfjQuery:u,findClosestByAttribute:function(e,t){return g=t,a(e,r)},findClosestAnchor:function(e){return a(e,i)},getPerformanceData:function(){var e;try{e=window.performance.getEntries().filter(function(e){return"script"===e.initiatorType||"link"===e.initiatorType})}catch(e){}return e},getPageLoadTime:function(){var e;return e=0<d.loadEventStart?d.loadEventStart-d.navigationStart:e},getTitle:function(){return document.title.substring(0,150)},removeInvalidElements:o,removeNonObjectsAndInvalidElements:function(e,t){var n,a;for(n in o(e),t)a=t[n],"object"==typeof e[a]?o(e[a]):delete e[a]},bracketIt:function(e){return"["+e+"]"},getAppIdWithPrefix:function(e){var t,n;return t=e?1<(n=e.split(":")).length&&"js"===n[0].toLowerCase()?e:"JS:"+e:t},isValueAssigned:s}}(),awa.ids=function(){function e(){return"xxxxxxxx-xxxx-4xxx-Rxxx-xxxxxxxxxxxx".replace(/x/g,function(){return Math.floor(16*Math.random()).toString(16)}).replace("R",(8|Math.floor(3*Math.random())).toString(16))}function t(){return i.getCookie(u)}function n(e){var t,n;if(!e)return s=null;if(e!==s)for(s=null,t=e.split(","),n=0;n<t.length;n++)!function(e){if(e&&!(e.length<4)){for(var t=!1,n=e.substring(0,3).toString().toUpperCase(),a=0;a<d.length;a++)if(d[a]+":"===n&&e.length<=256){t=!0;break}return t}}(t[n])?awa.logger.logWarning("Unsupported flight id format for this app expId: "+t[n]):s?s+=","+t[n]:s=t[n]}var a,r=e(),i=awa.cookie,o=null,s=null,c=!1,u="Treatments",l=["c:","i:","w:"],d=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];return{getSessionId:function(){return i.getCookie("MS0")},getVisitorId:function(){return i.getCookie("MUID")},getMuidUserId:function(){var e=i.getCookie("MUID");return e&&e.length?"t:"+e:e},setAppUserId:function(e){if(o=null,e){for(var t=0;t<l.length;t++)if(l[t]===e.substring(0,2)){o=e;break}o||awa.logger.logWarning("Unsupported app user id: "+e+". Supported app user ids are: c:, i:, and w:")}},getAppUserId:function(){return o},readExpIdFromCookie:function(){return n(t()),s},readExpIdFromCoreData:function(e){return n(e),s},getImpressionGuid:function(){return r},getPageViewImpressionGuid:function(){return c?r=e():c=!0,r},getGroups:t,setDeviceClass:function(e){e&&(a=e)},getDeviceClass:function(){return a},setExpIdCookieName:function(e){u=e},getExpIdCookieName:function(){return u}}}(),awa.vortexEvents=function(){function n(){0<o.length&&(awa.writeEvent(o),o=[])}function a(){for(;0<o.length;)awa.writeEvent(o.pop())}function r(e,t){if(!0!==t){if(s){if("complete"===s)return void awa.writeEvent(e)}else if("complete"===document.readyState)return void awa.writeEvent(e);0!==o.length&&0!==c||(window.addEventListener?window.addEventListener("load",a):window.attachEvent&&window.attachEvent("onload",a)),o.push(e),1<c&&o.length>=c&&n()}else awa.writeEvent(e)}var i=awa.ids,o=[],s=null,c=0;return{sendError:function(e,t){r({name:"Ms.Webi.ClientError",data:{"Ms.Webi.ClientError":{errorInfo:JSON.stringify(e),wasDisplayed:t||!1,customSessionGuid:i.getSessionId(),impressionGuid:i.getImpressionGuid()}}})},sendApiComplete:function(e){r({name:"Ms.Webi.OutgoingRequest",cV:e.cV,data:{"Ms.Qos.OutgoingServiceRequest":{operationName:e.currentOperationName,targetUri:e.requestUri,latencyMs:e.latencyMs,serviceErrorCode:e.serviceErrorCode||-1,succeeded:e.isSuccess,requestMethod:e.httpMethod,responseContentType:e.contentType,protocolStatusCode:e.httpStatusCode,dependencyOperationName:e.operationName,dependencyOperationVersion:e.operationVersion,dependencyName:e.serviceName,dependencyType:e.serviceType||"WebService",responseSizeBytes:e.responseSize},"Ms.Webi.OutgoingRequest":{customSessionGuid:i.getSessionId(),impressionGuid:i.getImpressionGuid(),message:e.errorMessage,retryCount:e.retryCount,customData:e.customData}}})},sendJsllEvent:function(e){var t={};"CorsDisallowed"===e.type?t={name:"Ms.Cll.Javascript.CorsDisallowed",data:{"Ms.Cll.Javascript.CorsDisallowed":{eventName:e.eventName}}}:"EventTooLong"===e.type&&(t={name:"Ms.Cll.Javascript.EventTooLong",data:{"Ms.Cll.Javascript.EventTooLong":{eventName:e.eventName,payloadLength:e.payloadLength}}}),r(t)},SendOrScheduleEvent:r,batchQueuedEvents:n,drainQueuedEvents:a,batchEventsByNumber:function(e){c=e},overrideQueueBehavior:function(e){e&&e.domReadyState&&(s=e.domReadyState)}}}(),awa.errorHandler=function(){function n(){var e;arguments&&(e={Page:window.location.href,Script:arguments[1]||"",Message:arguments[0]||"",LineNumber:arguments[2]||0,StackTrace:arguments[4]?(e=arguments[4]).stack?e.stack.substring(0,1e3):"":"",UserAgent:awa.utils.getUserAgent()||"",Platform:window.navigator.platform||""},t.sendError(e,!1))}var t=awa.vortexEvents;return{init:function(){var e,t;e=n,t=window.onerror,window.onerror=function(){t&&t.apply(this,arguments),e.apply(this,arguments)}}}}(),awa.timespanHandler=function(){var a={};return{recordTimeSpan:function(e,t){var n=(new Date).getTime();if(t)return n-a[e];a[e]=n}}}(),function(){function p(e){var t,n,a,r,i;for(c="",t=0;t<e.length;t++)0<t&&(c+="\n"),c+=JSON.stringify(e[t]);n="",awa.OnSuccessfulVortexRequest&&(n=v.endpoint+"/t.req?"+c),a="",w.isValueAssigned(e[0].ext.javascript.msfpc)&&(a="?ext-javascript-msfpc='"+encodeURIComponent(e[0].ext.javascript.msfpc)+"'",n+=a),"xhr"===A?((r=new XMLHttpRequest).open("POST",encodeURI(v.endpoint+a),!0),r.withCredentials=!0,r.onload=function(){200===r.status?N(n):l(r.statusText,r.status)},r.onerror=function(){l(r.statusText,r.status)},r.send(c)):"XDomainRequest"===A?((i=new window.XDomainRequest).onload=function(){N(n)},i.onerror=function(){d(i)},i.open("POST",v.endpoint),i.send(c)):awa.logger.logError("No event is sent.")}function m(e){var t,n;for(c="",t=0;t<e.length;t++)0<t&&(c+="\n"),c+=JSON.stringify(e[t]);n="",awa.OnSuccessfulVortexRequest&&(n=v.endpoint+"/t.bcn?"+c),navigator.sendBeacon(v.endpoint,c)?N(n):p(e)}function f(){return v.callback&&"function"==typeof v.callback.signedinStatus?v.callback.signedinStatus():v.isLoggedIn}var e,t,n,a;awa._schemas=awa._schemas||[];var w=awa.utils,h=w.isValueAssigned,v={endpoint:"https://web.vortex.data.microsoft.com/collect/v1",sendMode:1,batchSize:10,authMethod:0,logLevel:awa.verbosityLevels.NONE,syncMuid:!0,provisionMsfpc:!0,useDefaultContentName:!0,useShortNameForContentBlob:!1,debounceMs:{scroll:600,resize:3e3},muidDomain:"microsoft.com",biBlobAttributeTag:"data-m",isLoggedIn:!1,shareAuthStatus:!1,cookiesToCollect:["MSFPC","ANON"],useBeacon:!0,autoCapture:{pageView:!0,onLoad:!0,onUnload:!0,click:!0,scroll:!1,resize:!1,jsError:!0,addin:!0,perf:!0,assets:!1,lineage:!1},callback:{pageName:null,pageActionPageTags:null,pageViewPageTags:null,contentUpdatePageTags:null,pageActionContentTags:null,signedinStatus:null},coreData:{referrerUri:document.referrer,requestUri:"",appId:window.location.hostname,pageName:"",pageType:"",env:"",product:"",market:"",serverImpressionGuid:"",expId:"",pageTags:{}}},r=[];for(e in v)"object"==typeof v[e]&&r.push(e);var i,o,y=(i=w.getUserAgent(),0<(o=i.indexOf("MSIE "))&&parseInt(i.substring(o+5,i.indexOf(".",o)),10)<9)?2083:15e3,b="",E=!1,s=0,c="",T=!1,C=h(navigator)&&h(navigator.sendBeacon);awa.experimentIdTag="expId",awa.isAvailable=!0,awa.getRequestBody=function(){return c},awa.getQueryStringParameters=function(){return b},Object.freeze&&Object.freeze(awa.verbosityLevels),awa.capabilitiesCheck();function S(e,t,n){h(t)&&(n||0!==t.length)&&(0<b.length&&(b+="&"),b+=e+"="+(n=n?"":"'")+encodeURIComponent(t.toString())+n)}function I(e,t,n,a){for(var r,i,o,s,c,u,l,d,g,p,m="C"===a?"*":"-",f=t.fields,v=0;v<f.length;v++)if(i=n[(r=f[v]).name],h(i))if(S(m+r.name,i,"string"!==r.type),"map"===r.type){for(s in o={},i){if(!w.isOfCorrectType(r.key,s))return awa.logger.logError("A key in the map was of the wrong type: "+r.name),0;if(!w.isOfCorrectType(r.element,i[s]))return awa.logger.logError("A value in the map was of the wrong type: "+r.name),0;o[s]=i[s]}e[r.name]=o}else if("list"===r.type||"set"===r.type){if(c=[],"[object Array]"!==Object.prototype.toString.call(i))return awa.logger.logError("The "+r.type+" "+r.name+" was not an array as expected"),0;for(u=0;u<i.length;u++){if(h(i[u])&&!w.isOfCorrectType(r.element,i[u]))return awa.logger.logError("The list contains a value of the wrong type: "+r.name),0;c[u]=i[u]}e[r.name]=c}else if("struct"===r.type){if(!I(l={},r.def,i,a))return;e[r.name]=l}else{if(!w.isOfCorrectType(r.type,i))return awa.logger.logError("Property is the wrong type: "+r.name),0;e[r.name]=i}else if(r.req)return awa.logger.logError("Missing required property: "+r.name),0;for(d in n){for(g=!1,p=0;p<f.length;p++)if(f[p].name===d){g=!0;break}g||awa.logger.logWarning("An unexpected field was found in  the event content and dropped: "+d)}return 1}var A=window.XDomainRequest?"XDomainRequest":"xhr",u=function(){awa.vortexEvents.overrideQueueBehavior({domReadyState:"complete"}),awa.vortexEvents.drainQueuedEvents()},l=function(e,t){awa.logger.logError("Failure sending data to vortex: "+e+"Error: "+t.toString())},N=function(e){awa.OnSuccessfulVortexRequest&&awa.OnSuccessfulVortexRequest(e),1===v.sendMode&&!1===T&&(T=!0,u()),awa.logger.logInformation("Success sending data to vortex")},d=function(e){awa.logger.logError("Failure sending data to vortex using XDomainRequest.  Status code:"+e.status)};for(awa.init=function(e){awa.isInitialized||(awa.isInitialized=!0,e&&(w.removeNonObjectsAndInvalidElements(e,r),v=w.extend(!0,v,e)),0==(e=v.sendMode)&&!1===v.provisionMsfpc&&(T=!0),(1<=e||!0===v.provisionMsfpc)&&awa.vortexEvents.overrideQueueBehavior({domReadyState:"notComplete"}),2===e&&awa.vortexEvents.batchEventsByNumber(v.batchSize),awa.consoleVerbosity=v.logLevel,awa.ct.initialize(v))},awa.writeEvent=function(e){var t,n,a,r,i,o,s,c,u,l,d=!0,g=[];if("[object Array]"===Object.prototype.toString.call(e))for(d=!1,t=0;t<e.length;t++)(n=awa._validateAndTranslateEvent(e[t])).success&&g.push(n.event);else(l=awa._validateAndTranslateEvent(e)).success&&g.push(l.event);if(0!==g.length){if(d&&b&&(a=v.endpoint.length+b.length)+7>y&&(awa.logger.logWarning("event is too large to send using get -- using post instead"),(u={}).eventName=e.name,u.payloadLength=a,u.type="EventTooLong",awa.vortexEvents.sendJsllEvent(u),d=!1),!d&&"XDomainRequest"===A&&v.endpoint&&0!==v.endpoint.indexOf(window.location.protocol)&&(awa.logger.logError("Unable to write event: CORS requests are not supported cross-protocol in this browser"),1))return(u={}).eventName=e.name,u.type="CorsDisallowed",void awa.vortexEvents.sendJsllEvent(u);d&&b?!1===T?(!(l=!(r="/t.js"))===v.shareAuthStatus&&!0===f()&&-1===document.cookie.toLowerCase().indexOf("bounced=")&&!1===E&&(r=1===v.authMethod?"/asm.js":2===v.authMethod?"/asa.js":r,l=!0),c=v.endpoint+r+"?"+b,u=l,d=document.head||document.getElementsByTagName("head")[0]||document.documentElement,l=document.createElement("script"),u||(l.onload=function(){N(c)}),l.async=!0,l.src=c,d.appendChild(l)):C&&!0===v.useBeacon&&!1===v.shareAuthStatus?m(g):(r=!0===v.shareAuthStatus&&!0===f()?1===v.authMethod?"/asm.gif":2===v.authMethod?"/asa.gif":r:"/t.gif",i=v.endpoint+r+"?"+b,o=g,(s=new Image).onload=function(){1===s.width&&N(i)},s.onerror=function(){awa.logger.logWarning("Telemetry image beacon not sent properly. Sending through POST."),p(o)},s.src=i):(C&&!0===v.useBeacon&&!0===T&&!1===v.shareAuthStatus?m:p)(g)}},awa.sendEventThroughIframe=function(e){var t,n=document.createElement("iframe");n.id="telframe",n.style.display="none",t=function(e){1<++s&&N(e)},n.attachEvent?n.attachEvent("onreadystatechange",function(){"interactive"==n.readyState&&t(e)}):n.onload=function(){t(e)},n.src=e,E=!0,document.body.appendChild(n)},awa._validateAndTranslateEvent=function(e){function t(e,t,n){s[e]=t,S(e,t,n)}var n,a,r,i,o,s={},c={},u={},l={event:s,success:!1};if(b="",!e)return awa.logger.logError("Unable to write null event"),l;if(!e.name)return awa.logger.logError("Unable to write event with missing name"),l;if(!awa._schemas.hasOwnProperty(e.name))return awa.logger.logError("Unable to write event: a schema for the event named {"+e.name+"} does not exist"),l;if(!e.data)return awa.logger.logError("Unable to write event: the event is missing content"),l;for(a in t("ver","2.1"),t("name",e.name),t("time",w.dateToISOString(new Date)),t("os",w.getOs()),t("deviceClass",awa.ids.getDeviceClass()),g=e.appId||v.coreData.appId,t("appId",w.getAppIdWithPrefix(g)),"true"===e.isSensitive&&t("flags",524288,!0),n=awa._schemas[e.name])if("name"!==a){if(r=n[a],!e.data.hasOwnProperty(a))return awa.logger.logError("Unable to write event: missing expected part: "+a),l;if("C"===r.part?i=u:(u.baseData=i={},u.baseType=a,S("*baseType",a)),!I(i,r.def,e.data[a],r.part))return l}for(o in e.data)n[o]&&n[o].part||awa.logger.logWarning("An unexpected property was found in the event content and dropped: "+o);s.data=u,s.tags={},e.hasOwnProperty(awa.cv.tag)?t(awa.cv.tag,e.cV):awa.cv.isInit()&&t(awa.cv.tag,awa.cv.getValue());var d={},g=e.env,g=h(g)?g:v.coreData.env;return h(g)&&(d.env=g,c.app=d,S("ext-app-env",g)),(g=v&&v.coreData&&v.coreData.expId?awa.ids.readExpIdFromCoreData(v.coreData.expId):awa.ids.readExpIdFromCookie())&&(w.isOfCorrectType("string",g)?(d[awa.experimentIdTag]=g,c.app=d,S("ext-app-"+awa.experimentIdTag,g)):awa.logger.logError("The supplied experiment id is invalid: "+e[awa.experimentIdTag]+"Continuing to process event without this value.")),(g=awa.ids.getAppUserId())&&(w.isOfCorrectType("string",g)?((d={}).userId=g,c.app=d,S("ext-app-userId",g)):awa.logger.logError("ignoring the app userId value because it is invalid: "+g)),d={},g=window.location.hostname,h(g)||(g="file:"===window.location.protocol?"local":g),d.ver="1.1",d.libVer="4.1.0",d.domain=g,c.javascript=d,S("ext-javascript-ver","1.1"),S("ext-javascript-libVer","4.1.0"),S("ext-javascript-domain",g),g=awa.cookie.getCookie("MSFPC"),w.isValueAssigned(g)&&(d.msfpc=g,S("ext-javascript-msfpc",g)),(d=awa.ids.getMuidUserId())&&(w.isOfCorrectType("string",d)?((g={}).localId=d,c.user=g,S("ext-user-localId",d)):awa.logger.logError("ignoring the userid value because it is invalid: "+d)),s.ext=c,l.success=!0,l},awa._registerSchemas=function(e){for(var t=0;t<e.length;t++)awa._schemas[e[t].name]=e[t]},awa.console=window.console||{},awa.console.fallback=awa.console.log||function(){},t=["log","info","warn","error","trace"],n=0;n<t.length;n++)awa.console[a=t[n]]||(awa.console[a]=awa.console.fallback);awa.extendCoreData=function(e){w.removeInvalidElements(e),v.coreData=w.extend(!0,v.coreData,e)}}(),awa._registerSchemas([{name:"Ms.Cll.Javascript.CorsDisallowed","Ms.Cll.Javascript.CorsDisallowed":{part:"C",def:{fields:[{req:!0,name:"eventName",type:"string"}]}}},{name:"Ms.Cll.Javascript.EventTooLong","Ms.Cll.Javascript.EventTooLong":{part:"C",def:{fields:[{req:!0,name:"eventName",type:"string"},{req:!0,name:"payloadLength",type:"int32"}]}}},{name:"Ms.Cll.Javascript.Error","Ms.Telemetry.Error":{part:"B",def:{fields:[{name:"errorName",type:"string"},{name:"errorMessage",type:"string"},{name:"severity",type:"int32"},{name:"errorType",type:"string"},{name:"errorCode",type:"int32"},{name:"lineNumber",type:"uint32"},{name:"isDisplayed",type:"bool"},{name:"errorLocation",type:"string"},{name:"errorMethod",type:"string"}]}},"Ms.Cll.Javascript.Error":{part:"C",def:{fields:[{req:!0,name:"code",type:"int32"},{req:!0,name:"message",type:"string"}]}}},{name:"Ms.Webi.ClientError","Ms.Webi.ClientError":{part:"B",def:{fields:[{req:!0,name:"errorInfo",type:"string"},{name:"wasDisplayed",type:"bool"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"serverImpressionGuid",type:"string"},{name:"errorName",type:"string"},{name:"errorMessage",type:"string"},{name:"severity",type:"int32"},{name:"errorType",type:"string"},{name:"errorCode",type:"int32"},{name:"lineNumber",type:"uint32"},{name:"isDisplayed",type:"bool"},{name:"errorLocation",type:"string"},{name:"errorMethod",type:"string"}]}}},{name:"Ms.Webi.OutgoingRequest","Ms.Qos.OutgoingServiceRequest":{part:"B",def:{fields:[{req:!0,name:"operationName",type:"string"},{name:"targetUri",type:"string"},{req:!0,name:"latencyMs",type:"int32"},{name:"serviceErrorCode",type:"int32"},{req:!0,name:"succeeded",type:"bool"},{name:"requestMethod",type:"string"},{name:"responseContentType",type:"string"},{name:"protocol",type:"string"},{name:"protocolStatusCode",type:"string"},{req:!0,name:"dependencyOperationName",type:"string"},{name:"dependencyOperationVersion",type:"string"},{req:!0,name:"dependencyName",type:"string"},{name:"dependencyType",type:"string"},{name:"responseSizeBytes",type:"int32"},{name:"requestStatus",type:"int32"}]}},"Ms.Webi.OutgoingRequest":{part:"C",def:{fields:[{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"message",type:"string"},{name:"retryCount",type:"int32"},{name:"customData",type:"string"},{name:"serverImpressionGuid",type:"string"}]}}},{name:"Ms.Webi.PageView","Ms.Content.PageView":{part:"B",def:{fields:[{name:"ver",type:"string"},{req:!0,name:"impressionGuid",type:"string"},{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"referrerUri",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"actionType",type:"string"},{name:"behavior",type:"int32"},{name:"resHeight",type:"int32"},{name:"resWidth",type:"int32"},{name:"vpHeight",type:"int32"},{name:"vpWidth",type:"int32"},{name:"market",type:"string"}]}},"Ms.Webi.PageView":{part:"C",def:{fields:[{name:"cookieEnabled",type:"bool"},{name:"flashInstalled",type:"bool"},{name:"flashVersion",type:"string"},{name:"cookies",type:"string"},{name:"isJs",type:"bool"},{name:"title",type:"string"},{name:"isLoggedIn",type:"bool"},{name:"isManual",type:"bool"},{name:"serverImpressionGuid",type:"string"}]}}},{name:"Ms.Webi.ContentUpdate","Ms.Content.ContentUpdate":{part:"B",def:{fields:[{name:"ver",type:"string"},{req:!0,name:"impressionGuid",type:"string"},{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"pageTags",type:"string"},{name:"pageHeight",type:"int32"},{name:"vpHeight",type:"int32"},{name:"vpWidth",type:"int32"},{name:"market",type:"string"},{name:"actionType",type:"string"},{name:"behavior",type:"int32"},{name:"vScrollOffset",type:"int32"},{name:"hScrollOffset",type:"int32"},{name:"contentVer",type:"string"},{req:!0,name:"content",type:"string"}]}},"Ms.Webi.ContentUpdate":{part:"C",def:{fields:[{name:"pageLoadTime",type:"int32"},{name:"title",type:"string"},{name:"isJs",type:"bool"},{name:"cookieEnabled",type:"bool"},{name:"isLoggedIn",type:"bool"},{name:"isManual",type:"bool"},{name:"isDomComplete",type:"bool"},{name:"serverImpressionGuid",type:"string"},{name:"timings",type:"string"}]}}},{name:"Ms.Webi.PageAction","Ms.Content.PageAction":{part:"B",def:{fields:[{name:"ver",type:"string"},{req:!0,name:"impressionGuid",type:"string"},{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"destUri",type:"string"},{name:"market",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"actionType",type:"string"},{name:"behavior",type:"int32"},{name:"contentVer",type:"string"},{name:"content",type:"string"}]}},"Ms.Webi.PageAction":{part:"C",def:{fields:[{name:"timeToAction",type:"int32"},{name:"cookieEnabled",type:"bool"},{name:"cookies",type:"string"},{name:"isJs",type:"bool"},{name:"title",type:"string"},{name:"referrerUri",type:"string"},{name:"isLoggedIn",type:"bool"},{name:"isManual",type:"bool"},{name:"serverImpressionGuid",type:"string"}]}}},{name:"Ms.Webi.PageUnload","Ms.Content.PageUnload":{part:"B",def:{fields:[{name:"ver",type:"string"},{req:!0,name:"impressionGuid",type:"string"},{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"}]}},"Ms.Webi.PageUnload":{part:"C",def:{fields:[{name:"dwellTime",type:"int32"},{name:"scrollDepth",type:"string"},{name:"serverImpressionGuid",type:"string"}]}}}]),awa.ct=function(){function a(e){/in/.test(document.readyState)?setTimeout("awa.ct.onDomReadyDo("+e+")",9):e.call()}function s(){if(N.callback&&"function"==typeof N.callback.pageName)return N.callback.pageName();if(N.coreData.pageName)return N.coreData.pageName;var e=window.location.pathname.split("/");return 2<e.length&&""!==e[2]?e[2]:"Home"}function r(e){var t={A:!0,BUTTON:!0,AREA:!0,INPUT:!0},n=e||window.event,a=n.srcElement||n.target,r={isAuto:!0};if("which"in(e=n)?3===e.which:"button"in e&&2===e.button)r.behavior=awa.behavior.CONTEXTMENU,r.actionType=D.CLICKRIGHT;else if("which"in(e=n)?1===e.which:"button"in e&&1===e.button)r.actionType=D.CLICKLEFT;else if("keyCode"in(e=n)&&13===e.keyCode)r.actionType=D.KEYBOARDENTER;else{if(!("keyCode"in(n=n)&&32===n.keyCode))return;r.actionType=D.KEYBOARDSPACE}for(;a&&a.tagName;){if(t[a.tagName.toUpperCase()]){("INPUT"!==a.tagName.toUpperCase()||W[a.type.toUpperCase()])&&(c(a)||l(a,r));break}a=a.parentElement||a.parentNode}}function c(e){e=k.findClosestByAttribute(e,t);return k.isValueAssigned(e)}function i(a,r,i){var o;return function(){var e=this,t=arguments,n=!o;clearTimeout(o),o=setTimeout(function(){o=null,r&&r.apply(e,t)},i),n&&a&&a.apply(e,t)}}function o(e){var t={},n=awa.utils.extend(!0,N.coreData.pageTags);n.metaTags=v(t),f(n),"function"==typeof N.callback.pageViewPageTags&&(n=k.extend(!0,n,N.callback.pageViewPageTags()));var a,r=(a={h:0,w:0},window.screen&&(a.h=screen.height,a.w=screen.width),a),i={name:"Ms.Webi.PageView",data:{"Ms.Content.PageView":{ver:S,impressionGuid:M.getPageViewImpressionGuid(),pageName:s(),uri:C(),referrerUri:N.coreData.referrerUri,resHeight:r.h,resWidth:r.w,market:t.market,pageType:t.pageType,pageTags:n,product:t.product,behavior:t.behavior||awa.behavior.UNDEFINED},"Ms.Webi.PageView":{cookieEnabled:b(),cookies:m(),isJs:!0,title:k.getTitle(),isLoggedIn:N.isLoggedIn,isManual:!0,serverImpressionGuid:t.serverImpressionGuid}},isSensitive:t.isSensitive,env:t.env},a=i.data["Ms.Content.PageView"],r=i.data["Ms.Webi.PageView"];O.addin&&(t=function(){var e,t,n,a={};if(navigator.plugins["Shockwave Flash"])a.installed=!0,e=navigator.plugins["Shockwave Flash"],a.version=e.description.split(" ")[2];else if(-1!==navigator.userAgent.indexOf("MSIE"))for(t=(new Date).getFullYear()-1992,n=t;0<n;n--)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+n),a.installed=!0,a.version=n+".0";break}catch(e){}return a}(),r.flashInstalled=t.installed||!1,r.flashVersion=t.version||""),e&&(g(i,a,r,e),e.pageTags&&(a.pageTags=k.extend(!0,n,e.pageTags))),a.pageTags=k.stringifyField("pageTags",a.pageTags),R.SendOrScheduleEvent(i,!0)}function n(){u({isAuto:!0,isDomComplete:!0})}function u(e){var t,n={},a=awa.utils.extend(!0,N.coreData.pageTags);a.metaTags=v(n),f(a),e&&e.isDomComplete&&!0===O.perf&&window.performance&&(window.performance.timing&&(a.timing=k.stringifyField("timing",window.performance.timing)),!0===O.assets&&(t=k.getPerformanceData())&&(a.AssetPerformance=k.stringifyField("AssetPerformance",t))),"function"==typeof N.callback.contentUpdatePageTags&&(a=k.extend(!0,a,N.callback.contentUpdatePageTags()));var r,i=(r={h:0,w:0},window.screen&&(r.h=window.innerHeight||document.body.clientHeight||document.documentElement.clientHeight,r.w=window.innerWidth||document.body.clientWidth||document.documentElement.clientWidth),r),o=y(),r={top:0,bottom:i.h,left:0,right:i.w},o={name:"Ms.Webi.ContentUpdate",data:{"Ms.Content.ContentUpdate":{ver:S,impressionGuid:M.getImpressionGuid(),pageName:s(),uri:C(),pageTags:a,pageHeight:document.body.scrollHeight,vpHeight:i.h,vpWidth:i.w,market:n.market,behavior:n.behavior||awa.behavior.UNDEFINED,vScrollOffset:o.v,hScrollOffset:o.h,contentVer:I,content:(o=r,r=[],function(e,t,n){var a,r,i;if(e)for(a=0;a<e.length;a++)c(r=e[a])||k.isElementTrulyVisible(r,n)&&(i=p(r,!1))&&t.push(i)}(document.querySelectorAll(k.bracketIt(F.areaName)+","+k.bracketIt(F.slotNumber)+","+k.bracketIt(N.biBlobAttributeTag)),r,o),JSON.stringify(r))},"Ms.Webi.ContentUpdate":{title:k.getTitle(),cookieEnabled:b(),isJs:!0,isManual:!0,isDomComplete:!1,isLoggedIn:N.isLoggedIn,serverImpressionGuid:n.serverImpressionGuid}},isSensitive:n.isSensitive,env:n.env},r=o.data["Ms.Content.ContentUpdate"],n=o.data["Ms.Webi.ContentUpdate"];e&&(g(o,r,n,e),e.pageTags&&(r.pageTags=k.extend(!0,a,e.pageTags))),r.pageTags=k.stringifyField("pageTags",r.pageTags),R.SendOrScheduleEvent(o,!1)}function l(e,t){var n={},a=awa.utils.extend(!0,N.coreData.pageTags),r={};(e=k.returnDomObjectIfjQuery(e))&&(n.targetUri=function(e){var t,n="";switch(e.tagName){case"A":case"AREA":n=e.href||"";break;case"IMG":n=function(e){var t,e=e;if(e&&1===(t=k.findClosestAnchor(e)).length){if(t[0].href)return t[0].href;if(t[0].src)return t[0].src}return""}(e);break;case"INPUT":t=e.type,window.event,t&&W[t.toUpperCase()]&&(n=e.form&&e.form.action||window.location.pathname)}return n}(e),r=p(e,!0),(r=k.extend(r,function(e){for(var t,n,a={};e;)if(!E(e)){for(t in e.attributes)t&&e.attributes[t]&&(n=e.attributes[t].name)&&0===n.toLowerCase().indexOf("ms.")&&(a[n]=e.attributes[t].value);e=e.parentElement||e.parentNode}return a}(e))).bhvr&&T(n,k.extractFieldFromObject(r,"bhvr"))),a.metaTags=v(n),f(a),"function"==typeof N.callback.pageActionPageTags&&(a=k.extend(!0,a,N.callback.pageActionPageTags(e)));var i=N.callback.pageActionContentTags,i={name:"Ms.Webi.PageAction",data:{"Ms.Content.PageAction":{ver:S,impressionGuid:M.getImpressionGuid(),pageName:s(),uri:C(),destUri:n.targetUri,market:n.market,pageType:n.pageType,pageTags:a,product:n.product,actionType:n.actionType,behavior:n.behavior,contentVer:I,content:k.bracketIt(JSON.stringify(awa.utils.extend(r,"function"==typeof i?i(e):{},t?t.contentTags:{})))},"Ms.Webi.PageAction":{timeToAction:function(){if(window.performance&&window.performance.timing){var e=window.performance.timing.domComplete;if(0!==e)return(new Date).getTime()-e}return-1}(),cookies:m(),cookieEnabled:b(),isJs:!0,title:k.getTitle(),referrerUri:N.coreData.referrerUri,isLoggedIn:N.isLoggedIn,isManual:!0,serverImpressionGuid:n.serverImpressionGuid}},isSensitive:n.isSensitive,env:n.env},e=i.data["Ms.Content.PageAction"],n=i.data["Ms.Webi.PageAction"];t&&(g(i,e,n,t),t.pageTags&&(e.pageTags=k.extend(!0,a,t.pageTags)),t.referrerUri&&(n.referrerUri=k.extractFieldFromObject(e,"referrerUri"))),e.pageTags=k.stringifyField("pageTags",e.pageTags),R.SendOrScheduleEvent(i,!0)}function d(){var e;P||(P=!0,v(e={}),e={name:"Ms.Webi.PageUnload",data:{"Ms.Content.PageUnload":{ver:S,impressionGuid:M.getPageViewImpressionGuid(),pageName:s()},"Ms.Webi.PageUnload":{dwellTime:awa.timespanHandler.recordTimeSpan("dwellTime",!0),scrollDepth:U.v.toString()+"/"+document.body.scrollHeight.toString()}},isSensitive:e.isSensitive,env:e.env},R.SendOrScheduleEvent(e,!0))}function g(e,t,n,a){a.appId&&(e.appId=a.appId),a.behavior&&T(t,a.behavior),a.uri&&(t.uri=a.uri),a.referrerUri&&(t.referrerUri=a.referrerUri),a.pageName&&(t.pageName=a.pageName),a.actionType&&(t.actionType=a.actionType),a.pageHeight&&(t.pageHeight=a.pageHeight),a.content&&(t.content=k.bracketIt(JSON.stringify(a.content))),a.targetUri&&(t.destUri=a.targetUri),a.vScrollOffset&&(t.vScrollOffset=a.vScrollOffset),a.hScrollOffset&&(t.hScrollOffset=a.hScrollOffset),n.isManual=!0!==a.isAuto||void 0,a.isDomComplete&&(n.isDomComplete=a.isDomComplete,n.pageLoadTime=k.getPageLoadTime()),a.pageLoadTime&&(n.pageLoadTime=a.pageLoadTime),a.timings&&(n.timings=JSON.stringify(a.timings))}function p(e,t){var n,a,r,i,o,s;if(!e)return"";if(n={},s=(a=awa.utils.findClosestByAttribute(e,N.biBlobAttributeTag))?a.getAttribute(N.biBlobAttributeTag):s)n=JSON.parse(s);else for(r=k.findClosestByAttribute(e,k.bracketIt(F.id)),r=k.returnDomObjectIfjQuery(e),s=k.findClosestByAttribute(e,F.areaName),s=awa.utils.extend({},(s=s,(s=k.returnDomObjectIfjQuery(s))?{areaName:s.getAttribute(F.areaName),templateName:s.getAttribute(F.templateName),contentSource:s.getAttribute(F.contentSource),product:s.getAttribute(F.productId),type:s.getAttribute(F.contentType)}:void 0)),(n={id:r.getAttribute(F.id)||e.id||"",aN:s.areaName,sN:r.getAttribute(F.slotNumber),cN:r.getAttribute(F.contentName)||function(e){if(!1===N.useDefaultContentName||E(e)||!e.tagName)return"";var t;switch(e.tagName){case"A":t=document.all?e.innerText||e.innerHTML:e.text||e.innerHTML;case"IMG":case"AREA":t=e.alt;default:t=e.value||e.name||e.alt||e.innerText||e.id}return t.substring(0,A)}(e)||r.getAttribute("alt")||"",cS:r.getAttribute(F.contentSource)||s.contentSource,tN:s.templateName,pid:r.getAttribute(F.productId),cT:r.getAttribute(F.contentType)||s.type}).id&&n.aN&&n.sN&&n.cN||awa.logger.logWarning("Invalid content blob.  Missing required attributes (id, aN/area, sN/slot), cN/contentName.  Content information will still be collected!"),F.isShortNames||(n={contentId:n.id,areaName:n.aN,slotNumber:n.sN,contentName:n.cN,contentSource:n.cS,templateName:n.tN,productId:n.pid,contentType:n.cT}),i=0;i<r.attributes.length;i++)(o=r.attributes[i]).name!==F.id&&o.name!==F.areaName&&o.name!==F.slotNumber&&o.name!==F.contentName&&o.name!==F.contentSource&&o.name!==F.templateName&&o.name!==F.productId&&o.name!==F.contentType&&-1!==o.name.indexOf("data-bi-")&&(n[o.name.replace("data-bi-","")]=o.value);return awa.utils.removeInvalidElements(n),n=N.autoCapture.lineage&&t?awa.utils.extend(n,function(e){for(var t,n,a,r,i,o,s=[],c=[],u=[],l=[],d=N.biBlobAttributeTag,g=(F.contentName,"data-module-id"),p=void 0;e;)a=e.getAttribute(d)||e[d],n=e.getAttribute(g)||e[g],a?(a=JSON.parse(a))&&(t=a.cN||a.cT,s.push(t),n&&(p=t),u.push(a.id||void 0),c.push(a.sN||-1),l.push(a.tags||{})):(t=e.getAttribute(F.contentName)||e.getAttribute(F.contentType),s.push(t),n&&(p=t),u.push(e.getAttribute(F.id)||void 0),c.push(e.getAttribute(F.slotNumber)||-1),l.push(e.getAttribute("data-bi-tags")||{})),e=e.parentElement;for(i=!(r={lineage:s.join(">"),lineageOrdinal:c.join(">"),lineageById:u.join(">"),containerName:p}),o=0;o<l.length;o++)i=i||k.isValueAssigned(l[o]);return i&&(r.lineageTags=l),r}(e)):n}function m(){var e,t,n,a="",r={},i=[],o=N.cookiesToCollect;if(!1===N.shareAuthStatus)i=o;else for(e=0;e<o.length;e++)"ANON"!==o[e]&&i.push(o[e]);try{try{window.varCustomerCookies&&0<window.varCustomerCookies.length&&(i=i.concat(window.varCustomerCookies))}catch(e){}for(t in i)r.hasOwnProperty(i[t])||(r[i[t]]="",""!==(n=decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(i[t]).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")))&&(a+=i[t]+"="+n+";"))}catch(e){}return a}function f(e){var t;e.enabledFeatures||(t=x.getCookie("Features"))&&(e.enabledFeatures=t)}function v(e){var t,n=h("awa-",!0);return e.env=w(n,N.coreData,"env"),e.pageType=w(n,N.coreData,"pageType"),e.product=w(n,N.coreData,"product"),e.market=w(n,N.coreData,"market"),e.serverImpressionGuid=w(n,N.coreData,"serverImpressionGuid"),e.isSensitive=w(n,N.coreData,"isSensitive"),t=h("ms.",!1),k.extend(!0,n,t)}function w(e,t,n){e=k.extractFieldFromObject(e,n);return t[n]||e}function h(e,t){for(var n,a={},r=document.querySelectorAll("meta"),i=0;i<r.length;i++)(n=r[i]).name&&(0===n.name.toLowerCase().indexOf(e)&&(a[t?n.name.replace(e,""):n.name]=n.content));return a}function y(){return{h:parseInt(document.body.scrollLeft||document.documentElement.scrollLeft||window.pageXOffset||0,10),v:parseInt(document.body.scrollTop||document.documentElement.scrollTop||window.pageYOffset||0,10)}}function b(){if(navigator.cookieEnabled)return navigator.cookieEnabled;var e=x.getCookie("MC0");return e||(document.cookie="MC0=1",e=x.getCookie("MC0")),!!e}function E(e){if(e&&e.attributes)try{var t=e.getAttribute("data-dc");return k.isValueAssigned(t)&&"pii"===t.toLowerCase()}catch(e){return}}function T(e,t){var n=Number(t);k.isOfCorrectType("uint16",n)?function(e){for(var t=0;t<awa.behaviorKeys.length;t++)if(awa.behavior[awa.behaviorKeys[t]]===e)return 1;return awa.logger.logWarning("Unsupported behavior: "+e+"."),0}(n)&&(e.behavior=n):k.isOfCorrectType("string",t)&&(t=awa.behavior[t.toUpperCase()],k.isOfCorrectType("uint16",t)&&(e.behavior=t))}function C(){return""===N.coreData.requestUri?window.location.href:N.coreData.requestUri}var S="1.0",I="2.0",A=200,N={},O={},x=awa.cookie,L=awa.errorHandler,M=awa.ids,R=awa.vortexEvents,k=awa.utils,D=awa.actionType,U={h:0,v:0},t="data-bi-dnt",P=!1,V={longNames:{isShortNames:!1,id:"data-bi-id",areaName:"data-bi-area",slotNumber:"data-bi-slot",contentName:"data-bi-name",contentSource:"data-bi-source",templateName:"data-bi-view",productId:"data-bi-product",contentType:"data-bi-type"},shortNames:{isShortNames:!0,id:"data-bi-id",areaName:"data-bi-an",slotNumber:"data-bi-sn",contentName:"data-bi-cn",contentSource:"data-bi-cs",templateName:"data-bi-tn",productId:"data-bi-pid",contentType:"data-bi-ct"}},F=V.longNames,W={BUTTON:!0,CHECKBOX:!0,RADIO:!0,RESET:!0,SUBMIT:!0};return{initialize:function(e){var t,n;awa.isAvailable&&(O=(N=e).autoCapture,F=!0===N.useShortNameForContentBlob?V.shortNames:V.longNames,O.pageView&&(!0===N.isLoggedIn&&!0===N.shareAuthStatus?a(function(){awa.ct.capturePageView({isAuto:!0})}):o({isAuto:!0})),O.click&&(window.addEventListener?(t=-1!==navigator.appVersion.indexOf("MSIE")?"click":"mousedown",window.addEventListener(t,r,!1),window.addEventListener("keyup",r,!1)):document.attachEvent&&(document.attachEvent("onclick",r),document.attachEvent("keyup",r))),O.jsError&&L.init(),O.scroll&&(t=i(null,function(){u({isAuto:!0,actionType:awa.actionType.SCROLL})},N.debounceMs.scroll),window.addEventListener?window.addEventListener("scroll",t):window.attachEvent&&window.attachEvent("onscroll",t)),O.resize&&(n=i(function(){u({isAuto:!0,actionType:awa.actionType.RESIZE})},null,N.debounceMs.resize),window.addEventListener?window.addEventListener("resize",n):window.attachEvent&&window.attachEvent("onresize",n)),O.onUnload&&(n=function(){var e=y();U.v=(U.v>e.v?U:e).v},window.addEventListener?window.addEventListener("scroll",n):window.attachEvent&&window.attachEvent("onscroll",n),awa.timespanHandler.recordTimeSpan("dwellTime",!1),window.addEventListener?(window.addEventListener("beforeunload",d),window.addEventListener("unload",d)):window.attachEvent&&(window.attachEvent("onbeforeunload",d),window.attachEvent("onunload",d))),a(awa.ct.domReadyTasksWrapper))},capturePageView:o,captureContentUpdate:u,capturePageAction:function(e,t){l(e,t)},captureContentPageAction:function(e){l(null,e)},domReadyTasksWrapper:function(){awa.ct.domReadyTasks()},onDomReadyDo:a,domReadyTasks:function(){var e,t;N.syncMuid&&((t=k.getMuidHost(N.muidDomain||"microsoft.com"))?(e=(window.location.protocol||"http:")+"//"+t+"/c.gif?DI=4050&did=1&t=",(t=document.createElement("IMG")).style.display="none",t.src=e,t.hidden="",t["aria-hidden"]="true",t.role="presentation"):awa.logger.logWarning("Unable to get a muid host for the configured muidDomain '"+N.muidDomain+"'.  Unable to sync muid")),O.onLoad&&("complete"===document.readyState?n():window.addEventListener?window.addEventListener("load",n):window.attachEvent&&window.attachEvent("onload",n))}}}(),awa.service=function(){function t(i){var o,s;if("function"==typeof jQuery){m&&($.support.cors=!0);var c,n=i.additionalHeaders||{},e=i.body,e=e?JSON.stringify(e):i.data||void 0,u=i.maxRetry||0,l=0,a=$.noop,d=i.operationName||i.url,t=i.errorFormatter||function(e){return e},r=awa.ids,g={url:i.url,type:i.method,data:e,crossDomain:!0,headers:{},success:i.success,timeout:i.timeout,error:i.error,jsonp:i.jsonp,jsonpCallback:i.jsonpCallback,cache:i.cache,beforeSend:function(e){if(a(e),i.contractVersion&&e.setRequestHeader("MS-Contract-Version",i.contractVersion),(!awa.utils.isValueAssigned(i.addCvToRequestHeader)&&f||i.addCvToRequestHeader)&&awa.cv.isValid(c)&&e.setRequestHeader("MS-CV",c),n)for(var t in n)e.setRequestHeader(t,n[t])}};return i.dataType&&(g.dataType=i.dataType),i.noCacheBusting||(g.cache=!1),i.contentType&&(g.contentType=i.contentType),i.accept&&(g.headers.Accept=i.accept),i.accepts&&(g.accepts=i.accepts),i.async&&(g.async=i.async),i.xhrFields&&(g.xhrFields=i.xhrFields),i.complete&&(g.complete=i.complete),i.contents&&(g.contents=i.contents),i.context&&(g.context=i.context),i.dataFilter&&(g.dataFilter=i.dataFilter),i.global&&(g.global=i.global),i.ifModified&&(g.ifModified=i.ifModified),i.isLocal&&(g.isLocal=i.isLocal),i.mimeType&&(g.mimeType=i.mimeType),i.password&&(g.password=i.password),i.processData&&(g.processData=i.processData),i.scriptCharset&&(g.scriptCharset=i.scriptCharset),i.statusCode&&(g.statusCode=i.statusCode),i.traditional&&(g.traditional=i.traditional),i.type&&(g.type=i.type),i.username&&(g.username=i.username),i.xhr&&(g.xhr=i.xhr),c=awa.cv.isValid(i.cV)?i.cV:awa.cv.increment(),o=function(e,t,n){var a=e.getResponseHeader("Content-Length"),t={name:"Ms.Webi.OutgoingRequest",cV:c,data:{"Ms.Qos.OutgoingServiceRequest":{operationName:i.currentOperationName||window.location.href,targetUri:v?v(g.url):g.url,latencyMs:n,serviceErrorCode:!t&&e.responseJSON&&e.responseJSON.code&&!isNaN(e.responseJSON.code)?e.responseJSON.code:-1,succeeded:t,requestMethod:g.type,responseContentType:g.dataType,protocolStatusCode:e.status.toString(),dependencyOperationName:d,dependencyOperationVersion:i.version&&i.version.toString(),dependencyName:i.serviceName,dependencyType:"WebService",responseSizeBytes:a&&parseInt(a,10)},"Ms.Webi.OutgoingRequest":{customSessionGuid:r.getSessionId(),impressionGuid:r.getImpressionGuid(),message:t?void 0:awa.utils.stringifyField("errorMessage",e.errorThrown),retryCount:l,customData:i.customDataCallBack&&"function"==typeof i.customDataCallBack?awa.utils.stringifyField("customData",i.customDataCallBack(e)):void 0}}};i.QosCallback&&"function"==typeof i.QosCallback&&i.QosCallback(e,t),awa.vortexEvents.SendOrScheduleEvent(t)},(s=function(){var r=d+"_Retry_"+l;return p.recordTimeSpan(r),$.ajax(g).then(function(e,t,n){var a=p.recordTimeSpan(r,!0);return o(n,!0,a),n},function(e,t){var n,a=p.recordTimeSpan(r,!0);return o(e,!1,a),n=$.Deferred(),l<u&&(0===e.status||500<=e.status&&e.status<600)?(l++,c=awa.cv.isValid(i.cV)?awa.cv.incrementExternal(c):awa.cv.increment(),setTimeout(function(){s().done(n.resolve).fail(n.reject)},50)):n.reject(e,t),n.promise()})})().then(function(e,t,n){return n},function(e){return t(e,i)})}awa.logger.logError("jQuery is not defined, cannot use service module")}var p=awa.timespanHandler,m=!0,f=!1,v=null;return{post:function(e){return t(awa.utils.extend({},e,{method:"POST"}))},get:function(e){return t(awa.utils.extend({maxRetry:1},e,{method:"GET"}))},put:function(e){return t(awa.utils.extend({},e,{method:"PUT"}))},del:function(e){return t(awa.utils.extend({},e,{method:"DELETE"}))},patch:function(e){return t(awa.utils.extend({},e,{method:"PATCH"}))},doNotChangeSupportCors:function(){m=!1},alwaysAddCvToRequestHeader:function(){f=!0},setTargetUriOverride:function(e){"function"==typeof e?v=e:"string"==typeof e&&(v=function(){return e})}}}(),function(e){var t=(n.signIn=function(e,t,n){var a=$.Deferred();return this.startDefaultSignIn(e,t,n,a),a},n.startDefaultSignIn=function(t,e,n,a){var r=this,i=!1,o=setTimeout(function(){i||(i=!0,o=void 0,"undefined"!=typeof StandaloneAriaLogger&&void 0!==StandaloneAriaLogger.Logger&&void 0!==StandaloneAriaLogger.Logger.LogEvent&&StandaloneAriaLogger.Logger.LogEvent("unauth_generic","DefaultSignin_Timed_Out"),a.resolve(void 0))},n);getAccount(e,function(e){i||(i=!0,o&&(clearTimeout(o),o=null),r.handleSignInResult(e,t,a))})},n.handleSignInResult=function(e,t,n){var a,r;e&&("undefined"!=typeof StandaloneAriaLogger&&void 0!==StandaloneAriaLogger.Logger&&void 0!==StandaloneAriaLogger.Logger.LogEvent&&((r=e.telemetry).operation=e.op,r.idp=e.idp,r.hasUpn=String(null!==e.upn),StandaloneAriaLogger.Logger.LogEvent("unauth_generic","DefaultSignin_Telemetry",r)),"Redirect"===e.op?(a=e.idp,r=e.upn,e=t,a&&(r&&(e=this.updateQueryStringParameter(t,encodeURI(r))),n.resolve(e))):n.resolve(void 0))},n.updateQueryStringParameter=function(e,t){if(e&&t){var n=/login_hint=(.*?)(?=&|$)/g,t="login_hint="+encodeURIComponent(t);return n.test(e)?e.replace(n,t):e.concat("&",t)}},n);function n(){}e.DefaultSignInAdapter=t}(DefaultSignInHandler=DefaultSignInHandler||{});
