!function(n,e){"function"==typeof define&&define.amd?define([],function(){return n.bookingSSO=e()}):n.bookingSSO=e()}("undefined"==typeof self?this:self,function(){var n,f=[1,5,10,15,30,60,120,300,600],e={initAnonSession:function(n,i){function e(n,e){try{!function(o,i){var r=Date.now();if(window!==window.top)throw new Error("SSO should not be used in iframes");if(function(){try{var n=JSON.parse(localStorage.bssoNextAttempt).dt;return Date.now()<n}catch(n){}}())throw new Error("Too many attempts, please try again later");var a,s,c=function(n,e){c=function(){},document.removeEventListener("message",a),s&&s.parentElement.removeChild(s),i&&i(n,e);var t=Date.now()-r;e=o,t=t,n=n,function(){try{var n;if(localStorage.bssoNextAttempt){var e=JSON.parse(localStorage.bssoNextAttempt),t=e.dt,o=e.interval,i=Date.now()>t+1e3*o;if(i){if(Date.now()>t+2*o*1e3)for(var r=f.length-1;0<=r;r--)if(f[r]<o){o=f[r];break}}else for(var a=0;a<f.length;a++)if(o<f[a]){o=f[a];break}t=Date.now()+1e3*o,n={dt:t,interval:o}}else{var s=f[0],c=Date.now()+1e3*s;n={dt:c,interval:s}}localStorage.bssoNextAttempt=JSON.stringify(n)}catch(n){}}(),function(n,e,t){n={client_id:n.oauthClientId,success:t?0:1,elapsed:e,referrer:location.href};window!==window.top&&(n.iframe=1),window.booking&&window.booking.env&&window.booking.env.b_action&&(n.bkng_action=window.booking.env.b_action);t=d()+"/collector/anon_session_init",e=new XMLHttpRequest;e.withCredentials=!0,e.open("POST",t),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify(n))}(e,t,n)},n=function(n){if(!n.oauthClientId)throw new TypeError("oauthClientId is empty");if(!n.redirectUri)throw new TypeError("redirectUri is empty");var e=d()+"/oauth2/authorize/v2",t={client_id:n.oauthClientId,redirect_uri:n.redirectUri,response_type:"anon_session",prompt:"none",iframe:1,dt:Date.now(),state:n.state||"",bkng_referrer:location.origin+location.pathname};window.booking&&window.booking.env&&window.booking.env.b_action&&(t.bkng_action=window.booking.env.b_action);var o,i="?";for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e+=i+o+"="+encodeURIComponent(t[o]),i="&");return e}(o);(s=document.createElement("iframe")).id="booking-sso-iframe",s.name="booking-sso-iframe",function(n){n.style.top="-100000px",n.style.left="-100000px",n.style.border="none",n.style.width="1px",n.style.height="1px"}(s);var t=!1;s.addEventListener("load",function(){setTimeout(function(){t||c(new Error("IFrame load error"))},5e3)}),s.addEventListener("error",function(){c(new Error("HTTP request error"))}),a=function(n){if(n.origin===location.origin){var e=n.data;if("string"==typeof e)try{e=JSON.parse(n.data)}catch(n){}e&&e.sessionState&&e.oauthClientId===o.oauthClientId&&(t=!0,c(void 0,e))}},window.addEventListener("message",a),document.body.appendChild(s),s.src=n}(n,e)}catch(n){"function"==typeof e&&e(n)}}function d(){return n.apHost?"https://"+n.apHost:"https://"+(/\b(dev|dqs|localhost)\.booking\.com$/.test(location.hostname)?"account.dqs":"account")+".booking.com"}return"function"==typeof Promise?new Promise(function(t,o){e(n,function(n,e){"function"==typeof i&&i(n),n?o(n):t(e)})}):void e(n,i)}},t=window.bookingSSO;return null!=t&&t.autoInitAnonSession&&(n=0|t.autoInitAnonSessionTimeout,setTimeout(function(){e.initAnonSession(t,function(n,e){"function"==typeof t.initAnonSessionCallback&&t.initAnonSessionCallback(n,e)})},n)),e});
