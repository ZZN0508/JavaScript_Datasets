var rootSysName="jsp";function xmljx(t){var n=null;try{(n=new ActiveXObject("Microsoft.XMLDOM")).async="false",n.loadXML(t)}catch(e){n=(new DOMParser).parseFromString(t,"text/xml")}return n}function setHTMLValue(id,type,value){try{var excuteStr;"value"==type?document.getElementById(id).value=value:"innerHTML"==type?document.getElementById(id).innerHTML=value:(excuteStr="document.getElementById('"+id+"')."+type+"='"+value+"'",eval(excuteStr))}catch(e){}}function getHTMLValue(id,type){var value="",excuteStr,value;return value="value"==type?document.getElementById(id).value:"innerHTML"==type?document.getElementById(id).innerHTML:(excuteStr="document.getElementById('"+id+"')."+type,eval(excuteStr)),void 0===value?"":value}function $value(e,t){var n="";try{if("澶氶€夋寜閽�"==t){for(var n=";",o=document.getElementsByName(e),a=0;a<o.length;a++)o[a].checked&&(n+=o[a].value+";");";"==n&&(n="")}else if("鍗曢€夋寜閽�"==t){for(o=document.getElementsByName(e),a=0;a<o.length;a++)if(o[a].checked){n+=o[a].value;break}}else{if("缂栬緫鍣�"==t){var r=window.frames[e].getHtmlContent();return r=r&&r.ReplaceAll("&nbsp;","OA_YHNBSP")}n=document.getElementById(e).value}n=n||""}catch(e){n=""}return n}function $setvalue(e,t,n){try{if("鍗曢€夋寜閽�"==t){for(var o=document.getElementsByName(e),a=0;a<o.length;a++)if(o[a].value==n)return void(o[a].checked=!0)}else if("澶氶€夋寜閽�"==t)for(var r=document.getElementsByName(e),a=0;a<r.length;a++)-1!=n.indexOf(";"+r[a].value+";")&&(r[a].checked=!0);else if("涓嬫媺妗�"==t){for(var i=document.getElementById(e),a=0;a<i.length;a++)if(i[a].value==n)return void(i[a].selected=!0);var d=document.createElement("option");d.text=n,d.value=n,i.add(d),d.selected=!0}else"缂栬緫鍣�"==t?setHTMLValue(e+"HTMLDIV","innerHTML",n):setHTMLValue(e,"value",n)}catch(e){}}function addWhere(e,t){return""==e?t:e+" "+t}function addDBWhere(e,t){return e?t?"("+e+") and ("+t+")":e:t||""}function createXMLNode(e,t){var n="";return n+="<"+e+">",n+="<![CDATA["+t+"]]>",n+="</"+e+">"}function clear(e){for(var t=e.childNodes.length-1;0<=t;t--)e.removeChild(e.childNodes[t])}function $F(e){e=document.getElementById(e);return e?e.value:""}function setRadioValue(e,t){for(var n=document.getElementsByName(e),o=0;o<n.length;o++)if(n[o].value==t)return void(n[o].checked=!0)}function getOpener(){return window.opener||window.dialogArguments}function Ltrim(e){return e.replace(/ +/,"")}function Rtrim(e){return e.replace(/ +$/,"")}function trim(e){if(!e||""==e)return"";for(;" "==e.charAt(0)||"\n"==e.charAt(0)||"\r"==e.charAt(0,1);)e=e.substring(1,e.length);for(;" "==e.charAt(e.length-1)||"\n"==e.charAt(e.length-1)||"\r"==e.charAt(e.length-1);)e=e.substring(0,e.length-1);return e}function f_check_userID(e,t,n){e=e.value;return e.length<t||e.length>n?"闀垮害蹇呴』鍦╗"+t+","+n+"]涔嬮棿":isNaN(e.charAt(0))?/^\w{1,20}$/.test(e)?"OK":"ID鍙兘鐢辨暟瀛椼€佸瓧姣嶃€佷笅鍒掔嚎缁勫悎鑰屾垚":"ID绗竴涓瓧绗︿笉鑳戒负鏁板瓧"}function f_check_china(e,t,n){return/^[\u4e00-\u9fa5]+$/.test(e.value)?e.value.length>=t&&e.value.length<=n?"OK":"闀垮害蹇呴』鍦╗"+t+","+n+"]涔嬮棿":"璇疯緭鍏ユ眽瀛�"}function f_check_length(e,t,n){return e.value.length>=t&&e.value.length<=n?"OK":"闀垮害蹇呴』鍦╗"+t+","+n+"]涔嬮棿"}function f_check_integer(e){return!!/^(\+|-)?\d+$/.test(e)}function f_check_float(e){return!!/^(\+|-)?\d+($|\.\d+$)/.test(e)}function getDateTime(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),e=e.getDate();return t+"-"+(n=n<10?"0"+n:n)+"-"+(e=e<10?"0"+e:e)}function JHshToUpperCase(e){e.value=e.value.toUpperCase()}function chooseSelect(e,t){for(var n=document.getElementById(e).options,o=n.length,a=null,r=0;r<o;r++){(a=n[r]).value==t&&(a.selected=!0);break}}function getPath(e,t,n,o,a){var r=new Array,i=e.lastIndexOf("\\");if(-1==i)return alert("璇疯緭鍏ュ悎娉曠殑鏂囨。璺緞"),!1;var d=e.substring(i+1),e=d.lastIndexOf(".");if(-1==e)return alert("绯荤粺涓嶆敮鎸佹病鏈夋墿灞曞悕鐨勬枃浠朵笂浼�"),!1;i=d.substring(e+1),e=d.substring(0,e),a=t+"//"+n+"_"+o+"_"+a+"_"+(new Date).getTime()+"_"+getRandomNum(999999)+"."+i;return r[0]=e,r[1]=a,r[2]=i,r}function getRandomNum(e){var t=+e,e=Math.random();return Math.round(e*t)}function downLoad(e,t,n){var o=document.DOWNLOADFORM;o.CHINAVALUE.value=t,o.ENLISHVALUE.value=e,o.EXTENSIONVALUE.value=n,o.submit()}function openForeignWindow(e,t,n){window.showModalDialog("go_to_page.do?path=eformdatachooselist&basename="+e+"&showFieldName="+t+"&hideFieldName="+n,window,"dialogWidth:800px; dialogHeight:600px; center:yes; help:no; resizable:yes; status:no")}function encode(e,t){return("function"==typeof encodeURIComponent?t?encodeURI:encodeURIComponent:escape)(e)}function decode(t){if("function"==typeof decodeURIComponent)try{t=decodeURIComponent(t)}catch(e){t=unescape(t)}else t=unescape(t);return t}function setCookie(e,t,n,o){document.cookie=e+"="+encode(t)+";path="+n+" ;"+o}function getCookie(e){for(var t=document.cookie.split("; "),n=0;n<t.length;n++){var o=t[n].split("=");if(o[0]==e)return decode(o[1])}return""}function showDetail(e,t,n){window.showModalDialog("go_to_page.do?path=downloadframe&isMark="+n+"&ID="+e+"&eformDataID="+t,window,"dialogWidth:800px; dialogHeight:600px; center:yes; help:no; resizable:yes; status:no")}function showDetailDoc(e,t){"509"==e?window.open("../document/eformDataDetail.jsp?ID="+e+"&eformDataId="+t+"&type=onlyContent"):window.open("../document/eformDataDetail.jsp?ID="+e+"&eformDataId="+t)}function showDispense(e,t,n){document.getElementById("docid").value=e,document.getElementById("dispense").style.display="block",document.getElementById("dispense").style.top=(t+document.body.clientHeight-document.getElementById("dispense").offsetHeight)/2+"px",document.getElementById("dispense").style.left=(n+document.body.clientWidth-document.getElementById("dispense").offsetWidth)/2+"px"}function openWindow(e){window.open(e)}function openNoWindow(e){window.open(e,"","","")}function openMorePersonWindow(e,t){window.open("../main/choose_more_person.jsp?showField="+e+"&hideField="+t,"userwidow","","")}function openOnePersonWindow(e,t){window.open("../main/choose_one_person.jsp?showField="+e+"&hideField="+t,"userwidow","","")}function openSqlTool(e,t,n){window.showModalDialog("go_to_page.do?path=sqltool&eformID="+e+"&basename="+n+"&parentFieldName="+t,window,"dialogWidth:700px; dialogHeight:500px; center:yes; help:no; resizable:yes; status:no")}function delete_eform_data(e,t){t="ID="+e+"&eformDataIdList="+t+"&random="+Math.random();$.ajax({type:"POST",url:"delete_eformdata.do",data:t,success:function(e){-1!=e.indexOf("FAIL")?alert("鍒犻櫎鏁版嵁澶辫触"):alert("鎴愬姛鍒犻櫎鏁版嵁"),init()}})}function gd_eform_data(e,t){e="ID="+e+"&eformDataIdList="+t+"&random="+Math.random();$.ajax({type:"POST",url:"gd_eformdata.do",data:e,success:function(e){-1!=e.indexOf("FAIL")?alert("褰掓。[ "+t+" ]鏁版嵁澶辫触"):alert("鎴愬姛瀵筟 "+t+" ]鏁版嵁杩涜浜嗗綊妗�"),init()}})}function deleteTEformField(t){var e="eformFieldID="+t+"&random="+Math.random();$.ajax({type:"POST",url:"deleteeformfield.do",data:e,success:function(e){-1!=e.indexOf("$FAIL$")?alert("鍒犻櫎[ "+t+" ]鏁版嵁澶辫触"):(alert("鎴愬姛鍒犻櫎[ "+t+" ]鏁版嵁"),init())}})}function heightSearch(e){window.showModalDialog("go_to_page.do?ID="+e+"&path=eformdatasearch",window,"dialogWidth:900px; dialogHeight:550px; center:yes; help:no; resizable:yes; status:no")}function downLoadTemplate(e,t){e="eformID="+e+"&random="+Math.random();$.ajax({type:"POST",url:"geteformdatatemplate.do",data:e,cache:!1,success:function(e){-1!=e.indexOf("$FAIL$")?alert("鏈嶅姟鍣ㄥ嚭鐜板紓甯�"):(e=trim(e),window.location.href="download/download.jsp?file="+e+"&name="+t+".xls")}})}function chooseEformID(e,t){window.showModalDialog("go_to_page.do?showFieldName="+e+"&hideFieldName="+t+"&path=alerteformchooseid",window,"dialogWidth:600px; dialogHeight:700px; center:yes; help:no; resizable:yes; status:no")}function $text(e){for(var t,n=";",o=document.getElementById(e).options,a=0;a<o.length;a++)(t=o[a]).selected&&(n+=t.text+";");return n=";"==n?"":n}function searchObjByTagName(e,t,n){for(var o=0;null!=e&&"undefind"!=typeof e.tagName&&o<=5;){if(e.tagName.toUpperCase()==t.toUpperCase())return e;if(e.tagName.toUpperCase()==n.toUpperCase())return e;e=e.parentElement,o++}return null}function province_city_union(t,n,o){$("#"+n).change(function(){var e="provinceName="+$value(n)+"&cityID="+t+"&random="+Math.random();$.ajax({type:"POST",url:"getcityaction.do",data:e,cache:!1,success:function(e){e=xmljx(e);var t=XML.getValue(e,"VALUELIST"),e=XML.getValue(e,"TEXTLIST");THSelect.initOne(o,e,t,"")}})})}function openAppendix(e,t){window.showModalDialog("go_to_page.do?path=upload_frame&eformFieldID="+e+"&eformFieldName="+t,window,"dialogWidth:800px; dialogHeight:300px; center:yes; help:no; resizable:yes; status:no")}function download(e,t){window.location.href="download/download.jsp?file="+e+"&name="+t}function leaveMarks(e,t,n,o){".doc"==n||".DOC"==n?window.showModalDialog("leave_marks.do?file="+e+"&type="+o,window,"dialogWidth:1000px; dialogHeight:600px; center:yes; help:no; resizable:yes; status:no"):download(e,t)}function deleteAppendix(n,o){var e="appendixId="+o+"&random="+Math.random();$.ajax({type:"POST",url:"delete_appendix.do",data:e,success:function(e){var t;-1!=e.indexOf("$FAIL$")?alert("鍒犻櫎闄勪欢淇℃伅澶辫触"):(alert("鎴愬姛鍒犻櫎浜嗛檮浠剁殑淇℃伅"),t=searchObjByTagName(document.getElementById(n),"span","td"),e=document.getElementById("appendix_span_"+o),t.removeChild(e),e=document.getElementById(n).value,e=parseInt(e)-1,document.getElementById(n).value=e)}})}function deleteKmsAppendix(o,a){$.ajax({type:"POST",url:"deleteKmsAppendix.do",data:"appendixId="+a+"&type="+o,cache:!1,success:function(e){var t,n;-1!=e.indexOf("SUCCESS")?(alert("闄勪欢鍒犻櫎鎴愬姛"),n="","0"==o?n="PICAPPENDIXELE":"1"==o&&(n="FILEAPPENDIXELE"),t=document.getElementById(n),n=document.getElementById("appendix_span_"+a),t.removeChild(n),n=document.getElementById(docAppendix).value,n=parseInt(n)-1,document.getElementById(docAppendix).value=n):-1!=e.indexOf("$FAIL$")&&alert("闄勪欢鍒犻櫎澶辫触")}})}function doubleclick(e){var t;confirm("纭畾鎵嬪姩杈撳叆锛�")&&(e="<input type='text' name="+(t=document.getElementById(e)).name+" id="+t.id+" style='width:100px'>",searchObjByTagName(t,"span","p").innerHTML=e)}function handler(e,t){var t=t+"=",n=e.indexOf(t);if(-1==n)return"";var o=e.indexOf("&",n);return-1==o?e.substring(n+t.length):e.substring(n+t.length,o)}function showprogress(){}function closeprogress(){}function showEditEformData(e,t){window.showModalDialog("go_to_page.do?path=eformdataedit&ID="+e+"&eformDataID="+t+"&isclosed=true",window,"dialogWidth:800px; dialogHeight:300px; center:yes; help:no; resizable:yes; status:no")}function showAddEformData(e){window.showModalDialog("go_to_page.do?path=eformdatainsert&ID="+e+"&isclosed=true",window,"dialogWidth:800px; dialogHeight:300px; center:yes; help:no; resizable:yes; status:no")}function getDefaultTime(e){var t=new Date,n=t.getYear(),o=(o=t.getMonth()+1)<10?"0"+o:o,a=(a=t.getDate())<10?"0"+a:o,r=(r=t.getHours())<10?"0"+r:r,t=(t=t.getMinutes())<10?"0"+t:t;return"TH_CURDATETIME"!=e?"TH_CURDATE"!=e?"":n+"-"+o+"-"+a:n+"-"+o+"-"+a+" "+r+":"+t}function chooseUser(e,t){window.showModalDialog("chooseidname.do?path=chooseuser&comFieldID="+e+"&comFieldName="+t,window,"dialogWidth:500px; dialogHeight:600px; center:yes; help:no; resizable:yes; status:no")}function chooseRole(e,t){window.showModalDialog("chooseidname.do?path=chooserole&comFieldID="+e+"&comFieldName="+t,window,"dialogWidth:500px; dialogHeight:600px; center:yes; help:no; resizable:yes; status:no")}function ForDight(e,t){return e=Math.round(e*Math.pow(10,t))/Math.pow(10,t)}function openChat(e){var t=0;self.screen?(t=screen.width,screen.height):t=1024;window.open("chatTreeIndex.do",e+"chatUserTreeWindow","left="+(t-240)+",top=0,height=500,width=240,menubar=no,toolbar=no,location =no,status=no,scrollbars=yes,resizable=yes,alwaysRaised=yes,depended=yes,hotkeys=yes,resizable=no")}function showprocessbar(){try{$("#right").scrollTop(0);var e=document.getElementById("jiazai");e||((e=document.createElement("div")).id="jiazai",document.body.appendChild(e)),e.className="add_block_process",e.innerHTML='<div class="border_5"><table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0" class="b0rder_0">     <tr>      <td width="25%" align="right"><img src="'+rootSysName+'/images/loading_2.gif"></td>      <td width="75%" style="padding-left:8px;font-size: 11pt;">姝ｅ湪鏌ヨ锛岃绋嶅悗...</td>     </tr>    </table> </div>'}catch(e){}}function closeprocessbar(){try{var e=document.getElementById("jiazai");e&&(e.innerHTML="",e.className="")}catch(e){alert("error")}}function getScroll(){document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop=0:document.body&&(document.body.scrollTop=0)}function Utf8ToUnicode(e){for(var t,n,o,a="",r=e.length,i=0,d=r;i<r;)if(0==(128&(t=e.charCodeAt(i)))){if(d<1)break;a+=String.fromCharCode(127&t),i++,--d}else if(192==(224&t)){if(n=e.charCodeAt(i+1),d<2||128!=(192&n))break;a+=String.fromCharCode((63&t)<<6|63&n),i+=2,d-=2}else{if(224!=(240&t))break;if(n=e.charCodeAt(i+1),o=e.charCodeAt(i+2),d<3||128!=(192&n)||128!=(192&o))break;a+=String.fromCharCode((15&t)<<12|(63&n)<<6|63&o),i+=3,d-=3}return 0!=d?"":a}function SetHome(e){var t=window.location.href;try{e.style.behavior="url(#default#homepage)",e.setHomePage(t)}catch(e){if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(e){alert("姝ゆ搷浣滆娴忚鍣ㄦ嫆缁濓紒\n璇峰湪娴忚鍣ㄥ湴鍧€鏍忚緭鍏モ€渁bout:config鈥濆苟鍥炶溅\n鐒跺悗灏� [signed.applets.codebase_principal_support]鐨勫€艰缃负'true',鍙屽嚮鍗冲彲銆�")}Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefBranch).setCharPref("browser.startup.homepage",t)}}}function AddFavorite(t){var n=window.location.href;try{window.external.addFavorite(n,t)}catch(e){try{window.sidebar.addPanel(t,n,"")}catch(e){alert("鍔犲叆鏀惰棌澶辫触锛岃浣跨敤Ctrl+D杩涜娣诲姞")}}}function backOrForward(t,n){try{$.ajax({type:"post",url:"go.do",data:"type="+t,cache:!1,beforeSend:function(){$(n).unbind("click"),showprocessbar()},success:function(e){if(0==trim(e).length)return alert("鏈€鍚庝竴椤碉紝鏃犳硶鍚庨€€锛�"),void closeprocessbar();e=e.split("?");$.post(e[0],e[1]+"&backOrforward=0",function(e){closeprocessbar(),$("#right").html(e),$(n).bind("click",function(){backOrForward(t,n)})})}})}catch(e){}}function goToDocDetail(e,t,n,o,a,r,i,d,l,c,s,u,p,h,m,f,g,y,w,v,I,x,D,b,E){var _=!0;try{0<$("input[type=checkbox][name=changeDocId][checked]").length&&(_=window.confirm("纭畾瑕佽闂鏂囩珷鍚�?"))}catch(e){}_&&(e="title="+e,e+="&url="+t,e+="&siteName="+i,e+="&author="+d,e+="&classInfo="+l,e+="&siteAddr="+c,e+="&happenProvice="+s,e+="&keywords="+h,e+="&persionName="+f,e+="&addressName="+g,e+="&departName="+y,e+="&keywordHash="+m,e+="&ip="+D,e+="&txtfile="+v,e+="&txtoffset="+I,e+="&txtlength="+x,e+="&docId="+n,e+="&emotion="+u,e+="&polarity="+p,e+="&keyword="+b,t="document_page_detail.do?menuType=detail&"+(e+="&searchChannel="+E),window.open(t))}function goToSkyDocDetail(e,t,n,o,a,r,i,d,l,c,s,u,p,h,m,f,g,y,w,v,I,x,D,b,$){e="title="+e;e+="&url="+t,e+="&siteName="+i,e+="&author="+d,e+="&classInfo="+l,e+="&siteAddr="+c,e+="&happenProvice="+s,e+="&keywords="+h,e+="&persionName="+f,e+="&addressName="+g,e+="&departName="+y,e+="&keywordHash="+m,e+="&ip="+D,e+="&txtfile="+v,e+="&txtoffset="+I,e+="&txtlength="+x,e+="&docId="+n,e+="&emotion="+u,e+="&polarity="+p,e+="&keyword="+b;t="document_page_detail_sky.do?menuType=detail&"+(e+="&searchChannel="+$);window.open(t)}function chooseAll(e,t){var n=document.getElementsByName(e);if(t.checked)for(var o=0;o<n.length;o++)n[o].checked=!0;else for(o=0;o<n.length;o++)n[o].checked=!1}function updateLocation(e){$("#location").html(e)}function taggleSelectAll(e,t){$("#"+e).attr("checked")?$("input[type=checkbox][name="+t+"]").attr("checked","checked"):$("input[type=checkbox][name="+t+"]").removeAttr("checked")}function getCheckValue(e){var t=",";return $("input[type=checkbox][name="+e+"][checked]").each(function(){t=t+$(this).val()+","}),t}function addLightColorToString(e,t){if(null==t||0==t.length)return e;if(null==e||0==e.length)return e;var n=new RegExp(t,"g");return e=e.replace(n,"<span style='color:#ff0000'>"+t+"</span>")}function handlerStr(e,t){return e=e.length>t?e.substring(0,t):e}function isNumber(e){if(!e)return!1;if(!/^\d+(\.\d+)?$/.test(e))return!1;try{if(parseFloat(e)!=e)return!1}catch(e){return!1}return!0}function isEmail(e){return myReg=/^([-_A-Za-z0-9\.]+)@([-_A-Za-z0-9]+\.)+[_A-Za-z0-9]{2,3}$/,!!myReg.test(e)}function isMobileNo(e){return myReg=/^([-_0-9]+)$/,!!myReg.test(e)}function getTimeStringByLong(e,t){if(!isNumber(e))return"";t=t||"$yyyy$-$MM$-$dd$ $HH$:$mm$:$ss$";var n=new Date,o=n.getTime()-e;n.setTime(e);var a=(a=parseInt(n.getYear()))<1900?a+1900:a,r=(r=parseInt(n.getMonth()+1))<10?"0"+r:r,i=(i=parseInt(n.getDate()))<10?"0"+i:i,d=(d=parseInt(n.getHours()))<10?"0"+d:d,e=(e=parseInt(n.getMinutes()))<10?"0"+e:e,n=(n=parseInt(n.getSeconds()))<10?"0"+n:n;return t=t.ReplaceAll("\\$yyyy\\$",a).ReplaceAll("\\$MM\\$",r).ReplaceAll("\\$dd\\$",i).ReplaceAll("\\$HH\\$",d).ReplaceAll("\\$mm\\$",e).ReplaceAll("\\$ss\\$",n).ReplaceAll("\\$XSQ\\$",parseInt(o/1e3/60/60))}function findPreAndNext(e,t){for(var n=0,o=0,a=0;a<e.length&&(n=a-1,o=a+1,e[a]!=t);a++);n<0&&(n=0),o>=e.length&&(o=e.length-1);var r=new Array;return r[0]=e[n],r[1]=e[o],r}String.prototype.endWith=function(e){return new RegExp(e+"$").test(this)},String.prototype.ReplaceAll=function(e,t){e=new RegExp(e,"g");try{return this.replace(e,t)}catch(e){return""}};
