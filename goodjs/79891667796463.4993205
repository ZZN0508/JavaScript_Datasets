(window.webpackJsonp_spotim_registration=window.webpackJsonp_spotim_registration||[]).push([[4],{24:function(t,e,n){"use strict";n.d(e,"n",function(){return r}),n.d(e,"h",function(){return o}),n.d(e,"m",function(){return a}),n.d(e,"i",function(){return c}),n.d(e,"j",function(){return s}),n.d(e,"o",function(){return i}),n.d(e,"k",function(){return u}),n.d(e,"l",function(){return d}),n.d(e,"e",function(){return p}),n.d(e,"c",function(){return f}),n.d(e,"g",function(){return l}),n.d(e,"b",function(){return g}),n.d(e,"f",function(){return O}),n.d(e,"a",function(){return b}),n.d(e,"d",function(){return w});var e=n(7),e=n.n(e),r=e.a.get("init_data.config.id"),o=e.a.get("init_data.config.brand_color"),a=e.a.get("init_data.config.name"),c=e.a.get("init_data.config.connect_networks"),s=e.a.get("init_data.config.ltr")?"ltr":"rtl",i=e.a.get("tenant_config.registration.use_new_sso_api",!1),u=2===e.a.get("tenant_config.authentication.version",1),d=e.a.get("tenant_config.authentication.real_user_mode",!1),p="x-spotim-page-view-id",f="x-spotim-device-uuid",l="x-spotim-token",g="x-openweb-token",O="x-spotim-spotid",b="x-access-token",w="x-spotim-device-v2"},25:function(t,e,n){"use strict";function r(t){var e=t.accessToken,t=t.openWebAccessToken;e&&localStorage.setItem("SPOTIM_ACCESS_TOKEN",e),t&&localStorage.setItem("OPENWEB_ACCESS_TOKEN",t)}function o(){return{accessToken:localStorage.getItem("SPOTIM_ACCESS_TOKEN"),openWebAccessToken:localStorage.getItem("OPENWEB_ACCESS_TOKEN")}}n.d(e,"b",function(){return r}),n.d(e,"a",function(){return o})},26:function(t,e,n){"use strict";var r=n(55),r=n.n(r),n=n(51),n=r.a.create({baseURL:Object(n.a)()});e.a=n},27:function(t,e,n){"use strict";var r=n(8),o=n.n(r),a=n(65),c=n(24),s=n(25);function i(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){o()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}e.a=function(t){var e=t.token,n=t.spotId,t=Object(s.a)().openWebAccessToken;return u(u({},c.k?o()({},c.b,t):{}),{},(t={},o()(t,c.e,window.__SPOTIM_PAGE_VIEW_ID__),o()(t,c.c,Object(a.getStorageDeviceUuid)().uuid||""),o()(t,c.g,e),o()(t,c.f,n),t))}},30:function(t,e,n){"use strict";var r=n(7),o=n.n(r),r=n(18),r=n.n(r),o=o.a.get("spotId"),o=r()(o,"registration",{version:"v1.15.8"});e.a=o},33:function(t,e,n){"use strict";var r=n(22),s=n.n(r),r=n(23),i=n.n(r),u=n(16),o=n.n(u),r=n(17),a=n.n(r),d=n(4),p=n(26),f=n(27),l=n(25),g=n(24),O=n(30);var c,n=(c=i()(s.a.mark(function t(e){var r,n,c;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.spotId,g.k||g.l)return t.abrupt("return",new Promise(function(){var e=i()(s.a.mark(function t(e){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a()("v1.0.0/authentication/current-user",{method:"POST",headers:{"x-spot-id":r,"x-real-user-mode":"true"}});case 2:n=t.sent,(n=Object(u.parseUser)(n)).isRegistered&&Object(d.dispatchSpotimEvent)("spot-im-post-login",{currentUser:{email:n.email||"",socialNetworks:n.socialNetworks||[],username:n.username||""}}),e(n);case 6:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()));t.next=5;break;case 5:return t.next=7,o.a.getAsyncToken();case 7:return n=t.sent,c=n.token,t.abrupt("return",new Promise(function(o,a){var e;p.a.post("me/login",{spot_id:r},{method:"POST",headers:Object(f.a)({spotId:r,token:c})}).then((e=i()(s.a.mark(function t(e){var n,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:!1===(null==e||null===(n=e.data)||void 0===n?void 0:n.success)&&(r=new Error("Login failed due to ".concat(e.data.type," with code: ").concat(e.data.code," and status: ").concat(e.data.status)),O.a.error("login",r),a(new Error("Login failed due to ".concat(e.data.type," with code: ").concat(e.data.code," and status: ").concat(e.data.status)))),Object(l.b)({accessToken:e.headers[g.a],openWebAccessToken:e.headers[g.b]}),function(t){try{localStorage.setItem("SPOTIM_DEVICE_V2",t)}catch(t){O.a.error("setDeviceV2",t)}}(e.headers[g.d]),(r=Object(u.parseUser)(e.data)).isRegistered&&Object(d.dispatchSpotimEvent)("spot-im-post-login",{currentUser:{email:r.email||"",socialNetworks:r.socialNetworks||[],username:r.username||""}}),o(r);case 6:case"end":return t.stop()}},t)})),function(t){return e.apply(this,arguments)})).catch(function(t){O.a.error("login",t),a(new Error("Login failed due to with error: ".concat(t)))})}));case 10:case"end":return t.stop()}},t)})),function(t){return c.apply(this,arguments)});e.a=n},38:function(t,e,n){"use strict";var r=n(22),a=n.n(r),r=n(23),c=n.n(r),s=n(26),r=n(16),i=n.n(r),u=n(27),d=n(25),p=n(24);e.a=function(t){var e,r=t.spotId,o=t.token;return new Promise((e=c()(a.a.mark(function t(n){var e;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.getAsyncToken();case 2:e=t.sent,e=e.networkId,s.a.post("me/network-token/".concat(e),{spot_id:r},{method:"POST",headers:Object(u.a)({spotId:r,token:o})}).then(function(t){Object(d.b)({accessToken:t.headers[p.a],openWebAccessToken:t.headers[p.b]});var e=t.data,t=e.network_id,e=e.token;i.a.setToken(e,t),n({token:e})});case 5:case"end":return t.stop()}},t)})),function(t){return e.apply(this,arguments)}))}},44:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(4),o=null;function a(t){var e=function(){try{if(null===o){var t=new URLSearchParams(Object(r.getLocation)().search);if(!(o=!(o=t.get("SPOTIM_DEBUG_API".toLowerCase()))?window.SPOTIM_DEBUG_API:o))try{o=window.localStorage.getItem("SPOTIM_DEBUG_API")}catch(t){}o=(o=o||"").split(",").map(function(t){return t.toLowerCase()})}return o}catch(t){return[]}}();return-1<e.indexOf("*")||-1<e.indexOf(t.toLowerCase())?function(t){for(var e,n=arguments.length,r=new Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=console).log.apply(e,["%cSpot.IM ".concat(t),"background: #307fe2; color: white;"].concat(r))}.bind(null,t):function(){}}},52:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"c",function(){return c}),n.d(e,"b",function(){return s});var r=n(30),n=n(44),o=Object(n.a)("SSO"),a=function(t){var e;try{e=localStorage.getItem("OWֹֹ_EXTERNAL_USER_ID")||""}catch(t){var n="SSO - cannot get ".concat("OWֹֹ_EXTERNAL_USER_ID"," from local storage: ").concat(t);o(n),r.a.error("startSSO",n)}return t!==e},c=function(t){try{localStorage.setItem("OWֹֹ_EXTERNAL_USER_ID",t)}catch(t){var e="SSO - cannot set ".concat("OWֹֹ_EXTERNAL_USER_ID"," in local storage: ").concat(t);o(e),r.a.error("startSSO",e)}},s=function(){try{localStorage.removeItem("OWֹֹ_EXTERNAL_USER_ID")}catch(t){var e="SSO - cannot set ".concat("OWֹֹ_EXTERNAL_USER_ID"," in local storage: ").concat(t);o(e),r.a.error("startSSO",e)}}},71:function(t,e,n){"use strict";n.r(e);var r=n(22),d=n.n(r),r=n(8),o=n.n(r),r=n(23),p=n.n(r),a=n(16),f=n.n(a),r=n(7),c=n.n(r),r=n(17),l=n.n(r),g=n(26),O=n(38),b=n(33),w=n(27),h=n(25),m=n(24),v=n(30),_=n(52),n=n(44);function s(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){o()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var i,k=Object(n.a)("Registration"),n=(i=p()(d.a.mark(function t(){var e,s,i,u;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return k("Logout started"),t.next=3,f.a.getAsyncToken();case 3:return e=t.sent,s=e.token,i=c.a.get("spotId"),t.next=8,f.a.getAsyncUser();case 8:if((u=t.sent).isRegistered){t.next=14;break}return t.abrupt("return",Promise.resolve(u));case 14:if(m.k)return t.abrupt("return",new Promise(function(){var e=p()(d.a.mark(function t(e){var n;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l()("v1.0.0/authentication/logout",{method:"POST",headers:{"x-spot-id":i}});case 2:n=t.sent,n=Object(a.parseUser)(n),Object(_.b)(),f.a.set(S(S({},n),{},{isSuperAdmin:!1})),k("Logout succeed, new current user is: ",n),e(n);case 8:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()));t.next=18;break;case 18:return t.abrupt("return",new Promise(function(a,c){var e;g.a.post("me/logout",{spot_id:i},{method:"POST",headers:Object(w.a)({spotId:i,token:s})}).then((e=p()(d.a.mark(function t(e){var n,r,o;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return!1===(null==e||null===(n=e.data)||void 0===n?void 0:n.success)&&(r=new Error("Logout failed due to ".concat(e.data.type," with code: ").concat(e.data.code," and status: ").concat(e.data.status)),v.a.error("logout",r),c(new Error("Logout failed due to ".concat(e.data.type," with code: ").concat(e.data.code," and status: ").concat(e.data.status)))),Object(h.b)({accessToken:e.headers[m.a],openWebAccessToken:e.headers[m.b]}),t.next=4,Object(O.a)({spotId:i,token:s});case 4:return o=t.sent,o=o.token,f.a.setToken(o),t.next=9,Object(b.a)({spotId:i});case 9:o=t.sent,Object(_.b)(),f.a.set(S(S({},o),{},{isSuperAdmin:!1})),k("Logout succeed, new current user is: ",u),a(o);case 14:case"end":return t.stop()}},t)})),function(t){return e.apply(this,arguments)})).catch(function(t){v.a.error("logout",t),k("Logout failed with: ",t),c(new Error("Logout failed due to with error: ".concat(t)))})}));case 19:case"end":return t.stop()}},t)})),function(){return i.apply(this,arguments)});e.default=n}}]);
