function bt_eval(n,t){try{return window.eval.apply(window,[n])}catch(n){t&&t(n)}}var bt_parameter=function(){var e;return function(n,t){t=t||document;return(e=void 0===e?new BrightTag.HTTP.URL(t.location.href):e).param(n)}}();function bt_meta(n,t){for(var e,r=(t||document).getElementsByTagName("meta"),i=0,o=r.length;i<o;i++)if((e=r[i]).getAttribute("name")===n)return e.getAttribute("content");return""}function bt_cookie(n,t){return new BrightTag.HTTP.Cookie(t||document).get(n)||""}function bt_data(n,t){var e=BrightTag.V2_RESPONSE?BrightTag.configuredSites()[0]:BrightTag.instance;return e?e.data(n,t):""}function bt_log(n){window.console&&console.log&&console.log("Signal: "+n)}window.bt_data_escaped=bt_data;var _bt_url_prefix,_bt_referrer,_bt_site,_bt_mode,bt_handle_exception=bt_log;function btServe(n){var t=BrightTag,e={referrer:_bt_referrer,site:_bt_site,mode:_bt_mode};null!=_bt_url_prefix&&(e.host=_bt_url_prefix),t.configureSite(t.extend(e,n),window,t.initializeSite)}window.BrightTag=function(b){function t(n,t){return Object.prototype.toString.call(n)==="[object "+t+"]"}function a(n){return n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function m(n){return"\n//at-sourceURL=/BrightTag/"+n.replace(/\s+/g,"_")+".js"}function r(n,t,e){for(var r in n)n.hasOwnProperty(r)&&t.call(e,r,n[r],n)}function y(n,t,e){n&&(i(n)?Y.call(n,t,e):X.isObject(n)&&r(n,t,e))}function w(e,n){return r(n,function(n,t){e[n]=t}),e}function i(n){return X.isArray(n)||!X.isString(n)&&n.length}function o(n){return!!n}function u(n,t,e){if(n)return Z.call(i(n)?n:[n],t||o,e)}function S(n,t){for(var e=X.isArray(n)?n:[n],r=0,i=e.length;r<i;r++)if(e[r]===t)return!0;return!1}function s(n){return X.isString(n)?n.replace(/%/g,"%25").replace(/#/g,"%23").replace(/&/g,"%26").replace(/'/g,"%27").replace(/;/g,"%3B").replace(/</g,"%3C").replace(/>/g,"%3E"):n}function p(n){for(var t=5381,e=0,r=n.length;e<r;)t=(t<<5)+t+n.charCodeAt(e++);return t.toString(36)}function c(n){if("s.yjtag.jp"===n&&"false"!==b.HTTP.Cookie(document).get("testyjproxy"))return"yjtag.yahoo.co.jp"}function _(o){function i(){}function a(e){var r=Array.prototype.slice.call(arguments,1);tn.each(m,function(n){var t=[h].concat(r);(n[e]||i).apply(null,t)})}function n(){y=!0,w=b.length,a("engine:off")}function t(){y&&a("engine:on"),y=!1,S=0,(b[w++]||n)()}function u(n,t){return{type:n,exception:t}}function c(){a("block:finish"),t()}function s(n,t){var e=o.createElement(n.tagName),r=tn.extend(tn.extend({},n.defaults),t||{});return tn.each(n.supported,function(n){X.isString(n)&&null!=r[n]?e[n]=r[n]:X.isObject(n)&&null!=r[n.option]&&n.setter(e,r[n.option])}),e}function e(n,t){t=s(_,t);t.onerror=function(){a("block:error",u("iframe","Problem loading "+n))},a("block:start",n),t.src=n.toString(),o.body.appendChild(t),c()}function r(n,t){t=s(O,t);t.onerror=function(){a("block:error",u("image","Problem loading "+n))},a("block:start",n),t.src=n.toString(),c()}function f(n,t,e){var r=!1,i=s(j,e);i.onerror=function(){a("block:error",u("script","Problem loading "+n)),r||c()},i.onload=i.onreadystatechange=function(){var n;if(!(n=r)){n:{switch(i.readyState){case void 0:case"loaded":case"complete":n=!0;break n}n=!1}n=!n}n||(r=!0,c())},a("block:start",n),n&&(i.src=n.toString()),t&&(i.text=t),(t=o.getElementsByTagName("script")[0]).parentNode.insertBefore(i,t)}function l(n){var t=Array.prototype.slice.call(arguments,1);return function(){n.apply(null,t)}}function p(t){return function(){try{var n;a("block:start",t),X.isString(t)?(n=tn.trim(t).replace(/^\x3c!--/,"").replace(/--\x3e$/,""),o.defaultView?o.defaultView.eval.call(window,n):o.parentWindow?o.parentWindow.execScript(n):a("block:error",u("wait","Could not evaluate wait block ["+n+"]"))):t()}catch(n){a("block:error",u("wait",n))}finally{c()}}}function d(n){return b.push(n),y&&t(),h}function g(n){return b.splice(w+S++,0,n),h}var h=this,m=[],v={},y=!1,b=[],w=0,S=0,_={tagName:"iframe",defaults:{frameborder:"0",height:"1px",scrolling:"no",width:"1px"},supported:[{option:"display",setter:function(n,t){n.style.display=t}},"frameborder","id","height","scrolling","width"]},O={tagName:"img",defaults:{},supported:[{option:"display",setter:function(n,t){n.style.display=t}},"id",{option:"height",setter:function(n,t){n.setAttribute("height",t)}},{option:"width",setter:function(n,t){n.setAttribute("width",t)}}]},j={tagName:"script",defaults:{type:"text/javascript"},supported:["async","id","type","charset"]};h.run=function(){a("engine:on"),t()},h.options=function(n){return tn.extend(v,n),h},h.option=function(n){return v[n]},h.iframe=function(n,t){return d(l(e,n,t))},h.image=function(n,t){return d(l(r,n,t))},h.script=function(n,t,e){return d(l(f,n,t,e))},h.wait=function(n){return d(p(n))},h.preemptCss=function(n,t){return g(l(f,n,t))},h.preemptIframe=function(n,t){return g(l(f,n,t))},h.preemptImage=function(n,t){return g(l(f,n,t))},h.preemptScript=function(n,t,e){return g(l(f,n,t,e))},h.preemptWait=function(n){return g(p(n))},h.listen=function(n){return m.push(n),(n["engine:listen"]||i).apply(null,[h]),h}}function f(n){function t(n){i.push(n),a&&!u&&r()}function e(n){n.run()}function r(){var n=i[o];n&&(o++,n.listen(c).run())}var i=[],o=0,a=!1,u=!1,c={"engine:on":function(){u=!0},"engine:off":function(){u=!1,r()}},s=t;this.alwaysQueue=function(){s=t},this.neverQueue=function(){s=e},this.push=function(n){return s(n),n},this.run=function(){a=!0,r()},this.applyListener=function(n){for(var t=o,e=i.length;t<e;t++)i[t].listen(n)},this.toString=function(){return"Group[name="+n+"; working="+u+"; running="+a+"]"}}function O(t,e){return{"engine:listen":function(n){n.listen(new en(t,e))}}}function j(n){function e(n){return i[n]||(i[n]=new f(n))}function t(n){return r.addToGroup(n,r.newEngine())}var r=this,i={undefined:new f(void 0)},o=[];i.undefined.neverQueue(),r.addGlobalListener=function(e){o.push(e),y(i,function(n,t){t.applyListener(e)})},r.addToGroup=function(n,t){return y(o,function(n){t.listen(n)}),e(n).push(t)},r.newEngine=function(){return new _(n)},r.group=t,r.listen=function(){return t().listen.apply(null,arguments)},r.iframe=function(){return t().iframe.apply(null,arguments)},r.image=function(){return t().image.apply(null,arguments)},r.script=function(){return t().script.apply(null,arguments)},r.wait=function(){return t().wait.apply(null,arguments)},r.run=function(n){e(n).run()},r.alwaysQueue=function(n){e(n).alwaysQueue()},r.neverQueue=function(n){e(n).neverQueue()},r.setOptions=function(){return t()}}function l(r){function i(n){var t,e,r=n.split(c);for(a={},n=0,t=r.length;n<t;n++)(e=u.exec(r[n]))&&(a[e[1]]=unescape(e[2]))}function e(n,t,e){if(n){if(e=e||{},n=[n+"="+s(t||"")],!(t=e.expires)&&0!==t||(X.isNumber(t)&&(t=new Date(t).toGMTString()),n.push("expires="+t)),(t=e.path)&&n.push("path="+t),(t=e.domain)&&n.push("domain="+t),n.push("Secure"),!0===e.httponly&&n.push("HttpOnly"),n.push("SameSite=None"),!((e=n.join(";")).length<4096))throw{name:"CookieTooLongError",message:"Cookie reached 4096 byte limit"};r.cookie=e,i(r.cookie)}}function o(n,t){e(n,"",w(t||{},{expires:1}))}var a={},u=/([^=]+)=?(.*)/,c=/; ?/;return i(r.cookie||""),{get:function(n){return a[n]},set:e,remove:o,findEach:function(n,t){for(var e in a)a.hasOwnProperty(e)&&e.match(n)&&t(e,a[e])},clear:function(n){for(var t in w({},a))o(t,n)}}}function d(n){var r=(n=l(n)).set,e=n.remove;return n.set=function(n,t,e){0===(e=w(e||{},{path:"/"})).expires&&(e.expires=+new Date("1/1/2038")),r(n,t,e)},n.remove=function(n,t){e(n,w(t||{},{path:"/"}))},n.purge=function(){},n}function g(i,o){function r(n){return 0!==(n=n.expires)&&n<=+new Date}function a(n){n=o.getItem(n);try{return n?JSON.parse(n):void 0}catch(n){}}function u(n){var t;return(n=a(n))&&n.hasOwnProperty("value")&&n.hasOwnProperty("expires")&&!r(n)?(t=n.value,delete n.value,[t,n]):[]}function e(n,t,e,r){for(var i,o=0,a=n.length;o<a;o++)!e[i=n.key(o)]&&(e[i]=i.match(t))&&r(i)}return{set:function(n,t,e){n&&null!=t&&(null!=(e=e||{}).expires?function(n,t,e){r(t={value:t,expires:e})||o.setItem(n,JSON.stringify(t))}:function(n,t){i.setItem(n,t)})(n,t,e.expires)},get:function(n){return i.getItem(n)||u(n)[0]},findEach:function(n,r){var t={};e(i,n,t,function(n){var t=i.getItem(n);null!=t&&r(n,t)}),e(o,n,t,function(n){var t=(e=u(n))[0],e=e[1];null!=t&&r(n,t,e)})},remove:function(n){i.removeItem(n),o.removeItem(n)},purge:function(){for(var n,t,e=o.length;e--;)(t=a(n=o.key(e)))&&t.hasOwnProperty("value")&&t.hasOwnProperty("expires")&&r(t)&&o.removeItem(n)}}}function E(o,e){var n={};return n.set=o.set,n.findEach=function(n,r){var i={};o.findEach(n,function(n,t,e){i[n]=!0,r(n,t,e)}),e.findEach(n,function(n,t,e){i[n]||(o.set(n,t,e),r(n,t,e))})},n.get=function(n){var t=o.get(n);return void 0===t&&(void 0!==(t=e.get(n))&&o.set(n,t)),t},n.remove=function(n){o.remove(n),e.remove(n)},n.purge=function(){o.purge(),e.purge()},n}function h(n){function t(n){var e={};return X.isString(n)?(y(n.split("&"),function(n){var t;""!==n&&(t=n.split("="),n=decodeURIComponent(t[0]),t=t[1]&&decodeURIComponent(t[1].replace(/\+/g," ")),(null==e[n]?e[n]=[]:e[n]).push(t))}),e):n}function e(n,t){var e=[];return y(n,function(n){return!X.isObject(n)&&void((X.isString(n=null==n||""===n?t:n)||X.isNumber(n)||X.isBoolean(n))&&e.push(n))}),e}function r(n){return X.isArray(n)?n:[n]}var i=this,o={};w(o,t(n)),i.param=function(n){return 1<(n=o[n]||[""]).length?n:n[0]},i.params=function(){return o},i.appendParam=function(n,t){return!n||0<(t=e(r(t))).length&&(o[n]=(null==o[n]?o[n]=[]:o[n]).concat(t)),this},i.replaceParam=function(n,t){return!n||0<(t=e(r(t))).length&&(o[n]=(o[n]=[]).concat(t)),this},i.appendParams=function(n){return y(n,i.appendParam),this},i.alwaysAppendParam=function(n,t){return!n||0<(t=e(r(t),"")).length&&(o[n]=(null==o[n]?o[n]=[]:o[n]).concat(t)),this},i.alwaysReplaceParam=function(n,t){return!n||0<(t=e(r(t),"")).length&&(o[n]=(o[n]=[]).concat(t)),this},i.alwaysAppendParams=function(n){return y(n,i.alwaysAppendParam),this},i.appendPartialQueryString=function(n){return n&&i.alwaysAppendParams(t(n)),this},i.deleteParam=function(n){delete o[n]},i.toString=function(){var e=[];return y(o,function(t,n){y(n,function(n){e.push((n=n,encodeURIComponent(t)+"="+encodeURIComponent(n)))})}),e.join("&")}}function x(n){function t(){var n=l.toString();return o+a+(0<n.length?"?"+n:"")}var e,r,i,o,a,u,c,s,f,l,p={},d=n.match(rn);return n=d[1]||"",r=d[2]||"",i=(d[3]||"").substring(1),o=n+((e=r+(i?":"+i:""))?"//"+e:""),u=(c=(a=d[4]||"").match(/^(.+?)?\/([^\/]+)?$/))&&c[1]||"",c=c&&c[2]||"",s=(d[5]||"").substring(1),f=(d[6]||"").substring(1),w(p,l=new h(s)),w(p,{origin:o,scheme:n,host:e,hostname:r,port:i,path:a,pathname:u,scriptname:c,queryString:l.toString,fragment:function(){return f},tooLong:function(){return 2082<t().length},asString:t}),p.toString=t,p}function v(r,i,e){function o(t){setTimeout(function(){try{(t.handleEvent||t).call(r,a?function(){var n=e.createEvent("Event");n.initEvent(i,!0,!1);try{n.currentTarget=n.target=r}catch(n){bt_log("warning: can not set target for ["+i+"] event: "+n)}return n}():((n=e.createEventObject("Event")).type=i,n.cancelable=!0,n.bubbleable=!1,n))}catch(n){bt_log("error: overriding ["+i+"] event: "+n)}var n},0)}var a=!!r.addEventListener,n=a?"addEventListener":"attachEvent",u=r[n];r[n]=function(t,n,e){if(n&&("function"==typeof n||"function"==typeof n.handleEvent))if(t==i||t=="on"+i)o(n);else try{a?u.call(r,t,n,e):u(t,n)}catch(n){bt_log("error: proxying ["+t+"] event: "+n)}}}function P(e,r,n){function t(n){n.hasOwnProperty("enabled")&&(f=n.enabled),n.hasOwnProperty("timestamp")&&(p=n.timestamp,f=!0),n.hasOwnProperty("site")&&(c=n.site),n.hasOwnProperty("referrer")&&(s=n.referrer)}function i(n){n&&t(n),l=[],e.remove(r)}function o(){try{return JSON.stringify({site:c,referrer:s,errors:l})}catch(n){bt_log("problem serializing errors: "+n.message)}return null}function a(n){var t=X.isObject(n)?w({},n):{};return t.type=t.type||"unknown",t.message=t.message||n.toString(),t.timestamp=p,t}function u(){i(),l.push(a({type:"runtime",message:"Too many errors"})),e.set(r,o())}if(!e)throw Error("ErrorManager requires a store");var c,s,f=!0,l=[],p=+new Date;return n&&t(n),{configure:t,reset:i,hasErrors:function(){return 0<l.length},tooManyErrors:u,processStoredErrors:function(){var n=e.get(r);if(n)try{var t=JSON.parse(n)||{};c=t.site,s=t.referrer,X.isArray(t.errors)&&(l=l.concat(t.errors))}catch(n){bt_log("problem reading stored errors: "+n.message)}},push:function(n){if(bt_log("error: "+JSON.stringify(n)),f&&n&&!(n.tagId<-1||n.pageId<-1))try{l.push(a(n)),e.set(r,o())}catch(n){if("CookieTooLongError"!=n.name)throw n;u()}},toJSON:o,toArray:function(){return l}}}function T(n,t){return new function(t,e){function r(n){u.wait(n)}var i,o={},a="",u=b.Blab.group(e);return o.getJQuery=function(){return i},o.ensureJQuery=function(n){o.ensureJQuery=r,((i=t.jQuery)?r:function(n){function t(){i=b.jQuery,r(n)}a="var $ = BrightTag.$; ",b.jQuery?t():u.script(b.instance.baseUri()+"BrightTag.jquery-1.5.1.js").wait(t)})(n),b.Blab.run(e)},o.functionWithAccess=function(n,t){return new Function(n,a+t)},o}(n,t)}function R(n){function t(n,t){t&&t.findEach(n,function(n,t){r.appendParam(n,t)})}function e(t,e){return function(n){bt_log("invalid "+t+" expression: "+e+", exception = "+n)}}var r=this,i=n.window,o=n.parentReferrer,a=n.referrer,u=x(0===n.host.length?"":(/^[a-z0-9+.-]+:\/\/.+/.test(n.host)?"":"//")+n.host+"/tag"),c=n.store?n.store.get("X-BT-InspectSession"):null;w(r,u),r.toString=u.toString,r.appendParams({site:n.site,referrer:a,docReferrer:n.docReferrer,mode:n.mode,H:p(a||n.document.location.href)}),c&&r.appendParam("inspect-session",c),a!==o&&r.appendParam("parentReferrer",o),n.gdpr_consent&&r.appendParams({gdpr_consent:n.gdpr_consent}),n.gdpr&&r.appendParams({gdpr:n.gdpr}),t(/^btps\..+/,new l(n.document)),t(/^btpdb\..+/,n.store),r.appendData=function(n){var t=bt_data(n),t=X.isArray(t)||X.isObject(t)?i.JSON.stringify(t):t;return r.alwaysReplaceParam("_cb_bt_data('"+n+"')",t)},r.appendJs=function(n){var t=e("client binding expression",n);return r.alwaysReplaceParam("_cb_"+n,K(n,t))},r.cf=function(n){X.isArray(n)||(n=[n]);var t=r.param("cf");return t&&(n=Array(t).concat(n)),r.replaceParam("cf",n.join()),r},r.addCf=function(n,t){if(!K(t,e("conditional fire",t)))return!1;t=r.param("cf");return r.replaceParam("cf",t?t+","+n:n),!0},r.length=function(){return r.toString().length},r.isTooLarge=function(){return 2028<r.length()};var s=r.toString();r.hasConditions=function(){return s!=r.toString()}}function N(n,t){function g(e,n){y(n,function(n,t){e[e.type+"."+n]=t}),t.push(e)}function o(n,t,e){var r=b.instance.serverURL();y(n,function(n){n.trigger(t,e,r)}),r.hasConditions()&&(r.appendParam("mode","v1"),b.Blab.script(r.asString()))}function a(f,n,l){function r(c,s){y(i,function(n){var t,e,r,i,o,a,u=n.name;try{(a=p[n.dbe])||(t=p,e=n.dbe,r=n.dbe,i=m("event-dbes/"+u+"-page-"+(d||"adhoc")+"-event-"+f),o=h.functionWithAccess(["eventObject","eventData"],"return "+r+";"+i),a=t[e]=o),l.data(u,a.call(c.target,c,s))}catch(n){g({type:"evdbe",message:n.toString(),pageId:d||-1},{name:u,eventName:f})}})}var e={},i=[],p={},d=(n||{}).pageId;return e.data=function(n,t){return i.push({name:n,dbe:t}),e},e.applyDataBindings=r,e.handler=function(n){var t,e=u[f];e&&0<e.length&&(r(n,t=Array.prototype.slice.call(arguments,1)),o(e,n,t))},e}function e(u){var c,s,r={},f={},l=[],p=[],d=[];return r.execute=function(n,t){if(w(f,t||{}),X.isFunction(n))s=n;else if(X.isString(n))n:{try{var e=m("events/"+u+"-tag-"+(f.tagId||"adhoc"));s=h.functionWithAccess(["eventObject","eventData"],n+e);break n}catch(n){g({type:"evparse",message:n.toString(),tagId:f.tagId||-1},{eventName:u})}s=void 0}else bt_log("when.execute: unknown action: "+n);return r},r.evaluate=function(n){return c=n,r},r.fire=function(n){return l.push(n),r},r.appendData=function(n){return p.push(n),r},r.appendJs=function(n){return d.push(n),r},r.trigger=function(n,t,e){var r,i,o,a=(r="post-event conditional fire",function(n){bt_log("Invalid "+r+" expression: "+i+", exception = "+n)});if(!(i=c)||K(c,a)){try{s&&s.call(n.target,n,t)}catch(n){g({type:"evwait",message:n.toString(),tagId:f.tagId||-1},{eventName:u})}o=e,0<l.length&&(o.cf(l),y(p,function(n){o.appendData(n)}),y(d,function(n){o.appendJs(n)}))}},r}var r={},u={},h=T(n,"BrightTag.jQuery"),c=/^direct\//i;return r.executeActions=o,r.Binder=a,r.bind=function(n,e,r,t){var i=a(n,t,b.instance);return h.ensureJQuery(function(){var n=h.getJQuery(),t=n(e);X.isString(e)&&!c.test(r)&&(t.on||t.live)?t.on?n(document).on(r,e,i.handler):t.live(r,i.handler):t.bind(r.split(c).pop(),i.handler)}),i},r.EventAction=e,r.when=function(n){var t=e(n);return(u[n]||(u[n]=[])).push(t),t},r}function A(o,n,a,u){var c=!1,s={};return s[u]=!0,{tag:function(n,t){var e,r,i=t&&t.group;e=n,n=t,t=i=c||i?i:u,(r=o.group(t).options(n||{})).wait(function(){a.process(r,e)}),i&&void 0===s[i]&&(s[i]=!0,c&&o.run(i))},run:function(){o.addGlobalListener(O(n,a)),c=!0,y(s,o.run)}}}function I(t,n){function e(n){y(X.isArray(n)?n:[n],function(n){X.isFunction(n)?n():f.write('<script type="text/javascript" src="'+n+'"><\/script>')})}function r(n){var t=p.group().options({tagId:-2});y(X.isArray(n)?n:[n],function(n){(X.isFunction(n)?t.wait:t.script)(n)})}function i(n){f.write(n)}function o(n,t){m.tag(n,t)}function a(n){c.writeScript=n?e:r,c.appendContent=n?i:o}function u(n){d.hasErrors()&&(n.appendParam("errors",d.toJSON()),n.tooLong()&&(n.deleteParam("errors"),d.tooManyErrors(),n.appendParam("errors",d.toJSON()))),d.reset({site:t.site,referrer:t.referrer||f.location.href})}var c=this,s=t.data||{},f=t.document||{},l=t.window||{},p=t.blab||b.Blab,d=t.errorManager,g=t.store,h=C(f),m=t.asyncTagManager||A(p,f,h,"domready"),v=T(window,"jquery");c.referrer=t.referrer,c.parentReferrer=t.parentReferrer,c.docReferrer=t.docReferrer,c.site=t.site,c.host=t.host,c.gdpr_consent=t.gdpr_consent,c.gdpr=t.gdpr,c.loadOnly=!!t.loadOnly,d&&p.addGlobalListener(new M(d)),p.run("serializer"),c.load=function(){y(Array.prototype.slice.call(arguments,0),function(n){X.isFunction(n)?p.addToGroup("serializer",p.newEngine().wait(function(){n(c)})):X.isObject(n)&&n.src?c.library(n.src,n.options):X.isString(n)&&c.library(n)})},c.library=function(n,t){p.addToGroup("serializer",p.newEngine().options(t||{}).script(n))},a(S(t.mode,"sync")),c.domReady=function(){S(t.mode,"sync")&&a(!1),m.run()},c.parameter=function(n){return window.bt_parameter(n,f)},c.meta=function(n){return window.bt_meta(n,f)},c.cookie=function(n){return window.bt_cookie(n,f)},c.data=function(n,t){return void 0!==t?s[n]=t:null==(t=s[n])?"":t},c.dbe=function(t,n,e){null==s[t]&&c.data(t,K(n,function(n){d&&d.push({type:"dbe",message:n.toString(),"dbe.name":t,pageId:(e||{}).pageId||-1})},"page-dbes/"+t+"-page-"+(e&&e.pageId||"adhoc")))},c.errors=function(n){b.V2_RESPONSE=!1,d.configure(n)},c.store=g?function(n){y(n,function(n){var t;n.name&&(delete(t=w({},n)).name,delete t.value,g.set(n.name,n.value,t))})}:function(){},c.serverURL=function(){return new R(t)},c.defaultBaseUri=function(){return("https:"==f.location.protocol?"https:":"http:")+"//s.btstatic.com/"},c.baseUri=function(){return n&&n.src&&n.src.replace(/\btag(\-\d+\.\d+\.\d+|\.[^.]+|-n)?\.js(#.*)?$/,"")||c.defaultBaseUri()},c.primary=function(){function n(){var n=c.serverURL();return d&&(d.processStoredErrors(),u(n)),n.toString()}var t=[];l.JSON?t.push(n()):(t.push(c.baseUri()+"json2.js"),t.push(function(){c.writeScript(n())})),c.writeScript(t)},c.secondary=function(n){var t=c.serverURL(),e=t.toString();n(t),t.toString()!=e&&(t.appendParam("mode","v1"),d&&u(t),t.isTooLarge()?c.post(t):c.writeScript(t.toString()))},c.post=function(n){v.ensureJQuery(function(){v.getJQuery().ajax({url:"//"+n.host+n.path,type:"POST",dataType:"text",success:bt_eval,data:n.queryString(),xhrFields:{withCredentials:!0}})})}}function B(){var r={},i={};return{on:function(n,t){(r[n]||(r[n]=[])).push(t)},once:function(n,t){(i[n]||(i[n]=[])).push(t)},emit:function(n){function t(n){n.apply(this,e)}var e=Array.prototype.slice.call(arguments,1);y(r[n],t),y(i[n],t),i[n]=[]}}}function n(o){function e(n){return u.push(n),a}function t(n){try{return new Function(r,n)}catch(n){n.type="evparse",a.emit("error",n)}}var a,u=[],c=function(){return!0},r=["eventObject","eventData","$","bt_data"];return a=w({fire:function(t){return e(function(n){n.fire(t)})},appendData:function(t){return e(function(n){n.appendData(t)})},appendJs:function(t){return e(function(n){n.appendJs(t)})},execute:function(n){var i=X.isString(n)?t(n):n;return i?e(function(n,t,e,r){try{i.call(t.target,t,e,r,o.data)}catch(n){n.type="evwait",a.emit("error",n)}}):a},evaluate:function(n){var i=t("return "+n);return c=i?function(n,t,e,r){return i.call(t.target,t,e,r,o.data)}:function(){return!1},a},trigger:function(t,e,r,i){c(t,e,r,i)&&y(u,function(n){n(t,e,r,i)})}},B())}function k(t){var u=/^direct\//i,e=!1;return{bind:function(n,t,e){function r(n){var t=Array.prototype.slice.call(arguments,1);e(n,t,b.jQuery||window.jQuery)}var i=b.jQuery||window.jQuery,o=i(n),a=!X.isString(n)||u.test(t);!a&&o.on?i(document).on(t,n,r):!a&&o.live?o.live(t,r):o.bind(t.split(u).pop(),r)},newBinder:function(n){return o=n,u={},e=["eventObject","eventData","$","bt_data"],a=w({dbe:function(t,n){try{u[t]=new Function(e,"return "+n+";")}catch(n){n.type="evdbe",a.emit("error",n,t)}return a},trigger:function(n,t,e){var r=n.target,i=[n,t,e,o.data];y(u,function(t,n){try{o.data(t,n.apply(r,i))}catch(n){n.type="evdbe",a.emit("error",n,t)}})}},B());var o,a,u,e},newHandler:n,ensureLibrary:function(n){b.jQuery||window.jQuery?n():(e||(e=!0,t.run()),t.wait(n))}}}function L(f,i){var l={},p=B();return w(p,{bind:function(c,n,t,e){function r(n,t,e){var r,i,o,a,u;s.trigger(n,t,e),r=l[c],i=n,o=t,a=e,u=H(f),y(r,function(n){n.trigger(u,i,o,a)}),p.emit("triggered",u)}var s=i.newBinder(f,c);return s.on("error",function(n,t){p.emit("error",n,{name:t,eventName:c},e)}),i.ensureLibrary(function(){try{i.bind(n,t,r)}catch(n){p.emit("error",n,{eventName:c},e)}}),s},handle:function(t,e){var n=i.newHandler(f);return n.on("error",function(n){p.emit("error",n,{eventName:t},e)}),l[t]=l[t]||[],l[t].push(n),n}})}function C(a){function u(n,t){n.src?t.preemptScript(n.src,n.innerHTML):n.innerHTML&&t.preemptWait(n.innerHTML)}var c=a.createElement("div");return{process:function(n,t){if(0!==t.length){c.innerHTML="<br/>"+t;for(var e=c.childNodes||[],r=1,i=e.length;r<i;r++){var o=e[r];if("SCRIPT"==o.tagName)u(o,n);else{try{a.body.appendChild(o.cloneNode(!0))}catch(n){bt_log("error appending content to body: "+n)}!function n(t,e){for(var r=t.childNodes||[],i=0,o=r.length;i<o;i++){var a=r[i];("SCRIPT"==a.tagName?u:n)(a,e)}b.eventsReady=!0}(o,n)}}b.eventsReady=!0}}}}function J(i,o){var a={},u={tag:function(t,n){var e,r;return r=function(n){n.wait(function(){o.process(n,t)})},n=(e=n)&&e.group,r(i.group(n).options(e||{})),n&&void 0===a[n]&&(a[n]=!0,i.run(n)),u},script:i.script,wait:i.wait};return u}function M(a){return{dbe:function(n,t,e){a.push({type:"dbe",message:n.toString(),"dbe.name":t,pageId:(e||{}).pageId||-1})},events:function(n,t,e){var r=n.type,i="evdbe"===r?"pageId":"tagId",o={type:r,message:n.toString()};y(t,function(n,t){o[r+"."+n]=t}),o[i]=(e||{})[i]||-1,a.push(o)},"block:error":function(n,t){var e;t&&(e=t.type,t=t.exception||t,n=n.option("tagId")||-1,a.push({type:e,message:t.toString(),tagId:n}))}}}function Q(i){return{isTagjs:function(){return/\/tag(\-\d+\.\d+\.\d+|\.[^.]+|-n)?\.js(\?.*)?(#.*)?$/.test(i.src)},toJSON:function(){return w((n=new x(i.src),e={},t=n.fragment(),r=c(n.host),e.staticHost=n.host+n.pathname,r&&(e.host=r),t&&y(new h(t).params(),function(n,t){e[n]=1<t.length?t:t[0]}),e),0===(t=a(i.innerHTML)).length?{}:K("(\n"+t+"\n)",function(n){bt_log("json configuration error: "+n)}));var n,e,t,r},script:i}}function D(){function n(){return t}var t;return t={fire:n,appendData:n,appendJs:n,execute:n,when:n}}function H(e){var r,t=[],i={};return r={toJSON:function(){return w(0<t.length?{cf:t.join()}:{},i)},fire:function(n){return n=u(n=!X.isArray(n)?[n]:n,function(n){return null!=n&&""!==n}),t=t.concat(n),r},appendData:function(n){var t=e.data(n);return i["_cb_bt_data('"+n+"')"]=X.isArray(t)||X.isObject(t)?JSON.stringify(t):t,r},appendJs:function(n){return i["_cb_"+n]=K(n),r},execute:function(n){return n(),r},when:function(t){try{return new Function(["bt_data"],"return "+b.trim(t))(e.data)?r:D()}catch(n){bt_log("conditional evaluation error: ["+n.toString()+"] while evaluating ["+t+"]")}return D()},hasConditions:function(){return 0<t.length||function(n,t){for(var e in n)if(t(e,n[e]))return!0;return!1}(i,function(n,t){return null!=t})}}}function U(i,r,o,a,u,n){function c(n){null!=n&&!n.hasConditions()||a.reset({site:l.site,referrer:l.referrer||window.location.href})}function s(n){var e=x("//"+p+"/tag").appendParams({site:l.site,mode:l.mode,H:l.H,referrer:l.referrer,docReferrer:l.docReferrer}).appendParam("mode","v2").alwaysAppendParams(n);n=un.get("X-BT-InspectSession");var t=l.gdpr_consent,r=l.gdpr;return n&&e.appendParam("inspect-session",n),u.findEach(RegExp("^btp(s|db)\\."+l.site+"\\..+"),function(n,t){e.appendParam(n,t)}),t&&e.appendParams({gdpr_consent:t}),r&&e.appendParams({gdpr:r}),e.appendParams({errors:a.hasErrors()?a.toJSON():null})}function e(n){var t,e=null==(t=n)?s():t.hasConditions()?s(t.toJSON()):void 0;e?(c(n),e.tooLong()?g.ensure("jQuery",function(){b.jQuery.ajax({url:e.origin+e.path,type:"POST",data:e.queryString(),xhrFields:{withCredentials:!0}})}):r.script(e.toString())):c(n)}var f,l=tn.extend({},n),p=l.host||"",t=B(),d=!1,g=new on(r,l);return o.on("triggered",e),f=tn.extend({config:l,diagnostic:function(n){n&&(l.diagnostic=n,f.emit("diagnostic",n))},errors:function(n){a.configure({timestamp:n})},dbe:function(n,t,e){var r=i.dbe(n,t,e);null!=r&&f.emit("dbe",n,t,r,e)},data:i.data,dataref:function(n){return null==n?"":'BrightTag.site("'+l.site+'").data("'+n.replace(/"/g,"\\x22")+'")'},store:function(n){tn.each(n,function(n){var t;n.name&&(delete(t=tn.extend({},n)).name,delete t.value,u.set(n.name,n.value,t))})},tag:function(n,t){return f.emit("tag",n,t),r.tag(n,t)},script:r.script,wait:r.wait,events:{bind:function(n,t,e,r){return f.emit("event-binding",n,t,e,r),o.bind(n,t,e,r)},on:o.handle},when:function(n,t){return H(i).when(n).execute(function(){t(f)}),f},domready:function(n){null==n?(d=!0,r.async(),l.mode=tn.filter(l.mode,function(n){return"sync"!==n})):t.once("domready",n),d&&t.emit("domready",f)},primary:function(){g.ensure("JSON",function(){a.processStoredErrors(),e()})},secondary:function(n){var t=H(i);n(t),e(t)}},B())}function F(n){var t,e,r,i,o,a,u,c,s,f,l,p,d,g,h;if((r=n.site)&&!an[r])return d=n.data,h=w({},d),t=g=w({dbe:function(t,n,e){if(!v(t)&&null!=(n=K(n,function(n){g.emit("error",n,t,e)})))return y(t,n)},data:y,hasData:v},B()),e=new j(document),i=C(document),o=e,a=n,u=document,p=c={tag:m,script:function(n){return m('<script type="text/javascript" src="'+n+'"><\/script>')},wait:function(n){return n(),c}},o=J(e,i),s=p,l=f=o,p={tag:function(n,t){return l.tag(n,t)},script:function(n){return l.script(n)},wait:function(n){return l.wait(n)},sync:function(){l=s},async:function(){l=f}},tn.contains(a.mode,"sync")&&p.sync(),d=p,a=L(t,(o=x((o=n).staticHost+"/BrightTag.jquery-1.5.1.js"),k(new _(document).script(o)))),o=M(p=P(z?E(z,un):un,"__bterr_"+r,{site:r,referrer:n.referrer,enabled:!1})),t.on("error",o.dbe),a.on("error",o.events),e.addGlobalListener(o),b.Events.onDOMReady(function(){e.addGlobalListener(O(document,i))}),an[r]=U(t,d,a,p,z?E(un,z):un,n);function m(n){return u.write(n),c}function v(n){return null!=h[n]}function y(n,t){void 0!==t&&(h[n]=t);n=h[n];return null==n?"":n}}function G(t,n,e){try{var r,i=t.toJSON();if(!b.instance||b.instance.site!==i.site){var o,a,u,c,s,f=i.referrer||n.location.href,l=F(w({host:"s.thebrighttag.com",staticHost:"s.btstatic.com",H:p(f),referrer:f.split("#")[0],docReferrer:n.document.referrer},i));return!i.site||b.instance||S(i.mode,"v2")||S(i.mode,"v2b")?l&&(o=l.config,u=S(a=l.config.mode,"v2")?a:a?["v2"].concat(a):"v2",o.mode=u):(c=t.script,s=$(),b.EventBinding=N(s.window,s.errorManager),b.instance=new I(w(s,i),c),r=b.instance,l.config.loadOnly=!0),e&&e(l,r),l}}catch(n){bt_log("error configuring site ["+t.script.src+"]: "+n)}}function $(){var n,t=d(document),e=t,r=t;try{window.localStorage&&window.sessionStorage&&((n=g(sessionStorage,localStorage)).purge(),e=E(t,n),r=E(n,t))}catch(n){bt_log("Unable to access DOM storage: "+n)}return{id:Math.random(),loadOnly:!1,window:window,document:document,host:"s.thebrighttag.com",parentReferrer:top!=self&&self.window?self.window.location.href:null,docReferrer:document.referrer,data:{},store:e,errorManager:P(r,"__bterr")}}if(b)return b;b={};var z,q,W,V,X={isString:function(n){return t(n,"String")},isArray:function(n){return t(n,"Array")},isNumber:function(n){return t(n,"Number")},isBoolean:function(n){return t(n,"Boolean")},isFunction:function(n){return t(n,"Function")},isObject:function(n){return null!=n&&t(n,"Object")}},K=bt_eval,Y=Array.prototype.forEach||function(n,t){for(var e=0,r=this.length;e<r;e++)n.call(t,this[e],e,this)},Z=Array.prototype.filter||function(e,r){var n=Array.isArray(this)?this.slice():Array.from(this),i=[];return Y.call(n,function(n,t){e.call(r,n,t,this)&&i.push(n)}),i},nn=Array.prototype.map||function(e,r){var n=Array.isArray(this)?this.slice():Array.from(this),i=Array(n.length);return Y.call(n,function(n,t){i[t]=e.call(r,n,t,this)}),i},tn={contains:S,each:y,extend:w,filter:u,map:function(n,t,e){if(n)return nn.call(i(n)?n:[n],t,e)},trim:a,getTagserveHostOverride:c},en=(V=[],function(t,e){var r;this["block:start"]=function(){V.push([W,t.write,t.writeln,t.open,t.close]),W=[],sn(t,"write",fn),sn(t,"writeln",fn),sn(t,"open",cn),sn(t,"close",cn)},this["block:finish"]=function(){try{e.process(r,W.join(""))}finally{var n=V.pop();W=n[0],sn(t,"write",n[1]),sn(t,"writeln",n[2]),sn(t,"open",n[3]),sn(t,"close",n[4])}},this["engine:listen"]=function(n){r=n}}),rn=/^(?:([^:\/]+:)?\/\/)?([^:\/?#]+)?(:[0-9]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,on=(q={JSON:{object:"JSON",path:"/json2.js"},jQuery:{object:"BrightTag.jQuery",path:"/BrightTag.jquery-1.5.1.js"}},e.prototype={ensure:function(n,t){n=q[n];if(n){for(var e,r=n.object.split("."),i=window,o=r.length-1,a=0;a<o;a++){if(!(i=i[e=r[a]]))throw"DependencyManager: Could not find key "+e;i=i[r[a]]}i?t():this.tagMgrRouter.script(x(this.config.staticHost+n.path)).wait(t)}}},e),an={},un=d(document);function e(n,t){this.tagMgrRouter=n,this.config=t}function cn(){}function sn(n,t,e){try{n[t]=e}catch(n){bt_log("warning: could not assign value to 'document."+t+"': "+n)}}function fn(n){W.push(n)}try{window.localStorage&&window.sessionStorage&&(z=g(sessionStorage,localStorage)).purge()}catch(n){bt_log("Unable to access DOM storage: "+n)}return b.Escaper={cookie:s,javascript:function(n){return X.isString(n)?n.replace(/\\/g,"\\\\").replace(/'/g,"\\x27").replace(/"/g,"\\x22").replace(/\n/g,"\\n").replace(/\r/g,"\\r"):n}},b.Random={integer:function(n){return Math.floor(Math.random()*(n||1e8))}},b.pushIfDefined=function(n,t,e){n&&n.constructor==Array&&null!=t&&n.push(e||t)},b.ServerURL=R,b.Main=function(i){var n,t,e,r,o=function(){for(var n,t=/\/tag(\-\d+\.\d+\.\d+|\.[^.]+|-n)?\.js(#.*)?$/,e=i.document.getElementsByTagName("script"),r=e.length-1;-1<r;r--)if(n=e[r],t.test(n.src))return n}();if(o&&(t=new x(o.src),i.host=i.host||c(t.host),(r=(r=t).fragment())&&y(new h(r).params(),function(n,t){i[n]=t[0]}),0!==(e=a(e=o.innerHTML)).length&&w(i,K("(\n"+e+"\n)",function(n){bt_log("configuration error: "+n)},"site-config"))),null!=i.site){b.Events.enablePageReadyOverrides();try{n=new I(i,o),b.Events.onDOMReady(n.domReady),n.loadOnly||n.primary()}catch(n){bt_log("execution error: "+n)}return n}},b.CookieSync={pushImage:function(n){throw"CookieSync.pushImage no longer supported ["+((new Image).src=n)+"]"},pushIframe:function(n){throw"CookieSync.pushIframe no longer supported ["+n+"]"}},b.EventBindingManager=N,b.defaultConfig=$,b.eval=K,b.Types=X,b.trim=tn.trim,b.Util=tn,b.each=tn.each,b.extend=tn.extend,b.eventsReady=!1,b.HTTP={Cookie:l,QueryString:h,URL:x},b.Blab=new j(document),b.Events=new function(t,e){function n(){}function r(n,t,e){n[p](g+t,e,!1)}function i(n,t,e){n[d](g+t,e,!1)}function o(){var t=e.readyState;if("loading"==t)return!1;if("complete"==t)return!0;n:{try{h("left")}catch(n){t=!1;break n}t=!0}return t}function a(){a=n,s&&v(e,f,e)}function u(){a(),v(t,l,e)}var c=this,s=!!t.addEventListener,f="DOMContentLoaded",l="load",p=s?"addEventListener":"attachEvent",d=s?"removeEventListener":"detachEvent",g=s?"":"on",h=e.documentElement.doScroll||function(){throw"No doScroll"};c.listen=r,c.unlisten=i,c.onDOMReady=function(n){o()?n.call(this):e.addEventListener?(r(e,f,n),r(e,f,function(){i(t,l,n)}),r(t,l,n)):function n(t,e,r){var i=this;setTimeout(function(){t()?e.call(i):n(t,e,r)},r)}(o,n,1)},c.enablePageReadyOverrides=function(){c.enablePageReadyOverrides=n,o()?u():(s&&r(e,f,a),r(t,l,u))}}(window,document),b.Events.enablePageReadyOverrides(),b.Content=new function(n){return{iframe:(n=(n=b.Blab)||b.Blab).iframe,image:n.image,link:n.link,script:n.script}}(0),b.V2_RESPONSE=!0,b.site=function(t,n){try{var e=an[t];return e&&n&&n(e),e}catch(n){bt_log("error while executing site configuration ["+t+"]: "+n)}},b.configureNewSites=function(t,e){y(function(n){var t,e,r=[];if(X.isArray(n))r=n.slice(0);else for(t=0,e=n.length;t<e;t++)r.push(n[t]);return r}(t.document.getElementsByTagName("script")),function(n){(n=Q(n)).isTagjs()&&G(n,t,e)})},b.configureSite=function(n,t,e){return G((r=n,{isTagjs:function(){return!0},toJSON:function(){return r||{}},script:{src:void 0}}),t,e);var r},b.configuredSites=function(){var e=[];return tn.each(an,function(n,t){e.push(t)}),e},b.initializeSite=function(n,t){var e;t&&(b.Events.onDOMReady(t.domReady),t.loadOnly||t.primary()),n&&(S((e=n).config.mode,"v2")||S(e.config.mode,"v2b")?e.config.loadOnly||(b.Events.onDOMReady(function(n){e.domready()}),e.primary()):b.Events.onDOMReady(function(n){e.domready()}))},b.signalReady=function(){return b.eventsReady||!1},b}(window.BrightTag),function(n){n.configureNewSites(window,n.initializeSite),null==n.instance&&setTimeout(function(){null==n.instance&&n.configureNewSites(window,n.initializeSite)},0)}(BrightTag);
