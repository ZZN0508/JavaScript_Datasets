!function(e){e._securedTouchDependencies||(e._securedTouchDependencies={})}(window),function(){"use strict";function o(){}function e(e,t,n){this.options=n=n||{},this.pendingPromises=0,this.maxPendingPromises=void 0!==e?e:1/0,this.maxQueuedPromises=void 0!==t?t:1/0,this.queue=[]}window._securedTouchDependencies.StPromiseQueue=(e.prototype.add=function(i){var r=this;return new Promise(function(e,t,n){r.queue.length>=r.maxQueuedPromises?t(new Error("Queue limit reached")):(r.queue.push({promiseGenerator:i,resolve:e,reject:t,notify:n||o}),r._dequeue())})},e.prototype.getPendingLength=function(){return this.pendingPromises},e.prototype.getQueueLength=function(){return this.queue.length},e.prototype._dequeue=function(){var t=this;if(this.pendingPromises>=this.maxPendingPromises)return!1;var n,i=this.queue.shift();if(!i)return this.options.onEmpty&&this.options.onEmpty(),!1;try{this.pendingPromises++,((n=i.promiseGenerator())&&"function"==typeof n.then?n:new Promise(function(e){e(n)})).then(function(e){t.pendingPromises--,i.resolve(e),t._dequeue()},function(e){t.pendingPromises--,i.reject(e),t._dequeue()},function(e){i.notify(e)})}catch(n){t.pendingPromises--,i.reject(n),t._dequeue()}return!0},e)}(),function(root){"use strict";var ERROR="input is invalid type",NODE_JS=!1,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(t,n){return function(e){return new Sha256(n,!0).update(e)[t]()}},createMethod=function(e){var t=createOutputMethod("hex",e);(t=NODE_JS?nodeWrap(t,e):t).create=function(){return new Sha256(e)},t.update=function(e){return t.create().update(e)};for(var n=0;n<OUTPUT_TYPES.length;++n){var i=OUTPUT_TYPES[n];t[i]=createOutputMethod(i,e)}return t},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(e){if("string"==typeof e)return crypto.createHash(algorithm).update(e,"utf8").digest("hex");if(null==e)throw new Error(ERROR);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod},createHmacOutputMethod=function(n,i){return function(e,t){return new HmacSha256(e,i,!0).update(t)[n]()}},createHmacMethod=function(t){var n=createHmacOutputMethod("hex",t);n.create=function(e){return new HmacSha256(e,t)},n.update=function(e,t){return n.create(e).update(t)};for(var e=0;e<OUTPUT_TYPES.length;++e){var i=OUTPUT_TYPES[e];n[i]=createHmacOutputMethod(i,t)}return n};function Sha256(e,t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function HmacSha256(e,t,n){var i=typeof e;if("string"==i){for(var r,o=[],a=e.length,s=0,c=0;c<a;++c)(r=e.charCodeAt(c))<128?o[s++]=r:(r<2048?o[s++]=192|r>>6:(r<55296||57344<=r?o[s++]=224|r>>12:(r=65536+((1023&r)<<10|1023&e.charCodeAt(++c)),o[s++]=240|r>>18,o[s++]=128|r>>12&63),o[s++]=128|r>>6&63),o[s++]=128|63&r);e=o}else{if("object"!=i)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR)}64<e.length&&(e=new Sha256(t,!0).update(e).array());var u=[],d=[];for(c=0;c<64;++c){var h=e[c]||0;u[c]=92^h,d[c]=54^h}Sha256.call(this,t,n),this.update(d),this.oKeyPad=u,this.inner=!0,this.sharedMemory=n}Sha256.prototype.update=function(e){if(!this.finalized){var t,n=typeof e;if("string"!=n){if("object"!=n)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR);t=!0}for(var i,r,o=0,a=e.length,s=this.blocks;o<a;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),t)for(r=this.start;o<a&&r<64;++o)s[r>>2]|=e[o]<<SHIFT[3&r++];else for(r=this.start;o<a&&r<64;++o)(i=e.charCodeAt(o))<128?s[r>>2]|=i<<SHIFT[3&r++]:(i<2048?s[r>>2]|=(192|i>>6)<<SHIFT[3&r++]:(i<55296||57344<=i?s[r>>2]|=(224|i>>12)<<SHIFT[3&r++]:(i=65536+((1023&i)<<10|1023&e.charCodeAt(++o)),s[r>>2]|=(240|i>>18)<<SHIFT[3&r++],s[r>>2]|=(128|i>>12&63)<<SHIFT[3&r++]),s[r>>2]|=(128|i>>6&63)<<SHIFT[3&r++]),s[r>>2]|=(128|63&i)<<SHIFT[3&r++]);this.lastByteIndex=r,this.bytes+=r-this.start,64<=r?(this.block=s[16],this.start=r-64,this.hash(),this.hashed=!0):this.start=r}return 4294967295<this.bytes&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){var e,t;this.finalized||(this.finalized=!0,e=this.blocks,t=this.lastByteIndex,e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],56<=t&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash())},Sha256.prototype.hash=function(){for(var e,t,n,i,r,o,a,s,c=this.h0,u=this.h1,d=this.h2,h=this.h3,l=this.h4,p=this.h5,f=this.h6,g=this.h7,m=this.blocks,_=16;_<64;++_)e=((i=m[_-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t=((i=m[_-2])>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,m[_]=m[_-16]+e+m[_-7]+t<<0;for(s=u&d,_=0;_<64;_+=4)this.first?(h=this.is224?(r=300032,g=(i=m[0]-1413257819)-150054599<<0,i+24177077<<0):(r=704751109,g=(i=m[0]-210244248)-1521486534<<0,i+143694565<<0),this.first=!1):(n=(r=c&u)^c&d^s,g=h+(i=g+(t=(l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&p^~l&f)+K[_]+m[_])<<0,h=i+((e=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10))+n)<<0),n=(o=h&c)^h&u^r,f=d+(i=f+(t=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&l^~g&p)+K[_+1]+m[_+1])<<0,e=((d=i+((e=(h>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10))+n)<<0)>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),n=(a=d&h)^d&c^o,p=u+(i=p+(t=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&g^~f&l)+K[_+2]+m[_+2])<<0,e=((u=i+(e+n)<<0)>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),n=(s=u&d)^u&h^a,l=c+(i=l+(t=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&f^~p&g)+K[_+3]+m[_+3])<<0,c=i+(e+n)<<0;this.h0=this.h0+c<<0,this.h1=this.h1+u<<0,this.h2=this.h2+d<<0,this.h3=this.h3+h<<0,this.h4=this.h4+l<<0,this.h5=this.h5+p<<0,this.h6=this.h6+f<<0,this.h7=this.h7+g<<0},Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,i=this.h3,r=this.h4,o=this.h5,a=this.h6,s=this.h7,a=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a];return this.is224||(a+=HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s]),a},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,i=this.h3,r=this.h4,o=this.h5,a=this.h6,s=this.h7,a=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,i>>24&255,i>>16&255,i>>8&255,255&i,r>>24&255,r>>16&255,r>>8&255,255&r,o>>24&255,o>>16&255,o>>8&255,255&o,a>>24&255,a>>16&255,a>>8&255,255&a];return this.is224||a.push(s>>24&255,s>>16&255,s>>8&255,255&s),a},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){var e;Sha256.prototype.finalize.call(this),this.inner&&(this.inner=!1,e=this.array(),Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),Sha256.prototype.finalize.call(this))};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),root.sha256=exports.sha256,root.sha224=exports.sha224}(window._securedTouchDependencies),function(){"use strict";function h(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]+t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]+t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]+t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]+t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function l(e,t){return 32==(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:[e[1]<<(t-=32)|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t]}function p(e,t){return 0==(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function f(e){return e=m(e,[0,e[0]>>>1]),e=g(e,[4283543511,3981806797]),e=m(e,[0,e[0]>>>1]),e=g(e,[3301882366,444984403]),m(e,[0,e[0]>>>1])}function s(e,t){for(var n=(e=e||"").length%16,i=e.length-n,r=[0,t=t||0],o=[0,t],a=[0,0],s=[0,0],c=[2277735313,289559509],u=[1291169091,658871167],d=0;d<i;d+=16)a=[255&e.charCodeAt(d+4)|(255&e.charCodeAt(d+5))<<8|(255&e.charCodeAt(d+6))<<16|(255&e.charCodeAt(d+7))<<24,255&e.charCodeAt(d)|(255&e.charCodeAt(d+1))<<8|(255&e.charCodeAt(d+2))<<16|(255&e.charCodeAt(d+3))<<24],s=[255&e.charCodeAt(d+12)|(255&e.charCodeAt(d+13))<<8|(255&e.charCodeAt(d+14))<<16|(255&e.charCodeAt(d+15))<<24,255&e.charCodeAt(d+8)|(255&e.charCodeAt(d+9))<<8|(255&e.charCodeAt(d+10))<<16|(255&e.charCodeAt(d+11))<<24],a=g(a,c),a=l(a,31),a=g(a,u),r=m(r,a),r=l(r,27),r=h(r,o),r=h(g(r,[0,5]),[0,1390208809]),s=g(s,u),s=l(s,33),s=g(s,c),o=m(o,s),o=l(o,31),o=h(o,r),o=h(g(o,[0,5]),[0,944331445]);switch(a=[0,0],s=[0,0],n){case 15:s=m(s,p([0,e.charCodeAt(d+14)],48));case 14:s=m(s,p([0,e.charCodeAt(d+13)],40));case 13:s=m(s,p([0,e.charCodeAt(d+12)],32));case 12:s=m(s,p([0,e.charCodeAt(d+11)],24));case 11:s=m(s,p([0,e.charCodeAt(d+10)],16));case 10:s=m(s,p([0,e.charCodeAt(d+9)],8));case 9:s=m(s,[0,e.charCodeAt(d+8)]),s=g(s,u),s=l(s,33),s=g(s,c),o=m(o,s);case 8:a=m(a,p([0,e.charCodeAt(d+7)],56));case 7:a=m(a,p([0,e.charCodeAt(d+6)],48));case 6:a=m(a,p([0,e.charCodeAt(d+5)],40));case 5:a=m(a,p([0,e.charCodeAt(d+4)],32));case 4:a=m(a,p([0,e.charCodeAt(d+3)],24));case 3:a=m(a,p([0,e.charCodeAt(d+2)],16));case 2:a=m(a,p([0,e.charCodeAt(d+1)],8));case 1:a=m(a,[0,e.charCodeAt(d)]),a=g(a,c),a=l(a,31),a=g(a,u),r=m(r,a)}return r=m(r,[0,e.length]),o=m(o,[0,e.length]),r=h(r,o),o=h(o,r),r=f(r),o=f(o),r=h(r,o),o=h(o,r),("00000000"+(r[0]>>>0).toString(16)).slice(-8)+("00000000"+(r[1]>>>0).toString(16)).slice(-8)+("00000000"+(o[0]>>>0).toString(16)).slice(-8)+("00000000"+(o[1]>>>0).toString(16)).slice(-8)}function r(e){if(null==navigator.plugins)return e.NOT_AVAILABLE;for(var t=[],n=0,i=navigator.plugins.length;n<i;n++)navigator.plugins[n]&&t.push(navigator.plugins[n]);return a(e)&&(t=t.sort(function(e,t){return e.name>t.name?1:e.name<t.name?-1:0})),_(t,function(e){var t=_(e,function(e){return[e.type,e.suffixes]});return[e.name,e.description,t]})}function n(){function e(e){return o.clearColor(0,0,0,1),o.enable(o.DEPTH_TEST),o.depthFunc(o.LEQUAL),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),"["+e[0]+", "+e[1]+"]"}var o;if(!(o=c()))return null;var a=[],t=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,t);var n=new Float32Array([-.2,-.9,0,.4,-.26,0,0,.732134444,0]);o.bufferData(o.ARRAY_BUFFER,n,o.STATIC_DRAW),t.itemSize=3,t.numItems=3;var i=o.createProgram(),r=o.createShader(o.VERTEX_SHADER);o.shaderSource(r,"attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}"),o.compileShader(r),n=o.createShader(o.FRAGMENT_SHADER),o.shaderSource(n,"precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}"),o.compileShader(n),o.attachShader(i,r),o.attachShader(i,n),o.linkProgram(i),o.useProgram(i),i.vertexPosAttrib=o.getAttribLocation(i,"attrVertex"),i.offsetUniform=o.getUniformLocation(i,"uniformOffset"),o.enableVertexAttribArray(i.vertexPosArray),o.vertexAttribPointer(i.vertexPosAttrib,t.itemSize,o.FLOAT,!1,0,0),o.uniform2f(i.offsetUniform,1,1),o.drawArrays(o.TRIANGLE_STRIP,0,t.numItems);try{a.push(o.canvas.toDataURL())}catch(o){}a.push("extensions:"+(o.getSupportedExtensions()||[]).join(";")),a.push("webgl aliased line width range:"+e(o.getParameter(o.ALIASED_LINE_WIDTH_RANGE))),a.push("webgl aliased point size range:"+e(o.getParameter(o.ALIASED_POINT_SIZE_RANGE))),a.push("webgl alpha bits:"+o.getParameter(o.ALPHA_BITS)),a.push("webgl antialiasing:"+(o.getContextAttributes().antialias?"yes":"no")),a.push("webgl blue bits:"+o.getParameter(o.BLUE_BITS)),a.push("webgl depth bits:"+o.getParameter(o.DEPTH_BITS)),a.push("webgl green bits:"+o.getParameter(o.GREEN_BITS)),a.push("webgl max anisotropy:"+function(e){var t=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic");if(t){t=e.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT);return t=0===t?2:t}return null}(o)),a.push("webgl max combined texture image units:"+o.getParameter(o.MAX_COMBINED_TEXTURE_IMAGE_UNITS)),a.push("webgl max cube map texture size:"+o.getParameter(o.MAX_CUBE_MAP_TEXTURE_SIZE)),a.push("webgl max fragment uniform vectors:"+o.getParameter(o.MAX_FRAGMENT_UNIFORM_VECTORS)),a.push("webgl max render buffer size:"+o.getParameter(o.MAX_RENDERBUFFER_SIZE)),a.push("webgl max texture image units:"+o.getParameter(o.MAX_TEXTURE_IMAGE_UNITS)),a.push("webgl max texture size:"+o.getParameter(o.MAX_TEXTURE_SIZE)),a.push("webgl max varying vectors:"+o.getParameter(o.MAX_VARYING_VECTORS)),a.push("webgl max vertex attribs:"+o.getParameter(o.MAX_VERTEX_ATTRIBS)),a.push("webgl max vertex texture image units:"+o.getParameter(o.MAX_VERTEX_TEXTURE_IMAGE_UNITS)),a.push("webgl max vertex uniform vectors:"+o.getParameter(o.MAX_VERTEX_UNIFORM_VECTORS)),a.push("webgl max viewport dims:"+e(o.getParameter(o.MAX_VIEWPORT_DIMS))),a.push("webgl red bits:"+o.getParameter(o.RED_BITS)),a.push("webgl renderer:"+o.getParameter(o.RENDERER)),a.push("webgl shading language version:"+o.getParameter(o.SHADING_LANGUAGE_VERSION)),a.push("webgl stencil bits:"+o.getParameter(o.STENCIL_BITS)),a.push("webgl vendor:"+o.getParameter(o.VENDOR)),a.push("webgl version:"+o.getParameter(o.VERSION));try{var s=o.getExtension("WEBGL_debug_renderer_info");s&&(a.push("webgl unmasked vendor:"+o.getParameter(s.UNMASKED_VENDOR_WEBGL)),a.push("webgl unmasked renderer:"+o.getParameter(s.UNMASKED_RENDERER_WEBGL)))}catch(o){}return o.getShaderPrecisionFormat&&d(["FLOAT","INT"],function(r){d(["VERTEX","FRAGMENT"],function(i){d(["HIGH","MEDIUM","LOW"],function(n){d(["precision","rangeMin","rangeMax"],function(e){var t=o.getShaderPrecisionFormat(o[i+"_SHADER"],o[n+"_"+r])[e];"precision"!==e&&(e="precision "+e);t=["webgl ",i.toLowerCase()," shader ",n.toLowerCase()," ",r.toLowerCase()," ",e,":",t].join("");a.push(t)})})})}),a}function i(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}function o(){if(i()){var e=c();return!!window.WebGLRenderingContext&&!!e}}function c(){var e=document.createElement("canvas"),t=null;try{t=e.getContext("webgl")||e.getContext("experimental-webgl")}catch(e){}return t=t||null}function u(e){throw new Error("'new Fingerprint()' is deprecated, see https://github.com/Valve/fingerprintjs2#upgrade-guide-from-182-to-200")}var g,m,e,d,_,a,t;window._securedTouchDependencies.Fingerprint2=(e={preprocessor:null,audio:{timeout:1e3,excludeIOS11:!0},fonts:{swfContainerId:"fingerprintjs2",swfPath:"flash/compiled/FontList.swf",userDefinedFonts:[],extendedJsFonts:!(m=function(e,t){return[e[0]^t[0],e[1]^t[1]]})},screen:{detectScreenOrientation:!0},plugins:{sortPluginsFor:[/palemoon/i],excludeIE:!(g=function(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]*t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]*t[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=e[3]*t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]*t[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[2]*t[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[3]*t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]})},extraComponents:[],excludes:{enumerateDevices:!0,pixelRatio:!0,doNotTrack:!0,fontsFlash:!0},NOT_AVAILABLE:"not available",ERROR:"error",EXCLUDED:"excluded"},d=function(e,t){if(Array.prototype.forEach&&e.forEach===Array.prototype.forEach)e.forEach(t);else if(e.length===+e.length)for(var n=0,i=e.length;n<i;n++)t(e[n],n,e);else for(var r in e)e.hasOwnProperty(r)&&t(e[r],r,e)},_=function(e,i){var r=[];return null==e?r:Array.prototype.map&&e.map===Array.prototype.map?e.map(i):(d(e,function(e,t,n){r.push(i(e,t,n))}),r)},a=function(e){for(var t=!1,n=0,i=e.plugins.sortPluginsFor.length;n<i;n++){var r=e.plugins.sortPluginsFor[n];if(navigator.userAgent.match(r)){t=!0;break}}return t},t=[{key:"userAgent",getData:function(e){e(navigator.userAgent)}},{key:"webdriver",getData:function(e,t){e(null==navigator.webdriver?t.NOT_AVAILABLE:navigator.webdriver)}},{key:"language",getData:function(e,t){e(navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||t.NOT_AVAILABLE)}},{key:"colorDepth",getData:function(e,t){e(window.screen.colorDepth||t.NOT_AVAILABLE)}},{key:"deviceMemory",getData:function(e,t){e(navigator.deviceMemory||t.NOT_AVAILABLE)}},{key:"pixelRatio",getData:function(e,t){e(window.devicePixelRatio||t.NOT_AVAILABLE)}},{key:"hardwareConcurrency",getData:function(e,t){e((t=t,navigator.hardwareConcurrency||t.NOT_AVAILABLE))}},{key:"screenResolution",getData:function(e,t){e((e=[window.screen.width,window.screen.height],t.screen.detectScreenOrientation&&e.sort().reverse(),e))}},{key:"availableScreenResolution",getData:function(e,t){e(function(e){if(window.screen.availWidth&&window.screen.availHeight){var t=[window.screen.availHeight,window.screen.availWidth];return e.screen.detectScreenOrientation&&t.sort().reverse(),t}return e.NOT_AVAILABLE}(t))}},{key:"timezoneOffset",getData:function(e){e((new Date).getTimezoneOffset())}},{key:"timezone",getData:function(e,t){window.Intl&&window.Intl.DateTimeFormat?e((new window.Intl.DateTimeFormat).resolvedOptions().timeZone):e(t.NOT_AVAILABLE)}},{key:"sessionStorage",getData:function(e,t){e(function(t){try{return!!window.sessionStorage}catch(e){return t.ERROR}}(t))}},{key:"localStorage",getData:function(e,t){e(function(t){try{return!!window.localStorage}catch(e){return t.ERROR}}(t))}},{key:"indexedDb",getData:function(e,t){e(function(t){try{return!!window.indexedDB}catch(e){return t.ERROR}}(t))}},{key:"addBehavior",getData:function(e){e(!(!document.body||!document.body.addBehavior))}},{key:"openDatabase",getData:function(e){e(!!window.openDatabase)}},{key:"cpuClass",getData:function(e,t){e((t=t,navigator.cpuClass||t.NOT_AVAILABLE))}},{key:"platform",getData:function(e,t){e((t=t,navigator.platform||t.NOT_AVAILABLE))}},{key:"doNotTrack",getData:function(e,t){e((t=t,navigator.doNotTrack||navigator.msDoNotTrack||window.doNotTrack||t.NOT_AVAILABLE))}},{key:"plugins",getData:function(e,t){var n,i;"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&/Trident/.test(navigator.userAgent)?t.plugins.excludeIE?e(t.EXCLUDED):e((n=t,i=[],Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window?i=_(["AcroPDF.PDF","Adodb.Stream","AgControl.AgControl","DevalVRXCtrl.DevalVRXCtrl.1","MacromediaFlashPaper.MacromediaFlashPaper","Msxml2.DOMDocument","Msxml2.XMLHTTP","PDF.PdfCtrl","QuickTime.QuickTime","QuickTimeCheckObject.QuickTimeCheck.1","RealPlayer","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","Scripting.Dictionary","SWCtl.SWCtl","Shell.UIHelper","ShockwaveFlash.ShockwaveFlash","Skype.Detection","TDCCtl.TDCCtl","WMPlayer.OCX","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1"],function(e){try{return new window.ActiveXObject(e),e}catch(e){return n.ERROR}}):i.push(n.NOT_AVAILABLE),i=navigator.plugins?i.concat(r(n)):i)):e(r(t))}},{key:"canvas",getData:function(e,t){i()?e(function(e){var t=[],n=document.createElement("canvas");n.width=2e3,n.height=200,n.style.display="inline";var i=n.getContext("2d");return i.rect(0,0,10,10),i.rect(2,2,6,6),t.push("canvas winding:"+(!1===i.isPointInPath(5,5,"evenodd")?"yes":"no")),i.textBaseline="alphabetic",i.fillStyle="#f60",i.fillRect(125,1,62,20),i.fillStyle="#069",e.dontUseFakeFontInCanvas?i.font="11pt Arial":i.font="11pt no-real-font-123",i.fillText("Cwm fjordbank glyphs vext quiz, ðŸ˜ƒ",2,15),i.fillStyle="rgba(102, 204, 0, 0.2)",i.font="18pt Arial",i.fillText("Cwm fjordbank glyphs vext quiz, ðŸ˜ƒ",4,45),i.globalCompositeOperation="multiply",i.fillStyle="rgb(255,0,255)",i.beginPath(),i.arc(50,50,50,0,2*Math.PI,!0),i.closePath(),i.fill(),i.fillStyle="rgb(0,255,255)",i.beginPath(),i.arc(100,50,50,0,2*Math.PI,!0),i.closePath(),i.fill(),i.fillStyle="rgb(255,255,0)",i.beginPath(),i.arc(75,100,50,0,2*Math.PI,!0),i.closePath(),i.fill(),i.fillStyle="rgb(255,0,255)",i.arc(75,75,75,0,2*Math.PI,!0),i.arc(75,75,25,0,2*Math.PI,!0),i.fill("evenodd"),n.toDataURL&&t.push("canvas fp:"+n.toDataURL()),t}(t)):e(t.NOT_AVAILABLE)}},{key:"webgl",getData:function(e,t){o()?e(n()):e(t.NOT_AVAILABLE)}},{key:"webglVendorAndRenderer",getData:function(e){o()?e(function(){try{var e=c(),t=e.getExtension("WEBGL_debug_renderer_info");return e.getParameter(t.UNMASKED_VENDOR_WEBGL)+"~"+e.getParameter(t.UNMASKED_RENDERER_WEBGL)}catch(e){return null}}()):e()}},{key:"adBlock",getData:function(e){e(function(){var e=document.createElement("div");e.innerHTML="&nbsp;";var t=!(e.className="adsbox");try{document.body.appendChild(e),t=0===document.getElementsByClassName("adsbox")[0].offsetHeight,document.body.removeChild(e)}catch(e){t=!1}return t}())}},{key:"hasLiedLanguages",getData:function(e){e(function(){if(void 0!==navigator.languages)try{if(navigator.languages[0].substr(0,2)!==navigator.language.substr(0,2))return!0}catch(e){return!0}return!1}())}},{key:"hasLiedResolution",getData:function(e){e(window.screen.width<window.screen.availWidth||window.screen.height<window.screen.availHeight)}},{key:"hasLiedOs",getData:function(e){e(function(){var e=navigator.userAgent.toLowerCase(),t=navigator.oscpu,n=navigator.platform.toLowerCase(),e=0<=e.indexOf("windows phone")?"Windows Phone":0<=e.indexOf("win")?"Windows":0<=e.indexOf("android")?"Android":0<=e.indexOf("linux")||0<=e.indexOf("cros")?"Linux":0<=e.indexOf("iphone")||0<=e.indexOf("ipad")?"iOS":0<=e.indexOf("mac")?"Mac":"Other";if(("ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints)&&"Windows Phone"!=e&&"Android"!=e&&"iOS"!=e&&"Other"!=e)return!0;if(void 0!==t){if(0<=(t=t.toLowerCase()).indexOf("win")&&"Windows"!=e&&"Windows Phone"!=e)return!0;if(0<=t.indexOf("linux")&&"Linux"!=e&&"Android"!=e)return!0;if(0<=t.indexOf("mac")&&"Mac"!=e&&"iOS"!=e)return!0;if((-1===t.indexOf("win")&&-1===t.indexOf("linux")&&-1===t.indexOf("mac"))!=("Other"==e))return!0}return 0<=n.indexOf("win")&&"Windows"!=e&&"Windows Phone"!=e||((0<=n.indexOf("linux")||0<=n.indexOf("android")||0<=n.indexOf("pike"))&&"Linux"!=e&&"Android"!=e||((0<=n.indexOf("mac")||0<=n.indexOf("ipad")||0<=n.indexOf("ipod")||0<=n.indexOf("iphone"))&&"Mac"!=e&&"iOS"!=e||((n.indexOf("win")<0&&n.indexOf("linux")<0&&n.indexOf("mac")<0&&n.indexOf("iphone")<0&&n.indexOf("ipad")<0)!=("Other"==e)||void 0===navigator.plugins&&"Windows"!=e&&"Windows Phone"!=e)))}())}},{key:"hasLiedBrowser",getData:function(e){e(function(){var e,t=navigator.userAgent.toLowerCase(),n=navigator.productSub;if(("Chrome"==(e=0<=t.indexOf("firefox")?"Firefox":0<=t.indexOf("opera")||0<=t.indexOf("opr")?"Opera":0<=t.indexOf("chrome")?"Chrome":0<=t.indexOf("safari")?"Safari":0<=t.indexOf("trident")?"Internet Explorer":"Other")||"Safari"==e||"Opera"==e)&&"20030107"!==n)return!0;var i,n=eval.toString().length;if(37===n&&"Safari"!=e&&"Firefox"!=e&&"Other"!=e)return!0;if(39===n&&"Internet Explorer"!=e&&"Other"!=e)return!0;if(33===n&&"Chrome"!=e&&"Opera"!=e&&"Other"!=e)return!0;try{throw"a"}catch(e){try{e.toSource(),i=!0}catch(e){i=!1}}return i&&"Firefox"!=e&&"Other"!=e}())}},{key:"touchSupport",getData:function(e){e(function(){var e,t=0;void 0!==navigator.maxTouchPoints?t=navigator.maxTouchPoints:void 0!==navigator.msMaxTouchPoints&&(t=navigator.msMaxTouchPoints);try{document.createEvent("TouchEvent"),e=!0}catch(t){e=!1}return[t,e,"ontouchstart"in window]}())}},{key:"fonts",getData:function(e,t){function u(){var e=document.createElement("span");return e.style.position="absolute",e.style.left="-9999px",e.style.fontSize="72px",e.style.fontStyle="normal",e.style.fontWeight="normal",e.style.letterSpacing="normal",e.style.lineBreak="auto",e.style.lineHeight="normal",e.style.textTransform="none",e.style.textAlign="left",e.style.textDecoration="none",e.style.textShadow="none",e.style.whiteSpace="normal",e.style.wordBreak="normal",e.style.wordSpacing="normal",e.innerHTML="mmmmmmmmmmlli",e}var d=["monospace","sans-serif","serif"],h=["Andale Mono","Arial","Arial Black","Arial Hebrew","Arial MT","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Bitstream Vera Sans Mono","Book Antiqua","Bookman Old Style","Calibri","Cambria","Cambria Math","Century","Century Gothic","Century Schoolbook","Comic Sans","Comic Sans MS","Consolas","Courier","Courier New","Geneva","Georgia","Helvetica","Helvetica Neue","Impact","Lucida Bright","Lucida Calligraphy","Lucida Console","Lucida Fax","LUCIDA GRANDE","Lucida Handwriting","Lucida Sans","Lucida Sans Typewriter","Lucida Sans Unicode","Microsoft Sans Serif","Monaco","Monotype Corsiva","MS Gothic","MS Outlook","MS PGothic","MS Reference Sans Serif","MS Sans Serif","MS Serif","MYRIAD","MYRIAD PRO","Palatino","Palatino Linotype","Segoe Print","Segoe Script","Segoe UI","Segoe UI Light","Segoe UI Semibold","Segoe UI Symbol","Tahoma","Times","Times New Roman","Times New Roman PS","Trebuchet MS","Verdana","Wingdings","Wingdings 2","Wingdings 3"],h=(h=(h=t.fonts.extendedJsFonts?h.concat(["Abadi MT Condensed Light","Academy Engraved LET","ADOBE CASLON PRO","Adobe Garamond","ADOBE GARAMOND PRO","Agency FB","Aharoni","Albertus Extra Bold","Albertus Medium","Algerian","Amazone BT","American Typewriter","American Typewriter Condensed","AmerType Md BT","Andalus","Angsana New","AngsanaUPC","Antique Olive","Aparajita","Apple Chancery","Apple Color Emoji","Apple SD Gothic Neo","Arabic Typesetting","ARCHER","ARNO PRO","Arrus BT","Aurora Cn BT","AvantGarde Bk BT","AvantGarde Md BT","AVENIR","Ayuthaya","Bandy","Bangla Sangam MN","Bank Gothic","BankGothic Md BT","Baskerville","Baskerville Old Face","Batang","BatangChe","Bauer Bodoni","Bauhaus 93","Bazooka","Bell MT","Bembo","Benguiat Bk BT","Berlin Sans FB","Berlin Sans FB Demi","Bernard MT Condensed","BernhardFashion BT","BernhardMod BT","Big Caslon","BinnerD","Blackadder ITC","BlairMdITC TT","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bodoni MT","Bodoni MT Black","Bodoni MT Condensed","Bodoni MT Poster Compressed","Bookshelf Symbol 7","Boulder","Bradley Hand","Bradley Hand ITC","Bremen Bd BT","Britannic Bold","Broadway","Browallia New","BrowalliaUPC","Brush Script MT","Californian FB","Calisto MT","Calligrapher","Candara","CaslonOpnface BT","Castellar","Centaur","Cezanne","CG Omega","CG Times","Chalkboard","Chalkboard SE","Chalkduster","Charlesworth","Charter Bd BT","Charter BT","Chaucer","ChelthmITC Bk BT","Chiller","Clarendon","Clarendon Condensed","CloisterBlack BT","Cochin","Colonna MT","Constantia","Cooper Black","Copperplate","Copperplate Gothic","Copperplate Gothic Bold","Copperplate Gothic Light","CopperplGoth Bd BT","Corbel","Cordia New","CordiaUPC","Cornerstone","Coronet","Cuckoo","Curlz MT","DaunPenh","Dauphin","David","DB LCD Temp","DELICIOUS","Denmark","DFKai-SB","Didot","DilleniaUPC","DIN","DokChampa","Dotum","DotumChe","Ebrima","Edwardian Script ITC","Elephant","English 111 Vivace BT","Engravers MT","EngraversGothic BT","Eras Bold ITC","Eras Demi ITC","Eras Light ITC","Eras Medium ITC","EucrosiaUPC","Euphemia","Euphemia UCAS","EUROSTILE","Exotc350 Bd BT","FangSong","Felix Titling","Fixedsys","FONTIN","Footlight MT Light","Forte","FrankRuehl","Fransiscan","Freefrm721 Blk BT","FreesiaUPC","Freestyle Script","French Script MT","FrnkGothITC Bk BT","Fruitger","FRUTIGER","Futura","Futura Bk BT","Futura Lt BT","Futura Md BT","Futura ZBlk BT","FuturaBlack BT","Gabriola","Galliard BT","Gautami","Geeza Pro","Geometr231 BT","Geometr231 Hv BT","Geometr231 Lt BT","GeoSlab 703 Lt BT","GeoSlab 703 XBd BT","Gigi","Gill Sans","Gill Sans MT","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Gill Sans Ultra Bold","Gill Sans Ultra Bold Condensed","Gisha","Gloucester MT Extra Condensed","GOTHAM","GOTHAM BOLD","Goudy Old Style","Goudy Stout","GoudyHandtooled BT","GoudyOLSt BT","Gujarati Sangam MN","Gulim","GulimChe","Gungsuh","GungsuhChe","Gurmukhi MN","Haettenschweiler","Harlow Solid Italic","Harrington","Heather","Heiti SC","Heiti TC","HELV","Herald","High Tower Text","Hiragino Kaku Gothic ProN","Hiragino Mincho ProN","Hoefler Text","Humanst 521 Cn BT","Humanst521 BT","Humanst521 Lt BT","Imprint MT Shadow","Incised901 Bd BT","Incised901 BT","Incised901 Lt BT","INCONSOLATA","Informal Roman","Informal011 BT","INTERSTATE","IrisUPC","Iskoola Pota","JasmineUPC","Jazz LET","Jenson","Jester","Jokerman","Juice ITC","Kabel Bk BT","Kabel Ult BT","Kailasa","KaiTi","Kalinga","Kannada Sangam MN","Kartika","Kaufmann Bd BT","Kaufmann BT","Khmer UI","KodchiangUPC","Kokila","Korinna BT","Kristen ITC","Krungthep","Kunstler Script","Lao UI","Latha","Leelawadee","Letter Gothic","Levenim MT","LilyUPC","Lithograph","Lithograph Light","Long Island","Lydian BT","Magneto","Maiandra GD","Malayalam Sangam MN","Malgun Gothic","Mangal","Marigold","Marion","Marker Felt","Market","Marlett","Matisse ITC","Matura MT Script Capitals","Meiryo","Meiryo UI","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft Yi Baiti","MingLiU","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","MingLiU-ExtB","Minion","Minion Pro","Miriam","Miriam Fixed","Mistral","Modern","Modern No. 20","Mona Lisa Solid ITC TT","Mongolian Baiti","MONO","MoolBoran","Mrs Eaves","MS LineDraw","MS Mincho","MS PMincho","MS Reference Specialty","MS UI Gothic","MT Extra","MUSEO","MV Boli","Nadeem","Narkisim","NEVIS","News Gothic","News GothicMT","NewsGoth BT","Niagara Engraved","Niagara Solid","Noteworthy","NSimSun","Nyala","OCR A Extended","Old Century","Old English Text MT","Onyx","Onyx BT","OPTIMA","Oriya Sangam MN","OSAKA","OzHandicraft BT","Palace Script MT","Papyrus","Parchment","Party LET","Pegasus","Perpetua","Perpetua Titling MT","PetitaBold","Pickwick","Plantagenet Cherokee","Playbill","PMingLiU","PMingLiU-ExtB","Poor Richard","Poster","PosterBodoni BT","PRINCETOWN LET","Pristina","PTBarnum BT","Pythagoras","Raavi","Rage Italic","Ravie","Ribbon131 Bd BT","Rockwell","Rockwell Condensed","Rockwell Extra Bold","Rod","Roman","Sakkal Majalla","Santa Fe LET","Savoye LET","Sceptre","Script","Script MT Bold","SCRIPTINA","Serifa","Serifa BT","Serifa Th BT","ShelleyVolante BT","Sherwood","Shonar Bangla","Showcard Gothic","Shruti","Signboard","SILKSCREEN","SimHei","Simplified Arabic","Simplified Arabic Fixed","SimSun","SimSun-ExtB","Sinhala Sangam MN","Sketch Rockwell","Skia","Small Fonts","Snap ITC","Snell Roundhand","Socket","Souvenir Lt BT","Staccato222 BT","Steamer","Stencil","Storybook","Styllo","Subway","Swis721 BlkEx BT","Swiss911 XCm BT","Sylfaen","Synchro LET","System","Tamil Sangam MN","Technical","Teletype","Telugu Sangam MN","Tempus Sans ITC","Terminal","Thonburi","Traditional Arabic","Trajan","TRAJAN PRO","Tristan","Tubular","Tunga","Tw Cen MT","Tw Cen MT Condensed","Tw Cen MT Condensed Extra Bold","TypoUpright BT","Unicorn","Univers","Univers CE 55 Medium","Univers Condensed","Utsaah","Vagabond","Vani","Vijaya","Viner Hand ITC","VisualUI","Vivaldi","Vladimir Script","Vrinda","Westminster","WHITNEY","Wide Latin","ZapfEllipt BT","ZapfHumnst BT","ZapfHumnst Dm BT","Zapfino","Zurich BlkEx BT","Zurich Ex BT","ZWAdobeF"]):h).concat(t.fonts.userDefinedFonts)).filter(function(e,t){return h.indexOf(e)===t}),t=document.getElementsByTagName("body")[0],r=document.createElement("div"),l=document.createElement("div"),i={},o={},n=function(){for(var e=[],t=0,n=d.length;t<n;t++){var i=u();i.style.fontFamily=d[t],r.appendChild(i),e.push(i)}return e}();t.appendChild(r);for(var a=0,s=d.length;a<s;a++)i[d[a]]=n[a].offsetWidth,o[d[a]]=n[a].offsetHeight;var c=function(){for(var e,t,n={},i=0,r=h.length;i<r;i++){for(var o=[],a=0,s=d.length;a<s;a++){var c=(e=h[i],t=d[a],c=void 0,(c=u()).style.fontFamily="'"+e+"',"+t,c);l.appendChild(c),o.push(c)}n[h[i]]=o}return n}();t.appendChild(l);for(var p=[],f=0,g=h.length;f<g;f++)!function(e){for(var t=!1,n=0;n<d.length;n++)if(t=e[n].offsetWidth!==i[d[n]]||e[n].offsetHeight!==o[d[n]])return t;return t}(c[h[f]])||p.push(h[f]);t.removeChild(l),t.removeChild(r),e(p)},pauseBefore:!0},{key:"fontsFlash",getData:function(t,e){return void 0===window.swfobject?t("swf object not loaded"):window.swfobject.hasFlashPlayerVersion("9.0.0")?e.fonts.swfPath?void function(t,e){window.___fp_swf_loaded=function(e){t(e)};var n,i=e.fonts.swfContainerId;(n=document.createElement("div")).setAttribute("id",(void 0).fonts.swfContainerId),document.body.appendChild(n);window.swfobject.embedSWF(e.fonts.swfPath,i,"1","1","9.0.0",!1,{onReady:"___fp_swf_loaded"},{allowScriptAccess:"always",menu:"false"},{})}(function(e){t(e)},e):t("missing options.fonts.swfPath"):t("flash not installed")},pauseBefore:!0},{key:"audio",getData:function(n,e){var t=e.audio;if(t.excludeIOS11&&navigator.userAgent.match(/OS 11.+Version\/11.+Safari/))return n(e.EXCLUDED);var i=window.OfflineAudioContext||window.webkitOfflineAudioContext;if(null==i)return n(e.NOT_AVAILABLE);var r=new i(1,44100,44100),o=r.createOscillator();o.type="triangle",o.frequency.setValueAtTime(1e4,r.currentTime);var a=r.createDynamicsCompressor();d([["threshold",-50],["knee",40],["ratio",12],["reduction",-20],["attack",0],["release",.25]],function(e){void 0!==a[e[0]]&&"function"==typeof a[e[0]].setValueAtTime&&a[e[0]].setValueAtTime(e[1],r.currentTime)}),o.connect(a),a.connect(r.destination),o.start(0),r.startRendering();var s=setTimeout(function(){return console.warn('Audio fingerprint timed out. Please report bug at https://github.com/Valve/fingerprintjs2 with your user agent: "'+navigator.userAgent+'".'),r.oncomplete=function(){},r=null,n("audioTimeout")},t.timeout);r.oncomplete=function(e){var t;try{clearTimeout(s),t=e.renderedBuffer.getChannelData(0).slice(4500,5e3).reduce(function(e,t){return e+Math.abs(t)},0).toString(),o.disconnect(),a.disconnect()}catch(e){return void n(e)}n(t)}}},{key:"enumerateDevices",getData:function(t,e){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return t(e.NOT_AVAILABLE);navigator.mediaDevices.enumerateDevices().then(function(e){t(e.map(function(e){return"id="+e.deviceId+";gid="+e.groupId+";"+e.kind+";"+e.label}))}).catch(function(e){t(e)})}}],u.get=function(n,i){(function(e,t){if(null==t)return;var n,i;for(i in t)null==(n=t[i])||Object.prototype.hasOwnProperty.call(e,i)||(e[i]=n)})(n=i?n||{}:(i=n,{}),e),n.components=n.extraComponents.concat(t);function r(e){if((a+=1)>=n.components.length)i(o.data);else{var t=n.components[a];if(n.excludes[t.key])r(!1);else{if(!e&&t.pauseBefore)return--a,setTimeout(function(){r(!0)},1),0;try{t.getData(function(e){o.addPreprocessedComponent(t.key,e),r(!1)},n)}catch(e){o.addPreprocessedComponent(t.key,String(e)),r(!1)}}}}var o={data:[],addPreprocessedComponent:function(e,t){"function"==typeof n.preprocessor&&(t=n.preprocessor(e,t)),o.data.push({key:e,value:t})}},a=-1;r(!1)},u.getPromise=function(n){return new Promise(function(e,t){u.get(n,e)})},u.getV18=function(o,a){return null==a&&(a=o,o={}),u.get(o,function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];i.value===(o.NOT_AVAILABLE||"not available")?t.push({key:i.key,value:"unknown"}):"plugins"===i.key?t.push({key:"plugins",value:_(i.value,function(e){var t=_(e[2],function(e){return e.join?e.join("~"):e}).join(",");return[e[0],e[1],t].join("::")})}):-1!==["canvas","webgl"].indexOf(i.key)?t.push({key:i.key,value:i.value.join("~")}):-1!==["sessionStorage","localStorage","indexedDb","addBehavior","openDatabase"].indexOf(i.key)?i.value&&t.push({key:i.key,value:1}):i.value?t.push(i.value.join?{key:i.key,value:i.value.join(";")}:i):t.push({key:i.key,value:i.value})}var r=s(_(t,function(e){return e.value}).join("~~~"),31);a(r,t)})},u.x64hash128=s,u.VERSION="2.1.0",u)}(),function(e){function i(e,t){var n;t=t||{},this._id=i._generateUUID(),this._promise=t.promise||Promise,this._frameId=t.frameId||"CrossStorageClient-"+this._id,this._origin=i._getOrigin(e),this._requests={},this._connected=!1,this._closed=!1,this._count=0,this._timeout=t.timeout||5e3,this._listener=null,this._installListener(),(n=t.frameId?document.getElementById(t.frameId):n)&&this._poll(),n=n||this._createFrame(e),this._hub=n.contentWindow}i.frameStyle={width:0,height:0,border:"none",display:"none",position:"absolute",top:"-999px",left:"-999px"},i._getOrigin=function(e){var t;return(t=document.createElement("a")).href=e,(((t=!t.host?window.location:t).protocol&&":"!==t.protocol?t:window.location).protocol+"//"+t.host).replace(/:80$|:443$/,"")},i._generateUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},i.prototype.onConnect=function(){var e=this;return this._connected?this._promise.resolve():this._closed?this._promise.reject(new Error("CrossStorageClient has closed")):(this._requests.connect||(this._requests.connect=[]),new this._promise(function(t,n){var i=setTimeout(function(){n(new Error("CrossStorageClient could not connect"))},e._timeout);e._requests.connect.push(function(e){return clearTimeout(i),e?n(e):void t()})}))},i.prototype.set=function(e,t){return this._request("set",{key:e,value:t})},i.prototype.get=function(e){var t=Array.prototype.slice.call(arguments);return this._request("get",{keys:t})},i.prototype.del=function(){var e=Array.prototype.slice.call(arguments);return this._request("del",{keys:e})},i.prototype.clear=function(){return this._request("clear")},i.prototype.getKeys=function(){return this._request("getKeys")},i.prototype.close=function(){var e=document.getElementById(this._frameId);e&&e.parentNode.removeChild(e),window.removeEventListener?window.removeEventListener("message",this._listener,!1):window.detachEvent("onmessage",this._listener),this._connected=!1,this._closed=!0},i.prototype._installListener=function(){var r=this;this._listener=function(e){var t,n,i;if(!r._closed&&e.data&&"string"==typeof e.data&&("null"===e.origin?"file://":e.origin)===r._origin)if("cross-storage:unavailable"!==e.data){if(-1!==e.data.indexOf("cross-storage:")&&!r._connected){if(r._connected=!0,!r._requests.connect)return;for(t=0;t<r._requests.connect.length;t++)r._requests.connect[t](n);delete r._requests.connect}if("cross-storage:ready"!==e.data){try{i=JSON.parse(e.data)}catch(e){return}i.id&&r._requests[i.id]&&r._requests[i.id](i.error,i.result)}}else if(r._closed||r.close(),r._requests.connect)for(n=new Error("Closing client. Could not access localStorage in hub."),t=0;t<r._requests.connect.length;t++)r._requests.connect[t](n)},window.addEventListener?window.addEventListener("message",this._listener,!1):window.attachEvent("onmessage",this._listener)},i.prototype._poll=function(){var e,t="file://"===(e=this)._origin?"*":e._origin,n=setInterval(function(){return e._connected?clearInterval(n):void(e._hub&&e._hub.postMessage("cross-storage:poll",t))},1e3)},i.prototype._createFrame=function(e){var t,n;for(n in(t=window.document.createElement("iframe")).id=this._frameId,i.frameStyle)i.frameStyle.hasOwnProperty(n)&&(t.style[n]=i.frameStyle[n]);return window.document.body.appendChild(t),t.src=e,t},i.prototype._request=function(e,t){var o,a;return this._closed?this._promise.reject(new Error("CrossStorageClient has closed")):((a=this)._count++,o={id:this._id+":"+a._count,method:"cross-storage:"+e,params:t},new this._promise(function(n,i){var e,t,r=setTimeout(function(){a._requests[o.id]&&(delete a._requests[o.id],i(new Error("Timeout: could not perform "+o.method)))},a._timeout);a._requests[o.id]=function(e,t){if(clearTimeout(r),delete a._requests[o.id],e)return i(new Error(e));n(t)},Array.prototype.toJSON&&(e=Array.prototype.toJSON,Array.prototype.toJSON=null),t="file://"===a._origin?"*":a._origin,a._hub.postMessage(JSON.stringify(o),t),e&&(Array.prototype.toJSON=e)}))},e.CrossStorageClient=i}(window),function(e){"use strict";"function"!=typeof e.CustomEvent&&(e.CustomEvent=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:null};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n})}(window),function(){"use strict";"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},writable:!0,configurable:!0})}(),function(n){var i,r=n.history;!r||(i=r.pushState)&&(r.pushState=function(e){"function"==typeof r.onpushstate&&r.onpushstate({state:e});var t=i.apply(r,arguments);return n.dispatchEvent(new CustomEvent("_onlocationchange")),t})}(window),Array.from||(Array.from=function(){function c(e){return"function"==typeof e||"[object Function]"===t.call(e)}var t=Object.prototype.toString,u=Math.pow(2,53)-1;return function(e){var t=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var n,i=1<arguments.length?arguments[1]:void 0;if(void 0!==i){if(!c(i))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(n=arguments[2])}for(var r,o=function(e){e=Number(e),e=isNaN(e)?0:0!==e&&isFinite(e)?(0<e?1:-1)*Math.floor(Math.abs(e)):e;return Math.min(Math.max(e,0),u)}(t.length),a=c(this)?Object(new this(o)):new Array(o),s=0;s<o;)r=t[s],a[s]=i?void 0===n?i(r,s):i.call(n,r,s):r,s+=1;return a.length=o,a}}()),function(e){"use strict";function t(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})}var n=setTimeout;function c(e){return Boolean(e&&void 0!==e.length)}function r(){}function o(e){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],h(e,this)}function a(n,i){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,o._immediateFn(function(){var e,t=1===n._state?i.onFulfilled:i.onRejected;if(null!==t){try{e=t(n._value)}catch(e){return void u(i.promise,e)}s(i.promise,e)}else(1===n._state?s:u)(i.promise,n._value)})):n._deferreds.push(i)}function s(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void d(e);if("function"==typeof n)return void h((i=n,r=t,function(){i.apply(r,arguments)}),e)}e._state=1,e._value=t,d(e)}catch(t){u(e,t)}var i,r}function u(e,t){e._state=2,e._value=t,d(e)}function d(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)a(e,e._deferreds[t]);e._deferreds=null}function h(e,t){var n=!1;try{e(function(e){n||(n=!0,s(t,e))},function(e){n||(n=!0,u(t,e))})}catch(e){if(n)return;n=!0,u(t,e)}}o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(i,e){var t=new this.constructor(r);return a(this,new function(e,t,n){this.onFulfilled="function"==typeof i?i:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(0,e,t)),t},o.prototype.finally=t,o.all=function(t){return new o(function(r,o){if(!c(t))return o(new TypeError("Promise.all accepts an array"));var a=Array.prototype.slice.call(t);if(0===a.length)return r([]);var s=a.length;for(var e=0;e<a.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var i=e.then;if("function"==typeof i)return i.call(e,function(e){t(n,e)},o),0}a[n]=e,0==--s&&r(a)}catch(n){o(n)}}(e,a[e])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(n){return new o(function(e,t){t(n)})},o.race=function(r){return new o(function(e,t){if(!c(r))return t(new TypeError("Promise.race accepts an array"));for(var n=0,i=r.length;n<i;n++)o.resolve(r[n]).then(e,t)})},o._immediateFn="function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){n(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},"function"!=typeof e.Promise?e.Promise=o:e.Promise.prototype.finally||(e.Promise.prototype.finally=t)}(window),function(r){"use strict";function o(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof o))return new o(e,t).getResult();var n=e||(r&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),i=t?d.extend(p,t):p;return this.getBrowser=function(){var e={name:void 0,version:void 0};return h.rgx.call(e,n,i.browser),e.major=d.major(e.version),e},this.getCPU=function(){var e={architecture:void 0};return h.rgx.call(e,n,i.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return h.rgx.call(e,n,i.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return h.rgx.call(e,n,i.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return h.rgx.call(e,n,i.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this}var e="model",t="name",n="type",i="vendor",a="version",s="mobile",c="tablet",u="smarttv",d={extend:function(e,t){var n,i={};for(n in e)t[n]&&t[n].length%2==0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},h={rgx:function(e,t){for(var n,i,r,o,a,s=0;s<t.length&&!o;){for(var c=t[s],u=t[s+1],d=n=0;d<c.length&&!o;)if(o=c[d++].exec(e))for(i=0;i<u.length;i++)a=o[++n],"object"==typeof(r=u[i])&&0<r.length?2==r.length?"function"==typeof r[1]?this[r[0]]=r[1].call(this,a):this[r[0]]=r[1]:3==r.length?"function"!=typeof r[1]||r[1].exec&&r[1].test?this[r[0]]=a?a.replace(r[1],r[2]):void 0:this[r[0]]=a?r[1].call(this,a,r[2]):void 0:4==r.length&&(this[r[0]]=a?r[3].call(this,a.replace(r[1],r[2])):void 0):this[r]=a||void 0;s+=2}},str:function(e,t){for(var n in t)if("object"==typeof t[n]&&0<t[n].length){for(var i=0;i<t[n].length;i++)if(d.has(t[n][i],e))return"?"===n?void 0:n}else if(d.has(t[n],e))return"?"===n?void 0:n;return e}},l={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},p={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[t,a],[/(opios)[\/\s]+([\w\.]+)/i],[[t,"Opera Mini"],a],[/\s(opr)\/([\w\.]+)/i],[[t,"Opera"],a],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[t,a],[/(konqueror)\/([\w\.]+)/i],[[t,"Konqueror"],a],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[t,"IE"],a],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[t,"Edge"],a],[/(yabrowser)\/([\w\.]+)/i],[[t,"Yandex"],a],[/(Avast)\/([\w\.]+)/i],[[t,"Avast Secure Browser"],a],[/(AVG)\/([\w\.]+)/i],[[t,"AVG Secure Browser"],a],[/(puffin)\/([\w\.]+)/i],[[t,"Puffin"],a],[/(focus)\/([\w\.]+)/i],[[t,"Firefox Focus"],a],[/(opt)\/([\w\.]+)/i],[[t,"Opera Touch"],a],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[t,"UCBrowser"],a],[/(comodo_dragon)\/([\w\.]+)/i],[[t,/_/g," "],a],[/(windowswechat qbcore)\/([\w\.]+)/i],[[t,"WeChat(Win) Desktop"],a],[/(micromessenger)\/([\w\.]+)/i],[[t,"WeChat"],a],[/(brave)\/([\w\.]+)/i],[[t,"Brave"],a],[/(qqbrowserlite)\/([\w\.]+)/i],[t,a],[/(QQ)\/([\d\.]+)/i],[t,a],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[t,a],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[t,a],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[t,a],[/(MetaSr)[\/\s]?([\w\.]+)/i],[t],[/(LBBROWSER)/i],[t],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[a,[t,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[a,[t,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[t,a],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[a,[t,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[t,/(.+)/,"$1 WebView"],a],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[t,/(.+(?:g|us))(.+)/,"$1 $2"],a],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[a,[t,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[t,"Sailfish Browser"],a],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[t,a],[/(dolfin)\/([\w\.]+)/i],[[t,"Dolphin"],a],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[t,"360 Browser"]],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[t,"Chrome"],a],[/(coast)\/([\w\.]+)/i],[[t,"Opera Coast"],a],[/fxios\/([\w\.-]+)/i],[a,[t,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[a,[t,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[a,t],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[t,"GSA"],a],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[t,[a,h.str,l.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[t,a],[/(navigator|netscape)\/([\w\.-]+)/i],[[t,"Netscape"],a],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[t,a]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",d.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",d.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",d.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[e,i,[n,c]],[/applecoremedia\/[\w\.]+ \((ipad)/],[e,[i,"Apple"],[n,c]],[/(apple\s{0,1}tv)/i],[[e,"Apple TV"],[i,"Apple"],[n,u]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[i,e,[n,c]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[e,[i,"Amazon"],[n,c]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[e,h.str,l.device.amazon.model],[i,"Amazon"],[n,s]],[/android.+aft([bms])\sbuild/i],[e,[i,"Amazon"],[n,u]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[e,i,[n,s]],[/\((ip[honed|\s\w*]+);/i],[e,[i,"Apple"],[n,s]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[i,e,[n,s]],[/\(bb10;\s(\w+)/i],[e,[i,"BlackBerry"],[n,s]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[e,[i,"Asus"],[n,c]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[i,"Sony"],[e,"Xperia Tablet"],[n,c]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[e,[i,"Sony"],[n,s]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[i,e,[n,"console"]],[/android.+;\s(shield)\sbuild/i],[e,[i,"Nvidia"],[n,"console"]],[/(playstation\s[34portablevi]+)/i],[e,[i,"Sony"],[n,"console"]],[/(sprint\s(\w+))/i],[[i,h.str,l.device.sprint.vendor],[e,h.str,l.device.sprint.model],[n,s]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[i,[e,/_/g," "],[n,s]],[/(nexus\s9)/i],[e,[i,"HTC"],[n,c]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29)/i],[e,[i,"Huawei"],[n,s]],[/android.+(bah2?-a?[lw]\d{2})/i],[e,[i,"Huawei"],[n,c]],[/(microsoft);\s(lumia[\s\w]+)/i],[i,e,[n,s]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[e,[i,"Microsoft"],[n,"console"]],[/(kin\.[onetw]{3})/i],[[e,/\./g," "],[i,"Microsoft"],[n,s]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[e,[i,"Motorola"],[n,s]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[e,[i,"Motorola"],[n,c]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[i,d.trim],[e,d.trim],[n,u]],[/hbbtv.+maple;(\d+)/i],[[e,/^/,"SmartTV"],[i,"Samsung"],[n,u]],[/\(dtv[\);].+(aquos)/i],[e,[i,"Sharp"],[n,u]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[i,"Samsung"],e,[n,c]],[/smart-tv.+(samsung)/i],[i,[n,u],e],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[i,"Samsung"],e,[n,s]],[/sie-(\w*)/i],[e,[i,"Siemens"],[n,s]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[i,"Nokia"],e,[n,s]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[e,[i,"Acer"],[n,c]],[/android.+([vl]k\-?\d{3})\s+build/i],[e,[i,"LG"],[n,c]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[i,"LG"],e,[n,c]],[/(lg) netcast\.tv/i],[i,e,[n,u]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[e,[i,"LG"],[n,s]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[i,e,[n,c]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[e,[i,"Lenovo"],[n,c]],[/(lenovo)[_\s-]?([\w-]+)/i],[i,e,[n,s]],[/linux;.+((jolla));/i],[i,e,[n,s]],[/((pebble))app\/[\d\.]+\s/i],[i,e,[n,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[i,e,[n,s]],[/crkey/i],[[e,"Chromecast"],[i,"Google"],[n,u]],[/android.+;\s(glass)\s\d/i],[e,[i,"Google"],[n,"wearable"]],[/android.+;\s(pixel c)[\s)]/i],[e,[i,"Google"],[n,c]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[e,[i,"Google"],[n,s]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[e,/_/g," "],[i,"Xiaomi"],[n,s]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[e,/_/g," "],[i,"Xiaomi"],[n,c]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[e,[i,"Meizu"],[n,s]],[/(mz)-([\w-]{2,})/i],[[i,"Meizu"],e,[n,s]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[e,[i,"OnePlus"],[n,s]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[e,[i,"RCA"],[n,c]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[e,[i,"Dell"],[n,c]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[e,[i,"Verizon"],[n,c]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[i,"Barnes & Noble"],e,[n,c]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[e,[i,"NuVision"],[n,c]],[/android.+;\s(k88)\sbuild/i],[e,[i,"ZTE"],[n,c]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[e,[i,"Swiss"],[n,s]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[e,[i,"Swiss"],[n,c]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[e,[i,"Zeki"],[n,c]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[i,"Dragon Touch"],e,[n,c]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[e,[i,"Insignia"],[n,c]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[e,[i,"NextBook"],[n,c]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[i,"Voice"],e,[n,s]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[i,"LvTel"],e,[n,s]],[/android.+;\s(PH-1)\s/i],[e,[i,"Essential"],[n,s]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[e,[i,"Envizen"],[n,c]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[i,e,[n,c]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[e,[i,"MachSpeed"],[n,c]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[i,e,[n,c]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[e,[i,"Rotor"],[n,c]],[/android.+(KS(.+))\s+build/i],[e,[i,"Amazon"],[n,c]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[i,e,[n,c]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[n,d.lowerize],i,e],[/[\s\/\(](smart-?tv)[;\)]/i],[[n,u]],[/(android[\w\.\s\-]{0,9});.+build/i],[e,[i,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[a,[t,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[a,[t,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[t,a],[/rv\:([\w\.]{1,9}).+(gecko)/i],[a,t]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[t,a],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[t,[a,h.str,l.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[t,"Windows"],[a,h.str,l.os.windows.version]],[/\((bb)(10);/i],[[t,"BlackBerry"],a],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[t,a],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[t,"Symbian"],a],[/\((series40);/i],[t],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[t,"Firefox OS"],a],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[t,a],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[t,"Chromium OS"],a],[/(sunos)\s?([\w\.\d]*)/i],[[t,"Solaris"],a],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[t,a],[/(haiku)\s(\w+)/i],[t,a],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[a,/_/g,"."],[t,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[t,"Mac OS"],[a,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[t,a]]};o.VERSION="0.7.21",o.BROWSER={NAME:t,MAJOR:"major",VERSION:a},o.CPU={ARCHITECTURE:"architecture"},o.DEVICE={MODEL:e,VENDOR:i,TYPE:n,CONSOLE:"console",MOBILE:s,SMARTTV:u,TABLET:c,WEARABLE:"wearable",EMBEDDED:"embedded"},o.ENGINE={NAME:t,VERSION:a},o.OS={NAME:t,VERSION:a},r._securedTouchDependencies.UAParser=o}(window),window._securedTouchDependencies.pako=function i(r,o,a){function s(t,e){if(!o[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}n=o[t]={exports:{}};r[t][0].call(n.exports,function(e){return s(r[t][1][e]||e)},n,n.exports,i,r,o,a)}return o[t].exports}for(var c="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t,n,i=Array.prototype.slice.call(arguments,1);i.length;){var r=i.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var o in r)t=r,n=o,Object.prototype.hasOwnProperty.call(t,n)&&(e[o]=r[o])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var o=0;o<i;o++)e[r+o]=t[n+o]},flattenChunks:function(e){for(var t,n,i,r=0,o=0,a=e.length;o<a;o++)r+=e[o].length;for(i=new Uint8Array(r),o=t=0,a=e.length;o<a;o++)n=e[o],i.set(n,t),t+=n.length;return i}},o={arraySet:function(e,t,n,i,r){for(var o=0;o<i;o++)e[r+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(i)},{}],2:[function(e,t,n){"use strict";function c(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&r))return String.fromCharCode.apply(null,u.shrinkBuf(e,t));for(var n="",i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n}var u=e("./common"),r=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var d=new u.Buf8(256),i=0;i<256;i++)d[i]=252<=i?6:248<=i?5:240<=i?4:224<=i?3:192<=i?2:1;d[254]=d[254]=1,n.string2buf=function(e){for(var t,n,i,r,o=e.length,a=0,s=0;s<o;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(i=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new u.Buf8(a),s=r=0;r<a;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(i=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),n<128?t[r++]=n:(n<2048?t[r++]=192|n>>>6:(n<65536?t[r++]=224|n>>>12:(t[r++]=240|n>>>18,t[r++]=128|n>>>12&63),t[r++]=128|n>>>6&63),t[r++]=128|63&n);return t},n.buf2binstring=function(e){return c(e,e.length)},n.binstring2buf=function(e){for(var t=new u.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){for(var n,i,r=t||e.length,o=new Array(2*r),a=0,s=0;s<r;)if((n=e[s++])<128)o[a++]=n;else if(4<(i=d[n]))o[a++]=65533,s+=i-1;else{for(n&=2===i?31:3===i?15:7;1<i&&s<r;)n=n<<6|63&e[s++],i--;1<i?o[a++]=65533:n<65536?o[a++]=n:(n-=65536,o[a++]=55296|n>>10&1023,o[a++]=56320|1023&n)}return c(o,a)},n.utf8border=function(e,t){for(var n=(t=(t=t||e.length)>e.length?e.length:t)-1;0<=n&&128==(192&e[n]);)n--;return!(n<0)&&0!==n&&n+d[e[n]]>t?n:t}},{"./common":1}],3:[function(e,t,n){"use strict";t.exports=function(e,t,n,i){for(var r=65535&e|0,o=e>>>16&65535|0,a=0;0!==n;){for(n-=a=2e3<n?2e3:n;o=o+(r=r+t[i++]|0)|0,--a;);r%=65521,o%=65521}return r|o<<16|0}},{}],4:[function(e,t,n){"use strict";var s=function(){for(var e=[],t=0;t<256;t++){for(var n=t,i=0;i<8;i++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n}return e}();t.exports=function(e,t,n,i){var r=s,o=i+n;e^=-1;for(var a=i;a<o;a++)e=e>>>8^r[255&(e^t[a])];return-1^e}},{}],5:[function(e,t,n){"use strict";function c(e,t){return e.msg=y[t],t}function s(e){return(e<<1)-(4<e?9:0)}function d(e){for(var t=e.length;0<=--t;)e[t]=0}function u(e){var t=e.state,n=t.pending;0!==(n=n>e.avail_out?e.avail_out:n)&&(S.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function h(e,t){T._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,u(e.strm)}function l(e,t){e.pending_buf[e.pending++]=t}function p(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function o(e,t){var n,i,r=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-x?e.strstart-(e.w_size-x):0,u=e.window,d=e.w_mask,h=e.prev,l=e.strstart+U,p=u[o+a-1],f=u[o+a];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do{if(u[(n=t)+a]===f&&u[n+a-1]===p&&u[n]===u[o]&&u[++n]===u[o+1]){for(o+=2,n++;u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<l;);if(i=U-(l-o),o=l-U,a<i){if(e.match_start=t,s<=(a=i))break;p=u[o+a-1],f=u[o+a]}}}while((t=h[t&d])>c&&0!=--r);return a<=e.lookahead?a:e.lookahead}function f(e){var t,n,i,r,o,a,s,c,u,d=e.w_size;do{if(u=e.window_size-e.lookahead-e.strstart,e.strstart>=d+(d-x)){for(S.arraySet(e.window,e.window,d,d,0),e.match_start-=d,e.strstart-=d,e.block_start-=d,t=n=e.hash_size;i=e.head[--t],e.head[t]=d<=i?i-d:0,--n;);for(t=n=d;i=e.prev[--t],e.prev[t]=d<=i?i-d:0,--n;);u+=d}if(0===e.strm.avail_in)break;if(o=e.strm,a=e.window,s=e.strstart+e.lookahead,c=u,u=void 0,u=o.avail_in,n=0===(u=c<u?c:u)?0:(o.avail_in-=u,S.arraySet(a,o.input,o.next_in,u,s),1===o.state.wrap?o.adler=b(o.adler,a,u,s):2===o.state.wrap&&(o.adler=E(o.adler,a,u,s)),o.next_in+=u,o.total_in+=u,u),e.lookahead+=n,e.lookahead+e.insert>=k)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=(e.ins_h<<e.hash_shift^e.window[r+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[r+k-1])&e.hash_mask,e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<k)););}while(e.lookahead<x&&0!==e.strm.avail_in)}function i(e,t){for(var n,i;;){if(e.lookahead<x){if(f(e),e.lookahead<x&&t===w)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=k&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-x&&(e.match_length=o(e,n)),e.match_length>=k)if(i=T._tr_tally(e,e.strstart-e.match_start,e.match_length-k),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=k){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=T._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(h(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<k-1?e.strstart:k-1,4===t?(h(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?1:2}function r(e,t){for(var n,i,r;;){if(e.lookahead<x){if(f(e),e.lookahead<x&&t===w)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=k&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=k-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-x&&(e.match_length=o(e,n),e.match_length<=5&&(1===e.strategy||e.match_length===k&&4096<e.strstart-e.match_start)&&(e.match_length=k-1)),e.prev_length>=k&&e.match_length<=e.prev_length){for(r=e.strstart+e.lookahead-k,i=T._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-k),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=k-1,e.strstart++,i&&(h(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=T._tr_tally(e,0,e.window[e.strstart-1]))&&h(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=T._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<k-1?e.strstart:k-1,4===t?(h(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?1:2}function a(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}function g(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=C,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new S.Buf16(2*R),this.dyn_dtree=new S.Buf16(2*(2*L+1)),this.bl_tree=new S.Buf16(2*(2*O+1)),d(this.dyn_ltree),d(this.dyn_dtree),d(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new S.Buf16(M+1),this.heap=new S.Buf16(2*D+1),d(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new S.Buf16(2*D+1),d(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function m(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=I,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?B:N,e.adler=2===t.wrap?0:1,t.last_flush=w,T._tr_init(t),A):c(e,P)}function _(e){var t=m(e);return t===A&&((e=e.state).window_size=2*e.w_size,d(e.head),e.max_lazy_match=H[e.level].max_lazy,e.good_match=H[e.level].good_length,e.nice_match=H[e.level].nice_length,e.max_chain_length=H[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=k-1,e.match_available=0,e.ins_h=0),t}function v(e,t,n,i,r,o){if(!e)return P;var a=1;if(-1===t&&(t=6),i<0?(a=0,i=-i):15<i&&(a=2,i-=16),r<1||9<r||n!==C||i<8||15<i||t<0||9<t||o<0||4<o)return c(e,P);8===i&&(i=9);var s=new g;return(e.state=s).strm=e,s.wrap=a,s.gzhead=null,s.w_bits=i,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=r+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+k-1)/k),s.window=new S.Buf8(2*s.w_size),s.head=new S.Buf16(s.hash_size),s.prev=new S.Buf16(s.w_size),s.lit_bufsize=1<<r+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new S.Buf8(s.pending_buf_size),s.d_buf=+s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=o,s.method=n,_(e)}var S=e("../utils/common"),T=e("./trees"),b=e("./adler32"),E=e("./crc32"),y=e("./messages"),w=0,A=0,P=-2,I=2,C=8,D=286,L=30,O=19,R=2*D+1,M=15,k=3,U=258,x=U+k+1,B=42,N=113,H=[new a(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(f(e),0===e.lookahead&&t===w)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,h(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-x&&(h(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(h(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(h(e,!1),e.strm.avail_out),1)}),new a(4,4,8,4,i),new a(4,5,16,8,i),new a(4,6,32,32,i),new a(4,4,16,16,r),new a(8,16,32,32,r),new a(8,16,128,128,r),new a(8,32,128,256,r),new a(32,128,258,1024,r),new a(32,258,258,4096,r)];n.deflateInit=function(e,t){return v(e,t,C,15,8,0)},n.deflateInit2=v,n.deflateReset=_,n.deflateResetKeep=m,n.deflateSetHeader=function(e,t){return!e||!e.state||2!==e.state.wrap?P:(e.state.gzhead=t,A)},n.deflate=function(e,t){var n,i,r,o;if(!e||!e.state||5<t||t<0)return e?c(e,P):P;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||666===n.status&&4!==t)return c(e,0===e.avail_out?-5:P);if(n.strm=e,a=n.last_flush,n.last_flush=t,n.status===B&&(2===n.wrap?(e.adler=0,l(n,31),l(n,139),l(n,8),n.gzhead?(l(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),l(n,255&n.gzhead.time),l(n,n.gzhead.time>>8&255),l(n,n.gzhead.time>>16&255),l(n,n.gzhead.time>>24&255),l(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),l(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(l(n,255&n.gzhead.extra.length),l(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=E(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(l(n,0),l(n,0),l(n,0),l(n,0),l(n,0),l(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),l(n,3),n.status=N)):(o=C+(n.w_bits-8<<4)<<8,o|=(2<=n.strategy||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(o|=32),o+=31-o%31,n.status=N,p(n,o),0!==n.strstart&&(p(n,e.adler>>>16),p(n,65535&e.adler)),e.adler=1)),69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(e.adler=E(e.adler,n.pending_buf,n.pending-i,i)),u(e),i=n.pending,n.pending!==n.pending_buf_size));)l(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=E(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=E(e.adler,n.pending_buf,n.pending-i,i)),u(e),i=n.pending,n.pending===n.pending_buf_size)){r=1;break}}while(r=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,l(n,r),0!==r);n.gzhead.hcrc&&n.pending>i&&(e.adler=E(e.adler,n.pending_buf,n.pending-i,i)),0===r&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=E(e.adler,n.pending_buf,n.pending-i,i)),u(e),i=n.pending,n.pending===n.pending_buf_size)){r=1;break}}while(r=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,l(n,r),0!==r);n.gzhead.hcrc&&n.pending>i&&(e.adler=E(e.adler,n.pending_buf,n.pending-i,i)),0===r&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&u(e),n.pending+2<=n.pending_buf_size&&(l(n,255&e.adler),l(n,e.adler>>8&255),e.adler=0,n.status=N)):n.status=N),0!==n.pending){if(u(e),0===e.avail_out)return n.last_flush=-1,A}else if(0===e.avail_in&&s(t)<=s(a)&&4!==t)return c(e,-5);if(666===n.status&&0!==e.avail_in)return c(e,-5);if(0!==e.avail_in||0!==n.lookahead||t!==w&&666!==n.status){var a=2===n.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(f(e),0===e.lookahead)){if(t===w)return 1;break}if(e.match_length=0,n=T._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(h(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(h(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?1:2}(n,t):3===n.strategy?function(e,t){for(var n,i,r,o,a=e.window;;){if(e.lookahead<=U){if(f(e),e.lookahead<=U&&t===w)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=k&&0<e.strstart&&((i=a[r=e.strstart-1])===a[++r]&&i===a[++r]&&i===a[++r])){for(o=e.strstart+U;i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&r<o;);e.match_length=U-(o-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=k?(n=T._tr_tally(e,1,e.match_length-k),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=T._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(h(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(h(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?1:2}(n,t):H[n.level].func(n,t);if(3!==a&&4!==a||(n.status=666),1===a||3===a)return 0===e.avail_out&&(n.last_flush=-1),A;if(2===a&&(1===t?T._tr_align(n):5!==t&&(T._tr_stored_block(n,0,0,!1),3===t&&(d(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),u(e),0===e.avail_out))return n.last_flush=-1,A}return 4!==t?A:n.wrap<=0?1:(2===n.wrap?(l(n,255&e.adler),l(n,e.adler>>8&255),l(n,e.adler>>16&255),l(n,e.adler>>24&255),l(n,255&e.total_in),l(n,e.total_in>>8&255),l(n,e.total_in>>16&255),l(n,e.total_in>>24&255)):(p(n,e.adler>>>16),p(n,65535&e.adler)),u(e),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?A:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==B&&69!==t&&73!==t&&91!==t&&103!==t&&t!==N&&666!==t?c(e,P):(e.state=null,t===N?c(e,-3):A):P},n.deflateSetDictionary=function(e,t){var n,i,r,o,a,s,c,u=t.length;if(!e||!e.state)return P;if(2===(o=(n=e.state).wrap)||1===o&&n.status!==B||n.lookahead)return P;for(1===o&&(e.adler=b(e.adler,t,u,0)),n.wrap=0,u>=n.w_size&&(0===o&&(d(n.head),n.strstart=0,n.block_start=0,n.insert=0),c=new S.Buf8(n.w_size),S.arraySet(c,t,u-n.w_size,n.w_size,0),t=c,u=n.w_size),a=e.avail_in,s=e.next_in,c=e.input,e.avail_in=u,e.next_in=0,e.input=t,f(n);n.lookahead>=k;){for(i=n.strstart,r=n.lookahead-(k-1);n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+k-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++,--r;);n.strstart=i,n.lookahead=k-1,f(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=k-1,n.match_available=0,e.next_in=s,e.input=c,e.avail_in=a,n.wrap=o,A},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":4,"./messages":6,"./trees":7}],6:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],7:[function(e,t,n){"use strict";function i(e){for(var t=e.length;0<=--t;)e[t]=0}function a(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function r(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function c(e){return e<256?D[e]:D[256+(e>>>7)]}function o(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function d(e,t,n){e.bi_valid>E-n?(e.bi_buf|=t<<e.bi_valid&65535,o(e,e.bi_buf),e.bi_buf=t>>E-e.bi_valid,e.bi_valid+=n-E):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function h(e,t,n){d(e,n[2*t],n[2*t+1])}function u(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function l(e,t,n){for(var i,r=new Array(16),o=0,a=1;a<=15;a++)r[a]=o=o+n[a-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=u(r[s]++,s))}}function s(e){for(var t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function p(e){8<e.bi_valid?o(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function f(e,t,n,i){var r=2*t,o=2*n;return e[r]<e[o]||e[r]===e[o]&&i[t]<=i[n]}function m(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&f(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!f(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i}function g(e,t,n){var i,r,o,a,s=0;if(0!==e.last_lit)for(;i=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],r=e.pending_buf[e.l_buf+s],s++,0==i?h(e,r,t):(h(e,(o=L[r])+256+1,t),0!==(a=y[o])&&d(e,r-=O[o],a),h(e,o=c(--i),n),0!==(a=w[o])&&d(e,i-=R[o],a)),s<e.last_lit;);h(e,256,t)}function _(e,g){var t,n,i,r=g.dyn_tree,o=g.stat_desc.static_tree,a=g.stat_desc.has_stree,s=g.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,t=0;t<s;t++)0!==r[2*t]?(e.heap[++e.heap_len]=c=t,e.depth[t]=0):r[2*t+1]=0;for(;e.heap_len<2;)r[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=o[2*i+1]);for(g.max_code=c,t=e.heap_len>>1;1<=t;t--)m(e,r,t);for(i=s;t=e.heap[1],e.heap[1]=e.heap[e.heap_len--],m(e,r,1),n=e.heap[1],e.heap[--e.heap_max]=t,e.heap[--e.heap_max]=n,r[2*i]=r[2*t]+r[2*n],e.depth[i]=(e.depth[t]>=e.depth[n]?e.depth[t]:e.depth[n])+1,r[2*t+1]=r[2*n+1]=i,e.heap[1]=i++,m(e,r,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e){for(var t,n,i,r,o,a=g.dyn_tree,s=g.max_code,c=g.stat_desc.static_tree,u=g.stat_desc.has_stree,d=g.stat_desc.extra_bits,h=g.stat_desc.extra_base,l=g.stat_desc.max_length,p=0,f=0;f<=15;f++)e.bl_count[f]=0;for(a[2*e.heap[e.heap_max]+1]=0,t=e.heap_max+1;t<573;t++)(f=a[2*a[2*(n=e.heap[t])+1]+1]+1)>l&&(f=l,p++),a[2*n+1]=f,s<n||(e.bl_count[f]++,r=0,h<=n&&(r=d[n-h]),o=a[2*n],e.opt_len+=o*(f+r),u&&(e.static_len+=o*(c[2*n+1]+r)));if(0!==p){do{for(f=l-1;0===e.bl_count[f];)f--}while(e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[l]--,0<(p-=2));for(f=l;0!==f;f--)for(n=e.bl_count[f];0!==n;)(i=e.heap[--t])>s||(a[2*i+1]!==f&&(e.opt_len+=(f-a[2*i+1])*a[2*i],a[2*i+1]=f),n--)}}(e),l(r,c,e.bl_count)}function v(e,t,n){var i,r,o=-1,a=t[1],s=0,c=7,u=4;for(0===a&&(c=138,u=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=a,a=t[2*(i+1)+1],++s<c&&r===a||(s<u?e.bl_tree[2*r]+=s:0!==r?(r!==o&&e.bl_tree[2*r]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=r,u=(s=0)===a?(c=138,3):r===a?(c=6,3):(c=7,4))}function S(e,t,n){var i,r,o=-1,a=t[1],s=0,c=7,u=4;for(0===a&&(c=138,u=3),i=0;i<=n;i++)if(r=a,a=t[2*(i+1)+1],!(++s<c&&r===a)){if(s<u)for(;h(e,r,e.bl_tree),0!=--s;);else 0!==r?(r!==o&&(h(e,r,e.bl_tree),s--),h(e,16,e.bl_tree),d(e,s-3,2)):s<=10?(h(e,17,e.bl_tree),d(e,s-3,3)):(h(e,18,e.bl_tree),d(e,s-11,7));o=r,u=(s=0)===a?(c=138,3):r===a?(c=6,3):(c=7,4)}}function T(e,t,n,i){d(e,0+(i?1:0),3),t=t,n=n,p(e=e),o(e,n),o(e,~n),b.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}var b=e("../utils/common"),E=16,y=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],w=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],I=new Array(576);i(I);var C=new Array(60);i(C);var D=new Array(512);i(D);var L=new Array(256);i(L);var O=new Array(29);i(O);var R=new Array(30);i(R);var M,k,U,x=!1;n._tr_init=function(e){x||(function(){for(var e,t,n,i=new Array(16),r=0,o=0;o<28;o++)for(O[o]=r,e=0;e<1<<y[o];e++)L[r++]=o;for(L[r-1]=o,o=n=0;o<16;o++)for(R[o]=n,e=0;e<1<<w[o];e++)D[n++]=o;for(n>>=7;o<30;o++)for(R[o]=n<<7,e=0;e<1<<w[o]-7;e++)D[256+n++]=o;for(t=0;t<=15;t++)i[t]=0;for(e=0;e<=143;)I[2*e+1]=8,e++,i[8]++;for(;e<=255;)I[2*e+1]=9,e++,i[9]++;for(;e<=279;)I[2*e+1]=7,e++,i[7]++;for(;e<=287;)I[2*e+1]=8,e++,i[8]++;for(l(I,287,i),e=0;e<30;e++)C[2*e+1]=5,C[2*e]=u(e,5);M=new a(I,y,257,286,15),k=new a(C,w,0,30,15),U=new a(new Array(0),A,0,19,7)}(),x=!0),e.l_desc=new r(e.dyn_ltree,M),e.d_desc=new r(e.dyn_dtree,k),e.bl_desc=new r(e.bl_tree,U),e.bi_buf=0,e.bi_valid=0,s(e)},n._tr_stored_block=T,n._tr_flush_block=function(e,t,n,i){var r,o,a=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){for(var t=4093624447,n=0;n<=31;n++,t>>>=1)if(1&t&&0!==e.dyn_ltree[2*n])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(n=32;n<256;n++)if(0!==e.dyn_ltree[2*n])return 1;return 0}(e)),_(e,e.l_desc),_(e,e.d_desc),a=function(e){var t;for(v(e,e.dyn_ltree,e.l_desc.max_code),v(e,e.dyn_dtree,e.d_desc.max_code),_(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*P[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),r=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=r&&(r=o)):r=o=n+5,n+4<=r&&-1!==t?T(e,t,n,i):4===e.strategy||o===r?(d(e,2+(i?1:0),3),g(e,I,C)):(d(e,4+(i?1:0),3),function(e,t,n,i){var r;for(d(e,t-257,5),d(e,n-1,5),d(e,i-4,4),r=0;r<i;r++)d(e,e.bl_tree[2*P[r]+1],3);S(e,e.dyn_ltree,t-1),S(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),g(e,e.dyn_ltree,e.dyn_dtree)),s(e),i&&p(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(L[n]+256+1)]++,e.dyn_dtree[2*c(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){d(e,2,3),h(e,256,I),16===(e=e).bi_valid?(o(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}},{"../utils/common":1}],8:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/lib/deflate.js":[function(e,t,n){"use strict";function i(e){if(!(this instanceof i))return new i(e);this.options=s.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;e=a.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==e)throw new Error(o[e]);if(t.header&&a.deflateSetHeader(this.strm,t.header),t.dictionary){t="string"==typeof t.dictionary?c.string2buf(t.dictionary):"[object ArrayBuffer]"===d.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary;if(0!==(e=a.deflateSetDictionary(this.strm,t)))throw new Error(o[e]);this._dict_set=!0}}function r(e,t){t=new i(t);if(t.push(e,!0),t.err)throw t.msg||o[t.err];return t.result}var a=e("./zlib/deflate"),s=e("./utils/common"),c=e("./utils/strings"),o=e("./zlib/messages"),u=e("./zlib/zstream"),d=Object.prototype.toString;i.prototype.push=function(e,t){var n,i,r=this.strm,o=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:!0===t?4:0,"string"==typeof e?r.input=c.string2buf(e):"[object ArrayBuffer]"===d.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=new s.Buf8(o),r.next_out=0,r.avail_out=o),1!==(n=a.deflate(r,i))&&0!==n)return this.onEnd(n),!(this.ended=!0)}while(0!==r.avail_out&&(0!==r.avail_in||4!==i&&2!==i)||("string"===this.options.to?this.onData(c.buf2binstring(s.shrinkBuf(r.output,r.next_out))):this.onData(s.shrinkBuf(r.output,r.next_out))),(0<r.avail_in||0===r.avail_out)&&1!==n);return 4===i?(n=a.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==i||(this.onEnd(0),!(r.avail_out=0))},i.prototype.onData=function(e){this.chunks.push(e)},i.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=i,n.deflate=r,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,r(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,r(e,t)}},{"./utils/common":1,"./utils/strings":2,"./zlib/deflate":5,"./zlib/messages":6,"./zlib/zstream":8}]},{},[])("/lib/deflate.js"),_securedTouchDependencies.evaluateModernizr=function(){!function(e,l,d,p){function s(e,t){return typeof e===t}function f(e){return"function"!=typeof d.createElement?d.createElement(e):b?d.createElementNS.call(d,"http://www.w3.org/2000/svg",e):d.createElement.apply(d,arguments)}function g(e,t,n,i){var r,o,a,s="modernizr",c=f("div"),u=((a=d.body)||((a=f(b?"svg":"body")).fake=!0),a);if(parseInt(n,10))for(;n--;)(r=f("div")).id=i?i[n]:s+(n+1),c.appendChild(r);return(a=f("style")).type="text/css",a.id="s"+s,(u.fake?u:c).appendChild(a),u.appendChild(c),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(d.createTextNode(e)),c.id=s,u.fake&&(u.style.background="",u.style.overflow="hidden",o=T.style.overflow,T.style.overflow="hidden",T.appendChild(u)),e=t(c,e),u.fake?(u.parentNode.removeChild(u),T.style.overflow=o,T.offsetHeight):c.parentNode.removeChild(c),!!e}function m(e){return e.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()}).replace(/^ms-/,"-ms-")}function _(e,t,n){var i,r;return"getComputedStyle"in l?(i=getComputedStyle.call(l,e,t),r=l.console,null!==i?n&&(i=i.getPropertyValue(n)):r&&r[r.error?"error":"log"].call(r,"getComputedStyle returning null, its possible modernizr test results are inaccurate")):i=!t&&e.currentStyle&&e.currentStyle[n],i}function v(e){return e.replace(/([a-z])-([a-z])/g,function(e,t,n){return t+n.toUpperCase()}).replace(/^-/,"")}function c(e,t,n,i){function r(){a&&(delete w.style,delete w.modElem)}if(i=!(void 0===i)&&i,void 0!==n){var o=function(e,t){var n=e.length;if("CSS"in l&&"supports"in l.CSS){for(;n--;)if(l.CSS.supports(m(e[n]),t))return!0;return!1}if("CSSSupportsRule"in l){for(var i=[];n--;)i.push("("+m(e[n])+":"+t+")");return g("@supports ("+(i=i.join(" or "))+") { #modernizr { position: absolute; } }",function(e){return"absolute"===_(e,null,"position")})}return p}(e,n);if(void 0!==o)return o}for(var a,s,c,u,d,h=["modernizr","tspan","samp"];!w.style&&h.length;)a=!0,w.modElem=f(h.shift()),w.style=w.modElem.style;for(c=e.length,s=0;s<c;s++)if(u=e[s],d=w.style[u],~(""+u).indexOf("-")&&(u=v(u)),w.style[u]!==p){if(i||void 0===n)return r(),"pfx"!==t||u;try{w.style[u]=n}catch(e){}if(w.style[u]!==d)return r(),"pfx"!==t||u}return r(),!1}function i(e,t,n,i,r){var o=e.charAt(0).toUpperCase()+e.slice(1),a=(e+" "+E.join(o+" ")+o).split(" ");return s(t,"string")||void 0===t?c(a,t,i,r):function(e,t,n){var i,r;for(r in e)if(e[r]in t)return!1===n?e[r]:s(i=t[e[r]],"function")?function(e,t){return function(){return e.apply(t,arguments)}}(i,n||t):i;return!1}(a=(e+" "+A.join(o+" ")+o).split(" "),t,n)}function t(e,t,n){return i(e,p,p,t,n)}var u=[],n={_version:"3.11.1",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){u.push({name:e,fn:t,options:n})},addAsyncTest:function(e){u.push({name:null,fn:e})}};(h=function(){}).prototype=n;var r,h=new h,S=[],T=d.documentElement,b="svg"===T.nodeName.toLowerCase(),o=(r=!("onblur"in T),function(e,t){var n;return!!e&&(!(n=(e="on"+e)in(t=!t||"string"==typeof t?f(t||"div"):t))&&r&&((t=!t.setAttribute?f("div"):t).setAttribute(e,""),n="function"==typeof t[e],t[e]!==p&&(t[e]=p),t.removeAttribute(e)),n)});n.hasEvent=o,h.addTest("ambientlight",o("devicelight",l)),h.addTest("applicationcache","applicationCache"in l),function(){var t=f("audio");h.addTest("audio",function(){var e=!1;try{(e=!!t.canPlayType)&&(e=new Boolean(e))}catch(e){}return e});try{t.canPlayType&&(h.addTest("audio.ogg",t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")),h.addTest("audio.mp3",t.canPlayType('audio/mpeg; codecs="mp3"').replace(/^no$/,"")),h.addTest("audio.opus",t.canPlayType('audio/ogg; codecs="opus"')||t.canPlayType('audio/webm; codecs="opus"').replace(/^no$/,"")),h.addTest("audio.wav",t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")),h.addTest("audio.m4a",(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,"")))}catch(t){}}();var a="Moz O ms Webkit",E=n._config.usePrefixes?a.split(" "):[];n._cssomPrefixes=E;var y={elem:f("modernizr")};h._q.push(function(){delete y.elem});var w={style:y.elem.style};h._q.unshift(function(){delete w.style});var A=n._config.usePrefixes?a.toLowerCase().split(" "):[];n._domPrefixes=A,n.testAllProps=i;function P(e){var t,n=D.length,i=l.CSSRule;if(void 0===i)return p;if(!e)return!1;if((t=(e=e.replace(/^@/,"")).replace(/-/g,"_").toUpperCase()+"_RULE")in i)return"@"+e;for(var r=0;r<n;r++){var o=D[r];if(o.toUpperCase()+"_"+t in i)return"@-"+o.toLowerCase()+"-"+e}return!1}n.atRule=P;var I=n.prefixed=function(e,t,n){return 0===e.indexOf("@")?P(e):(-1!==e.indexOf("-")&&(e=v(e)),t?i(e,t,n):i(e,"pfx"))};h.addTest("batteryapi",!!I("battery",navigator)||!!I("getBattery",navigator),{aliases:["battery-api"]}),h.addTest("blobconstructor",function(){try{return!!new Blob}catch(e){return!1}},{aliases:["blob-constructor"]}),h.addTest("contextmenu","contextMenu"in T&&"HTMLMenuItemElement"in l),h.addTest("cors","XMLHttpRequest"in l&&"withCredentials"in new XMLHttpRequest);a=I("crypto",l);h.addTest("crypto",!!I("subtle",a)),h.addTest("customelements","customElements"in l),h.addTest("customprotocolhandler",function(){if(!navigator.registerProtocolHandler)return!1;try{navigator.registerProtocolHandler("thisShouldFail")}catch(e){return e instanceof TypeError}return!1}),h.addTest("customevent","CustomEvent"in l&&"function"==typeof l.CustomEvent),h.addTest("dart",!!I("startDart",navigator)),h.addTest("dataview","undefined"!=typeof DataView&&"getFloat64"in DataView.prototype),h.addTest("eventlistener","addEventListener"in l),h.addTest("forcetouch",function(){return!!o(I("mouseforcewillbegin",l,!1),l)&&MouseEvent.WEBKIT_FORCE_AT_MOUSE_DOWN&&MouseEvent.WEBKIT_FORCE_AT_FORCE_MOUSE_DOWN}),h.addTest("fullscreen",!(!I("exitFullscreen",d,!1)&&!I("cancelFullScreen",d,!1))),h.addTest("gamepads",!!I("getGamepads",navigator)),h.addTest("geolocation","geolocation"in navigator),h.addTest("ie8compat",!l.addEventListener&&!!d.documentMode&&7===d.documentMode),h.addTest("intl",!!I("Intl",l)),h.addTest("json","JSON"in l&&"parse"in JSON&&"stringify"in JSON),n.testAllProps=t,h.addTest("ligatures",t("fontFeatureSettings",'"liga" 1')),h.addTest("messagechannel","MessageChannel"in l),h.addTest("notification",function(){if(!l.Notification||!l.Notification.requestPermission)return!1;if("granted"===l.Notification.permission)return!0;try{new l.Notification("")}catch(e){if("TypeError"===e.name)return!1}return!0}),h.addTest("pagevisibility",!!I("hidden",d,!1)),h.addTest("performance",!!I("performance",l));var C=[""].concat(A);n._domPrefixesAll=C,h.addTest("pointerevents",function(){for(var e=0,t=C.length;e<t;e++)if(o(C[e]+"pointerdown"))return!0;return!1}),h.addTest("pointerlock",!!I("exitPointerLock",d)),h.addTest("queryselector","querySelector"in d&&"querySelectorAll"in d),h.addTest("quotamanagement",function(){var e=I("temporaryStorage",navigator),t=I("persistentStorage",navigator);return!(!e||!t)}),h.addTest("requestanimationframe",!!I("requestAnimationFrame",l),{aliases:["raf"]}),h.addTest("serviceworker","serviceWorker"in navigator);var D=n._config.usePrefixes?" -webkit- -moz- -o- -ms- ".split(" "):["",""];n._prefixes=D;var L,O=(L=l.matchMedia||l.msMatchMedia)?function(e){e=L(e);return e&&e.matches||!1}:function(e){var t=!1;return g("@media "+e+" { #modernizr { position: absolute; } }",function(e){t="absolute"===_(e,null,"position")}),t};n.mq=O,h.addTest("touchevents",function(){if("ontouchstart"in l||l.TouchEvent||l.DocumentTouch&&d instanceof DocumentTouch)return!0;var e=["(",D.join("touch-enabled),("),"heartz",")"].join("");return O(e)}),h.addTest("typedarrays","ArrayBuffer"in l),h.addTest("vibrate",!!I("vibrate",navigator)),function(){var t=f("video");h.addTest("video",function(){var e=!1;try{(e=!!t.canPlayType)&&(e=new Boolean(e))}catch(e){}return e});try{t.canPlayType&&(h.addTest("video.ogg",t.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")),h.addTest("video.h264",t.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")),h.addTest("video.h265",t.canPlayType('video/mp4; codecs="hev1"').replace(/^no$/,"")),h.addTest("video.webm",t.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")),h.addTest("video.vp9",t.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,"")),h.addTest("video.hls",t.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")),h.addTest("video.av1",t.canPlayType('video/mp4; codecs="av01"').replace(/^no$/,"")))}catch(t){}}(),h.addTest("webgl",function(){return"WebGLRenderingContext"in l});a=!1;try{a="WebSocket"in l&&2===l.WebSocket.CLOSING}catch(e){}h.addTest("websockets",a),h.addTest("xdomainrequest","XDomainRequest"in l),h.addTest("matchmedia",!!I("matchMedia",l)),function(){var e,t,n,i,r,o,a;for(a in u)if(u.hasOwnProperty(a)){if(e=[],(t=u[a]).name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(i=s(t.fn,"function")?t.fn():t.fn,r=0;r<e.length;r++)1===(o=e[r].split(".")).length?h[o[0]]=i:(h[o[0]]&&(!h[o[0]]||h[o[0]]instanceof Boolean)||(h[o[0]]=new Boolean(h[o[0]])),h[o[0]][o[1]]=i),S.push((i?"":"no-")+o.join("-"))}}(),delete n.addTest,delete n.addAsyncTest;for(var R=0;R<h._q.length;R++)h._q[R]();e.Modernizr=h}(_securedTouchDependencies,window,document)};var __awaiter=this&&this.__awaiter||function(o,a,s,c){return new(s=s||Promise)(function(e,t){function n(e){try{r(c.next(e))}catch(e){t(e)}}function i(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,i)}r((c=c.apply(o,a||[])).next())})},__generator=this&&this.__generator||function(n,i){var r,o,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],o=0}finally{r=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},__extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities,_securedTouchEntities;!function(e){(e=e.GestureType||(e.GestureType={}))[e.Unknown=0]="Unknown",e[e.FlingRight=1]="FlingRight",e[e.FlingLeft=2]="FlingLeft",e[e.FlingUp=3]="FlingUp",e[e.FlingDown=4]="FlingDown",e[e.Diagonal=5]="Diagonal",e[e.ScrollRight=6]="ScrollRight",e[e.ScrollLeft=7]="ScrollLeft",e[e.ScrollUp=8]="ScrollUp",e[e.ScrollDown=9]="ScrollDown",e[e.Tap=10]="Tap",e[e.DoubleTap=11]="DoubleTap"}(_securedTouchEntities=_securedTouchEntities||{}),function(e){var t=(Object.defineProperty(i,"isLogEnabled",{get:function(){return this._isLogEnabled||window["enable-logs-securedtouch"]},set:function(e){this._isLogEnabled=e},enumerable:!0,configurable:!0}),i.debug=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e="[WebSDK] "+e,i.isLogEnabled&&(t&&0<t.length?console.debug?console.debug(e,t):console.log(e,t):console.debug?console.debug(e):console.log(e))},i.error=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e="[WebSDK] "+e,i.isLogEnabled&&(t&&0<t.length?console.error(e,t):console.error(e))},i.warn=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e="[WebSDK] "+e,i.isLogEnabled&&(t&&0<t.length?console.warn(e,t):console.warn(e))},i.info=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e="[WebSDK] "+e,i.isLogEnabled&&(t&&0<t.length?console.info(e,t):console.info(e))},i);function i(){}e.STLogger=t}(_securedTouchEntities=_securedTouchEntities||{}),function(e){var t=(Object.defineProperty(n,"CLIENT_VERSION",{get:function(){return"3.8.1w"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SALT",{get:function(){return"ST8irbd3bB"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"WINDOW_ID_KEY",{get:function(){return"SecuredTouchWindowId"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"OPS_KEY",{get:function(){return"Ops"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"WEB_GL_KEY",{get:function(){return"WebGlId"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"APP_SECRET_KEY",{get:function(){return"QXBwU2VjcmV0"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"INIT_PARAMS_KEY",{get:function(){return"SecuredTouchInitParams"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"INIT_PARAMS_KEY_V2",{get:function(){return"SecuredTouchPointerParams"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"INIT_PARAMS_TS_KEY",{get:function(){return"SecuredTouchInitParamsTS"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"INIT_PARAMS_TTL_KEY",{get:function(){return"SecuredTouchInitParamsTTL"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"ST_INIT_KEY",{get:function(){return"SecuredTouchInitST"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"TOTAL_GESTURE_COUNTER_KEY",{get:function(){return"SecuredTouchTotalGestureCounter"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"APP_SESSION_ID_KEY",{get:function(){return"SecuredTouchAppSessionId"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"LAST_DISPOSED_PAYLOAD_KEY",{get:function(){return"SecuredTouchDisposedPayload"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"LAST_DISPOSED_TS_KEY",{get:function(){return"SecuredTouchDisposedTimestamp"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"DEVICE_CREDENTIALS_KEY",{get:function(){return"U2VjdXJlZFRvdWNoRGV2aWNlU2VjcmV0"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"DEVICE_ID_KEY",{get:function(){return"SecuredTouchDeviceId"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"REMOTE_LOG_ENABLED_KEY",{get:function(){return"SecuredTouchRemoteLogEnabled"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"USER_ID_KEY",{get:function(){return"SecuredTouchUserId"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"USER_ID_TS_KEY",{get:function(){return"SecuredTouchUserIdTs"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"CAPTURED_KEYBOARD_INTERACTIONS",{get:function(){return"SecuredTouchCapturedKeyboard"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"CAPTURED_MOUSE_INTERACTIONS",{get:function(){return"SecuredTouchCapturedMouse"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"CAPTURED_GESTURES",{get:function(){return"SecuredTouchCapturedGestures"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"CAPTURED_INDIRECT",{get:function(){return"SecuredTouchCapturedIndirect"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"CANCELED_INTERACTIONS",{get:function(){return"SecuredTouchCanceledInteractions"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"CANCELED_GESTURES",{get:function(){return"SecuredTouchCanceledGestures"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SESSION_STORAGE_UPDATE_TS",{get:function(){return"SecuredTouchBufferPushedTs"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SESSION_STORAGE_TTL_MILLIS",{get:function(){return 1e4},enumerable:!0,configurable:!0}),Object.defineProperty(n,"METADATA_TTL_MILLIS",{get:function(){return 5184e5},enumerable:!0,configurable:!0}),Object.defineProperty(n,"HEART_BEAT_TAG",{get:function(){return"HeartBeat"},enumerable:!0,configurable:!0}),n);function n(){}e.SecuredTouchConstants=t}(_securedTouchEntities=_securedTouchEntities||{}),function(r){var e=(u.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},u.makeId=function(e){for(var t="",n="abcdefghijklmnopqrstuvwxyz".length,i=0;i<e;i++)t+="abcdefghijklmnopqrstuvwxyz".charAt(Math.floor(Math.random()*n));return t},u.ieFix=function(){(-1!=navigator.userAgent.indexOf("MSIE")?/MSIE (\d+\.\d+);/:/Trident.*rv[ :]*(\d+\.\d+)/).test(navigator.userAgent)&&(document.body.setAttribute("style","-ms-touch-action:none;"),document.body.style.touchAction="none",document.body.style.msTouchAction="none")},u.now=function(){var e=window.performance||{};return e.now=e.now||e.webkitNow||e.msNow||e.oNow||e.mozNow||function(){return(new Date).getTime()},e.now()},Object.defineProperty(u,"isMobile",{get:function(){var e=!1,t=navigator.userAgent||navigator.vendor||window.opera;return e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))?!0:e},enumerable:!0,configurable:!0}),u.encodeBase64=function(e){var t,n,i,r,o,a,s="",c=0;for(e=u.utf8Encode(e);c<e.length;)i=(a=e.charCodeAt(c++))>>2,r=(3&a)<<4|(t=e.charCodeAt(c++))>>4,o=(15&t)<<2|(n=e.charCodeAt(c++))>>6,a=63&n,isNaN(t)?o=a=64:isNaN(n)&&(a=64),s=s+u.keyStr.charAt(i)+u.keyStr.charAt(r)+u.keyStr.charAt(o)+u.keyStr.charAt(a);return s},u.utf8Encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t+=String.fromCharCode(i):(127<i&&i<2048?t+=String.fromCharCode(i>>6|192):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128)),t+=String.fromCharCode(63&i|128))}return t},u.hash=function(e){var t=u.hashCache.get(e);return t||(t=_securedTouchDependencies.sha256(e+r.SecuredTouchConstants.SALT),u.hashCache.set(e,t)),t},u.utf8Decode=function(e){for(var t,n,i="",r=0,o=0;r<e.length;)(t=e.charCodeAt(r))<128?(i+=String.fromCharCode(t),r++):191<t&&t<224?(o=e.charCodeAt(r+1),i+=String.fromCharCode((31&t)<<6|63&o),r+=2):(o=e.charCodeAt(r+1),n=e.charCodeAt(r+2),i+=String.fromCharCode((15&t)<<12|(63&o)<<6|63&n),r+=3);return i},u.decodeBase64=function(e){var t,n,i,r,o,a="",s=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");s<e.length;)t=u.keyStr.indexOf(e.charAt(s++))<<2|(i=u.keyStr.indexOf(e.charAt(s++)))>>4,n=(15&i)<<4|(r=u.keyStr.indexOf(e.charAt(s++)))>>2,i=(3&r)<<6|(o=u.keyStr.indexOf(e.charAt(s++))),a+=String.fromCharCode(t),64!=r&&(a+=String.fromCharCode(n)),64!=o&&(a+=String.fromCharCode(i));return u.utf8Decode(a)},u.hashCode=function(e){var t=0,n=e?e.length:0,i=0;if(0<n)for(;i<n;)t=(t<<5)-t+e.charCodeAt(i++)|0;return t},u.mod=function(e,t){return(u.hashCode(e)%t+t)%t},u.isEmail=function(e){try{return e&&/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.toLowerCase())}catch(e){return r.STLogger.warn("isEmail function failed to parse string",e),!1}},u.getEmailDomain=function(e){return u.isEmail(e)?e.substring(e.lastIndexOf("@")+1):""},u.extractEnv=function(e){var t=e.indexOf("://");0<t&&(t+="://".length);var n=e.indexOf(".securedtouch.com");return e.substring(t,n)},u.extendPrimitiveValues=function(e,t,n){for(var i=u.allKeys(t),r=0;r<i.length;)u.isObject(t[i[r]])||n&&(!n||void 0!==e[i[r]])||(e[i[r]]=t[i[r]]),r++;return e},u.extend=function(e,t,n){for(var i=u.allKeys(t),r=0;r<i.length;)n&&void 0!==e[i[r]]||(e[i[r]]=t[i[r]]),r++;return e},u.flatten=function(e){var t={};return u.dive("",e,t),t},u.dive=function(e,t,n){for(var i in t){var r,o;t.hasOwnProperty(i)&&(o=t[r=i],0<e.length&&(r=e+"."+i),u.isObject(o)?u.dive(r,o,n):n[r]=o)}},u.isObject=function(e){var t=typeof e;return"function"==t||"object"==t&&!!e},u.isFunction=function(e){return e&&"function"==typeof e},u.isPassiveSupported=function(){function e(){}var t=!1;try{var n={get passive(){return t=!0}};window.addEventListener("test",e,n),window.removeEventListener("test",e,!1)}catch(e){t=!1}return t},u.getAttribute=function(e,t){try{if(e&&this.isFunction(e.getAttribute))return e.getAttribute(t)||""}catch(e){}return""},u.createInvisibleElement=function(e){try{var t=document.createElement(e);return t.style.display="none",t.style.border="none",t.style.position="absolute",t.style.top="-999px",t.style.left="-999px",t.style.width="0",t.style.height="0",t.style.visibility="hidden",t}catch(e){return r.STLogger.warn("Failed to create element",e),null}},u.allKeys=function(e){if(!u.isObject(e))return[];var t,n=[];for(t in e)n.push(t);return n},u.values=function(e){for(var t=u.allKeys(e),n=t.length,i=Array(n),r=0;r<n;r++)i[r]=e[t[r]];return i},u.modifiersKeys=function(t){var n=[];return t.getModifierState&&["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Hyper","Meta","NumLock","OS","ScrollLock","Shift","Super","Symbol","SymbolLock"].forEach(function(e){t.getModifierState(e.toString())&&n.push(e)}),n},u.getKeyboardEvent=function(e){return e||window.event},u.getSrcElement=function(e){return e.srcElement||e.target},u.getObjectType=function(e){try{var t=/function (.{1,})\(/.exec(e.constructor.toString());return t&&1<t.length?t[1]:""}catch(e){return""}},u.isSelectorMatches=function(e,t,n){try{var i=Element.prototype,r=i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.msMatchesSelector,o=0;do{if(r.call(e,t))return!0}while(null!==(e=e.parentElement||e.parentNode)&&1===e.nodeType&&o++<n);return!1}catch(e){return!1}},u.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},u.safeJsonParse=function(e){var t=null;try{e&&(t=JSON.parse(e))}catch(e){r.STLogger.warn("Failed to parse object "+e),t=null}return t},u.getElementSelectionStart=function(e){var t;try{t=e.selectionStart}catch(e){t=""}return t},u.getElementSelectionEnd=function(e){var t;try{t=e.selectionEnd}catch(e){t=""}return t},u.getDeviceOrientation=function(){var e=screen.orientation||screen.mozOrientation||{},t=screen.msOrientation||e.type,e=e.angle;return{orientation:t?t.toString():"",angle:null!=e?e.toString():""}},u.getCurrentLocationUrl=function(){return r.SecuredTouchPointerConfig.instance.sendLocation?window.location.href:""},u.getCookie=function(e){e=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return e?e[2]:null},u.setCookie=function(e,t,n){var i=new Date;i.setTime(i.getTime()+1e3*n),document.cookie=e+"="+t+";path=/;secure;expires="+i.toUTCString()},u.deleteCookie=function(e){u.setCookie(e,"",-1)},u.delay=function(t){return new Promise(function(e){return setTimeout(e,t)})},u.addEventListener=function(e,t,n,i){r.SecuredTouchPointerConfig.instance.eventsBlackList.has(t)||e.addEventListener(t,n,i)},u.getErrorAsString=function(t){var n;if(t)try{n="string"==typeof t||t instanceof String?t:t instanceof Error?t.toString():JSON.stringify(t)}catch(e){n=t.toString()}return n||""},u.getHostnameFromRegex=function(e){if(e){e=e.match(/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i);return e&&e[1]}return null},u.inIframe=function(){try{return window.self!==window.top}catch(e){return!0}},u.promiseTimeout=function(i,e){var t=new Promise(function(e,t){var n=setTimeout(function(){clearTimeout(n),t("Timed out in "+i+"ms.")},i)});return Promise.race([e,t])},u.hashCache=new Map,u.hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),u.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u);function u(){}r.SecuredTouchUtil=e}(_securedTouchEntities=_securedTouchEntities||{}),function(i){var e=(t.prototype.get=function(e){e=i.SecuredTouchUtil.hash(e);return this.crossStorageClient.get(e)},t.prototype.del=function(e){return this.crossStorageClient.del(i.SecuredTouchUtil.hash(e))},t.prototype.set=function(e,t,n){return this.crossStorageClient.set(i.SecuredTouchUtil.hash(e),t,n)},t.prototype.onConnect=function(){return this.crossStorageClient.onConnect()},t);function t(e,t){this.crossStorageClient=new CrossStorageClient(e,t)}i.SecuredTouchCrossStorage=e;n.prototype.get=function(e){return Promise.resolve(this.storage.getItem(e))},n.prototype.del=function(e){return this.storage.removeItem(e),Promise.resolve()},n.prototype.set=function(e,t){return this.storage.setItem(e,t),Promise.resolve()},n.prototype.onConnect=function(){return Promise.resolve()},e=n;function n(e){this.storage=e}i.SecuredTouchCrossStorageFallback=e}(_securedTouchEntities=_securedTouchEntities||{}),function(i){var e=(t.prototype.getItem=function(e){var t=i.SecuredTouchUtil.hash(e),n=this.storage.getItem(t);return n||(n=this.storage.getItem(e))&&(this.storage.setItem(t,n),this.storage.removeItem(e)),n},t.prototype.removeItem=function(e){return this.storage.removeItem(i.SecuredTouchUtil.hash(e))},t.prototype.setItem=function(e,t){return this.storage.setItem(i.SecuredTouchUtil.hash(e),t)},t);function t(e){this.storage=e}i.SecuredTouchStorageWrapper=e;n.prototype.getItem=function(e){return this.internalStorageMap.get(e)},n.prototype.removeItem=function(e){this.internalStorageMap.delete(e)},n.prototype.setItem=function(e,t){this.internalStorageMap.set(e,t)},e=n;function n(){this.internalStorageMap=new Map}i.SecuredTouchStorageFallback=e}(_securedTouchEntities=_securedTouchEntities||{}),function(r){var e=(Object.defineProperty(t,"instance",{get:function(){return t._instance=!t._instance?new t:t._instance},enumerable:!0,configurable:!0}),t.prototype.initDeviceStorage=function(n){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return(t={deviceId:this.stLocalStorage.getItem(r.SecuredTouchConstants.DEVICE_ID_KEY),deviceSecret:this.stLocalStorage.getItem(r.SecuredTouchConstants.DEVICE_CREDENTIALS_KEY)}).deviceId?(this.cachedDeviceId=t.deviceId,this.cachedDeviceSecret=t.deviceSecret||r.SecuredTouchUtil.hash(t.deviceId),this.crossStorage=new r.SecuredTouchCrossStorageFallback(this.stLocalStorage),[3,3]):[3,1];case 1:return[4,this.initCrossStorage(n)];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.initCrossStorage=function(i){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(e){switch(e.label){case 0:if(t=i||"https://hub.securedtouch.com/hub.html",this.crossStorage)return[3,6];e.label=1;case 1:return e.trys.push([1,4,,5]),this.crossStorage=new r.SecuredTouchCrossStorage(t,{timeout:1e4}),[4,this.crossStorage.onConnect()];case 2:return e.sent(),[4,Promise.all([this.crossStorage.get(r.SecuredTouchConstants.DEVICE_ID_KEY),this.crossStorage.get(r.SecuredTouchConstants.DEVICE_CREDENTIALS_KEY).catch(function(e){})])];case 3:return n=e.sent(),this.cachedDeviceId=n[0],this.cachedDeviceSecret=n[1],this.cachedDeviceId&&this.stLocalStorage.setItem(r.SecuredTouchConstants.DEVICE_ID_KEY,this.cachedDeviceId),this.cachedDeviceSecret&&this.stLocalStorage.setItem(r.SecuredTouchConstants.DEVICE_CREDENTIALS_KEY,this.cachedDeviceSecret),[3,5];case 4:return n=e.sent(),r.STLogger.warn("SecuredTouchSession crossStorage failed to connect "+n),this.crossStorage=new r.SecuredTouchCrossStorageFallback(this.stLocalStorage),[3,5];case 5:this.cachedDeviceId&&!this.cachedDeviceSecret&&(this.cachedDeviceSecret=r.SecuredTouchUtil.hash(this.cachedDeviceId)),e.label=6;case 6:return[2]}})})},Object.defineProperty(t.prototype,"windowId",{get:function(){return this.cachedWindowId||(this.cachedWindowId=this.stSessionStorage.getItem(r.SecuredTouchConstants.WINDOW_ID_KEY),this.cachedWindowId||(this.cachedWindowId=r.SecuredTouchUtil.newGuid(),this.stSessionStorage.setItem(r.SecuredTouchConstants.WINDOW_ID_KEY,this.cachedWindowId))),this.cachedWindowId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sessionStorage",{get:function(){return this.stSessionStorage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localStorage",{get:function(){return this.stLocalStorage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ops",{get:function(){var e=Number(this.stSessionStorage.getItem(r.SecuredTouchConstants.OPS_KEY));return isNaN(e)?null:e},set:function(e){e?this.stSessionStorage.setItem(r.SecuredTouchConstants.OPS_KEY,e.toString()):this.stSessionStorage.removeItem(r.SecuredTouchConstants.OPS_KEY)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"webGlID",{get:function(){return this.stSessionStorage.getItem(r.SecuredTouchConstants.WEB_GL_KEY)},set:function(e){e?this.stSessionStorage.setItem(r.SecuredTouchConstants.WEB_GL_KEY,e):this.stSessionStorage.removeItem(r.SecuredTouchConstants.WEB_GL_KEY)},enumerable:!0,configurable:!0}),t.prototype.getInitParamsTTLInMinutes=function(e){var t=r.SecuredTouchUtil.hash(r.SecuredTouchConstants.INIT_PARAMS_TTL_KEY+"-"+this.appId);return Number(this.stLocalStorage.getItem(t))||e},Object.defineProperty(t.prototype,"lastInitParamsTs",{get:function(){var e=r.SecuredTouchUtil.hash(r.SecuredTouchConstants.INIT_PARAMS_TS_KEY+"-"+this.appId);return Number(this.stLocalStorage.getItem(e))||0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"initParams",{get:function(){var e=r.SecuredTouchUtil.hash(r.SecuredTouchConstants.INIT_PARAMS_KEY_V2+"-"+this.appId),t=this.stLocalStorage.getItem(e);try{return t?JSON.parse(t):null}catch(e){return r.STLogger.debug("SecuredTouchSession FAILED to deserialize initParams!"),null}},enumerable:!0,configurable:!0}),t.prototype.setInitParams=function(e,t){var n=e?JSON.stringify(e):null,e=r.SecuredTouchUtil.hash(r.SecuredTouchConstants.INIT_PARAMS_KEY_V2+"-"+this.appId);this.stLocalStorage.setItem(e,n);n=r.SecuredTouchUtil.hash(r.SecuredTouchConstants.INIT_PARAMS_TS_KEY+"-"+this.appId);this.stLocalStorage.setItem(n,(new Date).getTime());n=r.SecuredTouchUtil.hash(r.SecuredTouchConstants.INIT_PARAMS_TTL_KEY+"-"+this.appId);this.stLocalStorage.setItem(n,t)},t.prototype.removeInitParams=function(){var e=r.SecuredTouchUtil.hash(r.SecuredTouchConstants.INIT_PARAMS_KEY+"-"+this.appId),t=r.SecuredTouchUtil.hash(r.SecuredTouchConstants.INIT_PARAMS_KEY_V2+"-"+this.appId);this.stLocalStorage.removeItem(e),this.stLocalStorage.removeItem(t)},Object.defineProperty(t.prototype,"initST",{get:function(){return Boolean(this.stSessionStorage.getItem(r.SecuredTouchConstants.ST_INIT_KEY))},set:function(e){this.stSessionStorage.setItem(r.SecuredTouchConstants.ST_INIT_KEY,e.toString())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"applicationId",{set:function(e){this.appId=e},enumerable:!0,configurable:!0}),t.prototype.getUsername=function(){return this.stSessionStorage.getItem(r.SecuredTouchConstants.USER_ID_KEY)||""},t.prototype.setUsername=function(e){this.stSessionStorage.setItem(r.SecuredTouchConstants.USER_ID_TS_KEY,(new Date).getTime()),e?this.stSessionStorage.setItem(r.SecuredTouchConstants.USER_ID_KEY,e):this.stSessionStorage.removeItem(r.SecuredTouchConstants.USER_ID_KEY)},Object.defineProperty(t.prototype,"usernameTs",{get:function(){return Number(this.stSessionStorage.getItem(r.SecuredTouchConstants.USER_ID_TS_KEY))||0},enumerable:!0,configurable:!0}),t.prototype.getMetadataTsKey=function(){return r.SecuredTouchUtil.hash("SecuredTouchMetadataTs-"+this.cachedDeviceId+"-"+this.appId)},t.prototype.getLastMetadataTimeStamp=function(){return Number(this.stLocalStorage.getItem(this.getMetadataTsKey()))||0},t.prototype.setLastMetadataTimeStamp=function(e){this.stLocalStorage.setItem(this.getMetadataTsKey(),e)},Object.defineProperty(t.prototype,"appSessionId",{get:function(){return this.stSessionStorage.getItem(r.SecuredTouchConstants.APP_SESSION_ID_KEY)||""},set:function(e){e?(r.STLogger.info("Set Session ID: "+e),this.stSessionStorage.setItem(r.SecuredTouchConstants.APP_SESSION_ID_KEY,e)):this.stSessionStorage.removeItem(r.SecuredTouchConstants.APP_SESSION_ID_KEY)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastDisposedPayload",{get:function(){var e=null;try{var t=this.stSessionStorage.getItem(r.SecuredTouchConstants.LAST_DISPOSED_TS_KEY);(new Date).getTime()-t<=r.SecuredTouchConstants.SESSION_STORAGE_TTL_MILLIS&&(e=JSON.parse(this.stSessionStorage.getItem(r.SecuredTouchConstants.LAST_DISPOSED_PAYLOAD_KEY)))}catch(e){r.STLogger.warn("Failed to get last disposed payload",e)}return this.stSessionStorage.removeItem(r.SecuredTouchConstants.LAST_DISPOSED_PAYLOAD_KEY),this.stSessionStorage.removeItem(r.SecuredTouchConstants.LAST_DISPOSED_TS_KEY),e},set:function(e){try{e&&(this.stSessionStorage.setItem(r.SecuredTouchConstants.LAST_DISPOSED_PAYLOAD_KEY,JSON.stringify(e)),this.stSessionStorage.setItem(r.SecuredTouchConstants.LAST_DISPOSED_TS_KEY,(new Date).getTime()))}catch(e){r.STLogger.warn("Failed to save last disposed payload",e)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"passedBufferTimeout",{get:function(){var e=this.stSessionStorage.getItem(r.SecuredTouchConstants.SESSION_STORAGE_UPDATE_TS)||0;return(new Date).getTime()-e>r.SecuredTouchConstants.SESSION_STORAGE_TTL_MILLIS},enumerable:!0,configurable:!0}),t.prototype.resetDeviceCredentials=function(){this.cachedDeviceId="Id-"+r.SecuredTouchUtil.newGuid(),this.cachedDeviceSecret=r.SecuredTouchUtil.hash(this.cachedDeviceId),this.crossStorage.set(r.SecuredTouchConstants.DEVICE_ID_KEY,this.cachedDeviceId),this.stLocalStorage.setItem(r.SecuredTouchConstants.DEVICE_ID_KEY,this.cachedDeviceId),this.crossStorage.del(r.SecuredTouchConstants.DEVICE_CREDENTIALS_KEY)},t.prototype.getDeviceCredentials=function(){return this.cachedDeviceId&&this.cachedDeviceSecret||this.resetDeviceCredentials(),{deviceSecret:this.cachedDeviceSecret,deviceId:this.cachedDeviceId}},Object.defineProperty(t.prototype,"remoteLogEnabledByFactor",{get:function(){var e=this.stLocalStorage.getItem(r.SecuredTouchConstants.REMOTE_LOG_ENABLED_KEY);return null!=e?"true"===e:null},set:function(e){this.stLocalStorage.setItem(r.SecuredTouchConstants.REMOTE_LOG_ENABLED_KEY,e)},enumerable:!0,configurable:!0}),t);function t(){this.appId="";try{window.sessionStorage.setItem("_st_storage_enabled_check","test"),window.sessionStorage.removeItem("_st_storage_enabled_check"),this.stSessionStorage=window.sessionStorage}catch(e){r.STLogger.warn("session storage disabled"),this.stSessionStorage=new r.SecuredTouchStorageFallback}try{window.localStorage.setItem("_st_storage_enabled_check","test"),window.localStorage.removeItem("_st_storage_enabled_check"),this.stLocalStorage=new r.SecuredTouchStorageWrapper(window.localStorage)}catch(e){r.STLogger.warn("local storage disabled"),this.stLocalStorage=new r.SecuredTouchStorageWrapper(new r.SecuredTouchStorageFallback),this.crossStorage=new r.SecuredTouchCrossStorageFallback(this.stLocalStorage)}}r.SecuredTouchSessionStorage=e}(_securedTouchEntities=_securedTouchEntities||{}),function(n){var e=(Object.defineProperty(i,"instance",{get:function(){return i._instance=!i._instance?new i:i._instance},enumerable:!0,configurable:!0}),i.prototype.cachePointer=function(e){var t=n.SecuredTouchSessionStorage.instance;e.CLIENT_POINTER_VERSION=i.POINTER_VERSION,t.setInitParams(e,this.pointerTTLMinutes)},i.prototype.loadPointerFromCache=function(e){var t=6e4*e.getInitParamsTTLInMinutes(i.SDK_PROPERTIES_DEFAULT.pointerTTLMinutes);if(Date.now()-e.lastInitParamsTs<t){t=e.initParams;if(t&&t.CLIENT_POINTER_VERSION===i.POINTER_VERSION&&this.refreshPointerParams(t))return t}return e.removeInitParams(),null},i.prototype.loadPointerFromServer=function(n,i,r){return void 0===r&&(r=0),__awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,n.getPointer(i,r)];case 1:return t=e.sent(),this.refreshPointerParams(t)?(this.cachePointer(t),[2,t]):[2,Promise.reject("got invalid pointer config json")]}})})},i.prototype.refreshPointerParams=function(e){this._token=e.token||i.TOKEN_DEFAULT;e=e.clientConfiguration;return this.pointerParams.enabled=null!=e.enabled?Boolean(e.enabled):i.ENABLED_DEFAULT,this.pointerParams.url=null!=e.url?e.url:i.URL_DEFAULT,this.pointerParams.clientDigest=null!=e.clientDigest?e.clientDigest:i.CLIENT_DIGEST_DEFAULT,this.pointerParams.bufferSize=null!=e.bufferSize?Number(e.bufferSize):i.BUFFER_SIZE_DEFAULT,this.pointerParams.maxSensorSamples=null!=e.maxSensorSamples?Number(e.maxSensorSamples):i.MAX_SENSOR_SAMPLES_DEFAULT,this.pointerParams.maxSnapshotsCount=null!=e.maxSnapshotsCount?Number(e.maxSnapshotsCount):i.MAX_SNAPSHOTS_COUNT_DEFAULT,this.pointerParams.logMode=null!=e.logMode?Number(e.logMode):i.LOG_MODE_DEFAULT,this.pointerParams.shouldSendOnKeyboardUp=null!=e.shouldSendOnKeyboardUp?Boolean(e.shouldSendOnKeyboardUp):i.SHOULD_SEND_ON_KEYBOARD_UP_DEFAULT,this.pointerParams.sensorsTimestampDeltaInMillis=null!=e.sensorsTimestampDeltaInMillis?Number(e.sensorsTimestampDeltaInMillis):i.SENSORS_TIMESTAMP_DELTA_IN_MILLIS_DEFAULT,this.pointerParams.propertyBlackList=null!=e.propertyBlackList?e.propertyBlackList:i.PROPERTY_BLACK_LIST_DEFAULT,this.pointerParams.behavioralBlacklist=null!=e.behavioralBlacklist?e.behavioralBlacklist:i.BEHAVIORAL_BLACK_LIST_DEFAULT,this.pointerParams.tagsBlacklistRegex=null!=e.tagsBlacklistRegex?e.tagsBlacklistRegex:i.TAGS_BLACK_LIST_REGEX_DEFAULT,this.pointerParams.tagsToFlushRegex=null!=e.tagsToFlushRegex?e.tagsToFlushRegex:i.TAGS_TO_FLUSH_BLACK_LIST_REGEX_DEFAULT,this.pointerParams.version=null!=e.version?e.version:i.VERSION_DEFAULT,this.populateSdkProperties(e.sdkProperties),Boolean(this.pointerParams.url)&&Boolean(this._token)},i.prototype.populateSdkProperties=function(e){var t;e?(e.web_sdk_url_whitelist?this.pointerParams.sdkProperties.urlWhitelist=n.SecuredTouchUtil.safeJsonParse(e.web_sdk_url_whitelist):this.pointerParams.sdkProperties.urlWhitelist=i.SDK_PROPERTIES_DEFAULT.urlWhitelist,e.web_sdk_web_rtc_url?this.pointerParams.sdkProperties.webRtcUrl=e.web_sdk_web_rtc_url:this.pointerParams.sdkProperties.webRtcUrl=i.SDK_PROPERTIES_DEFAULT.webRtcUrl,t=n.SecuredTouchUtil.safeJsonParse(e.web_sdk_events_black_list),this.pointerParams.sdkProperties.eventsBlackList=t?new Set(t):i.SDK_PROPERTIES_DEFAULT.eventsBlackList,t=n.SecuredTouchUtil.safeJsonParse(e.web_sdk_events_count_only),this.pointerParams.sdkProperties.countOnlyEventsList=t?new Set(t):i.SDK_PROPERTIES_DEFAULT.countOnlyEventsList,e.web_sdk_indirect_interval?this.pointerParams.sdkProperties.indirectInterval=Number(e.web_sdk_indirect_interval):this.pointerParams.sdkProperties.indirectInterval=i.SDK_PROPERTIES_DEFAULT.indirectInterval,e.web_sdk_update_interval?this.pointerParams.sdkProperties.updateInterval=Number(e.web_sdk_update_interval):this.pointerParams.sdkProperties.updateInterval=i.SDK_PROPERTIES_DEFAULT.updateInterval,e.web_sdk_idle_timeout_ms?this.pointerParams.sdkProperties.idleTimeoutMs=Number(e.web_sdk_idle_timeout_ms):this.pointerParams.sdkProperties.idleTimeoutMs=i.SDK_PROPERTIES_DEFAULT.idleTimeoutMs,e.web_sdk_max_events_count?this.pointerParams.sdkProperties.maxEventsCount=Number(e.web_sdk_max_events_count):this.pointerParams.sdkProperties.maxEventsCount=i.SDK_PROPERTIES_DEFAULT.maxEventsCount,t=n.SecuredTouchUtil.safeJsonParse(e.web_sdk_field_black_list),this.pointerParams.sdkProperties.fieldBlackList=t?new Set(t):i.SDK_PROPERTIES_DEFAULT.fieldBlackList,e.web_sdk_css_selectors?this.pointerParams.sdkProperties.cssSelectors=e.web_sdk_css_selectors:this.pointerParams.sdkProperties.cssSelectors=i.SDK_PROPERTIES_DEFAULT.cssSelectors,e.web_sdk_tags_css_selectors?this.pointerParams.sdkProperties.tagsCssSelectors=e.web_sdk_tags_css_selectors:this.pointerParams.sdkProperties.tagsCssSelectors=i.SDK_PROPERTIES_DEFAULT.tagsCssSelectors,e.web_sdk_tags_config?this.pointerParams.sdkProperties.tagsConfig=e.web_sdk_tags_config:this.pointerParams.sdkProperties.tagsConfig=i.SDK_PROPERTIES_DEFAULT.tagsConfig,e.web_sdk_obfuscated_values?this.pointerParams.sdkProperties.obfuscatedValues=e.web_sdk_obfuscated_values:this.pointerParams.sdkProperties.obfuscatedValues=i.SDK_PROPERTIES_DEFAULT.obfuscatedValues,e.web_sdk_max_selector_children?this.pointerParams.sdkProperties.maxSelectorChildren=Number(e.web_sdk_max_selector_children):this.pointerParams.sdkProperties.maxSelectorChildren=i.SDK_PROPERTIES_DEFAULT.maxSelectorChildren,e.interactions_queue_size?this.pointerParams.sdkProperties.maxRequestQueueSize=Number(e.interactions_queue_size):this.pointerParams.sdkProperties.maxRequestQueueSize=i.SDK_PROPERTIES_DEFAULT.maxRequestQueueSize,e.interaction_expiration_time?this.pointerParams.sdkProperties.interactionExpirationTime=Number(e.interaction_expiration_time):this.pointerParams.sdkProperties.interactionExpirationTime=i.SDK_PROPERTIES_DEFAULT.interactionExpirationTime,e.web_sdk_request_timeout?this.pointerParams.sdkProperties.requestTimeout=Number(e.web_sdk_request_timeout):this.pointerParams.sdkProperties.requestTimeout=i.SDK_PROPERTIES_DEFAULT.requestTimeout,e.web_sdk_send_location?this.pointerParams.sdkProperties.sendLocation="true"===e.web_sdk_send_location:this.pointerParams.sdkProperties.sendLocation=i.SDK_PROPERTIES_DEFAULT.sendLocation,e.heart_beat_frequency_ms?this.pointerParams.sdkProperties.heartBeatFrequencyMs=Number(e.heart_beat_frequency_ms):this.pointerParams.sdkProperties.heartBeatFrequencyMs=i.SDK_PROPERTIES_DEFAULT.heartBeatFrequencyMs,e.web_sdk_beforeunload_enabled?this.pointerParams.sdkProperties.beforeunloadEnabled="true"===e.web_sdk_beforeunload_enabled:this.pointerParams.sdkProperties.beforeunloadEnabled=i.SDK_PROPERTIES_DEFAULT.beforeunloadEnabled,e.web_sdk_devtools_enabled?this.pointerParams.sdkProperties.devToolsEnabled="true"===e.web_sdk_devtools_enabled:this.pointerParams.sdkProperties.devToolsEnabled=i.SDK_PROPERTIES_DEFAULT.devToolsEnabled,e.snapshots_reduce_factor?this.pointerParams.sdkProperties.snapshotsReduceFactor=Number(e.snapshots_reduce_factor):this.pointerParams.sdkProperties.snapshotsReduceFactor=i.SDK_PROPERTIES_DEFAULT.snapshotsReduceFactor,e.events_reduce_factor_map?this.pointerParams.sdkProperties.eventsReduceFactorMap=e.events_reduce_factor_map:this.pointerParams.sdkProperties.eventsReduceFactorMap=i.SDK_PROPERTIES_DEFAULT.eventsReduceFactorMap,e.remote_logs_enabled?this.pointerParams.sdkProperties.remoteLogsEnabled="true"===e.remote_logs_enabled:this.pointerParams.sdkProperties.remoteLogsEnabled=i.SDK_PROPERTIES_DEFAULT.remoteLogsEnabled,e.max_remote_logs?this.pointerParams.sdkProperties.maxRemoteLogs=Number(e.max_remote_logs):this.pointerParams.sdkProperties.maxRemoteLogs=i.SDK_PROPERTIES_DEFAULT.maxRemoteLogs,e.failures_amount_to_report?this.pointerParams.sdkProperties.failuresAmountToReport=Number(e.failures_amount_to_report):this.pointerParams.sdkProperties.failuresAmountToReport=i.SDK_PROPERTIES_DEFAULT.failuresAmountToReport,e.metrics_frequency?this.pointerParams.sdkProperties.metricsFrequency=Number(e.metrics_frequency):this.pointerParams.sdkProperties.metricsFrequency=i.SDK_PROPERTIES_DEFAULT.metricsFrequency,t=n.SecuredTouchUtil.safeJsonParse(e.web_sdk_fingerprint_black_list),this.pointerParams.sdkProperties.fingerPrintBlacklist=t||i.SDK_PROPERTIES_DEFAULT.fingerPrintBlacklist,e.pointer_cache_ttl_minutes?this.pointerParams.sdkProperties.pointerTTLMinutes=Number(e.pointer_cache_ttl_minutes):this.pointerParams.sdkProperties.pointerTTLMinutes=i.SDK_PROPERTIES_DEFAULT.pointerTTLMinutes,t=n.SecuredTouchUtil.safeJsonParse(e.web_sdk_navigator_props),this.pointerParams.sdkProperties.navigatorProperties=t||i.SDK_PROPERTIES_DEFAULT.navigatorProperties,t=n.SecuredTouchUtil.safeJsonParse(e.web_sdk_window_props),this.pointerParams.sdkProperties.windowProperties=t||i.SDK_PROPERTIES_DEFAULT.windowProperties,e.pong_on_app_session_change?this.pointerParams.sdkProperties.refreshTokenOnSessionChange="true"===e.pong_on_app_session_change:this.pointerParams.sdkProperties.refreshTokenOnSessionChange=i.SDK_PROPERTIES_DEFAULT.refreshTokenOnSessionChange):this.pointerParams.sdkProperties=i.SDK_PROPERTIES_DEFAULT},Object.defineProperty(i.prototype,"token",{get:function(){return this._token},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"enabled",{get:function(){return this.pointerParams.enabled},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"url",{get:function(){return this.pointerParams.url},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clientDigest",{get:function(){return this.pointerParams.clientDigest},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bufferSize",{get:function(){return this.pointerParams.bufferSize},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxSensorSamples",{get:function(){return this.pointerParams.maxSensorSamples},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxSnapshotsCount",{get:function(){return this.pointerParams.maxSnapshotsCount},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"logMode",{get:function(){return this.pointerParams.logMode},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shouldSendOnKeyboardUp",{get:function(){return this.pointerParams.shouldSendOnKeyboardUp},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sensorsTimestampDeltaInMillis",{get:function(){return this.pointerParams.sensorsTimestampDeltaInMillis},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"propertyBlackList",{get:function(){return this.pointerParams.propertyBlackList},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"behavioralBlacklist",{get:function(){return this.pointerParams.behavioralBlacklist},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tagsBlacklistRegex",{get:function(){return this.pointerParams.tagsBlacklistRegex},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tagsToFlushRegex",{get:function(){return this.pointerParams.tagsToFlushRegex},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"version",{get:function(){return this.pointerParams.version},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"urlWhitelist",{get:function(){return this.pointerParams.sdkProperties.urlWhitelist},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"webRtcUrl",{get:function(){return this.pointerParams.sdkProperties.webRtcUrl},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"eventsBlackList",{get:function(){return this.pointerParams.sdkProperties.eventsBlackList},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"countOnlyEventsList",{get:function(){return this.pointerParams.sdkProperties.countOnlyEventsList},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"indirectInterval",{get:function(){return this.pointerParams.sdkProperties.indirectInterval},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"updateInterval",{get:function(){return this.pointerParams.sdkProperties.updateInterval},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"idleTimeoutMs",{get:function(){return this.pointerParams.sdkProperties.idleTimeoutMs},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxEventsCount",{get:function(){return this.pointerParams.sdkProperties.maxEventsCount},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fieldBlackList",{get:function(){return this.pointerParams.sdkProperties.fieldBlackList},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cssSelectors",{get:function(){return this.pointerParams.sdkProperties.cssSelectors},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tagsCssSelectors",{get:function(){return this.pointerParams.sdkProperties.tagsCssSelectors},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tagsConfig",{get:function(){return this.pointerParams.sdkProperties.tagsConfig},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"obfuscatedValues",{get:function(){return this.pointerParams.sdkProperties.obfuscatedValues},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxSelectorChildren",{get:function(){return this.pointerParams.sdkProperties.maxSelectorChildren},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxRequestQueueSize",{get:function(){return this.pointerParams.sdkProperties.maxRequestQueueSize},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"interactionExpirationTime",{get:function(){return this.pointerParams.sdkProperties.interactionExpirationTime},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"requestTimeout",{get:function(){return this.pointerParams.sdkProperties.requestTimeout},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sendLocation",{get:function(){return this.pointerParams.sdkProperties.sendLocation},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"heartBeatFrequencyMs",{get:function(){return this.pointerParams.sdkProperties.heartBeatFrequencyMs},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"beforeUnloadEnabled",{get:function(){return this.pointerParams.sdkProperties.beforeunloadEnabled},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"devToolsEnabled",{get:function(){return this.pointerParams.sdkProperties.devToolsEnabled},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"snapshotsReduceFactor",{get:function(){return this.pointerParams.sdkProperties.snapshotsReduceFactor},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"eventsReduceFactorMap",{get:function(){return this.pointerParams.sdkProperties.eventsReduceFactorMap},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"remoteLogsEnabled",{get:function(){return this.pointerParams.sdkProperties.remoteLogsEnabled},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxRemoteLogs",{get:function(){return this.pointerParams.sdkProperties.maxRemoteLogs},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"failuresAmountToReport",{get:function(){return this.pointerParams.sdkProperties.failuresAmountToReport},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"metricsFrequency",{get:function(){return this.pointerParams.sdkProperties.metricsFrequency},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fingerPrintBlacklist",{get:function(){return this.pointerParams.sdkProperties.fingerPrintBlacklist},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pointerTTLMinutes",{get:function(){return this.pointerParams.sdkProperties.pointerTTLMinutes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"navigatorProperties",{get:function(){return this.pointerParams.sdkProperties.navigatorProperties},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"windowProperties",{get:function(){return this.pointerParams.sdkProperties.windowProperties},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"refreshTokenOnSessionChange",{get:function(){return this.pointerParams.sdkProperties.refreshTokenOnSessionChange},enumerable:!0,configurable:!0}),i.POINTER_VERSION=2,i.TOKEN_DEFAULT="",i.ENABLED_DEFAULT=!0,i.URL_DEFAULT="",i.CLIENT_DIGEST_DEFAULT="",i.BUFFER_SIZE_DEFAULT=4,i.MAX_SENSOR_SAMPLES_DEFAULT=0,i.MAX_SNAPSHOTS_COUNT_DEFAULT=500,i.LOG_MODE_DEFAULT=0,i.SHOULD_SEND_ON_KEYBOARD_UP_DEFAULT=!0,i.SENSORS_TIMESTAMP_DELTA_IN_MILLIS_DEFAULT=0,i.PROPERTY_BLACK_LIST_DEFAULT=[],i.BEHAVIORAL_BLACK_LIST_DEFAULT=null,i.TAGS_BLACK_LIST_REGEX_DEFAULT="",i.TAGS_TO_FLUSH_BLACK_LIST_REGEX_DEFAULT="",i.VERSION_DEFAULT="",i.SDK_PROPERTIES_DEFAULT={urlWhitelist:[],webRtcUrl:"",eventsBlackList:new Set,countOnlyEventsList:new Set,indirectInterval:3e3,updateInterval:1e3,idleTimeoutMs:1e3,maxEventsCount:500,fieldBlackList:new Set,cssSelectors:"",tagsCssSelectors:"",tagsConfig:"",obfuscatedValues:"",maxSelectorChildren:2,maxRequestQueueSize:10,interactionExpirationTime:3e5,requestTimeout:1e4,sendLocation:!0,heartBeatFrequencyMs:6e5,beforeunloadEnabled:!1,devToolsEnabled:!0,snapshotsReduceFactor:0,eventsReduceFactorMap:"",remoteLogsEnabled:!0,maxRemoteLogs:2,failuresAmountToReport:5,metricsFrequency:5,fingerPrintBlacklist:[],pointerTTLMinutes:8640,navigatorProperties:[],windowProperties:[],refreshTokenOnSessionChange:!0},i);function i(){this._token=i.TOKEN_DEFAULT;var e={urlWhitelist:i.SDK_PROPERTIES_DEFAULT.urlWhitelist,webRtcUrl:i.SDK_PROPERTIES_DEFAULT.webRtcUrl,eventsBlackList:i.SDK_PROPERTIES_DEFAULT.eventsBlackList,countOnlyEventsList:i.SDK_PROPERTIES_DEFAULT.countOnlyEventsList,indirectInterval:i.SDK_PROPERTIES_DEFAULT.indirectInterval,updateInterval:i.SDK_PROPERTIES_DEFAULT.updateInterval,idleTimeoutMs:i.SDK_PROPERTIES_DEFAULT.idleTimeoutMs,maxEventsCount:i.SDK_PROPERTIES_DEFAULT.maxEventsCount,fieldBlackList:i.SDK_PROPERTIES_DEFAULT.fieldBlackList,cssSelectors:i.SDK_PROPERTIES_DEFAULT.cssSelectors,tagsCssSelectors:i.SDK_PROPERTIES_DEFAULT.tagsCssSelectors,tagsConfig:i.SDK_PROPERTIES_DEFAULT.tagsConfig,obfuscatedValues:i.SDK_PROPERTIES_DEFAULT.obfuscatedValues,maxSelectorChildren:i.SDK_PROPERTIES_DEFAULT.maxSelectorChildren,maxRequestQueueSize:i.SDK_PROPERTIES_DEFAULT.maxRequestQueueSize,interactionExpirationTime:i.SDK_PROPERTIES_DEFAULT.interactionExpirationTime,requestTimeout:i.SDK_PROPERTIES_DEFAULT.requestTimeout,sendLocation:i.SDK_PROPERTIES_DEFAULT.sendLocation,heartBeatFrequencyMs:i.SDK_PROPERTIES_DEFAULT.heartBeatFrequencyMs,beforeunloadEnabled:i.SDK_PROPERTIES_DEFAULT.beforeunloadEnabled,devToolsEnabled:i.SDK_PROPERTIES_DEFAULT.devToolsEnabled,snapshotsReduceFactor:i.SDK_PROPERTIES_DEFAULT.snapshotsReduceFactor,eventsReduceFactorMap:i.SDK_PROPERTIES_DEFAULT.eventsReduceFactorMap,remoteLogsEnabled:i.SDK_PROPERTIES_DEFAULT.remoteLogsEnabled,maxRemoteLogs:i.SDK_PROPERTIES_DEFAULT.maxRemoteLogs,failuresAmountToReport:i.SDK_PROPERTIES_DEFAULT.failuresAmountToReport,metricsFrequency:i.SDK_PROPERTIES_DEFAULT.metricsFrequency,fingerPrintBlacklist:i.SDK_PROPERTIES_DEFAULT.fingerPrintBlacklist,pointerTTLMinutes:i.SDK_PROPERTIES_DEFAULT.pointerTTLMinutes,navigatorProperties:i.SDK_PROPERTIES_DEFAULT.navigatorProperties,windowProperties:i.SDK_PROPERTIES_DEFAULT.windowProperties,refreshTokenOnSessionChange:i.SDK_PROPERTIES_DEFAULT.refreshTokenOnSessionChange};this.pointerParams={enabled:i.ENABLED_DEFAULT,url:i.URL_DEFAULT,clientDigest:i.CLIENT_DIGEST_DEFAULT,bufferSize:i.BUFFER_SIZE_DEFAULT,maxSensorSamples:i.MAX_SENSOR_SAMPLES_DEFAULT,maxSnapshotsCount:i.MAX_SNAPSHOTS_COUNT_DEFAULT,logMode:i.LOG_MODE_DEFAULT,shouldSendOnKeyboardUp:i.SHOULD_SEND_ON_KEYBOARD_UP_DEFAULT,sensorsTimestampDeltaInMillis:i.SENSORS_TIMESTAMP_DELTA_IN_MILLIS_DEFAULT,propertyBlackList:i.PROPERTY_BLACK_LIST_DEFAULT,behavioralBlacklist:i.BEHAVIORAL_BLACK_LIST_DEFAULT,tagsBlacklistRegex:i.TAGS_BLACK_LIST_REGEX_DEFAULT,tagsToFlushRegex:i.TAGS_TO_FLUSH_BLACK_LIST_REGEX_DEFAULT,version:i.VERSION_DEFAULT,sdkProperties:e}}n.SecuredTouchPointerConfig=e}(_securedTouchEntities=_securedTouchEntities||{}),function(e){var t=(Object.defineProperty(n,"METRIC_PREFIX",{get:function(){return"st.metrics"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"METRICS_ENABLED",{get:function(){return"stMetricsEnabled"},enumerable:!0,configurable:!0}),n);function n(){}e.MetricsConstants=t}(_securedTouchEntities=_securedTouchEntities||{}),function(e){var t=(n.prototype.onCalcStarted=function(){this.calcStartTime=(new Date).getTime()},n.prototype.onCalcEnded=function(){0<this.calcStartTime&&(this._calcTime=(new Date).getTime()-this.calcStartTime,this.calcStartTime=0)},n.prototype.setMetadataSkipped=function(e){this._skipped=e?1:0,this._calculated=1-this._skipped},n.prototype.resetValues=function(){this._calcTime=void 0,this._skipped=void 0,this._calculated=void 0},n.prototype.setMetrics=function(e){var t=this;e.addMetric("count.metadata.calculated",this._calculated),e.addMetric("count.metadata.skip",this._skipped),e.addMetric("time.metadata.calculation.max",this._calcTime,function(e){return!e||t._calcTime>e})},n);function n(){this._calcTime=void 0,this._skipped=void 0,this._calculated=void 0,this.calcStartTime=0}e.MetadataMetrics=t}(_securedTouchEntities=_securedTouchEntities||{}),function(e){var t=(n.prototype.onInitStarted=function(){this.initStartTime=(new Date).getTime()},n.prototype.onInitEnded=function(){0<this.initStartTime&&(this._initTime=(new Date).getTime()-this.initStartTime,this.initStartTime=0)},n.prototype.setPointerCached=function(e){this._pointerCached=e?1:0,this._pointerNotCached=1-this._pointerCached},n.prototype.resetValues=function(){this._initTime=void 0,this._pointerCached=void 0,this._pointerNotCached=void 0},n.prototype.setMetrics=function(e){var t=this;e.addMetric("time.init.flow.max",this._initTime,function(e){return!e||t._initTime>e}),e.addMetric("count.pointer.cached",this._pointerCached),e.addMetric("count.pointer.not.cached",this._pointerNotCached)},n);function n(){this._initTime=void 0,this._pointerCached=void 0,this._pointerNotCached=void 0,this.initStartTime=0}e.InitMetrics=t}(_securedTouchEntities=_securedTouchEntities||{}),function(e){var t=(n.prototype.onInteractionSent=function(e){var t=(new Date).getTime();this.timesMap[e]=t,0===this.lastInteractionTimestamp?this.lastInteractionTimestamp=t:(0===this._minTimeBetweenInteractions||t-this.lastInteractionTimestamp<this._minTimeBetweenInteractions)&&(this._minTimeBetweenInteractions=t-this.lastInteractionTimestamp,this.lastInteractionTimestamp=t)},n.prototype.onInteractionSuccess=function(e){var t;this.timesMap[e]&&(t=(new Date).getTime()-this.timesMap[e],this.increment+=1,this._avgInteractionTime=(this._avgInteractionTime*(this.increment-1)+t)/this.increment,delete this.timesMap[e])},n.prototype.onInteractionFailure=function(e){this.timesMap[e]&&delete this.timesMap[e]},n.prototype.setQueueSize=function(e){this.queueSizeIncrement+=1,this._avgQueueSize=(this._avgQueueSize*(this.queueSizeIncrement-1)+e)/this.queueSizeIncrement},n.prototype.setAttempt=function(e){this.attemptIncrement+=1,this._avgAttempt=(this._avgAttempt*(this.attemptIncrement-1)+e)/this.attemptIncrement},n.prototype.resetValues=function(){this._avgInteractionTime=0,this._minTimeBetweenInteractions=0,this._avgQueueSize=0,this._avgAttempt=0},n.prototype.setMetrics=function(e){var t=this;this.increment=0,e.addMetric("time.interactions.e2e.avg",this._avgInteractionTime),e.addMetric("time.between.interactions.min",this._minTimeBetweenInteractions,function(e){return!e||t._minTimeBetweenInteractions<e}),this.queueSizeIncrement=0,e.addMetric("count.queue.size.avg",this._avgQueueSize),this.attemptIncrement=0,e.addMetric("count.request.attempt.avg",this._avgAttempt)},n);function n(){this._avgInteractionTime=0,this._minTimeBetweenInteractions=0,this._avgQueueSize=0,this._avgAttempt=0,this.attemptIncrement=0,this.queueSizeIncrement=0,this.timesMap={},this.increment=0,this.lastInteractionTimestamp=0}e.NetworkMetrics=t}(_securedTouchEntities=_securedTouchEntities||{}),function(a){var e=(Object.defineProperty(t,"instance",{get:function(){return t._instance=!t._instance?new t:t._instance},enumerable:!0,configurable:!0}),t.prototype.getMetricsData=function(e){var r,t,o={};try{this.enabled&&e%a.SecuredTouchPointerConfig.instance.metricsFrequency==0&&(t={addMetric:function(e,t,n){var i;e&&null!=t&&(i=r.stSessionStorage.getItem(a.MetricsConstants.METRIC_PREFIX+"."+e),n&&!n(i)||(r.stSessionStorage.setItem(a.MetricsConstants.METRIC_PREFIX+"."+e,t),o[e]=t))}},(r=this).metadata.setMetrics(t),this.init.setMetrics(t),this.network.setMetrics(t),this.metadata.resetValues(),this.init.resetValues(),this.network.resetValues())}catch(e){a.STLogger.warn("Failed to add metrics",e)}return o},t);function t(){this.enabledFactor=window._metricsEnabledFactor?Number(window._metricsEnabledFactor):.01,this.stSessionStorage=a.SecuredTouchSessionStorage.instance.sessionStorage,this.metadata=new a.MetadataMetrics,this.init=new a.InitMetrics,this.network=new a.NetworkMetrics;var e=this.stSessionStorage.getItem(a.MetricsConstants.METRICS_ENABLED);null!=e?this.enabled="true"===e:(this.enabled=Math.random()<=this.enabledFactor,this.stSessionStorage.setItem(a.MetricsConstants.METRICS_ENABLED,this.enabled))}a.SecuredTouchMetrics=e}(_securedTouchEntities=_securedTouchEntities||{}),function(h){var e=(t.prototype.setHeader=function(e,t){this.customHeaders.set(e,t)},t.prototype.removeHeader=function(e){this.customHeaders.delete(e)},t.prototype.setCustomHeaders=function(n,e){n.setRequestHeader("Accept","application/json"),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("Attempt",""+e),n.setRequestHeader("clientEpoch",""+(new Date).getTime()),this.customHeaders.forEach(function(e,t){n.setRequestHeader(t,e)})},t.isGzipEnabled=function(){try{return!!_securedTouchDependencies.pako&&!window["unzip-securedtouch"]}catch(e){return!1}},t.prototype.postJson=function(r,o,a,s,c,u){var d=this;return new Promise(function(t,n){var i,e;c?((i=new XMLHttpRequest).open("POST",r,!0),i.withCredentials=!0,i.timeout=a,i.setRequestHeader("Authorization",c),d.setCustomHeaders(i,s),i.onload=function(){if(200<=i.status&&i.status<400)try{var e=JSON.parse(i.responseText||"{}");t(e)}catch(e){n(e)}else n({status:i.status,statsText:i.statusText})},i.ontimeout=function(e){n(e)},i.onerror=function(e){n({status:i.status,statsText:i.statusText})},e=JSON.stringify(o),u&&h.STHttpClient.isGzipEnabled()?(i.setRequestHeader("Content-Encoding","gzip"),i.send(_securedTouchDependencies.pako.gzip(e))):i.send(e),h.SecuredTouchMetrics.instance.network.setAttempt(s)):n({status:401,statsText:"Aborted, Auth token is missing"})})},t);function t(e,t){this.clientVersion=e,this.customHeaders=new Map,this.customHeaders.set("clientVersion",this.clientVersion),this.customHeaders.set("instanceUUID",t)}h.STHttpClient=e}(_securedTouchEntities=_securedTouchEntities||{}),function(i){var e=(Object.defineProperty(r.prototype,"asMap",{get:function(){var e=(e=r.stSessionStorage.getItem(this.mapKey))||JSON.stringify({});return JSON.parse(e)},enumerable:!0,configurable:!0}),r.prototype.set=function(e,t){var n=this.asMap;n[e]=t,r.stSessionStorage.setItem(i.SecuredTouchConstants.SESSION_STORAGE_UPDATE_TS,(new Date).getTime()),r.stSessionStorage.setItem(this.mapKey,JSON.stringify(n))},r.prototype.get=function(e){return this.asMap[e]},r.prototype.delete=function(e){var t=this.asMap;delete t[e],r.stSessionStorage.setItem(this.mapKey,JSON.stringify(t))},r.prototype.values=function(){var e=this.asMap;return i.SecuredTouchUtil.values(e)},r.prototype.clear=function(){r.stSessionStorage.removeItem(this.mapKey)},r.stSessionStorage=i.SecuredTouchSessionStorage.instance.sessionStorage,r);function r(e){this.mapKey=e}i.SecuredTouchStorageMap=e}(_securedTouchEntities=_securedTouchEntities||{}),function(c){var u;(e=u=u||{})[e.pointer=0]="pointer",e[e.interactions=1]="interactions",e[e.metadata=2]="metadata",e[e.initSession=3]="initSession";var e=(a.prototype.init=function(e,t,n,i,r,o,a){this.applicationId=e,this.appSecretBase64=c.SecuredTouchUtil.encodeBase64(t),this.pointerUrlPrefix=n,this.clientVersion=i,this.deviceType=r,this.sessionStorage=a||c.SecuredTouchSessionStorage.instance,this.http=o||new c.STHttpClient(i,this.sessionStorage.windowId),this.interactionsQueue||(this.interactionsQueue=new _securedTouchDependencies.StPromiseQueue(1,c.SecuredTouchPointerConfig.instance.maxRequestQueueSize))},a.prototype.enqueue=function(e){return c.SecuredTouchMetrics.instance.network.setQueueSize(this.interactionsQueue.getQueueLength()),this.interactionsQueue.add(e)},a.prototype.sendCanceledPayloads=function(){var t=this,e=this.canceledInteractions.values();this.canceledInteractions.clear(),e&&0<e.length&&e.forEach(function(e){t.sendInteractions(e).catch(function(e){c.STLogger.warn("Failed to resend canceled interactions after page reload",e)})})},a.prototype.clearCanceledPayloads=function(){this.canceledInteractions.clear()},a.prototype.initSessionWithRetry=function(i,r){var o=this;return new Promise(function(t,n){o.http.postJson(c.SecuredTouchPointerConfig.instance.url+"initSession/",i,c.SecuredTouchPointerConfig.instance.requestTimeout,r,c.SecuredTouchPointerConfig.instance.token,!0).then(function(e){t(e)}).catch(function(e){o.handleNetworkFailure(e,u.initSession,r+1).then(function(){return o.initSessionWithRetry(i,r+1)}).then(function(e){t(e)}).catch(function(e){n(e)})})})},a.prototype.initSession=function(e){var t=this;return this.enqueue(function(){return t.initSessionWithRetry(e,0)})},a.prototype.getPointer=function(r,o){return void 0===o&&(o=0),__awaiter(this,void 0,void 0,function(){var i=this;return __generator(this,function(e){return[2,new Promise(function(t,n){i.http.postJson(i.pointerUrlPrefix+"/SecuredTouch/rest/services/"+i.applicationId+"/pointer",r,a.POINTER_TIMEOUT,o,i.appSecretBase64,!0).then(function(e){t(e)}).catch(function(e){i.handleNetworkFailure(e,u.pointer,o+1).then(function(){var e=i.sessionStorage.getDeviceCredentials();return c.SecuredTouchPointerConfig.instance.loadPointerFromServer(i,{device_id:e.deviceId,secret:e.deviceSecret,clientVersion:i.clientVersion,deviceType:i.deviceType,authToken:c.SecuredTouchPointerConfig.instance.token},o+1)}).then(function(e){t(e),i.shouldResetMetadata&&i.lastMetadata&&(i.shouldResetMetadata=!1,i.lastMetadata.deviceId=i.sessionStorage.getDeviceCredentials().deviceId,i.sendMetadata(i.lastMetadata).catch(function(e){c.STLogger.warn("Failed to update metadata",e)}))}).catch(function(e){n(e)})})})]})})},a.prototype.sendMetadata=function(e){var t=this;return this.lastMetadata=e,this.enqueue(function(){return t.sendMetadataWithRetry(e,0)})},a.prototype.sendMetadataWithRetry=function(i,r){var o=this;return new Promise(function(t,n){o.http.postJson(c.SecuredTouchPointerConfig.instance.url+"metadata/",i,c.SecuredTouchPointerConfig.instance.requestTimeout,r,c.SecuredTouchPointerConfig.instance.token,!0).then(function(){t()}).catch(function(e){o.handleNetworkFailure(e,u.metadata,r+1).then(function(){return o.sendMetadataWithRetry(i,r+1)}).then(t).catch(function(e){n(e)})})})},a.prototype.sendInteractionsWithRetry=function(o,a,n){var s=this,i=this;return o.deviceId!==this.sessionStorage.getDeviceCredentials().deviceId?(c.STLogger.warn("Send Interactions failed, interaction's deviceID not matching the current deviceId"),this.canceledInteractions.delete(a),Promise.reject("Interaction's deviceID not matching the current deviceId")):new Promise(function(r,t){c.SecuredTouchMetrics.instance.network.onInteractionSent(a),i.http.postJson(c.SecuredTouchPointerConfig.instance.url+"interactions/",o,c.SecuredTouchPointerConfig.instance.requestTimeout,n,c.SecuredTouchPointerConfig.instance.token,!0).then(function(e){c.SecuredTouchMetrics.instance.network.onInteractionSuccess(a);var t=o.keyboardInteractionPayloads?o.keyboardInteractionPayloads.length:0,n=o.mouseInteractionPayloads?o.mouseInteractionPayloads.length:0,i=o.gestures?o.gestures.length:0;c.STLogger.info(t+" Keyboard Interactions, "+n+" Mouse interactions and "+i+" Gestures sent to server."),s.canceledInteractions.delete(a),r(e)}).catch(function(e){c.SecuredTouchMetrics.instance.network.onInteractionFailure(a),i.handleNetworkFailure(e,u.interactions,n+1).then(function(){return i.sendInteractionsWithRetry(o,a,n+1)}).then(function(e){r(e)}).catch(function(e){s.canceledInteractions.delete(a),t(e)})})})},a.prototype.sendInteractions=function(e){var t=this,n=c.SecuredTouchUtil.newGuid();this.canceledInteractions.set(n,e);var i=c.SecuredTouchUtil.now();return this.enqueue(function(){return c.SecuredTouchUtil.now()-i>c.SecuredTouchPointerConfig.instance.interactionExpirationTime?Promise.reject("interaction expired"):t.sendInteractionsWithRetry(e,n,0)})},a.prototype.handleNetworkFailure=function(n,i,r){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:if(a.MAX_REQUEST_RETRIES<=r)return[2,Promise.reject(n)];e.label=1;case 1:return e.trys.push([1,6,,7]),401!=n.status&&403!=n.status?[3,2]:i==u.pointer?(this.sessionStorage.resetDeviceCredentials(),this.shouldResetMetadata=!0,[2,Promise.resolve()]):(t=this.sessionStorage.getDeviceCredentials(),[2,c.SecuredTouchPointerConfig.instance.loadPointerFromServer(this,{device_id:t.deviceId,secret:t.deviceSecret,clientVersion:this.clientVersion,deviceType:this.deviceType,authToken:c.SecuredTouchPointerConfig.instance.token})]);case 2:return 400<=n.status&&n.status<500&&408!==n.status?[2,Promise.reject(n)]:[3,3];case 3:return[4,c.SecuredTouchUtil.delay(a.REQUESTS_COOL_DOWN[r]||a.REQUESTS_COOL_DOWN[a.REQUESTS_COOL_DOWN.length-1])];case 4:return e.sent(),[2,Promise.resolve()];case 5:return[3,7];case 6:return t=e.sent(),[2,Promise.reject(t)];case 7:return[2]}})})},a.POINTER_TIMEOUT=1e4,a.MAX_REQUEST_RETRIES=3,a.REQUESTS_COOL_DOWN=[0,1e3,2e3],a);function a(){this.shouldResetMetadata=!1,this.canceledInteractions=new c.SecuredTouchStorageMap(c.SecuredTouchConstants.CANCELED_INTERACTIONS),this.pointerQueue=new _securedTouchDependencies.StPromiseQueue(1)}c.STServer=e}(_securedTouchEntities=_securedTouchEntities||{}),function(e){"use strict";var t=(r.prototype.execute=function(e,t,n){var i;this.isOnce&&this.isExecuted||(this.isExecuted=!0,i=this.handler,e?setTimeout(function(){i.apply(t,n)},1):i.apply(t,n))},r),n=(i.prototype.subscribe=function(e){e&&this._subscriptions.push(new t(e,!1))},i.prototype.sub=function(e){this.subscribe(e)},i.prototype.one=function(e){e&&this._subscriptions.push(new t(e,!0))},i.prototype.has=function(e){if(e)for(var t=0,n=this._subscriptions;t<n.length;t++)if(n[t].handler==e)return!0;return!1},i.prototype.unsubscribe=function(e){if(e)for(var t=0;t<this._subscriptions.length;t++)if(this._subscriptions[t].handler==e){this._subscriptions.splice(t,1);break}},i.prototype.unsub=function(e){this.unsubscribe(e)},i.prototype._dispatch=function(e,t,n){for(var i=0;i<this._subscriptions.length;i++){var r=this._subscriptions[i];if(r.isOnce){if(!0===r.isExecuted)continue;this._subscriptions.splice(i,1),i--}r.execute(e,t,n)}},i.prototype.asEvent=function(){return this._wrap},i);function i(){this._wrap=new g(this),this._subscriptions=new Array}function r(e,t){this.handler=e,this.isOnce=t,this.isExecuted=!1}e.DispatcherBase=n;var o,a=(__extends(s,o=n),s.prototype.dispatch=function(e,t){this._dispatch(!1,this,arguments)},s.prototype.dispatchAsync=function(e,t){this._dispatch(!0,this,arguments)},s);function s(){return null!==o&&o.apply(this,arguments)||this}e.EventDispatcher=a;var c,u,d,h,l,p=(__extends(A,l=n),A.prototype.dispatch=function(e){this._dispatch(!1,this,arguments)},A.prototype.dispatchAsync=function(e){this._dispatch(!0,this,arguments)},A),f=(__extends(w,h=n),w.prototype.dispatch=function(){this._dispatch(!1,this,arguments)},w.prototype.dispatchAsync=function(){this._dispatch(!0,this,arguments)},w),g=(y.prototype.subscribe=function(e){this._subscribe(e)},y.prototype.sub=function(e){this.subscribe(e)},y.prototype.unsubscribe=function(e){this._unsubscribe(e)},y.prototype.unsub=function(e){this.unsubscribe(e)},y.prototype.one=function(e){this._one(e)},y.prototype.has=function(e){return this._has(e)},y),n=(E.prototype.get=function(e){var t;return(t=this._events[e])||(t=this.createDispatcher(),this._events[e]=t)},E.prototype.remove=function(e){this._events[e]=null},E),m=(__extends(b,d=n),b.prototype.createDispatcher=function(){return new a},b),_=(__extends(T,u=n),T.prototype.createDispatcher=function(){return new p},T),v=(__extends(S,c=n),S.prototype.createDispatcher=function(){return new f},S);function S(){return null!==c&&c.apply(this,arguments)||this}function T(){return null!==u&&u.apply(this,arguments)||this}function b(){return null!==d&&d.apply(this,arguments)||this}function E(){this._events={}}function y(t){this._subscribe=function(e){return t.subscribe(e)},this._unsubscribe=function(e){return t.unsubscribe(e)},this._one=function(e){return t.one(e)},this._has=function(e){return t.has(e)}}function w(){return null!==h&&h.apply(this,arguments)||this}function A(){return null!==l&&l.apply(this,arguments)||this}function P(){this._events=new v}function I(){this._events=new _}function C(){this._events=new m}Object.defineProperty(C.prototype,"events",{get:function(){return this._events},enumerable:!0,configurable:!0}),C.prototype.subscribe=function(e,t){this._events.get(e).subscribe(t)},C.prototype.sub=function(e,t){this.subscribe(e,t)},C.prototype.unsubscribe=function(e,t){this._events.get(e).unsubscribe(t)},C.prototype.unsub=function(e,t){this.unsubscribe(e,t)},C.prototype.one=function(e,t){this._events.get(e).one(t)},C.prototype.has=function(e,t){return this._events.get(e).has(t)},Object.defineProperty(I.prototype,"events",{get:function(){return this._events},enumerable:!0,configurable:!0}),I.prototype.subscribe=function(e,t){this._events.get(e).subscribe(t)},I.prototype.sub=function(e,t){this.subscribe(e,t)},I.prototype.one=function(e,t){this._events.get(e).one(t)},I.prototype.has=function(e,t){return this._events.get(e).has(t)},I.prototype.unsubscribe=function(e,t){this._events.get(e).unsubscribe(t)},I.prototype.unsub=function(e,t){this.unsubscribe(e,t)},Object.defineProperty(P.prototype,"events",{get:function(){return this._events},enumerable:!0,configurable:!0}),P.prototype.one=function(e,t){this._events.get(e).one(t)},P.prototype.has=function(e,t){return this._events.get(e).has(t)},P.prototype.subscribe=function(e,t){this._events.get(e).subscribe(t)},P.prototype.sub=function(e,t){this.subscribe(e,t)},P.prototype.unsubscribe=function(e,t){this._events.get(e).unsubscribe(t)},P.prototype.unsub=function(e,t){this.unsubscribe(e,t)}}(_securedTouchEntities=_securedTouchEntities||{}),function(i){var e=(Object.defineProperty(t.prototype,"LAST_GESTURE_SENSOR_TIMEOUT_MILI_SECONDS",{get:function(){return 3e3},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accX",{get:function(){return this._accX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accY",{get:function(){return this._accY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accZ",{get:function(){return this._accZ},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lienarAccX",{get:function(){return this._lienarAccX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lienarAccY",{get:function(){return this._lienarAccY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lienarAccZ",{get:function(){return this._lienarAccZ},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isStarted",{get:function(){return this._isStarted},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotX",{get:function(){return this._rotX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotY",{get:function(){return this._rotY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotZ",{get:function(){return this._rotZ},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxSensorSamples",{get:function(){return this._maxSensorSamples},set:function(e){this._maxSensorSamples=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sensorsTimestampDeltaInMillis",{get:function(){return this._sensorsTimestampDeltaInMillis},set:function(e){this._sensorsTimestampDeltaInMillis=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accelerometerList",{get:function(){return this.getRelevantSensorSamples(this._accelerometerList)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gyroscopeList",{get:function(){return this.getRelevantSensorSamples(this._gyroscopeList)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"linearAccelerometerList",{get:function(){return this.getRelevantSensorSamples(this._linearAccelerometerList)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotationList",{get:function(){return this._rotationList},enumerable:!0,configurable:!0}),t.prototype.getRelevantSensorSamples=function(e){if(0==e.length||this._sensorsTimestampDeltaInMillis<1||0==this._gestureTimestamps.length)return e;for(var t,n,i=new Map,r=0;r<e.length;r++)for(var o=0;o<this._gestureTimestamps.length;o++)(n=e[r].timestamp)>=(t=this._gestureTimestamps[o]).start-this._sensorsTimestampDeltaInMillis&&n<=t.end+this._sensorsTimestampDeltaInMillis&&i.set(e[r].timestamp,e[r]);return Array.from(i.values())},t.prototype.getRotationListCopy=function(){return this._rotationList?Array.from(this._rotationList):[]},t.prototype.stopEvents=function(){this._isEventsStarted&&(null!=window.DeviceMotionEvent&&window.removeEventListener("devicemotion",this.accelerometerUpdateHandle,!0),window.DeviceOrientationEvent&&window.removeEventListener("deviceorientation",this.orientationUpdateHandle,!0),this._isEventsStarted=!1,i.STLogger.debug("Sensor events stopped listening"))},t.prototype.startEvents=function(){this._isEventsStarted||(null!=window.DeviceMotionEvent?i.SecuredTouchUtil.addEventListener(window,"devicemotion",this.accelerometerUpdateHandle,!0):i.STLogger.warn("DeviceMotion not supported!"),window.DeviceOrientationEvent?i.SecuredTouchUtil.addEventListener(window,"deviceorientation",this.orientationUpdateHandle,!0):i.STLogger.warn("DeviceOrientation not supported!"),i.STLogger.debug("Sensor events start listening..."),this._isEventsStarted=!0)},t.prototype.start=function(){this._isStarted||(this._isStarted=!0,i.STLogger.debug("Sensor events started..."))},t.prototype.stop=function(){this._isStarted&&(null!=window.DeviceMotionEvent&&window.removeEventListener("devicemotion",this.accelerometerUpdateHandle,!0),window.DeviceOrientationEvent&&window.removeEventListener("deviceorientation",this.orientationUpdateHandle,!0),this._isStarted=!1,i.STLogger.debug("Sensor events stopped"))},t.prototype.reset=function(){this._accelerometerList=[],this._gyroscopeList=[],this._linearAccelerometerList=[],this._rotationList=[],0<this._gestureTimestamps.length?this._gestureTimestamps=[this._gestureTimestamps[this._gestureTimestamps.length-1]]:this._gestureTimestamps=[],this._accX=0,this._accY=0,this._accZ=0,this._rotX=0,this._rotY=0,this._rotZ=0},t.prototype.onGesture=function(e){this._isEventsStarted||this.startEvents(),1<e.snapshots.length&&this._gestureTimestamps.push({start:e.snapshots[0].timestamp,end:e.snapshots[e.snapshots.length-1].timestamp})},t.prototype.puaseSensorsCollectionIfNoActivity=function(e){return(!(0<(0<this._gestureTimestamps.length?this._gestureTimestamps[this._gestureTimestamps.length-1].end:0))||Math.abs(e-this._gestureTimestamps[this._gestureTimestamps.length-1].end)>this.LAST_GESTURE_SENSOR_TIMEOUT_MILI_SECONDS)&&(this.stopEvents(),!0)},t.prototype.getDeviceAcceleration=function(e){return e&&null!=e.x&&null!=e.y&&null!=e.z?e:null},t.prototype.accelerometerUpdate=function(e){try{if(!this.delegate.collectBehavioralData()||this.puaseSensorsCollectionIfNoActivity(i.SecuredTouchUtil.now()))return;var t=this.getDeviceAcceleration(e.accelerationIncludingGravity);t&&(this._accX=t.x*this.orientationImplementationFix,this._accY=t.y*this.orientationImplementationFix,this._accZ=t.z,this.safeAddSensorSample({x:this._accX,y:this._accY,z:this._accX,timestamp:i.SecuredTouchUtil.now()},this._accelerometerList));var n=this.getDeviceAcceleration(e.acceleration);n&&(this._lienarAccX=n.x*this.orientationImplementationFix,this._lienarAccY=n.y*this.orientationImplementationFix,this._lienarAccZ=n.z,this.safeAddSensorSample({x:this._lienarAccX,y:this._lienarAccY,z:this._lienarAccZ,timestamp:i.SecuredTouchUtil.now()},this._linearAccelerometerList)),e.rotationRate&&null!=e.rotationRate.alpha&&null!=e.rotationRate.beta&&null!=e.rotationRate.gamma&&(this._rotX=e.rotationRate.alpha,this._rotY=e.rotationRate.beta,this._rotZ=e.rotationRate.gamma,this.safeAddSensorSample({x:this._rotX,y:this._rotY,z:this._rotZ,timestamp:i.SecuredTouchUtil.now()},this._gyroscopeList))}catch(e){i.STLogger.warn("error in accelerometer handler",e)}},t.prototype.orientationUpdate=function(e){try{if(!this.delegate.collectBehavioralData()||this.puaseSensorsCollectionIfNoActivity(i.SecuredTouchUtil.now()))return;null!=e.alpha&&null!=e.beta&&null!=e.gamma&&this.safeAddSensorSample({x:e.alpha,y:e.beta,z:e.gamma,timestamp:i.SecuredTouchUtil.now()},this._rotationList)}catch(e){i.STLogger.warn("error in orientation handler",e)}},t.prototype.safeAddSensorSample=function(e,t){this.maxSensorSamples>t.length&&t.push(e)},t);function t(e){this._isStarted=!1,this._isEventsStarted=!1,this._gestureTimestamps=[],this._maxSensorSamples=0,this._sensorsTimestampDeltaInMillis=0,this._accelerometerList=[],this._gyroscopeList=[],this._linearAccelerometerList=[],this._rotationList=[],this.orientationImplementationFix=1,this.delegate=e,window.navigator.userAgent.match(/^.*(iPhone|iPad).*(OS\s[0-9]).*(CriOS|Version)\/[.0-9]*\sMobile.*$/i)&&(this.orientationImplementationFix=-1),this.accelerometerUpdateHandle=this.accelerometerUpdate.bind(this),this.orientationUpdateHandle=this.orientationUpdate.bind(this)}i.SecuredTouchSensors=e}(_securedTouchEntities=_securedTouchEntities||{}),function(o){var i;(e=i=i||{})[e.Up=1]="Up",e[e.Down=2]="Down",e[e.Left=3]="Left",e[e.Right=4]="Right";var e=(Object.defineProperty(t.prototype,"onGesture",{get:function(){return this._onGesture.asEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isStarted",{get:function(){return this._isStarted},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SCROLL_MIN_DURATION",{get:function(){return 500},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SWIPE_MAX_ANGLE",{get:function(){return 45},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TAP_MOVEMENT_TRESHOLD",{get:function(){return 10},enumerable:!0,configurable:!0}),t.prototype.clearTouchSnapshots=function(e){this.touchSnapshotsMap.delete(e),this.snapshotStartTime.delete(e)},t.prototype.getTouchSnapshots=function(e){var t;return this.touchSnapshotsMap.has(e)?t=this.touchSnapshotsMap.get(e):this.touchSnapshotsMap.set(e,t=[]),t},t.prototype.isEmpty=function(){return 0===this.touchSnapshotsMap.size},t.prototype.start=function(){this._isStarted||(o.SecuredTouchUtil.addEventListener(document,"touchstart",this.touchStartHandler),o.SecuredTouchUtil.addEventListener(document,"touchmove",this.touchMoveHandler),o.SecuredTouchUtil.addEventListener(document,"touchend",this.touchEndHandler),o.SecuredTouchUtil.addEventListener(document,"touchcancel",this.touchCancelHandler),this._isStarted=!0)},t.prototype.stop=function(){this._isStarted&&(document.removeEventListener("touchstart",this.touchStartHandler),document.removeEventListener("touchmove",this.touchMoveHandler),document.removeEventListener("touchend",this.touchEndHandler),document.removeEventListener("touchcancel",this.touchCancelHandler),this._isStarted=!1)},t.prototype.touchStart=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return;o.STLogger.debug("touchstart("+e.changedTouches.length+")",e),0<e.changedTouches.length&&this.pushSnapshot(e)}catch(e){o.STLogger.warn("error in touchStart handler",e)}},t.prototype.touchMove=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return;o.STLogger.debug("touchmove("+e.changedTouches.length+")",e),0<e.changedTouches.length&&this.pushSnapshot(e)}catch(e){o.STLogger.warn("error in touchMove handler",e)}},t.prototype.touchEnd=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return void this._onGesture.dispatch(this,null);o.STLogger.debug("touchend("+e.changedTouches.length+")",e),this.gestureEnd(e)}catch(e){o.STLogger.warn("error in touchEnd handler",e)}},t.prototype.touchCancel=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return void this._onGesture.dispatch(this,null);o.STLogger.debug("touchcancel("+e.changedTouches.length+")",e),this.gestureEnd(e)}catch(e){o.STLogger.warn("error in touchCancel handler",e)}},t.prototype.gestureEnd=function(e){0<e.changedTouches.length&&this.pushSnapshot(e);for(var t=0;t<e.changedTouches.length;t++){var n=e.changedTouches.item(t),i=this.getTouchSnapshots(n.identifier);0<i.length&&(this.isTap(i)?this.dispatchGesture(o.GestureType.Tap,n.identifier):this.dispatchGesture(this.calcGestureType(i),n.identifier))}},t.prototype.calcGestureType=function(e){var t,n=this.getDirection(e);if(this.isFling(e))switch(n){case i.Up:t=o.GestureType.FlingUp;break;case i.Right:t=o.GestureType.FlingRight;break;case i.Down:t=o.GestureType.FlingDown;break;case i.Left:t=o.GestureType.FlingLeft}else if(this.isScroll(e))switch(n){case i.Up:t=o.GestureType.ScrollUp;break;case i.Right:t=o.GestureType.ScrollRight;break;case i.Down:t=o.GestureType.ScrollDown;break;case i.Left:t=o.GestureType.ScrollLeft}return t},t.prototype.pushSnapshot=function(e){if(e.changedTouches&&0<e.changedTouches.length)for(var t=0;t<e.changedTouches.length;t++){var n=e.changedTouches.item(t),i=n.radiusX&&n.radiusY?(n.radiusX+n.radiusY)/2:null;this.snapshotStartTime.has(n.identifier)||this.snapshotStartTime.set(n.identifier,(new Date).getTime());var r=this.getTouchSnapshots(n.identifier);r.length<o.SecuredTouchPointerConfig.instance.maxSnapshotsCount&&r.push({timestamp:o.SecuredTouchUtil.now(),relativeX:n.screenX,relativeY:n.screenY,x:n.clientX,y:n.clientY,pressure:n.force,size:i,xaccelerometer:this.sensors.accX,yaccelerometer:this.sensors.accY,zaccelerometer:this.sensors.accZ,xlinearaccelerometer:this.sensors.lienarAccX,ylinearaccelerometer:this.sensors.lienarAccY,zlinearaccelerometer:this.sensors.lienarAccZ,xrotation:this.sensors.rotX,yrotation:this.sensors.rotY,zrotation:this.sensors.rotZ,additionalData:{radiusX:n.radiusX,radiusY:n.radiusY,rotationAngle:n.rotationAngle,pageX:n.pageX,pageY:n.pageY,eventTimeStamp:e.timeStamp}})}},t.prototype.dispatchGesture=function(e,t){var n=this.touchSnapshotsMap.get(t)||[],i=o.SecuredTouchUtil.getDeviceOrientation();this._onGesture.dispatch(this,{timestamp:0<n.length?n[0].timestamp:0,epochTs:this.snapshotStartTime.get(t)||0,counter:null,type:e,snapshots:n,vector:{},attributes:{},additionalData:{width:screen.width,height:screen.height,availWidth:screen.availWidth,availHeight:screen.availHeight,deviceOrientation:i.orientation,deviceAngle:i.angle,locationHref:o.SecuredTouchUtil.getCurrentLocationUrl(),windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,windowInnerWidth:window.innerWidth,windowInnerHeight:window.innerHeight,bodyClientWidht:document.body.clientWidth,bodyClientHeight:document.body.clientHeight,devicePixelRatio:window.devicePixelRatio,clientDigest:o.SecuredTouchPointerConfig.instance.clientDigest,windowId:o.SecuredTouchSessionStorage.instance.windowId},identified:null}),this.clearTouchSnapshots(t)},t.prototype.isTap=function(e){var t=Math.abs(e[0].x-e[1].x),n=Math.abs(e[0].y-e[1].y);return 2==e.length&&t<this.TAP_MOVEMENT_TRESHOLD&&n<this.TAP_MOVEMENT_TRESHOLD},t.prototype.isFling=function(e){return 1<e.length&&e[e.length-1].timestamp-e[0].timestamp<this.SCROLL_MIN_DURATION},t.prototype.isScroll=function(e){return 1<e.length&&e[e.length-1].timestamp-e[0].timestamp>this.SCROLL_MIN_DURATION},t.prototype.getDirection=function(e){e=this.calcAngle(e[0],e[e.length-1]);return e>90-this.SWIPE_MAX_ANGLE&&e<=90+this.SWIPE_MAX_ANGLE?i.Up:e>180-this.SWIPE_MAX_ANGLE&&e<=180+this.SWIPE_MAX_ANGLE?i.Right:e>270-this.SWIPE_MAX_ANGLE&&e<=270+this.SWIPE_MAX_ANGLE?i.Down:i.Left},t.prototype.calcAngle=function(e,t){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI+180},t);function t(e,t){this.BEHAVIORAL_TYPE="gestures",this._isStarted=!1,this._onGesture=new o.EventDispatcher,this.touchSnapshotsMap=new Map,this.snapshotStartTime=new Map,this.delegate=e,this.sensors=t,this.touchStartHandler=this.touchStart.bind(this),this.touchMoveHandler=this.touchMove.bind(this),this.touchEndHandler=this.touchEnd.bind(this),this.touchCancelHandler=this.touchCancel.bind(this)}o.SecuredTouchGestureEvents=e}(_securedTouchEntities=_securedTouchEntities||{}),function(e){var t=(n.isPrivateMode=function(){return new Promise(function(e){function t(){return e(!0)}function n(){return e(!1)}var i,r,o,a;try{if((r=navigator&&/(?=.*(opera|chrome)).*/i.test(navigator.userAgent)&&navigator.storage&&navigator.storage.estimate)&&navigator.storage.estimate().then(function(e){(e.quota<12e7?t:n)()}).catch(function(e){n()}),r)return;if((a="MozAppearance"in document.documentElement.style)&&(null==indexedDB?t():((o=indexedDB.open("inPrivate")).onsuccess=n,o.onerror=t)),a)return;if(function(){var e=navigator&&navigator.userAgent&&navigator.userAgent.match(/Version\/([0-9\._]+).*Safari/);if(e){if(parseInt(e[1],10)<11)return function(){try{localStorage.length||(localStorage.setItem("inPrivate","0"),localStorage.removeItem("inPrivate")),n()}catch(e){(navigator.cookieEnabled?t:n)()}return 1}();try{window.openDatabase(null,null,null,null),n()}catch(e){t()}}return e}())return;if((i=!window.indexedDB&&(window.PointerEvent||window.MSPointerEvent))&&t(),i)return}catch(e){}return n()})},n);function n(){}e.SecuredTouchIncognito=t}(_securedTouchEntities=_securedTouchEntities||{}),function(i){var e=(Object.defineProperty(t.prototype,"deviceId",{set:function(e){this._deviceId=e||""},enumerable:!0,configurable:!0}),t.prototype.sendRemoteLog=function(e,t,n){this.enabledByHostingApp&&i.SecuredTouchPointerConfig.instance.remoteLogsEnabled&&i.SecuredTouchSessionStorage.instance.remoteLogEnabledByFactor&&this.counter<i.SecuredTouchPointerConfig.instance.maxRemoteLogs&&(n={appId:this.applicationId,instanceUUID:i.SecuredTouchSessionStorage.instance.windowId,pointerServerUrl:this.pointerServerUrl,clientVersion:this.clientVersion,packageName:i.SecuredTouchUtil.getHostnameFromRegex(location.href),deviceId:this._deviceId,deviceType:this.stMetadata.deviceType,osName:this.stMetadata.osName,osVersion:this.stMetadata.osVersion,browserName:this.stMetadata.browserName,browserVersion:this.stMetadata.browserVersion,location:location.href,logsCount:this.counter++,errorCode:e,message:t,errorReason:i.SecuredTouchUtil.getErrorAsString(n),enabledFactor:this.enabledFactor},this.postLog(n).catch(function(e){i.STLogger.warn("Failed to send log to SecuredTouch",e)}))},t.prototype.postLog=function(o){var a=this;return new Promise(function(e,t){try{var n=new XMLHttpRequest;n.open("POST",a.logUrl,!0),n.timeout=1e4,n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("Accept","application/json"),n.onload=function(){200<=n.status&&n.status<400?e():t({status:n.status,statsText:n.statusText})},n.ontimeout=function(e){t(e)},n.onerror=function(e){t({status:n.status,statsText:n.statusText})};var i=JSON.stringify(o),r=void 0;try{r=Boolean(_securedTouchDependencies.pako)&&!window["unzip-securedtouch"]}catch(e){r=!1}r?(n.setRequestHeader("Content-Encoding","gzip"),n.send(_securedTouchDependencies.pako.gzip(i))):n.send(i)}catch(e){t(e)}})},t);function t(e,t,n){this.logUrl="https://logs.securedtouch.com/log",this.enabledFactor=window._remoteLogEnabledFactor?Number(window._remoteLogEnabledFactor):.01,this._deviceId="",this.counter=0,this.enabledByHostingApp=!e.hasOwnProperty("externalLogsEnabled")||Boolean(e.externalLogsEnabled),this.applicationId=e.appId,this.pointerServerUrl=e.url,this.clientVersion=n,this.stMetadata=t,null==i.SecuredTouchSessionStorage.instance.remoteLogEnabledByFactor&&(i.SecuredTouchSessionStorage.instance.remoteLogEnabledByFactor=Math.random()<=this.enabledFactor)}i.SecuredTouchRemoteLogger=e}(_securedTouchEntities=_securedTouchEntities||{}),function(e){var t=(Object.defineProperty(n,"E_1000",{get:function(){return 1e3},enumerable:!0,configurable:!0}),Object.defineProperty(n,"E_1001",{get:function(){return 1001},enumerable:!0,configurable:!0}),Object.defineProperty(n,"E_1002",{get:function(){return 1002},enumerable:!0,configurable:!0}),Object.defineProperty(n,"E_3000",{get:function(){return 3e3},enumerable:!0,configurable:!0}),Object.defineProperty(n,"E_4000",{get:function(){return 4e3},enumerable:!0,configurable:!0}),Object.defineProperty(n,"E_4001",{get:function(){return 4001},enumerable:!0,configurable:!0}),Object.defineProperty(n,"E_5000",{get:function(){return 5e3},enumerable:!0,configurable:!0}),Object.defineProperty(n,"E_5001",{get:function(){return 5001},enumerable:!0,configurable:!0}),Object.defineProperty(n,"E_6000",{get:function(){return 6e3},enumerable:!0,configurable:!0}),n);function n(){}e.SecuredTouchErrorCodes=t}(_securedTouchEntities=_securedTouchEntities||{}),function(u){var e=(Object.defineProperty(t.prototype,"WEB_GL_ID",{get:function(){return this.isIphoneOrIPad,""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OPS",{get:function(){if(!this.isIphoneOrIPad)return 0;var e=this.sessionData.ops;return e||(e=this.getOps(),this.sessionData.ops=e),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deviceCategory",{get:function(){return this.userAgentData&&this.userAgentData.device?this.userAgentData.device.type:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"browserName",{get:function(){return this.userAgentData&&this.userAgentData.browser&&this.userAgentData.browser.name?this.userAgentData.browser.name.trim():""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"browserVersion",{get:function(){return this.userAgentData&&this.userAgentData.browser&&this.userAgentData.browser.version?this.userAgentData.browser.version.trim():""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"osName",{get:function(){return this.userAgentData&&this.userAgentData.os&&this.userAgentData.os.name?this.userAgentData.os.name.trim():""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"osVersion",{get:function(){return this.userAgentData&&this.userAgentData.os&&this.userAgentData.os.version?this.userAgentData.os.version.trim():""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deviceModel",{get:function(){return this.userAgentData&&this.userAgentData.device&&this.userAgentData.device.model?this.userAgentData.device.model.trim():""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deviceVendor",{get:function(){return this.userAgentData&&this.userAgentData.device&&this.userAgentData.device.vendor?this.userAgentData.device.vendor.trim():""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"engineName",{get:function(){return this.userAgentData&&this.userAgentData.engine&&this.userAgentData.engine.name?this.userAgentData.engine.name.trim():""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"engineVersion",{get:function(){return this.userAgentData&&this.userAgentData.engine&&this.userAgentData.engine.version?this.userAgentData.engine.version.trim():""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cpuArchitecture",{get:function(){return this.userAgentData&&this.userAgentData.cpu&&this.userAgentData.cpu.architecture?this.userAgentData.cpu.architecture.trim():""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"desktopType",{get:function(){var e=this.browserName;this.browserVersion&&(e=e+"("+this.browserVersion+")");var t=this.osName;this.osVersion&&(t=t+"("+this.osVersion+")");t=e&&t?e+"-"+t:e||t;return t?t.trim():""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mobileType",{get:function(){var e=this.deviceModel,t=this.deviceVendor,t=e&&t?e+" "+t:e||t;return t?t.trim():""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deviceType",{get:function(){return this._deviceType||(u.SecuredTouchUtil.isMobile?this._deviceType=this.mobileType||this.desktopType||t.UNKNOWN_DEVICE_TYPE:this._deviceType=this.desktopType||this.mobileType||t.UNKNOWN_DEVICE_TYPE),this._deviceType},enumerable:!0,configurable:!0}),t.prototype.initUAParser=function(){try{var e=new _securedTouchDependencies.UAParser;e.setUA(navigator.userAgent),this.userAgentData=e.getResult()}catch(e){u.STLogger.warn("UAParser failure",e)}},t.prototype.bluetoothInit=function(){var n=this;return new Promise(function(e,t){navigator.bluetooth?n.bluetoothSupported=!0:u.STLogger.debug("Bluetooth not supported!"),e()})},t.prototype.batteryInit=function(){var n=this,i=this;return new Promise(function(t,e){navigator.getBattery?(n.isBatterySupported=!0,navigator.getBattery().then(function(e){e&&(i.batteryLevel=e.level,i.batteryCharging=e.charging,i.batteryChargingTime=e.chargingTime,i.batteryDischargingTime=e.dischargingTime),t()}).catch(function(e){u.STLogger.warn("Battery "+e),t()})):(u.STLogger.debug("Battery not supported!"),t())})},t.prototype.enumerateDevicesEnabled=function(){var e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return!u.SecuredTouchUtil.inIframe()||!e},t.prototype.audioIntVideoInit=function(){var n=this,i=this;return new Promise(function(t,e){return n.enumerateDevicesEnabled()?navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?void navigator.mediaDevices.enumerateDevices().then(function(e){e.forEach(function(e){e.kind&&("audioinput"==e.kind.toLowerCase()?(i.hasMicrophone=!0,i.numberOfAudioDevices++):"videoinput"==e.kind.toLowerCase()?(i.hasWebcam=!0,i.numberOfVideoDevices++):"audiooutput"==e.kind.toLowerCase()&&(i.hasSpeakers=!0,i.numberOfAudioDevices++))}),t()}).catch(function(e){u.STLogger.warn("enumerateDevices failed",e),t()}):(u.STLogger.debug("enumerateDevices() not supported."),void t()):(u.STLogger.debug("enumerateDevices() cannot run within safari iframe"),void t())})},t.prototype.getRTCPeerConnection=function(){var e,t=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;return t||(e=window["iframe.contentWindow"])&&(t=e.RTCPeerConnection||e.mozRTCPeerConnection||e.webkitRTCPeerConnection),t},t.prototype.collectWebRtc=function(){var n=this;try{var i={},t=new(this.getRTCPeerConnection())({iceServers:[{urls:u.SecuredTouchPointerConfig.instance.webRtcUrl.trim()}]},{optional:[{RtpDataChannels:!0}]});t.onicecandidate=function(e){var t;e.candidate&&(t=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/.exec(e.candidate.candidate)[1],void 0===i[t]&&(0<e.candidate.candidate.indexOf("host")?n.webRtcIps.set("WEB_RTC_HOST_IP",t):0<e.candidate.candidate.indexOf("srflx")&&n.webRtcIps.set("WEB_RTC_SRFLX_IP",t)),i[t]=!0)},t.createDataChannel(""),t.createOffer(function(e){t.setLocalDescription(e,function(){},function(){})},function(){})}catch(e){}},t.prototype.getDeviceMetadata=function(a){return __awaiter(this,void 0,void 0,function(){var t,n,i,r,o;return __generator(this,function(e){switch(e.label){case 0:return u.SecuredTouchMetrics.instance.metadata.onCalcStarted(),this.gpsSupported=null!=navigator.geolocation,t=new Set(u.SecuredTouchPointerConfig.instance.propertyBlackList||[]),n=[this.getFingerPrint().catch(function(e){u.STLogger.warn("failed to get fingerprint info",e),a&&a.sendRemoteLog(u.SecuredTouchErrorCodes.E_4001,"getFingerPrint failed",e)}),this.getPrivateMode().catch(function(e){return u.STLogger.warn("failed to get incognito info",e)}),u.SecuredTouchIncognito.isPrivateMode().catch(function(e){return u.STLogger.warn("failed to get private mode info",e)}),this.getPermissionsMetadata().catch(function(e){return u.STLogger.warn("failed to get permissions info",e)}),new u.SecuredTouchDetectHeadless(t).getHeadlessResults().catch(function(e){return u.STLogger.warn("failed to get headless results",e)}),this.bluetoothInit().catch(function(e){return u.STLogger.warn("failed to get bluetooth info",e)}),this.audioIntVideoInit().catch(function(e){return u.STLogger.warn("failed to get audio-video info",e)}),this.batteryInit().catch(function(e){return u.STLogger.warn("failed to get battery info",e)})],[4,Promise.all(n)];case 1:return o=e.sent(),this.fingerPrint=o[0],this.isPrivateMode=o[1],this.isPrivateModeV2=o[2],this.permissions=o[3],this.headlessTests=o[4],r={ops:this.OPS,webGl:this.WEB_GL_ID,devicePixelRatio:window.devicePixelRatio,screenWidth:window.screen.width,screenHeight:window.screen.height},u.SecuredTouchUtil.extendPrimitiveValues(r,screen,!1),i=(new Date).getTime(),o={deviceType:this.deviceType,deviceId:this.sessionData.getDeviceCredentials().deviceId,osVersion:(this.osName+" "+this.osVersion).trim()||"",display:r,sensorsMetadata:this.getSensorsMetadata()},[4,this.getIdentificationMetadata(t)];case 2:return o.identificationMetadata=e.sent(),o.ioMetadata=this.getIoMetadata(),o.baseTimestamp=i,o.epochTimeInMillis=i,r=o,u.SecuredTouchMetrics.instance.metadata.onCalcEnded(),[2,r]}})})},t.prototype.getFingerPrint=function(){return __awaiter(this,void 0,void 0,function(){var s,t,n,c=this;return __generator(this,function(e){switch(e.label){case 0:return s=this,t=new Promise(function(i,r){try{var e={excludes:{enumerateDevices:!c.enumerateDevicesEnabled(),pixelRatio:!0,openDatabase:!0,addBehavior:!0}};try{for(var t=u.SecuredTouchPointerConfig.instance.fingerPrintBlacklist||[],n=0,o=t;n<o.length;n++){var a=o[n];e.excludes[a]=!0}}catch(e){u.STLogger.warn("Failed to apply fingerPrint blacklist",e)}_securedTouchDependencies.Fingerprint2.get(e,function(e){try{var t=e.map(function(e){return e.value}),n=_securedTouchDependencies.Fingerprint2.x64hash128(t.join(""),31);s.fingerPrintComponents=e,c.fingerPrint=n,i(n)}catch(e){u.STLogger.warn("Fingerprint callback failure "+e),r("Fingerprint callback failure "+e)}})}catch(e){u.STLogger.warn("Failed to get FingerPrint "+e),r("Failed to get FingerPrint "+e)}}),n=new Promise(function(e,t){return __awaiter(c,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,u.SecuredTouchUtil.delay(3e3)];case 1:return e.sent(),t("Fingerprint timeout"),[2]}})})}),[4,Promise.race([t,n])];case 1:return[2,e.sent()]}})})},t.prototype.getSensorsMetadata=function(){var e={};return this.flatAndAddMetadata(e,"DEDVCE_LIGHT_SUPPORTED",function(){return"ondevicelight"in window}),this.flatAndAddMetadata(e,"IS_TOUCH_DEVICE",function(){return"ontouchstart"in window}),window.DeviceMotionEvent||this.flatAndAddMetadata(e,"ACCELEROMETER_SUPPORTED",function(){return!1}),window.DeviceOrientationEvent||this.flatAndAddMetadata(e,"GYROSCOPE_SUPPORTED",function(){return!1}),this.flatAndAddMetadata(e,"PROXIMITY_SUPPORTED",function(){return"ondeviceproximity"in window}),e},t.prototype.getIdentificationMetadata=function(c){return __awaiter(this,void 0,void 0,function(){var n,i,t,r,o,a,s=this;return __generator(this,function(e){switch(e.label){case 0:return i={},(n=this).flatAndAddMetadata(i,"FINGER_PRINT",function(){return s.fingerPrint}),this.userAgentData&&(this.flatAndAddMetadata(i,"OS_NAME",function(){return s.osName}),this.flatAndAddMetadata(i,"OS_VERSION",function(){return s.osVersion})),this.userAgentData&&(this.flatAndAddMetadata(i,"DEVICE_MODEL",function(){return s.deviceModel}),this.flatAndAddMetadata(i,"DEVICE_VENDOR",function(){return s.deviceVendor})),this.userAgentData&&(this.flatAndAddMetadata(i,"BROWSER_ENGINE_NAME",function(){return s.engineName}),this.flatAndAddMetadata(i,"BROWSER_ENGINE_VERSION",function(){return s.engineVersion})),this.userAgentData&&this.flatAndAddMetadata(i,"CPU_ARCHITECTURE",function(){return s.cpuArchitecture}),this.flatAndAddMetadata(i,"NAVIGATOR_VENDOR",function(){return navigator.vendor}),this.flatAndAddMetadata(i,"NAVIGATOR_PLUGINS_LENGTH",function(){return navigator.plugins?navigator.plugins.length:null}),this.flatAndAddMetadata(i,"NAVIGATOR_LANGUAGE",function(){return navigator.language}),this.flatAndAddMetadata(i,"NAVIGATOR_LANGUAGES",function(){return navigator.languages}),this.flatAndAddMetadata(i,"NAVIGATOR_MAX_TOUCH_POINTS",function(){return navigator.maxTouchPoints||navigator.msMaxTouchPoints}),this.flatAndAddMetadata(i,"NAVIGATOR_POINTER_ENABLED",function(){return navigator.pointerEnabled||navigator.msPointerEnabled}),this.flatAndAddMetadata(i,"NAVIGATOR_WEB_DRIVER",function(){return navigator.webdriver}),this.flatAndAddMetadata(i,"NAVIGATOR_HARDWARE_CONCURRENCY",function(){return navigator.hardwareConcurrency}),this.flatAndAddMetadata(i,"NAVIGATOR_VIBRATE",function(){return null!=navigator.vibrate}),this.flatAndAddMetadata(i,"PUSH_NOTIFICATIONS_SUPPORTED",function(){return"Notification"in window}),this.flatAndAddMetadata(i,"NAVIGATOR_APP_CODE_NAME",function(){return navigator.appCodeName}),this.flatAndAddMetadata(i,"NAVIGATOR_APP_NAME",function(){return navigator.appName}),this.flatAndAddMetadata(i,"NAVIGATOR_APP_VERSION",function(){return navigator.appVersion}),this.flatAndAddMetadata(i,"NAVIGATOR_ON_LINE",function(){return navigator.onLine}),this.flatAndAddMetadata(i,"NAVIGATOR_PLATFORM",function(){return navigator.platform}),this.flatAndAddMetadata(i,"NAVIGATOR_PRODUCT",function(){return navigator.product}),this.flatAndAddMetadata(i,"NAVIGATOR_USER_AGENT",function(){return navigator.userAgent}),this.flatAndAddMetadata(i,"NAVIGATOR_DEVICE_MEMORY",function(){return navigator.deviceMemory}),c.has("modernizr")?[3,2]:[4,this.safeAddModernizrFeatures(i)];case 1:e.sent(),e.label=2;case 2:for(window._ST_PING?this.flatAndAddMetadata(i,"JS_CHALLENGE",function(){return window._ST_PING}):this.flatAndAddMetadata(i,"JS_CHALLENGE",function(){return"unknown"}),this.fingerPrintComponents&&this.fingerPrintComponents.forEach(function(e,t){"fonts"==e.key?s.flatAndAddMetadata(i,"JS_FONTS",function(){return e.value.length}):"webgl"==e.key?s.flatAndAddMetadata(i,"IS_WEBGL",function(){return null!=e.value}):"canvas"==e.key?s.flatAndAddMetadata(i,"IS_CANVAS",function(){return null!=e.value}):"screenResolution"==e.key&&e.value&&e.value.length?s.flatAndAddMetadata(i,"RESOLUTION",function(){return e.value.join(",")}):"availableScreenResolution"==e.key&&e.value&&e.value.length?s.flatAndAddMetadata(i,"AVAILABLE_RESOLUTION",function(){return e.value.join(",")}):"touchSupport"==e.key&&e.value&&e.value.length?s.flatAndAddMetadata(i,"TOUCH_SUPPORT",function(){return e.value.join(",")}):"audio"==e.key&&e.value&&e.value.length?s.flatAndAddMetadata(i,"AUDIO_FINGERPRINT",function(){return e.value}):"indexedDb"==e.key&&e.value&&e.value.length?s.flatAndAddMetadata(i,"INDEXEDDB_FINGERPRINT",function(){return e.value}):n.fingerPrintComponentKeys.has(e.key)&&null!=e.key&&s.flatAndAddMetadata(i,e.key.toUpperCase(),function(){return e.value})}),this.flatAndAddMetadata(i,"IS_INCOGNITO",function(){return s.isPrivateMode}),this.flatAndAddMetadata(i,"IS_PRIVATE_MODE",function(){return s.isPrivateModeV2}),this.flatAndAddMetadata(i,"IS_WEB_GLSTATUS",function(){return s.webGlStatus}),t={selenium:navigator.webdriver||u.SecuredTouchUtil.getAttribute(window.document.documentElement,"webdriver")||"",phantomjs:{_phantom:window._phantom||"",__phantomas:window.__phantomas||"",callPhantom:window.callPhantom||""},nodejs:{Buffer:window.Buffer||""},couchjs:{emit:window.emit||""},rhino:{spawn:window.spawn||""},chromium:{domAutomationController:window.domAutomationController||"",domAutomation:window.domAutomation||""},outerWidth:window.outerWidth,outerHeight:window.outerHeight},this.flatAndAddMetadata(i,"HEADLESS",function(){return t}),this.flatAndAddMetadata(i,"HEADLESS",function(){return s.headlessTests}),this.flatAndAddMetadata(i,"REF_LINK",function(){return document.referrer}),r={length:navigator.plugins.length,details:[]},o=0;o<r.length;o++)r.details.push({name:navigator.plugins[o].name,version:navigator.plugins[o].version,filename:navigator.plugins[o].filename});return this.flatAndAddMetadata(i,"PLUGINS",function(){return r}),this.flatAndAddMetadata(i,"AUDIO",function(){return s.numberOfAudioDevices}),this.flatAndAddMetadata(i,"VIDEO",function(){return s.numberOfVideoDevices}),window.performance&&window.performance.memory&&(this.flatAndAddMetadata(i,"MEMORY_HEAP_SIZE_LIMIT",function(){return window.performance.memory.jsHeapSizeLimit}),this.flatAndAddMetadata(i,"MEMORY_TOTAL_HEAP_SIZE",function(){return window.performance.memory.totalJSHeapSize}),this.flatAndAddMetadata(i,"MEMORY_USED_HEAP_SIZE",function(){return window.performance.memory.usedJSHeapSize})),this.flatAndAddMetadata(i,"IS_ACCEPT_COOKIES",function(){return navigator.cookieEnabled}),!c.has("cookieChallenge")&&navigator.cookieEnabled&&(a="ST-TEST",u.SecuredTouchUtil.setCookie(a,"TEST",40),u.SecuredTouchUtil.delay(3e4).then(function(){s.isDelayPassed=!0,s.isAutoDeleteCookie=!u.SecuredTouchUtil.getCookie(a),u.SecuredTouchUtil.deleteCookie(a)})),this.flatAndAddMetadata(i,"selenium_in_document",function(){return s.seleniumInDocument()}),this.flatAndAddMetadata(i,"selenium_in_window",function(){return s.seleniumInWindow()}),this.flatAndAddMetadata(i,"selenium_sequentum",function(){return s.seleniumSequentum()}),this.flatAndAddMetadata(i,"DOCUMENT_ELEMENT_SELENIUM",function(){return u.SecuredTouchUtil.getAttribute(window.document.documentElement,"selenium")}),this.flatAndAddMetadata(i,"DOCUMENT_ELEMENT_WEBDRIVER",function(){return u.SecuredTouchUtil.getAttribute(window.document.documentElement,"webdriver")}),this.flatAndAddMetadata(i,"DOCUMENT_ELEMENT_DRIVER",function(){return u.SecuredTouchUtil.getAttribute(window.document.documentElement,"driver")}),this.flatAndAddMetadata(i,"WEB_RTC_ENABLED",function(){return!!s.getRTCPeerConnection()}),u.SecuredTouchPointerConfig.instance.webRtcUrl&&0<u.SecuredTouchPointerConfig.instance.webRtcUrl.length&&(this.collectWebRtc(),this.webRtcIps.forEach(function(e,t){null!=t&&null!=e&&s.flatAndAddMetadata(i,t,function(){return e})}),this.webRtcIps.clear()),window.matchMedia&&this.flatAndAddMetadata(i,"MQ_SCREEN",function(){var e=window.matchMedia("(min-width: "+(window.innerWidth-1)+"px)");return{matches:e.matches,media:e.media}}),this.flatAndAddMetadata(i,"IFRAME_CHROME",function(){var e=u.SecuredTouchUtil.createInvisibleElement("iframe");if(!e)return null;e.srcdoc="blank page",document.body.appendChild(e);var t=typeof e.contentWindow.chrome;return e.remove(),t}),window.Notification&&this.flatAndAddMetadata(i,"NOTIFICATION_PERMISSION",function(){return window.Notification.permission}),this.addPropertyDescriptorInfo(navigator,"NAVIGATOR_PROPERTY_DESCRIPTOR",u.SecuredTouchPointerConfig.instance.navigatorProperties,i),this.addPropertyDescriptorInfo(window,"WINDOW_PROPERTY_DESCRIPTOR",u.SecuredTouchPointerConfig.instance.windowProperties,i),[2,i]}})})},t.prototype.addPropertyDescriptorInfo=function(n,e,t,i){try{for(var r=this,o=0,a=t;o<a.length;o++)!function(t){r.flatAndAddMetadata(i,e+"_"+t.toUpperCase(),function(){var e=Object.getOwnPropertyDescriptor(n,t);return e?JSON.stringify({configurable:e.configurable,enumerable:e.enumerable,value:e.value,writable:e.writable}):"undefined"})}(a[o])}catch(n){u.STLogger.warn("failed to add properties descriptor",n)}},t.prototype.getPermissionsMetadata=function(){return __awaiter(this,void 0,void 0,function(){var n,i,r,t,o,a;return __generator(this,function(e){switch(e.label){case 0:if(n={},i=["accelerometer","accessibility-events","ambient-light-sensor","background-sync","camera","clipboard-read","clipboard-write","geolocation","gyroscope","magnetometer","microphone","midi","notifications","payment-handler","persistent-storage","push"],r=[],navigator.permissions)for(o in t=function(e){var t=i[e];r.push(navigator.permissions.query({name:t}).then(function(e){n[t]=e.state}).catch(function(e){}))},i)t(o);e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.all(r)];case 2:return e.sent(),[3,4];case 3:return a=e.sent(),u.STLogger.warn(a),[3,4];case 4:return[2,n]}})})},t.prototype.safeAddModernizrFeatures=function(s){return __awaiter(this,void 0,void 0,function(){var t,n,i,r,o,a;return __generator(this,function(e){switch(e.label){case 0:return _securedTouchDependencies.evaluateModernizr(),t=this,n=_securedTouchDependencies.Modernizr,i=n.prefixed,r=n.hasEvent,this.flatAndAddMetadata(s,"ambient_light",function(){return n.ambientlight}),this.flatAndAddMetadata(s,"application_cache",function(){return n.applicationcache}),this.flatAndAddMetadata(s,"audio",function(){return!!n.audio}),n.audio&&this.flatAndAddMetadata(s,"audio",function(){return n.audio}),this.flatAndAddMetadata(s,"battery_api",function(){return!!i("battery",navigator)||!!i("getBattery",navigator)}),this.flatAndAddMetadata(s,"blob_constructor",function(){return n.blobconstructor}),this.flatAndAddMetadata(s,"context_menu",function(){return n.contextmenu}),this.flatAndAddMetadata(s,"cors",function(){return n.cors}),this.flatAndAddMetadata(s,"cryptography",function(){return n.cryptography}),this.flatAndAddMetadata(s,"custom_elements",function(){return n.customelements}),this.flatAndAddMetadata(s,"custom_protocol_handler",function(){return n.customprotocolhandler}),this.flatAndAddMetadata(s,"custom_event",function(){return n.customevent}),this.flatAndAddMetadata(s,"dart",function(){return n.dart}),this.flatAndAddMetadata(s,"data_view",function(){return n.dataview}),this.flatAndAddMetadata(s,"event_listener",function(){return n.eventlistener}),[4,this.safeModernizrOn("exiforientation")];case 1:return o=e.sent(),t.flatAndAddMetadata(s,"exif_orientation",function(){return o}),this.flatAndAddMetadata(s,"force_touch",function(){return n.forcetouch}),n.forcetouch&&(this.flatAndAddMetadata(s,"force_touch.mouse_force_will_begin",function(){return r(i("mouseforcewillbegin",window,!1),window)}),this.flatAndAddMetadata(s,"force_touch.webkit_force_at_mouse_down",function(){return MouseEvent.WEBKIT_FORCE_AT_MOUSE_DOWN}),this.flatAndAddMetadata(s,"force_touch.webkit_force_at_force_mouse_down",function(){return MouseEvent.WEBKIT_FORCE_AT_FORCE_MOUSE_DOWN})),this.flatAndAddMetadata(s,"full_screen",function(){return n.fullscreen}),this.flatAndAddMetadata(s,"game_pads",function(){return n.gamepads}),this.flatAndAddMetadata(s,"geo_location",function(){return n.geolocation}),this.flatAndAddMetadata(s,"ie8compat",function(){return n.ie8compat}),[4,this.safeModernizrOn("indexeddb")];case 2:return a=e.sent(),t.flatAndAddMetadata(s,"indexed_db",function(){return a}),this.flatAndAddMetadata(s,"indexed_db_blob",function(){return n.indexeddbblob}),this.flatAndAddMetadata(s,"internationalization",function(){return n.intl}),this.flatAndAddMetadata(s,"json",function(){return n.json}),this.flatAndAddMetadata(s,"ligatures",function(){return n.ligatures}),this.flatAndAddMetadata(s,"media_source",function(){return"MediaSource"in window}),this.flatAndAddMetadata(s,"message_channel",function(){return n.messagechannel}),this.flatAndAddMetadata(s,"notification",function(){return n.notification}),this.flatAndAddMetadata(s,"page_visibility",function(){return n.pagevisibility}),this.flatAndAddMetadata(s,"performance",function(){return n.performance}),this.flatAndAddMetadata(s,"pointer_events",function(){return n.pointerevents}),this.flatAndAddMetadata(s,"pointer_lock",function(){return n.pointerlock}),this.flatAndAddMetadata(s,"proximity",function(){return n.proximity}),this.flatAndAddMetadata(s,"query_selector",function(){return n.queryselector}),this.flatAndAddMetadata(s,"quota_management",function(){return n.quotamanagement}),this.flatAndAddMetadata(s,"request_animation_frame",function(){return n.requestanimationframe}),this.flatAndAddMetadata(s,"service_worker",function(){return n.serviceworker}),this.flatAndAddMetadata(s,"touch_events",function(){return n.touchevents}),this.flatAndAddMetadata(s,"typed_arrays",function(){return n.typedarrays}),this.flatAndAddMetadata(s,"vibrate",function(){return n.vibrate}),this.flatAndAddMetadata(s,"video",function(){return!!n.video}),n.video&&this.flatAndAddMetadata(s,"video",function(){return n.video}),this.flatAndAddMetadata(s,"web_gl",function(){return n.webgl}),this.flatAndAddMetadata(s,"web_sockets",function(){return n.websockets}),this.flatAndAddMetadata(s,"x_domain_request",function(){return n.xdomainrequest}),this.flatAndAddMetadata(s,"matchmedia",function(){return n.matchmedia}),[2]}})})},t.prototype.getIoMetadata=function(){var e=this,t={},n=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return this.flatAndAddMetadata(t,"NETWORK_TYPE",function(){return n?n.type:null}),this.flatAndAddMetadata(t,"NETWORK_DOWNLOAD_MAX",function(){return n?n.downlinkMax:null}),this.flatAndAddMetadata(t,"BLUTOOTH_SUPPORTED",function(){return e.bluetoothSupported}),this.flatAndAddMetadata(t,"BLUTOOTH_DEVICE_NAME",function(){return e.bluetoothDeviceName}),this.flatAndAddMetadata(t,"BLUTOOTH_DEVICE_ID",function(){return e.bluetoothDeviceId}),this.flatAndAddMetadata(t,"BLUTOOTH_IS_CONNECTED",function(){return e.bluetoothIsConnected}),this.flatAndAddMetadata(t,"HAS_SPEAKERS",function(){return e.hasSpeakers}),this.flatAndAddMetadata(t,"HAS_MICROPHONE",function(){return e.hasMicrophone}),this.flatAndAddMetadata(t,"HAS_CAMERA",function(){return e.hasWebcam}),this.flatAndAddMetadata(t,"BATTERY_SUPPORTED",function(){return e.isBatterySupported}),this.flatAndAddMetadata(t,"BATTERY_LEVEL",function(){return e.batteryLevel}),this.flatAndAddMetadata(t,"BATTERY_CHARGING",function(){return e.batteryCharging}),this.flatAndAddMetadata(t,"BATTERY_CHARGING_TIME",function(){return e.batteryChargingTime}),this.flatAndAddMetadata(t,"BATTERY_DISCHARGING_TIME",function(){return e.batteryDischargingTime}),this.flatAndAddMetadata(t,"GPS_SUPPORTED",function(){return e.gpsSupported}),this.flatAndAddMetadata(t,"IS_MOBILE",function(){return u.SecuredTouchUtil.isMobile}),this.flatAndAddMetadata(t,"HAS_TOUCH",function(){return"ontouchstart"in document.documentElement}),this.flatAndAddMetadata(t,"PERMISSIONS",function(){return e.permissions}),t},t.prototype.safeAddMetadata=function(e,t,n){try{var i=new Set(u.SecuredTouchPointerConfig.instance.propertyBlackList||[]);null==t||null==n||i.has(t)||(e[t]=n)}catch(e){u.STLogger.warn("Failed to add "+t+" -> "+n+", "+e)}},t.prototype.safeModernizrOn=function(i){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(e){switch(e.label){case 0:return t=new Promise(function(t){try{_securedTouchDependencies.Modernizr.on(i,function(e){t(e)})}catch(e){t(null),u.STLogger.warn("Modernizr.on Failed with feature "+i,e)}}),n=u.SecuredTouchUtil.delay(1e3).then(function(){return null}),[4,Promise.race([t,n])];case 1:return[2,e.sent()]}})})},t.prototype.flatAndAddMetadata=function(e,t,n){try{var i=new Set(u.SecuredTouchPointerConfig.instance.propertyBlackList||[]);if(!t||i.has(t))return;var r=n();if("object"==typeof r&&null!==r){var o,a=u.SecuredTouchUtil.flatten(r);for(o in a)this.safeAddMetadata(e,t+"."+o,a[o])}else this.safeAddMetadata(e,t,r)}catch(e){u.STLogger.warn("Failed to add "+t,e)}},t.prototype.getOps=function(){for(var e,t=new Date,n=0;n++,e=(new Date).getTime()-t.getTime(),Math.sqrt(n*Math.random()),e<500;);var i=n/e;return u.STLogger.debug("Ops : "+i),i},t.prototype.getWebGl=function(){var e="",t="";try{var n,i=document.createElement("canvas"),r=i.getContext("webgl")?i.getContext("webgl"):i.getContext("experimental-webgl")?i.getContext("experimental-webgl"):i.getContext("moz-webgl")?i.getContext("moz-webgl"):i.getContext("webkit-3d");r?(n=r.getExtension("WEBGL_debug_renderer_info"),e=r.getParameter(r.VERSION).toLowerCase(),n&&(u.STLogger.debug("WegGl debugInfo: "+n),t=r.getParameter(n.UNMASKED_RENDERER_WEBGL).toLowerCase()),this.webGlStatus=1):(u.STLogger.warn("WegGl failure, context is null"),this.webGlStatus=0)}catch(e){u.STLogger.warn("WegGl discovery failure"+e)}return u.STLogger.debug("WegGl : "+t||e),t||e},t.prototype.getPrivateMode=function(){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(e){return n=this,[2,new Promise(function(t,e){n.detectPrivateMode(function(e){t(e)})})]})})},t.prototype.detectPrivateMode=function(e){var t=e.bind(null,!0),n=e.bind(null,!1);window.webkitRequestFileSystem?window.webkitRequestFileSystem(0,0,n,t):"MozAppearance"in document.documentElement.style?((e=indexedDB.open("test")).onerror=t,e.onsuccess=n):(/constructor/i.test(window.HTMLElement)||window.safari?function(){try{localStorage.length||(localStorage.x=1,localStorage.removeItem("x")),n()}catch(e){(navigator.cookieEnabled?t:n)()}}:window.indexedDB||!window.PointerEvent&&!window.MSPointerEvent?n:t)()},t.prototype.seleniumInDocument=function(){for(var e=0,t=["__webdriver_evaluate","__selenium_evaluate","__webdriver_script_function","__webdriver_script_func","__webdriver_script_fn","__fxdriver_evaluate","__driver_unwrapped","__webdriver_unwrapped","__driver_evaluate","__selenium_unwrapped","__fxdriver_unwrapped"];e<t.length;e++)if(document[t[e]])return!0;return!1},t.prototype.seleniumInWindow=function(){for(var e=0,t=["_phantom","__nightmare","_selenium","callPhantom","callSelenium","_Selenium_IDE_Recorder"];e<t.length;e++)if(window[t[e]])return!0;return!1},t.prototype.seleniumSequentum=function(){return window.external&&window.external.toString()&&-1!=window.external.toString().indexOf("Sequentum")},t.UNKNOWN_DEVICE_TYPE="unknown",t);function t(e){this.sessionData=e,this.hasMicrophone=null,this.hasSpeakers=null,this.hasWebcam=null,this.isBatterySupported=null,this.batteryLevel=null,this.batteryCharging=null,this.batteryChargingTime=null,this.batteryDischargingTime=null,this.isIphoneOrIPad=!1,this.headlessTests=new Map,this.gpsSupported=null,this.fingerPrintComponentKeys=new Set(["navigatorPlatform","webdriver","language","colorDepth","deviceMemory","pixelRatio","hardwareConcurrency","screenResolution","availableScreenResolution","timezoneOffset","timezone","sessionStorage","localStorage","indexedDb","addBehavior","openDatabase","cpuClass","platform","doNotTrack","canvas","webgl","webglVendorAndRenderer","adBlock","hasLiedLanguages","hasLiedResolution","hasLiedOs","hasLiedBrowser","touchSupport","fonts","fontsFlash","audio"]),this.webGlStatus=-1,this.numberOfVideoDevices=0,this.numberOfAudioDevices=0,this.webRtcIps=new Map,this.isDelayPassed=!1,this.isAutoDeleteCookie=!1,(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i))&&(this.isIphoneOrIPad=!0)}u.SecuredTouchMeatadata=e}(_securedTouchEntities=_securedTouchEntities||{}),function(r){var e=(Object.defineProperty(t,"instance",{get:function(){return t._instance=!t._instance?new t:t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tags",{get:function(){return this._tags},enumerable:!0,configurable:!0}),t.prototype.getTagsCopy=function(){return this._tags?Array.from(this._tags):[]},t.prototype.setTag=function(e,t){var n,i=!1;return e&&(n=t?e+":"+t:e,(t=r.SecuredTouchPointerConfig.instance.tagsBlacklistRegex)&&e.match(t)?r.STLogger.info("Tag "+e+" is blacklisted"):(this._tags.push({name:n,epochTs:Date.now(),timestamp:Date.now()}),i=!0,r.STLogger.info("Add tag: "+n))),i},t.prototype.reset=function(){this._tags=[]},t);function t(){this._tags=[]}r.SecuredTouchTags=e}(_securedTouchEntities=_securedTouchEntities||{}),function(o){var t;(e=t=o.ForceReason||(o.ForceReason={})).tag="TAG",e.refreshUser="REFRESH_USER",e.indirect="INDIRECT",e.flush="FLUSH",e.appSession="APP_SESSION_ID";var e=(Object.defineProperty(i,"MAX_NUMBER_OF_TRIES",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(i,"RETRY_UPDATE_INTERVAL_MS",{get:function(){return 6e4},enumerable:!0,configurable:!0}),Object.defineProperty(i,"RETRY_INTERVAL_MS",{get:function(){return 15e3},enumerable:!0,configurable:!0}),Object.defineProperty(i,"START_INTERACTION_INTERVAL_MS",{get:function(){return 12e4},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"initST",{get:function(){return this.sessionData.initST},enumerable:!0,configurable:!0}),i.prototype.isRunning=function(e){return 0===this._pauseTimestamp||Boolean(e&&e<=this._pauseTimestamp)},i.instance=function(){if(!this._instance){var e=new o.STServer,t=o.SecuredTouchSessionStorage.instance;if(!document.body)throw o.STLogger.error("Securedtouch can be started only after DOM Ready!"),"SecuredTouch can be started only after DOM Ready!";this._instance=new o.SecuredTouchClient(e,t)}return this._instance},i.prototype.flush=function(){return this.started&&this.isRunning()?this.forceSendCapturedEvents(t.flush):Promise.resolve()},i.prototype.sendHeartBeat=function(){return(new Date).getTime()-this.lastPayloadTimestamp>=o.SecuredTouchPointerConfig.instance.heartBeatFrequencyMs?(this.lastPayloadTimestamp=(new Date).getTime(),this.addTag(o.SecuredTouchConstants.HEART_BEAT_TAG),this.flush()):Promise.resolve()},i.prototype.setTag=function(e,t){return this.addTag(e,t),this.flush()},i.prototype.addTag=function(e,t){var n;this.isRunning()&&(n=o.SecuredTouchTags.instance.setTag(e,t),t=o.SecuredTouchPointerConfig.instance.tagsToFlushRegex,n&&t&&e.match(t)&&this.flush())},i.prototype.setAppSessionId=function(e){this.updateSessionId(e),this.started&&this.isRunning()&&this.forceSendCapturedEvents(t.appSession)},i.prototype.updateSessionId=function(e){o.SecuredTouchSessionStorage.instance.appSessionId=e,o.SecuredTouchPointerConfig.instance.refreshTokenOnSessionChange&&window.dispatchEvent(new CustomEvent("_appsessionchange",{detail:{appSessionId:e}}))},i.prototype.locationInWhitelist=function(){var e,t=o.SecuredTouchPointerConfig.instance.urlWhitelist;if(0===t.length)return!0;for(e in t)if(window.location.href.match(t[e]))return!0;return!1},i.prototype.isEnabled=function(){return o.SecuredTouchPointerConfig.instance.enabled&&this.locationInWhitelist()},Object.defineProperty(i.prototype,"isBehavioralDataPaused",{get:function(){return this._isBehavioralDataPaused},enumerable:!0,configurable:!0}),i.prototype.isInitAndEnabled=function(){return!(!this.isEnabled()||!this.sessionData.initST)||(this.sessionData.initST||this.tryRecconect(),!1)},i.prototype.startNewSession=function(){var t=this,e=this.sessionData.getDeviceCredentials().deviceId;return this.dataRepository.initSession({username:this.sessionData.getUsername()||e,applicationId:this.startParams.appId,deviceType:this.stMetadata.deviceType,deviceId:e,modes:this.modes}).then(function(e){e&&e.clientDigest&&t.updateDigest(e.clientDigest)}).catch(function(e){o.STLogger.warn("Failed to init session",e)})},i.prototype.doAfterSdkInit=function(e){return this.started?e():(this.startTasks.push(e),Promise.resolve())},i.prototype.login=function(e,t){var n=this,i=o.SecuredTouchUtil.now();return this.doAfterSdkInit(function(){return void 0!==t&&n.updateSessionId(t),n.refreshUsernameAndModes(e,0,1,!1,i)})},i.prototype.logout=function(){var e=this,t=o.SecuredTouchUtil.now();return this.doAfterSdkInit(function(){return e.updateSessionId(null),e.refreshUsernameAndModes(null,0,0,!0,t)})},i.prototype.pauseSecuredTouch=function(){var e=this;this.addTag("SDK paused"),this.flush(),this._pauseTimestamp=o.SecuredTouchUtil.now(),this.doAfterSdkInit(function(){return e.stopListening(),Promise.resolve()})},i.prototype.resumeSecuredTouch=function(){var e=this;this._pauseTimestamp=0,this.addTag("SDK resumed"),this.doAfterSdkInit(function(){return e.refreshListening(),Promise.resolve()})},i.prototype.pauseBehavioralData=function(){var e=this;this._isBehavioralDataPaused||(this._isBehavioralDataPaused=!0,this.addTag("SDK paused behaviorally"),this.doAfterSdkInit(function(){return e.flush()}))},i.prototype.resumeBehavioralData=function(){this._isBehavioralDataPaused&&(this._isBehavioralDataPaused=!1,this.addTag("SDK resumed behaviorally"))},i.prototype.refreshUsernameAndModes=function(t,e,n,i,r){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.sessionData.initST?this.isEnabled()?this.isRunning(r)?i?(o.STLogger.info("Logout user"),[2,this.resetSession()]):(o.STLogger.info("Login with user: "+t),[2,this.updateUser(t)]):(o.STLogger.info("SDK paused"),this.sessionData.setUsername(t),[2,Promise.resolve()]):(o.STLogger.warn("Refresh User Name FAILED, SDK is disabled"),[2,Promise.resolve()]):(o.STLogger.error("Refresh User Name FAILED, SDK wasn't initialized"),[2,Promise.resolve()])})})},i.prototype.isIdentified=function(){var e=this.sessionData.getUsername();return e&&e!==this.sessionData.getDeviceCredentials().deviceId},i.prototype.resetSession=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.isIdentified()&&this.addTag("LOGOUT"),this.clearBuffer(),[4,this.forceSendCapturedEvents(t.refreshUser)];case 1:return e.sent(),[4,this.startNewSession()];case 2:return e.sent(),this.sessionData.setUsername(null),[2]}})})},i.prototype.updateUser=function(e){return this.isIdentified()&&this.sessionData.getUsername()===e||this.addTag("SUCCESS_LOGIN"),this.sessionData.setUsername(e),this.forceSendCapturedEvents(t.refreshUser)},i.prototype.validateStartParams=function(e){if(!e.appId)throw this.logWasSent=!0,o.STLogger.error("ApplicationId is mandatory (Start parameters)!"),"ApplicationId is mandatory (Start parameters)!";if(!e.appSecret)throw this.logWasSent=!0,o.STLogger.error("Application secret is mandatory (Start parameters)!"),"Application secret is mandatory (Start parameters)!";if(!document.body)throw this.logWasSent=!0,o.STLogger.error("Securedtouch can be started only after DOM Ready!"),"SecuredTouch can be started only after DOM Ready!"},i.prototype.sendMetadata=function(){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),t=this.sessionData.getLastMetadataTimeStamp(),t=(new Date).getTime()-t>o.SecuredTouchConstants.METADATA_TTL_MILLIS,o.SecuredTouchMetrics.instance.metadata.setMetadataSkipped(!t),t?(o.STLogger.debug("Updating Metadata"),[4,this.stMetadata.getDeviceMetadata(this.stRemoteLogger)]):[3,3];case 1:return n=e.sent(),[4,this.dataRepository.sendMetadata(n)];case 2:e.sent(),this.sessionData.setLastMetadataTimeStamp((new Date).getTime()),e.label=3;case 3:return[3,5];case 4:return n=e.sent(),this.sendRemoteLog(o.SecuredTouchErrorCodes.E_4000,"Failed to send metadata",n),o.STLogger.warn("Failed to update metadata",n),[3,5];case 5:return[2]}})})},i.prototype.getStToken=function(){return window._securedTouchToken||""},i.prototype.sendRemoteLog=function(e,t,n){try{this.stRemoteLogger&&this.stRemoteLogger.sendRemoteLog(e,t,n)}catch(e){o.STLogger.warn("sendRemoteLog failed",e)}},i.prototype.setUsername=function(e){try{e.hasOwnProperty("userId")?this.sessionData.setUsername(e.userId):e.hasOwnProperty("username")&&this.sessionData.setUsername(e.username)}catch(e){this.sendRemoteLog(o.SecuredTouchErrorCodes.E_1001,"Failed to update username",e),o.STLogger.warn("Failed to update username",e)}},i.prototype.loadEventPromise=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(t){"complete"===document.readyState?t():window.addEventListener("load",function(e){t()})})]})})},i.prototype.startST=function(i){return __awaiter(this,void 0,void 0,function(){var t,n=this;return __generator(this,function(e){switch(e.label){case 0:this.logWasSent=!1,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.initQueue.add(function(){return n.start(i)})];case 2:return[2,e.sent()];case 3:throw t=e.sent(),this.logWasSent||this.sendRemoteLog(o.SecuredTouchErrorCodes.E_1000,"SDK initialization failed",t),t;case 4:return[2]}})})},i.prototype.start=function(i){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(e){switch(e.label){case 0:return i.waitForWindowLoad?[4,this.loadEventPromise()]:[3,2];case 1:e.sent(),e.label=2;case 2:return this.startParams=i,this.validateStartParams(i),this.clientVersion=i.isDebugMode?o.SecuredTouchConstants.CLIENT_VERSION+"-debug":o.SecuredTouchConstants.CLIENT_VERSION,this.started?(this.sessionData.initST=!0,[2,Promise.resolve("SDK already initialized")]):(this.stMetadata.initUAParser(),this.stRemoteLogger=new o.SecuredTouchRemoteLogger(i,this.stMetadata,o.SecuredTouchConstants.CLIENT_VERSION),o.SecuredTouchMetrics.instance.init.onInitStarted(),i.isDebugMode&&(this.modes.isDebugMode=1),o.STLogger.isLogEnabled=i.enableLog,o.STLogger.info("Starting STClient..."),this.sessionData.applicationId=i.appId,[4,this.sessionData.initDeviceStorage(i.hubUrl)]);case 3:e.sent(),this.dataRepository.init(this.startParams.appId,this.startParams.appSecret,this.startParams.url,this.clientVersion,this.stMetadata.deviceType),t=this.sessionData.getDeviceCredentials(),this.stRemoteLogger.deviceId=t.deviceId,n=o.SecuredTouchPointerConfig.instance,t=n.loadPointerFromCache(this.sessionData),e.label=4;case 4:return e.trys.push([4,6,,7]),o.SecuredTouchMetrics.instance.init.setPointerCached(!!t),[4,this.refreshInitParams(t)];case 5:return e.sent(),[3,7];case 6:throw n=e.sent(),this.logWasSent=!0,this.sendRemoteLog(o.SecuredTouchErrorCodes.E_3000,"Send init failed",n),"Init failed. "+o.SecuredTouchUtil.getErrorAsString(n);case 7:return this.setUsername(i),this.updateSessionId(i.sessionId),this.isEnabled()?[3,8]:(o.STLogger.warn("StClient disabled!"),[3,11]);case 8:return i.initSession?[4,this.startNewSession().catch(function(e){o.STLogger.warn("failed to init session",e)})]:[3,10];case 9:e.sent(),e.label=10;case 10:this.sendMetadata(),this.sessionData.passedBufferTimeout?this.dataRepository.clearCanceledPayloads():this.dataRepository.sendCanceledPayloads(),e.label=11;case 11:return this.sessionData.initST=!0,this.refreshListening(),this.started=!0,o.SecuredTouchMetrics.instance.init.onInitEnded(),[4,this.postSdkInit()];case 12:return e.sent(),[2]}})})},i.prototype.postSdkInit=function(){return __awaiter(this,void 0,void 0,function(){var t,n,i,r;return __generator(this,function(e){switch(e.label){case 0:for(n in e.trys.push([0,2,,3]),document.referrer&&this.addTag("referrer:"+document.referrer),o.SecuredTouchPointerConfig.instance.sendLocation&&this.addTag("location:"+window.location.href),this.addTag("SDK started"),t=[],this.startTasks)i=this.startTasks[n],o.SecuredTouchUtil.isFunction(i)&&t.push(i());return[4,Promise.all(t)];case 1:return e.sent(),[3,3];case 2:return r=e.sent(),this.sendRemoteLog(o.SecuredTouchErrorCodes.E_1002,"Post init failed",r),o.STLogger.warn("SDK post init failed",r),[3,3];case 3:return[2]}})})},i.prototype.updateDigest=function(e){var t=this,n=Promise.resolve();return!this.digestProcessing&&o.SecuredTouchPointerConfig.instance.clientDigest!==e&&this.isRunning()&&(this.digestProcessing=!0,n=this.refreshInitParams().then(function(){t.digestProcessing=!1,t.refreshListening()}).catch(function(e){t.digestProcessing=!1,o.STLogger.warn("refreshInitParams failed",e)})),n},i.prototype.refreshInitParams=function(i){return void 0===i&&(i=null),__awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(e){switch(e.label){case 0:return t=o.SecuredTouchPointerConfig.instance.enabled,i?[3,2]:(n=this.sessionData.getDeviceCredentials(),[4,o.SecuredTouchPointerConfig.instance.loadPointerFromServer(this.dataRepository,{device_id:n.deviceId,secret:n.deviceSecret,clientVersion:this.clientVersion,deviceType:this.stMetadata.deviceType,authToken:o.SecuredTouchPointerConfig.instance.token})]);case 1:e.sent(),e.label=2;case 2:return o.STLogger.debug("Refreshing pointer config"),t&&!o.SecuredTouchPointerConfig.instance.enabled&&o.STLogger.warn("ST client disabled by init params!"),[2]}})})},i.prototype.tryRecconect=function(){var t=this,n=this;!this.sessionData.initST&&Date.now()-this.lastRetryTimestamp>i.RETRY_UPDATE_INTERVAL_MS&&(this.lastRetryTimestamp=Date.now(),this.startST(this.startParams).catch(function(e){"object"==typeof e&&(e=JSON.stringify(e)),o.STLogger.error("FAILED to start STClient! ("+e+")"),t._retryNumber<o.SecuredTouchClientBase.MAX_NUMBER_OF_TRIES?(window.setTimeout(n.tryRecconect,i.RETRY_INTERVAL_MS),t._retryNumber++):(o.STLogger.error("Connecting retries exhausted!"),t._retryNumber=1)}),o.STLogger.debug("Reconnecting..."))},i.prototype.getEnvironmentData=function(){return{ops:this.stMetadata.OPS,webGl:this.stMetadata.WEB_GL_ID,devicePixelRatio:window.devicePixelRatio,screenWidth:window.screen.width,screenHeight:window.screen.height}},i.prototype.getDevToolsState=function(){var e=160<window.outerWidth-window.innerWidth,t=160<window.outerHeight-window.innerHeight;return t&&e||!(window.Firebug&&window.Firebug.chrome&&window.Firebug.chrome.isInitialized||e||t)?{open:!1,orientation:null}:{open:!0,orientation:e?"vertical":"horizontal"}},i.prototype.addCommonAdditionalData=function(e){var t;!o.SecuredTouchPointerConfig.instance.devToolsEnabled||(t=this.getDevToolsState())&&(t.open&&(e.DEV_TOOLS_OPEN=t.open),t.orientation&&(e.DEV_TOOLS_ORIENTATION=t.orientation)),this.stMetadata.isDelayPassed&&(this.stMetadata.isDelayPassed=!1,e.IS_AUTODLTE_COOKIES=this.stMetadata.isAutoDeleteCookie)},i);function i(e,t){this.dataRepository=e,this.sessionData=t,this._retryNumber=1,this._pauseTimestamp=0,this._isBehavioralDataPaused=!1,this.logWasSent=!1,this.started=!1,this.digestProcessing=!1,this.startTasks=[],this.modes={},this.lastRetryTimestamp=Date.now(),this.lastPayloadTimestamp=Date.now(),this.initQueue=new _securedTouchDependencies.StPromiseQueue(1),this.stMetadata=new o.SecuredTouchMeatadata(t)}o.SecuredTouchClientBase=e}(_securedTouchEntities=_securedTouchEntities||{}),function(n){var e=(Object.defineProperty(t.prototype,"isStarted",{get:function(){return this._isStarted},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onClipboardEvent",{get:function(){return this._onClipboardEvent.asEvent()},enumerable:!0,configurable:!0}),t.prototype.onEvent=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return;this._onClipboardEvent.dispatch(this,this.createClipboardEvent(e))}catch(e){n.STLogger.warn("error in clipboard handler",e)}},t.prototype.createClipboardEvent=function(e){var t=n.SecuredTouchUtil.getSrcElement(e);return{category:"ClipboardEvent",type:e.type,eventTs:e.timeStamp,epochTs:(new Date).getTime(),additionalData:n.SecuredTouchUtil.flatten({stId:n.SecuredTouchUtil.getAttribute(t,"data-st-field")||"",elementId:t?t.id:""})}},t.prototype.start=function(){this._isStarted||(this._isStarted=!0,n.SecuredTouchUtil.addEventListener(document,"cut",this.onClipboardEventHandler),n.SecuredTouchUtil.addEventListener(document,"copy",this.onClipboardEventHandler),n.SecuredTouchUtil.addEventListener(document,"paste",this.onClipboardEventHandler))},t.prototype.stop=function(){this._isStarted&&(this._isStarted=!1,document.removeEventListener("cut",this.onClipboardEventHandler),document.removeEventListener("copy",this.onClipboardEventHandler),document.removeEventListener("paste",this.onClipboardEventHandler))},t);function t(e){this.BEHAVIORAL_TYPE="indirect",this._isStarted=!1,this._onClipboardEvent=new n.EventDispatcher,this.delegate=e,this.onClipboardEventHandler=this.onEvent.bind(this)}n.SecuredTouchClipboardEvents=e}(_securedTouchEntities=_securedTouchEntities||{}),function(i){var e=(Object.defineProperty(t.prototype,"isStarted",{get:function(){return this._isStarted},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onDragEvent",{get:function(){return this._onDragEvent.asEvent()},enumerable:!0,configurable:!0}),t.prototype.createDataTransferObject=function(e){var t="",n="",i=[],r=[];if(e&&(t=e.dropEffect,n=e.effectAllowed,i=e.types||[],e.files&&0<e.files.length))for(var o in e.files)r.push({lastModified:e.files[o].lastModified,size:e.files[o].size,type:e.files[o].type});return{dropEffect:t,effectAllowed:n,types:i.toString(),files:r}},t.prototype.createDragEvent=function(e){var t=i.SecuredTouchUtil.modifiersKeys(e),n=this.createDataTransferObject(e.dataTransfer);return{category:"DragEvent",type:e.type,eventTs:e.timeStamp,epochTs:(new Date).getTime(),additionalData:i.SecuredTouchUtil.flatten({button:e.button,buttons:e.buttons,clientX:e.clientX,clientY:e.clientY,movementX:e.movementX,movementY:e.movementY,offsetX:e.offsetX,offsetY:e.offsetY,pageX:e.pageX,pageY:e.pageY,screenX:e.screenX,screenY:e.screenY,which:e.which,modifierKeys:t.toString(),dataTransfer:n})}},t.prototype.onEvent=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return;this._onDragEvent.dispatch(this,this.createDragEvent(e))}catch(e){i.STLogger.warn("error in drag handler",e)}},t.prototype.start=function(){this._isStarted||(this._isStarted=!0,i.SecuredTouchUtil.addEventListener(document,"dragstart",this.onDragEventHandler),i.SecuredTouchUtil.addEventListener(document,"dragexit",this.onDragEventHandler),i.SecuredTouchUtil.addEventListener(document,"drop",this.onDragEventHandler),i.SecuredTouchUtil.addEventListener(document,"dragend",this.onDragEventHandler))},t.prototype.stop=function(){this._isStarted&&(this._isStarted=!1,document.removeEventListener("dragstart",this.onDragEventHandler),document.removeEventListener("dragexit",this.onDragEventHandler),document.removeEventListener("drop",this.onDragEventHandler),document.removeEventListener("dragend",this.onDragEventHandler))},t);function t(e){this.BEHAVIORAL_TYPE="indirect",this._isStarted=!1,this._onDragEvent=new i.EventDispatcher,this.delegate=e,this.onDragEventHandler=this.onEvent.bind(this)}i.SecuredTouchDragEvents=e}(_securedTouchEntities=_securedTouchEntities||{}),function(i){var e=(Object.defineProperty(t.prototype,"isStarted",{get:function(){return this._isStarted},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onFocusEvent",{get:function(){return this._onFocusEvent.asEvent()},enumerable:!0,configurable:!0}),t.prototype.getRelatedTarget=function(e){if(!e.relatedTarget)return{type:"",stId:"",elementId:""};var t={type:i.SecuredTouchUtil.getObjectType(e.relatedTarget),stId:"",elementId:""};e.relatedTarget.id&&(t.elementId=e.relatedTarget.id);try{var n=e.relatedTarget;t.stId=i.SecuredTouchUtil.getAttribute(n,"data-st-field")||""}catch(e){}return t},t.prototype.createFocusEvent=function(e){var t=i.SecuredTouchUtil.getSrcElement(e),n=this.getRelatedTarget(e);return{category:"FocusEvent",type:e.type,eventTs:e.timeStamp,epochTs:(new Date).getTime(),additionalData:i.SecuredTouchUtil.flatten({stId:i.SecuredTouchUtil.getAttribute(t,"data-st-field")||"",elementId:t?t.id:"",relatedTarget:n})}},t.prototype.onEvent=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return;this._onFocusEvent.dispatch(this,this.createFocusEvent(e))}catch(e){i.STLogger.warn("error in focus handler",e)}},t.prototype.start=function(){this._isStarted||(this._isStarted=!0,i.SecuredTouchUtil.addEventListener(document,"DOMFocusIn",this.onFocusEventHandler),i.SecuredTouchUtil.addEventListener(document,"DOMFocusOut",this.onFocusEventHandler),i.SecuredTouchUtil.addEventListener(document,"focus",this.onFocusEventHandler),i.SecuredTouchUtil.addEventListener(document,"focusin",this.onFocusEventHandler),i.SecuredTouchUtil.addEventListener(document,"focusout",this.onFocusEventHandler))},t.prototype.stop=function(){this._isStarted&&(this._isStarted=!1,document.removeEventListener("DOMFocusIn",this.onFocusEventHandler),document.removeEventListener("DOMFocusOut",this.onFocusEventHandler),document.removeEventListener("focus",this.onFocusEventHandler),document.removeEventListener("focusin",this.onFocusEventHandler),document.removeEventListener("focusout",this.onFocusEventHandler))},t);function t(e){this.BEHAVIORAL_TYPE="indirect",this._isStarted=!1,this._onFocusEvent=new i.EventDispatcher,this.delegate=e,this.onFocusEventHandler=this.onEvent.bind(this)}i.SecuredTouchFocusEvents=e}(_securedTouchEntities=_securedTouchEntities||{}),function(t){var e=(Object.defineProperty(n.prototype,"isStarted",{get:function(){return this._isStarted},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onUIEvent",{get:function(){return this._onUIEvent.asEvent()},enumerable:!0,configurable:!0}),n.prototype.createUIEvent=function(e){return{category:"UIEvent",type:e.type,eventTs:e.timeStamp,epochTs:(new Date).getTime(),additionalData:t.SecuredTouchUtil.flatten({detail:e.detail})}},n.prototype.onEvent=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return;this._onUIEvent.dispatch(this,this.createUIEvent(e))}catch(e){t.STLogger.warn("error in UIEvent handler",e)}},n.prototype.start=function(){this._isStarted||(this._isStarted=!0,t.SecuredTouchUtil.addEventListener(document,"resize",this.onUIEventHandler),t.SecuredTouchUtil.addEventListener(document,"scroll",this.onUIEventHandler),t.SecuredTouchUtil.addEventListener(document,"select",this.onUIEventHandler))},n.prototype.stop=function(){this._isStarted&&(this._isStarted=!1,document.removeEventListener("resize",this.onUIEventHandler),document.removeEventListener("scroll",this.onUIEventHandler),document.removeEventListener("select",this.onUIEventHandler))},n);function n(e){this.BEHAVIORAL_TYPE="indirect",this._isStarted=!1,this._onUIEvent=new t.EventDispatcher,this.delegate=e,this.onUIEventHandler=this.onEvent.bind(this)}t.SecuredTouchUIEvents=e}(_securedTouchEntities=_securedTouchEntities||{}),function(i){var e=(Object.defineProperty(t.prototype,"isStarted",{get:function(){return this._isStarted},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onGeneralEvent",{get:function(){return this._onGeneralEvent.asEvent()},enumerable:!0,configurable:!0}),t.prototype.onEvent=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return;this._onGeneralEvent.dispatch(this,this.createGeneralEvent(e))}catch(e){i.STLogger.warn("error in general event handler",e)}},t.prototype.onLangChangeEvent=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return;var t=this.createGeneralEvent(e);navigator&&navigator.language&&(t.additionalData["navigator.language"]=navigator.language),this._onGeneralEvent.dispatch(this,t)}catch(e){i.STLogger.warn("error in LangChange event handler",e)}},t.prototype.onOrientationChangeEvent=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return;var t=this.createGeneralEvent(e),n=i.SecuredTouchUtil.getDeviceOrientation();t.additionalData.orientation=n.orientation,t.additionalData.angle=n.angle,this._onGeneralEvent.dispatch(this,t)}catch(e){i.STLogger.warn("error in OrientationChange event handler",e)}},t.prototype.onVisibilityChangeEvent=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return;var t=this.createGeneralEvent(e);t.additionalData.hidden=!!document[this.hiddenProperty],document.visibilityState&&(t.additionalData.visibilityState=document.visibilityState.toString()),this._onGeneralEvent.dispatch(this,t)}catch(e){i.STLogger.warn("error in VisibilityChange event handler",e)}},t.prototype.createGeneralEvent=function(e){return{category:"Event",type:e.type,eventTs:e.timeStamp,epochTs:(new Date).getTime(),additionalData:{}}},t.prototype.start=function(){this._isStarted||(this._isStarted=!0,i.SecuredTouchUtil.addEventListener(document,this.visibilityChangeEventName,this.onVisibilityChangeHandler),i.SecuredTouchUtil.addEventListener(document,"change",this.onGeneralEventHandler),i.SecuredTouchUtil.addEventListener(document,"fullscreenchange",this.onGeneralEventHandler),i.SecuredTouchUtil.addEventListener(document,"invalid",this.onGeneralEventHandler),i.SecuredTouchUtil.addEventListener(window,"languagechange",this.onLangChangeHandler),i.SecuredTouchUtil.addEventListener(window,"orientationchange",this.onOrientationChangeHandler),i.SecuredTouchUtil.addEventListener(document,"seeked",this.onGeneralEventHandler),i.SecuredTouchUtil.addEventListener(document,"seeking",this.onGeneralEventHandler),i.SecuredTouchUtil.addEventListener(document,"selectstart",this.onGeneralEventHandler),i.SecuredTouchUtil.addEventListener(document,"selectionchange",this.onGeneralEventHandler),i.SecuredTouchUtil.addEventListener(document,"submit",this.onGeneralEventHandler),i.SecuredTouchUtil.addEventListener(document,"volumechange",this.onGeneralEventHandler),i.SecuredTouchUtil.addEventListener(document,"reset",this.onGeneralEventHandler))},t.prototype.stop=function(){this._isStarted&&(this._isStarted=!1,document.removeEventListener(this.visibilityChangeEventName,this.onVisibilityChangeHandler),document.removeEventListener("change",this.onGeneralEventHandler),document.removeEventListener("fullscreenchange",this.onGeneralEventHandler),document.removeEventListener("invalid",this.onGeneralEventHandler),window.removeEventListener("languagechange",this.onLangChangeHandler),window.removeEventListener("orientationchange",this.onOrientationChangeHandler),document.removeEventListener("seeked",this.onGeneralEventHandler),document.removeEventListener("seeking",this.onGeneralEventHandler),document.removeEventListener("selectstart",this.onGeneralEventHandler),document.removeEventListener("selectionchange",this.onGeneralEventHandler),document.removeEventListener("submit",this.onGeneralEventHandler),document.removeEventListener("volumechange",this.onGeneralEventHandler),document.removeEventListener("reset",this.onGeneralEventHandler))},t);function t(e){this.BEHAVIORAL_TYPE="indirect",this.visibilityChangeEventName="visibilitychange",this.hiddenProperty="hidden",this._isStarted=!1,this._onGeneralEvent=new i.EventDispatcher,this.delegate=e,this.onGeneralEventHandler=this.onEvent.bind(this),this.onLangChangeHandler=this.onLangChangeEvent.bind(this),this.onOrientationChangeHandler=this.onOrientationChangeEvent.bind(this),this.onVisibilityChangeHandler=this.onVisibilityChangeEvent.bind(this),void 0!==document.msHidden?(this.hiddenProperty="msHidden",this.visibilityChangeEventName="msvisibilitychange"):void 0!==document.webkitHidden&&(this.hiddenProperty="webkitHidden",this.visibilityChangeEventName="webkitvisibilitychange")}i.SecuredTouchGeneralEvents=e}(_securedTouchEntities=_securedTouchEntities||{}),function(t){var e=(Object.defineProperty(n.prototype,"isStarted",{get:function(){return this._isStarted},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onUnloadEvent",{get:function(){return this._onUnloadEvent.asEvent()},enumerable:!0,configurable:!0}),n.prototype.createUnloadEvent=function(e){return{category:"UIEvent",type:e.type,eventTs:e.timeStamp,epochTs:(new Date).getTime(),additionalData:t.SecuredTouchUtil.flatten({detail:e.detail})}},n.prototype.onEvent=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return void this._onUnloadEvent.dispatch(this,null);this._onUnloadEvent.dispatch(this,this.createUnloadEvent(e))}catch(e){t.STLogger.warn("error in UnloadEvent handler",e)}},n.prototype.start=function(){this._isStarted||(this._isStarted=!0,t.SecuredTouchPointerConfig.instance.beforeUnloadEnabled&&t.SecuredTouchUtil.addEventListener(window,"beforeunload",this.onUnloadEventHandler))},n.prototype.stop=function(){this._isStarted&&(this._isStarted=!1,document.removeEventListener("beforeunload",this.onUnloadEventHandler))},n);function n(e){this.BEHAVIORAL_TYPE="indirect",this._isStarted=!1,this._onUnloadEvent=new t.EventDispatcher,this.delegate=e,this.onUnloadEventHandler=this.onEvent.bind(this)}t.SecuredTouchUnloadEvents=e}(_securedTouchEntities=_securedTouchEntities||{}),function(n){var e=(Object.defineProperty(t.prototype,"onIndirect",{get:function(){return this._onIndirect.asEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onWindowDispose",{get:function(){return this._onWindowDispose.asEvent()},enumerable:!0,configurable:!0}),t.prototype.onTimeElapsed=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return 0<this.indirectEvents.length&&(new Date).getTime()-this.lastIndirectEventTimestamp>=this.idleTimeInMillis&&this.dispatch(),[2]})})},t.prototype.handleEvent=function(e,t){this.lastIndirectEventTimestamp=(new Date).getTime(),this.pushEvent(t)},t.prototype.windowUnload=function(e,t){t&&n.SecuredTouchPointerConfig.instance.beforeUnloadEnabled&&(this.lastIndirectEventTimestamp=(new Date).getTime(),this.pushEvent(t),this._onWindowDispose.dispatch(this,this.clearBuffer()))},t.prototype.pushEvent=function(e){n.SecuredTouchPointerConfig.instance.countOnlyEventsList.has(e.type)?this.countEvent(e):(e.additionalData.windowId=n.SecuredTouchSessionStorage.instance.windowId,e.additionalData.locationHref=n.SecuredTouchUtil.getCurrentLocationUrl(),e.additionalData.clientDigest=n.SecuredTouchPointerConfig.instance.clientDigest,this.indirectEvents.push(e),this.indirectEvents.length>=this.MAX_INDIRECT_EVENTS&&this.dispatch())},t.prototype.countEvent=function(e){this.eventCounterByType[e.type]=Number(this.eventCounterByType[e.type])+1||1},t.prototype.clearBuffer=function(){var e={events:this.indirectEvents,eventCounters:this.eventCounterByType};return this.indirectEvents=[],this.eventCounterByType={},e},t.prototype.dispatch=function(){try{clearInterval(this.updateIntervalHandle),this._onIndirect.dispatch(this,this.clearBuffer()),this.updateIntervalHandle=setInterval(this.onTimeElapsedHandler,n.SecuredTouchPointerConfig.instance.indirectInterval)}catch(e){n.STLogger.warn("Failed to dispatch indirect events",e)}},Object.defineProperty(t.prototype,"isStarted",{get:function(){return this._isStarted},enumerable:!0,configurable:!0}),t.prototype.start=function(){this._isStarted||(this.updateIntervalHandle=setInterval(this.onTimeElapsedHandler,n.SecuredTouchPointerConfig.instance.indirectInterval),this.stClipboardEvents.start(),this.stDragEvents.start(),this.stFocusEvents.start(),this.stUIEvents.start(),this.stGeneralEvents.start(),this.stUnloadEvent.start(),this._isStarted=!0)},t.prototype.stop=function(){this._isStarted&&(this.stClipboardEvents.stop(),this.stDragEvents.stop(),this.stFocusEvents.stop(),this.stUIEvents.stop(),this.stGeneralEvents.stop(),this.stUnloadEvent.stop(),clearInterval(this.updateIntervalHandle),this.updateIntervalHandle=null,this._isStarted=!1)},t.prototype.unsubscribe=function(){this.stClipboardEvents.onClipboardEvent.unsubscribe(this.handleEvent.bind(this)),this.stDragEvents.onDragEvent.unsubscribe(this.handleEvent.bind(this)),this.stFocusEvents.onFocusEvent.unsubscribe(this.handleEvent.bind(this)),this.stUIEvents.onUIEvent.unsubscribe(this.handleEvent.bind(this)),this.stGeneralEvents.onGeneralEvent.unsubscribe(this.handleEvent.bind(this)),this.stUnloadEvent.onUnloadEvent.unsubscribe(this.windowUnload.bind(this))},t);function t(e){this.DEFAULT_INDIRECT_IDLE_INTERVAL=1e3,this.MAX_INDIRECT_EVENTS=500,this._onIndirect=new n.EventDispatcher,this._onWindowDispose=new n.EventDispatcher,this.indirectEvents=[],this.eventCounterByType={},this.idleTimeInMillis=this.DEFAULT_INDIRECT_IDLE_INTERVAL,this.lastIndirectEventTimestamp=0,this._isStarted=!1,this.stClipboardEvents=new n.SecuredTouchClipboardEvents(e),this.stClipboardEvents.onClipboardEvent.subscribe(this.handleEvent.bind(this)),this.stDragEvents=new n.SecuredTouchDragEvents(e),this.stDragEvents.onDragEvent.subscribe(this.handleEvent.bind(this)),this.stFocusEvents=new n.SecuredTouchFocusEvents(e),this.stFocusEvents.onFocusEvent.subscribe(this.handleEvent.bind(this)),this.stUIEvents=new n.SecuredTouchUIEvents(e),this.stUIEvents.onUIEvent.subscribe(this.handleEvent.bind(this)),this.stGeneralEvents=new n.SecuredTouchGeneralEvents(e),this.stGeneralEvents.onGeneralEvent.subscribe(this.handleEvent.bind(this)),this.stUnloadEvent=new n.SecuredTouchUnloadEvents(e),this.stUnloadEvent.onUnloadEvent.subscribe(this.windowUnload.bind(this)),this.onTimeElapsedHandler=this.onTimeElapsed.bind(this)}n.SecuredTouchIndirectClient=e}(_securedTouchEntities=_securedTouchEntities||{}),function(s){var e=(t.prototype.refreshCssSelectors=function(e){try{if(!e)return;var t=s.SecuredTouchUtil.hashCode(e);if(this.cacheHash===t)return;this.config=JSON.parse(e),this.cacheHash=t,this.cache=new Map}catch(e){s.STLogger.warn("Failed to set css selectors",e)}},t.prototype.getIdentification=function(e,t){if(null===this.cache.get(e))return null;if(void 0!==this.cache.get(e))return this.cache.get(e);for(var n in this.config)try{if(!this.config.hasOwnProperty(n))continue;var i=this.config[n]||[];s.SecuredTouchUtil.isArray(i)||(i=[].concat(i));for(var r=0,o=i;r<o.length;r++){var a=o[r];if(s.SecuredTouchUtil.isSelectorMatches(e,a,t))return this.cache.set(e,n),n}}catch(e){s.STLogger.warn("Failed to find selector for "+n,e)}return this.cache.set(e,null),null},t);function t(){this.config={},this.cacheHash=0,this.cache=new Map}s.SecuredTouchElementsIdentifications=e}(_securedTouchEntities=_securedTouchEntities||{}),function(o){var e=(t.prototype.updateFieldsOperations=function(e){try{if(!e)return void(this.fieldsOperations=new Map);var t=o.SecuredTouchUtil.hashCode(e);if(this.cacheHashCode===t)return;this.fieldsOperations=new Map;var n,i=JSON.parse(e);for(n in i)try{if(!i.hasOwnProperty(n))continue;var r=i[n];o.SecuredTouchUtil.isArray(r)||(r=[].concat(r)),this.fieldsOperations.set(n,r)}catch(e){o.STLogger.warn("Failed to set operations for "+n,e)}}catch(e){o.STLogger.warn("Failed to set obfuscated config",e)}},t.prototype.performOperations=function(n,i,r){n&&i&&r&&(this.fieldsOperations.get(n)||[]).forEach(function(e){try{switch(e){case"email_domain":var t=o.SecuredTouchUtil.getEmailDomain(i);t&&r({fieldKey:n+"_domain",obfuscatedValue:t});break;case"obfuscate":r({fieldKey:n+"_obfuscated",obfuscatedValue:""+o.SecuredTouchUtil.mod(i,1e3)})}}catch(e){o.STLogger.warn("failed to perform operation on "+n)}})},t);function t(){this.cacheHashCode=0,this.fieldsOperations=new Map}o.SecuredTouchFieldValues=e}(_securedTouchEntities=_securedTouchEntities||{}),function(r){var e=(Object.defineProperty(t.prototype,"isStarted",{get:function(){return this._isStarted},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onInteraction",{get:function(){return this._onInteraction.asEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onEnterPress",{get:function(){return this._onEnterPress.asEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onObfuscatedValue",{get:function(){return this._onObfuscatedValue.asEvent()},enumerable:!0,configurable:!0}),t.prototype.refreshKeyboardCssSelectors=function(e){this.fieldsIdentifications.refreshCssSelectors(e)},t.prototype.refreshObfuscatedValues=function(e){this.fieldValues.updateFieldsOperations(e)},Object.defineProperty(t.prototype,"modifiersKeys",{get:function(){return["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Hyper","Meta","NumLock","OS","ScrollLock","Shift","Super","Symbol","SymbolLock"]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"specialKeys",{get:function(){return["Tab","Shift","Backspace","Enter","CapsLock","Meta","Delete","Alt","ArrowDown","ArrowUp","Control","ArrowLeft","End","Unidentified","Home","ArrowRight","Insert","Pause","PageDown","PageUp","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","AltGraph","Escape"]},enumerable:!0,configurable:!0}),t.prototype.getInteractionFromElement=function(e){var t=null,n=null,e=r.SecuredTouchUtil.getSrcElement(e);return e&&r.SecuredTouchUtil.isFunction(e.getAttribute)&&((n=!(n=r.SecuredTouchUtil.getAttribute(e,"data-st-field"))?this.fieldsIdentifications.getIdentification(e,0):n)&&!r.SecuredTouchPointerConfig.instance.fieldBlackList.has(n)&&((t=this.interactionsMap.get(e))||(t={stId:n,elementId:r.SecuredTouchUtil.getAttribute(e,"id"),name:r.SecuredTouchUtil.getAttribute(e,"name"),type:r.SecuredTouchUtil.getAttribute(e,"type"),events:[],identified:!1,counter:0,additionalData:{clientDigest:r.SecuredTouchPointerConfig.instance.clientDigest,windowId:r.SecuredTouchSessionStorage.instance.windowId,locationHref:r.SecuredTouchUtil.getCurrentLocationUrl()}},this.interactionsMap.set(e,t)))),t},t.prototype.getKeyCode=function(e){return e.keyCode||e.which||(e.code?r.SecuredTouchUtil.hashCode(e.code):r.SecuredTouchUtil.hashCode(e.key)+(e.location||0))},t.prototype.getKeystrokeId=function(e,t){var n,i=this.getKeyCode(e);return"keyup"===t&&(this.keyStrokeMap.has(i)?(n=this.keyStrokeMap.get(i),this.keyStrokeMap.delete(i)):n=r.SecuredTouchUtil.newGuid()),"keydown"===t&&(this.keyStrokeMap.has(i)&&e.repeat?n=this.keyStrokeMap.get(i):(n=r.SecuredTouchUtil.newGuid(),this.keyStrokeMap.set(i,n))),n},t.prototype.createKeyboardInteractionEvent=function(e,t){var n=r.SecuredTouchUtil.getSrcElement(t),i=n.value?n.value.toString().length:0;return{type:e,eventTs:t.timeStamp,epochTs:(new Date).getTime(),modifierKeys:[],selectionStart:r.SecuredTouchUtil.getElementSelectionStart(n),selectionEnd:r.SecuredTouchUtil.getElementSelectionEnd(n),repeat:t.repeat,key:null,keyCode:null,keystrokeId:null,currentLength:i,location:t.location}},t.prototype.enrichKeyboardEvent=function(t,e,n){(0<=this.modifiersKeys.indexOf(t.key)||0<=this.specialKeys.indexOf(t.key))&&(n.key=t.key,n.keyCode=t.keyCode),n.keystrokeId=this.getKeystrokeId(t,n.type);var i=r.SecuredTouchUtil.getSrcElement(t);n.currentLength=String(i.value).length,t.getModifierState&&this.modifiersKeys.forEach(function(e){t.getModifierState(e.toString())&&n.modifierKeys.push(e)})},t.prototype.onFocus=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return void this._onInteraction.dispatch(this,null);e=r.SecuredTouchUtil.getKeyboardEvent(e);var t,n=this.getInteractionFromElement(e);n&&(t=this.createKeyboardInteractionEvent("focus",e),n.events.push(t))}catch(e){r.STLogger.warn("error in keyboard focus handler",e)}},t.prototype.onKeyUp=function(e){try{if(13!==(e=r.SecuredTouchUtil.getKeyboardEvent(e)).keyCode&&13!==e.which||this._onEnterPress.dispatch(this,r.SecuredTouchUtil.getSrcElement(e)),!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return void this._onInteraction.dispatch(this,null);var t,n=this.getInteractionFromElement(e);n?(t=this.createKeyboardInteractionEvent("keyup",e),this.enrichKeyboardEvent(e,n,t),n.events.push(t)):this.keyStrokeMap.delete(this.getKeyCode(e))}catch(e){r.STLogger.warn("error in keyUp handler",e)}},t.prototype.onKeyDown=function(e){try{if(!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return void this._onInteraction.dispatch(this,null);e=r.SecuredTouchUtil.getKeyboardEvent(e);var t,n=this.getInteractionFromElement(e);n&&(t=this.createKeyboardInteractionEvent("keydown",e),this.enrichKeyboardEvent(e,n,t),n.events.push(t))}catch(e){r.STLogger.warn("error in keyDown handler",e)}},t.prototype.onBlur=function(e){try{e=r.SecuredTouchUtil.getKeyboardEvent(e);var t,n,i=this.getInteractionFromElement(e);if(this.dispatchValue(i,r.SecuredTouchUtil.getSrcElement(e)),!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return void this._onInteraction.dispatch(this,null);i&&(t=this.createKeyboardInteractionEvent("blur",e),i.events.push(t),n=r.SecuredTouchUtil.getSrcElement(e),this.interactionsMap.delete(n),this._onInteraction.dispatch(this,i))}catch(e){r.STLogger.warn("error in blur handler",e)}},t.prototype.dispatchValue=function(e,t){var n=this;try{e&&this.fieldValues.performOperations(e.stId,t.value,function(e){n._onObfuscatedValue.dispatch(n,e)})}catch(e){r.STLogger.warn("error in blur dispatchValue",e)}},t.prototype.clearBuffer=function(){var e=Array.from(this.interactionsMap.values());return this.interactionsMap.clear(),e},t.prototype.isEmpty=function(){return 0===this.interactionsMap.size},t.prototype.start=function(){this._isStarted?r.STLogger.debug("Desktop Keyboard events already listening"):(r.SecuredTouchUtil.addEventListener(document,"keydown",this.onKeyDownHandle),r.SecuredTouchUtil.addEventListener(document,"keyup",this.onKeyUpHandle),r.SecuredTouchUtil.addEventListener(document,"focus",this.onFocusHandle,!0),r.SecuredTouchUtil.addEventListener(document,"blur",this.onBlurHandle,!0),this._isStarted=!0,r.STLogger.debug("Desktop Keyboard events start listening..."))},t.prototype.stop=function(){this._isStarted?(document.removeEventListener("keydown",this.onKeyDownHandle),document.removeEventListener("keyup",this.onKeyUpHandle),document.removeEventListener("focus",this.onFocusHandle,!0),document.removeEventListener("blur",this.onBlurHandle,!0),this._isStarted=!1,r.STLogger.debug("Desktop Keyboard events stop listening...")):r.STLogger.debug("Desktop Keyboard events already stopped")},t);function t(e){this.BEHAVIORAL_TYPE="eventKeyboard",this._isStarted=!1,this._onInteraction=new r.EventDispatcher,this._onEnterPress=new r.EventDispatcher,this._onObfuscatedValue=new r.EventDispatcher,this.interactionsMap=new Map,this.fieldsIdentifications=new r.SecuredTouchElementsIdentifications,this.fieldValues=new r.SecuredTouchFieldValues,this.keyStrokeMap=new Map,this.delegate=e,this.onKeyDownHandle=this.onKeyDown.bind(this),this.onKeyUpHandle=this.onKeyUp.bind(this),this.onFocusHandle=this.onFocus.bind(this),this.onBlurHandle=this.onBlur.bind(this)}r.SecuredTouchKeyboard=e}(_securedTouchEntities=_securedTouchEntities||{}),function(i){var e=(Object.defineProperty(t.prototype,"isStarted",{get:function(){return this._isStarted},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onInteraction",{get:function(){return this._onInteraction.asEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onClickEvent",{get:function(){return this._onClickEvent.asEvent()},enumerable:!0,configurable:!0}),t.prototype.interactionUpdate=function(){this.lastMouseInteraction?(new Date).getTime()-this.lastMouseInteractionTimestamp>=i.SecuredTouchPointerConfig.instance.idleTimeoutMs&&this.dispatch():!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE)&&(new Date).getTime()-this.lastMouseInteractionTimestamp<=i.SecuredTouchPointerConfig.instance.updateInterval&&this.dispatch()},t.prototype.dispatch=function(){try{this.lastMouseInteraction&&(this.lastMouseInteraction.additionalData=Object.assign({},this.lastMouseInteraction.additionalData,this.counterGroupByType)),this._onInteraction.dispatch(this,this.lastMouseInteraction),this.lastMouseInteraction=null,this.mouseEventsCounter=0,this.counterGroupByType={}}catch(e){i.STLogger.warn("Failed to dispatch mouse events",e)}},t.prototype.updateInteraction=function(e){this.lastMouseInteraction||(this.lastMouseInteraction={events:[],identified:!1,counter:0,additionalData:{clientDigest:i.SecuredTouchPointerConfig.instance.clientDigest,windowId:i.SecuredTouchSessionStorage.instance.windowId,locationHref:i.SecuredTouchUtil.getCurrentLocationUrl()}}),this.lastMouseInteraction.events.push(e),this.mouseEventsCounter++,this.mouseEventsCounter>=i.SecuredTouchPointerConfig.instance.maxEventsCount&&this.dispatch()},t.prototype.onClick=function(t){try{if(this.lastMouseInteractionTimestamp=(new Date).getTime(),this._onClickEvent.dispatch(this,i.SecuredTouchUtil.getSrcElement(t)),!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return;if(i.SecuredTouchPointerConfig.instance.countOnlyEventsList.has(t.type))return void this.countEvent(t);this.updateInteraction(this.createMouseClickEvent(t.type,t)),this.dispatch()}catch(e){i.STLogger.warn("error in "+t.type+" handler",e)}},t.prototype.onMouseout=function(e){try{if(this.lastMouseInteractionTimestamp=(new Date).getTime(),!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return;if(i.SecuredTouchPointerConfig.instance.countOnlyEventsList.has(e.type))return void this.countEvent(e);this.updateInteraction(this.createMouseEvent(e.type,e));var t=e.relatedTarget||e.toElement;t&&"HTML"!==t.nodeName||this.dispatch()}catch(t){i.STLogger.warn("error in "+e.type+" handler",t)}},t.prototype.onMouseEvent=function(t){try{if(this.lastMouseInteractionTimestamp=(new Date).getTime(),!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return;if(i.SecuredTouchPointerConfig.instance.countOnlyEventsList.has(t.type))return void this.countEvent(t);this.updateInteraction(this.createMouseEvent(t.type,t))}catch(e){i.STLogger.warn("error in "+t.type+" handler",e)}},t.prototype.onMouseClickEvent=function(t){try{if(this.lastMouseInteractionTimestamp=(new Date).getTime(),!this.delegate.collectBehavioralData(this.BEHAVIORAL_TYPE))return;if(i.SecuredTouchPointerConfig.instance.countOnlyEventsList.has(t.type))return void this.countEvent(t);this.updateInteraction(this.createMouseClickEvent(t.type,t))}catch(e){i.STLogger.warn("error in "+t.type+" handler",e)}},t.prototype.countEvent=function(e){this.counterGroupByType[e.type]=Number(this.counterGroupByType[e.type])+1||1},t.prototype.start=function(){this._isStarted?i.STLogger.debug("Desktop Mouse events already listening"):(i.SecuredTouchUtil.addEventListener(document,"click",this.onClickHandle),i.SecuredTouchUtil.addEventListener(document,"dblclick",this.onDblclickHandle),i.SecuredTouchUtil.addEventListener(document,"mousedown",this.onMousedownHandle),i.SecuredTouchUtil.addEventListener(document,"mousemove",this.onMousemoveHandle),i.SecuredTouchUtil.addEventListener(document,"mouseout",this.onMouseoutHandle),i.SecuredTouchUtil.addEventListener(document,"mouseover",this.onMouseoverHandle),i.SecuredTouchUtil.addEventListener(document,"mouseup",this.onMouseupHandle),i.SecuredTouchUtil.addEventListener(document,"wheel",this.onWheelHandle,this.wheelOptions),this.updateIntervalHandle=setInterval(this.interactionUpdateHandle,i.SecuredTouchPointerConfig.instance.updateInterval),this._isStarted=!0,i.STLogger.debug("Desktop Mouse events start listening..."))},t.prototype.stop=function(){this._isStarted?(document.removeEventListener("click",this.onClickHandle),document.removeEventListener("dblclick",this.onDblclickHandle),document.removeEventListener("mousedown",this.onMousedownHandle),document.removeEventListener("mousemove",this.onMousemoveHandle),document.removeEventListener("mouseout",this.onMouseoutHandle),document.removeEventListener("mouseover",this.onMouseoverHandle),document.removeEventListener("mouseup",this.onMouseupHandle),document.removeEventListener("wheel",this.onWheelHandle,this.wheelOptions),clearInterval(this.updateIntervalHandle),this.updateIntervalHandle=null,this._isStarted=!1,i.STLogger.debug("Desktop Mouse events stop listening...")):i.STLogger.debug("Desktop Mouse events already stopped")},t.prototype.clearBuffer=function(){var e=null;return this.lastMouseInteraction&&(e=this.lastMouseInteraction),this.lastMouseInteraction=null,e},t.prototype.isEmpty=function(){return!this.lastMouseInteraction},t.prototype.createMouseEvent=function(e,t){var n=i.SecuredTouchUtil.modifiersKeys(t);return{type:e,eventTs:t.timeStamp,epochTs:(new Date).getTime(),button:t.button,buttons:t.buttons,clientX:t.clientX,clientY:t.clientY,movementX:t.movementX,movementY:t.movementY,offsetX:t.offsetX,offsetY:t.offsetY,pageX:t.pageX,pageY:t.pageY,screenX:t.screenX,screenY:t.screenY,which:t.which,modifierKeys:n}},t.prototype.createMouseClickEvent=function(e,t){e=this.createMouseEvent(e,t);return t.target&&i.SecuredTouchUtil.isFunction(t.target.getBoundingClientRect)&&(t=t.target.getBoundingClientRect(),e.targetBottom=t.bottom,e.targetHeight=t.height,e.targetLeft=t.left,e.targetRight=t.right,e.targetTop=t.top,e.targetWidth=t.width,e.targetX=t.x,e.targetY=t.y),e},t);function t(e){this.BEHAVIORAL_TYPE="mouse",this._isStarted=!1,this._onInteraction=new i.EventDispatcher,this._onClickEvent=new i.EventDispatcher,this.lastMouseInteractionTimestamp=null,this.mouseEventsCounter=0,this.counterGroupByType={},this.delegate=e,this.wheelOptions=!!i.SecuredTouchUtil.isPassiveSupported()&&{passive:!0},this.onClickHandle=this.onClick.bind(this),this.onDblclickHandle=this.onMouseClickEvent.bind(this),this.onMousedownHandle=this.onMouseClickEvent.bind(this),this.onMousemoveHandle=this.onMouseEvent.bind(this),this.onMouseoutHandle=this.onMouseout.bind(this),this.onMouseoverHandle=this.onMouseEvent.bind(this),this.onMouseupHandle=this.onMouseClickEvent.bind(this),this.onWheelHandle=this.onMouseEvent.bind(this),this.interactionUpdateHandle=this.interactionUpdate.bind(this)}i.SecuredTouchMouse=e}(_securedTouchEntities=_securedTouchEntities||{}),function(n){var e=(Object.defineProperty(i.prototype,"asArray",{get:function(){var e=(e=i.stSessionStorage.getItem(this.key))||JSON.stringify([]);return JSON.parse(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this.asArray.length},enumerable:!0,configurable:!0}),i.prototype.push=function(e){var t=this.asArray,e=t.push(e);return i.stSessionStorage.setItem(this.key,JSON.stringify(t)),i.stSessionStorage.setItem(n.SecuredTouchConstants.SESSION_STORAGE_UPDATE_TS,(new Date).getTime()),e},i.prototype.concat=function(e){e=this.asArray.concat(e);return i.stSessionStorage.setItem(this.key,JSON.stringify(e)),this},i.prototype.clear=function(){i.stSessionStorage.removeItem(this.key)},i.stSessionStorage=n.SecuredTouchSessionStorage.instance.sessionStorage,i);function i(e){this.key=e}n.SecuredTouchStorageArray=e}(_securedTouchEntities=_securedTouchEntities||{}),function(u){var e=(t.prototype.refreshConfig=function(e){try{if(!e)return;var t=u.SecuredTouchUtil.hashCode(e);if(this.cacheHash===t)return;this.config=JSON.parse(e),this.cacheHash=t,this.cache=new Map}catch(e){u.STLogger.warn("Failed to set css selectors",e)}},t.prototype.getMatchingTags=function(e,t){var n=this.cache.get(e);if(n)return n;var i,r={};for(i in this.config)try{if(!this.config.hasOwnProperty(i))continue;var o=this.config[i].selector||[];u.SecuredTouchUtil.isArray(o)||(o=[].concat(o));for(var a=0,s=o;a<s.length;a++){var c=s[a];u.SecuredTouchUtil.isSelectorMatches(e,c,t)&&(r[i]=this.config[i])}}catch(e){u.STLogger.warn("Failed to get the config for "+i+" tag",e)}return this.cache.set(e,r),r},t.prototype.getValue=function(e,t){if(t&&e)switch(t=t.trim(),e){case"email_domain":return u.SecuredTouchUtil.getEmailDomain(t);case"obfuscate":return""+u.SecuredTouchUtil.mod(t,1e3);case"plain":return t}return""},t);function t(){this.config={},this.cacheHash=0,this.cache=new Map}u.SecuredTouchTagsIdentifications=e}(_securedTouchEntities=_securedTouchEntities||{}),function(a){var e=(Object.defineProperty(t.prototype,"reduceFactorMap",{set:function(e){var t=a.SecuredTouchUtil.hashCode(e);this._reduceMapHashCode!==t&&(this._reduceMapHashCode=t,this._reduceFactorMap=JSON.parse(e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"snapshotsReduceFactor",{get:function(){return this._snapshotsReduceFactor},set:function(e){this._snapshotsReduceFactor=e},enumerable:!0,configurable:!0}),t.prototype.eventsWereReduced=function(){return 0!==this._reduceMapHashCode},t.prototype.reduceEvents=function(e){var n=this;try{if(!e||0===e.length||!this._reduceFactorMap)return e;for(var t=new Map,i=[],r=0;r<e.length;r++)t.get(e[r].type)?t.get(e[r].type).push(r):t.set(e[r].type,[r]);t.forEach(function(t,e){e=n._reduceFactorMap[e]?Number(n._reduceFactorMap[e]):0;n.reduceByFactor(e,t,function(e){i[t[e]]=!0})});for(var o=[],r=0;r<e.length;r++)i[r]&&o.push(e[r]);return e.length!==o.length&&a.STLogger.debug(e.length-o.length+" events reduced out of "+e.length),o}catch(n){return a.STLogger.warn("Failed to reduce events",n),e}},t.prototype.reduceSnapshots=function(t){try{if(!t||0===t.length||0===this._snapshotsReduceFactor)return t;var n=[];return this.reduceByFactor(this._snapshotsReduceFactor,t,function(e){n.push(t[e])}),a.STLogger.debug(t.length-n.length+" snapshots reduced out of "+t.length),n}catch(n){return a.STLogger.warn("Failed to reduce events",n),t}},t.prototype.reduceByFactor=function(e,t,n){e=Math.min(e,1);for(var e=Math.round(Math.max(t.length*(1-e),2)),i=(t.length-1)/(e-1),r=Math.min(t.length,e),o=0;o<r;o++)n(Math.round(o*i))},t);function t(){this._reduceFactorMap=null,this._reduceMapHashCode=0,this._snapshotsReduceFactor=0}a.SecuredTouchReduceFactor=e}(_securedTouchEntities=_securedTouchEntities||{}),function(a){var n,e=(n=a.SecuredTouchClientBase,__extends(t,n),t.prototype.dispose=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.stopListening(),this.keyboard.onInteraction.unsubscribe(this.handleKeyboardInteraction.bind(this)),this.keyboard.onEnterPress.unsubscribe(this.handleStTagOnEnter.bind(this)),this.keyboard.onObfuscatedValue.unsubscribe(this.handleTagValueOnBlur.bind(this)),this.mouse.onInteraction.unsubscribe(this.handleMouseInteraction.bind(this)),this.mouse.onClickEvent.unsubscribe(this.handleStTagOnClick.bind(this)),this.gesture.onGesture.unsubscribe(this.handleGesture.bind(this)),this.indirect.unsubscribe(),this.indirect.onIndirect.unsubscribe(this.handleIndirect.bind(this)),this.indirect.onWindowDispose.unsubscribe(this.handleWindowDispose.bind(this)),this.clearMouseBuffer(),this.clearIndirectBuffer(),this.sessionData.lastDisposedPayload=this.createInteractionsPayload(),[2]})})},t.prototype.collectBehavioralData=function(e){if(this.isBehavioralDataPaused)return!1;var t=a.SecuredTouchPointerConfig.instance.behavioralBlacklist;return!(e&&t&&t[e]&&Boolean(window.location.href.match(t[e])))},t.prototype.isAboveBufferSize=function(){return this.currentBufferSize>=a.SecuredTouchPointerConfig.instance.bufferSize},t.prototype.enrichMouseInteraction=function(e){e.counter=this.totalMouseCounter++,this.enrichInteractionWithAdditionalData(e)},t.prototype.addTagsWithValue=function(e){var t,n,i,r=!1;for(t in e)e.hasOwnProperty(t)&&(i="",e[t].operation&&e[t].valueSelector&&(n=(n=document.querySelector(e[t].valueSelector))instanceof HTMLInputElement?n.value:n.innerText,i=this.tagsWithValueIdentifications.getValue(e[t].operation,n)),this.addTag(t,i),r=!0);return r},t.prototype.handleStTagElement=function(e){var t,n,i;e&&(i=this.tagsWithValueIdentifications.getMatchingTags(e,a.SecuredTouchPointerConfig.instance.maxSelectorChildren),t=this.addTagsWithValue(i),n=a.SecuredTouchUtil.getAttribute(e,"data-st-tag"),i=a.SecuredTouchUtil.getAttribute(e,"data-st-tag-value"),(n=!n&&!t?this.tagsIdentifications.getIdentification(e,a.SecuredTouchPointerConfig.instance.maxSelectorChildren):n)&&this.addTag(n,i))},t.prototype.isClickableInput=function(e){return e&&0<=["button","checkbox","radio","submit","file","reset"].indexOf(e.type)},t.prototype.isTextInput=function(e){return e&&0<=["email","number","password","search","tel","text","url"].indexOf(e.type)},t.prototype.handleStTagOnEnter=function(e,t){t instanceof HTMLInputElement&&this.isTextInput(t)&&this.handleStTagElement(t)},t.prototype.handleTagValueOnBlur=function(e,t){t&&this.addTag(t.fieldKey,t.obfuscatedValue)},t.prototype.handleStTagOnClick=function(e,t){t instanceof HTMLInputElement&&!this.isClickableInput(t)||this.handleStTagElement(t)},t.prototype.handleMouseInteraction=function(e,t){this.isInitAndEnabled()&&(t?(this.addMouseInteractions(t),this.lastGestureTimestamp!==t.events[t.events.length-1].eventTs&&this.currentBufferSize++,this.isAboveBufferSize()&&this.sendAllCapturedInteractions()):this.sendHeartBeat())},t.prototype.handleIndirect=function(e,t){this.isInitAndEnabled()&&(this.addIndirectEvents(t),this.isEmpty()&&this.sendAllCapturedInteractions())},t.prototype.handleWindowDispose=function(e,t){this.isInitAndEnabled()&&(this.addIndirectEvents(t),this.dispose())},t.prototype.enrichKeyboardInteraction=function(e){e.counter=this.totalKeyboardCounter++,this.enrichInteractionWithAdditionalData(e)},t.prototype.handleKeyboardInteraction=function(e,t){this.isInitAndEnabled()&&(t?(this.addKeyboardInteraction(t),this.currentBufferSize++,this.isAboveBufferSize()&&this.sendAllCapturedInteractions()):this.sendHeartBeat())},t.prototype.handleGesture=function(e,t){this.isInitAndEnabled()&&(t?(this.enrichInteractionWithAdditionalData(t),t.counter=this.totalGestureCounter++,this.reduceGestureSnapshots(t),this.capturedGestures.push(t),this.currentBufferSize++,this.lastGestureTimestamp=0<t.snapshots.length?t.snapshots[t.snapshots.length-1].additionalData.eventTimeStamp:t.timestamp,this.sensors.onGesture(t),this.isAboveBufferSize()&&this.sendAllCapturedInteractions()):this.sendHeartBeat())},t.prototype.clearMouseBuffer=function(){var e=this.mouse.clearBuffer();e&&this.addMouseInteractions(e)},t.prototype.clearIndirectBuffer=function(){var e=this.indirect.clearBuffer();this.addIndirectEvents(e)},t.prototype.clearKeyboardBuffer=function(){for(var e=0,t=this.keyboard.clearBuffer();e<t.length;e++){var n=t[e];n&&this.addKeyboardInteraction(n)}},t.prototype.clearBuffer=function(){this.clearKeyboardBuffer(),this.clearMouseBuffer(),this.clearIndirectBuffer()},t.prototype.addMouseInteractions=function(e){this.enrichMouseInteraction(e),this.reduceMouseInteraction(e),this.capturedMouseInteractions.push(e)},t.prototype.addKeyboardInteraction=function(e){this.enrichKeyboardInteraction(e),this.reduceKeyboardInteraction(e),this.capturedKeyboardInteractions.push(e)},t.prototype.addIndirectEvents=function(e){e&&e.events&&0<e.events.length&&this.capturedIndirectEvents.concat(e.events),e&&e.eventCounters&&this.addIndirectCounters(e.eventCounters)},t.prototype.addIndirectCounters=function(e){for(var t in e)e.hasOwnProperty(t)&&(this.indirectCounters[t]=e[t]+(this.indirectCounters[t]||0))},t.prototype.reduceIndirectEvents=function(e){return this.reduceFactorManager.reduceEvents(e)},t.prototype.reduceMouseInteraction=function(e){e.events=this.reduceFactorManager.reduceEvents(e.events)},t.prototype.reduceKeyboardInteraction=function(e){e.events=this.reduceFactorManager.reduceEvents(e.events)},t.prototype.reduceGestureSnapshots=function(e){e.snapshots=this.reduceFactorManager.reduceSnapshots(e.snapshots)},t.prototype.isEmpty=function(){return 0===this.capturedKeyboardInteractions.length&&0===this.capturedMouseInteractions.length&&0===this.capturedGestures.length&&this.gesture.isEmpty()&&this.keyboard.isEmpty()&&this.mouse.isEmpty()},t.prototype.forceSendCapturedEvents=function(e){return this.clearMouseBuffer(),this.sendAllCapturedInteractions(e)},t.prototype.onUrlChange=function(){a.SecuredTouchPointerConfig.instance.sendLocation&&this.addTag("location:"+window.location.href)},t.prototype.onError=function(e){try{var t=e.colno,n=e.filename,i=e.lineno,r=e.message||"",o=e.error||{};n&&0<=n.toLowerCase().indexOf("securedtouch")&&this.sendRemoteLog(a.SecuredTouchErrorCodes.E_6000,"Unhandled error "+r,{colNumber:t,lineNumber:i,stack:o.stack||""})}catch(e){a.STLogger.warn("error in error handler",e)}},t.prototype.refreshListening=function(){var e;this.sessionData.initST?(e=a.SecuredTouchPointerConfig.instance,this.tagsIdentifications.refreshCssSelectors(e.tagsCssSelectors),this.tagsWithValueIdentifications.refreshConfig(e.tagsConfig),this.reduceFactorManager.reduceFactorMap=e.eventsReduceFactorMap,this.reduceFactorManager.snapshotsReduceFactor=e.snapshotsReduceFactor,this.keyboard.refreshKeyboardCssSelectors(e.cssSelectors),this.keyboard.refreshObfuscatedValues(e.obfuscatedValues),this.sensors.maxSensorSamples=e.maxSensorSamples,this.sensors.sensorsTimestampDeltaInMillis=e.sensorsTimestampDeltaInMillis,this.isEnabled()?(this.mouse.start(),this.keyboard.start(),this.gesture.start(),this.indirect.start(),0==e.maxSensorSamples?this.sensors.stop():this.sensors.start(),(e=this.sessionData.lastDisposedPayload)&&this.sendInteractions(e),a.SecuredTouchUtil.addEventListener(window,"_onlocationchange",this.onUrlChangeHandler),a.SecuredTouchUtil.addEventListener(window,"popstate",this.onUrlChangeHandler),a.SecuredTouchUtil.addEventListener(window,"error",this.onErrorHandler)):(this.stopListening(),a.STLogger.info("Securedtouch is disabled."))):this.tryRecconect()},t.prototype.stopListening=function(){this.keyboard.stop(),this.mouse.stop(),this.gesture.stop(),this.indirect.stop(),this.sensors.stop(),window.removeEventListener("_onlocationchange",this.onUrlChangeHandler),window.removeEventListener("popstate",this.onUrlChangeHandler),window.removeEventListener("error",this.onErrorHandler)},t.prototype.resetLists=function(){this.capturedKeyboardInteractions.clear(),this.capturedMouseInteractions.clear(),this.capturedGestures.clear(),this.capturedIndirectEvents.clear(),this.indirectCounters={},this.sensors.reset(),a.SecuredTouchTags.instance.reset(),this.currentBufferSize=0},t.prototype.setUsernameToPayload=function(e){var t=this.sessionData.getUsername();e.username=t||this.sessionData.getDeviceCredentials().deviceId,e.keyboardInteractionPayloads.forEach(function(e){e.identified=Boolean(t)}),e.mouseInteractionPayloads.forEach(function(e){e.identified=Boolean(t)}),e.gestures.forEach(function(e){e.identified=Boolean(t)})},t.prototype.isValidGestures=function(){return this.capturedGestures&&0<this.capturedGestures.length&&this.capturedGestures.length<a.SecuredTouchPointerConfig.instance.maxSnapshotsCount},t.prototype.createInteractionsPayload=function(){var e={applicationId:this.startParams.appId,deviceId:this.sessionData.getDeviceCredentials().deviceId,deviceType:this.stMetadata.deviceType,appSessionId:this.sessionData.appSessionId,stToken:this.getStToken(),keyboardInteractionPayloads:this.capturedKeyboardInteractions.asArray,mouseInteractionPayloads:this.capturedMouseInteractions.asArray,indirectEventsPayload:this.reduceIndirectEvents(this.capturedIndirectEvents.asArray),indirectEventsCounters:this.indirectCounters,gestures:this.isValidGestures()?this.capturedGestures.asArray:[],metricsData:a.SecuredTouchMetrics.instance.getMetricsData(this.payloadIndex),accelerometerData:this.sensors.accelerometerList,gyroscopeData:this.sensors.gyroscopeList,linearAccelerometerData:this.sensors.linearAccelerometerList,rotationData:this.sensors.getRotationListCopy(),index:this.payloadIndex,payloadId:a.SecuredTouchUtil.newGuid(),modes:this.modes,tags:a.SecuredTouchTags.instance.getTagsCopy(),environment:this.getEnvironmentData(),isMobile:a.SecuredTouchUtil.isMobile,usernameTs:this.sessionData.usernameTs,username:""};return this.payloadIndex++,this.resetLists(),this.setUsernameToPayload(e),e},t.prototype.sendAllCapturedInteractions=function(e){var t=this,n=Promise.resolve();return this.isEnabled()&&(e||this.isAboveBufferSize()||a.SecuredTouchTags.instance.tags&&0<a.SecuredTouchTags.instance.tags.length?(this.clearIndirectBuffer(),n=this.sendInteractions(this.createInteractionsPayload())):this.resetLists()),n.catch(function(e){t.sendRemoteLog(a.SecuredTouchErrorCodes.E_5001,"failed to queue or create payload",e)})},t.prototype.sendInteractions=function(e){var t=this;return this.lastPayloadTimestamp=(new Date).getTime(),this.dataRepository.sendInteractions(e).then(function(e){e&&e.clientDigest&&t.updateDigest(e.clientDigest),t.interactionFailuresCounter=0}).catch(function(e){a.STLogger.warn("Failed to send Interactions",e),++t.interactionFailuresCounter>=a.SecuredTouchPointerConfig.instance.failuresAmountToReport&&(t.interactionFailuresCounter=0,t.sendRemoteLog(a.SecuredTouchErrorCodes.E_5000,"missed multiple interactions",e))})},t.prototype.enrichInteractionWithAdditionalData=function(e){try{var t=e.additionalData||{};this.addCommonAdditionalData(t),this.addWidthAndHeight(t),t.deviceCategory=this.stMetadata.deviceCategory,t.snapshotsReduceFactor=this.reduceFactorManager.snapshotsReduceFactor,t.eventsWereReduced=this.reduceFactorManager.eventsWereReduced(),e.additionalData=t}catch(e){a.STLogger.warn("Failed to enrich interactions",e)}},t.prototype.addWidthAndHeight=function(e){e.innerWidth=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e.innerHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,e.outerWidth=window.outerWidth,e.outerHeight=window.outerHeight},t);function t(e,t){t=n.call(this,e,t)||this;return t.capturedKeyboardInteractions=new a.SecuredTouchStorageArray(a.SecuredTouchConstants.CAPTURED_KEYBOARD_INTERACTIONS),t.capturedMouseInteractions=new a.SecuredTouchStorageArray(a.SecuredTouchConstants.CAPTURED_MOUSE_INTERACTIONS),t.capturedGestures=new a.SecuredTouchStorageArray(a.SecuredTouchConstants.CAPTURED_GESTURES),t.capturedIndirectEvents=new a.SecuredTouchStorageArray(a.SecuredTouchConstants.CAPTURED_INDIRECT),t.indirectCounters={},t.tagsIdentifications=new a.SecuredTouchElementsIdentifications,t.tagsWithValueIdentifications=new a.SecuredTouchTagsIdentifications,t.reduceFactorManager=new a.SecuredTouchReduceFactor,t.payloadIndex=0,t.totalMouseCounter=0,t.totalKeyboardCounter=0,t.totalGestureCounter=0,t.lastGestureTimestamp=0,t.currentBufferSize=0,t.interactionFailuresCounter=0,t.keyboard=new a.SecuredTouchKeyboard(t),t.keyboard.onInteraction.subscribe(t.handleKeyboardInteraction.bind(t)),t.keyboard.onEnterPress.subscribe(t.handleStTagOnEnter.bind(t)),t.keyboard.onObfuscatedValue.subscribe(t.handleTagValueOnBlur.bind(t)),t.mouse=new a.SecuredTouchMouse(t),t.mouse.onInteraction.subscribe(t.handleMouseInteraction.bind(t)),t.mouse.onClickEvent.subscribe(t.handleStTagOnClick.bind(t)),t.sensors=new a.SecuredTouchSensors(t),t.gesture=new a.SecuredTouchGestureEvents(t,t.sensors),t.gesture.onGesture.subscribe(t.handleGesture.bind(t)),t.indirect=new a.SecuredTouchIndirectClient(t),t.indirect.onIndirect.subscribe(t.handleIndirect.bind(t)),t.indirect.onWindowDispose.subscribe(t.handleWindowDispose.bind(t)),t.onUrlChangeHandler=t.onUrlChange.bind(t),t.onErrorHandler=t.onError.bind(t),t.sessionData.passedBufferTimeout&&t.resetLists(),t}a.SecuredTouchClient=e}(_securedTouchEntities=_securedTouchEntities||{});var _securedTouch=function(){function e(){}return Object.defineProperty(e,"isLogEnabled",{get:function(){return _securedTouchEntities.STLogger.isLogEnabled},set:function(e){_securedTouchEntities.STLogger.isLogEnabled=e},enumerable:!0,configurable:!0}),e.login=function(e,t){return _securedTouchEntities.SecuredTouchClientBase.instance().login(e,t)},e.logout=function(){return _securedTouchEntities.SecuredTouchClientBase.instance().logout()},e.addTag=function(e,t){return _securedTouchEntities.SecuredTouchClientBase.instance().addTag(e,t),this},e.setTag=function(e,t){return _securedTouchEntities.SecuredTouchClientBase.instance().addTag(e,t),Promise.resolve()},e.setSessionId=function(e){_securedTouchEntities.SecuredTouchClientBase.instance().setAppSessionId(e)},e.getSessionId=function(){return _securedTouchEntities.SecuredTouchSessionStorage.instance.appSessionId},e.pauseSecuredTouch=function(){_securedTouchEntities.SecuredTouchClientBase.instance().pauseSecuredTouch()},Object.defineProperty(e,"isRunning",{get:function(){return _securedTouchEntities.SecuredTouchClientBase.instance().isRunning()},enumerable:!0,configurable:!0}),e.resumeSecuredTouch=function(){_securedTouchEntities.SecuredTouchClientBase.instance().resumeSecuredTouch()},e.pauseBehavioralData=function(){_securedTouchEntities.SecuredTouchClientBase.instance().pauseBehavioralData()},e.resumeBehavioralData=function(){_securedTouchEntities.SecuredTouchClientBase.instance().resumeBehavioralData()},e.flush=function(){return _securedTouchEntities.SecuredTouchClientBase.instance().flush()},e.init=function(e){return _securedTouchEntities.SecuredTouchUtil.ieFix(),_securedTouchEntities.SecuredTouchClientBase.instance().startST(e)},e}();window._securedTouch=_securedTouch;var onDomReady=function(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)},_securedTouchEntities;onDomReady(function(){var e=new CustomEvent("SecuredTouchReadyEvent");document.dispatchEvent(e),window._securedTouchReady=!0}),function(o){var e=(t.prototype.test=function(n,i,r){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),this.propertyBlackList.has(i)?[3,2]:[4,o.SecuredTouchUtil.promiseTimeout(1500,r())];case 1:null!=(t=e.sent())&&(n[i]=t),e.label=2;case 2:return[3,4];case 3:return t=e.sent(),o.STLogger.warn(i+" headless test was failed",t),[3,4];case 4:return[2]}})})},t.prototype.headlessResults=function(r){return __awaiter(this,void 0,void 0,function(){var t,n,i=this;return __generator(this,function(e){switch(e.label){case 0:return t=new Map,(n=[]).push(this.test(t,"headless_chrome",function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(e){return[2,/HeadlessChrome/.test(r.navigator.userAgent)]})})})),n.push(this.test(t,"navigator.webdriver_present",function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(e){return[2,"webdriver"in r.navigator]})})})),n.push(this.test(t,"window.chrome_missing",function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(e){return[2,/Chrome/.test(r.navigator.userAgent)&&!r.chrome]})})})),n.push(this.test(t,"permissions_api",function(){return __awaiter(i,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return r.navigator.permissions&&r.Notification?[4,r.navigator.permissions.query({name:"notifications"})]:[3,2];case 1:return t=e.sent(),[2,"denied"===r.Notification.permission&&"prompt"===t.state];case 2:return[2]}})})})),n.push(this.test(t,"permissions_api_overriden",function(){return __awaiter(i,void 0,void 0,function(){var t;return __generator(this,function(e){return(t=r.navigator.permissions)?"function query() { [native code] }"!==t.query.toString()||"function toString() { [native code] }"!==t.query.toString.toString()||t.query.toString.hasOwnProperty("[[Handler]]")&&t.query.toString.hasOwnProperty("[[Target]]")&&t.query.toString.hasOwnProperty("[[IsRevoked]]")?[2,!0]:[2,t.hasOwnProperty("query")]:[2]})})})),n.push(this.test(t,"navigator.plugins_empty",function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(e){return[2,0===navigator.plugins.length]})})})),n.push(this.test(t,"navigator.languages_blank",function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(e){return[2,""===navigator.languages]})})})),[4,Promise.all(n)];case 1:return e.sent(),[2,t]}})})},t.prototype.getHeadlessResults=function(){return __awaiter(this,void 0,void 0,function(){var t,n=this;return __generator(this,function(e){switch(e.label){case 0:return[4,this.headlessResults(window)];case 1:return t=e.sent(),[4,this.test(t,"iframe_window",function(){return __awaiter(n,void 0,void 0,function(){var t,n;return __generator(this,function(e){switch(e.label){case 0:return Object.getOwnPropertyDescriptors&&(t=o.SecuredTouchUtil.createInvisibleElement("iframe"))?(t.srcdoc="page intentionally left blank",document.body.appendChild(t),"function get contentWindow() { [native code] }"!==Object.getOwnPropertyDescriptors(HTMLIFrameElement.prototype).contentWindow.get.toString()||t.contentWindow===window?[2,!0]:[4,this.headlessResults(t.contentWindow)]):[2];case 1:return n=e.sent(),t.remove(),[2,n]}})})})];case 2:return e.sent(),[2,t]}})})},t);function t(e){this.propertyBlackList=e}o.SecuredTouchDetectHeadless=e}(_securedTouchEntities=_securedTouchEntities||{});
