!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("wafer-tooltip",[],e):"object"==typeof exports?exports["wafer-tooltip"]=e():(t.wafer=t.wafer||{},t.wafer.wafers=t.wafer.wafers||{},t.wafer.wafers["wafer-tooltip"]=e())}("undefined"!=typeof self?self:this,function(){return o={"./src/base.js":function(t,e,o){"use strict";function y(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}Object.defineProperty(e,"__esModule",{value:!0});var h=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var o=[],r=!0,i=!1,a=void 0;try{for(var s,n=t[Symbol.iterator]();!(r=(s=n.next()).done)&&(o.push(s.value),!e||o.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{!r&&n.return&&n.return()}finally{if(i)throw a}}return o}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},v=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o,r=arguments[e];for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},r=function(t,e,o){return e&&p(t.prototype,e),o&&p(t,o),t},i=window.wafer,a=i.constants,s=i.features,n=i.utils,i=i.WaferBaseClass,w=a.ATTR_PREFIX,l=a.DISPLAY_BLOCK,g=a.DISPLAY_NONE,u=a.WAFER_DESTROYED,b="wafer-tooltip-wrapper",_="wafer-tooltip-text",m="wafer-tooltip-close",c=n.clearTimeout,T=n.convertNodeListToArray,f=n.setTimeout,E=["handleTooltipClose","handleTooltipMouseEnter"],O=[200,0],S=[],r=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(j,i),r(j,[{key:"teardown",value:function(t){this._util.elem&&this._util.elem.classList.add(u),window.wafer.base.destroy(this._util.elem)}},{key:"destroy",value:function(){var t=this._util.elem;t&&t.classList.add(u),this._util={}}},{key:"showTooltip",value:function(){var t=this,e=this._util,o=e.divWrapper,e=e.tooltipDisplayDelay;this.isEligibleToShow&&o&&!this.isTooltipAlreadyVisible&&(this._util.timeoutId=f(function(){t._util.timeoutId=void 0,o.style.display=l},e),(e=this.getPreviousLocalState).lastDisplayCount++,this.writeToLocalStorage=e)}},{key:"hideTooltip",value:function(){var t=this._util.divWrapper;t&&(t.style.display=g)}},{key:"daysDifference",value:function(t,e){return Math.floor((e-t)/864e5)}},{key:"isResetEveryExceeded",value:function(t){var e=this._util.resetEvery,o=Date.now();return this.daysDifference(t,o)>=e}},{key:"refreshLastResetDate",value:function(){var t=this.getPreviousLocalState;t.lastResetDate=Date.now(),t.lastDisplayCount=0,t.discovered=0,this.writeToLocalStorage=t}},{key:"handleTooltipClose",value:function(t){t=t.target;-1!==this._util.closeButtonElms.indexOf(t)&&(this._util.divWrapper&&(this._util.divWrapper.style.display=g),(t=this.getPreviousLocalState).discovered++,this.writeToLocalStorage=t)}},{key:"handleTooltipMouseEnter",value:function(){var t=this;this._state.mouseEnterTimeout&&c(this._state.mouseEnterTimeout,this),this._state.mouseEnterTimeout=f(function(){t.showTooltip()},0,this)}},{key:"config",get:function(){return{offsetX:this._util.offsetX,offsetY:this._util.offsetY,trigger:this._util.trigger}}},{key:"isTooltipAlreadyVisible",get:function(){var t=this._util,e=t.divWrapper,t=t.timeoutId;return e&&e.style.display===l||void 0!==t}},{key:"readFromLocalStorage",get:function(){var t=this._util.localStorageKey,e={};if(s.localStorage)try{e=JSON.parse(window.localStorage.getItem(t))||{}}catch(t){}return e}},{key:"writeToLocalStorage",set:function(t){var e=this._util.localStorageKey;if(s.localStorage)try{window.localStorage.setItem(e,JSON.stringify(t))}catch(t){}}},{key:"getPreviousLocalState",get:function(){var t=this.readFromLocalStorage;return t.discovered=t.discovered||0,t.lastResetDate=t.lastResetDate||Date.now(),t.lastDisplayCount=t.lastDisplayCount||0,t}},{key:"isEligibleToShow",get:function(){var t=this._util,e=t.discoveredCount,o=t.maxDisplayCount,r=this.getPreviousLocalState,i=r.discovered,t=r.lastDisplayCount,r=r.lastResetDate;return!(e<=i||!this.isResetEveryExceeded(r)&&o<=t)}}]),j);function j(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=e.selector,r=e.successClass;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,j);var i=y(this,(j.__proto__||Object.getPrototypeOf(j)).call(this,t,{selector:o},{STATE_ATTRS:S}));i._util={elem:t,selector:o.replace(".","")},i._state=v({},i._state,{mouseEnterTimeout:null});var a=t.getAttribute(w+"local-storage-key");if(!a)return i.teardown(w+"local-storage-key data attribute is mandatory for element with wafer-tooltip class"),y(i);var s=t.getAttribute(w+"max-display-count")||3,n=t.getAttribute(w+"reset-every")||15,l=t.getAttribute(w+"template-id")||"wafer-tooltip-template",u=t.getAttribute(w+"display-delay")||0,c=t.getAttribute(w+"tooltip-position")||"top",f=t.getAttribute(w+"tooltip-text")||"",p=t.getAttribute(w+"trigger")||"viewport",d=t.getAttribute(w+"trigger-offset"),e=d&&d.split(" ")||O,o=h(e,2),d=o[0],e=o[1],o=t.getAttribute(w+"tooltip-discovered-count")||1;i._util.localStorageKey=a,i._util.maxDisplayCount=s,i._util.resetEvery=n,i._util.discoveredCount=o;o=i.getPreviousLocalState;if(i.isResetEveryExceeded(o.lastResetDate)&&i.refreshLastResetDate(),!i.isEligibleToShow)return i.teardown("Tooltip is not eligible to be shown."),y(i);o=document.getElementById(l);if(!o)return i.teardown("Cannot find a template with id "+l),y(i);if(o.content&&t.appendChild(o.content.cloneNode(!0)),"top"!==c&&"bottom"!==c)return i.teardown(w+"tooltip-position must be 'top' or 'bottom'"),y(i);o=T(t.getElementsByClassName(b));if(!o.length)return i.teardown("Cannot find an element with class "+b),y(i);o=o[0];o.setAttribute("data-toolpos",c),o.style.display=g,i._util.divWrapper=o;o=T(t.getElementsByClassName(_));return o.length?(o[0].innerHTML=f,i._util.closeButtonElms=T(t.getElementsByClassName(m)),t.classList.contains(m)&&i._util.closeButtonElms.push(t),i._util.closeButtonElms.length&&t.classList.add("has-tooltip-click","has-wafer-click"),t.classList.add(r),i._util.offsetX=Number(e),i._util.offsetY=Number(d),i._util.tooltipDisplayDelay=u,i._util.trigger=p,E.forEach(function(t){i[t]=i[t].bind(i)}),"mouseenter"===p&&i.addEventListeners(),window.wafer.base.sync(t),i):(i.teardown("Cannot find an element with class "+_),y(i))}function p(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}r.events={click:[["has-tooltip-click","handleTooltipClose"]],mouseenter:[["_self","handleTooltipMouseEnter"]]},e.default=r,t.exports=e.default},"./src/controller.js":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s,n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o,r=arguments[e];for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},o=function(t,e,o){return e&&i(t.prototype,e),o&&i(t,o),t},r=window.wafer.utils,l=r.elementInView,u=r.throttle,c=window.wafer.base,r=window.wafer.controllers.WaferBaseController,o=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(f,r),o(f,[{key:"handleScroll",value:function(){this._validateWithThrottle()}},{key:"handleResize",value:function(){this._validateWithThrottle()}},{key:"willValidate",value:function(t){var s=this._state.elementInstances;t.forEach(function(t){var e=s.get(t).instance,o=e.config,r=o.trigger,i=o.offsetX,a=o.offsetY;switch(r){case"mouseenter":break;case"onLoad":e.showTooltip();break;default:l(t,{offsetX:i,offsetY:a},c.viewport)?e.showTooltip():e.hideTooltip()}})}}]),f);function f(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).root,e=void 0===t?document:t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);var o=f.prototype.configs,r=o.selector,t=o.successClass,o=o.validateDelay,o=void 0===o?25:o,i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,{root:e,selector:r,props:{selector:r,successClass:t},WaferClass:(s||(t=a("./src/base.js"),s=t&&t.__esModule?t:{default:t})).default}));return i._options=n({},i._options,{defaultOffsetY:200,defaultOffsetX:0}),i._validateWithThrottle=u(function(){i.validate()},o,i),i.sync(),i}function i(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}o.prototype.configs={selector:".wafer-tooltip",successClass:"wafer-tooltip-done"},e.default=o,t.exports=e.default},"./src/entry.js":function(t,e,o){"use strict";function r(){return t=o("./src/controller.js"),i=t&&t.__esModule?t:{default:t};var t}var i;Object.defineProperty(e,"__esModule",{value:!0}),e.default=new(i||r()).default({selector:(i||r()).default.prototype.configs.selector}),t.exports=e.default}},i={},r.m=o,r.c=i,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="https://s.yimg.com/aaq/wf/",r(r.s="./src/entry.js");function r(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return o[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}var o,i});
