function hex2b64(t){for(var e,i="",r=0;r+3<=t.length;r+=3)e=parseInt(t.substring(r,r+3),16),i+=b64map.charAt(e>>6)+b64map.charAt(63&e);if(r+1==t.length?(e=parseInt(t.substring(r,r+1),16),i+=b64map.charAt(e<<2)):r+2==t.length&&(e=parseInt(t.substring(r,r+2),16),i+=b64map.charAt(e>>2)+b64map.charAt((3&e)<<4)),b64pad)for(;0<(3&i.length);)i+=b64pad;return i}function b64tohex(t){for(var e,i,r="",n=0,s=0;s<t.length&&t.charAt(s)!=b64pad;++s)(i=b64map.indexOf(t.charAt(s)))<0||(n=0==n?(r+=int2char(i>>2),e=3&i,1):1==n?(r+=int2char(e<<2|i>>4),e=15&i,2):2==n?(r+=int2char(e),r+=int2char(i>>2),e=3&i,3):(r+=int2char(e<<2|i>>4),r+=int2char(15&i),0));return 1==n&&(r+=int2char(e<<2)),r}function b64toBA(t){for(var e=b64tohex(t),i=[],r=0;2*r<e.length;++r)i[r]=parseInt(e.substring(2*r,2*r+2),16);return i}function BigInteger(t,e,i){null!=t&&("number"==typeof t?this.fromNumber(t,e,i):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function nbi(){return new BigInteger(null)}function am1(t,e,i,r,n,s){for(;0<=--s;){var o=e*this[t++]+i[r]+n;n=Math.floor(o/67108864),i[r++]=67108863&o}return n}function am2(t,e,i,r,n,s){for(var o=32767&e,h=e>>15;0<=--s;){var a=32767&this[t],g=this[t++]>>15,u=h*a+g*o;n=((a=o*a+((32767&u)<<15)+i[r]+(1073741823&n))>>>30)+(u>>>15)+h*g+(n>>>30),i[r++]=1073741823&a}return n}function am3(t,e,i,r,n,s){for(var o=16383&e,h=e>>14;0<=--s;){var a=16383&this[t],g=this[t++]>>14,u=h*a+g*o;n=((a=o*a+((16383&u)<<14)+i[r]+n)>>28)+(u>>14)+h*g,i[r++]=268435455&a}return n}function int2char(t){return BI_RM.charAt(t)}function intAt(t,e){e=BI_RC[t.charCodeAt(e)];return null==e?-1:e}function bnpCopyTo(t){for(var e=this.t-1;0<=e;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function bnpFromInt(t){this.t=1,this.s=t<0?-1:0,0<t?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0}function nbv(t){var e=nbi();return e.fromInt(t),e}function bnpFromString(t,e){var i,r;if(16==e)i=4;else if(8==e)i=3;else if(256==e)i=8;else if(2==e)i=1;else if(32==e)i=5;else{if(4!=e)return void this.fromRadix(t,e);i=2}this.t=0,this.s=0;for(var n=t.length,s=!1,o=0;0<=--n;)(r=8==i?255&t[n]:intAt(t,n))<0?"-"==t.charAt(n)&&(s=!0):(s=!1,0==o?this[this.t++]=r:o+i>this.DB?(this[this.t-1]|=(r&(1<<this.DB-o)-1)<<o,this[this.t++]=r>>this.DB-o):this[this.t-1]|=r<<o,(o+=i)>=this.DB&&(o-=this.DB));8==i&&0!=(128&t[0])&&(this.s=-1,0<o&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),s&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var t=this.s&this.DM;0<this.t&&this[this.t-1]==t;)--this.t}function bnToString(t){var e;if(this.s<0)return"-"+this.negate().toString(t);if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var i,r=(1<<e)-1,n=!1,s="",o=this.t,h=this.DB-o*this.DB%e;if(0<o--)for(h<this.DB&&0<(i=this[o]>>h)&&(n=!0,s=int2char(i));0<=o;)h<e?i=(this[o]&(1<<h)-1)<<e-h|this[--o]>>(h+=this.DB-e):(i=this[o]>>(h-=e)&r,h<=0&&(h+=this.DB,--o)),(n=0<i?!0:n)&&(s+=int2char(i));return n?s:"0"}function bnNegate(){var t=nbi();return BigInteger.ZERO.subTo(this,t),t}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(t){var e,i=this.s-t.s;if(0!=i)return i;if(0!=(i=(e=this.t)-t.t))return this.s<0?-i:i;for(;0<=--e;)if(0!=(i=this[e]-t[e]))return i;return 0}function nbits(t){var e,i=1;return 0!=(e=t>>>16)&&(t=e,i+=16),0!=(e=t>>8)&&(t=e,i+=8),0!=(e=t>>4)&&(t=e,i+=4),0!=(e=t>>2)&&(t=e,i+=2),0!=(e=t>>1)&&(t=e,i+=1),i}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(t,e){for(var i=this.t-1;0<=i;--i)e[i+t]=this[i];for(i=t-1;0<=i;--i)e[i]=0;e.t=this.t+t,e.s=this.s}function bnpDRShiftTo(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s}function bnpLShiftTo(t,e){for(var i=t%this.DB,r=this.DB-i,n=(1<<r)-1,s=Math.floor(t/this.DB),o=this.s<<i&this.DM,h=this.t-1;0<=h;--h)e[h+s+1]=this[h]>>r|o,o=(this[h]&n)<<i;for(h=s-1;0<=h;--h)e[h]=0;e[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function bnpRShiftTo(t,e){var i,r;if(e.s=this.s,(i=Math.floor(t/this.DB))>=this.t)e.t=0;else{var n=t%this.DB,s=this.DB-n,o=(1<<n)-1;for(e[0]=this[i]>>n,r=i+1;r<this.t;++r)e[r-i-1]|=(this[r]&o)<<s,e[r-i]=this[r]>>n;0<n&&(e[this.t-i-1]|=(this.s&o)<<s),e.t=this.t-i,e.clamp()}}function bnpSubTo(t,e){for(var i=0,r=0,n=Math.min(t.t,this.t);i<n;)r+=this[i]-t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r-=t[i],e[i++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=r<0?-1:0,r<-1?e[i++]=this.DV+r:0<r&&(e[i++]=r),e.t=i,e.clamp()}function bnpMultiplyTo(t,e){var i=this.abs(),r=t.abs(),n=i.t;for(e.t=n+r.t;0<=--n;)e[n]=0;for(n=0;n<r.t;++n)e[n+i.t]=i.am(0,r[n],e,n,0,i.t);e.s=0,e.clamp(),this.s!=t.s&&BigInteger.ZERO.subTo(e,e)}function bnpSquareTo(t){for(var e,i=this.abs(),r=t.t=2*i.t;0<=--r;)t[r]=0;for(r=0;r<i.t-1;++r)e=i.am(r,i[r],t,2*r,0,1),(t[r+i.t]+=i.am(r+1,2*i[r],t,2*r+1,e,i.t-r-1))>=i.DV&&(t[r+i.t]-=i.DV,t[r+i.t+1]=1);0<t.t&&(t[t.t-1]+=i.am(r,i[r],t,2*r,0,1)),t.s=0,t.clamp()}function bnpDivRemTo(t,e,i){var r,n,s,o=t.abs();if(!(o.t<=0)){if((u=this.abs()).t<o.t)return null!=e&&e.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=nbi());var h=nbi(),a=this.s,g=t.s,t=this.DB-nbits(o[o.t-1]);if(0<t?(o.lShiftTo(t,h),u.lShiftTo(t,i)):(o.copyTo(h),u.copyTo(i)),0!=(n=h[(r=h.t)-1])){var u=n*(1<<this.F1)+(1<r?h[r-2]>>this.F2:0),p=this.FV/u,f=(1<<this.F1)/u,c=1<<this.F2,l=i.t,d=l-r,S=null==e?nbi():e;for(h.dlShiftTo(d,S),0<=i.compareTo(S)&&(i[i.t++]=1,i.subTo(S,i)),BigInteger.ONE.dlShiftTo(r,S),S.subTo(h,h);h.t<r;)h[h.t++]=0;for(;0<=--d;)if(s=i[--l]==n?this.DM:Math.floor(i[l]*p+(i[l-1]+c)*f),(i[l]+=h.am(0,s,i,d,0,r))<s)for(h.dlShiftTo(d,S),i.subTo(S,i);i[l]<--s;)i.subTo(S,i);null!=e&&(i.drShiftTo(r,e),a!=g&&BigInteger.ZERO.subTo(e,e)),i.t=r,i.clamp(),0<t&&i.rShiftTo(t,i),a<0&&BigInteger.ZERO.subTo(i,i)}}}function bnMod(t){var e=nbi();return this.abs().divRemTo(t,null,e),this.s<0&&0<e.compareTo(BigInteger.ZERO)&&t.subTo(e,e),e}function Classic(t){this.m=t}function cConvert(t){return t.s<0||0<=t.compareTo(this.m)?t.mod(this.m):t}function cRevert(t){return t}function cReduce(t){t.divRemTo(this.m,null,t)}function cMulTo(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function cSqrTo(t,e){t.squareTo(e),this.reduce(e)}function bnpInvDigit(){var t,e;return this.t<1?0:0==(1&(t=this[0]))?0:0<(e=(e=(e=(e=(e=3&t)*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)?this.DV-e:-e}function Montgomery(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function montConvert(t){var e=nbi();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&0<e.compareTo(BigInteger.ZERO)&&this.m.subTo(e,e),e}function montRevert(t){var e=nbi();return t.copyTo(e),this.reduce(e),e}function montReduce(t){for(var e,i,r;t.t<=this.mt2;)t[t.t++]=0;for(e=0;e<this.m.t;++e)for(r=(i=32767&t[e])*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM,t[i=e+this.m.t]+=this.m.am(0,r,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++;t.clamp(),t.drShiftTo(this.m.t,t),0<=t.compareTo(this.m)&&t.subTo(this.m,t)}function montSqrTo(t,e){t.squareTo(e),this.reduce(e)}function montMulTo(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function bnpIsEven(){return 0==(0<this.t?1&this[0]:this.s)}function bnpExp(t,e){var i;if(4294967295<t||t<1)return BigInteger.ONE;var r=nbi(),n=nbi(),s=e.convert(this),o=nbits(t)-1;for(s.copyTo(r);0<=--o;)e.sqrTo(r,n),0<(t&1<<o)?e.mulTo(n,s,r):(i=r,r=n,n=i);return e.revert(r)}function bnModPowInt(t,e){e=new(t<256||e.isEven()?Classic:Montgomery)(e);return this.exp(t,e)}function bnClone(){var t=nbi();return this.copyTo(t),t}function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function bnpToRadix(t){if(null==t&&(t=10),0==this.signum()||t<2||36<t)return"0";var e=this.chunkSize(t),i=Math.pow(t,e),r=nbv(i),n=nbi(),s=nbi(),o="";for(this.divRemTo(r,n,s);0<n.signum();)o=(i+s.intValue()).toString(t).substr(1)+o,n.divRemTo(r,n,s);return s.intValue().toString(t)+o}function bnpFromRadix(t,e){var i;this.fromInt(0);for(var r=this.chunkSize(e=null==e?10:e),n=Math.pow(e,r),s=!1,o=0,h=0,a=0;a<t.length;++a)(i=intAt(t,a))<0?"-"==t.charAt(a)&&0==this.signum()&&(s=!0):(h=e*h+i,++o>=r&&(this.dMultiply(n),this.dAddOffset(h,0),h=o=0));0<o&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(h,0)),s&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(t,e,i){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(t-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(BigInteger.ONE.shiftLeft(t-1),this);else{var r=[],i=7&t;r.length=1+(t>>3),e.nextBytes(r),0<i?r[0]&=(1<<i)-1:r[0]=0,this.fromString(r,256)}}function bnToByteArray(){var t,e,i,r=this.t,n=[];if(n[0]=this.s,t=this.DB-r*this.DB%8,(i=0)<r--)for(t<this.DB&&(e=this[r]>>t)!=(this.s&this.DM)>>t&&(n[i++]=e|this.s<<this.DB-t);0<=r;)t<8?e=(this[r]&(1<<t)-1)<<8-t|this[--r]>>(t+=this.DB-8):(e=this[r]>>(t-=8)&255,t<=0&&(t+=this.DB,--r)),0!=(128&e)&&(e|=-256),0==i&&(128&this.s)!=(128&e)&&++i,(0<i||e!=this.s)&&(n[i++]=e);return n}function bnEquals(t){return 0==this.compareTo(t)}function bnMin(t){return this.compareTo(t)<0?this:t}function bnMax(t){return 0<this.compareTo(t)?this:t}function bnpBitwiseTo(t,e,i){for(var r,n=Math.min(t.t,this.t),s=0;s<n;++s)i[s]=e(this[s],t[s]);if(t.t<this.t){for(r=t.s&this.DM,s=n;s<this.t;++s)i[s]=e(this[s],r);i.t=this.t}else{for(r=this.s&this.DM,s=n;s<t.t;++s)i[s]=e(r,t[s]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()}function op_and(t,e){return t&e}function bnAnd(t){var e=nbi();return this.bitwiseTo(t,op_and,e),e}function op_or(t,e){return t|e}function bnOr(t){var e=nbi();return this.bitwiseTo(t,op_or,e),e}function op_xor(t,e){return t^e}function bnXor(t){var e=nbi();return this.bitwiseTo(t,op_xor,e),e}function op_andnot(t,e){return t&~e}function bnAndNot(t){var e=nbi();return this.bitwiseTo(t,op_andnot,e),e}function bnNot(){for(var t=nbi(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function bnShiftLeft(t){var e=nbi();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function bnShiftRight(t){var e=nbi();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function lbit(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function bnGetLowestSetBit(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+lbit(this[t]);return this.s<0?this.t*this.DB:-1}function cbit(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function bnBitCount(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=cbit(this[i]^e);return t}function bnTestBit(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function bnpChangeBit(t,e){t=BigInteger.ONE.shiftLeft(t);return this.bitwiseTo(t,e,t),t}function bnSetBit(t){return this.changeBit(t,op_or)}function bnClearBit(t){return this.changeBit(t,op_andnot)}function bnFlipBit(t){return this.changeBit(t,op_xor)}function bnpAddTo(t,e){for(var i=0,r=0,n=Math.min(t.t,this.t);i<n;)r+=this[i]+t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r+=t[i],e[i++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=r<0?-1:0,0<r?e[i++]=r:r<-1&&(e[i++]=this.DV+r),e.t=i,e.clamp()}function bnAdd(t){var e=nbi();return this.addTo(t,e),e}function bnSubtract(t){var e=nbi();return this.subTo(t,e),e}function bnMultiply(t){var e=nbi();return this.multiplyTo(t,e),e}function bnSquare(){var t=nbi();return this.squareTo(t),t}function bnDivide(t){var e=nbi();return this.divRemTo(t,e,null),e}function bnRemainder(t){var e=nbi();return this.divRemTo(t,null,e),e}function bnDivideAndRemainder(t){var e=nbi(),i=nbi();return this.divRemTo(t,e,i),[e,i]}function bnpDMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function NullExp(){}function nNop(t){return t}function nMulTo(t,e,i){t.multiplyTo(e,i)}function nSqrTo(t,e){t.squareTo(e)}function bnPow(t){return this.exp(t,new NullExp)}function bnpMultiplyLowerTo(t,e,i){var r,n=Math.min(this.t+t.t,e);for(i.s=0,i.t=n;0<n;)i[--n]=0;for(r=i.t-this.t;n<r;++n)i[n+this.t]=this.am(0,t[n],i,n,0,this.t);for(r=Math.min(t.t,e);n<r;++n)this.am(0,t[n],i,n,0,e-n);i.clamp()}function bnpMultiplyUpperTo(t,e,i){var r=i.t=this.t+t.t- --e;for(i.s=0;0<=--r;)i[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)i[this.t+r-e]=this.am(e-r,t[r],i,0,0,this.t+r-e);i.clamp(),i.drShiftTo(1,i)}function Barrett(t){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function barrettConvert(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=nbi();return t.copyTo(e),this.reduce(e),e}function barrettRevert(t){return t}function barrettReduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);0<=t.compareTo(this.m);)t.subTo(this.m,t)}function barrettSqrTo(t,e){t.squareTo(e),this.reduce(e)}function barrettMulTo(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function bnModPow(t,e){var i,r=t.bitLength(),n=nbv(1);if(r<=0)return n;var s=r<18?1:r<48?3:r<144?4:r<768?5:6,o=new(r<8?Classic:e.isEven()?Barrett:Montgomery)(e),h=[],a=3,g=s-1,u=(1<<s)-1;if(h[1]=o.convert(this),1<s)for(i=nbi(),o.sqrTo(h[1],i);a<=u;)h[a]=nbi(),o.mulTo(i,h[a-2],h[a]),a+=2;for(var p,f,c=t.t-1,l=!0,d=nbi(),r=nbits(t[c])-1;0<=c;){for(g<=r?p=t[c]>>r-g&u:(p=(t[c]&(1<<r+1)-1)<<g-r,0<c&&(p|=t[c-1]>>this.DB+r-g)),a=s;0==(1&p);)p>>=1,--a;if((r-=a)<0&&(r+=this.DB,--c),l)h[p].copyTo(n),l=!1;else{for(;1<a;)o.sqrTo(n,d),o.sqrTo(d,n),a-=2;0<a?o.sqrTo(n,d):(f=n,n=d,d=f),o.mulTo(d,h[p],n)}for(;0<=c&&0==(t[c]&1<<r);)o.sqrTo(n,d),f=n,n=d,d=f,--r<0&&(r=this.DB-1,--c)}return o.revert(n)}function bnGCD(t){var e,i,r=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(r.compareTo(n)<0&&(i=r,r=n,n=i),e=r.getLowestSetBit(),(i=n.getLowestSetBit())<0)return r;for(0<(i=e<i?e:i)&&(r.rShiftTo(i,r),n.rShiftTo(i,n));0<r.signum();)0<(e=r.getLowestSetBit())&&r.rShiftTo(e,r),0<(e=n.getLowestSetBit())&&n.rShiftTo(e,n),0<=r.compareTo(n)?(r.subTo(n,r),r.rShiftTo(1,r)):(n.subTo(r,n),n.rShiftTo(1,n));return 0<i&&n.lShiftTo(i,n),n}function bnpModInt(t){var e,i,r;if(t<=0)return 0;if(e=this.DV%t,i=this.s<0?t-1:0,0<this.t)if(0==e)i=this[0]%t;else for(r=this.t-1;0<=r;--r)i=(e*i+this[r])%t;return i}function bnModInverse(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return BigInteger.ZERO;for(var i=t.clone(),r=this.clone(),n=nbv(1),s=nbv(0),o=nbv(0),h=nbv(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),e?(n.isEven()&&s.isEven()||(n.addTo(this,n),s.subTo(t,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;r.isEven();)r.rShiftTo(1,r),e?(o.isEven()&&h.isEven()||(o.addTo(this,o),h.subTo(t,h)),o.rShiftTo(1,o)):h.isEven()||h.subTo(t,h),h.rShiftTo(1,h);0<=i.compareTo(r)?(i.subTo(r,i),e&&n.subTo(o,n),s.subTo(h,s)):(r.subTo(i,r),e&&o.subTo(n,o),h.subTo(s,h))}return 0!=r.compareTo(BigInteger.ONE)?BigInteger.ZERO:0<=h.compareTo(t)?h.subtract(t):h.signum()<0?(h.addTo(t,h),h.signum()<0?h.add(t):h):h}function bnIsProbablePrime(t){var e,i,r,n=this.abs();if(1==n.t&&n[0]<=lowprimes[lowprimes.length-1]){for(e=0;e<lowprimes.length;++e)if(n[0]==lowprimes[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<lowprimes.length;){for(i=lowprimes[e],r=e+1;r<lowprimes.length&&i<lplim;)i*=lowprimes[r++];for(i=n.modInt(i);e<r;)if(i%lowprimes[e++]==0)return!1}return n.millerRabin(t)}function bnpMillerRabin(t){var e,i,r,n,s,o=this.subtract(BigInteger.ONE),h=o.getLowestSetBit();if(h<=0)return!1;for(e=o.shiftRight(h),(t=t+1>>1)>lowprimes.length&&(t=lowprimes.length),i=nbi(),r=0;r<t;++r)if(i.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]),0!=(n=i.modPow(e,this)).compareTo(BigInteger.ONE)&&0!=n.compareTo(o)){for(s=1;s++<h&&0!=n.compareTo(o);)if(0==(n=n.modPowInt(2,this)).compareTo(BigInteger.ONE))return!1;if(0!=n.compareTo(o))return!1}return!0}function parseBigInt(t,e){return new BigInteger(t,e)}function linebrk(t,e){for(var i="",r=0;r+e<t.length;)i+=t.substring(r,r+e)+"\n",r+=e;return i+t.substring(r,t.length)}function byte2Hex(t){return t<16?"0"+t.toString(16):t.toString(16)}function pkcs1pad2(t,e){var i,r,n,s,o;if(e<t.length+11)return alert("Message too long for RSA"),null;for(i=[],r=t.length-1;0<=r&&0<e;)(n=t.charCodeAt(r--))<128?i[--e]=n:127<n&&n<2048?(i[--e]=63&n|128,i[--e]=n>>6|192):(i[--e]=63&n|128,i[--e]=n>>6&63|128,i[--e]=n>>12|224);for(i[--e]=0,s=new SecureRandom,o=[];2<e;){for(o[0]=0;0==o[0];)s.nextBytes(o);i[--e]=o[0]}return i[--e]=2,i[--e]=0,new BigInteger(i)}function oaep_mgf1_arr(t,e,i){for(var r="",n=0;r.length<e;)r+=i(String.fromCharCode.apply(String,t.concat([(4278190080&n)>>24,(16711680&n)>>16,(65280&n)>>8,255&n]))),n+=1;return r}function oaep_pad(t,e,i){var r,n,s,o,h,a,g,u;if(t.length+2*SHA1_SIZE+2>e)throw"Message too long for RSA";for(r="",n=0;n<e-t.length-2*SHA1_SIZE-2;n+=1)r+="\0";for(s=rstr_sha1("")+r+""+t,o=new Array(SHA1_SIZE),(new SecureRandom).nextBytes(o),h=oaep_mgf1_arr(o,s.length,i||rstr_sha1),a=[],n=0;n<s.length;n+=1)a[n]=s.charCodeAt(n)^h.charCodeAt(n);for(g=oaep_mgf1_arr(a,o.length,rstr_sha1),u=[0],n=0;n<o.length;n+=1)u[n+1]=o[n]^g.charCodeAt(n);return new BigInteger(u.concat(a))}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function RSASetPublic(t,e){this.isPublic=!0,"string"!=typeof t?(this.n=t,this.e=e):null!=t&&null!=e&&0<t.length&&0<e.length?(this.n=parseBigInt(t,16),this.e=parseInt(e,16)):alert("Invalid RSA public key")}function RSADoPublic(t){return t.modPowInt(this.e,this.n)}function RSAEncrypt(t){t=pkcs1pad2(t,this.n.bitLength()+7>>3);return null==t?null:null==(t=this.doPublic(t))?null:0==(1&(t=t.toString(16)).length)?t:"0"+t}function RSAEncryptOAEP(t,e){e=oaep_pad(t,this.n.bitLength()+7>>3,e);return null==e?null:null==(e=this.doPublic(e))?null:0==(1&(e=e.toString(16)).length)?e:"0"+e}function pkcs1unpad2(t,e){for(var i,r,n=t.toByteArray(),s=0;s<n.length&&0==n[s];)++s;if(n.length-s!=e-1||2!=n[s])return null;for(++s;0!=n[s];)if(++s>=n.length)return null;for(i="";++s<n.length;)(r=255&n[s])<128?i+=String.fromCharCode(r):191<r&&r<224?(i+=String.fromCharCode((31&r)<<6|63&n[s+1]),++s):(i+=String.fromCharCode((15&r)<<12|(63&n[s+1])<<6|63&n[s+2]),s+=2);return i}function oaep_mgf1_str(t,e,i){for(var r="",n=0;r.length<e;)r+=i(t+String.fromCharCode.apply(String,[(4278190080&n)>>24,(16711680&n)>>16,(65280&n)>>8,255&n])),n+=1;return r}function oaep_unpad(t,e,i){var r,n;for(t=t.toByteArray(),g=0;g<t.length;g+=1)t[g]&=255;for(;t.length<e;)t.unshift(0);if((t=String.fromCharCode.apply(String,t)).length<2*SHA1_SIZE+2)throw"Cipher too short";for(var s=t.substr(1,SHA1_SIZE),o=t.substr(SHA1_SIZE+1),h=oaep_mgf1_str(o,SHA1_SIZE,i||rstr_sha1),a=[],g=0;g<s.length;g+=1)a[g]=s.charCodeAt(g)^h.charCodeAt(g);for(r=oaep_mgf1_str(String.fromCharCode.apply(String,a),t.length-SHA1_SIZE,rstr_sha1),n=[],g=0;g<o.length;g+=1)n[g]=o.charCodeAt(g)^r.charCodeAt(g);if((n=String.fromCharCode.apply(String,n)).substr(0,SHA1_SIZE)!==rstr_sha1(""))throw"Hash mismatch";if((-1!=(i=(n=n.substr(SHA1_SIZE)).indexOf(""))?n.substr(0,i).lastIndexOf("\0"):-1)+1!=i)throw"Malformed data";return n.substr(i+1)}function RSASetPrivate(t,e,i){this.isPrivate=!0,"string"!=typeof t?(this.n=t,this.e=e,this.d=i):null!=t&&null!=e&&0<t.length&&0<e.length?(this.n=parseBigInt(t,16),this.e=parseInt(e,16),this.d=parseBigInt(i,16)):alert("Invalid RSA private key")}function RSASetPrivateEx(t,e,i,r,n,s,o,h){if(this.isPrivate=!0,null==t)throw"RSASetPrivateEx N == null";if(null==e)throw"RSASetPrivateEx E == null";if(0==t.length)throw"RSASetPrivateEx N.length == 0";if(0==e.length)throw"RSASetPrivateEx E.length == 0";null!=t&&null!=e&&0<t.length&&0<e.length?(this.n=parseBigInt(t,16),this.e=parseInt(e,16),this.d=parseBigInt(i,16),this.p=parseBigInt(r,16),this.q=parseBigInt(n,16),this.dmp1=parseBigInt(s,16),this.dmq1=parseBigInt(o,16),this.coeff=parseBigInt(h,16)):alert("Invalid RSA private key in RSASetPrivateEx")}function RSAGenerate(t,e){var i,r=new SecureRandom,n=t>>1;for(this.e=parseInt(e,16),i=new BigInteger(e,16);;){for(;this.p=new BigInteger(t-n,1,r),0!=this.p.subtract(BigInteger.ONE).gcd(i).compareTo(BigInteger.ONE)||!this.p.isProbablePrime(10););for(;this.q=new BigInteger(n,1,r),0!=this.q.subtract(BigInteger.ONE).gcd(i).compareTo(BigInteger.ONE)||!this.q.isProbablePrime(10););this.p.compareTo(this.q)<=0&&(h=this.p,this.p=this.q,this.q=h);var s=this.p.subtract(BigInteger.ONE),o=this.q.subtract(BigInteger.ONE),h=s.multiply(o);if(0==h.gcd(i).compareTo(BigInteger.ONE)){this.n=this.p.multiply(this.q),this.d=i.modInverse(h),this.dmp1=this.d.mod(s),this.dmq1=this.d.mod(o),this.coeff=this.q.modInverse(this.p);break}}this.isPrivate=!0}function RSADoPrivate(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),i=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(i)<0;)e=e.add(this.p);return e.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)}function RSADecrypt(t){t=parseBigInt(t,16),t=this.doPrivate(t);return null==t?null:pkcs1unpad2(t,this.n.bitLength()+7>>3)}function RSADecryptOAEP(t,e){t=parseBigInt(t,16),t=this.doPrivate(t);return null==t?null:oaep_unpad(t,this.n.bitLength()+7>>3,e)}function _rsapem_pemToBase64(t){return t.replace("-----BEGIN RSA PRIVATE KEY-----","").replace("-----END RSA PRIVATE KEY-----","").replace(/[ \n]+/g,"")}function _rsapem_getPosArrayOfChildrenFromHex(t){var e=[],i=ASN1HEX.getStartPosOfV_AtObj(t,0),r=ASN1HEX.getPosOfNextSibling_AtObj(t,i),n=ASN1HEX.getPosOfNextSibling_AtObj(t,r),s=ASN1HEX.getPosOfNextSibling_AtObj(t,n),o=ASN1HEX.getPosOfNextSibling_AtObj(t,s),h=ASN1HEX.getPosOfNextSibling_AtObj(t,o),a=ASN1HEX.getPosOfNextSibling_AtObj(t,h),g=ASN1HEX.getPosOfNextSibling_AtObj(t,a),t=ASN1HEX.getPosOfNextSibling_AtObj(t,g);return e.push(i,r,n,s,o,h,a,g,t),e}function _rsapem_getHexValueArrayOfChildrenFromHex(t){var e=_rsapem_getPosArrayOfChildrenFromHex(t),i=ASN1HEX.getHexOfV_AtObj(t,e[0]),r=ASN1HEX.getHexOfV_AtObj(t,e[1]),n=ASN1HEX.getHexOfV_AtObj(t,e[2]),s=ASN1HEX.getHexOfV_AtObj(t,e[3]),o=ASN1HEX.getHexOfV_AtObj(t,e[4]),h=ASN1HEX.getHexOfV_AtObj(t,e[5]),a=ASN1HEX.getHexOfV_AtObj(t,e[6]),g=ASN1HEX.getHexOfV_AtObj(t,e[7]),t=ASN1HEX.getHexOfV_AtObj(t,e[8]),e=[];return e.push(i,r,n,s,o,h,a,g,t),e}function _rsapem_readPrivateKeyFromASN1HexString(t){t=_rsapem_getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function _rsapem_readPrivateKeyFromPEMString(t){t=_rsapem_getHexValueArrayOfChildrenFromHex(b64tohex(_rsapem_pemToBase64(t)));this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function _rsasign_getHexPaddedDigestInfoForString(t,e,i){var r=KJUR.crypto.Util.hashString(t,i);return KJUR.crypto.Util.getPaddedDigestInfoHex(r,i,e)}function _zeroPaddingOfSignature(t,e){for(var i="",r=e/4-t.length,n=0;n<r;n++)i+="0";return i+t}function _rsasign_signString(t,e){var i=KJUR.crypto.Util.hashString(t,e);return this.signWithMessageHash(i,e)}function _rsasign_signWithMessageHash(t,e){e=parseBigInt(KJUR.crypto.Util.getPaddedDigestInfoHex(t,e,this.n.bitLength()),16);return _zeroPaddingOfSignature(this.doPrivate(e).toString(16),this.n.bitLength())}function _rsasign_signStringWithSHA1(t){return _rsasign_signString.call(this,t,"sha1")}function _rsasign_signStringWithSHA256(t){return _rsasign_signString.call(this,t,"sha256")}function pss_mgf1_str(t,e,i){for(var r="",n=0;r.length<e;)r+=hextorstr(i(rstrtohex(t+String.fromCharCode.apply(String,[(4278190080&n)>>24,(16711680&n)>>16,(65280&n)>>8,255&n])))),n+=1;return r}function _rsasign_signStringPSS(t,e,i){var r,t=(r=rstrtohex(t),KJUR.crypto.Util.hashHex(r,e));return this.signWithMessageHashPSS(t,e,i=void 0===i?-1:i)}function _rsasign_signWithMessageHashPSS(t,e,i){function r(t){return KJUR.crypto.Util.hashHex(t,e)}var n,s,o=hextorstr(t),h=o.length,a=this.n.bitLength()-1,g=Math.ceil(a/8);if(-1===i||void 0===i)i=h;else if(-2===i)i=g-h-2;else if(i<-2)throw"invalid salt length";if(g<h+i+2)throw"data too long";for(t="",0<i&&(t=new Array(i),(new SecureRandom).nextBytes(t),t=String.fromCharCode.apply(String,t)),n=hextorstr(r(rstrtohex("\0\0\0\0\0\0\0\0"+o+t))),s=[],c=0;c<g-i-h-2;c+=1)s[c]=0;for(var u=String.fromCharCode.apply(String,s)+""+t,p=pss_mgf1_str(n,u.length,r),f=[],c=0;c<u.length;c+=1)f[c]=u.charCodeAt(c)^p.charCodeAt(c);for(f[0]&=~(65280>>8*g-a&255),c=0;c<h;c++)f.push(n.charCodeAt(c));return f.push(188),_zeroPaddingOfSignature(this.doPrivate(new BigInteger(f)).toString(16),this.n.bitLength())}function _rsasign_getDecryptSignatureBI(t,e,i){var r=new RSAKey;return r.setPublic(e,i),r.doPublic(t)}function _rsasign_getHexDigestInfoFromSig(t,e,i){return _rsasign_getDecryptSignatureBI(t,e,i).toString(16).replace(/^1f+00/,"")}function _rsasign_getAlgNameAndHashFromHexDisgestInfo(t){var e,i,r;for(e in KJUR.crypto.Util.DIGESTINFOHEAD)if(i=KJUR.crypto.Util.DIGESTINFOHEAD[e],r=i.length,t.substring(0,r)==i)return[e,t.substring(r)];return[]}function _rsasign_verifySignatureWithArgs(t,e,i,r){r=_rsasign_getAlgNameAndHashFromHexDisgestInfo(_rsasign_getHexDigestInfoFromSig(e,i,r));if(0==r.length)return!1;var n=r[0];return r[1]==KJUR.crypto.Util.hashString(t,n)}function _rsasign_verifyHexSignatureForMessage(t,e){return _rsasign_verifySignatureWithArgs(e,parseBigInt(t,16),this.n.toString(16),this.e.toString(16))}function _rsasign_verifyString(t,e){if((e=parseBigInt(e=(e=e.replace(_RE_HEXDECONLY,"")).replace(/[ \n]+/g,""),16)).bitLength()>this.n.bitLength())return 0;e=_rsasign_getAlgNameAndHashFromHexDisgestInfo(this.doPublic(e).toString(16).replace(/^1f+00/,""));if(0==e.length)return!1;var i=e[0];return e[1]==KJUR.crypto.Util.hashString(t,i)}function _rsasign_verifyWithMessageHash(t,e){if((e=parseBigInt(e=(e=e.replace(_RE_HEXDECONLY,"")).replace(/[ \n]+/g,""),16)).bitLength()>this.n.bitLength())return 0;e=_rsasign_getAlgNameAndHashFromHexDisgestInfo(this.doPublic(e).toString(16).replace(/^1f+00/,""));return 0!=e.length&&(e[0],e[1]==t)}function _rsasign_verifyStringPSS(t,e,i,r){var n,t=(n=rstrtohex(t),KJUR.crypto.Util.hashHex(n,i));return this.verifyWithMessageHashPSS(t,e,i,r=void 0===r?-1:r)}function _rsasign_verifyWithMessageHashPSS(t,e,i,r){var n,s,o,h=new BigInteger(e,16);if(h.bitLength()>this.n.bitLength())return!1;function a(t){return KJUR.crypto.Util.hashHex(t,i)}var g,u=hextorstr(t),e=u.length,t=this.n.bitLength()-1,p=Math.ceil(t/8);if(-1===r||void 0===r)r=e;else if(-2===r)r=p-e-2;else if(r<-2)throw"invalid salt length";if(p<e+r+2)throw"data too long";for(f=this.doPublic(h).toByteArray(),g=0;g<f.length;g+=1)f[g]&=255;for(;f.length<p;)f.unshift(0);if(188!==f[p-1])throw"encoded message does not end in 0xbc";var f,c=(f=String.fromCharCode.apply(String,f)).substr(0,p-e-1),h=f.substr(c.length,e),t=65280>>8*p-t&255;if(0!=(c.charCodeAt(0)&t))throw"bits beyond keysize not zero";for(n=pss_mgf1_str(h,c.length,a),s=[],g=0;g<c.length;g+=1)s[g]=c.charCodeAt(g)^n.charCodeAt(g);for(s[0]&=~t,o=p-e-r-2,g=0;g<o;g+=1)if(0!==s[g])throw"leftmost octets not zero";if(1!==s[o])throw"0x01 marker not found";return h===hextorstr(a(rstrtohex("\0\0\0\0\0\0\0\0"+u+String.fromCharCode.apply(String,s.slice(-r)))))}function X509(){this.subjectPublicKeyRSA=null,this.subjectPublicKeyRSA_hN=null,this.subjectPublicKeyRSA_hE=null,this.hex=null,this.getSerialNumberHex=function(){return ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,1])},this.getIssuerHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3])},this.getIssuerString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3]))},this.getSubjectHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5])},this.getSubjectString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5]))},this.getNotBefore=function(){var t=(t=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,0])).replace(/(..)/g,"%$1");return decodeURIComponent(t)},this.getNotAfter=function(){var t=(t=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,1])).replace(/(..)/g,"%$1");return decodeURIComponent(t)},this.readCertPEM=function(t){var e=X509.pemToHex(t),i=X509.getPublicKeyHexArrayFromCertHex(e),t=new RSAKey;t.setPublic(i[0],i[1]),this.subjectPublicKeyRSA=t,this.subjectPublicKeyRSA_hN=i[0],this.subjectPublicKeyRSA_hE=i[1],this.hex=e},this.readCertPEMWithoutRSAInit=function(t){var e=X509.pemToHex(t),t=X509.getPublicKeyHexArrayFromCertHex(e);this.subjectPublicKeyRSA.setPublic(t[0],t[1]),this.subjectPublicKeyRSA_hN=t[0],this.subjectPublicKeyRSA_hE=t[1],this.hex=e}}function Base64x(){}function stoBA(t){for(var e=[],i=0;i<t.length;i++)e[i]=t.charCodeAt(i);return e}function BAtos(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return e}function BAtohex(t){for(var e,i="",r=0;r<t.length;r++)i+=e=1==(e=t[r].toString(16)).length?"0"+e:e;return i}function stohex(t){return BAtohex(stoBA(t))}function stob64(t){return hex2b64(stohex(t))}function stob64u(t){return b64tob64u(hex2b64(stohex(t)))}function b64utos(t){return BAtos(b64toBA(b64utob64(t)))}function b64tob64u(t){return(t=(t=t.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function b64utob64(t){return t.length%4==2?t+="==":t.length%4==3&&(t+="="),(t=t.replace(/-/g,"+")).replace(/_/g,"/")}function hextob64u(t){return b64tob64u(hex2b64(t))}function b64utohex(t){return b64tohex(b64utob64(t))}function utf8tob64(t){return hex2b64(uricmptohex(encodeURIComponentAll(t)))}function b64toutf8(t){return decodeURIComponent(hextouricmp(b64tohex(t)))}function utf8tohex(t){return uricmptohex(encodeURIComponentAll(t))}function hextoutf8(t){return decodeURIComponent(hextouricmp(t))}function hextorstr(t){for(var e="",i=0;i<t.length-1;i+=2)e+=String.fromCharCode(parseInt(t.substr(i,2),16));return e}function rstrtohex(t){for(var e="",i=0;i<t.length;i++)e+=("0"+t.charCodeAt(i).toString(16)).slice(-2);return e}function hextob64(t){return hex2b64(t)}function hextob64nl(t){return hextob64(t).replace(/(.{64})/g,"$1\r\n").replace(/\r\n$/,"")}function b64nltohex(t){return b64tohex(t.replace(/[^0-9A-Za-z\/+=]*/g,""))}function uricmptohex(t){return t.replace(/%/g,"")}function hextouricmp(t){return t.replace(/(..)/g,"%$1")}function encodeURIComponentAll(t){for(var e=encodeURIComponent(t),i="",r=0;r<e.length;r++)"%"==e[r]?(i+=e.substr(r,3),r+=2):i=i+"%"+stohex(e[r]);return i}function newline_toUnix(t){return t.replace(/\r\n/gm,"\n")}function newline_toDos(t){return(t=t.replace(/\r\n/gm,"\n")).replace(/\n/gm,"\r\n")}var CryptoJS=CryptoJS||function(g){var t={},e=t.lib={},i=e.Base={extend:function(t){p.prototype=this;var e=new p;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),(e.init.prototype=e).$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},u=e.WordArray=i.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||n).stringify(this)},concat:function(t){var e,i,r=this.words,n=t.words,s=this.sigBytes,o=t.sigBytes;if(this.clamp(),s%4)for(i=0;i<o;i++)e=n[i>>>2]>>>24-i%4*8&255,r[s+i>>>2]|=e<<24-(s+i)%4*8;else if(65535<n.length)for(i=0;i<o;i+=4)r[s+i>>>2]=n[i>>>2];else r.push.apply(r,n);return this.sigBytes+=o,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=g.ceil(e/4)},clone:function(){var t=i.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],i=0;i<t;i+=4)e.push(4294967296*g.random()|0);return new u.init(e,t)}}),r=t.enc={},n=r.Hex={stringify:function(t){for(var e,i=t.words,r=t.sigBytes,n=[],s=0;s<r;s++)e=i[s>>>2]>>>24-s%4*8&255,n.push((e>>>4).toString(16)),n.push((15&e).toString(16));return n.join("")},parse:function(t){for(var e=t.length,i=[],r=0;r<e;r+=2)i[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new u.init(i,e/2)}},s=r.Latin1={stringify:function(t){for(var e,i=t.words,r=t.sigBytes,n=[],s=0;s<r;s++)e=i[s>>>2]>>>24-s%4*8&255,n.push(String.fromCharCode(e));return n.join("")},parse:function(t){for(var e=t.length,i=[],r=0;r<e;r++)i[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new u.init(i,e)}},o=r.Utf8={stringify:function(t){try{return decodeURIComponent(escape(s.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return s.parse(unescape(encodeURIComponent(t)))}},h=e.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=o.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e,i,r=this._data,n=r.words,s=r.sigBytes,o=this.blockSize,h=s/(4*o),a=(h=t?g.ceil(h):g.max((0|h)-this._minBufferSize,0))*o,s=g.min(4*a,s);if(a){for(e=0;e<a;e+=o)this._doProcessBlock(n,e);i=n.splice(0,a),r.sigBytes-=s}return new u.init(i,s)},clone:function(){var t=i.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),a=(e.Hasher=h.extend({cfg:i.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(i){return function(t,e){return new i.init(e).finalize(t)}},_createHmacHelper:function(i){return function(t,e){return new a.HMAC.init(i,e).finalize(t)}}}),t.algo={});function p(){}return t}(Math),b64map,b64pad,dbits,canary,j_lm,BI_FP,BI_RM,BI_RC,rr,vv,lowprimes,lplim,SHA1_SIZE,_RE_HEXDECONLY,ASN1HEX,utf8tob64u,b64utoutf8;for(function(){var t=CryptoJS,e=t.lib,i=e.WordArray,r=e.Hasher,e=t.algo,u=[],e=e.SHA1=r.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var i,r=this._hash.words,n=r[0],s=r[1],o=r[2],h=r[3],a=r[4],g=0;g<80;g++)g<16?u[g]=0|t[e+g]:(i=u[g-3]^u[g-8]^u[g-14]^u[g-16],u[g]=i<<1|i>>>31),i=(n<<5|n>>>27)+a+u[g],i+=g<20?1518500249+(s&o|~s&h):g<40?1859775393+(s^o^h):g<60?(s&o|s&h|o&h)-1894007588:(s^o^h)-899497514,a=h,h=o,o=s<<30|s>>>2,s=n,n=i;r[0]=r[0]+n|0,r[1]=r[1]+s|0,r[2]=r[2]+o|0,r[3]=r[3]+h|0,r[4]=r[4]+a|0},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,r=8*t.sigBytes;return e[r>>>5]|=128<<24-r%32,e[14+(64+r>>>9<<4)]=Math.floor(i/4294967296),e[15+(64+r>>>9<<4)]=i,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA1=r._createHelper(e),t.HmacSHA1=r._createHmacHelper(e)}(),function(n){var l,t=CryptoJS,e=t.lib,i=e.WordArray,r=e.Hasher,e=t.algo,s=[],d=[];!function(){function t(t){return 4294967296*(t-(0|t))|0}for(var e=2,i=0;i<64;)!function(t){for(var e=n.sqrt(t),i=2;i<=e;i++)if(!(t%i))return;return 1}(e)||(i<8&&(s[i]=t(n.pow(e,.5))),d[i]=t(n.pow(e,1/3)),i++),e++}(),l=[],e=e.SHA256=r.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(t,e){for(var i=this._hash.words,r=i[0],n=i[1],s=i[2],o=i[3],h=i[4],a=i[5],g=i[6],u=i[7],p=0;p<64;p++){p<16?l[p]=0|t[e+p]:(f=l[p-15],c=l[p-2],l[p]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+l[p-7]+((c<<15|c>>>17)^(c<<13|c>>>19)^c>>>10)+l[p-16]);var f=r&n^r&s^n&s,c=u+((h<<26|h>>>6)^(h<<21|h>>>11)^(h<<7|h>>>25))+(h&a^~h&g)+d[p]+l[p],u=g,g=a,a=h,h=o+c|0,o=s,s=n,n=r,r=c+(((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+f)|0}i[0]=i[0]+r|0,i[1]=i[1]+n|0,i[2]=i[2]+s|0,i[3]=i[3]+o|0,i[4]=i[4]+h|0,i[5]=i[5]+a|0,i[6]=i[6]+g|0,i[7]=i[7]+u|0},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,r=8*t.sigBytes;return e[r>>>5]|=128<<24-r%32,e[14+(64+r>>>9<<4)]=n.floor(i/4294967296),e[15+(64+r>>>9<<4)]=i,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}}),t.SHA256=r._createHelper(e),t.HmacSHA256=r._createHmacHelper(e)}(Math),function(){var t=CryptoJS,e=t.lib,n=e.Base,s=e.WordArray,t=t.x64={};t.Word=n.extend({init:function(t,e){this.high=t,this.low=e}}),t.WordArray=n.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:8*t.length},toX32:function(){for(var t,e=this.words,i=e.length,r=[],n=0;n<i;n++)t=e[n],r.push(t.high),r.push(t.low);return s.create(r,this.sigBytes)},clone:function(){for(var t=n.clone.call(this),e=t.words=this.words.slice(0),i=e.length,r=0;r<i;r++)e[r]=e[r].clone();return t}})}(),function(){function e(){return n.create.apply(n,arguments)}var t=CryptoJS,i=t.lib.Hasher,r=t.x64,n=r.Word,s=r.WordArray,r=t.algo,tt=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],et=[];!function(){for(var t=0;t<80;t++)et[t]=e()}(),r=r.SHA512=i.extend({_doReset:function(){this._hash=new s.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var i=this._hash.words,r=i[0],n=i[1],s=i[2],o=i[3],h=i[4],a=i[5],g=i[6],u=i[7],p=r.high,f=r.low,c=n.high,l=n.low,d=s.high,S=s.low,y=o.high,b=o.low,m=h.high,A=h.low,v=a.high,B=a.low,_=g.high,x=g.low,H=u.high,i=u.low,I=p,R=f,w=c,E=l,T=d,P=S,N=y,D=b,O=m,C=A,M=v,j=B,K=_,L=x,U=H,X=i,V=0;V<80;V++){var F,J,q=et[V];V<16?(J=q.high=0|t[e+2*V],F=q.low=0|t[e+2*V+1]):(k=(Y=et[V-15]).high,Q=Y.low,Z=($=et[V-2]).high,G=$.low,J=(J=(J=((k>>>1|Q<<31)^(k>>>8|Q<<24)^k>>>7)+(W=et[V-7]).high+((F=(z=(Q>>>1|k<<31)^(Q>>>8|k<<24)^(Q>>>7|k<<25))+W.low)>>>0<z>>>0?1:0))+((Z>>>19|G<<13)^(Z<<3|G>>>29)^Z>>>6)+((F=F+(Y=(G>>>19|Z<<13)^(G<<3|Z>>>29)^(G>>>6|Z<<26)))>>>0<Y>>>0?1:0))+($=et[V-16]).high+((F=F+(Q=$.low))>>>0<Q>>>0?1:0),q.high=J,q.low=F);var k=O&M^~O&K,W=C&j^~C&L,z=I&w^I&T^w&T,G=(R>>>28|I<<4)^(R<<30|I>>>2)^(R<<25|I>>>7),Z=tt[V],Y=Z.high,$=Z.low,Q=X+((C>>>14|O<<18)^(C>>>18|O<<14)^(C<<23|O>>>9)),q=U+((O>>>14|C<<18)^(O>>>18|C<<14)^(O<<23|C>>>9))+(Q>>>0<X>>>0?1:0),Z=G+(R&E^R&P^E&P),U=K,X=L,K=M,L=j,M=O,j=C,O=N+(q=(q=(q=q+k+((Q=Q+W)>>>0<W>>>0?1:0))+Y+((Q=Q+$)>>>0<$>>>0?1:0))+J+((Q=Q+F)>>>0<F>>>0?1:0))+((C=D+Q|0)>>>0<D>>>0?1:0)|0,N=T,D=P,T=w,P=E,w=I,E=R,I=q+(((I>>>28|R<<4)^(I<<30|R>>>2)^(I<<25|R>>>7))+z+(Z>>>0<G>>>0?1:0))+((R=Q+Z|0)>>>0<Q>>>0?1:0)|0}f=r.low=f+R,r.high=p+I+(f>>>0<R>>>0?1:0),l=n.low=l+E,n.high=c+w+(l>>>0<E>>>0?1:0),S=s.low=S+P,s.high=d+T+(S>>>0<P>>>0?1:0),b=o.low=b+D,o.high=y+N+(b>>>0<D>>>0?1:0),A=h.low=A+C,h.high=m+O+(A>>>0<C>>>0?1:0),B=a.low=B+j,a.high=v+M+(B>>>0<j>>>0?1:0),x=g.low=x+L,g.high=_+K+(x>>>0<L>>>0?1:0),i=u.low=i+X,u.high=H+U+(i>>>0<X>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,r=8*t.sigBytes;return e[r>>>5]|=128<<24-r%32,e[30+(128+r>>>10<<5)]=Math.floor(i/4294967296),e[31+(128+r>>>10<<5)]=i,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32}),t.SHA512=i._createHelper(r),t.HmacSHA512=i._createHmacHelper(r)}(),b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64pad="=",canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary),dbits=j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,26):(BigInteger.prototype.am=am3,28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits,BI_FP=52,BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP,BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=[],rr="0".charCodeAt(0),vv=0;vv<=9;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo,lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=67108864/lowprimes[lowprimes.length-1],BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,BigInteger.prototype.square=bnSquare,SHA1_SIZE=20,RSAKey.prototype.doPublic=RSADoPublic,RSAKey.prototype.setPublic=RSASetPublic,RSAKey.prototype.encrypt=RSAEncrypt,RSAKey.prototype.encryptOAEP=RSAEncryptOAEP,RSAKey.prototype.type="RSA",SHA1_SIZE=20,RSAKey.prototype.doPrivate=RSADoPrivate,RSAKey.prototype.setPrivate=RSASetPrivate,RSAKey.prototype.setPrivateEx=RSASetPrivateEx,RSAKey.prototype.generate=RSAGenerate,RSAKey.prototype.decrypt=RSADecrypt,RSAKey.prototype.decryptOAEP=RSADecryptOAEP,RSAKey.prototype.readPrivateKeyFromPEMString=_rsapem_readPrivateKeyFromPEMString,RSAKey.prototype.readPrivateKeyFromASN1HexString=_rsapem_readPrivateKeyFromASN1HexString,_RE_HEXDECONLY=new RegExp(""),_RE_HEXDECONLY.compile("[^0-9a-f]","gi"),RSAKey.prototype.signWithMessageHash=_rsasign_signWithMessageHash,RSAKey.prototype.signString=_rsasign_signString,RSAKey.prototype.signStringWithSHA1=_rsasign_signStringWithSHA1,RSAKey.prototype.signStringWithSHA256=_rsasign_signStringWithSHA256,RSAKey.prototype.sign=_rsasign_signString,RSAKey.prototype.signWithSHA1=_rsasign_signStringWithSHA1,RSAKey.prototype.signWithSHA256=_rsasign_signStringWithSHA256,RSAKey.prototype.signWithMessageHashPSS=_rsasign_signWithMessageHashPSS,RSAKey.prototype.signStringPSS=_rsasign_signStringPSS,RSAKey.prototype.signPSS=_rsasign_signStringPSS,RSAKey.SALT_LEN_HLEN=-1,RSAKey.SALT_LEN_MAX=-2,RSAKey.prototype.verifyWithMessageHash=_rsasign_verifyWithMessageHash,RSAKey.prototype.verifyString=_rsasign_verifyString,RSAKey.prototype.verifyHexSignatureForMessage=_rsasign_verifyHexSignatureForMessage,RSAKey.prototype.verify=_rsasign_verifyString,RSAKey.prototype.verifyHexSignatureForByteArrayMessage=_rsasign_verifyHexSignatureForMessage,RSAKey.prototype.verifyWithMessageHashPSS=_rsasign_verifyWithMessageHashPSS,RSAKey.prototype.verifyStringPSS=_rsasign_verifyStringPSS,RSAKey.prototype.verifyPSS=_rsasign_verifyStringPSS,RSAKey.SALT_LEN_RECOVER=-2,ASN1HEX=new function(){this.getByteLengthOfL_AtObj=function(t,e){if("8"!=t.substring(e+2,e+3))return 1;e=parseInt(t.substring(e+3,e+4));return 0==e?-1:0<e&&e<10?e+1:-2},this.getHexOfL_AtObj=function(t,e){var i=this.getByteLengthOfL_AtObj(t,e);return i<1?"":t.substring(e+2,e+2+2*i)},this.getIntOfL_AtObj=function(t,e){e=this.getHexOfL_AtObj(t,e);return""==e?-1:(parseInt(e.substring(0,1))<8?new BigInteger(e,16):new BigInteger(e.substring(2),16)).intValue()},this.getStartPosOfV_AtObj=function(t,e){t=this.getByteLengthOfL_AtObj(t,e);return t<0?t:e+2*(t+1)},this.getHexOfV_AtObj=function(t,e){var i=this.getStartPosOfV_AtObj(t,e),e=this.getIntOfL_AtObj(t,e);return t.substring(i,i+2*e)},this.getHexOfTLV_AtObj=function(t,e){return t.substr(e,2)+this.getHexOfL_AtObj(t,e)+this.getHexOfV_AtObj(t,e)},this.getPosOfNextSibling_AtObj=function(t,e){return this.getStartPosOfV_AtObj(t,e)+2*this.getIntOfL_AtObj(t,e)},this.getPosArrayOfChildren_AtObj=function(t,e){var i,r=[],n=this.getStartPosOfV_AtObj(t,e);r.push(n);for(var s=this.getIntOfL_AtObj(t,e),o=n,h=0;!(null==(i=this.getPosOfNextSibling_AtObj(t,o))||2*s<=i-n)&&!(200<=h);)r.push(i),o=i,h++;return r},this.getNthChildIndex_AtObj=function(t,e,i){return this.getPosArrayOfChildren_AtObj(t,e)[i]},this.getDecendantIndexByNthList=function(t,e,i){if(0==i.length)return e;var r=i.shift(),e=this.getPosArrayOfChildren_AtObj(t,e);return this.getDecendantIndexByNthList(t,e[r],i)},this.getDecendantHexTLVByNthList=function(t,e,i){i=this.getDecendantIndexByNthList(t,e,i);return this.getHexOfTLV_AtObj(t,i)},this.getDecendantHexVByNthList=function(t,e,i){i=this.getDecendantIndexByNthList(t,e,i);return this.getHexOfV_AtObj(t,i)}},ASN1HEX.getVbyList=function(t,e,i,r){i=this.getDecendantIndexByNthList(t,e,i);if(void 0===i)throw"can't find nthList object";if(void 0!==r&&t.substr(i,2)!=r)throw"checking tag doesn't match: "+t.substr(i,2)+"!="+r;return this.getHexOfV_AtObj(t,i)},ASN1HEX.hextooidstr=function(t){function e(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t}var i,r,n,s,o,h=[],a=t.substr(0,2),a=parseInt(a,16);for(h[0]=new String(Math.floor(a/40)),h[1]=new String(a%40),i=t.substr(2),r=[],o=0;o<i.length/2;o++)r.push(parseInt(i.substr(2*o,2),16));for(n=[],s="",o=0;o<r.length;o++)128&r[o]?s+=e((127&r[o]).toString(2),7):(s+=e((127&r[o]).toString(2),7),n.push(new String(parseInt(s,2))),s="");return h=h.join("."),h=0<n.length?h+"."+n.join("."):h},X509.pemToBase64=function(t){return t.replace("-----BEGIN CERTIFICATE-----","").replace("-----END CERTIFICATE-----","").replace(/[ \n]+/g,"")},X509.pemToHex=function(t){return b64tohex(X509.pemToBase64(t))},X509.getSubjectPublicKeyPosFromCertHex=function(t){var e=X509.getSubjectPublicKeyInfoPosFromCertHex(t);return-1==e?-1:2!=(e=ASN1HEX.getPosArrayOfChildren_AtObj(t,e)).length?-1:(e=e[1],"03"!=t.substring(e,e+2)?-1:(e=ASN1HEX.getStartPosOfV_AtObj(t,e),"00"!=t.substring(e,e+2)?-1:e+2))},X509.getSubjectPublicKeyInfoPosFromCertHex=function(t){var e=ASN1HEX.getStartPosOfV_AtObj(t,0),e=ASN1HEX.getPosArrayOfChildren_AtObj(t,e);return e.length<1?-1:"a003020102"==t.substring(e[0],e[0]+10)?e.length<6?-1:e[6]:e.length<5?-1:e[5]},X509.getPublicKeyHexArrayFromCertHex=function(t){var e=X509.getSubjectPublicKeyPosFromCertHex(t),i=ASN1HEX.getPosArrayOfChildren_AtObj(t,e);return 2!=i.length?[]:(e=ASN1HEX.getHexOfV_AtObj(t,i[0]),i=ASN1HEX.getHexOfV_AtObj(t,i[1]),null!=e&&null!=i?[e,i]:[])},X509.getHexTbsCertificateFromCert=function(t){return ASN1HEX.getStartPosOfV_AtObj(t,0)},X509.getPublicKeyHexArrayFromCertPEM=function(t){t=X509.pemToHex(t);return X509.getPublicKeyHexArrayFromCertHex(t)},X509.hex2dn=function(t){for(var e,i="",r=ASN1HEX.getPosArrayOfChildren_AtObj(t,0),n=0;n<r.length;n++)e=ASN1HEX.getHexOfTLV_AtObj(t,r[n]),i=i+"/"+X509.hex2rdn(e);return i},X509.hex2rdn=function(e){var i=ASN1HEX.getDecendantHexTLVByNthList(e,0,[0,0]),t=ASN1HEX.getDecendantHexVByNthList(e,0,[0,1]),e="";try{e=X509.DN_ATTRHEX[i]}catch(t){e=i}return t=t.replace(/(..)/g,"%$1"),e+"="+decodeURIComponent(t)},X509.DN_ATTRHEX={"0603550406":"C","060355040a":"O","060355040b":"OU","0603550403":"CN","0603550405":"SN","0603550408":"ST","0603550407":"L"},X509.getPublicKeyFromCertPEM=function(t){var e=X509.getPublicKeyInfoPropOfCertPEM(t);if("2a864886f70d010101"==e.algoid)return r=KEYUTIL.parsePublicRawRSAKeyHex(e.keyhex),(i=new RSAKey).setPublic(r.n,r.e),i;if("2a8648ce3d0201"==e.algoid)return n=KJUR.crypto.OID.oidhex2name[e.algparam],(i=new KJUR.crypto.ECDSA({curve:n,info:e.keyhex})).setPublicKeyHex(e.keyhex),i;if("2a8648ce380401"!=e.algoid)throw"unsupported key";var i,t=ASN1HEX.getVbyList(e.algparam,0,[0],"02"),r=ASN1HEX.getVbyList(e.algparam,0,[1],"02"),n=ASN1HEX.getVbyList(e.algparam,0,[2],"02"),e=(e=ASN1HEX.getHexOfV_AtObj(e.keyhex,0)).substr(2);return(i=new KJUR.crypto.DSA).setPublic(new BigInteger(t,16),new BigInteger(r,16),new BigInteger(n,16),new BigInteger(e,16)),i},X509.getPublicKeyInfoPropOfCertPEM=function(t){var e={algparam:null},i=X509.pemToHex(t),r=ASN1HEX.getPosArrayOfChildren_AtObj(i,0);if(3!=r.length)throw"malformed X.509 certificate PEM (code:001)";if("30"!=i.substr(r[0],2))throw"malformed X.509 certificate PEM (code:002)";if((t=ASN1HEX.getPosArrayOfChildren_AtObj(i,r[0])).length<7)throw"malformed X.509 certificate PEM (code:003)";if(2!=(r=ASN1HEX.getPosArrayOfChildren_AtObj(i,t[6])).length)throw"malformed X.509 certificate PEM (code:004)";if(2!=(t=ASN1HEX.getPosArrayOfChildren_AtObj(i,r[0])).length)throw"malformed X.509 certificate PEM (code:005)";if(e.algoid=ASN1HEX.getHexOfV_AtObj(i,t[0]),"06"==i.substr(t[1],2)?e.algparam=ASN1HEX.getHexOfV_AtObj(i,t[1]):"30"==i.substr(t[1],2)&&(e.algparam=ASN1HEX.getHexOfTLV_AtObj(i,t[1])),"03"!=i.substr(r[1],2))throw"malformed X.509 certificate PEM (code:006)";return r=ASN1HEX.getHexOfV_AtObj(i,r[1]),e.keyhex=r.substr(2),e},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),void 0!==KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:"CryptoJS.algo.MD5",sha1:"CryptoJS.algo.SHA1",sha224:"CryptoJS.algo.SHA224",sha256:"CryptoJS.algo.SHA256",sha384:"CryptoJS.algo.SHA384",sha512:"CryptoJS.algo.SHA512",ripemd160:"CryptoJS.algo.RIPEMD160"},this.getDigestInfoHex=function(t,e){if(void 0===this.DIGESTINFOHEAD[e])throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+t},this.getPaddedDigestInfoHex=function(t,e,i){var r=this.getDigestInfoHex(t,e),t=i/4;if(r.length+22>t)throw"key is too short for SigAlg: keylen="+i+","+e;for(var r="00"+r,n="",s=t-"0001".length-r.length,o=0;o<s;o+=2)n+="ff";return"0001"+n+r},this.hashString=function(t,e){return new KJUR.crypto.MessageDigest({alg:e}).digestString(t)},this.hashHex=function(t,e){return new KJUR.crypto.MessageDigest({alg:e}).digestHex(t)},this.sha1=function(t){return new KJUR.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"}).digestString(t)},this.sha256=function(t){return new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestString(t)},this.sha256Hex=function(t){return new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestHex(t)},this.sha512=function(t){return new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestString(t)},this.sha512Hex=function(t){return new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestHex(t)},this.md5=function(t){return new KJUR.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(t)},this.ripemd160=function(t){return new KJUR.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(t)},this.getCryptoJSMDByName=function(){}},KJUR.crypto.MessageDigest=function(n){this.setAlgAndProvider=function(alg,prov){if(null!=alg&&void 0===prov&&(prov=KJUR.crypto.Util.DEFAULTPROVIDER[alg]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(alg)&&"cryptojs"==prov){try{this.md=eval(KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[alg]).create()}catch(ex){throw"setAlgAndProvider hash alg set fail alg="+alg+"/"+ex}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){t=CryptoJS.enc.Hex.parse(t);this.md.update(t)},this.digest=function(){return this.md.finalize().toString(CryptoJS.enc.Hex)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}if(-1!=":sha256:".indexOf(alg)&&"sjcl"==prov){try{this.md=new sjcl.hash.sha256}catch(ex){throw"setAlgAndProvider hash alg set fail alg="+alg+"/"+ex}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){t=sjcl.codec.hex.toBits(t);this.md.update(t)},this.digest=function(){var t=this.md.finalize();return sjcl.codec.hex.fromBits(t)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}},this.updateString=function(){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==n&&void 0!==n.alg&&(this.algName=n.alg,void 0===n.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},KJUR.crypto.Mac=function(n){this.setAlgAndProvider=function(alg,prov){var hashAlg,mdObj;if(null==alg&&(alg="hmacsha1"),alg=alg.toLowerCase(),"hmac"!=alg.substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+alg;if(void 0===prov&&(prov=KJUR.crypto.Util.DEFAULTPROVIDER[alg]),this.algProv=alg+"/"+prov,hashAlg=alg.substr(4),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(hashAlg)&&"cryptojs"==prov){try{mdObj=eval(KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[hashAlg]),this.mac=CryptoJS.algo.HMAC.create(mdObj,this.pass)}catch(ex){throw"setAlgAndProvider hash alg set fail hashAlg="+hashAlg+"/"+ex}this.updateString=function(t){this.mac.update(t)},this.updateHex=function(t){t=CryptoJS.enc.Hex.parse(t);this.mac.update(t)},this.doFinal=function(){return this.mac.finalize().toString(CryptoJS.enc.Hex)},this.doFinalString=function(t){return this.updateString(t),this.doFinal()},this.doFinalHex=function(t){return this.updateHex(t),this.doFinal()}}},this.updateString=function(){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},void 0!==n&&(void 0!==n.pass&&(this.pass=n.pass),void 0!==n.alg&&(this.algName=n.alg,void 0===n.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},KJUR.crypto.Signature=function(t){var e=null;if(this._setAlgNames=function(){this.algName.match(/^(.+)with(.+)$/)&&(this.mdAlgName=RegExp.$1.toLowerCase(),this.pubkeyAlgName=RegExp.$2.toLowerCase())},this._zeroPaddingOfSignature=function(t,e){for(var i="",r=e/4-t.length,n=0;n<r;n++)i+="0";return i+t},this.setAlgAndProvider=function(t,e){if(this._setAlgNames(),"cryptojs/jsrsa"!=e)throw"provider not supported: "+e;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+t}this.init=function(t,e){var i=null;try{i=void 0===e?KEYUTIL.getKey(t):KEYUTIL.getKey(t,e)}catch(t){throw"init failed:"+t}if(!0===i.isPrivate)this.prvKey=i,this.state="SIGN";else{if(!0!==i.isPublic)throw"init failed.:"+i;this.pubKey=i,this.state="VERIFY"}},this.initSign=function(t){"string"==typeof t.ecprvhex&&"string"==typeof t.eccurvename?(this.ecprvhex=t.ecprvhex,this.eccurvename=t.eccurvename):this.prvKey=t,this.state="SIGN"},this.initVerifyByPublicKey=function(t){"string"==typeof t.ecpubhex&&"string"==typeof t.eccurvename?(this.ecpubhex=t.ecpubhex,this.eccurvename=t.eccurvename):(t instanceof KJUR.crypto.ECDSA||t instanceof RSAKey)&&(this.pubKey=t),this.state="VERIFY"},this.initVerifyByCertificatePEM=function(t){var e=new X509;e.readCertPEM(t),this.pubKey=e.subjectPublicKeyRSA,this.state="VERIFY"},this.updateString=function(t){this.md.updateString(t)},this.updateHex=function(t){this.md.updateHex(t)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0!==this.ecprvhex&&void 0!==this.eccurvename){var t=new KJUR.crypto.ECDSA({curve:this.eccurvename});this.hSign=t.signHex(this.sHashHex,this.ecprvhex)}else if("rsaandmgf1"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if("rsa"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof KJUR.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof KJUR.crypto.DSA))throw"Signature: unsupported public key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(t){return this.updateString(t),this.sign()},this.signHex=function(t){return this.updateHex(t),this.sign()},this.verify=function(t){if(this.sHashHex=this.md.digest(),void 0!==this.ecpubhex&&void 0!==this.eccurvename)return new KJUR.crypto.ECDSA({curve:this.eccurvename}).verifyHex(this.sHashHex,t,this.ecpubhex);if("rsaandmgf1"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,t,this.mdAlgName,this.pssSaltLen);if("rsa"==this.pubkeyAlgName||this.pubKey instanceof KJUR.crypto.ECDSA||this.pubKey instanceof KJUR.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.initVerifyByPublicKey=function(){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName},this.initVerifyByCertificatePEM=function(){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName},this.initSign=function(){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName},this.updateString=function(){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},void 0!==(this.initParams=t)&&(void 0!==t.alg&&(this.algName=t.alg,this.provName=void 0===t.prov?KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]:t.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==t.psssaltlen&&(this.pssSaltLen=t.psssaltlen),void 0!==t.prvkeypem)){if(void 0!==t.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{(e=new RSAKey).readPrivateKeyFromPEMString(t.prvkeypem),this.initSign(e)}catch(t){throw"fatal error to load pem private key: "+t}}},KJUR.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},b64utoutf8="function"==typeof Buffer?(utf8tob64u=function(t){return b64tob64u(new Buffer(t,"utf8").toString("base64"))},function(t){return new Buffer(b64utob64(t),"base64").toString("utf8")}):(utf8tob64u=function(t){return hextob64u(uricmptohex(encodeURIComponentAll(t)))},function(t){return decodeURIComponent(hextouricmp(b64utohex(t)))});
