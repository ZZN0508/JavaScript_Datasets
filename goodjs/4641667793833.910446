(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"+/OB":function(t,e,i){i("ax0f")({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}})},5878:function(t,e,i){i("ax0f")({target:"Function",proto:!0},{bind:i("zh11")})},"HT/6":function(t,e,i){"use strict";i.d(e,"b",function(){return n}),i.d(e,"a",function(){return a}),i("yH/f");var n=Object.freeze({INITIAL:"initial",AUTO_PAUSED:"autoPaused",USER_PAUSED:"userPaused",AUTO_PLAYING:"autoPlaying",USER_PLAYING:"userPlaying",FINISHED:"finished"}),a=Object.freeze({DOCKABLE:2,NORMAL:1,SPACE:-1})},"W/Kd":function(t,e,i){var n=i("695J");t.exports=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,n(t,e)},t.exports.default=t.exports,t.exports.__esModule=!0},XmKV:function(t,e,i){"use strict";i.d(e,"b",function(){return a}),i.d(e,"a",function(){return s}),i("6U7i"),i("LW0h");var n=i("HT/6"),a=function(t){var e,i;return function(t,e){if(0!==t.length){for(var i=t[0],n=e(i),a=1;a<t.length;a++){var s=t[a],o=e(s);o<n&&(i=s,n=o)}return i}}(t,0===(null==t||null===(e=t[0])||void 0===e||null===(i=e.placement)||void 0===i?void 0:i.scrollY())?function(t){return t.placement?t.placement.distanceToTop():Number.MAX_VALUE}:function(t){return t.placement?t.placement.distanceToCenter():Number.MAX_VALUE})},s=function(t){var e=t.filter(function(t){return t.playbackPriority===n.a.DOCKABLE});return e.length?e[0]:a(t)}},Xq8B:function(t,e,i){"use strict";i("1t7P"),i("jQ/y"),i("aLgo"),i("hBpG"),i("jwue"),i("hCOa"),i("vrRf"),i("plBw"),i("lTEL"),i("z84I"),i("KOtZ"),i("M+/F"),i("+/OB"),i("cARO"),i("5878"),i("ho0z"),i("6U7i"),i("ssvU"),i("kH1Z"),i("IAdD"),i("+KXO"),i("7x/C"),i("JtPf"),i("KqXw"),i("DZ+c"),i("87if"),i("+oxZ"),i("kYxP"),i("sVFb");var n=i("1Pcy"),o=i.n(n),a=i("W/Kd"),r=i.n(a),s=i("KEM+"),c=i.n(s),l=i("r2q8"),u=i.n(l);function d(t,e){var i;if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator])return(i=t[Symbol.iterator]()).next.bind(i);if(Array.isArray(t)||(i=function(t){if(t){if("string"==typeof t)return h(t,void 0);var e=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(e="Object"===e&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?h(t,void 0):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var p="AD_SKIP_EVENT",v="CAPTIONS_TOGGLED_EVENT",y="CONFIG_LOADED_EVENT",_="CTA_CLICK_EVENT",m="CTA_IMPRESSION_EVENT",f="ERROR_EVENT",g="FULL_SCREEN_EVENT",b="GROUPM_VIEW_EVENT",T="HEARTBEAT_EVENT",E="HEARTBEAT_START_EVENT",P="INITIAL_CTA_IMPRESSION_EVENT",M="INITIAL_INTEND_TO_PLAY_EVENT",w="INTEND_TO_PLAY_EVENT",k="LOOP_EVENT",S="MRC_AUDIBLE_VIEW_EVENT",I="MRC_VIEW_EVENT",A="MUTE_EVENT",C="ONE_SEC_VIEW_EVENT",L="SIX_SEC_VIEW_EVENT",V="SHORT_FORM_COMPLETE_EVENT",N="PAUSE_EVENT",O="PLAY_EVENT",W="PLAY_FROM_TAP_EVENT",n="PLAYBACK_25_EVENT",a="PLAYBACK_50_EVENT",s="PLAYBACK_75_EVENT",i="PLAYBACK_95_EVENT",D="PLAYBACK_COMPLETE_EVENT",F="PLAYBACK_ERROR_EVENT",x="PLAYBACK_LAPSE_EVENT",B="PLAYBACK_START_EVENT",R="REPLAY_EVENT",H="REWIND_EVENT",U="SHRINK_EVENT",K="STARTUP_ERROR_EVENT",Y="TEARDOWN_EVENT",j="TICK_EVENT",G="TRACK_FINISHED_EVENT",z="UNMUTE_EVENT",q="VIDEO_SESSION_EVENT",X="VIDEO_QUALITY_VIEW_EVENT",J="VIDEO_VIEW_EVENT",Z="VIEW_THRESHOLD_EVENT",Q="content",$="broadcast",tt="gif",et="live",it="media_entity",nt="partner_video",at="periscope",st="vine",ot="vmap",rt={event:"url",go_to:"url",image:"url",url:"url",shop:"url",see_more:"url",visit:"url",visit_site:"url",watch:"url",watch_now:"watch"};function ct(t){return ut(t,t.source.trackId)}function lt(t){return ut(t,t.currentTrackId)}function ut(t,e){return t.tracks.find(function(t){return e===t.id})}function dt(t){return t.tracks.find(function(t){return"ad"===t.displayType})}function ht(t){return Boolean(t)&&t.isPlaying&&!t.isScrubbing&&!t.isMuted}var pt=((l={})[J]="creativeView",l[n]="firstQuartile",l[a]="midpoint",l[s]="thirdQuartile",l[D]="complete",l[O]="resume",l[N]="pause",l[H]="rewind",l[f]="adError",l),vt=((l=Pt.prototype).onPlaybackStart=function(t){this.fireBeacon("start",t),this.fireBeacon("adImpression",t)},l.fireBeacon=function(t,e){e=lt(e);if(void 0!==e&&void 0!==e.beacons&&void 0!==e.beacons[t])for(var i=d(e.beacons[t]);!(n=i()).done;){var n=n.value;(new window.Image).src=n}},Pt),yt=(Et.prototype.onTickEvent=function(t){var e=t.areCaptionsShown,i=this.currentCaptionsState;i!==e&&((!1===i&&!0===e||!0===i&&!1===e)&&this.analytics.emit(v,t,e),this.currentCaptionsState=e)},Et),_t=(Tt.prototype.onCtaImpressionEvent=function(t){var e=t.currentTrackId;this.hasFiredOnTrackMap[e]||(this.hasFiredOnTrackMap[e]=!0,this.analytics.emit(P,t))},Tt),mt=((l=bt.prototype).onPlaybackStartEvent=function(){this.hasStarted=!0},l.onShowEvent=function(){this.intentToPlayTime=new Date},l.onErrorEvent=function(t,e){var i,n,a=this.constructClientMediaEventError(t,e);this.hasStarted||this.hasFired||(n=void 0!==this.intentToPlayTime?new Date-this.intentToPlayTime:void 0,a&&(i={latency_millis:n,error:a}),this.analytics.emit(K,t,Object.assign({latency:n},e),i),this.hasFired=!0),this.analytics.emit(F,t,e,a)},l.constructClientMediaEventError=function(t,e){e=e&&e.media_details&&e.media_details.media_error||{};return{is_fatal:e.is_fatal,category:e.category,message:e.message,retry_count:e.retry_count}},bt),ft=((l=gt.prototype).onHeartbeat=function(t){this.reset(t)},l.onHeartbeatStart=function(t){this.reset(t)},l.onTickEvent=function(t){t=lt(t);void 0!==t&&(t.isBuffering&&null==this.bufferingBeginTimeMs?(this.bufferingBeginTimeMs=Date.now(),this.bufferingCount++):t.isBuffering||null==this.bufferingBeginTimeMs||(this.bufferingDurationMs+=Date.now()-this.bufferingBeginTimeMs,this.bufferingBeginTimeMs=void 0))},l.getBufferTime=function(t){var e=lt(t);if(void 0!==e){t=this.bufferingDurationMs;return e.isBuffering&&null!=this.bufferingBeginTimeMs&&(t+=Date.now()-this.bufferingBeginTimeMs),t}},l.reset=function(t){t=lt(t);void 0!==t&&(this.bufferingBeginTimeMs=t.isBuffering?Date.now():void 0,this.bufferingCount=t.isBuffering?1:0,this.bufferingDurationMs=0)},gt);function gt(t){this.bufferingCount=0,this.bufferingDurationMs=0,this.bufferingBeginTimeMs=void 0,t.on(j,this.onTickEvent.bind(this)),t.on(E,this.onHeartbeatStart.bind(this)),t.on(T,this.onHeartbeat.bind(this))}function bt(t){this.analytics=t,this.hasStarted=!1,this.hasFired=!1,this.analytics.on(B,this.onPlaybackStartEvent.bind(this)),this.analytics.on(w,this.onShowEvent.bind(this)),this.analytics.on(f,this.onErrorEvent.bind(this))}function Tt(t){this.analytics=t,this.hasFiredOnTrackMap={},this.analytics.on(m,this.onCtaImpressionEvent.bind(this))}function Et(t){this.analytics=t,this.analytics.on(j,this.onTickEvent.bind(this))}function Pt(t){var i=this;Object.keys(pt).forEach(function(e){t.on(e,function(t){i.fireBeacon(pt[e],t)})}),t.on(B,this.onPlaybackStart.bind(this))}function Mt(t){return"number"!=typeof t||Number.isNaN(t)||t===1/0||t===-1/0?"string"==typeof t?t:void 0:t.toString()}var wt=((l=kt.prototype).onTickEvent=function(t){var e,i=lt(t);void 0!==i&&(this.updateTimesOnTick(i,t),this.updatePerfMetrics(i),t.isScrubbing?this.stopPolling():t.isPlaying&&this.startPolling(t),void 0!==this.lastKnownPlayerState&&(e=this.lastKnownPlayerState.percentVisible,i=t.percentVisible,(0<e&&0===i||0===e&&0<i)&&(this.stopPolling(),this.startPolling(t))),this.lastKnownPlayerState=t,this.previousTickTimestamp=Date.now())},l.onPlayEvent=function(t){this.hasPlaybackStarted&&this.startPolling(t),this.lastKnownPlayerState=t},l.onPlaybackStartEvent=function(t){this.startPolling(t),this.lastKnownPlayerState=t,this.hasPlaybackStarted=!0},l.onTrackFinishedEvent=function(t){this.hasPlaybackStarted=!1,void 0!==lt(t)&&(this.stopPolling(),this.lastKnownPlayerState=t)},l.onErrorEvent=function(t,e){e&&e.media_details&&e.media_details.media_error&&e.media_details.media_error.is_fatal&&(this.stopPolling(),this.lastKnownPlayerState=t)},l.onPauseEvent=function(t,e){this.stopPolling(),this.lastKnownPlayerState=t},l.onTeardownEvent=function(t,e){this.stopPolling(!0),this.lastKnownPlayerState=t},l.onLoopEvent=function(t){this.startPolling(t)},l.onAdSkip=function(){this.stopPolling()},l.updateTimesOnTick=function(t,e){void 0!==(t=t.contentType===$||t.contentType===et||t.contentType===at?t.absoluteTimeMs:t.currentTimeMs)&&(ht(e)&&void 0!==this.lastTimeMs&&(this.audibleDuration+=t-this.lastTimeMs),this.lastTimeMs=t,void 0===this.startTimeMs&&(this.startTimeMs=t))},l.startPolling=function(t){var e=ct(t);void 0===this.intervalId&&void 0!==e&&e.contentType!==st&&(this.analytics.emit(E,t),this.onHeartbeatStart(t))},l.stopPolling=function(t){(this.intervalId||t)&&(this.onHeartbeat(),this.lastTimeMs=void 0,this.startTimeMs=void 0),void 0!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0)},l.onHeartbeatStart=function(t){this.intervalId=setInterval(this.onHeartbeat.bind(this),t.heartbeatIntervalMs||5e3),this.lastTimeMs=void 0,this.startTimeMs=void 0,this.bitrateHistory=[],this.latencyHistory=[]},l.updatePerfMetrics=function(t){var e;this.previousTickTimestamp&&(e=Date.now()-this.previousTickTimestamp,t.currentBitrate&&this.bitrateHistory.push({value:t.currentBitrate,weight:e}),t.liveLatencyMs&&this.latencyHistory.push({value:t.liveLatencyMs,weight:e}))},l.onHeartbeat=function(){var t,e,i,n,a,s,o,r=this.lastKnownPlayerState;r&&(o=lt(r),void 0!==(t=this.getProgramDateTimeMs())&&void 0!==o&&(s=o.currentBitrate?{sampled_bitrate:o.currentBitrate}:{},a=0,r.dataUsageBytes&&(a=r.dataUsageBytes-this.lastKnownDataUsageBytes,this.lastKnownDataUsageBytes=r.dataUsageBytes),e={data_usage_bytes:a},i=this.bufferingDurationListener.bufferingCount,n=this.bufferingDurationListener.getBufferTime(r),a=Math.floor(100*r.percentVisible),s=Object.assign({buffering_duration_millis:n,video_visibility:a},{start_program_date_time_millis:t.start_program_date_time_millis,end_program_date_time_millis:t.end_program_date_time_millis},s,e),o={buffering_duration_millis:Mt(n),buffering_count:i,percent_in_view:a,sampled_bits_per_second:o.currentBitrate,data_usage_bytes:Mt(e.data_usage_bytes),start_program_date_time_millis:Mt(t.start_program_date_time_millis),end_program_date_time_millis:Mt(t.end_program_date_time_millis),audible_duration_millis:Mt(t.audible_duration_millis),bandwidth_estimate_bps:Mt(r.bandwidthEstimateBps),bitrate_metrics:(t=St(this.bitrateHistory))&&{min_bps:Math.round(t.min),max_bps:Math.round(t.max),avg_bps:Math.round(t.avg)},live_or_non_live_heartbeat_metrics:function(t,e){e=St(e);return t?{live_heartbeat_metrics:{latency_metrics:e&&{min_ms:Math.round(e.min),max_ms:Math.round(e.max),avg_ms:Math.round(e.avg)}}}:{non_live_heartbeat_metrics:{}}}(o.isLive,this.latencyHistory)},this.analytics.emit(T,r,s,o)))},l.getProgramDateTimeMs=function(){if(void 0===this.startTimeMs||void 0===this.lastTimeMs)return{};var t=this.startTimeMs,e=this.lastTimeMs,i=this.audibleDuration;return this.startTimeMs=this.lastTimeMs,this.audibleDuration=0,{start_program_date_time_millis:Math.round(t),end_program_date_time_millis:Math.round(e),audible_duration_millis:Math.round(i)}},kt);function kt(t){this.analytics=t,this.bufferingDurationListener=new ft(t),this.lastKnownDataUsageBytes=0,this.audibleDuration=0,this.bitrateHistory=[],this.latencyHistory=[],this.previousTickTimestamp,this.analytics.on(j,this.onTickEvent.bind(this)),this.analytics.on(O,this.onPlayEvent.bind(this)),this.analytics.on(B,this.onPlaybackStartEvent.bind(this)),this.analytics.on(G,this.onTrackFinishedEvent.bind(this)),this.analytics.on(f,this.onErrorEvent.bind(this)),this.analytics.on(N,this.onPauseEvent.bind(this)),this.analytics.on(Y,this.onTeardownEvent.bind(this)),this.analytics.on(k,this.onLoopEvent.bind(this)),this.analytics.on(p,this.onAdSkip.bind(this))}function St(t){if(t&&t.length){var e=function(t){if(!t||0===t.length)return[Math.min(),Math.max()];for(var e=1/0,i=-1/0,n=d(t);!(a=n()).done;)var a=a.value,e=Math.min(e,a),i=Math.max(i,a);return[e,i]}(t.map(function(t){return t.value}));return{min:e[0],max:e[1],avg:(t=(e=t).reduce(function(t,e){return t+e.weight},0),e.reduce(function(t,e){return t+e.value*e.weight},0)/t)}}}function It(t){return"/api/v2/"+t}var At=((l=Nt.prototype).onIntendToPlayEvent=function(t){this.hasFiredOnTrackMap[t.currentTrackId]||(this.hasFiredOnTrackMap[t.currentTrackId]=!0,this.analytics.emit(M,t))},l.onTrackFinishedEvent=function(t){var e=lt(t);e&&(e.shouldLoop||(this.hasFiredOnTrackMap[t.currentTrackId]=!1))},Nt),Ct=(Vt.prototype.onTrackFinishedEvent=function(t){var e=lt(t);void 0!==e&&e.shouldLoop&&this.analytics.emit(k,t)},Vt),Lt={home:"HomeTimeline",list:"Lists",live_broadcast:"BroadcastPage",live_event_timeline:"EventPage",me:"UserTimeline",moments:"Moments",permalink:"TweetCard",profile:"UserTimeline",search:"Search"};function Vt(t){this.analytics=t,this.analytics.on(G,this.onTrackFinishedEvent.bind(this))}function Nt(t){this.analytics=t,this.hasFiredOnTrackMap={},this.analytics.on(w,this.onIntendToPlayEvent.bind(this)),this.analytics.on(R,this.onIntendToPlayEvent.bind(this)),this.analytics.on(G,this.onTrackFinishedEvent.bind(this))}function Ot(t,e,i,n){return{start:{method:t,path:It(e)},ping:{method:t,path:It(i)},stop:{method:t,path:It(n)}}}var Wt,Dt={public:{live:Ot("GET","startPublic","pingPublic","stopPublic"),replay:Ot("GET","replayViewedPublic","pingReplayViewedPublic","endReplayViewedPublic")},auth:{live:Ot("POST","startWatching","pingWatching","stopWatching"),replay:Ot("POST","replayViewed","pingReplayViewed","endReplayViewed")}},Ft=((l=xt.prototype).getPageContext=function(t){var e=t.page;return"permalink_overlay"===t.section?"TweetCard":Lt[e]||""},l.call=function(t,e){var i=Date.now(),n={"X-Idempotence":Wt=i<=Wt?Wt+1:i,"X-Attempt":1,"X-Periscope-User-Agent":"Twitter/video-analytics","content-type":"application/json"},a=Object.assign({},e);this.authToken&&(a.cookie=this.authToken);i=t.method,e=t.path,t={};return"POST"===i?t.data=a:t.params=a,this.httpClient.dispatch(Object.assign({headers:n,host:"https://proxsee.pscp.tv",method:i,path:e},t))},l.videoStartWatching=function(a,s,o){var r=this;return new Promise(function(e,i){("string"!=typeof a||a.length<1)&&i(new Error("Cannot videoStartWatching. lifecycleToken not valid, lifecycleToken="+a));var t=(s?r.lifecycles.replay:r.lifecycles.live).start,n={life_cycle_token:a,auto_play:!!o};r.pageContext&&(n.page=r.pageContext),r.componentContext&&(n.component=r.componentContext),r.call(t,n).then(function(t){t=JSON.parse(t.body).session;t?e(t):i("No valid Session")},i)})},l.videoPingWatching=function(n,a){var s=this;return new Promise(function(e,i){("string"!=typeof n||n.length<1)&&i(new Error("Cannot videoPingWatching. session not valid, session="+n));var t=(a?s.lifecycles.replay:s.lifecycles.live).ping;s.call(t,{session:n}).then(function(t){JSON.parse(t.body).success?e():i("Ping request failed")},i)})},l.videoStopWatching=function(n,a){var s=this;return new Promise(function(e,i){("string"!=typeof n||n.length<1)&&i(new Error("Cannot videoStopWatching. session not valid, session="+n));var t=(a?s.lifecycles.replay:s.lifecycles.live).stop;s.call(t,{session:n}).then(function(t){JSON.parse(t.body).success?e():i("StopWatching request failed")},i)})},xt);function xt(t,e){this.httpClient=t,this.authToken=null==e?void 0:e.periscopeAuthToken,this.lifecycles=this.authToken?Dt.auth:Dt.public,null!=e&&e.scribeContext&&null!=e&&e.periscopeComponent&&(t=e.scribeContext,e=e.periscopeComponent,this.pageContext=this.getPageContext(t),this.componentContext=e)}function Bt(t){return(t=new Error("Unable to map CTA type to engagement type for: "+t)).name="AD_CTA_TO_ENGAGEMENT_MAPPING_ERROR",t}var Rt=((l=qt.prototype).updateSession=function(t){this.session=t},l.setStartWatchingTimer=function(){this.startWatchingTimer=setTimeout(this.handleStartWatching,3e3)},l.clearStartWatchingTimer=function(){this.startWatchingTimer&&clearTimeout(this.startWatchingTimer)},l.handleStartWatching=function(){if(!this.isWatching){this.stopPingWatching();var t=this.api.videoStartWatching(this.lifecycleToken,this.isReplay,this.isVideoPreview).then(this.updateSession).then(this.startPingWatching);return this.isWatching=!0,t}},l.startPingWatching=function(){var t=this;this.stopPingWatching(),this.pingWatchingTimer=setInterval(function(){t.isWatching?t.api.videoPingWatching(t.session,t.isReplay):t.stopPingWatching()},3e4)},l.stopPingWatching=function(){clearInterval(this.pingWatchingTimer)},l.updateLifecycleToken=function(t){void 0!==t&&t!==this.lifecycleToken&&(this.lifecycleToken=t,this.isWatching&&(this.stopWatching(),this.handleStartWatching()))},l.updateIsReplay=function(t){void 0!==t&&t!==this.isReplay&&(this.isReplay=t)},l.startWatching=function(){return this.isVideoPreview=!1,this.handleStartWatching()},l.startWatchingPreview=function(){this.isVideoPreview=!0,this.clearStartWatchingTimer(),this.setStartWatchingTimer()},l.stopWatching=function(){this.isWatching&&(this.stopPingWatching(),this.session&&this.api.videoStopWatching(this.session,this.isReplay),this.isWatching=!1)},l.destroy=function(){this.stopWatching(),this.clearStartWatchingTimer(),this.isVideoPreview=void 0,this.lifecycleToken=void 0,this.session=void 0,this.isReplay=void 0,this.isWatching=void 0,this.pingWatchingTimer=void 0},qt),Ht=[y,O,N,G,Y],Ut=((l=zt.prototype).possiblyHandleEvent=function(t,e){if(this.shouldSendPeriscopeAnalytics(e)){var i=lt(e);switch(t){case y:this.updateLifecycleToken(e),this.updateReplayState(!i.isLive);break;case O:this.handleStartWatching(e);break;case N:this.handleStopWatching(e);break;case G:this.handleStopWatching(e),this.updateReplayState(!0);break;case Y:this.teardownPeriscopeLifecycle()}}},l.shouldSendPeriscopeAnalytics=function(t){t=lt(t);return void 0!==t&&(t.contentType===at||t.contentType===$)},l.getLifecycleToken=function(t){return lt(t).lifecycleToken},l.updateLifecycleToken=function(t){t=this.getLifecycleToken(t);this.lifecycleController.updateLifecycleToken(t)},l.updateReplayState=function(t){this.lifecycleController.updateIsReplay(t)},l.handleStartWatching=function(t){this.getLifecycleToken(t)&&(t.isPreview?this.lifecycleController.startWatchingPreview():this.lifecycleController.startWatching())},l.handleStopWatching=function(t){this.getLifecycleToken(t)&&this.lifecycleController.stopWatching()},l.teardownPeriscopeLifecycle=function(){this.lifecycleController.destroy(),this.lifecycleController=null},zt),Kt=((l=Gt.prototype).onTrackFinishedEvent=function(t){var e,i,n=lt(t);void 0===n||void 0!==(e=this.lapseMap[n.id])&&(e.timePlayedToMs=0,(i=ct(t))&&i.contentType!==tt&&!n.shouldLoop&&(this.emit(e,t),e.viewFired=!1))},l.onAdSkipEvent=function(t){this.onTickEvent(t);var e=lt(t);void 0!==e&&(e=this.lapseMap[e.id],this.emit(e,t))},l.onVideoViewEvent=function(t){var e=lt(t);void 0!==e&&(void 0===(t=this.lapseMap[e.id])&&(t=this.initializeLapseMapForTrack(e),this.lapseMap[e.id]=t),t.viewFired=!0)},l.onTickEvent=function(t){var e,i=lt(t);void 0!==i&&(void 0===(e=this.lapseMap[i.id])&&(e=this.initializeLapseMapForTrack(i),this.lapseMap[i.id]=e),t.isScrubbing?e.timePlayedToMs=i.currentTimeMs:(this.updateTimingData(i,e),this.checkPlaybackLapse(e,t)))},l.initializeLapseMapForTrack=function(t){return{timePlayedMs:0,timePlayedToMs:t.currentTimeMs,viewFired:!1}},l.updateTimingData=function(t,e){var i=t.currentTimeMs-e.timePlayedToMs;e.timePlayedToMs=t.currentTimeMs,e.timePlayedMs+=i},l.checkPlaybackLapse=function(t,e){1e4<t.timePlayedMs&&this.emit(t,e)},l.emit=function(t,e){var i=ct(e),n=t.viewFired,a=t.timePlayedMs;n&&0<a&&i&&i.contentType!==et&&(this.analytics.emit(x,e,{playback_lapse_ms:Math.round(a)}),t.timePlayedMs=0)},Gt),Yt=(jt.set=function(t){jt.report=t},jt);function jt(){}function Gt(t){this.analytics=t,this.lapseMap={},this.analytics.on(j,this.onTickEvent.bind(this)),this.analytics.on(G,this.onTrackFinishedEvent.bind(this)),this.analytics.on(p,this.onAdSkipEvent.bind(this)),this.analytics.on(J,this.onVideoViewEvent.bind(this))}function zt(t,e){var i=this;this.analytics=t,this.lifecycleController=e,Ht.map(function(t){return i.analytics.on(t,i.possiblyHandleEvent.bind(i,t))})}function qt(t){this.api=t,this.handleStartWatching=this.handleStartWatching.bind(this),this.updateSession=this.updateSession.bind(this),this.startPingWatching=this.startPingWatching.bind(this),this.isVideoPreview=!1,this.isReplay=!0}c()(Yt,"report",function(t){});var Xt=((c={})[B]="playback_start",c[n]="playback_25",c[a]="playback_50",c[s]="playback_75",c[i]="playback_95",c[D]="playback_complete",c[I]="mrc_view",c[b]="groupm_view",c[C]="1sec_view",c[L]="6sec_view",c[V]="short_form_complete",c[J]="view",c[W]="play_from_tap",c[Z]="view_threshold",c),Jt=((c=oe.prototype).buildEventName=function(t,e){t=Xt[t];return"video_"+e.displayType+"_"+t},c.log=function(t,e,i,n){void 0===i&&(i={});var a=lt(e),s=this.getPromotedEventData(e,a);void 0!==s.impression_id&&(a=this.getAmplifyDetailsData(e,a,i),i=JSON.stringify({amplify_details:a}),n=n&&JSON.stringify(n),n=Object.assign(s,a,{event:t,card_event:i,engagement_metadata:n}),this.promotedLogHandler.log(n))},c.logImpression=function(t){var e=lt(t);this.isPromotedTrack(t,e)&&this.log("impression",t)},c.onCtaClickEvent=function(t){var e=lt(t),i=null==e?void 0:e.cta,n=rt[null==i?void 0:i.type];if(!n)return Yt.report(Bt(null==i?void 0:i.type));"ad"===e.displayType?this.log("video_"+e.displayType+"_cta_"+n+"_click",t):this.log("video_cta_"+n+"_click",t)},c.onVideoSessionEvent=function(t,e){void 0!==e&&this.log("video_session",t,{},e)},c.isPromotedTrack=function(t,e){return e&&e.impressionId&&e.disclosureType},c.getPromotedEventData=function(t,e){var i=e.disclosureType||t.disclosureType;return{impression_id:e.impressionId||t.impressionId,earned:"earned"===i}},c.getAmplifyDetailsData=function(t,e,i){var n=ct(t),a=dt(t)||{};return Object.assign({content_id:n.contentId,dynamic_preroll_type:a.dynamicPrerollType,preroll_uuid:a.contentId,preroll_owner_id:a.publisherId,video_uuid:e.contentId,video_type:e.displayType===Q?"video":"ad",video_is_muted:t.isMuted,video_visibility:Math.floor(100*t.percentVisible)},i)},oe),Zt=(se.prototype.onTickEvent=function(t){var e=lt(t);void 0!==e&&(t.isScrubbing&&void 0===this.scrubbingStartTime?this.scrubbingStartTime=e.currentTimeMs:t.isScrubbing||void 0===this.scrubbingStartTime||(e.currentTimeMs<this.scrubbingStartTime&&this.analytics.emit(H,t),this.scrubbingStartTime=void 0))},se),Qt=((c={})[J]="video_view",c[W]="play_from_tap",c[Z]="view_threshold",c[S]="video_mrc_audible_view",c[I]="video_mrc_view",c[L]="video_6sec_view",c[V]="video_short_form_complete",c[B]="playback_start",c[n]="playback_25",c[a]="playback_50",c[s]="playback_75",c[i]="playback_95",c[D]="playback_complete",c[M]="intent_to_play",c[O]="play",c[N]="pause",c[R]="replay",c[k]="loop",c[A]="mute",c[z]="unmute",c[g]="full_screen",c[U]="shrink",c[x]="playback_lapse",c[F]="error",c[K]="playback_startup_error",c[X]="video_quality_view",c[p]="video_ad_skip",c),$t=["playback_lapse","video_1sec_view","shrink","full_screen"].reduce(function(t,e){return t[e]=!0,t},{}),te="client_event",ee=["appplayer","poll2choice_video","poll3choice_video","poll4choice_video","promo_video_convo","promo_video_website","video_direct_message"],ie=/^([0-9]{1,2})_([0-9]+)$/,ne=((c=ae.prototype).onCaptionsToggledEvent=function(t,e){e=e?"enable":"disable";this.scribe(e,t,{},{},te,{page:"settings",section:"captions",element:"display_audio_transcriptions",action:e})},c.onCtaClickEvent=function(t){var e=lt(t).cta,i=rt[null==e?void 0:e.type];if(!i)return Yt.report(Bt(null==e?void 0:e.type));this.scribe("cta_"+i+"_click",t)},c.onCtaImpressionEvent=function(t){var e=lt(t).cta,i=rt[null==e?void 0:e.type];if(!i)return Yt.report(Bt(null==e?void 0:e.type));this.scribe("cta_"+i+"_impression",t)},c.onHeartbeatEvent=function(t,e,i){var n,a=ct(t);if(void 0!==a){switch(a.contentType){case et:case $:n="live_video_heartbeat_event";break;default:n=te}this.scribe("heartbeat",t,e,i,n)}},c.scribe=function(t,e,i,n,a,s){void 0===i&&(i={}),void 0===n&&(n={}),void 0===a&&(a=te),void 0===s&&(s=null);var o,r,c=ct(e)||{},l=lt(e)||{},u=dt(e)||{},d=e.session||{},h=(e.features||{}).isLiveTimecodeEnabled&&0<l.requestedTimecode?1e3*l.requestedTimecode:void 0;this.isActionSupportedInClientMediaEvent(t)&&(r={media_client_event_type:((o={})[t]=n,o),session_state:{session_id:d.id,content_video_identifier:(r=this.getContentIdentifier(c),re(this.context.scribeContext)?{scrubbed_identifier:{}}:r),video_ads_passthrough_data:e.videoAnalyticsScribePassthrough,live_event_identifier:this.getLiveEventIdentifier(e,c.contentType),tweet_id:this.getTweetId(e.source,c.contentType)},playing_media_state:{video_type:l.displayType===Q?2:1,media_asset_url:this.getVariantUrl(l),media_timecode_millis:Mt(h),media_metadata:{broadcast_id:l.broadcastId,twitter_publisher_id:Mt(l.publisherId),publisher_identifier:(o=l.publisherId,r=l.periscopePublisherId,re(this.context.scribeContext)?{scrubbed_publisher_identifier:{}}:o&&r?{twitter_periscope_publisher_identifier:{twitter_id:Mt(o),periscope_id:r}}:o?{twitter_publisher_identifier:{id:Mt(o)}}:r?{periscope_publisher_identifier:{id:r}}:{unknown_publisher_identifier:{}})},broadcast_media_state:function(t,e){if(t===$||t===et||t===at)return{broadcast_state:e?1:2}}(l.contentType,l.isLive)},player_state:{is_muted:e.isMuted}});e=Object.assign({},this.getBaseItem(e.source,e.eventId),{media_asset_url:this.getVariantUrl(l),video_uuid:l.contentId,video_owner_id:l.publisherId,video_type:l.displayType===Q?"video":"ad",promoted_id:l.impressionId||e.impressionId,content_id:c.contentId,dynamic_preroll_type:u.dynamicPrerollType,preroll_uuid:u.contentId,preroll_owner_id:u.publisherId,publisher_id:c.publisherId,media_session_id:d.id,video_analytics_scribe_passthrough:e.videoAnalyticsScribePassthrough,client_media_event:r,media_timecode_millis:h,disclosure_type:l.disclosureType||e.disclosureType},i,this.getLexMetadata(e,c)),t=s||{element:this.getScribeElement(c),action:t};this.scribeHandler.log({namespace:t,category:a,data:{items:[e]}})},c.getContentIdentifier=function(t){var e=t.contentId,i=this.parseMediaKeyString(e);if(i)return{media_platform_identifier:i};switch(t.contentType){case it:case tt:case et:case $:return this.getMediaPlatformIdentifierUsingDefaultCategory(t);case ot:return this.isAdFormatsCard?{media_platform_identifier:{media_category:this.getMediaEntityCategoryUsingPlaybackUrl(t),media_id:e}}:{amplify_card_identifier:{vmap_url:t.vmapUrl,content_id:e}};default:return{unknown_identifier:{content_id:e}}}},c.parseMediaKeyString=function(t){var e=ie.exec(t)||[],t=e[1],e=e[2],t=+t;if(t&&e)return{media_category:t,media_id:e}},c.getMediaPlatformIdentifierUsingDefaultCategory=function(t){var e=this.defaultMediaCategory(t);return e?{media_platform_identifier:{media_category:e,media_id:t.contentId}}:{unknown_identifier:{content_id:t.contentId}}},c.getMediaEntityCategoryUsingPlaybackUrl=function(t){t=this.getVariantUrl(t);if(t)return-1!==t.indexOf("amplify_video")?13:-1!==t.indexOf("ext_tw_video")?7:void 0},c.defaultMediaCategory=function(t){switch(t.contentType){case tt:return 16;case et:return 26;case $:return 28;case it:return this.getMediaEntityCategoryUsingPlaybackUrl(t);default:return}},c.getLiveEventIdentifier=function(t,e){return t.eventId?{lex_event_identifier:{lex_event_id:t.eventId}}:e===et?{legacy_live_event_identifier:{legacy_live_event_id:t.source.id}}:void 0},c.getTweetId=function(t,e){return e===$||e===et?t.tweetId:"tweet"===t.type?t.id:void 0},c.getScribeElement=function(t){switch(t.contentType){case st:return"vine_player";case tt:return"gif_player";case ot:return"platform_amplify_card";case et:case $:return"live_video_player";case nt:return"partner_video_player";case at:return"periscope_player";default:return"video_player"}},c.getBaseItem=function(t,e){return this.context.baseScribeItem||("tweet"===t.type?{id:t.id,item_type:"0"}:t.tweetId?{id:t.tweetId,item_type:"0"}:e?{id:e,item_type:"28"}:void 0)},c.getLexMetadata=function(t,e){var i=this.context.scribeContext||{},n={},a={};return e.broadcastId&&(n.is_replay_broadcast=!e.isLive,a.tweet_id=t.source.tweetId,"live_event_timeline"===i.page&&"tweet"!==i.component?n.host_broadcast_id=e.broadcastId:n.target_broadcast_id=e.broadcastId),t.eventId&&("live_event_timeline"===i.page&&"tweet"!==i.component?a.host_event_id=t.eventId:a.target_event_id=t.eventId),{live_broadcast_details:n,live_video_event_details:a}},c.getVariantUrl=function(t){t=t.variants&&t.variants[t.currentVariantIndex];return t&&t.src},c.isActionSupportedInClientMediaEvent=function(t){return!$t[t]},ae);function ae(t,e,i){var a=this;this.scribeHandler=e,this.context=i||{},this.isAdFormatsCard=-1!==ee.indexOf(this.context.cardType),Object.keys(Qt).forEach(function(n){t.on(n,function(t,e,i){a.scribe(Qt[n],t,e,i)})}),t.on(_,this.onCtaClickEvent.bind(this)),t.on(P,this.onCtaImpressionEvent.bind(this)),t.on(T,this.onHeartbeatEvent.bind(this)),t.on(v,this.onCaptionsToggledEvent.bind(this))}function se(t){this.analytics=t,this.analytics.on(j,this.onTickEvent.bind(this))}function oe(t,e){var a=this;this.promotedLogHandler=e,Object.keys(Xt).forEach(function(n){t.on(n,function(t,e){var i=lt(t);void 0!==i&&a.log(a.buildEventName(n,i),t,e)})}),t.on(B,this.logImpression.bind(this)),t.on(_,this.onCtaClickEvent.bind(this)),t.on(q,this.onVideoSessionEvent.bind(this))}function re(t){return t&&"messages"===t.page}var ce=((c=be.prototype).onInitialIntendToPlayEvent=function(t){this.resetLatencyStartDate(t.intentToPlayTime)},c.onReplayEvent=function(){this.resetLatencyStartDate()},c.onTrackFinishedEvent=function(t){this.resetLatencyStartDate(),this.trackId!==t.currentTrackId&&(this.trackId=t.currentTrackId)},c.resetLatencyStartDate=function(t){this.latencyStartDate=t||new Date},c.getLatencyData=function(){if(void 0!==this.latencyStartDate)return{latency:new Date-this.latencyStartDate}},be),le=[{progress:.25,event:n},{progress:.5,event:a},{progress:.75,event:s},{progress:.95,event:i},{progress:1,event:D}],ue=((i=ge.prototype).onTrackFinishedEvent=function(t){var e=lt(t);void 0!==e&&(e.shouldLoop||(this.eventMap[t.currentTrackId]={}))},i.onTickEvent=function(t){var e,i=lt(t);void 0!==i&&i.durationMs&&(void 0===(e=this.eventMap[i.id])&&(this.eventMap[i.id]=e={}),this.checkAllTentpoles(i,e,t))},i.checkAllTentpoles=function(t,e,i){var n,a,s,o;i.isPlaying&&(n=t.durationMs,a=t.currentTimeMs,o={latency_millis:(s=this.playbackLatencyListener.getLatencyData()||{}).latency,cache_info:{notCached:{}}},this.emitOnce(B,e,i,s,o),t.isLive||this.checkProgressTentpoles(n,a,e,i))},i.checkProgressTentpoles=function(i,n,a,s){var o=this;le.forEach(function(t){var e=t.progress*i;e-1e3<=n&&n<=1e3+e&&o.emitOnce(t.event,a,s)})},i.emitOnce=function(t,e,i,n,a){e[t]||(this.analytics.emit(t,i,n,a),e[t]=!0)},ge),de=[0,5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100],he=((i={})[st]=2,i.gif=3,i[ot]=1,i[it]=1,i[et]=1,i[at]=5,i[$]=1,i),pe=((i=fe.prototype).onTickEvent=function(t){var e,i=lt(t);void 0!==i&&(e=this.getOrCreateNewSessionDataForTrack(i,t),t.isScrubbing?e.currentTimeMs=i.currentTimeMs:this.updateViewData(i,e,t))},i.onFullscreenEvent=function(t){var e=lt(t);void 0!==e&&(this.getOrCreateNewSessionDataForTrack(e,t).isFullscreenMode=!0)},i.onShrinkEvent=function(t){var e=lt(t);void 0!==e&&(this.getOrCreateNewSessionDataForTrack(e,t).isFullscreenMode=!1)},i.onTrackFinishedEvent=function(t){var e,i=lt(t);void 0===i||void 0!==(e=this.sessionDataStore[i.id])&&(i.shouldLoop?e.currentTimeMs=0:(0<e.timeWatchedMs&&(e=this.constructVideoSessionDetails(e,i),this.emitVideoSessionEvent(t,e)),this.sessionDataStore[i.id]=void 0))},i.onTrackInterrupt=function(t){var e,i=lt(t);void 0===i||void 0!==(e=this.sessionDataStore[i.id])&&(0<e.timeWatchedMs&&(e=this.constructVideoSessionDetails(e,i),this.emitVideoSessionEvent(t,e)),this.sessionDataStore[i.id]=void 0)},i.getOrCreateNewSessionDataForTrack=function(t,e){var i=this.sessionDataStore[t.id];return void 0===i&&(i={sizesInfoAtTheStart:e.sizesInfo,currentTimeMs:t.currentTimeMs,isFullscreenMode:!1,timeWatchedMs:0,timeWatchedFullscreenMs:0,timeWatchedWithAudioMs:0,timeWatchedFullscreenWithAudioMs:0,watchedMsByInViewPct:this.generateNewAggregateHistogram(),watchedWithAudioMsByInViewPct:this.generateNewAggregateHistogram(),watchedMsByViewportPct:this.generateNewAggregateHistogram(),maxContinuousWatchedMsByInViewPct:this.generateNewMaxContinuousHistogram(),maxContinuousWatchedWithAudioMsByInViewPct:this.generateNewMaxContinuousHistogram()},this.sessionDataStore[t.id]=i),i},i.generateNewAggregateHistogram=function(){for(var t,e={},i=d(de);!(t=i()).done;)e[t.value]=0;return e},i.generateNewMaxContinuousHistogram=function(){for(var t,e={},i=d(de);!(t=i()).done;)e[t.value]={current:0,max:0};return e},i.resetContinuousViewDataForHistogram=function(t){for(var e=d(de);!(i=e()).done;){var i=i.value;this.resetContinuousViewDataForBucket(t[i])}},i.resetContinuousViewDataForBucket=function(t){t.max=Math.max(t.current,t.max),t.current=0},i.updateViewData=function(t,e,i){var n=t.currentTimeMs-e.currentTimeMs,a=e.isFullscreenMode?1:i.percentVisible,s=e.isFullscreenMode?1:i.percentOfViewportOccupied;e.currentTimeMs=t.currentTimeMs,n<0||(e.timeWatchedMs+=n,this.updateAggregateHistogram(e.watchedMsByInViewPct,a,n),this.updateAggregateHistogram(e.watchedMsByViewportPct,s,n),this.updateMaxContinuousHistogram(e.maxContinuousWatchedMsByInViewPct,a,n),i.isMuted?this.resetContinuousViewDataForHistogram(e.maxContinuousWatchedWithAudioMsByInViewPct):(e.timeWatchedWithAudioMs+=n,this.updateAggregateHistogram(e.watchedWithAudioMsByInViewPct,a,n),this.updateMaxContinuousHistogram(e.maxContinuousWatchedWithAudioMsByInViewPct,a,n)),e.isFullscreenMode&&(e.timeWatchedFullscreenMs+=n,i.isMuted||(e.timeWatchedFullscreenWithAudioMs+=n)))},i.updateAggregateHistogram=function(t,e,i){if(0!==e)for(var n=100*e,a=d(de);!(s=a()).done;){var s=s.value;s<=n&&(t[s]+=i)}},i.updateMaxContinuousHistogram=function(t,e,i){if(0!==e)for(var n=100*e,a=d(de);!(s=a()).done;){var s=s.value;s<=n?t[s].current+=i:0<t[s].current&&this.resetContinuousViewDataForBucket(t[s])}else this.resetContinuousViewDataForHistogram(t)},i.constructVideoSessionDetails=function(t,e){return{video_details:{is_preroll_video:"ad"===e.displayType,video_length:Math.round(e.durationMs),time_watched:Math.round(t.timeWatchedMs),time_watched_fullscreen:Math.round(t.timeWatchedFullscreenMs),time_watched_with_audio:Math.round(t.timeWatchedWithAudioMs),time_watched_fullscreen_with_audio:Math.round(t.timeWatchedFullscreenWithAudioMs),time_watched_100_with_audio:Math.round(t.watchedWithAudioMsByInViewPct[100]),video_type:he[e.contentType],watched_ms_by_in_view_pct:this.constructAggregateHistogramPayload(t.watchedMsByInViewPct),watched_with_audio_ms_by_in_view_pct:this.constructAggregateHistogramPayload(t.watchedWithAudioMsByInViewPct),watched_ms_by_viewport_pct:this.constructAggregateHistogramPayload(t.watchedMsByViewportPct),max_continuous_watched_ms_by_in_view_pct:this.constructMaxContinuousHistogramPayload(t.maxContinuousWatchedMsByInViewPct),max_continuous_watched_with_audio_ms_by_in_view_pct:this.constructMaxContinuousHistogramPayload(t.maxContinuousWatchedWithAudioMsByInViewPct),sizes_info_at_the_start:{viewport_size:t.sizesInfoAtTheStart.viewportSize,ad_size:t.sizesInfoAtTheStart.mediaSize}}}},i.constructAggregateHistogramPayload=function(t){for(var e={},i=d(de);!(n=i()).done;){var n=n.value;e[n]=Math.round(t[n])}return{histogram:e}},i.constructMaxContinuousHistogramPayload=function(t){for(var e={},i=d(de);!(a=i()).done;){var n=a.value,a=t[n];e[n]=Math.round(Math.max(a.current,a.max))}return{histogram:e}},i.emitVideoSessionEvent=function(t,e){this.analytics.emit(q,t,e)},fe),ve=[J,W,Z,C,b,S,I,X,L,V],ye=[C,S,I,X],_e=((i=me.prototype).onTrackFinishedEvent=function(t){var e=lt(t);void 0===e||void 0!==(t=this.eventMap[e.id])&&(e.shouldLoop?t.timePlayedToMs=0:this.eventMap[e.id]=void 0)},i.onPlaybackComplete=function(t){var e=lt(t);void 0===e||void 0!==(e=this.eventMap[e.id])&&this.context&&this.context.enableShortFormCompleteLogging&&this.emitOnce(V,e,t)},i.onPauseEvent=function(t){this.resetContinuousViewEventTimingData(t)},i.onTickEvent=function(t){var e=lt(t);if(void 0!==e){if(void 0===(n=this.eventMap[e.id])){for(var i,n={timePlayedToMs:e.currentTimeMs},a=d(ve);!(i=a()).done;)n[i.value]={timePlayedMs:0,visibilityWeightedTimePlayedMs:0,fired:!1};this.eventMap[e.id]=n}t.isScrubbing?(n.timePlayedToMs=e.currentTimeMs,this.resetContinuousViewEventTimingData(t)):(this.updateTimingData(e,n,t),this.checkViewEvents(e,n,t)),this.checkPlayFromTap(n,t)}},i.updateTimingData=function(t,e,i){var n=t.currentTimeMs-e.timePlayedToMs;e.timePlayedToMs=t.currentTimeMs;t=i.percentVisible;1<=t&&(e[Z].timePlayedMs+=n),1<=t?e[C].timePlayedMs+=n:e[C].timePlayedMs=0,.5<=t&&ht(i)?e[S].timePlayedMs+=n:e[S].timePlayedMs=0,.5<=t?e[I].timePlayedMs+=n:e[I].timePlayedMs=0,1<=t&&!i.isMuted&&(e[b].timePlayedMs+=n),.5<=t?e[X].timePlayedMs+=n:e[X].timePlayedMs=0,e[L].timePlayedMs+=n,.5<=t&&(e[L].visibilityWeightedTimePlayedMs+=t*n),e[V].timePlayedMs+=n},i.resetContinuousViewEventTimingData=function(t){var e=this.eventMap[t.currentTrackId];if(void 0!==e)for(var i,n=d(ye);!(i=n()).done;)e[i.value].timePlayedMs=0},i.checkViewEvents=function(t,e,i){e[Z].timePlayedMs>=(!t.isLive&&0<t.durationMs&&!t.shouldLoop?Math.min(t.durationMs-500,3e3):3e3)&&(this.emitOnce(Z,e,i),this.emitOnce(J,e,i)),1e3<=e[C].timePlayedMs&&this.emitOnce(C,e,i),e[b].timePlayedMs>=(!t.isLive&&0<t.durationMs?.5*t.durationMs:Number.MAX_SAFE_INTEGER)&&this.emitOnce(b,e,i),2e3<=e[S].timePlayedMs&&this.emitOnce(S,e,i),2e3<=e[I].timePlayedMs&&this.emitOnce(I,e,i),e[X].timePlayedMs>=(!t.isLive&&0<t.durationMs?Math.min(.95*t.durationMs,1e4):1e4)&&this.emitOnce(X,e,i);var n=e[L];n.timePlayedMs>=(!t.isLive&&0<t.durationMs?Math.min(.95*t.durationMs,6e3):6e3)&&n.visibilityWeightedTimePlayedMs>=(!t.isLive&&0<t.durationMs?Math.min(.5*t.durationMs,3e3):3e3)&&this.emitOnce(L,e,i),this.context&&this.context.enableShortFormCompleteLogging&&15e3<=e[V].timePlayedMs&&this.emitOnce(V,e,i)},i.checkPlayFromTap=function(t,e){e.isPlaying&&!e.isPreview&&(this.emitOnce(W,t,e),this.emitOnce(J,t,e))},i.emitOnce=function(t,e,i){e[t].fired||(this.analytics.emit(t,i),e[t].fired=!0)},me),u=function(s){function t(t,e,i,n){var a;(a=s.call(this)||this).scribeListener=new ne(o()(a),t,n),a.promotedLogListener=new Jt(o()(a),e),a.tentpoleListener=new ue(o()(a)),a.viewListener=new _e(o()(a),n),a.playbackLapseListener=new Kt(o()(a)),a.errorListener=new mt(o()(a)),a.beaconListener=new vt(o()(a)),a.rewindListener=new Zt(o()(a)),a.heartbeatListener=new wt(o()(a)),a.loopListener=new Ct(o()(a)),a.intendToPlayListener=new At(o()(a)),a.videoSessionListener=new pe(o()(a)),a.ctaImpressionListener=new _t(o()(a)),a.captionsListener=new yt(o()(a));n=new Ft(i,n),n=new Rt(n);return a.lifecycleListener=new Ut(o()(a),n),a}r()(t,s);var e=t.prototype;return e.onTickEvent=function(t){this.emit(j,t)},e.onReplay=function(t){var e=lt(t);void 0!==e&&(e.shouldLoop||this.emit(R,t))},e.onTrackFinished=function(t){this.emit(G,t)},e.onIntendToPlay=function(t){this.emit(w,t)},e.onPlay=function(t){this.emit(O,t)},e.onPause=function(t){this.emit(N,t)},e.onMute=function(t){this.emit(A,t)},e.onUnmute=function(t){this.emit(z,t)},e.onFullScreen=function(t){this.emit(g,t)},e.onShrink=function(t){this.emit(U,t)},e.onAdSkip=function(t){this.emit(p,t)},e.onCtaImpression=function(t){this.emit(m,t)},e.onCtaClick=function(t){this.emit(_,t)},e.onConfigLoaded=function(t){this.emit(y,t)},e.onError=function(t,e){this.emit(f,t,e)},e.onTeardown=function(t){this.emit(Y,t)},t}(u.a);function me(t,e){this.analytics=t,this.context=e,this.eventMap={},this.analytics.on(j,this.onTickEvent.bind(this)),this.analytics.on(G,this.onTrackFinishedEvent.bind(this)),this.analytics.on(N,this.onPauseEvent.bind(this)),this.analytics.on(D,this.onPlaybackComplete.bind(this))}function fe(t){this.analytics=t,this.sessionDataStore={},this.analytics.on(j,this.onTickEvent.bind(this)),this.analytics.on(g,this.onFullscreenEvent.bind(this)),this.analytics.on(U,this.onShrinkEvent.bind(this)),this.analytics.on(G,this.onTrackFinishedEvent.bind(this)),this.analytics.on(p,this.onTrackInterrupt.bind(this)),this.analytics.on(Y,this.onTrackInterrupt.bind(this))}function ge(t){this.analytics=t,this.eventMap={},this.playbackLatencyListener=new ce(t),this.analytics.on(G,this.onTrackFinishedEvent.bind(this)),this.analytics.on(j,this.onTickEvent.bind(this))}function be(t){this.analytics=t,this.analytics.on(R,this.onReplayEvent.bind(this)),this.analytics.on(G,this.onTrackFinishedEvent.bind(this)),this.analytics.on(M,this.onInitialIntendToPlayEvent.bind(this))}e.a=u},cARO:function(t,e,i){var n=i("uLp7"),i=Date.prototype,a="Invalid Date",s=i.toString,o=i.getTime;new Date(NaN)+""!=a&&n(i,"toString",function(){var t=o.call(this);return t==t?s.call(this):a})},jHwr:function(t,e,i){"use strict";e.a=function(t,e){function i(){n=null,t()}var n=null;return function(){return n=n||e(i)}}},mf9H:function(t,e,i){"use strict";i.d(e,"a",function(){return d}),i.d(e,"b",function(){return p}),i.d(e,"c",function(){return v});var n=i("VrFO"),a=i.n(n),e=i("Y9Ll"),n=i.n(e),e=i("KEM+"),s=i.n(e),o=(i("hBpG"),i("jwue"),i("+oxZ"),i("vrRf"),i("Ee2X"),i("LW0h"),i("6U7i"),i("6/RC")),e=i("XmKV"),l=i("HT/6"),r=i("jHwr"),c=i("+d3d"),u=i("fs1G"),d=.25,h={autoplayPrioritizationPolicy:e.a,minimumVisibilityForAutoplay:d},p=(n()(y,[{key:"register",value:function(t){var e=this,i=t.canAutoplay,n=t.onAutoPlayRequest,a=t.onFullscreenEntered,s=t.onFullscreenExited,o=t.onPauseRequest,r=t.isLooping,t=t.playbackPriority,c={placement:void 0,playbackPriority:void 0===t?l.a.NORMAL:t,playbackState:l.b.INITIAL,previousPlaybackState:l.b.INITIAL,commandHandlers:{onAutoPlayRequest:n,onFullscreenEntered:a,onFullscreenExited:s,onPauseRequest:o},canAutoplay:i,isLooping:r};return this._players.push(c),{reset:function(){return e._handleReset(c)},signalFullscreenChange:function(t){return e._handleFullscreenChanged(t)},signalPlacementChange:function(t){return e._handlePlacementChange(c,t)},signalPlay:function(){return e._handlePlay(c)},signalPause:function(){return e._handlePause(c)},signalPlaybackFinish:function(){return e._handlePlaybackFinished(c)},unregister:function(){return e._handleUnregister(c)}}}},{key:"_handleFullscreenChanged",value:function(i){this._players.forEach(function(t){var e=t.commandHandlers,t=e.onFullscreenEntered,e=e.onFullscreenExited;i&&t?t():!i&&e&&e()})}},{key:"_handlePlacementChange",value:function(t,e){var i=e.scrollY();t.placement=e,this._scrollY!==i&&(this._scrollY=i),t.playbackState===l.b.FINISHED&&0===e.visibleFraction()&&this._setPlayerState(t,l.b.INITIAL),this._scheduleUpdate()}},{key:"_handlePlay",value:function(t){t.playbackState!==l.b.AUTO_PLAYING&&(t.previousPlaybackState===l.b.AUTO_PLAYING&&t.isLooping?this._setPlayerState(t,l.b.AUTO_PLAYING):this._setPlayerState(t,l.b.USER_PLAYING)),this._stopAllExcept(t)}},{key:"_handlePause",value:function(t){t.playbackState!==l.b.AUTO_PAUSED&&this._setPlayerState(t,l.b.USER_PAUSED)}},{key:"_handlePlaybackFinished",value:function(t){this._setPlayerState(t,l.b.FINISHED)}},{key:"_handleReset",value:function(t){this._setPlayerState(t,l.b.INITIAL),this._scheduleUpdate()}},{key:"_handleUnregister",value:function(t){t=this._players.indexOf(t);0<=t&&this._players.splice(t,1),this._scheduleUpdate()}},{key:"_triggerAutoplay",value:function(){var e=this,t=this._players.filter(function(t){return e._canAutoPlay(t)}),t=this._findBestAutoplayFit(t);t?(this._stopAllExcept(t),this._autoPlayVideo(t)):this._players.forEach(function(t){t.playbackState===l.b.AUTO_PLAYING&&e._pausePlayer(t)})}},{key:"_canAutoPlay",value:function(t){var e=!!t.placement&&t.placement.visibleFraction()>=this._minimumVisibilityForAutoplay,i=t.playbackState===l.b.USER_PAUSED,n=t.playbackState===l.b.FINISHED;return t.canAutoplay&&e&&!i&&!n}},{key:"_canPlay",value:function(t){var e=!!t.placement&&t.placement.visibleFraction()>=this._minimumVisibilityForAutoplay,i=!!t.placement&&0<t.placement.visibleFraction();return!t.placement||i||e}},{key:"_stopAllExcept",value:function(e){var i=this;this._players.forEach(function(t){t===e||t.playbackState!==l.b.USER_PLAYING&&t.playbackState!==l.b.AUTO_PLAYING||i._pausePlayer(t)})}},{key:"_pausePlayer",value:function(t){var e=t.commandHandlers.onPauseRequest;this._setPlayerState(t,l.b.AUTO_PAUSED),e()}},{key:"_autoPlayVideo",value:function(t){var e=t.commandHandlers.onAutoPlayRequest;this._setPlayerState(t,l.b.AUTO_PLAYING),e()}},{key:"_findBestAutoplayFit",value:function(t){return this._autoplayPrioritizationPolicy(t)}},{key:"_getDistanceToCenter",value:function(t){return t.placement?t.placement.distanceToCenter():Number.MAX_VALUE}},{key:"_getDistanceToTop",value:function(t){return t.placement?t.placement.distanceToTop():Number.MAX_VALUE}}]),y),v=new p;function y(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:h;a()(this,y),s()(this,"_players",[]),s()(this,"_setPlayerState",function(t,e){t.previousPlaybackState=t.playbackState,t.playbackState=e}),s()(this,"_updatePlaybackStates",function(){var t=e._players.find(function(t){return t.playbackState===l.b.USER_PLAYING&&t.playbackPriority!==l.a.SPACE});t&&!e._canPlay(t)?(e._pausePlayer(t),e._triggerAutoplay()):t?e._stopAllExcept(t):e._triggerAutoplay()}),s()(this,"_scheduleUpdate",o.canUseDOM?Object(c.a)(Object(r.a)(this._updatePlaybackStates,window.requestIdleCallback?function(t){return window.requestIdleCallback(t,{timeout:200})}:window.requestAnimationFrame),300,{leading:!1,trailing:!0}):u.a);var i=t.autoplayPrioritizationPolicy,t=t.minimumVisibilityForAutoplay;this._autoplayPrioritizationPolicy=i,this._minimumVisibilityForAutoplay=t}},sVFb:function(t,e,i){var n=i("ax0f"),a=i("9JhN"),s=i("ZORK"),o=[].slice,i=function(a){return function(t,e){var i=2<arguments.length,n=i?o.call(arguments,2):void 0;return a(i?function(){("function"==typeof t?t:Function(t)).apply(this,n)}:t,e)}};n({global:!0,bind:!0,forced:/MSIE .\./.test(s)},{setTimeout:i(a.setTimeout),setInterval:i(a.setInterval)})},ssvU:function(t,e,i){i("ax0f")({target:"Number",stat:!0},{isNaN:function(t){return t!=t}})}}]);
