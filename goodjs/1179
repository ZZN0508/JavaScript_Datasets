!function(d,_){function g(){var n={},e=new s(function(e,t){n.resolve=e,n.reject=t});return n.promise=e,n}function i(e,t){for(var n in t)void 0===e[n]&&(e[n]=t[n]);return e}function l(e){var t,n=[];for(t in e)e[t]&&n.push(t+"="+encodeURIComponent(e[t]));return n.join("&")}function p(e){function a(e,t){return e<<t|e>>>32-t}function p(e,t){var n=2147483648&e,o=2147483648&t,i=1073741824&e,r=1073741824&t,t=(1073741823&e)+(1073741823&t);return i&r?2147483648^t^n^o:i|r?1073741824&t?3221225472^t^n^o:1073741824^t^n^o:t^n^o}function t(e,t,n,o,i,r,s){return e=p(e,p(p(t&n|~t&o,i),s)),p(a(e,r),t)}function n(e,t,n,o,i,r,s){return e=p(e,p(p(t&o|n&~o,i),s)),p(a(e,r),t)}function o(e,t,n,o,i,r,s){return e=p(e,p(p(t^n^o,i),s)),p(a(e,r),t)}function i(e,t,n,o,i,r,s){return e=p(e,p(p(n^(t|~o),i),s)),p(a(e,r),t)}function r(e){for(var t="",n="",o=0;o<=3;o++)t+=(n="0"+(e>>>8*o&255).toString(16)).substr(n.length-2,2);return t}for(var s,c,u,d,l=function(e){for(var t,n=e.length,o=16*(1+((o=n+8)-o%64)/64),i=new Array(o-1),r=0,s=0;s<n;)r=s%4*8,i[t=(s-s%4)/4]=i[t]|e.charCodeAt(s)<<r,s++;return i[t=(s-s%4)/4]=i[t]|128<<(r=s%4*8),i[o-2]=n<<3,i[o-1]=n>>>29,i}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var o=e.charCodeAt(n);o<128?t+=String.fromCharCode(o):(127<o&&o<2048?t+=String.fromCharCode(o>>6|192):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128)),t+=String.fromCharCode(63&o|128))}return t}(e)),m=1732584193,f=4023233417,h=2562383102,_=271733878,g=0;g<l.length;g+=16)m=t(s=m,c=f,u=h,d=_,l[g+0],7,3614090360),_=t(_,m,f,h,l[g+1],12,3905402710),h=t(h,_,m,f,l[g+2],17,606105819),f=t(f,h,_,m,l[g+3],22,3250441966),m=t(m,f,h,_,l[g+4],7,4118548399),_=t(_,m,f,h,l[g+5],12,1200080426),h=t(h,_,m,f,l[g+6],17,2821735955),f=t(f,h,_,m,l[g+7],22,4249261313),m=t(m,f,h,_,l[g+8],7,1770035416),_=t(_,m,f,h,l[g+9],12,2336552879),h=t(h,_,m,f,l[g+10],17,4294925233),f=t(f,h,_,m,l[g+11],22,2304563134),m=t(m,f,h,_,l[g+12],7,1804603682),_=t(_,m,f,h,l[g+13],12,4254626195),h=t(h,_,m,f,l[g+14],17,2792965006),m=n(m,f=t(f,h,_,m,l[g+15],22,1236535329),h,_,l[g+1],5,4129170786),_=n(_,m,f,h,l[g+6],9,3225465664),h=n(h,_,m,f,l[g+11],14,643717713),f=n(f,h,_,m,l[g+0],20,3921069994),m=n(m,f,h,_,l[g+5],5,3593408605),_=n(_,m,f,h,l[g+10],9,38016083),h=n(h,_,m,f,l[g+15],14,3634488961),f=n(f,h,_,m,l[g+4],20,3889429448),m=n(m,f,h,_,l[g+9],5,568446438),_=n(_,m,f,h,l[g+14],9,3275163606),h=n(h,_,m,f,l[g+3],14,4107603335),f=n(f,h,_,m,l[g+8],20,1163531501),m=n(m,f,h,_,l[g+13],5,2850285829),_=n(_,m,f,h,l[g+2],9,4243563512),h=n(h,_,m,f,l[g+7],14,1735328473),m=o(m,f=n(f,h,_,m,l[g+12],20,2368359562),h,_,l[g+5],4,4294588738),_=o(_,m,f,h,l[g+8],11,2272392833),h=o(h,_,m,f,l[g+11],16,1839030562),f=o(f,h,_,m,l[g+14],23,4259657740),m=o(m,f,h,_,l[g+1],4,2763975236),_=o(_,m,f,h,l[g+4],11,1272893353),h=o(h,_,m,f,l[g+7],16,4139469664),f=o(f,h,_,m,l[g+10],23,3200236656),m=o(m,f,h,_,l[g+13],4,681279174),_=o(_,m,f,h,l[g+0],11,3936430074),h=o(h,_,m,f,l[g+3],16,3572445317),f=o(f,h,_,m,l[g+6],23,76029189),m=o(m,f,h,_,l[g+9],4,3654602809),_=o(_,m,f,h,l[g+12],11,3873151461),h=o(h,_,m,f,l[g+15],16,530742520),m=i(m,f=o(f,h,_,m,l[g+2],23,3299628645),h,_,l[g+0],6,4096336452),_=i(_,m,f,h,l[g+7],10,1126891415),h=i(h,_,m,f,l[g+14],15,2878612391),f=i(f,h,_,m,l[g+5],21,4237533241),m=i(m,f,h,_,l[g+12],6,1700485571),_=i(_,m,f,h,l[g+3],10,2399980690),h=i(h,_,m,f,l[g+10],15,4293915773),f=i(f,h,_,m,l[g+1],21,2240044497),m=i(m,f,h,_,l[g+8],6,1873313359),_=i(_,m,f,h,l[g+15],10,4264355552),h=i(h,_,m,f,l[g+6],15,2734768916),f=i(f,h,_,m,l[g+13],21,1309151649),m=i(m,f,h,_,l[g+4],6,4149444226),_=i(_,m,f,h,l[g+11],10,3174756917),h=i(h,_,m,f,l[g+2],15,718787259),f=i(f,h,_,m,l[g+9],21,3951481745),m=p(m,s),f=p(f,c),h=p(h,u),_=p(_,d);return(r(m)+r(f)+r(h)+r(_)).toLowerCase()}function m(e){e=new RegExp("(?:^|;\\s*)"+e+"\\=([^;]+)(?:;\\s*|$)").exec(document.cookie);return e?e[1]:void 0}function r(e,t,n){var o=new Date;o.setTime(o.getTime()-864e5);document.cookie=e+"=;path=/;domain=."+t+";expires="+o.toGMTString(),document.cookie=e+"=;path=/;domain=."+n+"."+t+";expires="+o.toGMTString()}function o(e){this.id=++h,this.params=i(e||{},{v:"*",data:{},type:"get",dataType:"jsonp"}),this.params.type=this.params.type.toLowerCase(),"object"==typeof this.params.data&&(this.params.data=JSON.stringify(this.params.data)),this.middlewares=u.slice(0)}var s=d.Promise;if(!s){var e="å½“å‰æµè§ˆå™¨ä¸æ”¯æŒPromiseï¼Œè¯·åœ¨windowså¯¹è±¡ä¸ŠæŒ‚è½½Promiseå¯¹è±¡å¯å‚è€ƒï¼ˆhttp://gitlab.alibaba-inc.com/mtb/lib-es6polyfill/tree/masterï¼‰ä¸­çš„è§£å†³æ–¹æ¡ˆ";throw _.mtop={ERROR:e},new Error(e)}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});var c=s.resolve();try{d.localStorage.setItem("@private","false")}catch(e){0}var t,n,a={useJsonpResultType:!1,safariGoLogin:!0,useAlipayJSBridge:!1},u=[],f={ERROR:-1,SUCCESS:0,TOKEN_EXPIRED:1,SESSION_EXPIRED:2};(function(){(n=d.location.hostname)||(t=d.parent.location.hostname)&&~t.indexOf("zebra.alibaba-inc.com")&&(n=t);var e=new RegExp("([^.]*?)\\.?((?:"+["taobao.net","taobao.com","tmall.com","tmall.hk","alibaba-inc.com"].join(")|(?:").replace(/\./g,"\\.")+"))","i"),t=n.match(e)||[],n=t[2]||"taobao.com",e=t[1]||"m";"taobao.net"!==n||"x"!==e&&"waptest"!==e&&"daily"!==e?"taobao.net"===n&&"demo"===e?e="demo":"alibaba-inc.com"===n&&"zebra"===e?e="zebra":"waptest"!==e&&"wapa"!==e&&"m"!==e&&(e="m"):e="waptest",t="taobao.com"!==n&&"tmall.com"!==n?"api":"h5api",a.mainDomain=n,a.subDomain=e,a.prefix=t})(),t=d.navigator.userAgent,(n=t.match(/WindVane[\/\s]([\d\.\_]+)/))&&(a.WindVaneVersion=n[1]),(t=t.match(/AliApp\(([^\/]+)\/([\d\.\_]+)\)/i))&&(a.AliAppName=t[1],a.AliAppVersion=t[2]);var h=0;o.prototype.use=function(e){if(!e)throw new Error("middleware is undefined");return this.middlewares.push(e),this},o.prototype.__processRequestMethod=function(e){var t=this.params,n=this.options;"get"===t.type&&"jsonp"===t.dataType?n.getJSONP=!0:"get"===t.type&&"originaljsonp"===t.dataType?n.getOriginalJSONP=!0:"get"===t.type&&"json"===t.dataType?n.getJSON=!0:"post"===t.type&&(n.postJSON=!0),e()},o.prototype.__processRequestType=function(e){var t=this,n=this.options;if(!0===a.H5Request&&(n.H5Request=!0),!0===a.WindVaneRequest&&(n.WindVaneRequest=!0),!1===n.H5Request&&!0===n.WindVaneRequest){if(!_.windvane||parseFloat(n.WindVaneVersion)<5.4)throw new Error("WINDVANE_NOT_FOUND::ç¼ºå°‘WindVaneçŽ¯å¢ƒ")}else!0===n.H5Request?n.WindVaneRequest=!1:void 0===n.WindVaneRequest&&void 0===n.H5Request&&(_.windvane&&5.4<=parseFloat(n.WindVaneVersion)?n.WindVaneRequest=!0:n.H5Request=!0);var o=d.navigator.userAgent.toLowerCase();return-1<o.indexOf("youku")&&n.mainDomain.indexOf("youku.com")<0&&(n.WindVaneRequest=!1,n.H5Request=!0),-1<n.mainDomain.indexOf("youku.com")&&o.indexOf("youku")<0&&(n.WindVaneRequest=!1,n.H5Request=!0),e?e().then(function(){var e=n.retJson.ret;return e instanceof Array&&(e=e.join(",")),!0===n.WindVaneRequest&&(!e||-1<e.indexOf("PARAM_PARSE_ERROR")||-1<e.indexOf("HY_FAILED")||-1<e.indexOf("HY_NO_HANDLER")||-1<e.indexOf("HY_CLOSED")||-1<e.indexOf("HY_EXCEPTION")||-1<e.indexOf("HY_NO_PERMISSION"))?(a.H5Request=!0,t.__sequence([t.__processRequestType,t.__processToken,t.__processRequestUrl,t.middlewares,t.__processRequest])):void 0}):void 0};var R="_m_h5_c",v="_m_h5_tk";o.prototype.__getTokenFromAlipay=function(){var t=g(),n=this.options,e=(d.navigator.userAgent,!!location.protocol.match(/^https?\:$/)),o="AP"===n.AliAppName&&8.2<=parseFloat(n.AliAppVersion);return!0===n.useAlipayJSBridge&&!e&&o&&d.AlipayJSBridge&&d.AlipayJSBridge.call?d.AlipayJSBridge.call("getMtopToken",function(e){e&&e.token&&(n.token=e.token),t.resolve()},function(){t.resolve()}):t.resolve(),t.promise},o.prototype.__getTokenFromCookie=function(){var e=this.options;return e.CDR&&m(R)?e.token=m(R).split(";")[0]:e.token=e.token||m(v),e.token&&(e.token=e.token.split("_")[0]),s.resolve()},o.prototype.__processToken=function(e){var n=this,o=this.options;return this.params,o.token&&delete o.token,!0!==o.WindVaneRequest?c.then(function(){return n.__getTokenFromAlipay()}).then(function(){return n.__getTokenFromCookie()}).then(e).then(function(){var e=o.retJson,t=e.ret;if(-1<(t=t instanceof Array?t.join(","):t).indexOf("TOKEN_EMPTY")||!0===o.CDR&&-1<t.indexOf("ILLEGAL_ACCESS")||-1<t.indexOf("TOKEN_EXOIRED")){if(o.maxRetryTimes=o.maxRetryTimes||5,o.failTimes=o.failTimes||0,o.H5Request&&++o.failTimes<o.maxRetryTimes)return n.__sequence([n.__processToken,n.__processRequestUrl,n.middlewares,n.__processRequest]);0<o.maxRetryTimes&&(r(R,o.pageDomain,"*"),r(v,o.mainDomain,o.subDomain),r("_m_h5_tk_enc",o.mainDomain,o.subDomain)),e.retType=f.TOKEN_EXPIRED}}):void e()},o.prototype.__processRequestUrl=function(e){var t,n,o,i,r,s=this.params,a=this.options;a.hostSetting&&a.hostSetting[d.location.hostname]&&((o=a.hostSetting[d.location.hostname]).prefix&&(a.prefix=o.prefix),o.subDomain&&(a.subDomain=o.subDomain),o.mainDomain&&(a.mainDomain=o.mainDomain)),!0===a.H5Request&&(t="//"+(a.prefix?a.prefix+".":"")+(a.subDomain?a.subDomain+".":"")+a.mainDomain+"/h5/"+s.api.toLowerCase()+"/"+s.v.toLowerCase()+"/",n=s.appKey||("waptest"===a.subDomain?"4272":"12574478"),o=(new Date).getTime(),i={jsv:"2.4.2",appKey:n,t:o,sign:p(a.token+"&"+o+"&"+n+"&"+s.data)},r={data:s.data,ua:s.ua},Object.keys(s).forEach(function(e){void 0===i[e]&&void 0===r[e]&&(i[e]=s[e])}),a.getJSONP?i.type="jsonp":a.getOriginalJSONP?i.type="originaljsonp":(a.getJSON||a.postJSON)&&(i.type="originaljson"),!0===a.useJsonpResultType&&"originaljson"===i.type&&delete i.type,a.querystring=i,a.postdata=r,a.path=t),e()},o.prototype.__processUnitPrefix=function(e){e()};var E=0;o.prototype.__requestJSONP=function(e){function t(e){if(a&&clearTimeout(a),p.parentNode&&p.parentNode.removeChild(p),"TIMEOUT"===e)window[s]=function(){window[s]=void 0;try{delete window[s]}catch(e){}};else{window[s]=void 0;try{delete window[s]}catch(e){}}}var n=g(),o=this.params,i=this.options,r=o.timeout||2e4,s="mtopjsonp"+(o.jsonpIncPrefix||"")+ ++E,a=setTimeout(function(){e("TIMEOUT::æŽ¥å£è¶…æ—¶"),t("TIMEOUT")},r);i.querystring.callback=s;var p=document.createElement("script");return p.src=i.path+"?"+l(i.querystring)+"&"+l(i.postdata),p.async=!0,p.onerror=function(){t("ABORT"),e("ABORT::æŽ¥å£å¼‚å¸¸é€€å‡º")},window[s]=function(){i.results=Array.prototype.slice.call(arguments),t(),n.resolve()},r=p,(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]||document.firstElementChild||document).appendChild(r),n.promise},o.prototype.__requestJSON=function(n){function o(e){a&&clearTimeout(a),"TIMEOUT"===e&&s.abort()}var i=g(),e=this.params,r=this.options,s=new d.XMLHttpRequest,t=e.timeout||2e4,a=setTimeout(function(){n("TIMEOUT::æŽ¥å£è¶…æ—¶"),o("TIMEOUT")},t);r.CDR&&m(R)&&(r.querystring.c=decodeURIComponent(m(R))),s.onreadystatechange=function(){if(4==s.readyState){var e,t=s.status;if(200<=t&&t<300||304==t){o(),e=s.responseText,t=s.getAllResponseHeaders()||"";try{(e=/^\s*$/.test(e)?{}:JSON.parse(e)).responseHeaders=t,r.results=[e],i.resolve()}catch(e){n("PARSE_JSON_ERROR::è§£æžJSONå¤±è´¥")}}else o("ABORT"),n("ABORT::æŽ¥å£å¼‚å¸¸é€€å‡º")}};var p,c,t=r.path+"?"+l(r.querystring);if(r.getJSON?(p="GET",t+="&"+l(r.postdata)):r.postJSON&&(p="POST",c=l(r.postdata)),s.open(p,t,!0),s.withCredentials=!0,s.setRequestHeader("Accept","application/json"),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.headers)for(var u in e.headers)s.setRequestHeader(u,e.headers[u]);return s.send(c),i.promise},o.prototype.__requestWindVane=function(e){function t(e){i.results=[e],n.resolve()}var n=g(),o=this.params,i=this.options,r=o.data,s=o.api,a=o.v,p=i.postJSON?1:0,c=i.getJSON||i.postJSON?"originaljson":"";!0===i.useJsonpResultType&&(c="");var u="https"===location.protocol?1:0,d=o.isSec||0,l=o.sessionOption||"AutoLoginOnly",m=o.ecode||0,f=void 0!==o.timer?parseInt(o.timer):void 0!==o.timeout?parseInt(o.timeout):2e4,h=2*f;return!0===o.needLogin&&void 0===o.sessionOption&&(l="AutoLoginAndManualLogin"),void 0!==o.secType&&void 0===o.isSec&&(d=o.secType),_.windvane.call("MtopWVPlugin","send",{api:s,v:a,post:String(p),type:c,isHttps:String(u),ecode:String(m),isSec:String(d),param:JSON.parse(r),timer:f,sessionOption:l,ext_headers:{referer:location.href}},t,t,h),n.promise},o.prototype.__processRequest=function(e,t){var r=this;return c.then(function(){var e=r.options;if(e.H5Request&&(e.getJSONP||e.getOriginalJSONP))return r.__requestJSONP(t);if(e.H5Request&&(e.getJSON||e.postJSON))return r.__requestJSON(t);if(e.WindVaneRequest)return r.__requestWindVane(t);throw new Error("UNEXCEPT_REQUEST::é”™è¯¯çš„è¯·æ±‚ç±»åž‹")}).then(e).then(function(){var e=r.options,t=(r.params,e.results[0]),n=t&&t.ret||[];(t.ret=n)instanceof Array&&(n=n.join(","));var o,i=t.c;e.CDR&&i&&(o=i,i=(i={domain:e.pageDomain,path:"/"})||{},document.cookie=R.replace(/[^+#$&^`|]/g,encodeURIComponent).replace("(","%28").replace(")","%29")+"="+o.replace(/[^+#$&\/:<-\[\]-}]/g,encodeURIComponent)+(i.domain?";domain="+i.domain:"")+(i.path?";path="+i.path:"")+(i.secure?";secure":"")+(i.httponly?";HttpOnly":"")),-1<n.indexOf("SUCCESS")?t.retType=f.SUCCESS:t.retType=f.ERROR,e.retJson=t})},o.prototype.__sequence=function(e){var r=this,s=[],a=[];e.forEach(function e(t){var n,o,i;t instanceof Array?t.forEach(e):(o=g(),i=g(),s.push(function(){return o=g(),n=(n=t.call(r,function(e){return o.resolve(e),i.promise},function(e){return o.reject(e),i.promise}))&&n.catch(function(e){o.reject(e)}),o.promise}),a.push(function(e){return i.resolve(e),n}))});for(var t,n=c;t=s.shift();)n=n.then(t);for(;t=a.pop();)n=n.then(t);return n};function y(e){e()}var w=function(e){e()};o.prototype.request=function(e){var n=this;this.options=i(e||{},a);var t,o=s.resolve([w,y]).then(function(e){var t=e[0],e=e[1];return n.__sequence([t,n.__processRequestMethod,n.__processRequestType,n.__processToken,n.__processRequestUrl,n.middlewares,n.__processRequest,e])}).then(function(){var e=n.options.retJson;return e.retType!==f.SUCCESS?s.reject(e):n.options.successCallback?void n.options.successCallback(e):s.resolve(e)}).catch(function(e){e=e instanceof Error?(console.error(e.stack),{ret:[e.message],stack:[e.stack],retJson:f.ERROR}):"string"==typeof e?{ret:[e],retJson:f.ERROR}:void 0!==e?e:n.options.retJson;return n.options.failureCallback?void n.options.failureCallback(e):s.reject(e)});return this.__processRequestType(),n.options.H5Request&&(n.constructor.__firstProcessor||(n.constructor.__firstProcessor=o),w=function(e){n.constructor.__firstProcessor.then(e).catch(e)}),("get"===this.params.type&&"json"===this.params.dataType||"post"===this.params.type)&&(e.pageDomain=e.pageDomain||(t=d.location.hostname).substring(t.lastIndexOf(".",t.lastIndexOf(".")-1)+1),e.mainDomain!==e.pageDomain&&(e.maxRetryTimes=4,e.CDR=!0)),o},_.mtop=function(e){return new o(e)},_.mtop.request=function(e,t,n){t={H5Request:e.H5Request,WindVaneRequest:e.WindVaneRequest,LoginRequest:e.LoginRequest,AntiCreep:e.AntiCreep,AntiFlood:e.AntiFlood,successCallback:t,failureCallback:n||t};return new o(e).request(t)},_.mtop.H5Request=function(e,t,n){t={H5Request:!0,successCallback:t,failureCallback:n||t};return new o(e).request(t)},_.mtop.middlewares=u,_.mtop.config=a,_.mtop.RESPONSE_TYPE=f,_.mtop.CLASS=o}(window,window.lib||(window.lib={})),function(m,s){function p(e){return e.preventDefault(),!1}function f(e,t){var n=this,o=m.dpr||1,i=document.createElement("div"),r=document.documentElement.getBoundingClientRect(),s=Math.max(r.width,window.innerWidth)/o,a=Math.max(r.height,window.innerHeight)/o;i.style.cssText=["-webkit-transform:scale("+o+") translateZ(0)","-ms-transform:scale("+o+") translateZ(0)","transform:scale("+o+") translateZ(0)","-webkit-transform-origin:0 0","-ms-transform-origin:0 0","transform-origin:0 0","width:"+s+"px","height:"+a+"px","z-index:999999","position:"+(800<s?"fixed":"absolute"),"left:0","top:0px","background:"+(800<s?"rgba(0,0,0,.5)":"#FFF"),"display:none"].join(";");o=document.createElement("div");o.style.cssText=["width:100%","height:52px","background:#EEE","line-height:52px","text-align:left","box-sizing:border-box","padding-left:20px","position:absolute","left:0","top:0","font-size:16px","font-weight:bold","color:#333"].join(";"),o.innerText=e;a=document.createElement("a");a.style.cssText=["display:block","position:absolute","right:0","top:0","height:52px","line-height:52px","padding:0 20px","color:#999"].join(";"),a.innerText="å…³é—­";e=document.createElement("iframe");e.style.cssText=["width:100%","height:100%","border:0","overflow:hidden"].join(";"),800<s&&(o.style.cssText=["width:370px","height:52px","background:#EEE","line-height:52px","text-align:left","box-sizing:border-box","padding-left:20px","position:absolute","left:"+(s/2-185)+"px","top:40px","font-size:16px","font-weight:bold","color:#333"].join(";"),e.style.cssText=["position:absolute","top:92px","left:"+(s/2-185)+"px","width:370px","height:480px","border:0","background:#FFF","overflow:hidden"].join(";")),o.appendChild(a),i.appendChild(o),i.appendChild(e),i.className="J_MIDDLEWARE_FRAME_WIDGET",document.body.appendChild(i),e.src=t,a.addEventListener("click",function(){n.hide();var e=document.createEvent("HTMLEvents");e.initEvent("close",!1,!1),i.dispatchEvent(e)},!1),this.addEventListener=function(){i.addEventListener.apply(i,arguments)},this.removeEventListener=function(){i.removeEventListener.apply(i,arguments)},this.show=function(){document.addEventListener("touchmove",p,!1),i.style.display="block",window.scrollTo(0,0)},this.hide=function(){document.removeEventListener("touchmove",p),window.scrollTo(0,-r.top),i.parentNode&&i.parentNode.removeChild(i)}}if(!s||!s.mtop||s.mtop.ERROR)throw new Error("Mtop åˆå§‹åŒ–å¤±è´¥ï¼è¯·å‚è€ƒMtopæ–‡æ¡£http://gitlab.alibaba-inc.com/mtb/lib-mtop");var r=m.Promise,o=s.mtop.CLASS,a=s.mtop.config,c=s.mtop.RESPONSE_TYPE;s.mtop.middlewares.push(function(e){var o=this,i=this.options,r=this.params;return e().then(function(){var e=i.retJson,t=e.ret,n=navigator.userAgent.toLowerCase(),n=-1<n.indexOf("safari")&&n.indexOf("chrome")<0&&n.indexOf("qqbrowser")<0;if((-1<(t=t instanceof Array?t.join(","):t).indexOf("SESSION_EXPIRED")||-1<t.indexOf("SID_INVALID")||-1<t.indexOf("AUTH_REJECT")||-1<t.indexOf("NEED_LOGIN"))&&(e.retType=c.SESSION_EXPIRED,!i.WindVaneRequest&&(!0===a.LoginRequest||!0===i.LoginRequest||!0===r.needLogin))){if(!s.login)throw new Error("LOGIN_NOT_FOUND::ç¼ºå°‘lib.login");if(!0!==i.safariGoLogin||!n||"taobao.com"===i.pageDomain)return s.login.goLoginAsync().then(function(e){return o.__sequence([o.__processToken,o.__processRequestUrl,o.__processUnitPrefix,o.middlewares,o.__processRequest])}).catch(function(e){throw"CANCEL"===e?new Error("LOGIN_CANCEL::ç”¨æˆ·å–æ¶ˆç™»å½•"):new Error("LOGIN_FAILURE::ç”¨æˆ·ç™»å½•å¤±è´¥")});s.login.goLogin()}})}),s.mtop.loginRequest=function(e,t,n){t={LoginRequest:!0,H5Request:!0,successCallback:t,failureCallback:n||t};return new o(e).request(t)},s.mtop.antiFloodRequest=function(e,t,n){t={AntiFlood:!0,successCallback:t,failureCallback:n||t};return new o(e).request(t)},s.mtop.middlewares.push(function(e){var n=this.options;return this.params,!0!==n.H5Request||!0!==a.AntiFlood&&!0!==n.AntiFlood?void e():e().then(function(){var e=n.retJson,t=e.ret;-1<(t=t instanceof Array?t.join(","):t).indexOf("FAIL_SYS_USER_VALIDATE")&&e.data.url&&(n.AntiFloodReferer?location.href=e.data.url.replace(/(http_referer=).+/,"$1"+n.AntiFloodReferer):location.href=e.data.url)})}),s.mtop.antiCreepRequest=function(e,t,n){t={AntiCreep:!0,successCallback:t,failureCallback:n||t};return new o(e).request(t)},s.mtop.middlewares.push(function(e){var u=this,d=this.options,l=this.params;return!0!==l.forceAntiCreep&&!0!==d.H5Request||!0!==a.AntiCreep&&!0!==d.AntiCreep?void e():e().then(function(){var e=d.retJson,t=e.ret;if(-1<(t=t instanceof Array?t.join(","):t).indexOf("RGV587_ERROR::SM")&&e.data.url){var c="_m_h5_smt",n=(t=c,(t=new RegExp("(?:^|;\\s*)"+t+"\\=([^;]+)(?:;\\s*|$)").exec(document.cookie))?t[1]:void 0),o=!1;if(!0===d.saveAntiCreepToken&&n)for(var i in n=JSON.parse(n))l[i]&&(o=!0);if(!0!==d.saveAntiCreepToken||!n||o)return new r(function(i,r){function s(){p.removeEventListener("close",s),m.removeEventListener("message",a),r("USER_INPUT_CANCEL::ç”¨æˆ·å–æ¶ˆè¾“å…¥")}function a(e){var t,n;try{t=JSON.parse(e.data)||{}}catch(e){}if(t&&"child"===t.type){p.removeEventListener("close",s),m.removeEventListener("message",a),p.hide();try{for(var o in n="string"==typeof(n=JSON.parse(decodeURIComponent(t.content)))?JSON.parse(n):n)l[o]=n[o];!0===d.saveAntiCreepToken?(document.cookie=c+"="+JSON.stringify(n)+";",m.location.reload()):u.__sequence([u.__processToken,u.__processRequestUrl,u.__processUnitPrefix,u.middlewares,u.__processRequest]).then(i)}catch(e){r("USER_INPUT_FAILURE::ç”¨æˆ·è¾“å…¥å¤±è´¥")}}}var p=new f("",e.data.url);p.addEventListener("close",s,!1),m.addEventListener("message",a,!1),p.show()});for(i in n)l[i]=n[i];return u.__sequence([u.__processToken,u.__processRequestUrl,u.__processUnitPrefix,u.middlewares,u.__processRequest])}})})}(window,window.lib||(window.lib={}));
