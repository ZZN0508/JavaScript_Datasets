(this.$WP=this.$WP||[]).push(["fsml46",(e,t)=>{"use strict";var s,a,l,u,o,c,n,i=!1,d=e=>{var t=(()=>{try{return JSON.parse(localStorage.getItem("interaction_mutation_buffer")||"[]")}catch(e){}return[]})();0<t.length&&!i?(i=!0,e({request:{clientRequestTimestampMs:Date.now(),request:t}}).then(()=>{(e=>{try{var t=JSON.parse(localStorage.getItem("interaction_mutation_buffer")||"[]");localStorage.setItem("interaction_mutation_buffer",JSON.stringify(t.filter(t=>e.every(e=>!a(t,e)))))}catch(e){}})(t)}).finally(()=>{i=!1})):0<t.length&&i&&setTimeout(()=>d(e),3e3)},r=()=>{var[,n]=o(c),[,{uid:a}]=s.useContext(l),{userId:i,sessionId:r}=s.useContext(u);return s.useCallback(e=>{var t=Object.assign({pageUid:a,eventTimestampMs:Date.now()},e),e=[];i&&e.push({key:"user_id",value:i}),r&&e.push({key:"session_id",value:r}),(e=>{try{var t=JSON.parse(localStorage.getItem("interaction_mutation_buffer")||"[]");t.push(e),localStorage.setItem("interaction_mutation_buffer",JSON.stringify(t))}catch(e){}})(t=0!==e.length?Object.assign({opaqueIds:e},t):t),setTimeout(()=>d(n),3e3)},[n,r,a,i])},m=()=>{var[,e]=o(c);s.useEffect(()=>{requestIdleCallback(()=>{d(e)})},[e])},v=e=>{if(0===e.length)return Promise.resolve();var a=new URLSearchParams("?batched=true");return e.forEach((e,n)=>{e.forEach((e,t)=>{void 0!==e&&a.append(`data[${n}][${t}]`,e)})}),fetch("/GARecord",{method:"POST",body:a.toString(),credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-Requested-With":"XMLHttpRequest"}}).catch(e=>{console.error(e)})},f=e=>{var n=new URLSearchParams;return Object.entries(e).forEach(([e,t])=>{"eventId"!==e&&n.append(e,t)}),n},g=!1,p=()=>{if(g)h();else{g=!0;try{var e=localStorage.getItem("interaction_buffer"),n=e?JSON.parse(e):[];v(n.map(f)).then(()=>{var e=localStorage.getItem("interaction_buffer"),e=e?JSON.parse(e):[];localStorage.setItem("interaction_buffer",JSON.stringify(e.filter(t=>n.every(e=>!a(e,t)))))}).finally(()=>{g=!1})}catch(e){g=!1}}},k=null,h=()=>{null!==k&&clearTimeout(k),k=setTimeout(p,1e3)},I=e=>{try{var t=localStorage.getItem("interaction_buffer"),n=t?JSON.parse(t):[];n.push(e),localStorage.setItem("interaction_buffer",JSON.stringify(n))}catch(e){return!1}return h(),!0},S=e=>{var n={eventId:Math.random().toString()};e.forEach((e,t)=>{n[t]=e}),I(n)||v([e])},b=e=>{try{var t;return(null==(t=e.match(/^\/([a-zA-Z0-9_]+)/))?void 0:t[1])||"Home"}catch(e){return"Unknown"}},y=()=>{var[{page:n,params:e},{uid:a}]=s.useContext(l),i=s.useContext(u)["userId"],r=(null==e?void 0:e.detailId)||void 0,o=(null==e?void 0:e.geoId)||void 0;return s.useCallback(e=>{var t="Unknown"===n?(e=>{try{var t,n;return(null==(t=e.match(/-d([0-9]+)/))?void 0:t[1])||(null==(n=e.match(/-g([0-9]+)/))?void 0:n[1])||void 0}catch(e){return}})(window.location.pathname):r||o||void 0,t={gac:e.module,gaa:e.action,gal:e.context,gav:e.value,gani:e.nonInteraction,gasl:null!=(e=e.location)?e:t,gass:"Unknown"===n?b(window.location.pathname):n,gapu:a,gams:null!==i,eventId:Math.random().toString()};I(t)||v([f(t)])},[n,r,o,a,i])},N=e=>{var t=y(),{module:n,action:a,context:i,value:r,location:o,nonInteraction:l}=e||{};return s.useCallback(()=>{n&&a&&t({module:n,action:a,context:i,value:r,location:o,nonInteraction:l})},[t,n,a,i,r,o,l])};return[()=>{(c=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"LogInteractions"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"request"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"Impressions_InteractionsRequestInput"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"Impressions_postInteractionsV2"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"request"},"value":{"kind":"Variable","name":{"kind":"Name","value":"request"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"response"},"arguments":[],"directives":[]}]}}]}}],"loc":{"start":0,"end":157}}')).__key=0xe635e385a1b2,c.loc.source={body:"e635e385a1b2"},(n=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"LogInteractionV4"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"interaction"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"InteractionV4Input"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"logInteractionV4"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"interaction"},"value":{"kind":"Variable","name":{"kind":"Name","value":"interaction"}}}],"directives":[]}]}}],"loc":{"start":0,"end":119}}')).__key=0x790de86432c2,n.loc.source={body:"790de86432c2"},"undefined"!=typeof requestIdleCallback&&requestIdleCallback(h),e({LogInteractionV4:n,enqueue:S,useGARecordCallback:N,useGARecorder:y,useInteractionLogger:r,useSubmitInteractionBufferEffect:m})},[e=>s=e,e=>a=e.default,e=>(l=e.Route,u=e.Visitor),e=>o=e.useMutation]]},["cDcdfi","YwNsO_","2R4xv2","5X2em-"]]);
