!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.NanoPlayer=t():e.NanoPlayer=t()}(this,function(){return r=[function(e,t,n){var n=[n(1)],n=function(e){return window.NanoPlayer=e}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(3),n(9),n(5),n(6),n(7),n(8),n(2),n(17),n(21),n(100),n(23),n(101)],n=function(t,e,n,r,a,s,o,i,u,c,d,E){"use strict";function f(e){d.validatePlayerDivId(e),this.version=i.CORE,console.debug("NanoCore api version: "+this.version),this.type="default",this.id=Math.round(1e11*Math.random()).toString(),this._playerDivId=e,this._dummyPlayer=new t(this._playerDivId),this._realPlayer=this._dummyPlayer}var l=f.prototype=Object.create(t.prototype);return l.setup=function(i){return new E(function(t,n){var r=i&&i.events&&i.events.onError?i.events.onError:null,o=function(e){e.code||(e.code=u.SETUP.EXCEPTION),e.message||(e.message="An unknown error occured during setup.");var t={name:"Error",data:{code:e.code,message:e.message},player:this._playerDivId,id:this.id,version:this.version,state:s.IDLE};r&&this.on(t.name,r),this.emit(t.name,t),n(e)}.bind(this);try{this._realPlayer&&this._realPlayer!==this._dummyPlayer&&(this._realPlayer.destroy(),this._realPlayer=this._dummyPlayer),e.create(this._playerDivId,i).then(function(e){this.version=e.version,this.type=e.type,this._realPlayer=e,this._realPlayer.id=this.id,this._propagator=c.create(e,a,this),this._realPlayer.setup(i).then(function(e){window.onunload=function(e){this._realPlayer.destroy()}.bind(this),t(e)}.bind(this),o)}.bind(this),function(e){o(e)})}catch(e){o(e)}}.bind(this))},l.destroy=function(){this._realPlayer.destroy()},l.play=function(){this._realPlayer.play()},l.pause=function(){this._realPlayer.pause()},l.mute=function(){this._realPlayer.mute()},l.unmute=function(){this._realPlayer.unmute()},l.setVolume=function(e){this._realPlayer.setVolume(e)},l.updateSource=function(e,t){return this._realPlayer.updateSource(e,t)},f.events=a,f.states=s,f.emptyConfig=n,f.validConfig=r,f.pauseReasons=o,f.errorCodes=u,f.version=i.CORE,f.capabilities=e.capabilities,f}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){return Object.freeze({NORMAL:"normal",BUFFER:"buffer",CONNECTION_CLOSE:"connectionclose",SERVER_NOT_FOUND:"servernotfound",STREAM_NOT_FOUND:"streamnotfound",INTERACTION_REQUIRED:"interactionrequired",PLAYBACK_SUSPENDED:"playbacksuspended",PLAYBACK_ERROR:"playbackerror",RECONNECTION_IMMINENT:"reconnectionimminent",DESTROY:"destroy",PLAYBACK_RESTART:"playbackrestart",VISIBILITY_HIDDEN:"visibilityhidden",NOT_ENOUGH_DATA:"notenoughdata",SOURCE_STREAM_STOPPED:"sourcestreamstopped"})}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(4)],n=function(e){"use strict";function t(){this.version=void 0,this.type=void 0}e=t.prototype=Object.create(e.prototype);return e.setup=function(){throw new Error('"setup" must be implemented or player not initialized')},e.destroy=function(){throw new Error('"destroy" must be implemented or player not initialized')},e.play=function(){throw new Error('"play" must be implemented or player not initialized by call setup')},e.pause=function(){throw new Error('"pause" must be implemented or player not initialized by call setup')},e.mute=function(){throw new Error('"mute" must be implemented or player not initialized by call setup')},e.unmute=function(){throw new Error('"unmute" must be implemented or player not initialized by call setup')},e.setVolume=function(){throw new Error('"setVolume" must be implemented or player not initialized by call setup')},e.updateSource=function(){throw new Error('"updateSource" must be implemented or player not initialized by call setup')},t.isSupported=function(){return!1},t.supportedTechniques=[],t}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){"use strict";function e(){}function i(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function t(e){return function(){return this[e].apply(this,arguments)}}var n=e.prototype;return n.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp)for(n in t={},r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n]);else t=r[e]||(r[e]=[]);return t},n.flattenListeners=function(e){for(var t=[],n=0;n<e.length;n+=1)t.push(e[n].listener);return t},n.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},n.addListener=function(e,t){var n,r=this.getListenersAsObject(e),o="object"==typeof t;for(n in r)r.hasOwnProperty(n)&&-1===i(r[n],t)&&r[n].push(o?t:{listener:t,once:!1});return this},n.on=t("addListener"),n.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},n.once=t("addOnceListener"),n.defineEvent=function(e){return this.getListeners(e),this},n.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},n.removeListener=function(e,t){var n,r,o=this.getListenersAsObject(e);for(r in o)o.hasOwnProperty(r)&&(n=i(o[r],t),-1!==n&&o[r].splice(n,1));return this},n.off=t("removeListener"),n.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},n.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},n.manipulateListeners=function(e,t,n){var r,o,i=e?this.removeListener:this.addListener,a=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)i.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(o=t[r])&&("function"==typeof o?i:a).call(this,r,o);return this},n.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"==n)delete r[e];else if(e instanceof RegExp)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},n.removeAllListeners=t("removeEvent"),n.emitEvent=function(e,t){var n,r,o,i,a,s=this.getListenersAsObject(e);for(i in s)if(s.hasOwnProperty(i))for(n=s[i].slice(0),o=n.length;o--;)r=n[o],!0===r.once&&this.removeListener(e,r.listener),a=r.listener.apply(this,t||[]),a===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},n.trigger=t("emitEvent"),n.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return t.length?t.length&&"object"!=typeof t[0]||t.length&&!t[0].hasOwnProperty("data")?t[0]={name:e,data:t[0]}:t[0].name=e:t.push({name:e,data:{}}),this.emitEvent(e,t)},n.emitSimple=function(e,t,n){return this.emitEvent(e,[{name:e||"AnonymousEvent",target:n||this,data:t||{}}])},n.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},n._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},n._getEvents=function(){return this._events||(this._events={})},e}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return{create:function(){return{playback:{autoplay:!0,automute:!1,muted:!1,metadata:!1,forceTech:"",flashplayer:"",videoId:"",keepConnection:!1,allowSafariHlsFallback:!1,reconnect:{minDelay:2,maxDelay:10,delaySteps:10,maxRetries:10},timeouts:{loading:20,buffering:20,connecting:5}},source:{hls:"",h5live:{server:{websocket:"",progressive:"",hls:""},token:"",rtmp:{url:"",streamname:""},security:{token:"",expires:"",options:"",tag:""},params:{}}},events:{onReady:void 0,onPlay:void 0,onPause:void 0,onLoading:void 0,onStartBuffering:void 0,onStopBuffering:void 0,onError:void 0,onMetaData:void 0,onFullscreenEnter:void 0,onFullscreenExit:void 0,onPlaybackFinished:void 0,onMedia:void 0,onStats:void 0,onMute:void 0,onUnmute:void 0,onVolumeChange:void 0,onStreamInfo:void 0,onStreamInfoUpdate:void 0,onWarning:void 0,onDestroy:void 0,onUpdateSourceInit:void 0,onUpdateSourceSuccess:void 0,onUpdateSourceError:void 0,onUpdateSourceTimeout:void 0},tweaks:{buffer:{min:void 0,start:void 0,max:void 0,target:void 0,limit:void 0},bufferDynamic:{offsetThreshold:void 0,offsetStep:void 0,cooldownTime:void 0}}}}}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return{create:function(){return{source:{hls:"string",h5live:{server:{websocket:"string",progressive:"string",hls:"string"},token:"string",rtmp:{url:"string",streamname:"string"},params:"object",security:{token:"string",expires:"string",options:"string",tag:"string"}}},playback:{autoplay:"boolean",automute:"boolean",muted:"boolean",forceTech:"string",metadata:"boolean",flashplayer:"string",videoId:"string",keepConnection:"boolean",allowSafariHlsFallback:"boolean",reconnect:{minDelay:"number",maxDelay:"number",delaySteps:"number",maxRetries:"number"},timeouts:{loading:"number",buffering:"number",connecting:"number"}},events:{onReady:"function",onPlay:"function",onPause:"function",onLoading:"function",onStartBuffering:"function",onStopBuffering:"function",onError:"function",onMetaData:"function",onStats:"function",onMute:"function",onUnmute:"function",onVolumeChange:"function",onStreamInfo:"function",onStreamInfoUpdate:"function",onWarning:"function",onDestroy:"function",onUpdateSourceInit:"function",onUpdateSourceSuccess:"function",onUpdateSourceError:"function",onUpdateSourceTimeout:"function"},tweaks:{buffer:{max:"number",min:"number",start:"number",target:"number",limit:"number"},bufferDynamic:{offsetThreshold:"number",offsetStep:"number",cooldownTime:"number"}}}}}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return Object.freeze({READY:"Ready",ERROR:"Error",PAUSE:"Pause",LOADING:"Loading",START_BUFFERING:"StartBuffering",STOP_BUFFERING:"StopBuffering",PLAY:"Play",METADATA:"MetaData",STATS:"Stats",PLAYBACK_FINISHED:"PlaybackFinished",MEDIA:"Media",STREAM_INFO:"StreamInfo",STREAM_INFO_UPDATE:"StreamInfoUpdate",MUTE:"Mute",UNMUTE:"Unmute",VOLUME_CHANGE:"VolumeChange",STATE_CHANGE:"StateChange",WARNING:"Warning",DESTROY:"Destroy",UPDATE_SOURCE_INIT:"UpdateSourceInit",UPDATE_SOURCE_SUCCESS:"UpdateSourceSuccess",UPDATE_SOURCE_FAIL:"UpdateSourceFail",UPDATE_SOURCE_ABORT:"UpdateSourceAbort"})}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return Object.freeze({UNINITIALIZED:1,IDLE:2,READY:3,LOADING:4,PLAYING:5,PAUSED:6,BUFFERING:7,UNKNOWN:8,PLAYBACK_NOT_STARTED:9,PLAYBACK_SUSPENDED:10,PAUSING:11,PLAYBACK_ERROR:12,RECONNECTION_IMMINENT:13,CONNECTION_ERROR:14,DESTROYING:15,PLAYBACK_RESTARTING:16,VISIBILITY_HIDDEN:17,NOT_ENOUGH_DATA:18,SOURCE_STREAM_STOPPED:19})}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(10),n(11),n(12),n(99),n(24),n(21)],n=function(e,i,a,s,u,c){function d(e,r){var t=[],e=e.filter(function(e){t=t.concat(e.supportedTechniques);var n=!1;return e.supportedTechniques.forEach(function(e){var t;!1===n&&(n=!r.playback.forceTech||(t=e,e=r.playback.forceTech,-1!==t.indexOf(e)||-1!==e.indexOf(t)))}),n});if(!e.length)throw new i(s.FORCE_NOT_SUPPORTED.replace("$tech$",r.playback.forceTech),c.SETUP.FORCE_NOT_SUPPORTED);return e}return{create:function(r,o){return new Promise(function(e,t){var n=a;try{e(new(d(function(e,n){var r={};r[u.H5LIVE_WSS]="h5live",r[u.H5LIVE_HLS]="h5live",r[u.FLASH]="h5live",r[u.NATIVE]="hls";var o=[];if(!(e=e.filter(function(e){var t=!1;return e.supportedTechniques.forEach(function(e){o.push(r[e]),!1===t&&(t=n.hasOwnProperty("source")&&n.source.hasOwnProperty(r[e]))}),t})).length)throw new i(s.SOURCE_NOT_SUPPORTED,c.SETUP.SOURCE_NOT_SUPPORTED);return e}(function(e){if(!(e=e.filter(function(e){return e.isSupported()})).length)throw new i(s.CLIENT_NOT_SUPPORTED,c.SETUP.CLIENT_NOT_SUPPORTED);return e}(n),o),o)[0])(r))}catch(e){t(e)}})},capabilities:(t=[],a.filter(function(e){return e.isSupported()}).forEach(function(e){t=t.concat(e.supportedTechniques)}),t)};var t}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){"use strict";var e="Unknown",t="";screen.width&&(t+=(screen.width||"")+" x "+(screen.height||""));var n,r=navigator.appVersion,o=navigator.userAgent,i=navigator.appName,a=""+parseFloat(navigator.appVersion),s=parseInt(navigator.appVersion,10),u=e,c=navigator.plugins;if(-1!==(f=o.indexOf("Opera"))&&(i="Opera",a=o.substring(f+6),-1!==(f=o.indexOf("Version"))&&(a=o.substring(f+8)),u="Chromium"),-1!==(f=o.indexOf("SamsungBrowser")))i="Samsung Browser",a=o.substring(f+15),u="Chromium";else if(-1!==(f=o.indexOf("Edg/")))i="Microsoft Edge Chromium",a=o.substring(f+4),u="Chromium";else if(-1!==(f=o.indexOf("UCBrowser")))i="UC Browser",a=o.substring(f+10),u="Blink";else if(-1!==(f=o.indexOf("YaBrowser")))i="Yandex Browser",a=o.substring(f+10),u="Blink";else if(-1!==(f=o.indexOf("QIHU 360EE"))||-1!==(f=o.indexOf("360Browser")))i="Qihoo 360 Browser",a="0",u="Blink";else if(-1!==(f=o.indexOf("Iron")))i="Iron Browser",a=o.substring(f+5),u="Chromium";else if(-1!==(f=o.indexOf("Vivaldi")))i="Vivaldi Browser",a=o.substring(f+8),u="Chromium";else if(-1!==(f=o.indexOf("OPR/")))i="Opera",a=o.substring(f+4),u="Chromium";else if(-1!==(f=o.indexOf("MSIE")))i="Microsoft Internet Explorer",a=o.substring(f+5),u="Trident";else if("Netscape"===i&&-1!==(f=o.indexOf("Trident/")))i="Microsoft Internet Explorer",a=o.substring(f+8),-1!==(f=o.indexOf("rv:"))&&(a=o.substring(f+3)),u="Trident";else if("Netscape"===i&&-1!==(f=o.indexOf("Edge/")))i="Microsoft Edge Trident",a=o.substring(f+5),u="Trident";else if(-1!==(f=o.indexOf("Chrome"))){for(var d=["Chromium PDF Viewer","Native Client","Chromium PDF Plugin"],i="Chrome",E=0;E<c.length;E++){d.includes(c[E].name)&&(i="Chromium");break}a=o.substring(f+7),u="Chromium"}else-1!==(f=o.indexOf("PhantomJS"))?(i="PhantomJS",a=o.substring(f+10),u="Webkit"):-1!==(f=o.indexOf("Safari"))?(i="Safari",a=o.substring(f+7),-1!==(f=o.indexOf("Version"))&&(a=o.substring(f+8)),-1!==o.indexOf("CriOS")&&(i="Chrome"),u="Webkit"):-1!==(f=o.indexOf("Firefox"))?(i="Firefox",a=o.substring(f+8),u="Firefox"):(n=o.lastIndexOf(" ")+1)<(f=o.lastIndexOf("/"))&&(i=o.substring(n,f),a=o.substring(f+1),i.toLowerCase()===i.toUpperCase()&&(i=navigator.appName));-1!==(f=(a=-1!==(f=(a=-1!==(f=a.indexOf(";"))?a.substring(0,f):a).indexOf(" "))?a.substring(0,f):a).indexOf(")"))&&(a=a.substring(0,f)),s=parseInt(""+a,10),isNaN(s)&&(a=""+parseFloat(navigator.appVersion),s=parseInt(navigator.appVersion,10));var f=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(r),s=!!navigator.cookieEnabled;void 0!==navigator.cookieEnabled||s||(document.cookie="testcookie",s=-1!==document.cookie.indexOf("testcookie"));var l,p=e,T=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 10",r:/(Windows 10|Windows NT 10.0)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(l in T){var m=T[l];if(m.r.test(o)){p=m.s;break}}var A=e;switch(/Windows/.test(p)&&(/Windows (.*)/.exec(p)&&(A=/Windows (.*)/.exec(p)[1]),p="Windows"),p){case"Mac OS X":/Mac OS X (10[._\d]+)/.exec(o)&&(A=/Mac OS X (10[._\d]+)/.exec(o)[1]);break;case"Android":/Android ([._\d]+)/.exec(o)&&(A=/Android ([._\d]+)/.exec(o)[1]);break;case"iOS":A=(A=/OS (\d+)_(\d+)_?(\d+)?/.exec(r))?A[1]+"."+A[2]+"."+(0|A[3]):e}return{screen:t,browser:i,browserVersion:a,mobile:f,os:p,osVersion:A,cookies:s,browserEngine:u}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return function(e,t){return(e=new window.Error(e||"")).code=t||0,e}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(13),n(13)],n=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);return e}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(3),n(15),n(14),n(17),n(10),n(18),n(19),n(4),n(22),n(23),n(25),n(11),n(5),n(6),n(8),n(27),n(7),n(21),n(24),n(2),n(28),n(33),n(34),n(36),n(38),n(56),n(70),n(29),n(31),n(30),n(32),n(40)],n=function(e,s,u,t,n,r,f,o,i,l,a,p,c,d,E,T,m,A,_,S,h,R,O,g,N,y,I,v,C,b,D,P){"use strict";function U(e){l.validatePlayerDivId(e),this._setBaseValues(e)}var L=r.log;U.supportedTechniques=(U.getSupportedTechniques=function(){var e=[];return a.isH5LiveKnownUnsupported||(a.hasMediaSource&&e.push(_.H5LIVE_WSS),(a.mustUseHLS||a.canUseHLS)&&e.push(_.H5LIVE_HLS)),e})(),U.isSupported=function(){return 0<U.supportedTechniques.length};e=U.prototype=Object.create(e.prototype);return e._setBaseValues=function(e){this.version=t.CORE,this.type="h5live",this.networkState=this.NETWORK_STATE.UNINITIALIZED,this._info=n,this.config=c.create(),this._playerDivId="",this._playing=!1,this._updating=!1,this._serverInfo=null,this._pauseReason="",this._playerDivId=e,this._mediaElementId="h5live-"+e,this._componentEmitter=new o,this._componentListeners={logic:[{type:C.SERVER_INFO,listener:this._onServerInfo.bind(this)},{type:C.STREAM_INFO,listener:this._onStreamInfo.bind(this)},{type:C.STREAM_INFO_UPDATE,listener:this._onStreamInfoUpdate.bind(this)},{type:C.NO_KEEP_CONNECTION,listener:this._onNoKeepConnection.bind(this)},{type:C.MIME_TYPE_UNSUPPORTED,listener:this._onMimeTypeUnsupported.bind(this)},{type:C.ERROR,listener:this._onLogicError.bind(this)},{type:C.UPDATE_SOURCE_INIT,listener:this._onUpdateSourceInit.bind(this)}],network:[{type:D.CONNECTING,listener:this._onConnectionConnecting.bind(this)},{type:D.CONNECTED,listener:this._onConnectionOpen.bind(this)},{type:D.DISCONNECTED,listener:this._onConnectionClosed.bind(this)},{type:D.RECONNECTING,listener:this._onConnectionReconnecting.bind(this)},{type:D.RECONNECTION_IMMINENT,listener:this._onConnectionReconnectionImminent.bind(this)},{type:D.DESTROYED,listener:this._onConnectionDestroyed.bind(this)},{type:D.INITIALIZATION_ERROR,listener:this._onConnectionInitializationError.bind(this)},{type:D.CONNECTION_ERROR,listener:this._onConnectionError.bind(this)},{type:D.ERROR,listener:this._onConnectionError.bind(this)},{type:D.WARNING,listener:this._onConnectionWarning.bind(this)},{type:D.STATE_CHANGE,listener:this._onConnectionStateChange.bind(this)}],media:[{type:b.ERROR,listener:this._onError.bind(this)},{type:b.PLAYBACK_ERROR,listener:this._onMediaError.bind(this)},{type:b.PLAYBACK_STARTED,listener:this._onMediaPlaying.bind(this)},{type:b.PLAYBACK_SUSPENDED,listener:this._onMediaSuspended.bind(this)},{type:b.BUFFERING,listener:this._onMediaBuffering.bind(this)},{type:b.PLAY_START_ERROR,listener:this._onPlayStartError.bind(this)}]},this._setState(this.STATE.IDLE)},e._baseSetup=function(e,t){var n,r=f.check(t,d.create());if(f.merge(t,this.config),f.clean(this.config),n=l.validateConfig(e,t))return n;t.playback.videoId&&(this._mediaElementId=t.playback.videoId),this._setListeners(this.config.events,this),r.forEach(function(e){this._emitWarning(e)}.bind(this));var o=document.getElementById(this._playerDivId);this._metaDataEnabled=this.config.playback.metadata;var i,a,e=this.config.source.h5live.params,t=this.config.source.h5live.rtmp,r=e&&e.url?e.url:t&&t.url?t.url:null,t=e&&e.stream?e.stream:t&&t.streamname?t.streamname:null;for(i in this.config.url=r&&t?r+"/"+t:"",this.config.type=this.type,this.config.id=this.id,this._components={network:y.create(this._componentEmitter),media:I.create(this._componentEmitter),logic:N.create(this._componentEmitter),performance:O.create(this._componentEmitter,this._playerDivId),propagator:R.create(this._componentEmitter),error:g.create(this._componentEmitter),state:h.create(this._componentEmitter)},this._components)this._componentListeners.hasOwnProperty(i)&&this._componentListeners[i].length&&s.add({target:this._componentEmitter,listeners:this._componentListeners[i]});for(a in m)(this._outwardEvents||(this._outwardEvents=[]))&&this._outwardEvents.push({from:m[a],to:m[a]});return this._outwardTranslator=u.create(this._componentEmitter,this,this._outwardEvents),this._emitConfig(),this._setupVideoElement(o),n},e.setup=function(r){return new Promise(function(e,t){try{var n=this._baseSetup(U.supportedTechniques[0],r);n?t(n):(setTimeout(function(){this._setState(this.STATE.READY),this.emit(m.READY,{config:this.config}),this.config.playback.autoplay&&this.play()}.bind(this),20),e(this.config))}catch(e){t(e)}}.bind(this))},e._destroy=function(){for(var e in this._setState(this.STATE.DESTROYING),this._playing&&this.pause(this.state),this.emit(m.DESTROY),this._outwardTranslator&&this._outwardTranslator.destroy(),this._outwardTranslator=null,this._components)this._components.hasOwnProperty(e)&&(this._components[e].destroy(),delete this._components[e]);for(var t in this._componentListeners)this._componentListeners.hasOwnProperty(t)&&this._componentListeners[t].length&&s.remove({target:this._componentEmitter,listeners:this._componentListeners[t]});this.removeAllListeners()},e.destroy=e._destroy,e._emitConfig=function(){this._componentEmitter.emit(v.CONFIG,{config:i.copy(this.config)})},e._setState=function(e){var t=1<arguments.length?arguments[1]:{};this.state=e,t.state=e,this._componentEmitter.emit(C.STATE_CHANGE,t)},e._debug=function(e,t){L("nanoplayer ("+this._playerDivId+"): "+e,t)},e._setListeners=function(e,t){for(var n in e){var r;e.hasOwnProperty(n)&&"function"==typeof e[n]&&(r=n.replace("on",""),n=e[n],t.on(r,n))}},e._setupVideoElement=function(e){this._componentEmitter.emit(v.CREATE_VIDEO,{elementId:this._mediaElementId,container:e})},e._onLogicError=function(e){switch(e.data.code){case A.PLAYER.VISIBILITY_HIDDEN:this._setState(E.VISIBILITY_HIDDEN);break;case A.STREAM.NOT_ENOUGH_DATA:this._setState(E.NOT_ENOUGH_DATA);break;case A.STREAM.SOURCE_STOPPED:this._setState(E.SOURCE_STREAM_STOPPED);break;case A.MEDIA.SOURCE_ENDED:this._setState(E.PLAYBACK_ERROR)}this.emit(m.ERROR,e.data),this.pause(this.state)},e._onUpdateSourceInit=function(e){!(a.mustUseHLS||a.canUseHLS&&this.config.playback.allowSafariHlsFallback)||this.state!==this.STATE.PLAYING&&this.state!==this.STATE.LOADING&&this.state!==this.STATE.BUFFERING?e.data.options.forcePlay&&-1!==[this.STATE.READY,this.STATE.PAUSED].indexOf(this.state)&&setTimeout(this.play.bind(this),200):(this._setState(E.PLAYBACK_RESTARTING),this.pause(this.state),setTimeout(this.play.bind(this),200))},e._onPlayStartError=function(e){"NotAllowedError"===(this._debug(e.data.error.name+": "+e.data.error.message,1),e.data.error.name)&&(e.data.automuted?this._emitWarning("Unmuted autoplay failed by autoplay policy, but 'automute' is enabled. Try to play muted."):(this._setState(this.STATE.PLAYBACK_NOT_STARTED),this._emitError(A.PLAYER.INTERACTION_REQUIRED,"Playback must be initialized by user gesture.")))},e._onError=function(e){if(this.state!==this.STATE.PAUSING&&this.state!==this.STATE.PAUSED){var t="",e=e.data.code;switch(e){case MediaError.MEDIA_ERR_ABORTED:t="A fetching process of the media aborted by user";break;case MediaError.MEDIA_ERR_NETWORK:t="An error occurred when downloading media";break;case MediaError.MEDIA_ERR_DECODE:t="An error occurred when decoding media";break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:t="The received audio/video is not supported";break;default:t="An unknown media error occurred"}this._debug('error media with state "'+this._getState()+'", networkstate "'+this._getNetworkState()+'"',3),this._debug("error message: "+t,3),e===MediaError.MEDIA_ERR_DECODE&&this.state!==this.STATE.LOADING&&setTimeout(this.play.bind(this),1e3),this._setState(this.STATE.PLAYBACK_ERROR),this._emitError(e+3e3,t)}},e._preparePlay=function(e){this._setState(this.STATE.LOADING,{connectDelay:e}),this.emit(m.LOADING,{connectDelay:e}),setTimeout(function(){this.state===this.STATE.LOADING&&(this._componentEmitter.emit(P.PLAY),this._componentEmitter.emit(v.PLAY,{external:!0}))}.bind(this),e)},e.play=function(){var e=arguments.length?arguments[0]:0;L("nanoplayer ("+this._playerDivId+"): play in state "+this.state,1),this.state<this.STATE.READY?this._emitError(A.PLAYER.NOT_CONFIGURED,"Could not play because player has not been configured."):this.state===this.STATE.READY||this.state===this.STATE.PAUSED?(this._playing=!0,this._preparePlay(e)):this.state===this.STATE.PAUSING&&(L("nanoplayer ("+this._playerDivId+"play in PAUSING state, setting flag to resume"),this._resumeOnPause=!0)},e._onConnectionInitializationError=function(e){this._debug('error init connection with state "'+this._getState()+'", networkstate "'+this._getNetworkState()+'"',2),this._setState(this.STATE.CONNECTION_ERROR),this._emitError(e.data.code,e.data.message)},e._onConnectionError=function(e){this._debug('error connection with state "'+this._getState()+'", networkstate "'+this._getNetworkState()+'"',2),this._setState(this.STATE.CONNECTION_ERROR),this._emitError(e.data.code,e.data.message)},e._onConnectionConnecting=function(e){this._debug("connecting",1)},e._onConnectionStateChange=function(e){this.networkState=e.data.connectionState},e._onConnectionWarning=function(e){var t="Connection warning!",e=e?e.data:void 0;e&&e.message&&(t+=" "+e.message),e&&e.code&&(t+=" (code:"+e.code+")"),this._emitWarning(t)},e._onConnectionOpen=function(e){e.data.count?this._debug("connection open after "+e.data.count+" reconnect tries",1):this._debug("connection open",1)},e._onConnectionClosed=function(e){this._debug("connection closed",1),this._debug('closed connection with state "'+this._getState()+'", networkstate "'+this._getNetworkState()+'"',2),this._emitError(e.data.code,e.data.message)},e._onConnectionDestroyed=function(e){this._debug("connection destroyed"+(e.data.silent?", but silent":""),1),this.state===this.STATE.READY||e.data.silent||this.pause(this.state)},e._onConnectionReconnecting=function(e){this._debug("reconnect attempt "+e.data.count+" started",1)},e._onConnectionReconnectionImminent=function(e){var t=e.data.code;this._debug("connection "+e.data.count+(1<e.data.count?" times":" time")+" unexpectedly closed with code "+t+", but a reconnect will be prepared",1),this._debug("reconnect attempt "+e.data.count+" starts in "+Math.round(e.data.delay)+" ms",1),("iOS"!==n.os||"iOS"===n.os&&1<e.data.count)&&this._emitWarning("Connection error: closed "+e.data.count+(1<e.data.count?" times":" time")+" unexpectedly with code "+t+", but a reconnect will be prepared in "+(e.data.delay/1e3).toFixed(3)+" s"),this._playing&&"iOS"!==n.os&&(this._setState(this.STATE.RECONNECTION_IMMINENT),this.pause(this.state),this.play(e.data.delay))},e._onServerInfo=function(e){this._debug("onServerInfo",2);try{this._serverInfo=e.data.onServerInfo;var t=JSON.stringify(e.data);this._debug(""+t,3)}catch(e){}},e._onStreamInfo=function(e){this._debug("onStreamInfo",2),this.emit(m.STREAM_INFO,e.data)},e._onStreamInfoUpdate=function(e){this._debug("onStreamInfoUpdate",2),this.emit(m.STREAM_INFO_UPDATE,e.data)},e._onNoKeepConnection=function(e){this._debug("onNoKeepConnection",2),this._emitWarning(e.data.message)},e._onMimeTypeUnsupported=function(){this._setState(this.STATE.PLAYBACK_ERROR),this._emitError(A.MEDIA.NOT_SUPPORTED,"The received audio/video is not supported")},e._onMediaError=function(e){this._setState(this.STATE.PLAYBACK_ERROR),this._emitError(A.PLAYER.PLAYBACK_ERROR,e.data)},e._onMediaSuspended=function(){n.mobile?(this._setState(this.STATE.PLAYBACK_SUSPENDED),this._emitError(A.PLAYER.PLAYBACK_SUSPENDED,"Playback suspended by external reason.")):(this._setState(E.PLAYBACK_RESTARTING),this.pause(this.state),setTimeout(this.play.bind(this),0))},e._emit=e.emit,e.emit=function(e,t){var n={};t&&t.name&&t.data?n=t:(n.data=t||{},n.name=e||"unknown"),n.player=this._playerDivId,n.id=this.id,n.version=this.version,n.state=this.state,"Error"===e&&n.data.code&&n.data.message&&this._debug("error "+n.data.code+" "+n.data.message,1),this._emit(n.name,n)},e._emitError=function(e,t){this.emit(m.ERROR,{code:e,message:t}),this.pause(this.state)},e._emitWarning=function(e){this.emit(m.WARNING,{message:e})},e._getPauseReason=function(e){var t="";if(e){var n=this.networkState!==this.NETWORK_STATE.OPEN&&this.networkState!==this.NETWORK_STATE.UNINITIALIZED;switch(e){case this.STATE.READY:t=S.SERVER_NOT_FOUND;break;case this.STATE.LOADING:t=n?S.CONNECTION_CLOSE:S.STREAM_NOT_FOUND;break;case this.STATE.BUFFERING:t=n?S.CONNECTION_CLOSE:S.BUFFER;break;case this.STATE.UNKNOWN:t=n?S.CONNECTION_CLOSE:S.UNKNOWN;break;case this.STATE.PLAYING:t=n?S.CONNECTION_CLOSE:S.NORMAL;break;case this.STATE.PLAYBACK_NOT_STARTED:t=S.INTERACTION_REQUIRED;break;case this.STATE.PLAYBACK_SUSPENDED:t=S.PLAYBACK_SUSPENDED;break;case this.STATE.PLAYBACK_ERROR:t=S.PLAYBACK_ERROR;break;case this.STATE.RECONNECTION_IMMINENT:t=S.RECONNECTION_IMMINENT;break;case this.STATE.CONNECTION_ERROR:t=S.CONNECTION_CLOSE;break;case this.STATE.DESTROYING:t=S.DESTROY;break;case this.STATE.PLAYBACK_RESTARTING:t=S.PLAYBACK_RESTART;break;case this.STATE.VISIBILITY_HIDDEN:t=S.VISIBILITY_HIDDEN;break;case this.STATE.NOT_ENOUGH_DATA:t=S.NOT_ENOUGH_DATA;break;case this.STATE.SOURCE_STREAM_STOPPED:t=S.SOURCE_STREAM_STOPPED;break;default:t=S.NORMAL}}else t=S.NORMAL;return t},e._triggerPause=function(){return this.state===this.STATE.PAUSED?void L("nanoplayer ("+this._playerDivId+"): trigger pause but already in state paused"):(L("nanoplayer ("+this._playerDivId+'): trigger pause with reason "'+this._pauseReason+'", state "'+this._getState()+'", networkstate "'+this._getNetworkState()+'"',3),this._setState(this.STATE.PAUSED,{reason:this._pauseReason}),this.emit(m.PAUSE,{reason:this._pauseReason}),void(this._resumeOnPause&&(this._resumeOnPause=!1,this.play())))},e.pause=function(){var e=arguments.length?arguments[0]:0;L("nanoplayer ("+this._playerDivId+"): pause in state "+this.state,2),this.state<this.STATE.READY?this._emitError(A.PLAYER.NOT_PLAYING,"Could not pause because player was not in playing state before."):this.state!==this.STATE.PAUSED&&this.state!==this.STATE.PAUSING&&(this._pauseReason=this._getPauseReason(e),this._setState(this.STATE.PAUSING),this._playing=!1,this._resumeOnPause=!1,this._componentEmitter.emit(P.PAUSE),this._componentEmitter.emit(v.PAUSE),this._triggerPause())},e.mute=function(){this._componentEmitter.emit(v.MUTE)},e.unmute=function(){this._componentEmitter.emit(v.UNMUTE)},e.setVolume=function(e){this._componentEmitter.emit(v.SET_VOLUME,{volume:e})},e.updateSource=function(d,E){return new Promise(function(e,t){if(this._updating)t(new p("Another 'updateSource' call is pending."));else{this._updating=!0;var n,r=function(e,t){this._updating=!1,e.apply(null,t)}.bind(this);try{if(n=l.validateConfig(U.supportedTechniques[0],{source:d}))n.message.replace("create","update"),this._emitError(n.code,n.message),r(t,[n]);else{f.merge(d,this.config.source),f.clean(this.config.source);var o=this.config.source.h5live.params,i=this.config.source.h5live.rtmp,a=o&&o.url?o.url:i&&i.url?i.url:null,s=o&&o.stream?o.stream:i&&i.streamname?i.streamname:null;this.config.url=a&&s?a+"/"+s:"";var u,c={method:"server",timestampReset:!1,pauseOnError:!1,forcePlay:!0,fastStart:!1,incTiming:!1,timeout:10,tag:""};for(u in c)if(E.hasOwnProperty(u)&&typeof E[u]==typeof c[u])switch(u){case"method":-1!==["server","client"].indexOf(E[u])?c[u]=E[u]:this._emitWarning("The 'updateSource' method is not valid. Valid methods are 'server' and 'client'. The default method 'server' will be set.");break;case"timeout":5<=E[u]&&E[u]<=30?c[u]=E[u]:this._emitWarning("The 'updateSource' timeout value is not in the valid range. the valid range is between 5 and 30. The default value 10 will be set.");break;default:c[u]=E[u]}this._componentEmitter.emit(v.UPDATE_SOURCE,{source:d,options:c}),r(e,[this.config])}}catch(e){r(t,[new p(e.message,e.code)])}}}.bind(this))},e._parseUrl=function(e){var t={url:"",streamname:""},n=e.lastIndexOf("/"),r=e.substr(0,n),n=e.substr(n,e-n);return t.url=r,t.streamname=n,t},e._getState=function(){return i.findPropertyByValue(this.STATE,this.state)},e._getNetworkState=function(){return i.findPropertyByValue(this.NETWORK_STATE,this.networkState)},e._onMediaPlaying=function(e){var t=this.state;this._setState(E.PLAYING),this.emit(t===E.BUFFERING?m.STOP_BUFFERING:m.PLAY,e.data),this._debug("state is PLAYING")},e._onMediaBuffering=function(){this._setState(E.BUFFERING),this.emit(m.START_BUFFERING)},e.STATE=E,e.NETWORK_STATE=T,e.PAUSE_REASON=S,U}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(15)],n=function(a){return{create:function(e,o,t){function n(r){i[r.name]&&i[r.name].forEach(function(e){var t,n={};for(t in r)r.hasOwnProperty(t)&&(n[t]=r[t]);o.emit(e,n)})}var r,i={};return r=[],t.forEach(function(e){r.push({type:e.from,listener:n}),i[e.from]||(i[e.from]=[]),i[e.from].push(e.to)}),a.add({target:e,listeners:r}),{destroy:function(){a.remove({target:e,listeners:r}),i=r=null}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(16)],n=function(n){"use strict";function r(e,t){for(var n=0;n<t.length;++n)if("function"==typeof e[t[n]])return e[t[n]];return null}function e(e,t){(function(e){if(!e.target)throw new Error(n.NO_TARGET);if(!e.listeners||!e.listeners.length)throw new Error(n.NO_LISTENERS);if(!r(e.target,o)||!r(e.target,i))throw new Error(n.NOT_DISPATCHER);for(var t=0;t<e.listeners.length;++t)if(!e.listeners[t].type&&"string"!=typeof e.listeners[t].type||0!==e.listeners[t].type.length){if(!e.listeners[t].type)throw new Error(n.MISSING_TYPE.replace("%index%",t));if("function"!=typeof e.listeners[t].listener)throw new Error(n.MISSING_LISTENER.replace("%index%",t))}else e.listeners.splice(t,1),t--})(t),function(e,t,n){for(var r=0;r<n.length;++r)e.call(t,n[r].type,n[r].listener)}(r(t.target,e),t.target,t.listeners)}var o=["addEventListener","addListener","on"],i=["removeEventListener","removeListener","off"];return{add:e.bind(null,o),remove:e.bind(null,i)}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){return Object.freeze({NO_TARGET:"No target in config",NO_LISTENERS:"No listeners in config",NOT_DISPATCHER:"Target is not an event dispatcher",MISSING_TYPE:"Missing type in listener #%index%",MISSING_LISTENER:"Missing/invalid listener in listener #%index%"})}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return{CORE:"4.0.9"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return function(){function e(){var e,t=isNaN(n("debug"))?0:+n("debug"),e=(e="nanoDebug",+(-1!==document.cookie.indexOf(e+"=")?document.cookie.split(e+"=")[1].split(";")[0]:null));return Math.max(t,e)}function n(e){if(!u){u=[];var t,n=document.location.search.substr(1,document.location.search.length);if(""===n&&-1!==document.location.href.indexOf("?")&&(t=document.location.href.indexOf("?")+1,n=document.location.href.slice(t)),""!==n)for(var r=n.split("&"),o=0;o<r.length;++o){var i="",a=r[o].split("="),s=a[0];1<a.length&&(i=a[1]),u[decodeURIComponent(s)]=decodeURIComponent(i)}}try{return u[e]}catch(e){return}}var r=e(),u=void 0;setInterval(function(){r=e()},5e3);return{log:function(e,t){try{t<=r&&console.debug((new Date).toISOString()+": "+e)}catch(e){}},getHTTPParam:n}}()}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(11),n(20),n(21)],n=function(e,t,n){function o(e,t){for(var n in e)e.hasOwnProperty(n)&&(t[n]||(t[n]={}),"object"==typeof e[n]?o(e[n],t[n]):t[n]=e[n])}return{merge:function e(t,n){for(var r in t)t.hasOwnProperty(r)&&n.hasOwnProperty(r)&&("object"!=typeof t[r]||!Object.keys(t[r]).length||"object"==typeof n[r]&&Object.keys(n[r]).length?"object"==typeof t[r]?e(t[r],n[r]):n[r]=t[r]:o(t[r],n[r]))},clean:function e(t){for(var n in t)t.hasOwnProperty(n)&&(void 0===t[n]||"string"==typeof t[n]&&0===t[n].length)&&delete t[n],t.hasOwnProperty(n)&&t[n]instanceof Object&&e(t[n]);for(n in t)(t.hasOwnProperty(n)&&(void 0===t[n]||"string"==typeof t[n]&&0===t[n].length)||"object"==typeof t[n]&&"function"!=typeof t[n]&&0===Object.keys(t[n]).length)&&delete t[n]},check:function e(t,n,r,o){for(var i in r=r||"",o=o||[],t)t.hasOwnProperty(i)&&n.hasOwnProperty(i)&&("object"==typeof t[i]&&"object"==typeof n[i]?o=e(t[i],n[i],r+i+".",o):typeof t[i]!==n[i]&&"*"!==n[i]&&void 0!==t[i]&&""!==t[i]&&o.push("Configuration warning. The config property '$property$' must be of type '$type$'.".replace("$property$",r+i).replace("$type$",n[i]))),t.hasOwnProperty(i)&&!n.hasOwnProperty(i)&&o.push("Configuration warning. The config property '$property$' is not a valid property. Please remove from config.".replace("$property$",r+i));return o},extend:o}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){return Object.freeze({CONFIG_RTMP:"Configuration error. Could not create player, the rtmp configuration is missing or incomplete. Add an rtmp url and streamname to the configuration.",CONFIG_TOKEN:"Configuration error. Could not create player, with this configuration an security token is required. Add an token to the configuration.",CONFIG_WSS:"Configuration error. Could not create player, the websocket server configuration is missing.",CONFIG_HLS:"Configuration error. Could not create player, the hls server configuration is missing.",CONFIG_METADATA:"Configuration error. Could not create player, the websocket server configuration for metadata is missing.",CONFIG_SOURCE:"The players source configuration is malformed or missing, please check documentation for more information or contact us."})}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return Object.freeze({PLAYER:{NO_RTMP_URL_SET:1001,NO_SERVER_SET:1002,NOT_CONFIGURED:1003,NOT_PLAYING:1004,INTERACTION_REQUIRED:1005,BUFFER_CONFIG_INVALID:1006,PLAYBACK_SUSPENDED:1007,PLAYBACK_ERROR:1008,VISIBILITY_HIDDEN:1009},STREAM:{NOT_FOUND:2001,MEDIA_NOT_AVAILABLE:2002,NOT_ENOUGH_DATA:2003,SOURCE_STOPPED:2004,METADATA_STILL_PROCESSING:2014,METADATA_NO_START_INDEX:2013,METADATA_INVALID_JSON:2012,METADATA_WRONG_INDEX:2011},MEDIA:{ABORTED:3001,DOWNLOAD_ERROR:3002,DECODE_ERROR:3003,NOT_SUPPORTED:3004,MEDIA_SOURCE_ENDED:3100},NETWORK:{COULD_NOT_ESTABLISH_CONNECTION:4001,CONNECTION_ERROR:4002,MAX_RECONNECTS_REACHED:4003,RECONNECTION_CONFIG_INVALID:4004,UPDATE_SOURCE_STREAM_STOPPED:4005,UPDATE_SOURCE_TIMEOUT:4006},SETUP:{EXCEPTION:5001,CLIENT_NOT_SUPPORTED:5002,FORCE_NOT_SUPPORTED:5003,SOURCE_NOT_SUPPORTED:5004,CONFIG_RTMP:5005,CONFIG_TOKEN:5006,CONFIG_WSS:5007,CONFIG_HLS:5008,CONFIG_METADATA:5009,EMBED_PLAYER:5010}})}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var t=Object.prototype.toString;return{copy:function n(r){var e;if("object"==typeof r)if(null===r)e=null;else switch(t.call(r)){case"[object Array]":e=r.map(n);break;case"[object Date]":e=new Date(r);break;case"[object RegExp]":e=new RegExp(r);break;default:e=Object.keys(r).reduce(function(e,t){return e[t]=n(r[t]),e},{})}else e=r;return e},findPropertyByValue:function(e,t){if("object"==typeof e)for(var n in e)if(e[n]===t)return n;return!1}}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(11),n(20),n(24),n(21)],n=function(r,o,i,a){return{validateConfig:function(e,t){var n=t.source;if(!n||!n.h5live)return new r(o.CONFIG_SOURCE,a.SETUP.SOURCE_NOT_SUPPORTED);if(!((n=t.source.h5live).rtmp&&n.rtmp.url&&n.rtmp.streamname||n.params))return new r(o.CONFIG_RTMP,a.SETUP.CONFIG_RTMP);if(e===i.H5LIVE_WSS&&(!n.server||n.server&&!n.server.websocket))return new r(o.CONFIG_WSS,a.SETUP.CONFIG_WSS);if(e===i.H5LIVE_HLS){if(!n.server||n.server&&!n.server.hls)return new r(o.CONFIG_HLS,a.SETUP.CONFIG_HLS);if(t.playback&&t.playback.metadata&&!n.server.websocket)return new r(o.CONFIG_METADATA,a.SETUP.CONFIG_METADATA)}return!(n.server&&(n.server.websocket||n.server.hls)||n.token)&&new r(o.CONFIG_TOKEN,a.SETUP.CONFIG_TOKEN)},validatePlayerDivId:function(e){if(!("string"==typeof e||e instanceof String))throw new r('The param "playerDivId" must be of type "String".');var t=document.getElementById(e);if(!t)throw new r('The param "playerDivId" must be the id of an existing "div" element.');if("DIV"!==t.tagName)throw new r('The element with the id "'+e+'" is not a "div" element.');return!0}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){return Object.freeze({FLASH:"flash",NATIVE:"hls.native",H5LIVE_WSS:"h5live",H5LIVE_HLS:"h5live.hls"})}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(10),n(26)],n=function(e,t){var n,r=t.create("Conditions"),o=e.os,i=e.osVersion,a=e.browser,s=parseInt(e.browserVersion.split(".")[0],10),u=e.browserEngine,c="Microsoft Edge Trident"===a,d="Microsoft Internet Explorer"===a||c,E="Chromium"===u&&57<s,f="iOS"===o,l=f&&11<=s,p="Mac OS X"===o,T="Firefox"===a,m="Safari"===a,t=m&&12.1===parseFloat(e.browserVersion)&&"iOS"!==o,u=f&&10<=parseInt(i),e=t,o="iOS"!==o&&!!window.MediaSource&&(T&&48<=s||c||window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),c=function(){var e=!1;try{(("Chrome"===a||"Chromium"===a)&&s<54||"Firefox"===a&&s<48||"Microsoft Internet Explorer"===a&&(s<11||11===s&&7===parseInt(i))||"Safari"===a&&s<10)&&(e=!0)}catch(e){}return e}(),A={mustUseHLS:u=!u&&!o&&p&&m&&10<=s?!0:u,canUseHLS:e,isTridentBrowser:d,useFakeAudio:E,hasMediaSource:o,isIOS:f,isIOS11:l,isFirefox:T,isSafari:m,isSafari121MacOSX:t,isH5LiveKnownUnsupported:c};for(n in A)A.hasOwnProperty(n)&&r.debug(n+": "+A[n]);return A}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(18)],n=function(r){function t(e,t,n){r.log("["+t+"] "+n,e)}return{create:function(e){return{debug:t.bind(this,3,e),info:t.bind(this,2,e),warn:t.bind(this,1,e),error:t.bind(this,0,e),detail:t.bind(this,4,e)}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){return Object.freeze({UNINITIALIZED:1,CONNECTING:2,OPEN:3,CLOSING:4,CLOSED:5})}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(15),n(7),n(29),n(30),n(31),n(32),n(26)],n=function(t,r,e,n,o,i,a){return{create:function(n){var e=(a.create("StateMachine"),[{type:o.STATE_CHANGE,listener:function(e){var t;e.data.state,t=r.STATE_CHANGE,e=e.data,n.emit(t,e)}}]);return t.add({target:n,listeners:e}),{destroy:function(){t.remove({target:n,listeners:e})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){var e="control.";return{BASE:e,CONNECT:e+"connect",DISCONNECT:e+"disconnect",NETWORK_PLAY:e+"networkPlay",NETWORK_PAUSE:e+"networkPause",PLAY:e+"play",PAUSE:e+"pause",MUTE:e+"mute",UNMUTE:e+"unmute",SET_VOLUME:e+"setVolume",SEEK:e+"seek",SET_RATE:e+"playbackRate",CONFIG:e+"config",CREATE_VIDEO:e+"createVideo",DESTROY_VIDEO:e+"destroyVideo",VIDEO_SOURCE:e+"videoSource",UPDATE_SOURCE:e+"updateSource",NETWORK_UPDATE_SOURCE:e+"networkUpdateSource"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="media.";return{BASE:e,LOAD_START:e+"loadstart",PROGRESS:e+"progress",SUSPEND:e+"suspend",ABORT:e+"abort",EMPTIED:e+"emptied",STALLED:e+"stalled",PLAY:e+"play",PAUSE:e+"pause",LOADED_META_DATA:e+"loadedmetadata",LOADED_DATA:e+"loadeddata",WAITING:e+"waiting",ERROR:e+"error",PLAYING:e+"playing",CAN_PLAY:e+"canplay",CAN_PLAY_THROUGH:e+"canplaythrough",SEEKING:e+"seeking",SEEKED:e+"seeked",TIME_UPDATE:e+"timeupdate",ENDED:e+"ended",RATE_CHANGE:e+"ratechange",DURATION_CHANGE:e+"durationchange",VOLUME_CHANGE:e+"volumechange",ELEMENT_CREATED:e+"elementCreated",QUALITY_STATS:e+"qualitystats",PLAY_STATS:e+"playStats",FRAME_DROP:e+"framedrop",PLAYBACK_FINISHED:e+"playbackFinished",PLAYBACK_ERROR:e+"playbackError",PLAYBACK_STARTED:e+"playbackStarted",PLAYBACK_SUSPENDED:e+"playbackSuspended",BUFFERING:e+"buffering",PLAY_START_SUCCESS:e+"playStartSuccess",PLAY_START_ERROR:e+"playStartError",BUFFER_TWEAKS_CREATED:e+"bufferTweaksCreated",BUFFER_TWEAKS_ERROR:e+"bufferTweaksError",VIEWPORT_VISIBLE:e+"viewportvisible",VIEWPORT_HIDDEN:e+"viewporthidden"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="logic.";return{BASE:e,STATE_CHANGE:e+"stateChange",LOADING_TIMEOUT:e+"loadingTimeout",BUFFERING_TIMEOUT:e+"bufferingTimeout",STREAM_INFO:e+"streamInfo",STREAM_INFO_UPDATE:e+"streamInfoUpdate",SERVER_INFO:e+"serverInfo",STREAM_URL:e+"streamUrl",NO_KEEP_CONNECTION:e+"noKeepConnection",MIME_TYPE_UNSUPPORTED:e+"mimeTypeUnsupported",META_DATA_RECEIVED:e+"metaDataReceived",META_DATA_ERROR:e+"metaDataError",NO_SERVER_ERROR:e+"noServerError",MISSING_RTMP_ERROR:e+"missingRtmpError",STARTUP_STATS:e+"startupStats",DOCUMENT_VISIBLE:e+"documentVisible",DOCUMENT_HIDDEN:e+"documentHidden",ERROR:e+"error",UPDATE_SOURCE_INIT:e+"updateSourceInit",UPDATE_SOURCE_SUCCESS:e+"updateSourceSuccess",UPDATE_SOURCE_FAIL:e+"updateSourceFail",UPDATE_SOURCE_ABORT:e+"updateSourceAbort"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="network.";return{BASE:e,CONNECTING:e+"connecting",CONNECTED:e+"connected",DISCONNECTED:e+"disconnected",RESUMING:e+"resuming",RECONNECTION_IMMINENT:e+"reconnectionImminent",RECONNECTING:e+"reconnecting",RECONNECTION_CONFIG_INVALID:e+"reconnectionConfigInvalid",CONNECTION_ERROR:e+"connectionError",INITIALIZATION_ERROR:e+"initializationError",ERROR:e+"error",WARNING:e+"warning",DESTROYED:e+"destroyed",STATE_CHANGE:e+"stateChange",META_DATA:e+"metaData",SERVER_INFO:e+"serverInfo",STREAM_INFO:e+"streamInfo",STREAM_INFO_UPDATE:e+"streamInfoUpdate",STREAM_FRAGMENT:e+"streamFragment",RANDOM_ACCESS_POINT:e+"randomAccessPoint",RAW_PACKET:e+"raw",STREAM_STATUS:e+"streamStatus",UPDATE_SOURCE_SUCCESS:e+"updateSourceSuccess",UPDATE_SOURCE_FAIL:e+"updateSourceFail",UPDATE_SOURCE_ABORT:e+"updateSourceAbort"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(15),n(21),n(7),n(29),n(30),n(31),n(32),n(26)],n=function(c,d,E,e,f,l,p,T){return{create:function(n){function r(e,t){n.emit(e,t)}function t(t){var n,r;u.forEach(function(e){e.event===t.name&&(n=e.code||t.data.code,r=e.message||t.data.reason,e.defer?setTimeout(o.bind(this,n,r),0):o(n,r))})}function o(e,t){r(E.ERROR,{code:e,message:t})}var i,a=(T.create("FacadePropagator"),1),s=!1,e=[{type:f.VOLUME_CHANGE,listener:function(e){e.data.muted!==s?r((s=e.data.muted)?E.MUTE:E.UNMUTE,{volume:a}):e.data.volume!==a&&(a=e.data.volume,r(E.VOLUME_CHANGE,{volume:a}))}},{type:f.QUALITY_STATS,listener:function(e){(i=i||{}).quality=e.data}},{type:f.PLAY_STATS,listener:function(e){i&&i.quality&&(n=i.quality),i=e.data.stats,n&&!i.quality&&(i.quality=n);var t,n="stats error";try{n=JSON.stringify(i),delete(t=JSON.parse(n)).buffer.update,delete t.buffer.delay.before}catch(e){}r(E.STATS,{stats:t})}},{type:f.PLAYBACK_FINISHED,listener:function(e){r(E.PLAYBACK_FINISHED)}},{type:l.META_DATA_RECEIVED,listener:function(e){setTimeout(r.bind(this,E.METADATA,e.data),0)}},{type:l.UPDATE_SOURCE_INIT,listener:function(e){setTimeout(r.bind(this,E.UPDATE_SOURCE_INIT,e.data),0)}},{type:l.UPDATE_SOURCE_SUCCESS,listener:function(e){setTimeout(r.bind(this,E.UPDATE_SOURCE_SUCCESS,e.data),0)}},{type:l.UPDATE_SOURCE_FAIL,listener:function(e){setTimeout(r.bind(this,E.UPDATE_SOURCE_FAIL,e.data),0)}},{type:l.UPDATE_SOURCE_ABORT,listener:function(e){setTimeout(r.bind(this,E.UPDATE_SOURCE_ABORT,e.data),0)}}],u=[{event:l.META_DATA_ERROR,code:null,message:null,defer:!0},{event:l.MISSING_RTMP_ERROR,code:d.PLAYER.NO_RTMP_URL_SET,message:"No rtmp url set.",defer:!1},{event:l.NO_SERVER_ERROR,code:d.PLAYER.NO_SERVER_SET,message:"No server set.",defer:!1},{event:p.RECONNECTION_CONFIG_INVALID,code:d.NETWORK.RECONNECTION_CONFIG_INVALID,message:null,defer:!0},{event:f.BUFFER_TWEAKS_ERROR,code:d.PLAYER.BUFFER_CONFIG_INVALID,message:null,defer:!1}];return c.add({target:n,listeners:e}),u.forEach(function(e){n.addListener(e.event,t)}),{destroy:function(){c.remove({target:n,listeners:e}),u.forEach(function(e){n.removeListener(e.event,t)})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(35),n(26),n(25),n(15),n(8),n(29),n(30),n(32),n(31)],n=function(m,e,A,_,S,h,R,O,g){var N="nano",y=[],I=y[0]="connecting",v=(y[1]="connected",y[2]="firstFragmentReceived"),C=y[3]="firstFrameRendered",b=y[4]="playable",D=y[5]="playing",P=e.create("Performance");return{create:function(n,r){function e(e){var t=[N,r,e].join(".");m&&"function"==typeof m.mark&&-1===d.indexOf(t)&&(m.mark(t),d.push(t)),E[e]||e===D&&(e!==D||-1===[v,C,b].indexOf(f))||(E[f=e]=m.now(),P.debug(e+": "+E[e]),e===D&&function(){if(y.forEach(function(e,t){if(void 0===E[e]){E[e]=0;for(var n=t+1,r=y.length;n<r;n+=1)if(void 0!==E[y[n]]){E[e]=E[y[n]];break}}}),y.filter(function(e){return void 0!==E[e]}).length){var e,t=E[I];for(e in E)E.hasOwnProperty(e)&&(E[e]=Math.round(E[e]-t));n.emit(g.STARTUP_STATS,{stats:E}),P.debug("startup stats: "+JSON.stringify(E))}}())}function t(){e(I)}function o(){e("connected")}function i(){e(b)}function a(){e(D)}function s(){e(v)}function u(){e(C)}var c,d=[],E={},f=null,l=[{type:g.STATE_CHANGE,listener:function(e){e.data.state===S.PAUSED&&(E={},f=null)}},{type:h.CONFIG,listener:function(e){c=A.mustUseHLS||e.data.config.playback.allowSafariHlsFallback&&A.canUseHLS,_.add({target:n,listeners:c?T:p})}}],p=[{type:O.CONNECTING,listener:t},{type:O.CONNECTED,listener:o},{type:O.STREAM_FRAGMENT,listener:s},{type:R.LOADED_DATA,listener:u},{type:R.CAN_PLAY_THROUGH,listener:i},{type:R.PLAYING,listener:a}],T=[{type:R.PLAY,listener:t},{type:R.DURATION_CHANGE,listener:o},{type:R.LOADED_META_DATA,listener:s},{type:R.LOADED_DATA,listener:u},{type:R.CAN_PLAY_THROUGH,listener:i},{type:R.PLAYING,listener:a}];return _.add({target:n,listeners:l}),{destroy:function(){_.remove({target:n,listeners:l}),_.remove({target:n,listeners:c?T:p})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){function t(e,t){for(var n=0,r=i.length,o=[];n<r;n++)i[n][e]===t&&o.push(i[n]);return o}function n(e,t){for(var n,r=i.length;r--;)(n=i[r]).entryType!==e||void 0!==t&&n.name!==t||i.splice(r,1)}var e=Date.now?Date.now():+new Date,r=window.performance||{},i=[],o={};return r.now||(r.now=r.webkitNow||r.mozNow||r.msNow||function(){return(Date.now?Date.now():+new Date)-e}),r.mark||(r.mark=r.webkitMark||function(e){var t={name:e,entryType:"mark",startTime:r.now(),duration:0};i.push(t),o[e]=t}),r.measure||(r.measure=r.webkitMeasure||function(e,t,n){t=o[t].startTime,n=o[n].startTime,i.push({name:e,entryType:"measure",startTime:t,duration:n-t})}),r.getEntriesByType||(r.getEntriesByType=r.webkitGetEntriesByType||function(e){return t("entryType",e)}),r.getEntriesByName||(r.getEntriesByName=r.webkitGetEntriesByName||function(e){return t("name",e)}),r.clearMarks||(r.clearMarks=r.webkitClearMarks||function(e){n("mark",e)}),r.clearMeasures||(r.clearMeasures=r.webkitClearMeasures||function(e){n("measure",e)}),void 0===window.performance&&(window.performance=r),window.performance}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(15),n(21),n(37),n(7),n(8),n(29),n(30),n(31),n(32),n(26),n(10)],n=function(u,c,d,e,E,t,f,l,p,T,n){return{create:function(r){function t(e,t){var n;n=l.ERROR,t={code:c[e][t],message:d[e][t]},r.emit(n,t)}function e(e){e.name===l.DOCUMENT_HIDDEN?i=!0:(i&&(a=!0),i=!1,setTimeout(function(e){a=!1},1e3))}var n,o,i,a,s=(T.create("ErrorSelector"),[{type:l.STATE_CHANGE,listener:function(e){e.data.state===E.LOADING&&(o=!1,n=null)}},{type:l.LOADING_TIMEOUT,listener:function(e){t("STREAM",o?"NOT_ENOUGH_DATA":n&&"stopped"===n?"SOURCE_STOPPED":"NOT_FOUND")}},{type:l.BUFFERING_TIMEOUT,listener:function(e){t("STREAM",n&&"stopped"===n?"SOURCE_STOPPED":"MEDIA_NOT_AVAILABLE")}},{type:l.STREAM_INFO,listener:function(e){o=!0}},{type:l.DOCUMENT_VISIBLE,listener:e},{type:l.DOCUMENT_HIDDEN,listener:e},{type:f.PLAYBACK_FINISHED,listener:function(e){i||a?t("PLAYER","VISIBILITY_HIDDEN"):t("MEDIA","MEDIA_SOURCE_ENDED")}},{type:p.STREAM_STATUS,listener:function(e){n=e.data.onStreamStatus.status}}]);return u.add({target:r,listeners:s}),{destroy:function(){u.remove({target:r,listeners:s})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){return Object.freeze({PLAYER:{VISIBILITY_HIDDEN:"Playback failed because the player was in visibility state 'hidden' at load start."},STREAM:{NOT_FOUND:"The requested stream can not be found.",MEDIA_NOT_AVAILABLE:"No media available.",NOT_ENOUGH_DATA:"Not enough media data received.",SOURCE_STOPPED:"The source stream has been stopped."},MEDIA:{MEDIA_SOURCE_ENDED:"The media source extension changed the state to 'ended'."},NETWORK:{UPDATE_SOURCE_STREAM_STOPPED:"The requested source stream in the 'updateSource' call has been stopped.",UPDATE_SOURCE_TIMEOUT:"The update source request was aborted by timeout."}})}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(26),n(4),n(25),n(15),n(14),n(40),n(29),n(31),n(30),n(32),n(41),n(42),n(39),n(43),n(44),n(45),n(46),n(47),n(49),n(50),n(51),n(53),n(54),n(55)],n=function(c,d,E,f,l,p,T,m,A,_,S,h,R,O,g,N,y,I,v,C,b,D,P,U){"use strict";return{create:function(e){var t,n,r=new d,o=c.create("LogicManager"),i=[],a=[{from:S.SEEK,to:T.SEEK},{from:S.RATE,to:T.SET_RATE},{from:h.CONNECT,to:T.CONNECT},{from:h.DISCONNECT,to:T.DISCONNECT},{from:h.VIDEO_SOURCE,to:T.VIDEO_SOURCE},{from:h.NETWORK_PLAY,to:T.NETWORK_PLAY},{from:h.NETWORK_UPDATE_SOURCE,to:T.NETWORK_UPDATE_SOURCE},{from:h.NO_SERVER_ERROR,to:m.NO_SERVER_ERROR},{from:h.MISSING_RTMP_ERROR,to:m.MISSING_RTMP_ERROR},{from:h.NO_KEEP_CONNECTION,to:m.NO_KEEP_CONNECTION},{from:h.SERVER_INFO,to:m.SERVER_INFO},{from:h.URL,to:m.STREAM_URL},{from:h.UPDATE_SOURCE_INIT,to:m.UPDATE_SOURCE_INIT},{from:h.UPDATE_SOURCE_SUCCESS,to:m.UPDATE_SOURCE_SUCCESS},{from:h.UPDATE_SOURCE_FAIL,to:m.UPDATE_SOURCE_FAIL},{from:h.UPDATE_SOURCE_ABORT,to:m.UPDATE_SOURCE_ABORT},{from:O.LOADING_TIMEOUT,to:m.LOADING_TIMEOUT},{from:O.BUFFERING_TIMEOUT,to:m.BUFFERING_TIMEOUT},{from:g.CREATED,to:m.STREAM_INFO},{from:g.UPDATED,to:m.STREAM_INFO_UPDATE},{from:g.MIME_TYPE_UNSUPPORTED,to:m.MIME_TYPE_UNSUPPORTED},{from:N.RECEIVED,to:m.META_DATA_RECEIVED},{from:N.ERROR,to:m.META_DATA_ERROR},{from:y.VISIBLE,to:m.DOCUMENT_VISIBLE},{from:y.HIDDEN,to:m.DOCUMENT_HIDDEN}],s=[{from:p.PLAY,to:R.API_PLAY},{from:p.PAUSE,to:R.API_PAUSE},{from:A.BUFFER_TWEAKS_CREATED,to:R.BUFFER_TWEAKS_CREATED},{from:A.PLAY_STATS,to:R.PLAY_STATS},{from:A.PLAYBACK_STARTED,to:R.PLAYING},{from:A.BUFFERING,to:R.BUFFERING},{from:A.CAN_PLAY,to:R.CAN_PLAY},{from:A.FRAME_DROP,to:R.FRAME_DROP},{from:A.VIEWPORT_VISIBLE,to:R.VIEWPORT_VISIBLE},{from:A.VIEWPORT_HIDDEN,to:R.VIEWPORT_HIDDEN},{from:_.CONNECTING,to:R.NETWORK_CONNECTING},{from:_.CONNECTED,to:R.NETWORK_CONNECTED},{from:_.DISCONNECTED,to:R.NETWORK_DISCONNECTED},{from:_.DESTROYED,to:R.NETWORK_DISCONNECTED},{from:_.RECONNECTING,to:R.NETWORK_RECONNECTING},{from:_.RECONNECTION_IMMINENT,to:R.NETWORK_RECONNECTION_IMMINENT},{from:_.INITIALIZATION_ERROR,to:R.NETWORK_INITIALIZATION_ERROR},{from:_.ERROR,to:R.NETWORK_ERROR},{from:_.STATE_CHANGE,to:R.NETWORK_STATE_CHANGE},{from:_.RANDOM_ACCESS_POINT,to:R.RANDOM_ACCESS_POINT},{from:_.SERVER_INFO,to:R.SERVER_INFO},{from:_.STREAM_INFO,to:R.STREAM_INFO},{from:_.STREAM_INFO_UPDATE,to:R.STREAM_INFO_UPDATE},{from:_.META_DATA,to:R.META_DATA},{from:_.UPDATE_SOURCE_SUCCESS,to:R.UPDATE_SOURCE_SUCCESS},{from:_.UPDATE_SOURCE_FAIL,to:R.UPDATE_SOURCE_FAIL},{from:_.UPDATE_SOURCE_ABORT,to:R.UPDATE_SOURCE_ABORT},{from:m.STATE_CHANGE,to:R.APPLICATION_STATE_CHANGE},{from:m.STREAM_URL,to:R.STREAM_URL},{from:T.CONFIG,to:R.CONFIG},{from:T.UPDATE_SOURCE,to:R.UPDATE_SOURCE}],u=[{type:R.CONFIG,listener:function(e){i.push((E.mustUseHLS||e.data.config.playback.allowSafariHlsFallback&&E.canUseHLS?C:v).create(r)),e.data.config.playback.metadata&&i.push(P.create(r))}}];return o.debug("init"),t=l.create(e,r,s),n=l.create(r,e,a),f.add({target:r,listeners:u}),i.push(I.create(r)),i.push(D.create(r)),i.push(b.create(r)),i.push(U.create(r)),{destroy:function(){for(t.destroy(),t=null,n.destroy(),n=null;i.length;)i.pop().destroy();f.remove({target:r,listeners:u})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){var e="logicManager.";return{BASE:e,API_PLAY:e+"apiPlay",API_PAUSE:e+"apiPause",NETWORK_CONNECTING:e+"networkConnecting",NETWORK_CONNECTED:e+"networkConnected",NETWORK_DISCONNECTED:e+"networkDisconnected",NETWORK_RECONNECTION_IMMINENT:e+"networkReconnectionImminent",NETWORK_RECONNECTING:e+"networkReconnecting",NETWORK_CONNECTION_ERROR:e+"networkConnectionError",NETWORK_INITIALIZATION_ERROR:e+"networkInitializationError",NETWORK_MAX_RETRY_REACHED:e+"networkMaxRetryReached",NETWORK_ERROR:e+"networkError",NETWORK_STATE_CHANGE:e+"networkStateChange",SERVER_INFO:e+"serverInfo",STREAM_INFO:e+"streamInfo",STREAM_INFO_UPDATE:e+"streamInfoUpdate",STREAM_FRAGMENT:e+"streamFragment",RANDOM_ACCESS_POINT:e+"randomAccessPoint",STREAM_URL:e+"streamUrl",CONFIG:e+"config",BUFFER_TWEAKS_CREATED:e+"tweaksCreated",PLAYING:e+"playing",BUFFERING:e+"buffering",PLAY_STATS:e+"playStats",APPLICATION_STATE_CHANGE:e+"applicationStateChange",CAN_PLAY:e+"canPlay",META_DATA:e+"metaData",UPDATE_SOURCE:e+"updateSource",FRAME_DROP:e+"frameDrop",VIEWPORT_VISIBLE:e+"viewportvisible",VIEWPORT_HIDDEN:e+"viewporthidden",UPDATE_SOURCE_SUCCESS:e+"updateSourceSuccess",UPDATE_SOURCE_FAIL:e+"updateSourceFail",UPDATE_SOURCE_ABORT:e+"updateSourceAbort"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return{PLAY:"api.play",PAUSE:"api.pause"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="liveBufferControl.";return{BASE:e,SEEK:e+"seek",RATE:e+"rate"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="connection.";return{BASE:e,CONNECT:e+"connect",DISCONNECT:e+"disconnect",VIDEO_SOURCE:e+"videoSource",NETWORK_PLAY:e+"networkPlay",NO_SERVER_ERROR:e+"noServerError",MISSING_RTMP_ERROR:e+"missingRtmpError",SERVER_INFO:e+"serverInfo",NO_KEEP_CONNECTION:e+"noKeepConnection",URL:e+"url",NETWORK_UPDATE_SOURCE:e+"networkUpdateSource",UPDATE_SOURCE_INIT:e+"updateSourceInit",UPDATE_SOURCE_SUCCESS:e+"updateSourceSuccess",UPDATE_SOURCE_FAIL:e+"updateSourceFail",UPDATE_SOURCE_ABORT:e+"updateSourceAbort"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="timeout.";return{BASE:e,LOADING_TIMEOUT:e+"loadingTimeout",BUFFERING_TIMEOUT:e+"bufferingTimeout"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="streamInfo.";return{BASE:e,CREATED:e+"created",UPDATED:e+"updated",MIME_TYPE_UNSUPPORTED:e+"mimetypeUnsupported"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="metaData.";return{BASE:e,RECEIVED:e+"received",ERROR:e+"error"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="visibility.";return{BASE:e,HIDDEN:e+"hidden",VISIBLE:e+"visible"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(26),n(25),n(11),n(22),n(15),n(42),n(39),n(27),n(8),n(2),n(48)],n=function(I,v,C,e,b,D,P,U,L,w,M){return{create:function(E){function t(e){1<m.length&&m.shift(),E.emit(D.UPDATE_SOURCE_SUCCESS,{tag:e.data.tag,count:e.data.count}),g=!1}function n(e){1<m.length&&m.pop(),E.emit(D.UPDATE_SOURCE_FAIL,{tag:e.data.tag,count:e.data.count,code:e.data.code,message:e.data.message}),g=!1}function r(e){var t,n,r=e?m.length-1:0;!S&&!m[r].security&&R||((O?u:s)("paused"),(S&&R?s:u)("metastreamonly"),(!S&&m[r].security&&R?s:u)("checkandclose"),t=a("websocket",r),n=e?D.NETWORK_UPDATE_SOURCE:D.CONNECT,T.debug("connect to: "+t,1),E.emit(n,{url:t,config:m[r],update:!!e&&e,reconnect:l.playback.reconnect,timeouts:l.playback.timeouts}),R||E.emit(D.URL,{url:t}))}function o(e){T.debug("disconnecting"),E.emit(D.DISCONNECT,{silent:!!e})}function i(e){T.debug("set connection config",3);var t,n=new f,r=e.server,o=e.rtmp,i=e.params,a=e.token,s=e.security;if("object"==typeof r){for(var u=["websocket","hls","progressive"],c=0;c<u.length;c++)r[u[c]]&&"string"==typeof r[u[c]]&&0!==r[u[c]].length&&(n.server[u[c]]=r[u[c]]);T.debug("set connection server: "+JSON.stringify(n.server),3)}if(n.server.websocket.length||n.server.hls.length||E.emit(D.NO_SERVER_ERROR),"object"==typeof o&&o.url&&o.url.length&&o.streamname&&o.streamname.length||i)for(d in o)o.hasOwnProperty(d)&&(t=d.replace("name",""),n.query.hasOwnProperty(t)&&(n.query[t]=o[d],T.debug("set connection config rtmp: "+t+":"+n.query[t])));else E.emit(D.MISSING_RTMP_ERROR);if(a&&n.query.hasOwnProperty("token")&&(n.query.token=a,T.debug("set connection config token: "+n.query.token)),"object"==typeof i)for(d in i)i.hasOwnProperty(d)&&(n.query[d]=i[d],T.debug("set connection param: "+d+":"+n.query[d]));if(s)for(var d in n.security={},T.debug("set security config",3),s)s.hasOwnProperty(d)&&s[d].length&&(n.security[d]=s[d],T.debug("set security config "+d+": "+n.security[d]));m.push(n)}function a(e,t){var n,r="?",o=-1<t&&(m[t],1)?t:m.length-1,t=m[o].server,i=m[o].query,a=m[o].security,e=t[e];for(n in i)i.hasOwnProperty(n)&&("cid"===n&&(i[n]=Math.round(1e6*Math.random()).toString()),"pid"!==n||i[n].length||(i[n]=d),i[n].length&&(r+=n+"="+encodeURIComponent(i[n])+"&"));for(n in a)a.hasOwnProperty(n)&&a[n].length&&(r+=n+"="+encodeURIComponent(a[n])+"&");for(var s="",o=0,u=A.length;o<u;o+=1)s+=A[o],o===u-1?r+="&flags="+encodeURIComponent(s):s+=",";return e+(r=r.lastIndexOf("&")===r.length-1?r.substr(0,r.length-1):r)}function s(e){-1===A.indexOf(e)&&A.push(e)}function u(t){A=A.filter(function(e){return e!==t})}function c(e){for(var t in U)if(U.hasOwnProperty(t)&&U[t]===e)return t}function f(){return{server:{websocket:"",hls:"",progressive:""},query:{url:"",stream:"",cid:"",pid:"",token:""},security:null}}var d,l,p,T=I.create("Connection"),m=[],A=[],_=U.UNITIALIZED,S=!1,h=!1,R=!1,O=!0,g=!1,N=!1,y=0,e=[{type:P.NETWORK_STATE_CHANGE,listener:function(e){T.debug(e.name+": network state change from "+c(_)+" to "+c(e.data.connectionState)),_=e.data.connectionState}},{type:P.SERVER_INFO,listener:function(e){var t,n,r;p=e.data.onServerInfo,h&&(t=p.capabilities,n=p.serverVersion,r=parseFloat(n),-1===t.indexOf("onPlay")&&-1===t.indexOf("onPause")&&(h=!1,E.emit(D.NO_KEEP_CONNECTION,{message:r<1.8?"The keepConnection feature is enabled by the players config, but is not supported by this server version ("+n+"). Use at least server version 1.8.0.0. The feature will be disabled.":"The keepConnection feature is enabled by the players config, but is not enabled by this server ("+n+"). The feature will be disabled."}),O||o())),E.emit(D.SERVER_INFO,e.data)}},{type:P.STREAM_INFO,listener:function(e){}},{type:P.UPDATE_SOURCE_SUCCESS,listener:t},{type:P.UPDATE_SOURCE_FAIL,listener:n},{type:P.UPDATE_SOURCE_ABORT,listener:function(e){1<m.length&&m.pop(),E.emit(D.UPDATE_SOURCE_ABORT,{tag:e.data.tag,count:e.data.count,reason:e.data.reason}),g=!1}},{type:P.CONFIG,listener:function(e){i((l=e.data.config).source.h5live),d=l.id,S=l.playback.metadata,h=l.playback.keepConnection,O=l.playback.autoplay,R=v.mustUseHLS||l.playback.allowSafariHlsFallback&&v.canUseHLS,h&&r()}},{type:P.UPDATE_SOURCE,listener:function(e){var t=e.data.source,n=e.data.options;if(y+=1,n.tag=n.tag||"",n.count=y,E.emit(D.UPDATE_SOURCE_INIT,{source:t,options:n,tag:n.tag,count:n.count}),N)throw E.emit(D.UPDATE_SOURCE_ABORT,{source:t,reason:"updatefrequency",tag:n.tag,count:n.count}),new C("The 'updateSource' function was called to close to the last call. The call is aborted.");N=!0,setTimeout(function(){N=!1},500),g=e.data,T.debug("update source: "+JSON.stringify(t)),1<m.length&&m.pop(),i(t.h5live),h&&!O?(T.debug("connect to new source with terminating the old one"),o(!0),m.shift(),r()):O?(T.debug("connect to new source without terminating the old one"),r(e.data)):(m.shift(),T.debug("replaced source"))}},{type:P.API_PLAY,listener:function(){var e;T.debug("api play"),O=!0,h?(T.debug("send network play"),E.emit(D.NETWORK_PLAY)):r(g&&g.options.forcePlay?g:void 0),R&&(e=a("hls"),E.emit(D.VIDEO_SOURCE,{src:e,type:M.HLS}),E.emit(D.URL,{url:e}))}},{type:P.API_PAUSE,listener:function(){T.debug("api pause"),O=!1,h&&!g||o(),R&&E.emit(D.VIDEO_SOURCE,{src:"",type:M.HLS})}},{type:P.APPLICATION_STATE_CHANGE,listener:function(e){switch(e.data.state){case L.PAUSED:g&&R&&-1===[w.NORMAL,w.PLAYBACK_RESTART].indexOf(e.data.reason)&&n({data:{tag:g.options.tag,count:g.options.count}});break;case L.PLAYING:g&&R&&t({data:{tag:g.options.tag,count:g.options.count}})}}}];return T.debug("init"),b.add({target:E,listeners:e}),{destroy:function(){b.remove({target:E,listeners:e})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){return Object.freeze({MP4:"video/mp4",MP4_MS:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',HLS:"application/vnd.apple.mpegURL"})}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(26),n(25),n(15),n(41),n(39),n(8)],n=function(A,_,S,h,R,O){return{create:function(t){function e(e){l=e.name!==R.VIEWPORT_VISIBLE,s.debug("viewport changed to "+(l?"hidden":"visible"))}function n(e){f!==e&&(s.debug("set rate to "+e),t.emit(h.RATE,{rate:e}))}function r(e){e=E-e;_.isTridentBrowser&&(e=function(e,t){for(var n=0;n<d.length;++n)if(d[n]>e&&d[n]<=t)return d[n];return-1}(c,e))<0||o(e)}function o(e){s.debug("seeking to "+e),t.emit(h.SEEK,{position:e})}var i,a,s=A.create("WSSLiveController"),u={},c=0,d=[],E=0,f=1,l=!1,p=[{type:R.APPLICATION_STATE_CHANGE,listener:function(e){S.remove({target:t,listeners:m}),(i=e.data.state)===O.PLAYING&&S.add({target:t,listeners:m})}},{type:R.BUFFER_TWEAKS_CREATED,listener:function(e){u.buffer=e.data.tweaks.buffer}},{type:R.RANDOM_ACCESS_POINT,listener:function(e){for(d.push(e.data.onRandomAccessPoint.streamTime/1e3);10<d.length;)d.shift()}},{type:R.FRAME_DROP,listener:function(e){_.isTridentBrowser&&"extreme"===e.data.type&&!l&&i===O.PLAYING&&(s.debug("visible and extreme frame drop detected (edge)"),s.debug("try seeking to last RAP to get stable playback"),o(d.length?d[d.length-1]:0))}}],T=[{type:R.VIEWPORT_VISIBLE,listener:e},{type:R.VIEWPORT_HIDDEN,listener:e}],m=[{type:R.PLAY_STATS,listener:function(e){a=e.data.stats,f=e.data.playbackRate,c=e.data.currentTime,e.data.buffered&&e.data.buffered.length&&(E=a.buffer.end>E+.1?a.buffer.end:E,u.buffer.max<a.buffer.delay.current&&a.buffer.start<c&&a.buffer.end-a.buffer.start>u.buffer.target?(s.debug("tweaks.buffer.max ("+u.buffer.max+") < stats.buffer.delay.current ("+a.buffer.delay.current+") && stats.buffer.start ("+a.buffer.start+") < currentTime ("+c+") && stats.buffer.end ("+a.buffer.end+") > tweaks.buffer.target ("+u.buffer.target+")"),r(u.buffer.target)):u.buffer.limit<a.buffer.delay.current?_.isTridentBrowser?r(u.buffer.target):n(1.1):u.buffer.target>a.buffer.delay.current&&n(1))}}];return s.debug("init"),S.add({target:t,listeners:p}),_.isTridentBrowser&&S.add({target:t,listeners:T}),{destroy:function(){S.remove({target:t,listeners:p}),_.isTridentBrowser&&S.remove({target:t,listeners:T})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(26),n(25),n(15),n(41),n(39),n(8)],n=function(c,e,d,E,f,l){return{create:function(t){function n(e){s!==e&&(o.debug("set rate to: "+e),t.emit(E.RATE,{rate:e}))}var r,o=c.create("HLSLiveController"),i=!0,a={buffer:{max:8,min:.2,start:.5,target:1.2,limit:1.7}},s=1,e=[{type:f.APPLICATION_STATE_CHANGE,listener:function(e){d.remove({target:t,listeners:u}),e.data.state===l.PLAYING&&d.add({target:t,listeners:u})}},{type:f.BUFFER_TWEAKS_CREATED,listener:function(e){for(var t in e.data.tweaks.buffer)e.data.tweaks.buffer[t]!==a.buffer[t]&&(i=!1);i||(a.buffer=e.data.tweaks.buffer)}}],u=[{type:f.PLAY_STATS,listener:function(e){r=e.data.stats,s=e.data.playbackRate,e.data.buffered&&e.data.buffered.length&&(i?0<r.buffer.update.avg&&r.buffer.update.avg+a.buffer.limit-.7<r.buffer.delay.avg?n(1.1):0<r.buffer.update.avg&&r.buffer.update.avg+a.buffer.min<r.buffer.delay.avg<=r.buffer.update.avg+a.buffer.target-.7?n(1):0<=r.buffer.update.avg&&r.buffer.update.avg>=r.buffer.delay.avg&&n(.9):a.buffer.limit<r.buffer.delay.avg?n(1.1):a.buffer.start<r.buffer.delay.avg<=a.buffer.target?n(1):a.buffer.min>=r.buffer.delay.avg&&n(.9))}}];return o.debug("init"),d.add({target:t,listeners:e}),{destroy:function(){d.remove({target:t,listeners:e})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(26),n(25),n(15),n(39),n(44),n(8),n(52),n(48)],n=function(o,i,d,E,f,l,p,T){return{create:function(a){function t(e,t){s=t.data.onStreamInfo,c.debug(JSON.stringify(s));t=s&&s.mimeType?s.mimeType:T.MP4_MS;if(window.MediaSource.isTypeSupported(t)){var n,r,o={},i=[p.PREROLL_DURATION,p.MIME_TYPE];for(n in p)p.hasOwnProperty(n)&&(r=p[n],p.hasOwnProperty(n)&&s.hasOwnProperty(r)&&-1===i.indexOf(r)&&(o[r]=s[r]));(s=o).url=u,a.emit(e,{streamInfo:s})}else a.emit(f.MIME_TYPE_UNSUPPORTED)}var n,r,s,u,c=o.create("StreamInfo"),e=[{type:E.APPLICATION_STATE_CHANGE,listener:function(e){n=e.data.state}},{type:E.CONFIG,listener:function(e){r=i.mustUseHLS||e.data.config.playback.allowSafariHlsFallback&&i.canUseHLS}},{type:E.STREAM_INFO,listener:function(e){n!==l.READY&&t(f.CREATED,e)}},{type:E.STREAM_INFO_UPDATE,listener:function(e){n!==l.BUFFERING&&n!==l.PLAYING||t(f.UPDATED,e)}},{type:E.STREAM_URL,listener:function(e){u=e.data.url}},{type:E.CAN_PLAY,listener:function(e){r&&n===l.LOADING&&((s={haveAudio:e.data.haveAudio,haveVideo:e.data.haveVideo,audioInfo:e.data.haveAudio?{bitsPerSample:null,channels:null,sampleRate:null}:null,videoInfo:e.data.haveVideo?{width:e.data.videoWidth,height:e.data.videoHeight,frameRate:null}:null}).url=u,a.emit(f.CREATED,{streamInfo:s}))}}];return c.debug("init"),d.add({target:a,listeners:e}),{destroy:function(){d.remove({target:a,listeners:e})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){return Object.freeze({HAVE_VIDEO:"haveVideo",HAVE_AUDIO:"haveAudio",VIDEO_INFO:"videoInfo",AUDIO_INFO:"audioInfo",PREROLL_DURATION:"prerollDuration",MIME_TYPE:"mimeType"})}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(26),n(25),n(15),n(41),n(39),n(43),n(8)],n=function(a,e,s,t,u,c,d){var E=2e4,f=2e4;return{create:function(n){var r,o,i,e=a.create("Timeout"),t=[{type:u.APPLICATION_STATE_CHANGE,listener:function(e){switch(r=e.data.state){case d.READY:case d.PLAYING:case d.PAUSED:clearTimeout(o),clearTimeout(i)}var t;r===d.BUFFERING?(clearTimeout(i),i=setTimeout(function(){n.emit(c.BUFFERING_TIMEOUT,{delay:f})},f)):clearTimeout(i),r===d.LOADING&&(t=e.data.connectDelay,clearTimeout(o),o=setTimeout(function(){n.emit(c.LOADING_TIMEOUT,{delay:E+t})},E+t))}},{type:u.CONFIG,listener:function(e){var e=1e3*(t=e.data.config).playback.timeouts.loading,t=1e3*t.playback.timeouts.buffering;E=Math.max(Math.min(e,6e4),1e4),f=Math.max(Math.min(t,6e4),1e4)}}];return e.debug("init"),s.add({target:n,listeners:t}),{destroy:function(){clearTimeout(o),clearTimeout(i),s.remove({target:n,listeners:t})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(26),n(25),n(15),n(21),n(8),n(39),n(45)],n=function(f,l,p,T,m,A,_){return{create:function(i){var t,r,a,s,u,o,c,d,E=f.create("MetaData"),e=[{type:A.APPLICATION_STATE_CHANGE,listener:function(e){switch(t=e.data.state){case m.LOADING:a=!(d=0),s={handlerName:"",streamTime:0,message:[]},u=[],o=[],c=0,p.add({target:i,listeners:n});break;case m.PAUSING:p.remove({target:i,listeners:n})}}},{type:A.CONFIG,listener:function(e){r=l.mustUseHLS||e.data.config.playback.allowSafariHlsFallback&&l.canUseHLS}}],n=[{type:A.META_DATA,listener:function(e){E.debug("onMetaData");var t=e.data[e.data.eventType];if(1===t.chunkIndex)"function"==typeof s.message.push&&0!==s.message.length&&i.emit(_.ERROR,{code:T.STREAM.METADATA_STILL_PROCESSING,message:"Received metadata with start index but currently process another. Discard old one."}),a=!0,s={handlerName:t.handlerName,streamTime:t.streamTime,message:[]};else{if(0===s.message.length||"function"!=typeof s.message.push)return void(a&&(i.emit(_.ERROR,{code:T.STREAM.METADATA_NO_START_INDEX,message:"Received metadata but no start index. Discard."}),a=!1,s.message=[]));if(!a)return}if(s.message.push(t.message),s.message.length!==t.chunkIndex)a&&(i.emit(_.ERROR,{code:T.STREAM.METADATA_WRONG_INDEX,message:"Received metadata with wrong index. Discard."}),a=!1,s.message=[]);else if(t.chunkCount-t.chunkIndex==0)try{var n=s.message.join(""),r=s.handlerName;E.debug("handlerName="+r+", metaData="+n),n=JSON.parse(n),s.message=n;var o={handlerName:s.handlerName,streamTime:s.streamTime,message:s.message};u.push(o)}catch(e){i.emit(_.ERROR,{code:T.STREAM.METADATA_INVALID_JSON,message:"Received metadata with invalid json string."})}}},{type:A.PLAY_STATS,listener:function(e){for(d=e.data.currentTime;u.length;){var t=u.shift(),n=r&&e.data.stats.buffer.delay.avg?e.data.stats.buffer.delay.avg:0;t.streamTime+c+n<=d?(t.streamTime+=c+n,i.emit(_.RECEIVED,t)):o.push(t)}for(;o.length;)u.push(o.shift())}},{type:A.NETWORK_CONNECTED,listener:function(){c=t===m.PLAYING&&r?d:0}}];return E.debug("init"),p.add({target:i,listeners:e}),{destroy:function(){p.remove({target:i,listeners:e})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(15),n(26),n(39),n(46)],n=function(u,c,d,E){return{create:function(e){function t(){a=document[n],i.debug(a?"hidden":"visible"),e.emit(a?E.HIDDEN:E.VISIBLE)}var n,r,o,i=c.create("VisibilityProxy"),a=!1,s=[{type:d.APPLICATION_STATE_CHANGE,listener:function(e){o||(i.debug("initial player state"),t()),o=e.data.state}}];return i.debug("initialize"),u.add({target:e,listeners:s}),void 0!==document.hidden?(n="hidden",r="visibilitychange"):void 0!==document.msHidden?(n="msHidden",r="msvisibilitychange"):void 0!==document.webkitHidden&&(n="webkitHidden",r="webkitvisibilitychange"),document.addEventListener(r,t),{destroy:function(){u.remove({target:e,listeners:s}),document.removeEventListener(r,t)}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(4),n(15),n(40),n(29),n(31),n(30),n(32),n(14),n(57),n(58),n(59),n(62)],n=function(s,e,t,u,c,n,d,E,f,l,r,p){"use strict";return{create:function(e){var t=new s,n=[],r=[{from:l.CONNECTING,to:d.CONNECTING},{from:l.CONNECTED,to:d.CONNECTED},{from:l.RESUMING,to:d.RESUMING},{from:l.DESTROYED,to:d.DESTROYED},{from:l.RECONNECTING,to:d.RECONNECTING},{from:l.RECONNECTION_IMMINENT,to:d.RECONNECTION_IMMINENT},{from:l.RECONNECTION_CONFIG_INVALID,to:d.RECONNECTION_CONFIG_INVALID},{from:l.DISCONNECTED,to:d.DISCONNECTED},{from:l.INITIALIZATION_ERROR,to:d.INITIALIZATION_ERROR},{from:l.CONNECTION_ERROR,to:d.CONNECTION_ERROR},{from:l.ERROR,to:d.ERROR},{from:l.WARNING,to:d.WARNING},{from:l.STATE_CHANGE,to:d.STATE_CHANGE},{from:l.UPDATE_SOURCE_SUCCESS,to:d.UPDATE_SOURCE_SUCCESS},{from:l.UPDATE_SOURCE_FAIL,to:d.UPDATE_SOURCE_FAIL},{from:l.UPDATE_SOURCE_ABORT,to:d.UPDATE_SOURCE_ABORT},{from:l.META_DATA,to:d.META_DATA},{from:l.RANDOM_ACCESS_POINT,to:d.RANDOM_ACCESS_POINT},{from:l.SERVER_INFO,to:d.SERVER_INFO},{from:l.STREAM_INFO,to:d.STREAM_INFO},{from:l.STREAM_INFO_UPDATE,to:d.STREAM_INFO_UPDATE},{from:l.RAW_PACKET,to:d.RAW_PACKET},{from:l.STREAM_FRAGMENT,to:d.STREAM_FRAGMENT},{from:l.STREAM_STATUS,to:d.STREAM_STATUS}],o=[{from:u.CONNECT,to:f.CONNECT},{from:u.DISCONNECT,to:f.DISCONNECT},{from:u.NETWORK_PLAY,to:f.PLAY},{from:u.PAUSE,to:f.PAUSE},{from:u.CONFIG,to:f.CONFIG},{from:u.NETWORK_UPDATE_SOURCE,to:f.UPDATE_SOURCE},{from:c.STATE_CHANGE,to:f.STATE_CHANGE}],i=E.create(e,t,o),a=E.create(t,e,r);return n.push(p.create(t)),{destroy:function(){for(i.destroy(),i=null,a.destroy(),a=null;n.length;)n.pop().destroy()}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){var e="networkmanager.";return{BASE:e,CONNECT:e+"connect",DISCONNECT:e+"disconnect",PLAY:e+"play",PAUSE:e+"pause",CONFIG:e+"config",UPDATE_SOURCE:e+"updateSource",STATE_CHANGE:e+"stateChange"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="webSocketHandler.";return{BASE:e,CONNECTING:e+"connecting",CONNECTED:e+"connected",DISCONNECTED:e+"disconnected",RESUMING:e+"resuming",MESSAGE:e+"message",RECONNECTION_IMMINENT:e+"reconnectionImminent",RECONNECTING:e+"reconnecting",RECONNECTION_CONFIG_INVALID:e+"reconnectionConfigInvalid",CONNECTION_ERROR:e+"connectionError",INITIALIZATION_ERROR:e+"initializationError",DESTROYED:e+"destroyed",ERROR:e+"error",WARNING:e+"warning",STATE_CHANGE:e+"stateChange",META_DATA:e+"metaData",SERVER_INFO:e+"serverInfo",STREAM_INFO:e+"streamInfo",STREAM_INFO_UPDATE:e+"streamInfoUpdate",STREAM_FRAGMENT:e+"streamFragment",RANDOM_ACCESS_POINT:e+"randomAccessPoint",RAW_PACKET:e+"raw",STREAM_STATUS:e+"streamStatus",UPDATE_SOURCE_SUCCESS:e+"updateSourceSuccess",UPDATE_SOURCE_FAIL:e+"updateSourceFail",UPDATE_SOURCE_ABORT:e+"updateSourceAbort"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(15),n(60),n(61)],n=function(t,d,n){"use strict";return{create:function(a){function s(){for(;u.length;)u.pop();c=0}var u=[],c=0,e=[{type:n.MESSAGE,listener:function(e){if(e){var t=e.data;if("string"==typeof t){var n=JSON.parse(t);n&&n.eventType&&(e=n.eventType.substr(2,n.eventType.length-2),-1!==(e=d.BASE+e[0].toLowerCase()+e.slice(1)).indexOf(d.STREAM_INFO)&&s(),a.emit(e,n))}else if(t instanceof ArrayBuffer&&0<t.byteLength){n=new Uint8Array(t);if(a.emit(d.RAW_PACKET),8<=t.byteLength&&109===n[4]&&111===n[5]&&111===n[6]&&(102===n[7]||118===n[7])){for(var r=new Uint8Array(c),o=0,i=0;i<u.length;i++)r.set(u[i],o),o+=u[i].length;s(),a.emit(d.STREAM_FRAGMENT,r)}u.push(n),c+=t.byteLength}}}}];return t.add({target:a,listeners:e}),{destroy:function(){t.remove({target:a,listeners:e})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){var e="message.";return{BASE:e,META_DATA:e+"metaData",SERVER_INFO:e+"serverInfo",STREAM_INFO:e+"streamInfo",STREAM_INFO_UPDATE:e+"streamInfoUpdate",STREAM_FRAGMENT:e+"streamFragment",RANDOM_ACCESS_POINT:e+"randomAccessPoint",RAW_PACKET:e+"raw",STREAM_STATUS:e+"streamStatus",UPDATE_SOURCE_SUCCESS:e+"updateSourceSuccess",UPDATE_SOURCE_ERROR:e+"updateSourceError",UPDATE_SOURCE_ABORT:e+"updateSourceAbort"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="webSocketProxy.";return{BASE:e,CONNECTING:e+"connecting",CONNECTED:e+"connected",DISCONNECTED:e+"disconnected",RESUMING:e+"resuming",MESSAGE:e+"message",RECONNECTION_IMMINENT:e+"reconnectionImminent",RECONNECTING:e+"reconnecting",RECONNECTION_CONFIG_INVALID:e+"reconnectionConfigInvalid",CONNECTION_ERROR:e+"connectionError",INITIALIZATION_ERROR:e+"initializationError",DESTROYED:e+"destroyed",ERROR:e+"error",STATE_CHANGE:e+"stateChange",META_DATA:e+"metaData",SERVER_INFO:e+"serverInfo",STREAM_INFO:e+"streamInfo",STREAM_INFO_UPDATE:e+"streamInfoUpdate",STREAM_FRAGMENT:e+"streamFragment",RANDOM_ACCESS_POINT:e+"randomAccessPoint",RAW_PACKET:e+"raw",STREAM_STATUS:e+"streamStatus",UPDATE_SOURCE_SUCCESS:e+"updateSourceSuccess",UPDATE_SOURCE_ERROR:e+"updateSourceError",UPDATE_SOURCE_ABORT:e+"updateSourceAbort"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(26),n(25),n(22),n(15),n(27),n(8),n(2),n(57),n(58),n(61),n(63),n(66),n(67),n(68)],n=function(e,t,n,f,r,l,o,p,T,m,A,i,a,s){var _=e.create("WebSocketHandler");return{create:function(s){function u(e){_.debug("on connect"),1===E.length&&n().isWaitForReconnect()?n().connect(e):1===E.length&&(E.push(A.create(s)),c().connect(e)),E.length||(E[0]=A.create(s),E[0].setActive(!0),n().connect(e))}function t(e){_.debug("pass "+e.name),e.name=e.name.replace(m.BASE,T.BASE),s.emit(e.name,e)}function n(){_.debug("get active connection");for(var e=!1,t=0;t<E.length;t+=1)if(E[t].isActive()){_.debug("found active connection"),e=E[t];break}return e}function c(){var e=!1;return e=E.length?E[E.length-1]:e}function r(){var e=!!c()&&c().shouldPauseOnError();return _.debug("should pause on error: "+e),e}function d(){_.debug("drop inactive connection?"),1<E.length&&(_.debug("drop inactive connection!"),E.pop().destroy())}var o,i=[{type:p.CONNECT,listener:u},{type:p.DISCONNECT,listener:function(e){if(_.debug("on disconnect"),1!==E.length||!n().isWaitForReconnect())for(_.debug("not waiting for reconnect");E.length;)E.pop().destroy()}},{type:p.PLAY,listener:function(){_.debug("on play"),1===E.length&&E[0].play()}},{type:p.PAUSE,listener:function(){_.debug("on pause"),1===E.length&&E[0].pause()}},{type:p.UPDATE_SOURCE,listener:function(e){if(_.debug("on update source"),0===E.length)e.data.update.options.method="client",u(e);else{for(;1<E.length;){var t=c().getConnectData().update.options;s.emit(m.UPDATE_SOURCE_ABORT,{reason:"superseded",tag:t.tag,count:t.count}),d()}var n=E[0].getConnectData(),r=E[0].getServerInfo(),o=n.config.server.websocket!==e.data.config.server.websocket,i=!r,a=-1===r.capabilities.indexOf("onUpdateSource"),r="client"===e.data.update.options.method;o||i||a||r?(e.data.update.options.method="client",a=n.config.query,r=e.data.config.query,n=!1,(n=a.url&&r.url&&a.stream&&r.stream?a.url===r.url&&a.stream===r.stream:n)?s.emit(m.UPDATE_SOURCE_ABORT,{reason:"equalsource",tag:e.data.update.options.tag,count:e.data.update.options.count}):u(e)):(e.data.update.options.method="server",E[0].updateSource(e))}}},{type:p.STATE_CHANGE,listener:function(e){e.data.state===l.PAUSING&&o!==l.RECONNECTION_IMMINENT&&E.length&&n().reset(),o=e.data.state}}],a=[{type:m.CONNECTING,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.CONNECTED,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.DISCONNECTED,listener:function(e){_.debug("fired "+e.name),e.update&&s.emit(T.UPDATE_SOURCE_FAIL,{tag:e.update.update.options.tag,count:e.update.update.options.count,code:e.data.code,message:e.data.message}),(r()||e.active)&&t(e),d()}},{type:m.RESUMING,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.MESSAGE,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.RECONNECTION_IMMINENT,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.RECONNECTING,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.RECONNECTION_CONFIG_INVALID,listener:function(e){_.debug("fired "+e.name),e.update&&s.emit(T.UPDATE_SOURCE_FAIL,{tag:e.update.update.options.tag,count:e.update.update.options.count,code:e.data.code,message:e.data.message}),e.active&&t(e)}},{type:m.CONNECTION_ERROR,listener:function(e){_.debug("fired "+e.name),(r()||e.active)&&t(e),d()}},{type:m.INITIALIZATION_ERROR,listener:function(e){_.debug("fired "+e.name),e.update&&s.emit(T.UPDATE_SOURCE_FAIL,{tag:e.update.update.options.tag,count:e.update.update.options.count,code:e.data.code,message:e.data.message}),(r()||e.active)&&t(e),d()}},{type:m.DESTROYED,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.ERROR,listener:function(e){_.debug("fired "+e.name),e.update&&s.emit(T.UPDATE_SOURCE_FAIL,{tag:e.update.update.options.tag,count:e.update.update.options.count,code:e.data.code,message:e.data.message}),(r()||e.active)&&t(e),d()}},{type:m.STATE_CHANGE,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.META_DATA,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.SERVER_INFO,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.STREAM_INFO,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.STREAM_INFO_UPDATE,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.STREAM_FRAGMENT,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.RANDOM_ACCESS_POINT,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.RAW_PACKET,listener:function(e){_.debug("fired "+e.name),e.active&&t(e)}},{type:m.STREAM_STATUS,listener:function(e){_.debug("fired "+e.name),e.active&&!e.update&&t(e)}},{type:m.UPDATE_SOURCE_SUCCESS,listener:function(e){_.debug("fired "+e.name),e.active||(_.debug("drop active connection?"),1<E.length&&(_.debug("drop active connection!"),E.shift().destroy()),e.active=!0,c().setActive(!0)),_.debug("trigger update source success"),s.emit(T.UPDATE_SOURCE_SUCCESS,{tag:e.data.tag,count:e.data.count})}},{type:m.UPDATE_SOURCE_ERROR,listener:function(e){_.debug("fired "+e.name),_.debug("trigger update source fail"),s.emit(T.UPDATE_SOURCE_FAIL,{tag:e.data.tag,count:e.data.count,code:e.data.code,message:e.data.message}),r()&&(_.debug("trigger disconnected"),s.emit(T.DISCONNECTED,{code:e.data.code,message:e.data.message})),d()}},{type:m.UPDATE_SOURCE_ABORT,listener:function(e){_.debug("fired "+e.name),_.debug("trigger update source abort"),s.emit(T.UPDATE_SOURCE_ABORT,{tag:e.data.tag,count:e.data.count,reason:e.data.reason})}}],E=[];return f.add({target:s,listeners:i}),f.add({target:s,listeners:a}),{destroy:function(){for(var e in _.debug("destroy"),E)E.hasOwnProperty(e)&&(E[e].destroy(),delete E[e]);f.remove({target:s,listeners:i}),f.remove({target:s,listeners:a})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(4),n(26),n(25),n(22),n(15),n(27),n(21),n(37),n(64),n(58),n(61),n(60),n(65),n(59),n(66),n(67),n(68),n(69)],n=function(k,e,x,B,Y,V,H,W,K,t,j,q,z,X,J,Q,Z,$){var ee=e.create("WebSocketProxy"),te=5e3;return{create:function(o){function r(){var e=D;return(D=null!==b?b.readyState+2:V.UNINITIALIZED)!==e&&o.emit(j.STATE_CHANGE,_({connectionState:D})),D}function e(){return g}function t(){return U}function i(){return!!N&&N}function n(){return g.config.query.cid}function a(){ee.debug("connection open"),setTimeout(function(){L||null===b||(clearTimeout(P),o.emit(j.CONNECTED,_({count:w.retryCount})),w.retryCount=0)},200)}function s(e){ee.debug("connection close"),clearTimeout(P);var t,n=e;x.isTridentBrowser&&1005===e.code&&((n=B.copy(e)).code=parseInt(e.reason.split(" ")[1])),4200===n.code?p(!0):(t=n.code,e="Unknown reason.",K.hasOwnProperty(+t)&&(e=K[+t]),1e3<t&&t<4e3&&(t+=3100),f(n,j.DISCONNECTED,_({code:t,message:e})))}function u(e){I.emit(j.MESSAGE,_(e.data))}function c(n){ee.debug("connection error"),clearTimeout(R),R=setTimeout(function(){var e,t;L||null===b||(clearTimeout(P),e="Connection error.",(t=n||void 0)&&t.message&&(e=t.message),t&&t.code&&(e+=" (code:"+t.code+")"),t&&t.name&&(e=t.name+": "+e),f(n,j.CONNECTION_ERROR,_({code:H.NETWORK.CONNECTION_ERROR,message:e})))},200)}function d(){ee.debug("connection timeout"),L||null===b||f(null,j.INITIALIZATION_ERROR,_({code:H.NETWORK.COULD_NOT_ESTABLISH_CONNECTION,message:"Could not open connection. Timeout reached."}))}function E(){if(i())for(o.emit(j.UPDATE_SOURCE_ERROR,_({tag:N.update.options.tag,count:N.update.options.count,code:H.NETWORK.UPDATE_SOURCE_TIMEOUT,message:W.NETWORK.UPDATE_SOURCE_TIMEOUT})),N=void 0;Object.keys(G).length;)delete G[Object.keys(G)[0]]}function f(e,t,n){if(!L)if(clearTimeout(h),h=0,U&&(e&&e.data&&-1!==v.indexOf(e.data.code)||n&&n.data&&-1!==v.indexOf(n.data.code))&&w.retryCount<w.maxRetries){if(L=!0,!w.retryCount){for(;w.delays.length;)w.delays.pop();w.delays=Q.calculate(w.minDelay,w.maxDelay,w.delaySteps,w.maxRetries,w.randomFactor)}var r=w.delays[w.retryCount];w.retryCount++,g.count=w.retryCount;e=(e=e&&e.data&&e.data.code?e.data.code:e&&e.code?e.code:0)&&(n&&n.data&&n.data.code?n.data.code:n&&n.code?n.code:0);o.emit(j.RECONNECTION_IMMINENT,_({delay:r,count:w.retryCount,code:e}))}else o.emit(t,n&&n.data?n:_(n))}function l(e){ee.debug("create connection"),T(),(b=new $(e)).binaryType="arraybuffer",b.addEventListener(z.OPEN,a),b.addEventListener(z.CLOSE,s),b.addEventListener(z.MESSAGE,u),b.addEventListener(z.ERROR,c),P=setTimeout(d,te)}function p(e){ee.debug("destroy connection"+(e?" silent":"")),N=void 0,T(),o.emit(j.DESTROYED,_({silent:!!e}))}function T(){clearTimeout(P),clearTimeout(h),clearTimeout(R),clearTimeout(O),null!==b&&(b.onopen=null,b.onclose=null,b.onmessage=null,b.onerror=null,b.close(),b=null)}function m(e,t){if(ee.debug("send "+e),t)try{t=JSON.stringify(t)}catch(e){t="{}"}else t="{}";var n=F.requestId+1;(F={}).eventType=e,F[e]=JSON.parse(t),F.requestId=n;n=JSON.stringify(F);try{r()===V.OPEN&&b.send(n)}catch(e){}}function A(e){return{code:e.code,name:e.name,message:e.message}}function _(e){return{data:e||void 0,connectionState:r(),connectionId:g.config.query.cid,active:U,update:i()}}function S(e){var t=e.name.replace(q.BASE,j.BASE);o.emit(t,_(e.data))}var h,R,O,g,N,y,I=new k,v=[4102,4103,4105,4106,4107,4108,4109,4111,4115,4500,4503],C=[{type:q.META_DATA,listener:function(e){S(e)}},{type:q.SERVER_INFO,listener:function(e){y=e.data.onServerInfo,S(e)}},{type:q.STREAM_INFO,listener:function(e){S(e),e.data.onStreamInfo}},{type:q.STREAM_INFO_UPDATE,listener:function(e){e.data.onStreamInfo,S(e)}},{type:q.STREAM_FRAGMENT,listener:function(e){S(e)}},{type:q.RANDOM_ACCESS_POINT,listener:function(e){S(e)}},{type:q.RAW_PACKET,listener:function(e){S(e)}},{type:q.STREAM_STATUS,listener:function(e){i()&&"client"===N.update.options.method&&"stopped"===e.data.onStreamStatus.status&&o.emit(j.UPDATE_SOURCE_ERROR,_({tag:N.update.options.tag,count:N.update.options.count,code:H.NETWORK.UPDATE_SOURCE_STREAM_STOPPED,message:W.NETWORK.UPDATE_SOURCE_STREAM_STOPPED})),S(e)}},{type:q.UPDATE_SOURCE_SUCCESS,listener:function(e){var t;i()&&F.requestId>=e.data.onUpdateSourceSuccess.requestId&&(t=e.data[e.data.eventType].tag,0===(e=e.data[e.data.eventType].count)&&(t=N.update.options.tag,e=N.update.options.count),o.emit(j.UPDATE_SOURCE_SUCCESS,_({tag:t,count:e})),G[e]?(g=B.copy(G[e]),N===G[e]&&(N=void 0),delete G[e]):(g=N,N=void 0))}},{type:q.UPDATE_SOURCE_ERROR,listener:function(e){var t,n,r;F.requestId>=e.data.onUpdateSourceError.requestId&&(t=e.data.onUpdateSourceError.code,n="Unknown reason.",K.hasOwnProperty(+t)&&(n=K[+t]),1e3<t&&t<4e3&&(t+=3100),r=e.data[e.data.eventType].tag,e=e.data[e.data.eventType].count,o.emit(j.UPDATE_SOURCE_ERROR,_({tag:r,count:e,code:t,message:n})),N===G[e]&&(N=void 0),delete G[e])}},{type:q.UPDATE_SOURCE_ABORT,listener:function(e){var t,n;F.requestId>=e.data.onUpdateSourceAbort.requestId&&(t=e.data[e.data.eventType].tag,n=e.data[e.data.eventType].count,e=e.data[e.data.eventType].reason,o.emit(j.UPDATE_SOURCE_ABORT,_({tag:t,count:n,reason:e})),N===G[n]&&(N=void 0),delete G[n])}}],b=null,D=V.UNINITIALIZED,P=0,U=!1,L=!1,w={minDelay:2,maxDelay:10,delaySteps:10,maxRetries:10,delays:[],retryCount:0,randomFactor:1.5},M=[],F={requestId:0},G={};return ee.debug("init"),M.push(X.create(I)),Y.add({target:I,listeners:C}),{connect:function(e){if(ee.debug("on connect"),L=!1,clearTimeout(h),(g=e.data).count=w.retryCount,g.reconnect){var t=J.validate(g.reconnect);if(t.success)for(var n in g.reconnect)g.reconnect.hasOwnProperty(n)&&(w[n]=g.reconnect[n]);else o.emit(j.RECONNECTION_CONFIG_INVALID,_({reason:t.reason}))}g.timeouts&&(r=1e3*g.timeouts.connecting,te=Math.max(Math.min(r,3e4),5e3));try{l(g.url),o.emit(e.name?j.CONNECTING:j.RECONNECTING,_(g)),N=e.data.update?e.data:void 0,i()&&(clearTimeout(O),O=setTimeout(E,1e3*e.data.update.options.timeout))}catch(e){var t="Connection initialization error.",r=e?A(e):void 0;r&&r.message&&(t=r.message),r&&r.code&&(t+=" (code:"+r.code+")"),r&&r.name&&(t=r.name+": "+t),o.emit(j.INITIALIZATION_ERROR,_({code:H.NETWORK.COULD_NOT_ESTABLISH_CONNECTION,message:t}))}},disconnect:function(e){p(e.data.silent)},play:function(){ee.debug("on play");try{g=Z.create(g,!1),null===b?l(g.url):(ee.debug("sending play to server"),m("onPlay"),o.emit(j.RESUMING,_()))}catch(e){o.emit(j.ERROR,_(A(e)))}},pause:function(){ee.debug("on pause");try{null!==b&&(ee.debug("sending pause to server"),g=Z.create(g,!0),m("onPause"))}catch(e){o.emit(j.ERROR,_(A(e)))}},updateSource:function(e){if(ee.debug("on update source"),y&&-1!==y.capabilities.indexOf("onUpdateSource")&&"server"===e.data.update.options.method&&null!==b){clearTimeout(O),O=setTimeout(E,1e3*e.data.update.options.timeout),G[e.data.update.options.count]=e.data,(N=e.data).count=w.retryCount;var t=N.update,n={options:{fastStart:t.options.fastStart,incTiming:t.options.incTiming},tag:t.options.tag,count:t.options.count};if(t.source.h5live.rtmp&&t.source.h5live.rtmp.url&&t.source.h5live.rtmp.streamname&&(n.rtmp={url:t.source.h5live.rtmp.url,stream:t.source.h5live.rtmp.streamname}),t.source.h5live.params&&(n.params=pdate.source.h5live.params),t.source.h5live.security&&"object"==typeof t.source.h5live.security)for(var r in n.security={},t.source.h5live.security)t.source.h5live.security.hasOwnProperty(r)&&(n.security[r]=t.source.h5live.security[r]);m("onUpdateSource",n)}},reset:function(){L=!1,w.retryCount=0},getState:r,getConnectData:e,getServerInfo:function(){return y},getWebSocket:function(){return b},setActive:function(e){U=!!e},isActive:t,isUpdate:i,isWaitForReconnect:function(){return L},getConnectionId:n,isConnectionId:function(e){return n()===e},shouldPauseOnError:function(){return g.update&&g.update.options.pauseOnError||N&&N.update.options.pauseOnError},destroy:function(){for(ee.debug("destroy");M.length;)M.pop().destroy();T(),Y.remove({target:I,listeners:C})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){return Object.freeze({1e3:"Normal closure, meaning that the purpose for which the connection was established has been fulfilled.",1001:'An endpoint is "going away", such as a server going down or a browser having navigated away from a page.',1002:"An endpoint is terminating the connection due to a protocol error",1003:"An endpoint is terminating the connection because it has received a type of data it cannot accept (e.g., an endpoint that understands only text data MAY send this if it receives a binary message).",1004:"Reserved. The specific meaning might be defined in the future.",1005:"No status code was actually present.",1006:"Maybe no network, wrong url or server down.",1007:"An endpoint is terminating the connection because it has received data within a message that was not consistent with the type of the message (e.g., non-UTF-8 [http://tools.ietf.org/html/rfc3629] data within a text message).",1008:'An endpoint is terminating the connection because it has received a message that "violates its policy". This reason is given either if there is no other sutible reason, or if there is a need to hide specific details about the policy.',1009:"An endpoint is terminating the connection because it has received a message that is too big for it to process.",1011:"A server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request.",1015:"The connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified).",4005:"The requested source stream in the 'updateSource' call has been stopped.",4400:"Bad request. Maybe stream parameters are missing or malformed.",4403:"Access denied. The authentication token is missing or invalid.",4500:"The connection has been rejected due an internal server error.",4503:"The requested service is currently unavailable.",4900:"The security service has been rejected due an internal server error.",4901:"The security service denied access. The authentication token is invalid.",4903:"The security service denied access. The url is expired or a token parameter is missing (expires, token, or options).",4904:"The security service can not be found."})}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return{BASE:"",OPEN:"open",CLOSE:"close",MESSAGE:"message",ERROR:"error"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return{validate:function(e){for(var t=["minDelay","maxDelay","delaySteps","maxRetries"],n=0;n<t.length;++n){if(!e.hasOwnProperty(t[n]))return{success:!1,reason:"The reconnect config is invalid, it must contain 'minDelay', 'maxDelay', 'delaySteps', and 'maxRetries'. Reset to default."};if("number"!=typeof e[t[n]])return{success:!1,reason:"The reconnect config is invalid, the value '"+t[n]+"' have to be a number. Reset to default."}}return e[t[0]]>e[t[1]]?{success:!1,reason:"The reconnect config is invalid, the value '"+t[0]+"' have to be lower then '"+t[1]+"'. Reset to default."}:e[t[0]]<1?{success:!1,reason:"The reconnect config is invalid, the value '"+t[0]+"' have to be greater or equal then 1 sec. Reset to default."}:{success:!0}}}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return{calculate:function(e,t,n,r,o){for(var i=[],a=Math.sqrt(e),s=(Math.sqrt(t)-a)/((n=r<n?r:n)-1),u=0;u<r;u+=1){var c=o*(Math.random()-.5),c=a+s*Math.min(n-1,u)+(!u&&a-Math.abs(c)<=.5?Math.abs(c)+o*Math.random():c),c=Math.round(c*c*1e3);i.push(c)}return i}}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return{create:function(e,t){var n=e.url.split("&flags=");if(1<n.length&&(n[1]=decodeURIComponent(n[1])),t)1<n.length&&-1===n[1].indexOf("paused")?e.url=n[0]+"&flags="+encodeURIComponent("paused,"+n[1]):1===n.length&&(e.url+="&flags=paused");else if(1<n.length&&-1!==n[1].indexOf("paused")){var r=n[1].split(",");if(1===r.length)e.url=e.url.replace("&flags=paused","");else{e.url=n[0]+"&flags=";for(var o=0;o<r.length;o+=1)"paused"!==r[o]&&(e.url+=encodeURIComponent(r[o]),e.url+=encodeURIComponent(2<r.length&&o<r.length-1?",":""))}}return e}}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(65)],n=function(r){var o=WebSocket.addEventListener;return WebSocket.prototype.addEventListener=function(e,t,n){this["on"+e],r[e.toUpperCase()]===e?this["on"+e]=t:o(e,t,n)},WebSocket}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(26),n(25),n(4),n(10),n(15),n(14),n(48),n(29),n(31),n(30),n(32),n(72),n(73),n(74),n(75),n(76),n(71),n(77),n(78),n(79),n(80),n(81),n(84),n(88),n(92),n(93),n(94),n(95),n(96),n(97),n(98)],n=function(c,d,E,e,f,l,p,T,m,A,_,S,h,R,O,g,N,y,I,v,C,b,D,P,U,L,w,M,F,G,k){"use strict";return{create:function(e){var t,n,r=new E,o=c.create("MediaManager"),i=[],a=[{type:R.VIDEO_SOURCE,listener:function(e){o.debug("creating media handlers"),e.data.type===p.MP4?(i.push(L.create(r)),i.push(F.create(r)),i.push(k.create(r))):i.push(w.create(r)),f.remove({target:r,listeners:a})}},{type:N.CONFIG,listener:function(e){!d.hasMediaSource||e.data.config.playback.allowSafariHlsFallback&&d.canUseHLS||i.push(P.create(r))}}],s=[{from:O.LOAD_START,to:A.LOAD_START},{from:O.PROGRESS,to:A.PROGRESS},{from:O.SUSPEND,to:A.SUSPEND},{from:O.ABORT,to:A.ABORT},{from:O.EMPTIED,to:A.EMPTIED},{from:O.STALLED,to:A.STALLED},{from:O.PLAY,to:A.PLAY},{from:O.PAUSE,to:A.PAUSE},{from:O.LOADED_META_DATA,to:A.LOADED_META_DATA},{from:O.LOADED_DATA,to:A.LOADED_DATA},{from:O.WAITING,to:A.WAITING},{from:O.ERROR,to:A.ERROR},{from:O.PLAYING,to:A.PLAYING},{from:O.CAN_PLAY,to:A.CAN_PLAY},{from:O.CAN_PLAY_THROUGH,to:A.CAN_PLAY_THROUGH},{from:O.SEEKING,to:A.SEEKING},{from:O.SEEKED,to:A.SEEKED},{from:O.TIME_UPDATE,to:A.TIME_UPDATE},{from:O.ENDED,to:A.ENDED},{from:O.RATE_CHANGE,to:A.RATE_CHANGE},{from:O.DURATION_CHANGE,to:A.DURATION_CHANGE},{from:O.VOLUME_CHANGE,to:A.VOLUME_CHANGE},{from:O.ELEMENT_CREATED,to:A.ELEMENT_CREATED},{from:O.PLAY_START_SUCCESS,to:A.PLAY_START_SUCCESS},{from:O.PLAY_START_ERROR,to:A.PLAY_START_ERROR},{from:O.VIEWPORT_VISIBLE,to:A.VIEWPORT_VISIBLE},{from:O.VIEWPORT_HIDDEN,to:A.VIEWPORT_HIDDEN},{from:h.ERROR,to:A.PLAYBACK_ERROR},{from:h.SUSPENDED,to:A.PLAYBACK_SUSPENDED},{from:y.QUALITY_STATS,to:A.QUALITY_STATS},{from:y.FRAME_DROP,to:A.FRAME_DROP},{from:I.PLAY_STATS,to:A.PLAY_STATS},{from:g.SOURCE_ENDED,to:A.PLAYBACK_FINISHED},{from:g.SOURCE_CLOSED,to:A.PLAYBACK_FINISHED},{from:S.PLAYBACK_STARTED,to:A.PLAYBACK_STARTED},{from:S.BUFFERING,to:A.BUFFERING},{from:v.BUFFER_TWEAKS_CREATED,to:A.BUFFER_TWEAKS_CREATED},{from:v.BUFFER_TWEAKS_ERROR,to:A.BUFFER_TWEAKS_ERROR}],u=[{from:T.CREATE_VIDEO,to:R.CREATE_VIDEO},{from:T.DESTROY_VIDEO,to:R.DESTROY_VIDEO},{from:T.VIDEO_SOURCE,to:R.VIDEO_SOURCE},{from:T.PLAY,to:R.PLAY},{from:T.PAUSE,to:R.PAUSE},{from:T.SEEK,to:R.SEEK},{from:T.MUTE,to:R.MUTE},{from:T.UNMUTE,to:R.UNMUTE},{from:T.SET_VOLUME,to:R.SET_VOLUME},{from:T.SET_RATE,to:R.SET_RATE},{from:T.UPDATE_SOURCE,to:R.UPDATE_SOURCE},{from:T.CONFIG,to:N.CONFIG},{from:_.SERVER_INFO,to:N.SERVER_INFO},{from:_.STREAM_INFO,to:N.STREAM_INFO},{from:_.STREAM_INFO_UPDATE,to:N.STREAM_INFO_UPDATE},{from:_.STREAM_FRAGMENT,to:N.STREAM_FRAGMENT},{from:_.RANDOM_ACCESS_POINT,to:N.RANDOM_ACCESS_POINT},{from:m.STATE_CHANGE,to:N.APPLICATION_STATE_CHANGE},{from:m.STARTUP_STATS,to:N.STARTUP_STATS},{from:m.DOCUMENT_VISIBLE,to:N.DOCUMENT_VISIBLE},{from:m.DOCUMENT_HIDDEN,to:N.DOCUMENT_HIDDEN}];return f.add({target:r,listeners:a}),t=l.create(e,r,u),n=l.create(r,e,s),i.push(C.create(r)),i.push(b.create(r)),i.push(D.create(r)),i.push(M.create(r)),i.push(G.create(r)),d.useFakeAudio&&i.push(U.create(r)),{destroy:function(){for(t.destroy(),t=null,n.destroy(),n=null;i.length;)i.pop().destroy()}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){var e="mediaManager.";return{BASE:e,CONFIG:e+"config",SERVER_INFO:e+"serverInfo",STREAM_INFO:e+"streamInfo",STREAM_INFO_UPDATE:e+"streamInfoUpdate",STREAM_FRAGMENT:e+"streamFragment",RANDOM_ACCESS_POINT:e+"randomAccessPoint",APPLICATION_STATE_CHANGE:e+"applicationStateChange",STARTUP_STATS:e+"startupStats",DOCUMENT_VISIBLE:e+"documentVisible",DOCUMENT_HIDDEN:e+"documentHidden"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="mediaControl.";return{BASE:e,PLAYBACK_STARTED:e+"playbackStarted",BUFFERING:e+"buffering"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="mediaHandler.";return{BASE:e,ERROR:e+"error",SUSPENDED:e+"suspended"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="mediaControl.";return{BASE:e,CREATE_VIDEO:e+"createVideo",DESTROY_VIDEO:e+"destroyVideo",VIDEO_SOURCE:e+"videoSource",UPDATE_SOURCE:e+"updateSource",PLAY:e+"play",PAUSE:e+"pause",SEEK:e+"seek",MUTE:e+"mute",UNMUTE:e+"unmute",SET_VOLUME:e+"volume",SET_RATE:e+"playbackRate"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="mediaElementProxy.";return{BASE:e,LOAD_START:e+"loadstart",PROGRESS:e+"progress",SUSPEND:e+"suspend",ABORT:e+"abort",EMPTIED:e+"emptied",STALLED:e+"stalled",PLAY:e+"play",PAUSE:e+"pause",LOADED_META_DATA:e+"loadedmetadata",LOADED_DATA:e+"loadeddata",WAITING:e+"waiting",ERROR:e+"error",PLAYING:e+"playing",CAN_PLAY:e+"canplay",CAN_PLAY_THROUGH:e+"canplaythrough",SEEKING:e+"seeking",SEEKED:e+"seeked",TIME_UPDATE:e+"timeupdate",ENDED:e+"ended",RATE_CHANGE:e+"ratechange",DURATION_CHANGE:e+"durationchange",VOLUME_CHANGE:e+"volumechange",QUALITY_UPDATE:e+"qualityupdate",ELEMENT_CREATED:e+"elementCreated",PLAY_START_SUCCESS:e+"playStartSuccess",PLAY_START_ERROR:e+"playStartError",VIEWPORT_VISIBLE:e+"viewportvisible",VIEWPORT_HIDDEN:e+"viewporthidden"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="mediaSourceProxy.";return{BASE:e,SOURCE_OPEN:e+"sourceopen",SOURCE_ENDED:e+"sourceended",SOURCE_CLOSED:e+"sourceclosed",SOURCE_READY:e+"sourceready"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="qualityHandler.";return{BASE:e,QUALITY_STATS:e+"qualitystats",FRAME_DROP:e+"framedrop"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="statsCollector.";return{BASE:e,PLAY_STATS:e+"playStats"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){var e="mediaControl.";return{BASE:e,BUFFER_TWEAKS_CREATED:e+"tweaksCreated",BUFFER_TWEAKS_ERROR:e+"tweaksError"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(26),n(25),n(48),n(15),n(72),n(79),n(74),n(75),n(76),n(71),n(78),n(8)],n=function(s,y,u,I,v,C,b,D,P,U,L,w){return{create:function(c){function d(){T.debug("add control listeners"),E(),I.add({target:c,listeners:i})}function E(){T.debug("remove control listeners"),I.remove({target:c,listeners:i})}function t(){n(),T.debug("add play state listeners?"),m&&(T.debug("add play state listeners!"),I.add({target:c,listeners:a}))}function n(){T.debug("remove play state listeners"),I.remove({target:c,listeners:a})}function f(e){var t=!0;if(e.length){for(var n=e[0],r=1;r<e.length;r++)if(e[r]!==n){t=!1;break}return t}return!1}function l(e,t,n){e.length===n&&e.shift(),e.push(t)}function p(e,t){for(var n=0;e&&n<e.length;++n)if(e.start(n)<=t&&e.end(n)>=t||y.isTridentBrowser&&t<=.3&&e.start(n)<=5&&.2<e.end(n)-e.start(n))return n;return-1}var r,T=s.create("BufferControl"),m={},A=!1,_=!0,S=!1,h=!1,R=-1,O=null,g=[],N=[],e=[{type:U.APPLICATION_STATE_CHANGE,listener:function(e){switch(r=e.data.state){case w.PLAYING:O=null;break;case w.LOADING:break;case w.PAUSED:n();break;case w.PAUSING:n(),T.warn("entering paused state"),_=!(A=!(R=-1))}}},{type:U.STARTUP_STATS,listener:function(e){O=e.data.stats}},{type:b.VIDEO_SOURCE,listener:function(e){T.debug("video source"),(S=e.data.type===u.HLS)&&(t(),I.add({target:c,listeners:o}))}},{type:P.SOURCE_READY,listener:function(){t()}},{type:C.BUFFER_TWEAKS_CREATED,listener:function(e){T.debug("buffer tweaks created"),!S&&r===w.PLAYING&&m.buffer.start<e.data.tweaks.buffer.start&&setTimeout(function(){_=!0,c.emit(v.BUFFERING),T.debug("new tweaks, pausing to raise buffer"),c.emit(b.PAUSE)},10),m.buffer=e.data.tweaks.buffer}}],o=[{type:D.CAN_PLAY_THROUGH,listener:function(){r===w.LOADING&&(T.debug("hls: canplaythrough while loading, wait for progress"),c.emit(b.PLAY,{external:!1}),h=!0)}},{type:D.PROGRESS,listener:function(){(r===w.BUFFERING||r===w.LOADING&&h)&&(T.debug("hls: progress at buffering or after canplaythrough while loading, continue"),_=h=!1,c.emit(v.PLAYBACK_STARTED,O?{stats:O}:{}))}},{type:D.WAITING,listener:function(){r===w.PLAYING&&(T.debug("hls: waiting while playing, now buffering"),_=!0,c.emit(v.BUFFERING))}}],i=[{type:b.PLAY,listener:function(e){S||-1!==R||setTimeout(function(){T.debug("pausing to raise buffer"),c.emit(b.PAUSE)},10)}}],a=[{type:L.PLAY_STATS,listener:function(e){if(e.data.buffered&&e.data.buffered.length){var t=e.data.stats,n=t.buffer.delay.current,r=n>m.buffer.start,o=S?0<n:n>m.buffer.min,i=t.buffer.end-t.buffer.start,a=e.data.currentTime,t=e.data.buffered,e=-1!==p(t,a);l(g,a,5),l(N,n,5);n=f(g)&&f(N);if(!S&&!e&&!A&&.45<i){var s=t.length,u=Math.min(t.start(s-1)+.3,t.end(s-1));return T.warn("seek to range: "+t.start(s-1)+" < "+u+" > "+t.end(s-1)),void c.emit(b.SEEK,{position:y.isTridentBrowser?0:u})}if(!S&&!A&&y.isFirefox&&1<t.length&&p(t,a)!==t.length-1&&.3<t.end(s-1)-t.start(s-1)){s=t.length,u=t.start(s-1);return T.warn("seek to startable range start: "+t.start(s-1)),void c.emit(b.SEEK,{position:u})}if(r&&-1===R&&e){if(R=a,!S&&y.isSafari&&R<.2)return R=.3,T.warn("initial safari stream startTime set to "+R+", seeking"),void c.emit(b.SEEK,{position:R});T.debug("stream startTime set to "+R)}_&&r&&(S?h&&(T.debug("hls: buffering and has enough to start, don't wait for progress"),h=!1):(T.debug("starting stream"),E(),c.emit(b.PLAY,{external:!1}),d()),_=!1,A&&c.emit(v.PLAYBACK_STARTED,O?{stats:O}:{})),_||(!A&&-1!==R&&R<a-.1&&(A=!0,S&&h&&(T.debug("hls: current time rising and started, don't wait for progress"),h=!1),c.emit(v.PLAYBACK_STARTED,O?{stats:O}:{})),a>m.buffer.start&&(!o||A&&n)&&(_=!0,S||(T.debug("pausing to buffer"),c.emit(b.PAUSE)),c.emit(v.BUFFERING)))}else T.debug("no data in play stats")}}];return I.add({target:c,listeners:e}),d(),{destroy:function(){I.remove({target:c,listeners:e}),S&&I.remove({target:c,listeners:o}),E()}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(26),n(22),n(25),n(82),n(15),n(72),n(79),n(77),n(71),n(78),n(83)],n=function(O,g,N,y,I,v,C,b,D,P,U){return{create:function(n){function t(){u=y.create(10*m)}function r(e){I.add({target:n,listeners:e?R:h}),I.remove({target:n,listeners:e?h:R})}function o(e){e.data.onStreamInfo.videoInfo&&e.data.onStreamInfo.haveVideo&&e.data.onStreamInfo.videoInfo.frameRate<=30&&N.isTridentBrowser&&!S&&(f=g.copy(E),i(Math.sqrt(30)-Math.sqrt(e.data.onStreamInfo.videoInfo.frameRate),1),f.start+=(f.target-f.start)/2,f.min+=(f.start-f.min)/2,a())}function i(t,n){n=n||1,["start","target","limit"].forEach(function(e){f[e]*=n,f[e]+=t})}function a(){d.debug("new buffer: "+JSON.stringify(f)),n.emit(C.BUFFER_TWEAKS_CREATED,{tweaks:{buffer:g.copy(f)}})}var s,u,c,d=O.create("BufferTweaker"),E={max:8,min:.2,start:.5,target:1.2,limit:1.7},f=g.copy(E),l=g.copy(E),p=0,T=0,m=0,A=-1,_=!1,S=!1,e=[{type:D.STREAM_INFO,listener:o},{type:D.STREAM_INFO_UPDATE,listener:function(e){o(e)}},{type:D.CONFIG,listener:function(e){var t;(c=N.mustUseHLS||e.data.config.playback.allowSafariHlsFallback&&N.canUseHLS)||I.add({target:n,listeners:R}),e.data.config.tweaks&&(e.data.config.tweaks.buffer&&((t=U.validateBuffer(e.data.config.tweaks.buffer)).success?(f=g.copy(e.data.config.tweaks.buffer),l=g.copy(f),S=!0):n.emit(C.BUFFER_TWEAKS_ERROR,{reason:t.reason})),e.data.config.tweaks.bufferDynamic&&!c&&((t=U.validateDynamic(e.data.config.tweaks.bufferDynamic)).success?(p=e.data.config.tweaks.bufferDynamic.offsetThreshold,T=e.data.config.tweaks.bufferDynamic.offsetStep,m=e.data.config.tweaks.bufferDynamic.cooldownTime):n.emit(C.BUFFER_TWEAKS_ERROR,{reason:t.reason}))),a()}},{type:b.FRAME_DROP,listener:function(e){N.isFirefox&&(d.debug("frame drop"),d.debug(""+JSON.stringify(e)),d.debug("current buffer: "+JSON.stringify(f)),d.debug("limit: "+l.limit+", start: "+f.start),f.start<l.limit?(d.debug("start lower then limit -> tweaking"),i(f.target-f.start),a()):d.debug("start higher then limit -> tweaking denied"))}}],h=[{type:P.PLAY_STATS,listener:function(e){(e=e.data.stats.buffer.delay.current)&&u.add(e),!_&&N.isTridentBrowser&&2<e&&(f.target=e,f.limit=f.target+1.5,a()),_=!0}},{type:v.BUFFERING,listener:function(){r(!0);var e=((new Date).getTime()-A)/1e3;-1!==A&&e<p&&f.start<l.limit&&(d.warn("buffering "+e+" seconds after stream started, raising buffer values"),i(T),a()),t(),clearInterval(s),s=0}}],R=[{type:v.PLAYBACK_STARTED,listener:function(){r(!1),A=(new Date).getTime(),_&&m&&(s=setInterval(function(){d.debug("stream running stable since "+m+" sec"),d.debug("buffer min: "+u.minimum+", max: "+u.maximum),f.start>l.start?(d.debug(-T+" sec cooldown"),i(-T),a()):(d.debug("no cooldown"),clearInterval(s),s=0)},1e3*m))}}];return d.debug("initialize"),t(),I.add({target:n,listeners:e}),{destroy:function(){u=null,[e,h,R].forEach(function(e){I.remove({target:n,listeners:e})})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){return{create:function(t){var n=[],r={};return r={add:function(e){for(n.push(e);n.length>t;)n.shift();return e=JSON.parse(JSON.stringify(n)).sort(function(e,t){return e-t},0),r.arithmetic=function(e){return e.reduce(function(e,t){return e+t},0)/e.length}(e),r.geometric=function(e){return Math.pow(e.reduce(function(e,t){return e?t?e*t:e:t},0),1/e.length)}(e),r.harmonic=function(e){var t=e.reduce(function(e,t,n){return t?n-1?e+1/t:(e?1/e:0)+1/t:e},0);return t?e.length/t:0}(e),r.minimum=e[0],r.maximum=e[e.length-1],{minimum:r.min,maximum:r.max,arithmetic:r.arithmetic,geometric:r.geometric,harmonic:r.harmonic}},minimum:0,maximum:0,arithmetic:0,geometric:0,harmonic:0,values:n}}}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return{validateBuffer:function(t){var e,n=["min","start","target","limit","max"],r=n.filter(function(e){return!t.hasOwnProperty(e)});if(r.length)return{success:!1,reason:"The buffer config is invalid, it must contain "+r.join(", ")+". Reset to default."};for(e in n)if(n.hasOwnProperty(e)){if("number"!=typeof t[n[e]])return{success:!1,reason:"The buffer config is invalid, the value '"+n[e]+"' have to be a number. Reset to default."};if(0<e&&t[n[e-1]]>t[n[e]])return{success:!1,reason:"The buffer config is invalid, the value '"+n[e-1]+"' have to be lower then '"+n[e]+"'. Reset to default."}}return{success:!0}},validateDynamic:function(t){var e=["offsetThreshold","offsetStep","cooldownTime"],n=e.filter(function(e){return!t.hasOwnProperty(e)});return n.length?{success:!1,reason:"The dynamic buffer config is invalid, it must contain "+n.join(", ")+". Reset to default."}:(e.forEach(function(e){if("number"!=typeof t[e]||0===t[e])return{success:!1,reason:"The dynamic buffer config is invalid, the value '"+e+"' have to be a number. Reset to default."}}),{success:!0})}}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(26),n(25),n(85),n(15),n(86),n(87),n(74),n(71),n(75)],n=function(b,D,P,U,L,w,M,F,G){return{create:function(r){function e(){if(E){for(U.remove({target:E,listeners:C}),D.isTridentBrowser&&(_=void 0,["scroll","resize"].forEach(function(e){window.removeEventListener&&removeEventListener(e,t,!1),window.detachEvent&&detachEvent("on"+e,t)})),S&&(l.src="",E.load());f.firstChild;)f.removeChild(f.firstChild);for(;E.firstChild;)E.removeChild(E.firstChild);R&&(h.debug("releasing external video"),E.style.cssText=p,p=null,T.appendChild(E)),clearInterval(m),clearInterval(A),E=null}}function n(){h.debug("mute"),g=!0,E&&(E.muted=!0)}function o(){h.debug("unmute"),g=!1,E&&(E.muted=!1)}function i(t){h.debug("onPlay"),E&&P.play(E).then(function(){h.debug("play promise resolved"),r.emit(G.PLAY_START_SUCCESS),O=!(y=!1)}).catch(function(e){h.debug("play promise rejected"),e.error.name!==L.NOT_ALLOWED_ERROR||E.muted||!N||y?E.muted&&y&&(h.debug("unmute to reset"),o(),E.muted||(s({type:w.VOLUME_CHANGE}),y=!1)):(h.debug("mute to play"),n(),E.muted&&(y=!0,setTimeout(i.bind(null,{data:{external:!1}}),20))),t.data.external&&!y||r.emit(G.PLAY_START_ERROR,{error:e.error,automuted:y})})}function a(e){E&&E.playbackRate!==e.data.rate&&(h.debug("set rate to: "+e.data.rate),E.playbackRate=e.data.rate)}function s(e){var t=d();switch(e.type){case w.ERROR:t.code=E.error.code;break;case w.VOLUME_CHANGE:t.muted=E.muted,t.volume=E.volume;break;case w.CAN_PLAY:t.haveVideo=void 0!==E.videoTracks&&0<E.videoTracks.length,t.haveAudio=void 0!==E.audioTracks&&0<E.audioTracks.length,t.videoWidth=E.videoWidth,t.videoHeight=E.videoHeight}h.detail(e.type),r.emit("mediaElementProxy."+e.type,t)}function u(){r.emit(G.TIME_UPDATE,d())}function c(){var e=d();e.quality=E.getVideoPlaybackQuality(),r.emit(G.QUALITY_UPDATE,e)}function t(){var e=E&&"function"==typeof E.getBoundingClientRect?E.getBoundingClientRect():{top:0,left:0,bottom:0,right:0},t=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth,t=e.top<=t&&0<=e.top+e.height,e=e.left<=n&&0<=e.left+e.width,e=t&&e;e!==_&&(h.debug("viewport changed to "+(e?"visible":"hidden")),_=e,r.emit(e?G.VIEWPORT_VISIBLE:G.VIEWPORT_HIDDEN))}function d(){return{currentTime:E.currentTime,buffered:E.buffered,played:E.played,playbackRate:E.playbackRate}}var E,f,l,p,T,m,A,_,S,h=b.create("MediaElementProxy"),R=!1,O=!1,g=!1,N=!1,y=!1,I=1,v=[{type:F.CONFIG,listener:function(e){S=D.mustUseHLS||e.data.config.playback.allowSafariHlsFallback&&D.canUseHLS,e.data.config.playback&&(g=!!e.data.config.playback.muted,N=!!e.data.config.playback.automute)}},{type:M.CREATE_VIDEO,listener:function(e){E=document.getElementById(e.data.elementId),R=!!E,h.debug("using "+(R?"external ":"generated ")+"video eleement"),f=e.data.container,E?(T=E.parentElement,p=E.style.cssText,E.style.cssText=""):((E=document.createElement("video")).id=e.data.elementId,E.autoplay=!1,E.controls=!1,E.setAttribute("playsinline",!0),E.style.backgroundColor="transparent"),E.muted=g,E.volume=I,l=document.createElement("source"),E.appendChild(l),D.isIOS11||!D.isIOS&&D.mustUseHLS?(h.debug("iOS11 detected, using iframe hack"),E.style.width="100vw",E.style.height="100vh",(e=document.createElement("iframe")).frameBorder=0,e.scrolling="no",e.style.cssText="width: 100%;height: 100%;position: absolute;display: block;top: 0;left: 0;",e.addEventListener("load",function(e){e.target.contentDocument.body.style.height="100%",e.target.contentDocument.body.style.width="100%",e.target.contentDocument.body.style.overflow="hidden",e.target.contentDocument.body.style.position="absolute",e.target.contentDocument.body.style.margin="0",e.target.contentDocument.body.style.padding="0",e.target.contentDocument.body.firstChild||(e.target.contentDocument.body.appendChild(E),U.remove({target:E,listeners:C}),U.add({target:E,listeners:C}))}),e.addEventListener("unload",function(e){e.target.contentDocument.body.firstChild&&e.target.contentDocument.body.removeChild(E)}),f.appendChild(e)):(h.debug("appending video to container"),f.appendChild(E),U.add({target:E,listeners:C})),D.isTridentBrowser&&(["scroll","resize"].forEach(function(e){window.addEventListener&&addEventListener(e,t,!1),window.attachEvent&&attachEvent("on"+e,t)}),t()),r.emit(G.ELEMENT_CREATED,{video:E}),r.emit(G.VOLUME_CHANGE,{muted:E.muted,volume:E.volume})}},{type:M.DESTROY_VIDEO,listener:e},{type:M.VIDEO_SOURCE,listener:function(e){var t;h.debug("received video source"),E&&(t=!e.data.src.length,h.debug("src: "+e.data.src),h.debug("type: "+e.data.type),l.src=e.data.src,E.type=e.data.type,E.load(),O&&!t&&(h.debug("call play while playing after video source received"),P.play(E).then(function(){h.debug("play promise resolved after video source received")}).catch(function(e){h.debug("play promise rejected after video source received")})),clearInterval(m),clearInterval(A),t||(h.debug("add time update interval for play stats"),m=setInterval(u,100),"function"==typeof E.getVideoPlaybackQuality&&(h.debug("add quality update interval"),A=setInterval(c,1e3))))}},{type:M.PLAY,listener:i},{type:M.PAUSE,listener:function(){if(h.debug("onPause"),E&&(E.pause(),O=!1,a({data:{rate:1}}),D.isIOS11||!D.isIOS&&D.mustUseHLS))for(var e=0;e<f.children.length;e+=1){var t=f.children[e];t&&t.tagName&&"IFRAME"===t.tagName&&t.contentWindow.location.reload(!0)}}},{type:M.SEEK,listener:function(e){E&&(h.debug("seek to: "+e.data.position),E.currentTime=e.data.position)}},{type:M.MUTE,listener:n},{type:M.UNMUTE,listener:o},{type:M.SET_VOLUME,listener:function(e){I=Math.min(1,Math.max(0,e.data.volume)),E&&E.volume!==I&&(h.debug("set volume: "+e.data.volume),E.volume=I)}},{type:M.SET_RATE,listener:a}],C=[];return function(){U.add({target:r,listeners:v});var e,t=[w.TIME_UPDATE];for(e in w)w.hasOwnProperty(e)&&-1===t.indexOf(w[e])&&C.push({type:w[e],listener:s})}(),{destroy:function(){U.remove({target:r,listeners:v}),e()}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){var o,i;return{play:function(r){return new Promise(function(t,n){var e=r.play();Promise.all([e]).then(function(e){t({media:r})}).catch(function(e){o=e&&e.name?e.name:"Unknown",i=e&&e.message?e.message:"Message not available.",n({media:r,error:{name:o,message:i}})})})}}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return{ABORT_ERROR:"AbortError",NOT_ALLOWED_ERROR:"NotAllowedError"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return{BASE:"",LOAD_START:"loadstart",PROGRESS:"progress",SUSPEND:"suspend",ABORT:"abort",EMPTIED:"emptied",STALLED:"stalled",PLAY:"play",PAUSE:"pause",LOADED_META_DATA:"loadedmetadata",LOADED_DATA:"loadeddata",WAITING:"waiting",ERROR:"error",PLAYING:"playing",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",SEEKING:"seeking",SEEKED:"seeked",TIME_UPDATE:"timeupdate",ENDED:"ended",RATE_CHANGE:"ratechange",DURATION_CHANGE:"durationchange",VOLUME_CHANGE:"volumechange"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(26),n(15),n(48),n(89),n(74),n(75),n(71),n(76),n(90)],n=function(m,A,_,S,h,R,O,g,N){return{create:function(e){function t(){c.debug("create mediasource"),s=new window.MediaSource,A.add({target:s,listeners:p}),T.push(N.create(e,s,d.timestampReset,f,E?u:null))}function n(){if(s){for(c.debug("destroy mediasource"),A.remove({target:s,listeners:p});T.length;)T.pop().destroy();s=null}}function r(){c.debug("bind mediasource"),e.emit(h.VIDEO_SOURCE,{src:window.URL.createObjectURL(s),type:_.MP4})}function o(){n(),t(),r()}function i(e){f=0,u&&u.onStreamInfo.mimeType!=e.data.onStreamInfo.mimeType?(c.debug("new mime type received"),u=e.data,f=s&&s.activeSourceBuffers.length&&s.activeSourceBuffers[s.activeSourceBuffers.length-1].buffered.length?s.activeSourceBuffers[s.activeSourceBuffers.length-1].buffered.end(s.activeSourceBuffers[s.activeSourceBuffers.length-1].buffered.length-1):0,E=!0,o(),E=!1):u=e.data}function a(){return{readyState:s.readyState}}var s,u,c=m.create("MediaSourceProxy"),d={timestampReset:!1},E=!1,f=0,l=[{type:O.STREAM_INFO,listener:i},{type:O.STREAM_INFO_UPDATE,listener:i},{type:h.UPDATE_SOURCE,listener:function(e){d=e.data.options}},{type:R.ELEMENT_CREATED,listener:function(){r()}}],p=[{type:S.SOURCE_OPEN,listener:function(){c.debug("open"),e.emit(g.SOURCE_OPEN,a())}},{type:S.SOURCE_ENDED,listener:function(){c.debug("ended"),o(),e.emit(g.SOURCE_ENDED,a())}},{type:S.SOURCE_CLOSED,listener:function(){c.debug("closed"),o(),e.emit(g.SOURCE_CLOSED,a())}}],T=[];return c.debug("create"),A.add({target:e,listeners:l}),t(),{destroy:function(){c.debug("destroy"),n(),A.remove({target:e,listeners:l})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){return{BASE:"",SOURCE_OPEN:"sourceopen",SOURCE_ENDED:"sourceended",SOURCE_CLOSED:"sourceclosed"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(26),n(25),n(15),n(91),n(89),n(74),n(75),n(71),n(76),n(8)],n=function(H,W,K,j,q,z,X,J,Q,Z){return{create:function(o,i,t,n,r){function a(e,t){c({command:P,from:e,to:t})}function s(e){c({command:L,position:e})}function u(e){c({command:w,offset:e})}function c(e){e.count=I++,(C?function(e){{var t,n,r;h.debug("queue "+e.command+" "+e.count),e.force?b.unshift(e):e.command===D&&b.length&&b[b.length-1].command===D?(v+1<N?(t=b[b.length-1].fragment,n=e.fragment,(r=new Uint8Array(t.byteLength+n.byteLength)).set(new Uint8Array(t),0),r.set(new Uint8Array(n),t.byteLength),b[b.length-1].fragment=r,b[b.length-1].count=b[b.length-1].count.toString()+" & "+e.count,v++):(v=0,h.debug("joined fragments threshold ("+N+") reached so begin new one"),b.push(e)),h.debug("joined fragments count "+v)):(v=0,h.debug("joined fragments count "+v),b.push(e))}}:d)(e)}function d(e){h.debug("execute "+e.command+" "+e.count);var t="ranges ";if(T.buffered.length)for(var n=0,r=T.buffered.length;n<r;n+=1)t+=n+" "+T.buffered.start(n)+" - "+T.buffered.end(n),n!==r-1&&(t+=", ");else t+="0";switch(h.debug(t),e.command){case D:C=!0,M?(h.debug("append "+e.count),T.appendBuffer(e.fragment),p()||y++):E();break;case P:C=!0,T.buffered.length&&0<T.buffered.end(T.buffered.length-1)?(T.remove(e.from,e.to),h.debug("removed buffer from "+e.from+" to "+e.to+" "+e.count)):E();break;case U:C=!0,F=1,h.debug("append enabled after reset"),M=!0,e.zeroing?(h.debug("zeroing mse duration"),i.duration=0):E();break;case L:C=!0,h.debug("seek to position "+e.position+" "+e.count),o.emit(z.SEEK,{position:e.position}),E();break;case w:C=!0,T&&(h.debug("offset "+e.offset+" "+e.count),T.timestampOffset=e.offset),E()}}function E(){var e;-1<k&&T&&T.buffered.length&&(e=parseFloat(k.toString()),k=-1,h.debug("have buffer and start time on update end"),0<e?(h.debug("from stream info update"),s(t?0:e)):0===e&&(h.debug("from stream info"),s(t?e:n))),C=!1,F&&(F=0,h.debug("source ready"),o.emit(Q.SOURCE_READY)),b.length?d(b.shift()):!S&&T.buffered.length&&T.buffered.start(0)<m-R&&p()&&(S=setTimeout(function(){clearTimeout(S),S=0},x),h.debug("remove buffer"),a(T.buffered.start(0),m-O))}function e(e){h.debug("stream info"),r=e.data.onStreamInfo,_=r&&r.mimeType?r.mimeType:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',i&&"open"===i.readyState?-1!==[Z.PLAYING,Z.BUFFERING].indexOf(A)?G=!1:T?c({command:U,zeroing:W.isTridentBrowser&&!isNaN(i.duration)&&0<i.duration}):(h.debug("init sourcebuffer after stream info"),l()):(h.debug("add source open listener after stream info"),i.addEventListener(q.SOURCE_OPEN,f))}function f(){h.debug("mediasource open"),i.removeEventListener(q.SOURCE_OPEN,f),h.debug("init sourcebuffer"),l()}function l(){!T&&i&&"open"===i.readyState&&(h.debug("create source buffer with mime type '"+_+"'"),T=i.addSourceBuffer(_),K.add({target:o,listeners:Y}),K.add({target:T,listeners:V}),h.debug("append enabled init source buffer"),M=!0,C&&E(),o.emit(Q.SOURCE_READY))}function p(){return g<y}var T,m,A,_,S,h=H.create("SourceBufferQueue "+(new Date).toLocaleTimeString()),R=30,O=20,g=300,N=30,y=0,I=0,v=0,C=!1,b=[],D="append",P="remove",U="reset",L="seek",w="offset",M=!1,r=r||void 0,t=!!t,F=0,G=!1,k=-1,n=n||0,x=1e4,B=[{type:J.STREAM_INFO,listener:e},{type:J.STREAM_INFO_UPDATE,listener:e},{type:J.STREAM_FRAGMENT,listener:function(e){if(!G){for(var t="",n=4;n<8;++n)t+=String.fromCharCode(e.data[n]);if(-1===["moov","ftyp"].indexOf(t))return void h.debug("dropping fragment: "+t);h.debug("initialized with "+t),G=!0}var r;r=e.data,c({command:D,fragment:r})}},{type:J.RANDOM_ACCESS_POINT,listener:function(e){h.debug("random access point streamtime "+e.data.onRandomAccessPoint.streamTime),G||(k=Math.floor(e.data.onRandomAccessPoint.streamTime)/1e3,h.debug("set start time to random access point"),e=parseFloat(k.toString()),T&&T.buffered.length&&(k=-1),0<e?(h.debug("from stream info update"),t&&(u(-e),a(y=0,1/0))):0===e&&(h.debug("from stream info"),t?(a(y=0,1/0),u(0)):u(n)),T&&T.buffered.length&&(h.debug("have buffer and start time"),0<e?(h.debug("from stream info update"),t&&s(0)):0===e&&(h.debug("from stream info"),t?s(e):u(T.buffered.end(T.buffered.length-1)))))}},{type:z.UPDATE_SOURCE,listener:function(e){t=e.data.options.timestampReset}}],Y=[{type:X.TIME_UPDATE,listener:function(e){m=e.data.currentTime,A!==Z.PAUSED&&h.debug("current time "+m)}},{type:J.APPLICATION_STATE_CHANGE,listener:function(e){(A=e.data.state)===Z.PAUSED&&function(){for(h.debug("pause"),M=G=!1;b.length;)b.pop();a(0,1/0),n=y=0}()}}],V=[{type:j.UPDATE_END,listener:E}];return K.add({target:o,listeners:B}),r&&(C=!0,e({data:r})),{destroy:function(){for(;b.length;)b.pop();K.remove({target:o,listeners:B}),K.remove({target:o,listeners:Y}),T&&K.remove({target:T,listeners:V}),i.removeEventListener(q.SOURCE_OPEN,f),T=null}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){return{BASE:"",ABORT:"abort",ERROR:"error",UPDATE:"update",UPDATE_START:"updatestart",UPDATE_END:"updateend"}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){var n=[n(26),n(15),n(74),n(71)],n=function(i,a,s,u){return{create:function(e){function t(){n&&"function"==typeof n.close&&(n.close(),n=null)}var n,r=i.create("FakeAudioContext"),o=[{type:u.STREAM_INFO,listener:function(e){t(),e.data.onStreamInfo.haveAudio||(window.AudioContext=window.AudioContext||window.webkitAudioContext||function(){return{close:function(){}}},n=new AudioContext)}},{type:s.PAUSE,listener:t}];return r.debug("initialize"),a.add({target:e,listeners:o}),{destroy:function(){t(),a.remove({target:e,listeners:o})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(26),n(25),n(15),n(74),n(71),n(75),n(8)],n=function(r,o,f,l,p,T,m){return{create:function(i){function a(e,t){for(var n=0;n<t.length-1&&t.start(n+1)<=e;)n++;return n}function s(e,t){for(var n=0;n<t.length-1&&t.start(n)<=e;)n++;return n}var t,u,c=.2,d=r.create("GapHandler"),E=0,e=[{type:p.APPLICATION_STATE_CHANGE,listener:function(e){t=e.data.state,f.remove({target:i,listeners:n}),(o.isTridentBrowser&&t===m.PLAYING||!o.isTridentBrowser&&t!==m.PAUSED)&&f.add({target:i,listeners:n})}}],n=[{type:T.TIME_UPDATE,listener:function(e){var t,n,r=a(e.data.currentTime,e.data.buffered),o=s(e.data.currentTime,e.data.buffered);if(u===e.data.currentTime){if(++E<10)return;r<o&&(r=e.data.buffered,.5<((n=o)<r.length?r.end(n)-r.start(n):0))&&(n=e.data.currentTime,t=e.data.buffered,n+c>=t.end(a(n,t)))&&(t=e.data.buffered.start(s(e.data.currentTime,e.data.buffered)),d.debug("recover gap, seek to "+t,3),i.emit(l.SEEK,{position:t}),i.emit(l.PLAY,{external:!1}))}u=e.data.currentTime,E=0}}];return d.debug("initialize"),f.add({target:i,listeners:e}),{destroy:function(){f.remove({target:i,listeners:e}),f.remove({target:i,listeners:n})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(26),n(22),n(15),n(73),n(71),n(78),n(8)],n=function(i,a,s,u,c,d,E){return{create:function(n){var r,t=i.create("HLSJumpHandler"),e=[{type:c.APPLICATION_STATE_CHANGE,listener:function(e){switch(s.remove({target:n,listeners:o}),e.data.state){case E.PAUSED:case E.PAUSING:t.debug("entering paused state"),r=null;break;case E.PLAYING:s.add({target:n,listeners:o})}}}],o=[{type:d.PLAY_STATS,listener:function(e){var t;r&&void 0!==r.currentTime&&e.data.stats.currentTime<r.currentTime-2&&(t={currentTime:{last:r.currentTime,current:e.data.stats.currentTime}},n.emit(u.ERROR,t)),r=a.copy(e.data.stats)}}];return t.debug("initialize"),s.add({target:n,listeners:e}),{destroy:function(){s.remove({target:n,listeners:e})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(10),n(26),n(25),n(15),n(73),n(74),n(71),n(75),n(8)],n=function(c,d,E,f,l,p,T,m,A){return{create:function(n){function e(e){s=e.name===T.DOCUMENT_HIDDEN,i.debug(s?"hidden":"visible"),s&&c.mobile&&(r===A.PLAYING||r===A.LOADING||r===A.BUFFERING)&&n.emit(l.SUSPENDED)}function t(e){var t=e.data.buffered.length?e.data.buffered.end(0)-e.data.currentTime:"n.a.";(o&&e.name===m.PAUSE||s&&c.mobile)&&r===A.PLAYING?n.emit(l.SUSPENDED):a=a||setTimeout(function(){r===A.PLAYING&&(i.debug("nanoplayer: recover unexpected pause type "+e.name+", delay = "+t,3),n.emit(p.PLAY,{external:!1})),a=0},200)}var r,o,i=d.create("PauseHandler"),a=0,s=!1,u=[{type:m.PAUSE,listener:t},{type:m.WAITING,listener:t},{type:m.ENDED,listener:t},{type:T.APPLICATION_STATE_CHANGE,listener:function(e){r=e.data.state}},{type:T.CONFIG,listener:function(e){o=E.mustUseHLS||e.data.config.playback.allowSafariHlsFallback&&E.canUseHLS}},{type:T.DOCUMENT_VISIBLE,listener:e},{type:T.DOCUMENT_HIDDEN,listener:e}];return i.debug("initialize"),f.add({target:n,listeners:u}),{destroy:function(){f.remove({target:n,listeners:u})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(26),n(15),n(8),n(74),n(71),n(75),n(77)],n=function(m,A,_,e,S,h,R){return{create:function(n){function t(e){f=e.data.onStreamInfo.haveVideo&&(l=e.data.onStreamInfo.videoInfo.frameRate)}function r(){clearInterval(p),A.remove({target:n,listeners:T}),p=0,function(){for(a={droppedVideoFrames:0,droppedVideoFramesCurrent:0,corruptedVideoFrames:0,corruptedVideoFramesCurrent:0,creationTime:0,totalVideoFrames:0};E.length;)E.pop()}()}function o(){if(s===_.PLAYING){var e=i("extreme");if(e=!(e=!e?i("high"):e)?i("medium"):e){for(u.debug("frame drop detected with type '"+e.type+"'"),u.debug(e.frames.dropped+" frames in last "+e.samples.all.length+" seconds dropped");E.length;)E.pop();n.emit(R.FRAME_DROP,e)}}}function i(t){if(E.length>d[t].samplesRange-1){var e=E.slice(-d[t].samplesRange),n=e.filter(function(e){return e.count>=l*d[t].ratioThreshold});if(n.length>d[t].samplesMatchAllowed){var r=0;return e.forEach(function(e){r+=e.count}),{type:t,framerate:l,samples:{all:e,matched:n,limit:Math.ceil(l*d[t].ratioThreshold)},frames:{dropped:r}}}}return!1}var a,s,u=m.create("QualityHandler"),c=1e3,d={extreme:{ratioThreshold:.95,samplesRange:3,samplesMatchAllowed:1},high:{ratioThreshold:.2,samplesRange:5,samplesMatchAllowed:1},medium:{ratioThreshold:.1,samplesRange:10,samplesMatchAllowed:3}},E=[],f=!1,l=0,p=0,e=[{type:S.APPLICATION_STATE_CHANGE,listener:function(e){(s=e.data.state)===_.PAUSED?r():!p&&f&&s===_.PLAYING&&(r(),A.add({target:n,listeners:T}),p=setInterval(o,c))}},{type:S.STREAM_INFO,listener:t},{type:S.STREAM_INFO_UPDATE,listener:function(e){t(e)}}],T=[{type:h.QUALITY_UPDATE,listener:function(e){for(var t in e.data.quality)if(a.hasOwnProperty(t)){if("droppedVideoFrames"===t){for(a.droppedVideoFramesCurrent=e.data.quality.droppedVideoFrames-a.droppedVideoFrames;9<E.length;)E.shift();E.push({count:a.droppedVideoFramesCurrent,time:e.data.currentTime})}"corruptedVideoFrames"===t&&(a.corruptedVideoFramesCurrent=e.data.quality.corruptedVideoFrames-a.corruptedVideoFrames),a[t]=e.data.quality[t]}n.emit(R.QUALITY_STATS,a)}}];return A.add({target:n,listeners:e}),{destroy:function(){A.remove({target:n,listeners:e}),A.remove({target:n,listeners:T})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(35),n(15),n(26),n(25),n(82),n(8),n(71),n(74),n(75),n(78)],n=function(S,h,R,O,g,N,y,e,I,v){return{create:function(t){function r(e){t.emit(v.PLAY_STATS,{stats:i,buffered:e?e.data.buffered:null,played:e?e.data.played:null,currentTime:e?e.data.currentTime:0,playbackRate:e?e.data.playbackRate:0})}function o(e,t){t.avg=e.arithmetic,t.min=e.minimum,t.max=e.maximum}function n(){i={currentTime:0,playout:{start:0,end:0},buffer:{start:0,end:0,delay:{before:0,current:0,avg:0,min:0,max:0},update:{current:0,avg:0,min:0,max:0}},quality:{droppedVideoFrames:0,droppedVideoFramesCurrent:0,corruptedVideoFrames:0,corruptedVideoFramesCurrent:0,creationTime:0,totalVideoFrames:0},bitrate:{current:0,avg:0,min:0,max:0},framerate:{current:0,avg:0,min:0,max:0}},c=g.create(10),d=g.create(10),E=g.create(10),f=g.create(10),p=l=0,r(null)}var i,a,s,u,c,d,E,f,l,p,T=R.create("StatsCollector"),m=0,e=[{type:y.APPLICATION_STATE_CHANGE,listener:function(e){switch(a=e.data.state){case N.PAUSED:T.debug("remove stats listener"),h.remove({target:t,listeners:_});break;case N.PLAYING:break;case N.LOADING:n(),s&&(T.debug("hls: add stats listener"),h.add({target:t,listeners:_}))}}},{type:y.CONFIG,listener:function(e){s=O.mustUseHLS||e.data.config.playback.allowSafariHlsFallback&&O.canUseHLS}}],A=[{type:y.STREAM_FRAGMENT,listener:function(e){l+=1,p+=e.data.byteLength}},{type:y.STREAM_INFO,listener:function(e){s||(T.debug("wss: add stats listener"),h.add({target:t,listeners:_})),u=e.data.onStreamInfo.haveVideo}},{type:y.STREAM_INFO_UPDATE,listener:function(e){u=e.data.onStreamInfo.haveVideo}}],_=[{type:I.TIME_UPDATE,listener:function(e){var t=e.data.buffered.length-1,n=e.data.played.length-1;i.currentTime=a===N.LOADING?0:e.data.currentTime,0<=n&&(i.playout.start=e.data.played.start(n),i.playout.end=e.data.played.end(n)),0<=t&&(!s||i.buffer.end!==e.data.buffered.end(t)||e.data.buffered.end(t)<i.currentTime)&&(i.buffer.update.current=e.data.buffered.end(t)-i.buffer.end,i.buffer.delay.before=i.buffer.end-i.currentTime,i.buffer.start=e.data.buffered.start(t),i.buffer.end=e.data.buffered.end(t),i.buffer.delay.current=i.buffer.end-i.currentTime,c.add(i.buffer.delay.current),o(c,i.buffer.delay),d.add(i.buffer.update.current),o(d,i.buffer.update)),S&&!s&&(t=Math.floor(S.now()/1e3),m!==t&&(m=t,i.bitrate.current=8*p,E.add(i.bitrate.current),o(E,i.bitrate),u&&(i.framerate.current=l,f.add(i.framerate.current),o(f,i.framerate)),p=l=0)),r(e)}}];return n(),h.add({target:t,listeners:e}),h.add({target:t,listeners:A}),{destroy:function(){h.remove({target:t,listeners:A}),h.remove({target:t,listeners:e})}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){var n=[n(71)],n=function(n){return{create:function(e){function t(e){window.fragments||(window.fragments=[]),window.fragments.push(e.data)}return function(e){return-1!==document.cookie.indexOf(e+"=")?document.cookie.split(e+"=")[1].split(";")[0]:null}("nanoDump")&&e.addListener(n.STREAM_FRAGMENT,t),{destroy:function(){e.removeListener(n.STREAM_FRAGMENT,t)}}}}}.apply(t,n);void 0===n||(e.exports=n)},function(e,t,n){t=function(){return{FORCE_NOT_SUPPORTED:'The forced tech "$tech$" is not supported by your browser.',SOURCE_NOT_SUPPORTED:"The players source configuration is malformed or missing, please check documentation for more information or contact us.",CLIENT_NOT_SUPPORTED:"This browser does not fully support HTML5 and H5Live.\t            Supported are: Chrome >=54 (Windows, MacOSX, Android), Firefox >=48 (Windows, MacOSX, Android), Microsoft Edge (Windows), Microsoft Internet Explorer 11 (at least Windows 8), Safari (MacOSX & at least iOS 10)."}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){return{create:function(t,n,r){function o(e){r.emit(e.name,e)}return function(){for(var e in n)n.hasOwnProperty(e)&&t.on(n[e],o)}(),{destroy:function(){for(var e in n)n.hasOwnProperty(e)&&t.off(n[e],o)}}}}}.apply(t,[]);void 0===t||(e.exports=t)},function(e,t,n){t=function(){function r(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(e,this)}function o(n,r){for(;3===n._state;)n=n._value;return 0===n._state?void n._deferreds.push(r):(n._handled=!0,void i._immediateFn(function(){var e,t=1===n._state?r.onFulfilled:r.onRejected;if(null!==t){try{e=t(n._value)}catch(e){return void s(r.promise,e)}a(r.promise,e)}else(1===n._state?a:s)(r.promise,n._value)}))}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void u(t);if("function"==typeof n)return void d((r=n,o=e,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=e,u(t)}catch(e){s(t,e)}var r,o}function s(e,t){e._state=2,e._value=t,u(e)}function u(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function c(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function d(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,s(t,e))})}catch(e){if(n)return;n=!0,s(t,e)}}var t=setTimeout;return i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(r);return o(this,new c(e,t,n)),n},i.all=function(e){var s=Array.prototype.slice.call(e);return new i(function(o,i){if(0===s.length)return o([]);for(var a=s.length,e=0;e<s.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if("function"==typeof r)return r.call(e,function(e){t(n,e)},i),0}s[n]=e,0==--a&&o(s)}catch(e){i(e)}}(e,s[e])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(n){return new i(function(e,t){t(n)})},i.race=function(o){return new i(function(e,t){for(var n=0,r=o.length;n<r;n++)o[n].then(e,t)})},i._immediateFn="function"==typeof window.setImmediate?function(e){window.setImmediate(e)}:function(e){t(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},void 0===window.Promise&&(window.Promise=i),window.Promise}.apply(t,[]);void 0===t||(e.exports=t)}],o={},n.m=r,n.c=o,n.p="",n(0);function n(e){if(o[e])return o[e].exports;var t=o[e]={exports:{},id:e,loaded:!1};return r[e].call(t.exports,t,t.exports,n),t.loaded=!0,t.exports}var r,o});
