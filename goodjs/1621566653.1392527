define(["OK/utils/dom"],(function(e){"use strict";var t="toolbar_dropdown_w_hover";function n(){}return n.prototype.closeDropdown=function(){window.setTimeout(function(){this.element.classList.remove(t),document.removeEventListener("mousedown",this.boundDocumentClick,!1)}.bind(this),this.closeTimeout)},n.prototype.documentClick=function(t){var n=!1;this.element.contains(t.target)?e.parent(t.target,"u-menu_a",this.element,!0)&&(n=!0):n=!0,n&&this.closeDropdown()},n.prototype.cardClick=function(){this.element.classList.contains(t)?this.closeDropdown():(this.element.classList.add(t),document.addEventListener("mousedown",this.boundDocumentClick,!1)),this.isBubbleHidden||(this.isBubbleHidden=!0,window.navigateOnUrlFromJS(this.closeBubbleHandle))},n.prototype.mouseEnterHandler=function(){window.clearTimeout(this.timeoutHandle)},n.prototype.mouseLeaveHandler=function(){window.clearTimeout(this.timeoutHandle),this.timeoutHandle=window.setTimeout(this.boundCloseDropdown,700)},n.prototype.activate=function(t){this.element=t,this.closeTimeout=parseInt(this.element.getAttribute("data-timeout"),10),this.card=e.firstByClass(this.element,"js-toolbar-menu"),this.timeoutHandle=null,this.dropdown=e.firstByClass(this.element,"toolbar_dropdown"),this.closeBubbleHandle=this.element.getAttribute("data-hide-dropdown"),this.isBubbleHidden=!this.closeBubbleHandle,this.boundDocumentClick=this.documentClick.bind(this),this.boundCardClick=this.cardClick.bind(this),this.boundCloseDropdown=this.closeDropdown.bind(this),this.boundMouseEnter=this.mouseEnterHandler.bind(this),this.boundMouseLeave=this.mouseLeaveHandler.bind(this),this.card.addEventListener("click",this.boundCardClick,!1),this.element.addEventListener("mouseenter",this.boundMouseEnter,!1),this.element.addEventListener("mouseleave",this.boundMouseLeave,!1)},n.prototype.deactivate=function(){this.card.removeEventListener("click",this.boundCardClick),document.removeEventListener("mousedown",this.boundDocumentClick),this.element.removeEventListener("mouseenter",this.boundMouseEnter),this.element.removeEventListener("mouseleave",this.boundMouseLeave)},new n}));