(this.$WP=this.$WP||[]).push(["fTyhRT",(e,r)=>{"use strict";var n,a,s,u,d,c,I,o,T,p,v,f,h=e=>{var[,r]=I(u),[t,l]=n.useState({fetching:!1}),d=T("SAVE_TO_TRIP"),i=n.useRef(!0),a=n.useCallback(e=>{i.current&&l(e)},[]);if(n.useEffect(()=>()=>{i.current=!1},[]),!e)return[t,()=>Promise.resolve([null,null])];var s=e;return[t,e=>(a({fetching:!0}),r({tripId:e,referenceId:""+s.id,referenceType:s.type,allowDuplicates:!1}).then(e=>{var r,t,l,i,n=null==e||null==(r=e.data)||null==(n=r.addItemToTrip)?void 0:n.trip,u=null==e||null==(t=e.data)||null==(l=t.addItemToTrip)||null==(u=l.errors)||null==(i=u[0])?void 0:i.error;return n?(i=o(n,s))?(d(),a({fetching:!1,result:{trip:n,tripItem:i}})):"bundleSave"===s.type?a({fetching:!1,result:{trip:n,tripItem:{__typename:"TripItem",id:0,comments:[]}}}):a({fetching:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:u}}):a({fetching:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:u}}),[n,u]}).catch(e=>(console.error(e),a({fetching:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),[null,null])))]},t=(t,l,i,n)=>{var[e,u]=h(l),d=a(v)["userId"];return[e,s(()=>{var e,r,r=null!=t?t:(e=d,(r=p.get("mostRecentlyAddedToTrip"))&&r.userId===e?r.tripId:null);return i||!r||f.has(null==l?void 0:l.type)?(n&&n(),Promise.resolve([null,null])):u(r)},[i,l,n,u,d,t]),e=>{d?p.set("mostRecentlyAddedToTrip",{tripId:e,userId:d},144e5):p.remove("mostRecentlyAddedToTrip")}]},l=(e,r,t)=>{var[o,T]=n.useState({fetching:!1,saved:!!t}),[,l]=I(d),[,i]=I(c);return[o,t?()=>t?(T(Object.assign({},o,{fetching:!0})),i({itemId:t.id,tripId:r}).then(e=>{var r=null==e||null==(r=e.data)?void 0:r.tripsRemoveItem;return T(r?{fetching:!1,saved:!1,result:{trip:r}}:{fetching:!1,saved:!0,error:{query:"REMOVE_TRIP_ITEM",tripsError:void 0}}),o}).catch(()=>(T({fetching:!1,saved:!0,error:{query:"REMOVE_TRIP_ITEM"}}),o))):Promise.resolve(o):()=>(T(Object.assign({},o,{fetching:!0})),l({tripId:r,referenceId:""+e.id,referenceType:e.type,allowDuplicates:!1}).then(e=>{var r,t,l,i,n,u,d=null==e||null==(r=e.data)||null==(d=r.addItemToTrip)?void 0:d.trip,a=null==e||null==(t=e.data)||null==(l=t.addItemToTrip)||null==(i=l.errors)||null==(a=i[0])?void 0:a.error;if(a||!d)return T({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:a||void 0}}),o;var s=null==e||null==(n=e.data)||null==(u=n.addItemToTrip)||null==(s=u.items)?void 0:s[0];return T(s?{fetching:!1,saved:!0,result:{trip:d,tripItem:s}}:{fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),o}).catch(()=>(T({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),o)))]};return[()=>{f=new Set(["savesItem","bundleSave"]),e({useAutosave:t,useSave:h,useTripSaveToggle:l})},[e=>(a=(n=e).useContext,s=e.useCallback),e=>(u=e.AddItemToTrip,d=e.AddItemWithFullTrip,c=e.RemoveItemWithFullTrip),e=>I=e.useMutation,e=>o=e.getItemByReference,e=>T=e.usePixelCallback,e=>p=e.default,e=>v=e.Visitor]]},["cDcdfi","RXx5aI","5X2em-","eFKnUp","jb_4W2","jaCyxS","2R4xv2"]]);
