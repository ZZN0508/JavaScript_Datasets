define("pkg/@alife/refly-db/3.x/index",["pkg/@alife/refly-monitor/0.0.x/index","jquery"],function(e,r){return o=[function(t,n){t.exports=e},function(t,n,e){"use strict";function r(){}var i=(function(t,n,e){return n&&s(t.prototype,n),e&&s(t,e),t}(o,[{key:"done",value:function(t){return this.sucCbs.push(t),this}},{key:"fail",value:function(t){return this.errCbs.push(t),this}},{key:"final",value:function(t){return this.finCbs.push(t),this}},{key:"catch",value:function(t){return this.catCbs.push(t),this}},{key:"fire",value:function(t,n,e){for(var r=0,i=t.length;r<i;r++)t[r](n,e);return this}},{key:"resolve",value:function(t,n){this.fire(this.sucCbs,t,n).fire(this.finCbs,t,n),this.status&&(n&&1===this.status&&(this.firstCbs[0]&&this.firstCbs[0](t),this.status=2),n||(1===this.status&&this.firstCbs[0]&&this.firstCbs[0](t),this.secondCbs[0]&&this.secondCbs[0](t),this.status=3))}},{key:"reject",value:function(t,n){if("dev"===window._ENV_&&0===this.errCbs.length)throw new Error("You need use fail method to get the error: "+JSON.stringify(t));this.fire(this.errCbs,t,n).fire(this.finCbs,t,n),this.status&&(1===this.status?this.firstCbs[1]&&this.firstCbs[1](t):2===this.status&&this.secondCbs[1]&&this.secondCbs[1](t),this.status=0)}},{key:"_first",value:function(){var e=this;return this._first=r,this.status=1,new Promise(function(t,n){e.firstCbs.push(t,n)})}},{key:"_sencond",value:function(){var e=this;return this._sencond=r,this.status=1,new Promise(function(t,n){e.secondCbs.push(t,n)})}}]),o);function o(){var n=this;(function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")})(this,o),this.sucCbs=[],this.errCbs=[],this.finCbs=[],this.firstCbs=[],this.secondCbs=[],this.catCbs=[],this.status=0;for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];0<e.length&&(Promise.all(e.map(function(t){return t._first()})).then(function(t){n.resolve(t,"FIRST")},function(t){n.reject(t)}),Promise.all(e.map(function(t){return t._sencond()})).then(function(t){n.resolve(t,"SECOND")},function(t){n.reject(t)}))}function s(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=i},function(t,n,e){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=function(t){var n="DB("+t.url+")";return n="object"===r(t._inject_)?"Component("+t._inject_.name+"@"+t._inject_.version+")."+n:n}},function(t,n){t.exports=r},function(t,n,e){"use strict";var r=function(t,n,e){return n&&p(t.prototype,n),e&&p(t,e),t},i=e(5),o=e(3),s=e(7),l=e(9),u=e(1),a=e(8),r=(function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(c,i),r(c,[{key:"ajax",value:function(t,n){var e=this;n=n||new u;var r=this.applyPluginsWaterfall("options",o.extend({},this.options,t));return this.applyPluginsBailResult("endpoint",r,n)(r).then(a(function(t){!1===e.applyPluginsBailResult("judge",t,r)?(t=e.applyPluginsWaterfall("error",t,r),n.reject(t)):e.applyPlugins("resolve",t,r,n)},n,r),a(function(t){t=e.applyPluginsWaterfall("error",t,r),n.reject(t)},n,r)),n}},{key:"get",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return n.method="GET",n.data=t,this.ajax(n)}},{key:"post",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return n.method="POST",n.data=t,this.ajax(n)}},{key:"jsonp",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return n.dataType="JSONP",n.data=t,this.ajax(n)}}]),c);function c(t){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,c);var n=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));return n.options=o.extend({},t||{},n.constructor.defaultOptions),s(n),l(n),n}function p(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=r},function(t,n){function a(t){"use strict";if(null==this)throw new TypeError;var n=Object(this),e=n.length>>>0;if("function"!=typeof t)throw new TypeError;for(var r,i=[],o=2<=arguments.length?arguments[1]:void 0,s=0;s<e;s++)s in n&&(r=n[s],t.call(o,r,s,n)&&i.push(r));return i}function e(){this._plugins={}}function c(t,n){for(var e in t)n[e]=t[e];return n}(t.exports=e).mixin=function(t){c(e.prototype,t)},e.prototype.applyPlugins=function(t){if(this._plugins[t])for(var n=Array.prototype.slice.call(arguments,1),e=this._plugins[t],r=0;r<e.length;r++)e[r].apply(this,n)},e.prototype.applyPlugins0=function(t){var n=this._plugins[t];if(n)for(var e=0;e<n.length;e++)n[e].call(this)},e.prototype.applyPlugins1=function(t,n){var e=this._plugins[t];if(e)for(var r=0;r<e.length;r++)e[r].call(this,n)},e.prototype.applyPlugins2=function(t,n,e){var r=this._plugins[t];if(r)for(var i=0;i<r.length;i++)r[i].call(this,n,e)},e.prototype.applyPluginsWaterfall=function(t,n){if(!this._plugins[t])return n;for(var e=Array.prototype.slice.call(arguments,2),r=this._plugins[t],i=n,o=0;o<r.length;o++)i=r[o].apply(this,[i].concat(e));return i},e.prototype.applyPluginsWaterfall0=function(t,n){var e=this._plugins[t];if(!e)return n;for(var r=n,i=0;i<e.length;i++)r=e[i].call(this,r);return r},e.prototype.applyPluginsBailResult=function(t){if(this._plugins[t])for(var n=Array.prototype.slice.call(arguments,1),e=this._plugins[t],r=0;r<e.length;r++){var i=e[r].apply(this,n);if(void 0!==i)return i}},e.prototype.applyPluginsBailResult1=function(t,n){if(this._plugins[t])for(var e=this._plugins[t],r=0;r<e.length;r++){var i=e[r].call(this,n);if(void 0!==i)return i}},e.prototype.applyPluginsAsyncSeries=e.prototype.applyPluginsAsync=function(t){var n=Array.prototype.slice.call(arguments,1),e=n.pop(),r=this._plugins[t];if(!r||0===r.length)return e();var i=0,o=this;n.push(c(e,function(t){return t?e(t):++i>=r.length?e():void r[i].apply(o,n)})),r[0].apply(this,n)},e.prototype.applyPluginsAsyncSeries1=function(t,n,e){var r=this._plugins[t];if(!r||0===r.length)return e();var i=0,o=this,s=c(e,function(t){return t?e(t):++i>=r.length?e():void r[i].call(o,n,s)});r[0].call(this,n,s)},e.prototype.applyPluginsAsyncSeriesBailResult=function(t){var n=Array.prototype.slice.call(arguments,1),e=n.pop();if(!this._plugins[t]||0===this._plugins[t].length)return e();var r=this._plugins[t],i=0,o=this;n.push(c(e,function(){return 0<arguments.length?e.apply(null,arguments):++i>=r.length?e():void r[i].apply(o,n)})),r[0].apply(this,n)},e.prototype.applyPluginsAsyncSeriesBailResult1=function(t,e,r){var i=this._plugins[t];if(!i||0===i.length)return r();var o=0,s=this,l=c(r,function(t,n){return 0<arguments.length?r(t,n):++o>=i.length?r():void i[o].call(s,e,l)});i[0].call(this,e,l)},e.prototype.applyPluginsAsyncWaterfall=function(t,n,e){if(!this._plugins[t]||0===this._plugins[t].length)return e(null,n);var r=this._plugins[t],i=0,o=this,s=c(e,function(t,n){return t?e(t):++i>=r.length?e(null,n):void r[i].call(o,n,s)});r[0].call(this,n,s)},e.prototype.applyPluginsParallel=function(t){var n=Array.prototype.slice.call(arguments,1),e=n.pop();if(!this._plugins[t]||0===this._plugins[t].length)return e();var r=this._plugins[t],i=r.length;n.push(c(e,function(t){if(!(i<0))return t?(i=-1,e(t)):0===--i?e():void 0}));for(var o=0;o<r.length;o++)if(r[o].apply(this,n),i<0)return},e.prototype.applyPluginsParallelBailResult=function(t){var n=Array.prototype.slice.call(arguments,1),e=n[n.length-1];if(!this._plugins[t]||0===this._plugins[t].length)return e();for(var r,i=this._plugins[t],o=i.length,s=[],l=0;l<i.length;l++)n[n.length-1]=function(n){return c(e,function(){o<=n||(s.push(n),0<arguments.length&&(o=n+1,s=a.call(s,function(t){return t<=n}),r=Array.prototype.slice.call(arguments)),s.length===o&&(e.apply(null,r),o=0))})}(l),i[l].apply(this,n)},e.prototype.applyPluginsParallelBailResult1=function(t,n,e){var r=this._plugins[t];if(!r||0===r.length)return e();for(var i,o=r.length,s=[],l=0;l<r.length;l++){var u=function(n){return c(e,function(){o<=n||(s.push(n),0<arguments.length&&(o=n+1,s=a.call(s,function(t){return t<=n}),i=Array.prototype.slice.call(arguments)),s.length===o&&(e.apply(null,i),o=0))})}(l);r[l].call(this,n,u)}},e.prototype.plugin=function(t,n){Array.isArray(t)?t.forEach(function(t){this.plugin(t,n)},this):this._plugins[t]?this._plugins[t].push(n):this._plugins[t]=[n]},e.prototype.apply=function(){for(var t=0;t<arguments.length;t++)arguments[t].apply(this)}},function(t,n,e){"use strict";var r=e(4),e=e(1);r.Defer=e,t.exports=r},function(t,n,e){"use strict";function r(t){var e,n=t.__key__||t.url+"?"+((e=t.data)?Object.keys(e).filter(function(t){return"_"!==t.charAt(0)}).sort().reduce(function(t,n){return t.push(n+"="+e[n]),t},[]).join("&"):"");return t.__key__=n}var o=e(10),s=e(3),i=e(0),l=e(2);t.exports=function(e){o.compat()&&(o.init(),e.plugin("options",function(t){return t.hasCache=function(t){if(t.nocache)return!1;var n=o.has(r(t),t.level);if(n&&t.lazy&&t.refresh){var e=+n.slice(n.length-13);if(t.refresh<+new Date-e)return!1}return n}(t),t.lazy&&!t.refresh&&(t.refresh=864e5),t}),e.plugin("endpoint",function(t,n){return t.hasCache?function(t,n){var e=o.get(n.hasCache),r=new Promise(function(t,n){setTimeout(function(){e&&t(s.extend({__flag__:"CACHE"},e))},0)});if(n.refresh&&!n.lazy){var i=n.hasCache,i=+i.slice(i.length-13);if(n.refresh>+new Date-i)return r}return this.ajax(s.extend({},n,{nocache:"again",hasCache:!1}),t),r}.bind(e,n):void(t.__start__=+new Date)}),e.plugin("resolve",function(t,n,e){if(n.nocache&&"again"!==n.nocache||t.__flag__||o.save(r(n),n.level,t),"again"!==n.nocache||!n.lazy)try{e.resolve(t,t.__flag__)}catch(t){throw t.message=l(n)+" "+t.message,i.log("error",t),t}}))}},function(t,n,e){"use strict";var i=e(2);t.exports=function(t,e,n){var r=i(n);return function(n){try{t(n)}catch(t){n=window.console;0===e.catCbs.length&&n&&n.warn&&(n.warn(r+" may have some error, please use catch method to catch error"),n.warn(t.toString())),e.fire(e.catCbs,t)}}}},function(t,n,e){"use strict";var r=e(0);t.exports=function(t){t.plugin("error",function(t,n){return r.reportState(n.url,!1,t.traceId&&"traceId="+t.traceId||null),t}),t.plugin("resolve",function(t,n){r.reportState(n.url,!0,void 0,+new Date-n.__start__),r.log("debug",{from:n.url,msg:t})})}},function(t,n,e){"use strict";function s(t,n){return 3<n?"refly"+n+"✂$_SYSTEM_$✂"+t+"✂":"refly"+n+"✂"+c+"✂"+t+"✂"}function a(t){for(var n=0,e=t.length;n<e;n++){var r=t[n],i=f.indexOf(r);0<=i&&f.splice(i,1),localStorage.removeItem(r)}}function l(e,r,i,o){i={r:i,v:p},setTimeout(function(){!function(t,n){for(var e=s(t,n),r=[],i=0,o=f.length;i<o;i++)0===f[i].indexOf(e)&&r.push(f[i]);a(r)}(e,r);var t=JSON.stringify(i);if(1e5<t.length)u.log("warn","[API_REPONSE_TOO_BIG]"+e);else{var n=""+s(e,r)+ +new Date;try{localStorage[n]=t,f.push(n)}catch(t){o<=r&&(function(t){var n=[];if(4<t)return f.length=0,localStorage.clear();if(0===t)for(var e=/refly[1-3]\u2702([^\u2702]+)/,r=0,i=f.length;r<i;r++){var o=f[r].match(e);o&&o[1]!==c&&n.push(f[r])}else for(var s="refly"+t+"✂",l=0,u=f.length;l<u;l++)0===f[l].indexOf(s)&&n.push(f[l]);a(n)}(o),l(e,r,i,o++))}}},0)}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=e(0),c=(e=document.cookie.match(/(^| )last_mid=([^;]*)(;|$)/))?e[2]:"$_stranger_$",p=1,i={},f=[];t.exports={init:function(){f=Object.keys(window.localStorage)},compat:function(){return!!window.localStorage},has:function(t){for(var n=s(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:1),e=0,r=f.length;e<r;e++)if(0===f[e].indexOf(n))return f[e];return!1},save:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,e=arguments[2];"object"===(void 0===e?"undefined":r(e))&&l(t,n,i[t]=e,0)},get:function(t){var n=t.split("✂"),e=void 0;if(!(e=3<n?i[n[2]]:e))try{e=(e=JSON.parse(localStorage[t])).v===p?e.r:(a([t]),!1)}catch(t){f.length=0,localStorage.clear(),e=!1}return e}}}],s={},i.m=o,i.c=s,i.d=function(t,n,e){i.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,value:e})},i.n=function(t){t=t&&t.__esModule?t.default:t;return i.d({},"a",t),t},i.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},i.p="",i(i.s=6);function i(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return o[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}var o,s});
