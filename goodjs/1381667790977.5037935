!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).videojsContribHls=e()}(function(){return function n(a,r,s){function o(i,e){if(!r[i]){if(!a[i]){var t="function"==typeof require&&require;if(!e&&t)return t(i,!0);if(u)return u(i,!0);t=new Error("Cannot find module '"+i+"'");throw t.code="MODULE_NOT_FOUND",t}t=r[i]={exports:{}};a[i][0].call(t.exports,function(e){var t=a[i][1][e];return o(t||e)},t,t.exports,n,a,r,s)}return r[i].exports}for(var u="function"==typeof require&&require,e=0;e<s.length;e++)o(s[e]);return o}({1:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var d=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,a=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(i.push(s.value),!t||i.length!==t);n=!0);}catch(e){a=!0,r=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw r}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function l(e,t){for(var i=e.cues,n=0;n<i.length;n++){var a=i[n];if(t>=a.adStartTime&&t<=a.adEndTime)return a}return null}var n,a=e("global/window"),c=(n=a)&&n.__esModule?n:{default:n};i.default={updateAdCues:function(e,t){if(e.segments)for(var i=arguments.length<=2||void 0===arguments[2]?0:arguments[2],n=void 0,a=0;a<e.segments.length;a++){var r,s,o,u=e.segments[a];if(n=n||l(t,i+u.duration/2)){if("cueIn"in u){n.endTime=i,n.adEndTime=i,i+=u.duration,n=null;continue}if(i<n.endTime){i+=u.duration;continue}n.endTime+=u.duration}else"cueOut"in u&&((n=new c.default.VTTCue(i,i+u.duration,u.cueOut)).adStartTime=i,n.adEndTime=i+parseFloat(u.cueOut),t.addCue(n)),"cueOutCont"in u&&(o=s=void 0,r=u.cueOutCont.split("/").map(parseFloat),s=(r=d(r,2))[0],o=r[1],(n=new c.default.VTTCue(i,i+u.duration,"")).adStartTime=i-s,n.adEndTime=n.adStartTime+o,t.addCue(n));i+=u.duration}},findAdCue:l},t.exports=i.default},{"global/window":32}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function a(e,t){return e=e.toString(16),"00".substring(0,2-e.length)+e+(t%2?" ":"")}function r(e){return 32<=e&&e<126?String.fromCharCode(e):"."}var n={hexDump:function(e){for(var t=Array.prototype.slice.call(e),i="",n=0;n<t.length/16;n++)i+=t.slice(16*n,16*n+16).map(a).join("")+" "+t.slice(16*n,16*n+16).map(r).join("")+"\n";return i},tagDump:function(e){return n.hexDump(e.bytes)},textRanges:function(e){for(var t,i,n="",a=void 0,a=0;a<e.length;a++)n+=(i=a,(t=e).start(i)+"-"+t.end(i)+" ");return n},createTransferableMessage:function(i){var n={};return Object.keys(i).forEach(function(e){var t=i[e];ArrayBuffer.isView(t)?n[e]={bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}:n[e]=t}),n},initSegmentId:function(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")}};i.default=n,t.exports=i.default},{}],3:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},t.exports=i.default},{}],4:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function n(e){e.onmessage=function(e){var i=e.data,t=new Uint8Array(i.encrypted.bytes,i.encrypted.byteOffset,i.encrypted.byteLength),n=new Uint32Array(i.key.bytes,i.key.byteOffset,i.key.byteLength/4),e=new Uint32Array(i.iv.bytes,i.iv.byteOffset,i.iv.byteLength/4);new o.Decrypter(t,n,e,function(e,t){s.default.postMessage((0,u.createTransferableMessage)({source:i.source,decrypted:t}),[t.buffer])})}}var a,r=e("global/window"),s=(a=r)&&a.__esModule?a:{default:a},o=e("aes-decrypter"),u=e("./bin-utils");i.default=function(e){return new n(e)},t.exports=i.default},{"./bin-utils":2,"aes-decrypter":25,"global/window":32}],5:[function(O,e,E){!function(e){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var t=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e){return(0,u.translateLegacyCodecs)([e])[0]})}var c=i(O("./playlist-loader")),s=O("./playlist.js"),f=i(O("./segment-loader")),h=i(O("./vtt-segment-loader")),a=i(O("./ranges")),p=i("undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null),o=i(O("./ad-cue-tags")),m=i(O("./sync-controller")),u=O("videojs-contrib-media-sources/es5/codec-utils"),g=i(O("webworkify")),y=i(O("./decrypter-worker")),d=i(O("./config")),l=O("./util/codecs.js"),_=O("./media-groups"),v=void 0,b={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},T=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"];E.mapLegacyAvcCodecs_=r;function S(e,t,i){return e+"/"+t+'; codecs="'+i.filter(function(e){return!!e}).join(", ")+'"'}function w(e,t){var i=(s=t).segments&&s.segments.length&&s.segments[0].map?"mp4":"mp2t",n=function(e){e=e.attributes||{};return e.CODECS?(0,l.parseCodecs)(e.CODECS):b}(t),a=t.attributes||{},r=!0,s=!1;if(!t)return[];if(e.mediaGroups.AUDIO&&a.AUDIO){var o=e.mediaGroups.AUDIO[a.AUDIO];if(o)for(var u in r=!(s=!0),o)if(!o[u].uri){r=!0;break}}return s&&!n.audioProfile&&(p.default.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"),n.audioProfile=b.audioProfile),e={},n.videoCodec&&(e.video=""+n.videoCodec+n.videoObjectTypeIndicator),n.audioProfile&&(e.audio="mp4a.40."+n.audioProfile),a=S("audio",i,[e.audio]),n=S("video",i,[e.video]),i=S("video",i,[e.video,e.audio]),s?!r&&e.video?[n,a]:[i,a]:e.video?[i]:[a]}E.mimeTypesForPlaylist_=w;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(k,p.default.EventTarget),t(k,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var a=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var e=a.masterPlaylistLoader_.media(),t=1.5*a.masterPlaylistLoader_.targetDuration*1e3;(0,s.isLowestEnabledRendition)(a.masterPlaylistLoader_.master,a.masterPlaylistLoader_.media())?a.requestOptions_.timeout=0:a.requestOptions_.timeout=t,e.endList&&"none"!==a.tech_.preload()&&(a.mainSegmentLoader_.playlist(e,a.requestOptions_),a.mainSegmentLoader_.load()),(0,_.setupMediaGroups)({segmentLoaders:{AUDIO:a.audioSegmentLoader_,SUBTITLES:a.subtitleSegmentLoader_,main:a.mainSegmentLoader_},tech:a.tech_,requestOptions:a.requestOptions_,masterPlaylistLoader:a.masterPlaylistLoader_,mode:a.mode_,hls:a.hls_,master:a.master(),mediaTypes:a.mediaTypes_,blacklistCurrentPlaylist:a.blacklistCurrentPlaylist.bind(a)}),a.triggerPresenceUsage_(a.master(),e);try{a.setupSourceBuffers_()}catch(e){return p.default.log.warn("Failed to create SourceBuffers",e),a.mediaSource.endOfStream("decode")}a.setupFirstPlay(),a.trigger("selectedinitialmedia")}),this.masterPlaylistLoader_.on("loadedplaylist",function(){var e=a.masterPlaylistLoader_.media();if(!e){var t=void 0,t=(t=a.enableLowInitialPlaylist?a.selectInitialPlaylist():t)||a.selectPlaylist();return a.initialMedia_=t,void a.masterPlaylistLoader_.media(a.initialMedia_)}function i(){var e=a.seekable();0!==e.length&&a.mediaSource.addSeekableRange_(e.start(0),e.end(0))}function n(){a.duration()===1/0?i():a.tech_.one("durationchange",n)}a.useCueTags_&&a.updateAdCues_(e),a.mainSegmentLoader_.playlist(e,a.requestOptions_),a.updateDuration(),a.tech_.paused()||a.mainSegmentLoader_.load(),e.endList||(a.duration()!==1/0?a.tech_.one("durationchange",n):i())}),this.masterPlaylistLoader_.on("error",function(){a.blacklistCurrentPlaylist(a.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){a.mainSegmentLoader_.abort(),a.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var e=a.masterPlaylistLoader_.media(),t=1.5*a.masterPlaylistLoader_.targetDuration*1e3;(0,s.isLowestEnabledRendition)(a.masterPlaylistLoader_.master,a.masterPlaylistLoader_.media())?a.requestOptions_.timeout=0:a.requestOptions_.timeout=t,a.mainSegmentLoader_.playlist(e,a.requestOptions_),a.mainSegmentLoader_.load(),a.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var e=a.masterPlaylistLoader_.media();a.stuckAtPlaylistEnd_(e)&&(a.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),a.tech_.trigger("playliststuck"))}),this.masterPlaylistLoader_.on("renditiondisabled",function(){a.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){a.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})}},{key:"triggerPresenceUsage_",value:function(e,t){var i,n=e.mediaGroups||{},a=!0,e=Object.keys(n.AUDIO);for(i in n.AUDIO)for(var r in n.AUDIO[i])n.AUDIO[i][r].uri||(a=!1);a&&this.tech_.trigger({type:"usage",name:"hls-demuxed"}),Object.keys(n.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"hls-webvtt"}),v.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"hls-aes"}),v.Playlist.isFmp4(t)&&this.tech_.trigger({type:"usage",name:"hls-fmp4"}),e.length&&1<Object.keys(n.AUDIO[e[0]]).length&&this.tech_.trigger({type:"usage",name:"hls-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}},{key:"setupSegmentLoaderListeners_",value:function(){var a=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){var e=a.selectPlaylist(),t=a.masterPlaylistLoader_.media(),i=a.tech_.buffered(),n=i.length?i.end(i.length-1)-a.tech_.currentTime():0,i=a.bufferLowWaterLine();(!t.endList||a.duration()<d.default.MAX_BUFFER_LOW_WATER_LINE||e.attributes.BANDWIDTH<t.attributes.BANDWIDTH||i<=n)&&a.masterPlaylistLoader_.media(e),a.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("progress",function(){a.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){a.blacklistCurrentPlaylist(a.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("syncinfoupdate",function(){a.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){a.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){a.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("ended",function(){a.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(){a.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120)}),this.mainSegmentLoader_.on("reseteverything",function(){a.tech_.trigger("hls-reset")}),this.mainSegmentLoader_.on("segmenttimemapping",function(e){a.tech_.trigger({type:"hls-segment-time-mapping",mapping:e.mapping})}),this.audioSegmentLoader_.on("ended",function(){a.onEndOfStream()})}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}},{key:"fastQualityChange_",value:function(){var e=this.selectPlaylist();e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetLoader())}},{key:"play",value:function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_()&&this.load();var e=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.tech_.setCurrentTime(e.end(e.length-1)):void 0}}},{key:"setupFirstPlay",value:function(){var e,t=this,i=this.masterPlaylistLoader_.media();if(!i||this.tech_.paused()||this.hasPlayed_())return!1;if(!i.endList){i=(e=t.seekable()).length?p.default.browser.IE_VERSION&&"html5"===t.mode_&&0===t.tech_.readyState()?(t.tech_.one("loadedmetadata",function(){t.trigger("firstplay"),t.tech_.setCurrentTime(e.end(0)),t.hasPlayed_=function(){return!0}}),{v:!1}):(t.trigger("firstplay"),void t.tech_.setCurrentTime(e.end(0))):{v:!1};if("object"==typeof i)return i.v}return this.hasPlayed_=function(){return!0},this.load(),!0}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(e){return p.default.log.warn("Failed to create Source Buffers",e),this.mediaSource.endOfStream("decode")}this.tech_.autoplay()&&this.tech_.play(),this.trigger("sourceopen")}},{key:"onEndOfStream",value:function(){var e=this.mainSegmentLoader_.ended_;(e=this.mediaTypes_.AUDIO.activePlaylistLoader?e&&this.audioSegmentLoader_.ended_:e)&&this.mediaSource.endOfStream()}},{key:"stuckAtPlaylistEnd_",value:function(e){if(!this.seekable().length)return!1;var t=this.syncController_.getExpiredTime(e,this.mediaSource.duration);if(null===t)return!1;var i=v.Playlist.playlistEnd(e,t),e=this.tech_.currentTime(),t=this.tech_.buffered();if(!t.length)return i-e<=a.default.SAFE_TIME_DELTA;t=t.end(t.length-1);return t-e<=a.default.SAFE_TIME_DELTA&&i-t<=a.default.SAFE_TIME_DELTA}},{key:"blacklistCurrentPlaylist",value:function(e,t){var i,n=void 0,n=(e=void 0===e?{}:e).playlist||this.masterPlaylistLoader_.media();if(t=t||e.blacklistDuration||this.blacklistDuration,!n){this.error=e;try{return this.mediaSource.endOfStream("network")}catch(e){return this.trigger("error")}}var a=1===this.masterPlaylistLoader_.master.playlists.filter(s.isEnabled).length;return a?(p.default.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the final playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(a)):(n.excludeUntil=Date.now()+1e3*t,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"}),i=this.selectPlaylist(),p.default.log.warn("Problem encountered with the current HLS playlist."+(e.message?" "+e.message:"")+" Switching to another playlist."),this.masterPlaylistLoader_.media(i))}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(e){var t=a.default.findRange(this.tech_.buffered(),e);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?t&&t.length&&"flash"!==this.mode_?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0}},{key:"duration",value:function(){return this.masterPlaylistLoader_?this.mediaSource?this.mediaSource.duration:v.Playlist.duration(this.masterPlaylistLoader_.media()):0}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var e=void 0,t=void 0;if(this.masterPlaylistLoader_){var i=this.masterPlaylistLoader_.media();if(i){var n=this.syncController_.getExpiredTime(i,this.mediaSource.duration);if(null!==n&&0!==(e=v.Playlist.seekable(i,n)).length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(i=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(n=this.syncController_.getExpiredTime(i,this.mediaSource.duration)))return;if(0===(t=v.Playlist.seekable(i,n)).length)return}!t||t.start(0)>e.end(0)||e.start(0)>t.end(0)?this.seekable_=e:this.seekable_=p.default.createTimeRanges([[(t.start(0)>e.start(0)?t:e).start(0),(t.end(0)<e.end(0)?t:e).end(0)]]),this.tech_.trigger("seekablechanged")}}}}},{key:"updateDuration",value:function(){function e(){t.mediaSource.duration=n,t.tech_.trigger("durationchange"),t.mediaSource.removeEventListener("sourceopen",e)}var t=this,i=this.mediaSource.duration,n=v.Playlist.duration(this.masterPlaylistLoader_.media()),a=this.tech_.buffered();i!==(n=0<a.length?Math.max(n,a.end(a.length-1)):n)&&("open"!==this.mediaSource.readyState?this.mediaSource.addEventListener("sourceopen",e):e())}},{key:"dispose",value:function(){var n=this;this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach(function(e){var t,i=n.mediaTypes_[e].groups;for(t in i)i[t].forEach(function(e){e.playlistLoader&&e.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var e,t=this.masterPlaylistLoader_.media();if(t&&"open"===this.mediaSource.readyState){if((e=w(this.masterPlaylistLoader_.master,t)).length<1)return this.error="No compatible SourceBuffer configuration for the variant stream:"+t.resolvedUri,this.mediaSource.endOfStream("decode");this.mainSegmentLoader_.mimeType(e[0]),e[1]&&this.audioSegmentLoader_.mimeType(e[1]),this.excludeIncompatibleVariants_(t)}}},{key:"excludeIncompatibleVariants_",value:function(e){var t,i=this.masterPlaylistLoader_.master,n=2,a=null;e.attributes.CODECS&&(t=(0,l.parseCodecs)(e.attributes.CODECS),a=t.videoCodec,n=t.codecCount),i.playlists.forEach(function(e){var t,i={codecCount:2,videoCodec:null};e.attributes.CODECS&&(t=e.attributes.CODECS,i=(0,l.parseCodecs)(t),window.MediaSource&&window.MediaSource.isTypeSupported&&!window.MediaSource.isTypeSupported('video/mp4; codecs="'+r(t)+'"')&&(e.excludeUntil=1/0)),i.codecCount!==n&&(e.excludeUntil=1/0),i.videoCodec!==a&&(e.excludeUntil=1/0)})}},{key:"updateAdCues_",value:function(e){var t=0,i=this.seekable();i.length&&(t=i.start(0)),o.default.updateAdCues(e,this.cueTagsTrack_,t)}},{key:"goalBufferLength",value:function(){var e=this.tech_.currentTime(),t=d.default.GOAL_BUFFER_LENGTH,i=d.default.GOAL_BUFFER_LENGTH_RATE,n=Math.max(t,d.default.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*i,n)}},{key:"bufferLowWaterLine",value:function(){var e=this.tech_.currentTime(),t=d.default.BUFFER_LOW_WATER_LINE,i=d.default.BUFFER_LOW_WATER_LINE_RATE,n=Math.max(t,d.default.MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*i,n)}}]),t=k;function k(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,k),function(e,t,i){for(var n=!0;n;){var a=e,r=t,s=i,n=!1;null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,r);if(void 0!==o){if("value"in o)return o.value;var u=o.get;return void 0===u?void 0:u.call(s)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=r,i=s,n=!0,o=void 0}}(Object.getPrototypeOf(k.prototype),"constructor",this).call(this);var i=e.url,n=e.withCredentials,a=e.mode,r=e.tech,s=e.bandwidth,o=e.externHls,u=e.useCueTags,d=e.blacklistDuration,l=e.enableLowInitialPlaylist;if(!i)throw new Error("A non-empty playlist URL is required");v=o,this.withCredentials=n,this.tech_=r,this.hls_=r.hls,this.mode_=a,this.useCueTags_=u,this.blacklistDuration=d,this.enableLowInitialPlaylist=l,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:this.withCredentials,timeout:null},this.mediaTypes_=(0,_.createMediaTypes)(),this.mediaSource=new p.default.MediaSource({mode:a}),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_.bind(this)),this.seekable_=p.default.createTimeRanges(),this.hasPlayed_=function(){return!1},this.syncController_=new m.default(e),this.segmentMetadataTrack_=r.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.decrypter_=(0,g.default)(y.default);s={hls:this.hls_,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:function(){return t.seekable()},seeking:function(){return t.tech_.seeking()},duration:function(){return t.mediaSource.duration},hasPlayed:function(){return t.hasPlayed_()},goalBufferLength:function(){return t.goalBufferLength()},bandwidth:s,syncController:this.syncController_,decrypter:this.decrypter_};this.masterPlaylistLoader_=new c.default(i,this.hls_,this.withCredentials),this.setupMasterPlaylistLoaderListeners_(),this.mainSegmentLoader_=new f.default(p.default.mergeOptions(s,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),e),this.audioSegmentLoader_=new f.default(p.default.mergeOptions(s,{loaderType:"audio"}),e),this.subtitleSegmentLoader_=new h.default(p.default.mergeOptions(s,{loaderType:"vtt"}),e),this.setupSegmentLoaderListeners_(),T.forEach(function(e){t[e+"_"]=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]}.bind(t,e)}),this.masterPlaylistLoader_.load()}E.MasterPlaylistController=t}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ad-cue-tags":1,"./config":3,"./decrypter-worker":4,"./media-groups":6,"./playlist-loader":9,"./playlist.js":11,"./ranges":12,"./segment-loader":16,"./sync-controller":18,"./util/codecs.js":19,"./vtt-segment-loader":20,"videojs-contrib-media-sources/es5/codec-utils":65,webworkify:76}],6:[function(n,e,a){!function(e){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(a,"__esModule",{value:!0});function i(){}function u(e,t){e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)}var m=t("undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null),g=t(n("./playlist-loader"));a.stopLoaders=u;function d(e,t){(t.activePlaylistLoader=e).load()}a.startLoaders=d;function l(r,s){return function(){var e=s.segmentLoaders,t=e[r],i=e.main,n=s.mediaTypes[r],a=n.activeTrack(),e=n.activeGroup(a),a=n.activePlaylistLoader;u(t,n),e&&(e.playlistLoader?(t.resyncLoader(),d(e.playlistLoader,n)):a&&i.resetEverything())}}a.onGroupChanged=l;function c(s,o){return function(){var e=o.segmentLoaders,t=e[s],i=e.main,n=o.mediaTypes[s],a=n.activeTrack(),r=n.activeGroup(a),e=n.activePlaylistLoader;u(t,n),r&&(r.playlistLoader?(e!==r.playlistLoader&&(t.track&&t.track(a),t.resetEverything()),d(r.playlistLoader,n)):i.resetEverything())}}a.onTrackChanged=c;var y={AUDIO:function(s,o){return function(){var e=o.segmentLoaders[s],t=o.mediaTypes[s],i=o.blacklistCurrentPlaylist;u(e,t);var n=t.activeTrack(),e=t.activeGroup(),e=(e.filter(function(e){return e.default})[0]||e[0]).id,a=t.tracks[e];if(n!==a){for(var r in m.default.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),t.tracks)t.tracks[r].enabled=t.tracks[r]===a;t.onTrackChanged()}else i({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(i,n){return function(){var e=n.segmentLoaders[i],t=n.mediaTypes[i];m.default.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),u(e,t);e=t.activeTrack();e&&(e.mode="disabled"),t.onTrackChanged()}}};a.onError=y;var _={AUDIO:function(e,t,i){var n,a,r;t&&(n=i.tech,a=i.requestOptions,r=i.segmentLoaders[e],t.on("loadedmetadata",function(){var e=t.media();r.playlist(e,a),(!n.paused()||e.endList&&"none"!==n.preload())&&r.load()}),t.on("loadedplaylist",function(){r.playlist(t.media(),a),n.paused()||r.load()}),t.on("error",y[e](e,i)))},SUBTITLES:function(e,t,i){var n=i.tech,a=i.requestOptions,r=i.segmentLoaders[e],s=i.mediaTypes[e];t.on("loadedmetadata",function(){var e=t.media();r.playlist(e,a),r.track(s.activeTrack()),(!n.paused()||e.endList&&"none"!==n.preload())&&r.load()}),t.on("loadedplaylist",function(){r.playlist(t.media(),a),n.paused()||r.load()}),t.on("error",y[e](e,i))}};a.setupListeners=_;var f={AUDIO:function(e,t){var i,n,a=t.mode,r=t.hls,s=t.segmentLoaders[e],o=t.requestOptions.withCredentials,u=t.master.mediaGroups,d=t.mediaTypes[e],l=d.groups,c=d.tracks;for(i in u[e]&&0!==Object.keys(u[e]).length&&"html5"===a||(u[e]={main:{default:{default:!0}}}),u[e])for(var f in l[i]||(l[i]=[]),u[e][i]){var h=void 0,h=(p=u[e][i][f]).resolvedUri?new g.default(p.resolvedUri,r,o):null,p=m.default.mergeOptions({id:f,playlistLoader:h},p);_[e](e,p.playlistLoader,t),l[i].push(p),void 0===c[f]&&(p=new m.default.AudioTrack({id:f,kind:(n=void 0,n=(h=p).default?"main":"alternative",n=h.characteristics&&0<=h.characteristics.indexOf("public.accessibility.describes-video")?"main-desc":n),enabled:!1,language:p.language,default:p.default,label:f}),c[f]=p)}s.on("error",y[e](e,t))},SUBTITLES:function(e,t){var i,n,a=t.tech,r=t.hls,s=t.segmentLoaders[e],o=t.requestOptions.withCredentials,u=t.master.mediaGroups,d=t.mediaTypes[e],l=d.groups,c=d.tracks;for(i in u[e])for(var f in l[i]||(l[i]=[]),u[e][i])u[e][i][f].forced||(n=u[e][i][f],n=m.default.mergeOptions({id:f,playlistLoader:new g.default(n.resolvedUri,r,o)},n),_[e](e,n.playlistLoader,t),l[i].push(n),void 0===c[f]&&(n=a.addRemoteTextTrack({id:f,kind:"subtitles",enabled:!1,language:n.language,label:f},!1).track,c[f]=n));s.on("error",y[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var i,n=t.tech,a=t.master.mediaGroups,t=t.mediaTypes[e],r=t.groups,s=t.tracks;for(i in a[e])for(var o in r[i]||(r[i]=[]),a[e][i]){var u=a[e][i][o];u.instreamId.match(/CC\d/)&&(r[i].push(m.default.mergeOptions({id:o},u)),void 0===s[o]&&(u=n.addRemoteTextTrack({id:u.instreamId,kind:"captions",enabled:!1,language:u.language,label:o},!1).track,s[o]=u))}}};a.initialize=f;function h(a,r){return function(t){var e=r.masterPlaylistLoader,i=r.mediaTypes[a].groups,n=e.media();if(!n)return null;e=null,e=(e=n.attributes[a]?i[n.attributes[a]]:e)||i.main;return void 0===t?e:null!==t&&e.filter(function(e){return e.id===t.id})[0]||null}}a.activeGroup=h;var p={AUDIO:function(i,n){return function(){var e,t=n.mediaTypes[i].tracks;for(e in t)if(t[e].enabled)return t[e];return null}},SUBTITLES:function(i,n){return function(){var e,t=n.mediaTypes[i].tracks;for(e in t)if("showing"===t[e].mode)return t[e];return null}}};a.activeTrack=p;a.setupMediaGroups=function(t){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(e){f[e](e,t)});var i=t.mediaTypes,e=t.masterPlaylistLoader,n=t.tech,a=t.hls;["AUDIO","SUBTITLES"].forEach(function(e){i[e].activeGroup=h(e,t),i[e].activeTrack=p[e](e,t),i[e].onGroupChanged=l(e,t),i[e].onTrackChanged=c(e,t)});var r=i.AUDIO.activeGroup(),r=(r.filter(function(e){return e.default})[0]||r[0]).id;i.AUDIO.tracks[r].enabled=!0,i.AUDIO.onTrackChanged(),e.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(e){return i[e].onGroupChanged()})});function s(){i.AUDIO.onTrackChanged(),n.trigger({type:"usage",name:"hls-audio-change"})}for(var o in n.audioTracks().addEventListener("change",s),n.remoteTextTracks().addEventListener("change",i.SUBTITLES.onTrackChanged),a.on("dispose",function(){n.audioTracks().removeEventListener("change",s),n.remoteTextTracks().removeEventListener("change",i.SUBTITLES.onTrackChanged)}),n.clearTracks("audio"),i.AUDIO.tracks)n.audioTracks().addTrack(i.AUDIO.tracks[o])};a.createMediaTypes=function(){var t={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(e){t[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:i,activeTrack:i,onGroupChanged:i,onTrackChanged:i}}),t}}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./playlist-loader":9}],7:[function(a,e,s){!function(e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var t,i="undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null,T=(t=i)&&t.__esModule?t:{default:t},r=a("./bin-utils"),S={FAILURE:2,TIMEOUT:-101,ABORTED:-102};s.REQUEST_ERRORS=S;function w(e){var t={};return e.byterange&&(t.Range=n(e.byterange)),t}var n=function(e){var t=e.offset+e.length-1;return"bytes="+e.offset+"-"+t},k=function(e){e.forEach(function(e){e.abort()})},O=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}},E=function(e){var t=e.target,t={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-t.requestTime||0};return t.bytesReceived=e.loaded,t.bandwidth=Math.floor(t.bytesReceived/t.roundTripTime*8*1e3),t},A=function(e,t){return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:S.TIMEOUT,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:S.ABORTED,xhr:t}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:S.FAILURE,xhr:t}:null},L=function(t,i,n){function a(e){if(e.data.source===i.requestId){t.removeEventListener("message",a);e=e.data.decrypted;return i.bytes=new Uint8Array(e.bytes,e.byteOffset,e.byteLength),n(null,i)}}t.addEventListener("message",a),t.postMessage((0,r.createTransferableMessage)({source:i.requestId,encrypted:i.encryptedBytes,key:i.key.bytes,iv:i.key.iv}),[i.encryptedBytes.buffer,i.key.bytes.buffer])},P=function(e){return e.reduce(function(e,t){return t.code>e.code?t:e})};s.mediaSegmentRequest=function(e,t,i,n,a,r){var s,o,u,d,l,c,f,h,p,m,g=[],r=(s=g,o=i,u=r,d=[],l=0,function(e,t){if(e&&(k(s),d.push(e)),(l+=1)===s.length){if(t.endOfAllRequests=Date.now(),0<d.length){e=P(d);return u(e,t)}return t.encryptedBytes?L(o,t,u):u(null,t)}});n.key&&(h=e(T.default.mergeOptions(t,{uri:n.key.resolvedUri,responseType:"arraybuffer"}),(c=n,f=r,function(e,t){var i=t.response,e=A(e,t);if(e)return f(e,c);if(16!==i.byteLength)return f({status:t.status,message:"Invalid HLS key at URL: "+t.uri,code:S.FAILURE,xhr:t},c);i=new DataView(i);return c.key.bytes=new Uint32Array([i.getUint32(0),i.getUint32(4),i.getUint32(8),i.getUint32(12)]),f(null,c)})),g.push(h)),n.map&&!n.map.bytes&&(h=e(T.default.mergeOptions(t,{uri:n.map.resolvedUri,responseType:"arraybuffer",headers:w(n.map)}),(p=n,m=r,function(e,t){var i=t.response,e=A(e,t);return e?m(e,p):0===i.byteLength?m({status:t.status,message:"Empty HLS segment content at URL: "+t.uri,code:S.FAILURE,xhr:t},p):(p.map.bytes=new Uint8Array(t.response),m(null,p))})),g.push(h));var y,_,v,b,r=e(T.default.mergeOptions(t,{uri:n.resolvedUri,responseType:"arraybuffer",headers:w(n)}),(y=n,_=r,function(e,t){var i=t.response,e=A(e,t);return e?_(e,y):0===i.byteLength?_({status:t.status,message:"Empty HLS segment content at URL: "+t.uri,code:S.FAILURE,xhr:t},y):(y.stats=O(t),y.key?y.encryptedBytes=new Uint8Array(t.response):y.bytes=new Uint8Array(t.response),_(null,y))}));return r.addEventListener("progress",(v=n,b=a,function(e){return v.stats=T.default.mergeOptions(v.stats,E(e)),!v.stats.firstBytesReceivedAt&&v.stats.bytesReceived&&(v.stats.firstBytesReceivedAt=Date.now()),b(e,v)})),g.push(r),function(){return k(g)}}}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./bin-utils":2}],8:[function(a,r,c){!function(e){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var t=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e){return e&&e.__esModule?e:{default:e}}var s=i(a("global/window")),o=i(a("./ranges")),u=i("undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null),d=["seeking","seeked","pause","playing","error"],t=(t(l,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&s.default.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=s.default.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+o.default.SAFE_TIME_DELTA>=t.end(t.length-1)))return this.techWaiting_();5<=this.consecutiveUpdates&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null}},{key:"fixesBadSeeks_",value:function(){var e=this.tech_.seeking(),t=this.seekable(),i=this.tech_.currentTime(),n=void 0;return e&&this.afterSeekableWindow_(t,i)&&(n=t.end(t.length-1)),void 0!==(n=e&&this.beforeSeekableWindow_(t,i)?t.start(0)+o.default.SAFE_TIME_DELTA:n)&&(this.logger_("Trying to seek outside of seekable at time "+i+" with seekable range "+o.default.printableRange(t)+". Seeking to "+n+"."),this.tech_.setCurrentTime(n),!0)}},{key:"waiting_",value:function(){var e,t;this.techWaiting_()||(e=this.tech_.currentTime(),t=this.tech_.buffered(),(t=o.default.findRange(t,e)).length&&e+3<=t.end(0)&&(this.cancelTimer_(),this.tech_.setCurrentTime(e),this.logger_("Stopped at "+e+" while inside a buffered region ["+t.start(0)+" -> "+t.end(0)+"]. Attempting to resume playback by seeking to the current time."),this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})))}},{key:"techWaiting_",value:function(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_())return!0;if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(e,t)){var i=e.end(e.length-1);return this.logger_("Fell out of live window at time "+t+". Seeking to live point (seekable end) "+i),this.cancelTimer_(),this.tech_.setCurrentTime(i),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}e=this.tech_.buffered(),i=o.default.findNextRange(e,t);if(this.videoUnderflow_(i,e,t))return this.cancelTimer_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;if(0<i.length){e=i.start(0)-t;return this.logger_("Stopped at "+t+", setting timer for "+e+", seeking to "+i.start(0)),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*e,t),!0}return!1}},{key:"afterSeekableWindow_",value:function(e,t){return!!e.length&&t>e.end(e.length-1)+o.default.SAFE_TIME_DELTA}},{key:"beforeSeekableWindow_",value:function(e,t){return!!(e.length&&0<e.start(0)&&t<e.start(0)-o.default.SAFE_TIME_DELTA)}},{key:"videoUnderflow_",value:function(e,t,i){if(0===e.length){t=this.gapFromVideoUnderflow_(t,i);if(t)return this.logger_("Encountered a gap in video from "+t.start+" to "+t.end+". Seeking to current time "+i),!0}return!1}},{key:"skipTheGap_",value:function(e){var t=this.tech_.buffered(),i=this.tech_.currentTime(),t=o.default.findNextRange(t,i);this.cancelTimer_(),0!==t.length&&i===e&&(this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",e,"nextRange start:",t.start(0)),this.tech_.setCurrentTime(t.start(0)+o.default.TIME_FUDGE_FACTOR),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))}},{key:"gapFromVideoUnderflow_",value:function(e,t){for(var i=o.default.findGaps(e),n=0;n<i.length;n++){var a=i.start(n),r=i.end(n);if(t-a<4&&2<t-a)return{start:a,end:r}}return null}},{key:"logger_",value:function(){}}]),l);function l(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),this.tech_=e.tech,this.seekable=e.seekable,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,e.debug&&(this.logger_=u.default.log.bind(u.default,"playback-watcher ->")),this.logger_("initialize");function i(){return t.monitorCurrentTime_()}function n(){return t.techWaiting_()}function a(){return t.cancelTimer_()}function r(){return t.fixesBadSeeks_()}this.tech_.on("seekablechanged",r),this.tech_.on("waiting",n),this.tech_.on(d,a),this.tech_.on("canplay",i),this.dispose=function(){t.logger_("dispose"),t.tech_.off("seekablechanged",r),t.tech_.off("waiting",n),t.tech_.off(d,a),t.tech_.off("canplay",i),t.checkCurrentTimeTimeout_&&s.default.clearTimeout(t.checkCurrentTimeTimeout_),t.cancelTimer_()}}c.default=t,r.exports=c.default}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ranges":12,"global/window":32}],9:[function(m,e,g){!function(e){"use strict";Object.defineProperty(g,"__esModule",{value:!0});var t=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,i){var n=t.slice();i=i||0;for(var a=Math.min(e.length,t.length+i),r=i;r<a;r++)n[r-i]=(0,o.mergeOptions)(e[r],n[r-i]);return n}var s=i(m("./resolve-url")),o="undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null,a=i(m("m3u8-parser")),u=i(m("global/window"));g.updateSegments=r;function d(e,t){e.resolvedUri||(e.resolvedUri=(0,s.default)(t,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=(0,s.default)(t,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=(0,s.default)(t,e.map.uri))}g.resolveSegmentUris=d;function l(e,t){var i=(0,o.mergeOptions)(e,{});if(!(e=i.playlists.filter(function(e){return e.uri===t.uri})[0]))return null;if(e.segments&&t.segments&&e.segments.length===t.segments.length&&e.mediaSequence===t.mediaSequence)return null;var n=(0,o.mergeOptions)(e,t);e.segments&&(n.segments=r(e.segments,t.segments,t.mediaSequence-e.mediaSequence)),n.segments.forEach(function(e){d(e,n.resolvedUri)});for(var a=0;a<i.playlists.length;a++)i.playlists[a].uri===t.uri&&(i.playlists[a]=n);return i.playlists[t.uri]=n,i}g.updateMaster=l;function c(e){for(var t=e.playlists.length;t--;){var i=e.playlists[t];(e.playlists[i.uri]=i).resolvedUri=(0,s.default)(e.uri,i.uri),i.attributes||(i.attributes={},o.log.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute."))}}g.setupMediaPlaylists=c;function f(n){["AUDIO","SUBTITLES"].forEach(function(e){for(var t in n.mediaGroups[e])for(var i in n.mediaGroups[e][t]){i=n.mediaGroups[e][t][i];i.uri&&(i.resolvedUri=(0,s.default)(n.uri,i.uri))}})}g.resolveMediaGroupUris=f;function h(e,t){var i=e.segments[e.segments.length-1];return t&&i&&i.duration?1e3*i.duration:500*(e.targetDuration||10)}g.refreshDelay=h;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(p,o.EventTarget),t(p,[{key:"playlistRequestError",value:function(e,t,i){this.request=null,i&&(this.state=i),this.error={playlist:this.master.playlists[t],status:e.status,message:"HLS playlist request error at URL: "+t,responseText:e.responseText,code:500<=e.status?4:2},this.trigger("error")}},{key:"haveMetadata",value:function(e,t){var i=this;this.request=null,this.state="HAVE_METADATA";var n=new a.default.Parser;n.push(e.responseText),n.end(),n.manifest.uri=t,n.manifest.attributes=n.manifest.attributes||{};t=l(this.master,n.manifest);this.targetDuration=n.manifest.targetDuration,t?(this.master=t,this.media_=this.master.playlists[n.manifest.uri]):this.trigger("playlistunchanged"),this.media().endList||(u.default.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=u.default.setTimeout(function(){i.trigger("mediaupdatetimeout")},h(this.media(),!!t))),this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.stopRequest(),u.default.clearTimeout(this.mediaUpdateTimeout)}},{key:"stopRequest",value:function(){var e;this.request&&(e=this.request,this.request=null,e.onreadystatechange=null,e.abort())}},{key:"media",value:function(i){var n=this;if(!i)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var a=this.state;if("string"==typeof i){if(!this.master.playlists[i])throw new Error("Unknown playlist URI: "+i);i=this.master.playlists[i]}var e=!this.media_||i.uri!==this.media_.uri;if(this.master.playlists[i.uri].endList)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=i,void(e&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(e){if(this.state="SWITCHING_MEDIA",this.request){if((0,s.default)(this.master.uri,i.uri)===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.hls_.xhr({uri:(0,s.default)(this.master.uri,i.uri),withCredentials:this.withCredentials},function(e,t){if(n.request){if(e)return n.playlistRequestError(n.request,i.uri,a);n.haveMetadata(t,i.uri),"HAVE_MASTER"===a?n.trigger("loadedmetadata"):n.trigger("mediachange")}})}}},{key:"pause",value:function(){this.stopRequest(),u.default.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}},{key:"load",value:function(e){var t=this;u.default.clearTimeout(this.mediaUpdateTimeout);var i=this.media();e?(e=i?i.targetDuration/2*1e3:5e3,this.mediaUpdateTimeout=u.default.setTimeout(function(){return t.load()},e)):this.started?i&&!i.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}},{key:"start",value:function(){var i=this;this.started=!0,this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,t){if(i.request){if(i.request=null,e)return i.error={status:t.status,message:"HLS playlist request error at URL: "+i.srcUrl,responseText:t.responseText,code:2},"HAVE_NOTHING"===i.state&&(i.started=!1),i.trigger("error");e=new a.default.Parser;return(e.push(t.responseText),e.end(),i.state="HAVE_MASTER",e.manifest.uri=i.srcUrl,e.manifest.playlists)?(i.master=e.manifest,c(i.master),f(i.master),i.trigger("loadedplaylist"),void(i.request||i.media(e.manifest.playlists[0]))):(i.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:u.default.location.href,playlists:[{uri:i.srcUrl}]},i.master.playlists[i.srcUrl]=i.master.playlists[0],i.master.playlists[0].resolvedUri=i.srcUrl,i.master.playlists[0].attributes=i.master.playlists[0].attributes||{},i.haveMetadata(t,i.srcUrl),i.trigger("loadedmetadata"))}})}}]),t=p;function p(e,t,i){var n=this;if(!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),function(e,t,i){for(var n=!0;n;){var a=e,r=t,s=i,n=!1;null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,r);if(void 0!==o){if("value"in o)return o.value;var u=o.get;return void 0===u?void 0:u.call(s)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=r,i=s,n=!0,o=void 0}}(Object.getPrototypeOf(p.prototype),"constructor",this).call(this),this.srcUrl=e,this.hls_=t,this.withCredentials=i,!this.srcUrl)throw new Error("A non-empty playlist URL is required");this.state="HAVE_NOTHING",this.on("mediaupdatetimeout",function(){"HAVE_METADATA"===n.state&&(n.state="HAVE_CURRENT_METADATA",n.request=n.hls_.xhr({uri:(0,s.default)(n.master.uri,n.media().uri),withCredentials:n.withCredentials},function(e,t){if(n.request)return e?n.playlistRequestError(n.request,n.media().uri,"HAVE_METADATA"):void n.haveMetadata(n.request,n.media().uri)}))})}g.default=t}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./resolve-url":15,"global/window":32,"m3u8-parser":33}],10:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(i,"__esModule",{value:!0});function a(e,t){var i;return e&&(i=window.getComputedStyle(e))?i[t]:""}function f(e,n){var a=e.slice();e.sort(function(e,t){var i=n(e,t);return 0===i?a.indexOf(e)-a.indexOf(t):i})}function d(e,t){var i=void 0,n=void 0;return(i=(i=e.attributes.BANDWIDTH?e.attributes.BANDWIDTH:i)||window.Number.MAX_VALUE)-(n=(n=t.attributes.BANDWIDTH?t.attributes.BANDWIDTH:n)||window.Number.MAX_VALUE)}var h=n(e("./config")),p=n(e("./playlist")),r=e("./util/codecs.js");i.comparePlaylistBandwidth=d;i.comparePlaylistResolution=function(e,t){var i=void 0,n=void 0;return(i=(i=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width?e.attributes.RESOLUTION.width:i)||window.Number.MAX_VALUE)===(n=(n=t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width?t.attributes.RESOLUTION.width:n)||window.Number.MAX_VALUE)&&e.attributes.BANDWIDTH&&t.attributes.BANDWIDTH?e.attributes.BANDWIDTH-t.attributes.BANDWIDTH:i-n};function s(e,t,i,n){var a=e.playlists.map(function(e){var t=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width,i=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height;return{bandwidth:e.attributes.BANDWIDTH||window.Number.MAX_VALUE,width:t,height:i,playlist:e}});f(a,function(e,t){return e.bandwidth-t.bandwidth});var r=(a=a.filter(function(e){return!p.default.isIncompatible(e.playlist)})).filter(function(e){return p.default.isEnabled(e.playlist)}),s=(l=(r=!r.length?a.filter(function(e){return!p.default.isDisabled(e.playlist)}):r).filter(function(e){return e.bandwidth*h.default.BANDWIDTH_VARIANCE<t}))[l.length-1],o=l.filter(function(e){return e.bandwidth===s.bandwidth})[0],u=l.filter(function(e){return e.width&&e.height});f(u,function(e,t){return e.width-t.width});var s=(c=u.filter(function(e){return e.width===i&&e.height===n}))[c.length-1],e=c.filter(function(e){return e.bandwidth===s.bandwidth})[0],d=void 0,l=void 0,c=void 0;return e||(l=(d=u.filter(function(e){return e.width>i||e.height>n})).filter(function(e){return e.width===d[0].width&&e.height===d[0].height}),s=l[l.length-1],c=l.filter(function(e){return e.bandwidth===s.bandwidth})[0]),(a=c||e||o||r[0]||a[0])?a.playlist:null}i.simpleSelector=s;i.lastBandwidthSelector=function(){return s(this.playlists.master,this.systemBandwidth,parseInt(a(this.tech_.el(),"width"),10),parseInt(a(this.tech_.el(),"height"),10))};i.movingAverageBandwidthSelector=function(e){var t=-1;if(e<0||1<e)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){return t<0&&(t=this.systemBandwidth),t=e*this.systemBandwidth+(1-e)*t,s(this.playlists.master,t,parseInt(a(this.tech_.el(),"width"),10),parseInt(a(this.tech_.el(),"height"),10))}};i.minRebufferMaxBandwidthSelector=function(e){var t=e.master,i=e.currentTime,n=e.bandwidth,a=e.duration,r=e.segmentDuration,s=e.timeUntilRebuffer,o=e.currentTimeline,u=e.syncController,e=t.playlists.filter(function(e){return!p.default.isIncompatible(e)}),t=e.filter(p.default.isEnabled),e=(t=!t.length?e.filter(function(e){return!p.default.isDisabled(e)}):t).filter(p.default.hasAttribute.bind(null,"BANDWIDTH")).map(function(e){var t=u.getSyncPoint(e,a,o,i)?1:2;return{playlist:e,rebufferingImpact:p.default.estimateSegmentRequestTime(r,n,e)*t-s}}),t=e.filter(function(e){return e.rebufferingImpact<=0});return f(t,function(e,t){return d(t.playlist,e.playlist)}),t.length?t[0]:(f(e,function(e,t){return e.rebufferingImpact-t.rebufferingImpact}),e[0]||null)};i.lowestBitrateCompatibleVariantSelector=function(){var e=this.playlists.master.playlists.filter(p.default.isEnabled);return f(e,d),e.filter(function(e){return(0,r.parseCodecs)(e.attributes.CODECS).videoCodec})[0]||null}},{"./config":3,"./playlist":11,"./util/codecs.js":19}],11:[function(O,e,E){!function(e){"use strict";Object.defineProperty(E,"__esModule",{value:!0});function n(e,t,i){var n;return(t=void 0===t?e.mediaSequence+e.segments.length:t)<e.mediaSequence?0:(n=o(e,t)).precise?n.result:(t=u(e,t)).precise?t.result:n.result+i}function a(e,t,i){if(!e)return 0;if(void 0===t){if(e.totalDuration)return e.totalDuration;if(!e.endList)return s.default.Infinity}return n(e,t,i="number"!=typeof i?0:i)}var t,r="undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null,i=O("global/window"),s=(t=i)&&t.__esModule?t:{default:t},o=function(e,t){var i=0,n=t-e.mediaSequence,a=e.segments[n];if(a){if(void 0!==a.start)return{result:a.start,precise:!0};if(void 0!==a.end)return{result:a.end-a.duration,precise:!0}}for(;n--;){if(void 0!==(a=e.segments[n]).end)return{result:i+a.end,precise:!0};if(i+=a.duration,void 0!==a.start)return{result:i+a.start,precise:!0}}return{result:i,precise:!1}},u=function(e,t){for(var i,n=0,a=t-e.mediaSequence;a<e.segments.length;a++){if(void 0!==(i=e.segments[a]).start)return{result:i.start-n,precise:!0};if(n+=i.duration,void 0!==i.end)return{result:i.end-n,precise:!0}}return{result:-1,precise:!1}};E.duration=a;function d(e,t,i){var n,a=0;if(i<t&&(t=(n=[i,t])[0],i=n[1]),t<0){for(var r=t;r<Math.min(0,i);r++)a+=e.targetDuration;t=0}for(r=t;r<i;r++)a+=e.segments[r].duration;return a}E.sumDurations=d;function l(e){if(!e.segments.length)return 0;for(var t=e.segments.length-1,i=e.segments[t].duration||e.targetDuration,n=i+2*e.targetDuration;t--&&!(n<=(i+=e.segments[t].duration)););return Math.max(0,t)}E.safeLiveIndex=l;function c(e,t,i){return e&&e.segments?e.endList?a(e):null===t?null:(t=t||0,i=i?l(e):e.segments.length,n(e,e.mediaSequence+i,t)):null}E.playlistEnd=c;function f(e,t){var i=t||0;return null===(t=c(e,t,!0))?(0,r.createTimeRange)():(0,r.createTimeRange)(i,t)}E.seekable=f;function h(e){return e-Math.floor(e)==0}function p(e,t,i,n){var a=void 0,r=void 0,s=e.segments.length,o=t-n;if(o<0){if(0<i)for(a=i-1;0<=a;a--)if(r=e.segments[a],0<(o+=y(r.duration)))return{mediaIndex:a,startTime:n-d(e,i,a)};return{mediaIndex:0,startTime:t}}if(i<0){for(a=i;a<0;a++)if((o-=e.targetDuration)<0)return{mediaIndex:0,startTime:t};i=0}for(a=i;a<s;a++)if(r=e.segments[a],(o-=g(r.duration))<0)return{mediaIndex:a,startTime:n+d(e,i,a)};return{mediaIndex:s-1,startTime:t}}var m=function(e,t){if(h(t))return t+.1*e;for(var i=t.toString().split(".")[1].length,n=1;n<=i;n++){var a=Math.pow(10,n),r=t*a;if(h(r)||n===i)return(r+e)/a}},g=m.bind(null,1),y=m.bind(null,-1);E.getMediaInfoForTime=p;function _(e){return e.excludeUntil&&e.excludeUntil>Date.now()}E.isBlacklisted=_;function v(e){return e.excludeUntil&&e.excludeUntil===1/0}E.isIncompatible=v;function b(e){var t=_(e);return!e.disabled&&!t}E.isEnabled=b;function T(e){return e.disabled}E.isDisabled=T;function S(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].key)return!0;return!1}E.isAes=S;function w(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].map)return!0;return!1}E.isFmp4=w;function k(e,t){return t.attributes&&t.attributes[e]}E.hasAttribute=k;e=function(e,t,i){return k("BANDWIDTH",i)?(e*i.attributes.BANDWIDTH-8*(arguments.length<=3||void 0===arguments[3]?0:arguments[3]))/t:NaN};E.estimateSegmentRequestTime=e;m=function(e,t){if(1===e.playlists.length)return!0;var i=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter(function(e){return!!b(e)&&(e.attributes.BANDWIDTH||0)<i}).length};E.isLowestEnabledRendition=m,E.default={duration:a,seekable:f,safeLiveIndex:l,getMediaInfoForTime:p,isEnabled:b,isDisabled:T,isBlacklisted:_,isIncompatible:v,playlistEnd:c,isAes:S,isFmp4:w,hasAttribute:k,estimateSegmentRequestTime:e,isLowestEnabledRendition:m}}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"global/window":32}],12:[function(e,r,s){!function(e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,a=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(i.push(s.value),!t||i.length!==t);n=!0);}catch(e){a=!0,r=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw r}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function n(e,t){var i=[],n=void 0;if(e&&e.length)for(n=0;n<e.length;n++)t(e.start(n),e.end(n))&&i.push([e.start(n),e.end(n)]);return u.default.createTimeRanges(i)}var t,i="undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null,u=(t=i)&&t.__esModule?t:{default:t},a=1/30,c=function(e,t){var i=null,n=null,a=0,r=[],s=[];if(!(e&&e.length&&t&&t.length))return u.default.createTimeRange();for(var o=e.length;o--;)r.push({time:e.start(o),type:"start"}),r.push({time:e.end(o),type:"end"});for(o=t.length;o--;)r.push({time:t.start(o),type:"start"}),r.push({time:t.end(o),type:"end"});for(r.sort(function(e,t){return e.time-t.time}),o=0;o<r.length;o++)"start"===r[o].type?2===++a&&(i=r[o].time):"end"===r[o].type&&1===--a&&(n=r[o].time),null!==i&&null!==n&&(s.push([i,n]),n=i=null);return u.default.createTimeRanges(s)};s.default={findRange:function(e,i){return n(e,function(e,t){return e-a<=i&&i<=t+a})},findNextRange:function(e,t){return n(e,function(e){return t<=e-a})},findGaps:function(e){if(e.length<2)return u.default.createTimeRanges();for(var t=[],i=1;i<e.length;i++){var n=e.end(i-1),a=e.start(i);t.push([n,a])}return u.default.createTimeRanges(t)},findSoleUncommonTimeRangesEnd:function(e,t){function i(e){return e[0]<=r&&e[1]>=r}var n=void 0,a=void 0,r=void 0,s=[],o=[];if(e)for(n=0;n<e.length;n++)a=e.start(n),r=e.end(n),o.push([a,r]);if(t)for(n=0;n<t.length;n++)a=t.start(n),r=t.end(n),o.some(i)||s.push(r);return 1!==s.length?null:s[0]},getSegmentBufferedPercent:function(e,t,i,n){var a,r=e+t,s=u.default.createTimeRanges([[e,r]]),r=u.default.createTimeRanges([[(a=e,t=(e=o(t=[i,r],2))[0],e=e[1],Math.min(Math.max(t,a),e)),r]]);if(r.start(0)===r.end(0))return 0;n=function(e,t,i,n){for(var a=t.end(0)-t.start(0),r=a-(e.end(0)-e.start(0)),s=c(e,n),o=c(t,n),u=0,d=0,l=s.length;l--;)u+=s.end(l)-s.start(l),s.start(l)===i&&(u+=r);for(l=o.length;l--;)d+=o.end(l)-o.start(l);return Math.max(u,d)/a*100}(r,s,i,n);return isNaN(n)||n===1/0||n===-1/0?0:n},TIME_FUDGE_FACTOR:a,SAFE_TIME_DELTA:.1,printableRange:function(e){var t=[];if(!e||!e.length)return"";for(var i=0;i<e.length;i++)t.push(e.start(i)+" => "+e.end(i));return t.join(", ")},timeUntilRebuffer:function(e,t){var i=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return((e.length?e.end(e.length-1):0)-t)/i}},r.exports=s.default}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(e,n,a){!function(e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});function d(t,e){var i=0,n=0,a=l.default.mergeOptions(c,e);function r(e){null!=e&&(n=t.duration()!==1/0&&t.currentTime()||0,t.one("loadedmetadata",u),t.src(e),t.trigger({type:"usage",name:"hls-error-reload"}),t.play())}function s(){if(Date.now()-i<1e3*a.errorInterval)t.trigger({type:"usage",name:"hls-error-reload-canceled"});else{if(a.getSource&&"function"==typeof a.getSource)return i=Date.now(),a.getSource.call(t,r);l.default.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}}function o(){t.off("loadedmetadata",u),t.off("error",s),t.off("dispose",o)}t.ready(function(){t.trigger({type:"usage",name:"hls-error-reload-initialized"})});var u=function(){n&&t.currentTime(n)};t.on("error",s),t.on("dispose",o),t.reloadSourceOnError=function(e){o(),d(t,e)}}var t,i="undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null,l=(t=i)&&t.__esModule?t:{default:t},c={errorInterval:30,getSource:function(e){return e(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_)}};a.default=function(e){d(this,e)},n.exports=a.default}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],14:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function r(e,t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var n,a=e.masterPlaylistController_.fastQualityChange_.bind(e.masterPlaylistController_);t.attributes.RESOLUTION&&(n=t.attributes.RESOLUTION,this.width=n.width,this.height=n.height),this.bandwidth=t.attributes.BANDWIDTH,this.id=i,this.enabled=s(e.playlists,t.uri,a)}var o=e("./playlist.js"),s=function(a,r,s){return function(e){var t=a.master.playlists[r],i=(0,o.isIncompatible)(t),n=(0,o.isEnabled)(t);return void 0===e?n:(e?delete t.disabled:t.disabled=!0,e===n||i||(s(),e?a.trigger("renditionenabled"):a.trigger("renditiondisabled")),e)}};i.default=function(i){var e=i.playlists;i.representations=function(){return e.master.playlists.filter(function(e){return!(0,o.isIncompatible)(e)}).map(function(e,t){return new r(i,e,e.uri)})}},t.exports=i.default},{"./playlist.js":11}],15:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(i,"__esModule",{value:!0});var a=n(e("url-toolkit")),r=n(e("global/window"));i.default=function(e,t){return/^[a-z]+:/i.test(t)?t:(/\/\//i.test(e)||(e=a.default.buildAbsoluteURL(r.default.location.href,e)),a.default.buildAbsoluteURL(e,t))},t.exports=i.default},{"global/window":32,"url-toolkit":63}],16:[function(v,e,b){!function(e){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var t=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t,i){return!(!e||!t)&&(i=i===e.segments.length,e.endList&&"open"===t.readyState&&i)}function r(e){return"number"==typeof e&&isFinite(e)}function s(e,t,i){return"main"===e&&t&&i?i.containsAudio||i.containsVideo?t.containsVideo&&!i.containsVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!t.containsVideo&&i.containsVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null}var d=i(v("./playlist")),o=i("undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null),u=i(v("./source-updater")),l=i(v("./config")),c=i(v("global/window")),f=i(v("videojs-contrib-media-sources/es5/remove-cues-from-track.js")),h=v("./bin-utils"),p=v("./media-segment-request"),m=v("./ranges"),g=v("./playlist-selectors");b.illegalMediaSwitch=s;function y(e,t,i){var n=void 0,n=e.length&&0<e.start(0)&&e.start(0)<t?e.start(0):t-30;return Math.min(n,t-i)}b.safeBackBufferTrimTime=y;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(_,o.default.EventTarget),t(_,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.state="DISPOSED",this.pause(),this.abort_(),this.sourceUpdater_&&this.sourceUpdater_.dispose(),this.resetStats_()}},{key:"abort",value:function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)}},{key:"abort_",value:function(){this.pendingSegment_&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null}},{key:"error",value:function(e){return void 0!==e&&(this.error_=e),this.pendingSegment_=null,this.error_}},{key:"endOfStream",value:function(){this.ended_=!0,this.pause(),this.trigger("ended")}},{key:"buffered_",value:function(){return this.sourceUpdater_?this.sourceUpdater_.buffered():o.default.createTimeRanges()}},{key:"initSegment",value:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];if(!e)return null;var i=(0,h.initSegmentId)(e),n=this.initSegments_[i];return t&&!n&&e.bytes&&(this.initSegments_[i]=n={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes}),n||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&"INIT"===this.state)&&!this.paused()}},{key:"load",value:function(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY")}}},{key:"init_",value:function(){return this.state="READY",this.sourceUpdater_=new u.default(this.mediaSource_,this.mimeType_),this.resetEverything(),this.monitorBuffer_()}},{key:"playlist",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(e){var i=this.playlist_,n=this.pendingSegment_;if(this.playlist_=e,this.xhrOptions_=t,this.hasPlayed_()||(e.syncInfo={mediaSequence:e.mediaSequence,time:0}),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();i&&i.uri===e.uri?(t=e.mediaSequence-i.mediaSequence,this.logger_("mediaSequenceDiff",t),null!==this.mediaIndex&&(this.mediaIndex-=t),n&&(n.mediaIndex-=t,0<=n.mediaIndex&&(n.segment=e.segments[n.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(i,e)):null!==this.mediaIndex&&this.resyncLoader()}}},{key:"pause",value:function(){this.checkBufferTimeout_&&(c.default.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"mimeType",value:function(e){this.mimeType_||(this.mimeType_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_())}},{key:"resetEverything",value:function(){this.ended_=!1,this.resetLoader(),this.remove(0,this.duration_()),this.trigger("reseteverything")}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1,this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null,this.syncPoint_=null,this.abort()}},{key:"remove",value:function(e,t){this.sourceUpdater_&&this.sourceUpdater_.remove(e,t),(0,f.default)(e,t,this.segmentMetadataTrack_)}},{key:"monitorBuffer_",value:function(){this.checkBufferTimeout_&&c.default.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=c.default.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&c.default.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=c.default.setTimeout(this.monitorBufferTick_.bind(this),500)}},{key:"fillBuffer_",value:function(){var e;this.sourceUpdater_.updating()||(this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_())),(e=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_))&&(a(this.playlist_,this.mediaSource_,e.mediaIndex)?this.endOfStream():e.mediaIndex===this.playlist_.segments.length-1&&"ended"===this.mediaSource_.readyState&&!this.seeking_()||((e.timeline!==this.currentTimeline_||null!==e.startOfSegment&&e.startOfSegment<this.sourceUpdater_.timestampOffset())&&(this.syncController_.reset(),e.timestampOffset=e.startOfSegment),this.loadSegment_(e))))}},{key:"checkBuffer_",value:function(e,t,i,n,a,r){var s=0,o=void 0;e.length&&(s=e.end(e.length-1));e=Math.max(0,s-a);if(!t.segments.length)return null;if(e>=this.goalBufferLength_())return null;if(!n&&1<=e)return null;if(this.logger_("checkBuffer_","mediaIndex:",i,"hasPlayed:",n,"currentTime:",a,"syncPoint:",r,"fetchAtBuffer:",this.fetchAtBuffer_,"bufferedTime:",e),null===r)return i=this.getSyncSegmentCandidate_(t),this.logger_("getSync","mediaIndex:",i),this.generateSegmentInfo_(t,i,null,!0);if(null===i)return o=(i=(u=this.fetchAtBuffer_?d.default.getMediaInfoForTime(t,s,r.segmentIndex,r.time):d.default.getMediaInfoForTime(t,a,r.segmentIndex,r.time)).mediaIndex,u.startTime),this.logger_("getMediaIndexForTime","mediaIndex:",i,"startOfSegment:",o),this.generateSegmentInfo_(t,i,o,!1);this.logger_("walkForward","mediaIndex:",i+1);var u=t.segments[i],o=u&&u.end?u.end:s;return this.generateSegmentInfo_(t,i+1,o,!1)}},{key:"getSyncSegmentCandidate_",value:function(e){var t=this;if(-1===this.currentTimeline_)return 0;var i=e.segments.map(function(e,t){return{timeline:e.timeline,segmentIndex:t}}).filter(function(e){return e.timeline===t.currentTimeline_});return i.length?i[Math.min(i.length-1,1)].segmentIndex:Math.max(e.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function(e,t,i,n){if(t<0||t>=e.segments.length)return null;var a=e.segments[t];return{requestId:"segment-loader-"+Math.random(),uri:a.resolvedUri,mediaIndex:t,isSyncRequest:n,startOfSegment:i,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:a.timeline,duration:a.duration,segment:a}}},{key:"abortRequestEarly_",value:function(e){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return!1;if(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return!1;var t=this.currentTime_(),i=e.bandwidth,n=this.pendingSegment_.duration,a=d.default.estimateSegmentRequestTime(n,i,this.playlist_,e.bytesReceived),e=(0,m.timeUntilRebuffer)(this.buffered_(),t,this.hls_.tech_.playbackRate())-1;if(a<=e)return!1;i=(0,g.minRebufferMaxBandwidthSelector)({master:this.hls_.playlists.master,currentTime:t,bandwidth:i,duration:this.duration_(),segmentDuration:n,timeUntilRebuffer:e,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(i){n=a-e-i.rebufferingImpact,a=.5;return(e<=m.TIME_FUDGE_FACTOR&&(a=1),!i.playlist||i.playlist.uri===this.playlist_.uri||n<a)?!1:(this.bandwidth=i.playlist.attributes.BANDWIDTH*l.default.BANDWIDTH_VARIANCE+1,this.abort(),this.trigger("earlyabort"),!0)}}},{key:"handleProgress_",value:function(e,t){this.pendingSegment_&&t.requestId===this.pendingSegment_.requestId&&!this.abortRequestEarly_(t.stats)&&this.trigger("progress")}},{key:"loadSegment_",value:function(e){this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),e.abortRequests=(0,p.mediaSegmentRequest)(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.createSimplifiedSegmentObj_(e),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function(e){var t=y(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);0<t&&this.remove(0,t)}},{key:"createSimplifiedSegmentObj_",value:function(e){var t=e.segment,i={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:e.requestId};return t.key&&(e=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]),i.key={resolvedUri:t.key.resolvedUri,iv:e}),t.map&&(i.map=this.initSegment(t.map)),i}},{key:"segmentRequestFinished_",value:function(e,t){if(this.mediaRequests+=1,t.stats&&(this.mediaBytesTransferred+=t.stats.bytesReceived,this.mediaTransferDuration+=t.stats.roundTripTime),this.pendingSegment_){if(t.requestId===this.pendingSegment_.requestId){if(e)return this.pendingSegment_=null,this.state="READY",e.code===p.REQUEST_ERRORS.ABORTED?void(this.mediaRequestsAborted+=1):(this.pause(),e.code===p.REQUEST_ERRORS.TIMEOUT?(this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,void this.trigger("bandwidthupdate")):(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error")));this.bandwidth=t.stats.bandwidth,this.roundTrip=t.stats.roundTripTime,t.map&&(t.map=this.initSegment(t.map,!0)),this.processSegmentResponse_(t)}}else this.mediaRequestsAborted+=1}},{key:"processSegmentResponse_",value:function(e){var t=this.pendingSegment_;t.bytes=e.bytes,e.map&&(t.segment.map.bytes=e.map.bytes),t.endOfAllRequests=e.endOfAllRequests,this.handleSegment_()}},{key:"handleSegment_",value:function(){var e=this;if(this.pendingSegment_){var t=this.pendingSegment_,i=t.segment,n=this.syncController_.probeSegmentInfo(t);void 0===this.startingMedia_&&n&&(n.containsAudio||n.containsVideo)&&(this.startingMedia_={containsAudio:n.containsAudio,containsVideo:n.containsVideo});n=s(this.loaderType_,this.startingMedia_,n);if(n)return this.error({message:n,blacklistDuration:1/0}),void this.trigger("error");if(t.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");null!==t.timestampOffset&&t.timestampOffset!==this.sourceUpdater_.timestampOffset()&&(this.sourceUpdater_.timestampOffset(t.timestampOffset),this.trigger("timestampoffset"));var a,n=this.syncController_.mappingForTimeline(t.timeline);null!==n&&this.trigger({type:"segmenttimemapping",mapping:n}),this.state="APPENDING",i.map&&(a=(0,h.initSegmentId)(i.map),e.activeInitSegmentId_&&e.activeInitSegmentId_===a||(n=e.initSegment(i.map),e.sourceUpdater_.appendBuffer(n.bytes,function(){e.activeInitSegmentId_=a}))),t.byteLength=t.bytes.byteLength,"number"==typeof i.start&&"number"==typeof i.end?this.mediaSecondsLoaded+=i.end-i.start:this.mediaSecondsLoaded+=i.duration,this.sourceUpdater_.appendBuffer(t.bytes,this.handleUpdateEnd_.bind(this))}else this.state="READY"}},{key:"handleUpdateEnd_",value:function(){if(this.logger_("handleUpdateEnd_","segmentInfo:",this.pendingSegment_),!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var e=this.pendingSegment_,t=e.segment,i=null!==this.mediaIndex;this.pendingSegment_=null,this.recordThroughput_(e),this.addSegmentMetadataCue_(e),this.state="READY",this.mediaIndex=e.mediaIndex,this.fetchAtBuffer_=!0,this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate"),t.end&&this.currentTime_()-t.end>3*e.playlist.targetDuration?this.resetEverything():(i&&this.trigger("bandwidthupdate"),this.trigger("progress"),a(e.playlist,this.mediaSource_,e.mediaIndex+1)&&this.endOfStream(),this.paused()||this.monitorBuffer_())}},{key:"recordThroughput_",value:function(e){var t=this.throughput.rate,i=Date.now()-e.endOfAllRequests+1,i=Math.floor(e.byteLength/i*8*1e3);this.throughput.rate+=(i-t)/++this.throughput.count}},{key:"logger_",value:function(){}},{key:"addSegmentMetadataCue_",value:function(e){var t,i,n;this.segmentMetadataTrack_&&(t=(i=e.segment).start,n=i.end,r(t)&&r(n)&&((0,f.default)(t,n,this.segmentMetadataTrack_),i=c.default.WebKitDataCue||c.default.VTTCue,e={uri:e.uri,timeline:e.timeline,playlist:e.playlist.uri,start:t,end:n},(n=new i(t,n,JSON.stringify(e))).value=e,this.segmentMetadataTrack_.addCue(n)))}}]),t=_;function _(e){var t=this,i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,_),function(e,t,i){for(var n=!0;n;){var a=e,r=t,s=i,n=!1;null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,r);if(void 0!==o){if("value"in o)return o.value;var u=o.get;return void 0===u?void 0:u.call(s)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=r,i=s,n=!0,o=void 0}}(Object.getPrototypeOf(_.prototype),"constructor",this).call(this),!e)throw new TypeError("Initialization settings are required");if("function"!=typeof e.currentTime)throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");this.state="INIT",this.bandwidth=e.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.hasPlayed_=e.hasPlayed,this.currentTime_=e.currentTime,this.seekable_=e.seekable,this.seeking_=e.seeking,this.duration_=e.duration,this.mediaSource_=e.mediaSource,this.hls_=e.hls,this.loaderType_=e.loaderType,this.startingMedia_=void 0,this.segmentMetadataTrack_=e.segmentMetadataTrack,this.goalBufferLength_=e.goalBufferLength,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.pendingSegment_=null,this.mimeType_=null,this.sourceUpdater_=null,this.xhrOptions_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.decrypter_=e.decrypter,this.syncController_=e.syncController,this.syncPoint_={segmentIndex:0,time:0},this.syncController_.on("syncinfoupdate",function(){return t.trigger("syncinfoupdate")}),this.mediaSource_.addEventListener("sourceopen",function(){return t.ended_=!1}),this.fetchAtBuffer_=!1,i.debug&&(this.logger_=o.default.log.bind(o.default,"segment-loader",this.loaderType_,"->"))}b.default=t}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./bin-utils":2,"./config":3,"./media-segment-request":7,"./playlist":11,"./playlist-selectors":10,"./ranges":12,"./source-updater":17,"global/window":32,"videojs-contrib-media-sources/es5/remove-cues-from-track.js":72}],17:[function(e,u,d){!function(e){"use strict";Object.defineProperty(d,"__esModule",{value:!0});var t=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(){}var i,r="undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null,s=(i=r)&&i.__esModule?i:{default:i},t=(t(o,[{key:"abort",value:function(e){var t=this;this.processedAppend_&&this.queueCallback_(function(){t.sourceBuffer_.abort()},e)}},{key:"appendBuffer",value:function(e,t){var i=this;this.processedAppend_=!0,this.queueCallback_(function(){i.sourceBuffer_.appendBuffer(e)},t)}},{key:"buffered",value:function(){return this.sourceBuffer_?this.sourceBuffer_.buffered:s.default.createTimeRanges()}},{key:"remove",value:function(e,t){var i=this;this.processedAppend_&&this.queueCallback_(function(){i.sourceBuffer_.remove(e,t)},a)}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating||this.pendingCallback_}},{key:"timestampOffset",value:function(e){var t=this;return void 0!==e&&(this.queueCallback_(function(){t.sourceBuffer_.timestampOffset=e}),this.timestampOffset_=e),this.timestampOffset_}},{key:"queueCallback_",value:function(e,t){this.callbacks_.push([e.bind(this),t]),this.runCallback_()}},{key:"runCallback_",value:function(){var e=void 0;!this.updating()&&this.callbacks_.length&&(e=this.callbacks_.shift(),this.pendingCallback_=e[1],e[0]())}},{key:"dispose",value:function(){this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_),this.sourceBuffer_&&"open"===this.mediaSource.readyState&&this.sourceBuffer_.abort()}}]),o);function o(e,t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);function n(){i.sourceBuffer_=e.addSourceBuffer(t),i.onUpdateendCallback_=function(){var e=i.pendingCallback_;i.pendingCallback_=null,e&&e(),i.runCallback_()},i.sourceBuffer_.addEventListener("updateend",i.onUpdateendCallback_),i.runCallback_()}this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=e,this.processedAppend_=!1,"closed"===e.readyState?e.addEventListener("sourceopen",n):n()}d.default=t,u.exports=d.default}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],18:[function(l,e,c){!function(e){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var t=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e){return e&&e.__esModule?e:{default:e}}var a=i(l("mux.js/lib/mp4/probe")),r=l("mux.js/lib/tools/ts-inspector.js"),d=l("./playlist"),s=i("undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null),u=[{name:"VOD",run:function(e,t,i,n,a){if(i===1/0)return null;return{time:0,segmentIndex:0}}},{name:"ProgramDateTime",run:function(e,t,i,n,a){return e.datetimeToDisplayTime&&t.dateTimeObject?{time:t.dateTimeObject.getTime()/1e3+e.datetimeToDisplayTime,segmentIndex:0}:null}},{name:"Segment",run:function(e,t,i,n,a){var r=t.segments||[],s=null,o=null;a=a||0;for(var u=0;u<r.length;u++){var d=r[u];if(d.timeline===n&&void 0!==d.start){var l=Math.abs(a-d.start);if(null!==o&&o<l)break;(!s||null===o||l<=o)&&(o=l,s={time:d.start,segmentIndex:u})}}return s}},{name:"Discontinuity",run:function(e,t,i,n,a){var r=null;if(a=a||0,t.discontinuityStarts&&t.discontinuityStarts.length)for(var s=null,o=0;o<t.discontinuityStarts.length;o++){var u=t.discontinuityStarts[o],d=t.discontinuitySequence+o+1,l=e.discontinuities[d];if(l){d=Math.abs(a-l.time);if(null!==s&&s<d)break;(!r||null===s||d<=s)&&(s=d,r={time:l.time,segmentIndex:u})}}return r}},{name:"Playlist",run:function(e,t,i,n,a){return t.syncInfo?{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence}:null}}];c.syncPointStrategies=u;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(o,s.default.EventTarget),t(o,[{key:"getSyncPoint",value:function(e,t,i,n){i=this.runStrategies_(e,t,i,n);return i.length?this.selectSyncPoint_(i,{key:"time",value:n}):null}},{key:"getExpiredTime",value:function(e,t){if(!e||!e.segments)return null;t=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!t.length)return null;t=this.selectSyncPoint_(t,{key:"segmentIndex",value:0});return 0<t.segmentIndex&&(t.time*=-1),Math.abs(t.time+(0,d.sumDurations)(e,t.segmentIndex,0))}},{key:"runStrategies_",value:function(e,t,i,n){for(var a=[],r=0;r<u.length;r++){var s=u[r],o=s.run(this,e,t,i,n);o&&(o.strategy=s.name,a.push({strategy:s.name,syncPoint:o}),this.logger_("syncPoint found via <"+s.name+">:",o))}return a}},{key:"selectSyncPoint_",value:function(e,t){for(var i=e[0].syncPoint,n=Math.abs(e[0].syncPoint[t.key]-t.value),a=e[0].strategy,r=1;r<e.length;r++){var s=Math.abs(e[r].syncPoint[t.key]-t.value);s<n&&(n=s,i=e[r].syncPoint,a=e[r].strategy)}return this.logger_("syncPoint with strategy <"+a+"> chosen: ",i),i}},{key:"saveExpiredSegmentInfo",value:function(e,t){for(var i=t.mediaSequence-e.mediaSequence-1;0<=i;i--){var n=e.segments[i];if(n&&void 0!==n.start){t.syncInfo={mediaSequence:e.mediaSequence+i,time:n.start},this.logger_("playlist sync:",t.syncInfo),this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(e){!this.datetimeToDisplayTime&&e.dateTimeObject&&(e=e.dateTimeObject.getTime()/1e3,this.datetimeToDisplayTime=-e)}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(e){var t=e.segment,i=e.playlist,n=void 0;return(n=t.map?this.probeMp4Segment_(e):this.probeTsSegment_(e))&&this.calculateSegmentTimeMapping_(e,n)&&(this.saveDiscontinuitySyncInfo_(e),i.syncInfo||(i.syncInfo={mediaSequence:i.mediaSequence+e.mediaIndex,time:t.start})),n}},{key:"probeMp4Segment_",value:function(e){var t=e.segment,i=a.default.timescale(t.map.bytes),i=a.default.startTime(i,e.bytes);return null!==e.timestampOffset&&(e.timestampOffset-=i),{start:i,end:i+t.duration}}},{key:"probeTsSegment_",value:function(e){var t=(0,r.inspect)(e.bytes,this.inspectCache_),i=void 0,e=void 0;return t?(t.video&&2===t.video.length?(this.inspectCache_=t.video[1].dts,i=t.video[0].dtsTime,e=t.video[1].dtsTime):t.audio&&2===t.audio.length&&(this.inspectCache_=t.audio[1].dts,i=t.audio[0].dtsTime,e=t.audio[1].dtsTime),{start:i,end:e,containsVideo:t.video&&2===t.video.length,containsAudio:t.audio&&2===t.audio.length}):null}},{key:"timestampOffsetForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].time}},{key:"mappingForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].mapping}},{key:"calculateSegmentTimeMapping_",value:function(e,t){var i=e.segment,n=this.timelines[e.timeline];if(null!==e.timestampOffset)this.logger_("tsO:",e.timestampOffset),n={time:e.startOfSegment,mapping:e.startOfSegment-t.start},this.timelines[e.timeline]=n,this.trigger("timestampoffset"),i.start=e.startOfSegment,i.end=t.end+n.mapping;else{if(!n)return!1;i.start=t.start+n.mapping,i.end=t.end+n.mapping}return!0}},{key:"saveDiscontinuitySyncInfo_",value:function(e){var t=e.playlist,i=e.segment;if(i.discontinuity)this.discontinuities[i.timeline]={time:i.start,accuracy:0};else if(t.discontinuityStarts.length)for(var n=0;n<t.discontinuityStarts.length;n++){var a,r=t.discontinuityStarts[n],s=t.discontinuitySequence+n+1,o=r-e.mediaIndex,u=Math.abs(o);(!this.discontinuities[s]||this.discontinuities[s].accuracy>u)&&(a=void 0,a=o<0?i.start-(0,d.sumDurations)(t,e.mediaIndex,r):i.end+(0,d.sumDurations)(t,e.mediaIndex+1,r),this.discontinuities[s]={time:a,accuracy:u})}}},{key:"logger_",value:function(){}}]),t=o;function o(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),function(e,t,i){for(var n=!0;n;){var a=e,r=t,s=i,n=!1;null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,r);if(void 0!==o){if("value"in o)return o.value;var u=o.get;return void 0===u?void 0:u.call(s)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=r,i=s,n=!0,o=void 0}}(Object.getPrototypeOf(o.prototype),"constructor",this).call(this),this.inspectCache_=void 0,this.timelines=[],this.discontinuities=[],this.datetimeToDisplayTime=null,e.debug&&(this.logger_=s.default.log.bind(s.default,"sync-controller ->"))}c.default=t}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./playlist":11,"mux.js/lib/mp4/probe":57,"mux.js/lib/tools/ts-inspector.js":59}],19:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.parseCodecs=function(){var e,t=arguments.length<=0||void 0===arguments[0]?"":arguments[0],i={codecCount:0};return i.codecCount=t.split(",").length,i.codecCount=i.codecCount||2,(e=/(^|\s|,)+(avc1)([^ ,]*)/i.exec(t))&&(i.videoCodec=e[2],i.videoObjectTypeIndicator=e[3]),i.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(t),i.audioProfile=i.audioProfile&&i.audioProfile[2],i}},{}],20:[function(f,h,p){!function(e){"use strict";Object.defineProperty(p,"__esModule",{value:!0});var t=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return String.fromCharCode.apply(null,e)}var r=i(f("./segment-loader")),s=i("undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null),o=i(f("global/window")),u=i(f("videojs-contrib-media-sources/es5/remove-cues-from-track.js")),d=f("./bin-utils"),l=new Uint8Array("\n\n".split("").map(function(e){return e.charCodeAt(0)})),t=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,r.default),t(c,[{key:"buffered_",value:function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return s.default.createTimeRanges();var e=this.subtitlesTrack_.cues,t=e[0].startTime,e=e[e.length-1].startTime;return s.default.createTimeRanges([[t,e]])}},{key:"initSegment",value:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];if(!e)return null;var i=(0,d.initSegmentId)(e),n=this.initSegments_[i];return t&&!n&&e.bytes&&(t=l.byteLength+e.bytes.byteLength,(t=new Uint8Array(t)).set(e.bytes),t.set(l,e.bytes.byteLength),this.initSegments_[i]=n={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:t}),n||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}},{key:"track",value:function(e){return void 0===e||(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_}},{key:"remove",value:function(e,t){(0,u.default)(e,t,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function(){var e=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(t=this.skipEmptySegments_(t)){if(null===this.syncController_.timestampOffsetForTimeline(t.timeline))return this.syncController_.one("timestampoffset",function(){e.state="READY",e.paused()||e.monitorBuffer_()}),void(this.state="WAITING_ON_TIMELINE");this.loadSegment_(t)}}},{key:"skipEmptySegments_",value:function(e){for(;e&&e.segment.empty;)e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest);return e}},{key:"handleSegment_",value:function(){var t=this;if(this.pendingSegment_&&this.subtitlesTrack_){this.state="APPENDING";var e=this.pendingSegment_,i=e.segment;if("function"!=typeof o.default.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var n=(t.state="WAITING_ON_VTTJS",t.subtitlesTrack_.tech_.one("vttjsloaded",a),t.subtitlesTrack_.tech_.one("vttjserror",function(){t.subtitlesTrack_.tech_.off("vttjsloaded",a),t.error({message:"Error loading vtt.js"}),t.state="READY",t.pause(),t.trigger("error")}),{v:void 0});if("object"==typeof n)return n.v}i.requested=!0;try{this.parseVTTCues_(e)}catch(e){return this.error({message:e.message}),this.state="READY",this.pause(),this.trigger("error")}if(this.updateTimeMapping_(e,this.syncController_.timelines[e.timeline],this.playlist_),e.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");e.byteLength=e.bytes.byteLength,this.mediaSecondsLoaded+=i.duration,e.cues.length&&this.remove(e.cues[0].endTime,e.cues[e.cues.length-1].endTime),e.cues.forEach(function(e){t.subtitlesTrack_.addCue(e)}),this.handleUpdateEnd_()}else this.state="READY";function a(){t.handleSegment_()}}},{key:"parseVTTCues_",value:function(t){var e=void 0,i=!1;"function"==typeof o.default.TextDecoder?e=new o.default.TextDecoder("utf8"):(e=o.default.WebVTT.StringDecoder(),i=!0);e=new o.default.WebVTT.Parser(o.default,o.default.vttjs,e);t.cues=[],t.timestampmap={MPEGTS:0,LOCAL:0},e.oncue=t.cues.push.bind(t.cues),e.ontimestampmap=function(e){return t.timestampmap=e},e.onparsingerror=function(e){s.default.log.warn("Error encountered when parsing cues: "+e.message)},t.segment.map&&(n=t.segment.map.bytes,i&&(n=a(n)),e.parse(n));var n=t.bytes;i&&(n=a(n)),e.parse(n),e.flush()}},{key:"updateTimeMapping_",value:function(e,t,i){var n,a,r=e.segment;t&&(e.cues.length?(a=e.timestampmap,n=a.MPEGTS/9e4-a.LOCAL+t.mapping,e.cues.forEach(function(e){e.startTime+=n,e.endTime+=n}),i.syncInfo||(a=e.cues[0].startTime,t=e.cues[e.cues.length-1].startTime,i.syncInfo={mediaSequence:i.mediaSequence+e.mediaIndex,time:Math.min(a,t-r.duration)})):r.empty=!0)}}]),c);function c(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),function(e,t,i){for(var n=!0;n;){var a=e,r=t,s=i,n=!1;null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,r);if(void 0!==o){if("value"in o)return o.value;var u=o.get;return void 0===u?void 0:u.call(s)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=r,i=s,n=!0,o=void 0}}(Object.getPrototypeOf(c.prototype),"constructor",this).call(this,e,t),this.mediaSource_=null,this.subtitlesTrack_=null}p.default=t,h.exports=p.default}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./bin-utils":2,"./segment-loader":16,"global/window":32,"videojs-contrib-media-sources/es5/remove-cues-from-track.js":72}],21:[function(e,i,n){!function(e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t,s="undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null,o=(t=s)&&t.__esModule?t:{default:t};n.default=function(){return function e(t,n){t=(0,s.mergeOptions)({timeout:45e3},t);var i=e.beforeRequest||o.default.Hls.xhr.beforeRequest;!i||"function"!=typeof i||(i=i(t))&&(t=i);var a=(0,s.xhr)(t,function(e,t){var i=a.response;!e&&i&&(a.responseTime=Date.now(),a.roundTripTime=a.responseTime-a.requestTime,a.bytesReceived=i.byteLength||i.length,a.bandwidth||(a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3))),e&&"ETIMEDOUT"===e.code&&(a.timedout=!0),e||a.aborted||200===t.statusCode||206===t.statusCode||0===t.statusCode||(e=new Error("XHR Failed with a response of: "+(a&&(i||a.responseText)))),n(e,a)}),r=a.abort;return a.abort=function(){return a.aborted=!0,r.apply(a,arguments)},a.uri=t.uri,a.requestTime=Date.now(),a}},i.exports=n.default}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],22:[function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(i,"__esModule",{value:!0});var l=null,a=(function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}(c,[{key:"decrypt",value:function(e,t,i,n,a,r){for(var s,o,u=this._key[1],d=e^u[0],l=n^u[1],c=i^u[2],f=t^u[3],h=void 0,p=u.length/4-2,m=void 0,g=4,t=this._tables[1],y=t[0],_=t[1],v=t[2],b=t[3],T=t[4],m=0;m<p;m++)h=y[d>>>24]^_[l>>16&255]^v[c>>8&255]^b[255&f]^u[g],s=y[l>>>24]^_[c>>16&255]^v[f>>8&255]^b[255&d]^u[g+1],o=y[c>>>24]^_[f>>16&255]^v[d>>8&255]^b[255&l]^u[g+2],f=y[f>>>24]^_[d>>16&255]^v[l>>8&255]^b[255&c]^u[g+3],g+=4,d=h,l=s,c=o;for(m=0;m<4;m++)a[(3&-m)+r]=T[d>>>24]<<24^T[l>>16&255]<<16^T[c>>8&255]<<8^T[255&f]^u[g++],h=d,d=l,l=c,c=f,f=h}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),l=l||function(){for(var e,t,i,n=[[[],[],[],[],[]],[[],[],[],[],[]]],a=n[0],r=n[1],s=a[4],o=r[4],u=void 0,d=void 0,l=void 0,c=[],f=[],h=void 0,p=void 0,u=0;u<256;u++)f[(c[u]=u<<1^283*(u>>7))^u]=u;for(d=l=0;!s[d];d^=e||1,l=f[l]||1)for(p=16843009*c[t=c[e=c[o[s[d]=i=(i=l^l<<1^l<<2^l<<3^l<<4)>>8^255&i^99]=d]]]^65537*t^257*e^16843008*d,h=257*c[i]^16843008*i,u=0;u<4;u++)a[u][d]=h=h<<24^h>>>8,r[u][i]=p=p<<24^p>>>8;for(u=0;u<5;u++)a[u]=a[u].slice(0),r[u]=r[u].slice(0);return n}(),this._tables=[[l[0][0].slice(),l[0][1].slice(),l[0][2].slice(),l[0][3].slice(),l[0][4].slice()],[l[1][0].slice(),l[1][1].slice(),l[1][2].slice(),l[1][3].slice(),l[1][4].slice()]];var t=void 0,i=void 0,n=void 0,a=void 0,r=void 0,s=this._tables[0][4],o=this._tables[1],u=e.length,d=1;if(4!==u&&6!==u&&8!==u)throw new Error("Invalid aes key size");for(a=e.slice(0),this._key=[a,r=[]],t=u;t<4*u+28;t++)n=a[t-1],(t%u==0||8===u&&t%u==4)&&(n=s[n>>>24]<<24^s[n>>16&255]<<16^s[n>>8&255]<<8^s[255&n],t%u==0&&(n=n<<8^n>>>24^d<<24,d=d<<1^283*(d>>7))),a[t]=a[t-u]^n;for(i=0;t;i++,t--)n=a[3&i?t:t-4],r[i]=t<=4||i<4?n:o[0][s[n>>>24]]^o[1][s[n>>16&255]]^o[2][s[n>>8&255]]^o[3][s[255&n]]}i.default=a,t.exports=i.default},{}],23:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e};function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r,s=e("./stream"),o=(r=s)&&r.__esModule?r:{default:r},n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,o.default),n(u,[{key:"processJob_",value:function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}},{key:"push",value:function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}]),u);function u(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),function(e,t,i){for(var n=!0;n;){var a=e,r=t,s=i,n=!1;null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,r);if(void 0!==o){if("value"in o)return o.value;var u=o.get;return void 0===u?void 0:u.call(s)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=r,i=s,n=!0,o=void 0}}(Object.getPrototypeOf(u.prototype),"constructor",this).call(this,o.default),this.jobs=[],this.delay=1,this.timeout_=null}i.default=n,t.exports=i.default},{"./stream":26}],24:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e};function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e){return e&&e.__esModule?e:{default:e}}function m(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}function s(e,t,i){for(var n,a,r,s,o=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),u=new g.default(Array.prototype.slice.call(t)),e=new Uint8Array(e.byteLength),d=new Int32Array(e.buffer),l=void 0,c=void 0,f=void 0,h=void 0,p=void 0,l=i[0],c=i[1],f=i[2],h=i[3],p=0;p<o.length;p+=4)n=m(o[p]),a=m(o[p+1]),r=m(o[p+2]),s=m(o[p+3]),u.decrypt(n,a,r,s,d,p),d[p]=m(d[p]^l),d[p+1]=m(d[p+1]^c),d[p+2]=m(d[p+2]^f),d[p+3]=m(d[p+3]^h),l=n,c=a,f=r,h=s;return e}var g=r(e("./aes")),u=r(e("./async-stream")),d=e("pkcs7");i.decrypt=s;n(l,[{key:"decryptChunk_",value:function(t,i,n,a){return function(){var e=s(t,i,n);a.set(e,t.byteOffset)}}}],[{key:"STEP",get:function(){return 32e3}}]),n=l;function l(e,t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);var a=l.STEP,r=new Int32Array(e.buffer),s=new Uint8Array(e.byteLength),o=0;for(this.asyncStream_=new u.default,this.asyncStream_.push(this.decryptChunk_(r.subarray(o,o+a),t,i,s)),o=a;o<r.length;o+=a)i=new Uint32Array([m(r[o-4]),m(r[o-3]),m(r[o-2]),m(r[o-1])]),this.asyncStream_.push(this.decryptChunk_(r.subarray(o,o+a),t,i,s));this.asyncStream_.push(function(){n(null,(0,d.unpad)(s))})}i.Decrypter=n,i.default={Decrypter:n,decrypt:s}},{"./aes":22,"./async-stream":23,pkcs7:28}],25:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n,a=e("./decrypter"),r=e("./async-stream"),e=(n=r)&&n.__esModule?n:{default:n};i.default={decrypt:a.decrypt,Decrypter:a.Decrypter,AsyncStream:e.default},t.exports=i.default},{"./async-stream":23,"./decrypter":24}],26:[function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(i,"__esModule",{value:!0});var a=(function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}(r,[{key:"on",value:function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"off",value:function(e,t){var i;return!!this.listeners[e]&&(i=this.listeners[e].indexOf(t),this.listeners[e].splice(i,1),-1<i)}},{key:"trigger",value:function(e){var t,i=void 0,n=void 0,a=void 0;if(i=this.listeners[e])if(2===arguments.length)for(a=i.length,n=0;n<a;++n)i[n].call(this,arguments[1]);else for(t=Array.prototype.slice.call(arguments,1),a=i.length,n=0;n<a;++n)i[n].apply(this,t)}},{key:"dispose",value:function(){this.listeners={}}},{key:"pipe",value:function(t){this.on("data",function(e){t.push(e)})}}]),r);function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.listeners={}}i.default=a,t.exports=i.default},{}],27:[function(e,t,i){"use strict";var n;t.exports=function(e){var t=n[e.byteLength%16||0],i=new Uint8Array(e.byteLength+t.length);return i.set(e),i.set(t,e.byteLength),i},n=[[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[14,14,14,14,14,14,14,14,14,14,14,14,14,14],[13,13,13,13,13,13,13,13,13,13,13,13,13],[12,12,12,12,12,12,12,12,12,12,12,12],[11,11,11,11,11,11,11,11,11,11,11],[10,10,10,10,10,10,10,10,10,10],[9,9,9,9,9,9,9,9,9],[8,8,8,8,8,8,8,8],[7,7,7,7,7,7,7],[6,6,6,6,6,6],[5,5,5,5,5],[4,4,4,4],[3,3,3],[2,2],[1]]},{}],28:[function(e,t,i){"use strict";i.pad=e("./pad.js"),i.unpad=e("./unpad.js")},{"./pad.js":27,"./unpad.js":29}],29:[function(e,t,i){"use strict";t.exports=function(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}},{}],30:[function(e,t,i){},{}],31:[function(n,a,e){!function(e){var t=void 0!==e?e:"undefined"!=typeof window?window:{},e=n("min-document"),i="undefined"!=typeof document?document:(i=t["__GLOBAL_DOCUMENT_CACHE@4"])||(t["__GLOBAL_DOCUMENT_CACHE@4"]=e);a.exports=i}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"min-document":30}],32:[function(e,t,i){!function(e){e="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};t.exports=e}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],33:[function(e,t,i){"use strict";var n=r(e("./line-stream")),a=r(e("./parse-stream")),e=r(e("./parser"));function r(e){return e&&e.__esModule?e:{default:e}}t.exports={LineStream:n.default,ParseStream:a.default,Parser:e.default}},{"./line-stream":34,"./parse-stream":35,"./parser":36}],34:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e};function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r,s=e("./stream");(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(o,((r=s)&&r.__esModule?r:{default:r}).default),n(o,[{key:"push",value:function(e){var t=void 0;for(this.buffer+=e,t=this.buffer.indexOf("\n");-1<t;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}}]),n=o;function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.buffer="",e}i.default=n},{"./stream":37}],35:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,a=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(i.push(s.value),!t||i.length!==t);n=!0);}catch(e){a=!0,r=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw r}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e};function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r,o=e("./stream"),e=(r=o)&&r.__esModule?r:{default:r};function u(e){for(var t=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),i={},n=t.length,a=void 0;n--;)""!==t[n]&&((a=/([^=]*)=(.*)/.exec(t[n]).slice(1))[0]=a[0].replace(/^\s+|\s+$/g,""),a[1]=a[1].replace(/^\s+|\s+$/g,""),a[1]=a[1].replace(/^['"](.*)['"]$/g,"$1"),i[a[0]]=a[1]);return i}(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(d,e.default),n(d,[{key:"push",value:function(e){var t=void 0,i=void 0;if(0!==(e=e.replace(/^[\u0000\s]+|[\u0000\s]+$/g,"")).length)if("#"===e[0])if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e))this.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return i={type:"tag",tagType:"inf"},t[1]&&(i.duration=parseFloat(t[1])),t[2]&&(i.title=t[2]),void this.trigger("data",i);if(t=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"targetduration"},t[1]&&(i.duration=parseInt(t[1],10)),void this.trigger("data",i);if(t=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"totalduration"},t[1]&&(i.duration=parseInt(t[1],10)),void this.trigger("data",i);if(t=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"version"},t[1]&&(i.version=parseInt(t[1],10)),void this.trigger("data",i);if(t=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return i={type:"tag",tagType:"media-sequence"},t[1]&&(i.number=parseInt(t[1],10)),void this.trigger("data",i);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return i={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(i.number=parseInt(t[1],10)),void this.trigger("data",i);if(t=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return i={type:"tag",tagType:"playlist-type"},t[1]&&(i.playlistType=t[1]),void this.trigger("data",i);if(t=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"byterange"},t[1]&&(i.length=parseInt(t[1],10)),t[2]&&(i.offset=parseInt(t[2],10)),void this.trigger("data",i);if(t=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return i={type:"tag",tagType:"allow-cache"},t[1]&&(i.allowed=!/NO/.test(t[1])),void this.trigger("data",i);if(t=/^#EXT-X-MAP:?(.*)$/.exec(e)){var n,i={type:"tag",tagType:"map"};return t[1]&&((n=u(t[1])).URI&&(i.uri=n.URI),n.BYTERANGE&&(r=n.BYTERANGE.split("@"),r=(a=s(r,2))[0],a=a[1],i.byterange={},r&&(i.byterange.length=parseInt(r,10)),a&&(i.byterange.offset=parseInt(a,10)))),void this.trigger("data",i)}var a,r,t=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e);if(t)return i={type:"tag",tagType:"stream-inf"},t[1]&&(i.attributes=u(t[1]),i.attributes.RESOLUTION&&(r={},(a=i.attributes.RESOLUTION.split("x"))[0]&&(r.width=parseInt(a[0],10)),a[1]&&(r.height=parseInt(a[1],10)),i.attributes.RESOLUTION=r),i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))),void this.trigger("data",i);if(t=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return i={type:"tag",tagType:"media"},t[1]&&(i.attributes=u(t[1])),void this.trigger("data",i);if(t=/^#EXT-X-ENDLIST/.exec(e))this.trigger("data",{type:"tag",tagType:"endlist"});else{if(!(t=/^#EXT-X-DISCONTINUITY/.exec(e)))return(t=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))?(i={type:"tag",tagType:"program-date-time"},t[1]&&(i.dateTimeString=t[1],i.dateTimeObject=new Date(t[1])),void this.trigger("data",i)):(t=/^#EXT-X-KEY:?(.*)$/.exec(e))?(i={type:"tag",tagType:"key"},t[1]&&(i.attributes=u(t[1]),i.attributes.IV&&("0x"===i.attributes.IV.substring(0,2).toLowerCase()&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),void this.trigger("data",i)):(t=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))?(i={type:"tag",tagType:"cue-out-cont"},t[1]?i.data=t[1]:i.data="",void this.trigger("data",i)):(t=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))?(i={type:"tag",tagType:"cue-out"},t[1]?i.data=t[1]:i.data="",void this.trigger("data",i)):(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))?(i={type:"tag",tagType:"cue-in"},t[1]?i.data=t[1]:i.data="",void this.trigger("data",i)):void this.trigger("data",{type:"tag",data:e.slice(4)});this.trigger("data",{type:"tag",tagType:"discontinuity"})}}else this.trigger("data",{type:"comment",text:e.slice(1)});else this.trigger("data",{type:"uri",uri:e})}}]),n=d;function d(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this))}i.default=n},{"./stream":37}],36:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i,n=arguments[t];for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},n=function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e};function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=s(e("./stream")),f=s(e("./line-stream")),h=s(e("./parse-stream"));function s(e){return e&&e.__esModule?e:{default:e}}(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(p,r.default),n(p,[{key:"push",value:function(e){this.lineStream.push(e)}},{key:"end",value:function(){this.lineStream.push("\n")}}]),n=p;function p(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(p.__proto__||Object.getPrototypeOf(p)).call(this));e.lineStream=new f.default,e.parseStream=new h.default,e.lineStream.pipe(e.parseStream);var a=e,r=[],s={},o=void 0,u=void 0,d={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},l=0;return e.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},e.parseStream.on("data",function(t){var i=void 0,n=void 0;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=t.allowed,"allowed"in t||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var e={};"length"in t&&((s.byterange=e).length=t.length,"offset"in t||(this.trigger("info",{message:"defaulting offset to zero"}),t.offset=0)),"offset"in t&&((s.byterange=e).offset=t.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),0<t.duration&&(s.duration=t.duration),0===t.duration&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=r},key:function(){t.attributes?"NONE"!==t.attributes.METHOD?t.attributes.URI?(t.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),u={method:t.attributes.METHOD||"AES-128",uri:t.attributes.URI},void 0!==t.attributes.IV&&(u.iv=t.attributes.IV)):this.trigger("warn",{message:"ignoring key declaration without URI"}):u=null:this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(t.number)?this.manifest.mediaSequence=t.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+t.number})},"discontinuity-sequence":function(){isFinite(t.number)?(this.manifest.discontinuitySequence=t.number,l=t.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+t.number})},"playlist-type":function(){/VOD|EVENT/.test(t.playlistType)?this.manifest.playlistType=t.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+t.playlist})},map:function(){o={},t.uri&&(o.uri=t.uri),t.byterange&&(o.byterange=t.byterange)},"stream-inf":function(){this.manifest.playlists=r,this.manifest.mediaGroups=this.manifest.mediaGroups||d,t.attributes?(s.attributes||(s.attributes={}),c(s.attributes,t.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){var e;this.manifest.mediaGroups=this.manifest.mediaGroups||d,t.attributes&&t.attributes.TYPE&&t.attributes["GROUP-ID"]&&t.attributes.NAME?((e=this.manifest.mediaGroups[t.attributes.TYPE])[t.attributes["GROUP-ID"]]=e[t.attributes["GROUP-ID"]]||{},i=e[t.attributes["GROUP-ID"]],(n={default:/yes/i.test(t.attributes.DEFAULT)}).default?n.autoselect=!0:n.autoselect=/yes/i.test(t.attributes.AUTOSELECT),t.attributes.LANGUAGE&&(n.language=t.attributes.LANGUAGE),t.attributes.URI&&(n.uri=t.attributes.URI),t.attributes["INSTREAM-ID"]&&(n.instreamId=t.attributes["INSTREAM-ID"]),t.attributes.CHARACTERISTICS&&(n.characteristics=t.attributes.CHARACTERISTICS),t.attributes.FORCED&&(n.forced=/yes/i.test(t.attributes.FORCED)),i[t.attributes.NAME]=n):this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){l+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(r.length)},"program-date-time":function(){this.manifest.dateTimeString=t.dateTimeString,this.manifest.dateTimeObject=t.dateTimeObject},targetduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+t.duration}):this.manifest.targetDuration=t.duration},totalduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+t.duration}):this.manifest.totalDuration=t.duration},"cue-out":function(){s.cueOut=t.data},"cue-out-cont":function(){s.cueOutCont=t.data},"cue-in":function(){s.cueIn=t.data}}[t.tagType]||function(){}).call(a)},uri:function(){s.uri=t.uri,r.push(s),!this.manifest.targetDuration||"duration"in s||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),u&&(s.key=u),s.timeline=l,o&&(s.map=o),s={}},comment:function(){}})[t.type].call(a)}),e}i.default=n},{"./line-stream":34,"./parse-stream":35,"./stream":37}],37:[function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(i,"__esModule",{value:!0});var a=(function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}(r,[{key:"on",value:function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"off",value:function(e,t){if(!this.listeners[e])return!1;t=this.listeners[e].indexOf(t);return this.listeners[e].splice(t,1),-1<t}},{key:"trigger",value:function(e){var t,i=this.listeners[e],n=void 0,a=void 0;if(i)if(2===arguments.length)for(a=i.length,n=0;n<a;++n)i[n].call(this,arguments[1]);else for(t=Array.prototype.slice.call(arguments,1),a=i.length,n=0;n<a;++n)i[n].apply(this,t)}},{key:"dispose",value:function(){this.listeners={}}},{key:"pipe",value:function(t){this.on("data",function(e){t.push(e)})}}]),r);function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.listeners={}}i.default=a},{}],38:[function(e,t,i){"use strict";var e=e("../utils/stream.js"),n=function(){var r=new Uint8Array,s=0;n.prototype.init.call(this),this.setTimestamp=function(e){s=e},this.parseId3TagSize=function(e,t){var i=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?20+i:10+i},this.parseAdtsSize=function(e,t){var i=(224&e[t+5])>>5,n=e[t+4]<<3;return 6144&e[t+3]|n|i},this.push=function(e){var t,i,n=0,a=0;for(r.length?(i=r.length,(r=new Uint8Array(e.byteLength+i)).set(r.subarray(0,i)),r.set(e,i)):r=e;3<=r.length-a;)if(r[a]!=="I".charCodeAt(0)||r[a+1]!=="D".charCodeAt(0)||r[a+2]!=="3".charCodeAt(0))if(!0&r[a]&&240==(240&r[a+1])){if(r.length-a<7)break;if((n=this.parseAdtsSize(r,a))>r.length)break;t={type:"audio",data:r.subarray(a,a+n),pts:s,dts:s},this.trigger("data",t),a+=n}else a++;else{if(r.length-a<10)break;if((n=this.parseId3TagSize(r,a))>r.length)break;t={type:"timed-metadata",data:r.subarray(a,a+n)},this.trigger("data",t),a+=n}e=r.length-a,r=0<e?r.subarray(a):new Uint8Array}};n.prototype=new e,t.exports=n},{"../utils/stream.js":62}],39:[function(e,t,i){"use strict";function o(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]}var n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],u=function(e,t,i){for(var n="",a=t;a<i;a++)n+="%"+("00"+e[a].toString(16)).slice(-2);return n};t.exports={parseId3TagSize:function(e,t){var i=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?20+i:10+i},parseAdtsSize:function(e,t){var i=(224&e[t+5])>>5,n=e[t+4]<<3;return 6144&e[t+3]|n|i},parseType:function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240==(240&e[t+1])?"audio":null},parseSampleRate:function(e){for(var t=0;t+5<e.length;){if(255===e[t]&&240==(246&e[t+1]))return n[(60&e[t+2])>>>2];t++}return null},parseAacTimestamp:function(e){var t,i=10;64&e[5]&&(i+=4,i+=o(e.subarray(10,14)));do{if((t=o(e.subarray(i+4,i+8)))<1)return null;if("PRIV"===String.fromCharCode(e[i],e[i+1],e[i+2],e[i+3]))for(var n=e.subarray(i+10,i+t+10),a=0;a<n.byteLength;a++)if(0===n[a]){if("com.apple.streaming.transportStreamTimestamp"!==unescape(u(n,0,a)))break;var r=n.subarray(a+1),s=(1&r[3])<<30|r[4]<<22|r[5]<<14|r[6]<<6|r[7]>>>2;return s*=4,s+=3&r[7]}}while(i+=10,(i+=t)<e.byteLength);return null}}},{}],40:[function(e,t,i){"use strict";var e=e("../utils/stream.js"),d=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],n=function(){var u;n.prototype.init.call(this),this.push=function(e){var t,i,n,a,r,s=0,o=0;if("audio"===e.type)for(u?(n=u,(u=new Uint8Array(n.byteLength+e.data.byteLength)).set(n),u.set(e.data,n.byteLength)):u=e.data;s+5<u.length;)if(255===u[s]&&240==(246&u[s+1])){if(t=2*(1&~u[s+1]),i=(3&u[s+3])<<11|u[s+4]<<3|(224&u[s+5])>>5,r=9e4*(a=1024*(1+(3&u[s+6])))/d[(60&u[s+2])>>>2],u.byteLength<(i=s+i))return;if(this.trigger("data",{pts:e.pts+o*r,dts:e.dts+o*r,sampleCount:a,audioobjecttype:1+(u[s+2]>>>6&3),channelcount:(1&u[s+2])<<2|(192&u[s+3])>>>6,samplerate:d[(60&u[s+2])>>>2],samplingfrequencyindex:(60&u[s+2])>>>2,samplesize:16,data:u.subarray(s+7+t,i)}),u.byteLength===i)return void(u=void 0);o++,u=u.subarray(i)}else s++},this.flush=function(){this.trigger("done")}};n.prototype=new e,t.exports=n},{"../utils/stream.js":62}],41:[function(e,t,i){"use strict";var u,y,n=e("../utils/stream.js"),_=e("../utils/exp-golomb.js"),d=function(){var i,n,a=0;d.prototype.init.call(this),this.push=function(e){var t;for(n=n?((t=new Uint8Array(n.byteLength+e.data.byteLength)).set(n),t.set(e.data,n.byteLength),t):e.data;a<n.byteLength-3;a++)if(1===n[a+2]){i=a+5;break}for(;i<n.byteLength;)switch(n[i]){case 0:if(0!==n[i-1]){i+=2;break}if(0!==n[i-2]){i++;break}for(a+3!==i-2&&this.trigger("data",n.subarray(a+3,i-2));1!==n[++i]&&i<n.length;);a=i-2,i+=3;break;case 1:if(0!==n[i-1]||0!==n[i-2]){i+=3;break}this.trigger("data",n.subarray(a+3,i-2)),a=i-2,i+=3;break;default:i+=3}n=n.subarray(a),i-=a,a=0},this.flush=function(){n&&3<n.byteLength&&this.trigger("data",n.subarray(a+3)),n=null,a=0,this.trigger("done")}};d.prototype=new n,y={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(u=function(){var i,n,a,r,s,o,g,t=new d;u.prototype.init.call(this),(i=this).push=function(e){"video"===e.type&&(n=e.trackId,a=e.pts,r=e.dts,t.push(e))},t.on("data",function(e){var t={trackId:n,pts:a,dts:r,data:e};switch(31&e[0]){case 5:t.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:t.nalUnitType="sei_rbsp",t.escapedRBSP=s(e.subarray(1));break;case 7:t.nalUnitType="seq_parameter_set_rbsp",t.escapedRBSP=s(e.subarray(1)),t.config=o(t.escapedRBSP);break;case 8:t.nalUnitType="pic_parameter_set_rbsp";break;case 9:t.nalUnitType="access_unit_delimiter_rbsp"}i.trigger("data",t)}),t.on("done",function(){i.trigger("done")}),this.flush=function(){t.flush()},g=function(e,t){for(var i=8,n=8,a=0;a<e;a++)i=0===(n=0!==n?(i+t.readExpGolomb()+256)%256:n)?i:n},s=function(e){for(var t=e.byteLength,i=[],n=1;n<t-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(i.push(n+2),n+=2):n++;if(0===i.length)return e;for(var a=t-i.length,r=new Uint8Array(a),s=0,n=0;n<a;s++,n++)s===i[0]&&(s++,i.shift()),r[n]=e[s];return r},o=function(e){var t,i,n,a,r,s,o=0,u=0,d=0,l=0,c=1,f=new _(e),h=f.readUnsignedByte(),p=f.readUnsignedByte(),m=f.readUnsignedByte();if(f.skipUnsignedExpGolomb(),y[h]&&(3===(i=f.readUnsignedExpGolomb())&&f.skipBits(1),f.skipUnsignedExpGolomb(),f.skipUnsignedExpGolomb(),f.skipBits(1),f.readBoolean()))for(a=3!==i?8:12,s=0;s<a;s++)f.readBoolean()&&g(s<6?16:64,f);if(f.skipUnsignedExpGolomb(),0===(n=f.readUnsignedExpGolomb()))f.readUnsignedExpGolomb();else if(1===n)for(f.skipBits(1),f.skipExpGolomb(),f.skipExpGolomb(),t=f.readUnsignedExpGolomb(),s=0;s<t;s++)f.skipExpGolomb();if(f.skipUnsignedExpGolomb(),f.skipBits(1),e=f.readUnsignedExpGolomb(),i=f.readUnsignedExpGolomb(),0===(n=f.readBits(1))&&f.skipBits(1),f.skipBits(1),f.readBoolean()&&(o=f.readUnsignedExpGolomb(),u=f.readUnsignedExpGolomb(),d=f.readUnsignedExpGolomb(),l=f.readUnsignedExpGolomb()),f.readBoolean()&&f.readBoolean()){switch(f.readUnsignedByte()){case 1:r=[1,1];break;case 2:r=[12,11];break;case 3:r=[10,11];break;case 4:r=[16,11];break;case 5:r=[40,33];break;case 6:r=[24,11];break;case 7:r=[20,11];break;case 8:r=[32,11];break;case 9:r=[80,33];break;case 10:r=[18,11];break;case 11:r=[15,11];break;case 12:r=[64,33];break;case 13:r=[160,99];break;case 14:r=[4,3];break;case 15:r=[3,2];break;case 16:r=[2,1];break;case 255:r=[f.readUnsignedByte()<<8|f.readUnsignedByte(),f.readUnsignedByte()<<8|f.readUnsignedByte()]}r&&(c=r[0]/r[1])}return{profileIdc:h,levelIdc:m,profileCompatibility:p,width:Math.ceil((16*(e+1)-2*o-2*u)*c),height:(2-n)*(i+1)*16-2*d-2*l}}}).prototype=new n,t.exports={H264Stream:u,NalByteStream:d}},{"../utils/exp-golomb.js":61,"../utils/stream.js":62}],42:[function(e,t,i){var n,a=[33,16,5,32,164,27],r=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],s=function(e){for(var t=[];e--;)t.push(0);return t},s={96e3:[a,[227,64],s(154),[56]],88200:[a,[231],s(170),[56]],64e3:[a,[248,192],s(240),[56]],48e3:[a,[255,192],s(268),[55,148,128],s(54),[112]],44100:[a,[255,192],s(268),[55,163,128],s(84),[112]],32e3:[a,[255,192],s(268),[55,234],s(226),[112]],24e3:[a,[255,192],s(268),[55,255,128],s(268),[111,112],s(126),[224]],16e3:[a,[255,192],s(268),[55,255,128],s(268),[111,255],s(269),[223,108],s(195),[1,192]],12e3:[r,s(268),[3,127,248],s(268),[6,255,240],s(268),[13,255,224],s(268),[27,253,128],s(259),[56]],11025:[r,s(268),[3,127,248],s(268),[6,255,240],s(268),[13,255,224],s(268),[27,255,192],s(268),[55,175,128],s(108),[112]],8e3:[r,s(268),[3,121,16],s(47),[7]]};t.exports=(n=s,Object.keys(n).reduce(function(e,t){return e[t]=new Uint8Array(n[t].reduce(function(e,t){return e.concat(t)},[])),e},{}))},{}],43:[function(e,t,i){"use strict";function n(e){this.numberOfTracks=0,this.metadataStream=e.metadataStream,this.videoTags=[],this.audioTags=[],this.videoTrack=null,this.audioTrack=null,this.pendingCaptions=[],this.pendingMetadata=[],this.pendingTracks=0,this.processedTracks=0,n.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):("video"===e.track.type&&(this.videoTrack=e.track,this.videoTags=e.tags,this.pendingTracks++),void("audio"===e.track.type&&(this.audioTrack=e.track,this.audioTags=e.tags,this.pendingTracks++)))}}e=e("../utils/stream.js");(n.prototype=new e).flush=function(e){var t,i,n,a,r={tags:{},captions:[],captionStreams:{},metadata:[]};if(this.pendingTracks<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(0===this.pendingTracks&&(this.processedTracks++,this.processedTracks<this.numberOfTracks))return}if(this.processedTracks+=this.pendingTracks,this.pendingTracks=0,!(this.processedTracks<this.numberOfTracks)){for(this.videoTrack?a=this.videoTrack.timelineStartInfo.pts:this.audioTrack&&(a=this.audioTrack.timelineStartInfo.pts),r.tags.videoTags=this.videoTags,r.tags.audioTags=this.audioTags,n=0;n<this.pendingCaptions.length;n++)(i=this.pendingCaptions[n]).startTime=i.startPts-a,i.startTime/=9e4,i.endTime=i.endPts-a,i.endTime/=9e4,r.captionStreams[i.stream]=!0,r.captions.push(i);for(n=0;n<this.pendingMetadata.length;n++)(t=this.pendingMetadata[n]).cueTime=t.pts-a,t.cueTime/=9e4,r.metadata.push(t);r.metadata.dispatchType=this.metadataStream.dispatchType,this.videoTrack=null,this.audioTrack=null,this.videoTags=[],this.audioTags=[],this.pendingCaptions.length=0,this.pendingMetadata.length=0,this.pendingTracks=0,this.processedTracks=0,this.trigger("data",r),this.trigger("done")}},t.exports=n},{"../utils/stream.js":62}],44:[function(e,t,i){"use strict";var s=e("./flv-tag.js");t.exports=function(e,t,i){var n,a=new Uint8Array(9),r=new DataView(a.buffer);return e=e||0,t=void 0===t||t,i=void 0===i||i,r.setUint8(0,70),r.setUint8(1,76),r.setUint8(2,86),r.setUint8(3,1),r.setUint8(4,(t?4:0)|(i?1:0)),r.setUint32(5,a.byteLength),e<=0?((n=new Uint8Array(a.byteLength+4)).set(a),n.set([0,0,0,0],a.byteLength)):((i=new s(s.METADATA_TAG)).pts=i.dts=0,i.writeMetaDataDouble("duration",e),i=i.finalize().length,(n=new Uint8Array(a.byteLength+i)).set(a),n.set(r.byteLength,i)),n}},{"./flv-tag.js":45}],45:[function(e,t,i){"use strict";var d=function(e,i){function a(e,t){(t=e.position+t)<e.bytes.byteLength||((t=new Uint8Array(2*t)).set(e.bytes.subarray(0,e.position),0),e.bytes=t,e.view=new DataView(e.bytes.buffer))}var t,n=0,r=16384,s=d.widthBytes||new Uint8Array("width".length),o=d.heightBytes||new Uint8Array("height".length),u=d.videocodecidBytes||new Uint8Array("videocodecid".length);if(!d.widthBytes){for(t=0;t<"width".length;t++)s[t]="width".charCodeAt(t);for(t=0;t<"height".length;t++)o[t]="height".charCodeAt(t);for(t=0;t<"videocodecid".length;t++)u[t]="videocodecid".charCodeAt(t);d.widthBytes=s,d.heightBytes=o,d.videocodecidBytes=u}switch(this.keyFrame=!1,e){case d.VIDEO_TAG:this.length=16,r*=6;break;case d.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case d.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw new Error("Unknown FLV tag type")}this.bytes=new Uint8Array(r),this.view=new DataView(this.bytes.buffer),this.bytes[0]=e,this.position=this.length,this.keyFrame=i,this.pts=0,this.dts=0,this.writeBytes=function(e,t,i){var n=t||0,t=n+(i=i||e.byteLength);a(this,i),this.bytes.set(e.subarray(n,t),this.position),this.position+=i,this.length=Math.max(this.length,this.position)},this.writeByte=function(e){a(this,1),this.bytes[this.position]=e,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(e){a(this,2),this.view.setUint16(this.position,e),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(e){return this.bytes[this.length-e]},this.nalUnitSize=function(){return 0===n?0:this.length-(n+4)},this.startNalUnit=function(){if(0<n)throw new Error("Attempted to create new NAL wihout closing the old one");n=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(e){var t,i;this.length===n+4?this.length-=4:0<n&&(t=n+4,i=this.length-t,this.position=n,this.view.setUint32(this.position,i),this.position=this.length,e&&e.push(this.bytes.subarray(t,t+i))),n=0},this.writeMetaDataDouble=function(e,t){var i;if(a(this,2+e.length+9),this.view.setUint16(this.position,e.length),this.position+=2,"width"===e)this.bytes.set(s,this.position),this.position+=5;else if("height"===e)this.bytes.set(o,this.position),this.position+=6;else if("videocodecid"===e)this.bytes.set(u,this.position),this.position+=12;else for(i=0;i<e.length;i++)this.bytes[this.position]=e.charCodeAt(i),this.position++;this.position++,this.view.setFloat64(this.position,t),this.position+=8,this.length=Math.max(this.length,this.position),++n},this.writeMetaDataBoolean=function(e,t){var i;for(a(this,2),this.view.setUint16(this.position,e.length),this.position+=2,i=0;i<e.length;i++)a(this,1),this.bytes[this.position]=e.charCodeAt(i),this.position++;a(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,t?1:0),this.position++,this.length=Math.max(this.length,this.position),++n},this.finalize=function(){var e,t;switch(this.bytes[0]){case d.VIDEO_TAG:this.bytes[11]=7|(this.keyFrame||i?16:32),this.bytes[12]=i?0:1,e=this.pts-this.dts,this.bytes[13]=(16711680&e)>>>16,this.bytes[14]=(65280&e)>>>8,this.bytes[15]=(255&e)>>>0;break;case d.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=i?0:1;break;case d.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,n),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position}return t=this.length-11,this.bytes[1]=(16711680&t)>>>16,this.bytes[2]=(65280&t)>>>8,this.bytes[3]=(255&t)>>>0,this.bytes[4]=(16711680&this.dts)>>>16,this.bytes[5]=(65280&this.dts)>>>8,this.bytes[6]=(255&this.dts)>>>0,this.bytes[7]=(4278190080&this.dts)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,a(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=d.frameTime(this.bytes),this}};d.AUDIO_TAG=8,d.VIDEO_TAG=9,d.METADATA_TAG=18,d.isAudioFrame=function(e){return d.AUDIO_TAG===e[0]},d.isVideoFrame=function(e){return d.VIDEO_TAG===e[0]},d.isMetaData=function(e){return d.METADATA_TAG===e[0]},d.isKeyFrame=function(e){return d.isVideoFrame(e)?23===e[11]:!!d.isAudioFrame(e)||!!d.isMetaData(e)},d.frameTime=function(e){var t=e[4]<<16;return t|=e[5]<<8,t|=e[6]<<0,t|=e[7]<<24},t.exports=d},{}],46:[function(e,t,i){t.exports={tag:e("./flv-tag"),Transmuxer:e("./transmuxer"),getFlvHeader:e("./flv-header")}},{"./flv-header":44,"./flv-tag":45,"./transmuxer":48}],47:[function(e,t,i){"use strict";t.exports=function(){var e=this;this.list=[],this.push=function(e){this.list.push({bytes:e.bytes,dts:e.dts,pts:e.pts,keyFrame:e.keyFrame,metaDataTag:e.metaDataTag})},Object.defineProperty(this,"length",{get:function(){return e.list.length}})}},{}],48:[function(e,t,i){"use strict";var p,m,n=e("../utils/stream.js"),u=e("./flv-tag.js"),g=e("../m2ts/m2ts.js"),y=e("../codecs/adts.js"),_=e("../codecs/h264").H264Stream,v=e("./coalesce-stream.js"),d=e("./tag-list.js"),l=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts?e.timelineStartInfo.pts=t.pts:e.timelineStartInfo.pts=Math.min(e.timelineStartInfo.pts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts?e.timelineStartInfo.dts=t.dts:e.timelineStartInfo.dts=Math.min(e.timelineStartInfo.dts,t.dts))},o=function(e,t){var i=new u(u.METADATA_TAG);return i.dts=t,i.pts=t,i.writeMetaDataDouble("videocodecid",7),i.writeMetaDataDouble("width",e.width),i.writeMetaDataDouble("height",e.height),i},c=function(e,t){var i,n=new u(u.VIDEO_TAG,!0);for(n.dts=t,n.pts=t,n.writeByte(1),n.writeByte(e.profileIdc),n.writeByte(e.profileCompatibility),n.writeByte(e.levelIdc),n.writeByte(255),n.writeByte(225),n.writeShort(e.sps[0].length),n.writeBytes(e.sps[0]),n.writeByte(e.pps.length),i=0;i<e.pps.length;++i)n.writeShort(e.pps[i].length),n.writeBytes(e.pps[i]);return n},b=function(a){var r,s=[],o=[];b.prototype.init.call(this),this.push=function(e){l(a,e),a&&(a.audioobjecttype=e.audioobjecttype,a.channelcount=e.channelcount,a.samplerate=e.samplerate,a.samplingfrequencyindex=e.samplingfrequencyindex,a.samplesize=e.samplesize,a.extraData=a.audioobjecttype<<11|a.samplingfrequencyindex<<7|a.channelcount<<3),e.pts=Math.round(e.pts/90),e.dts=Math.round(e.dts/90),s.push(e)},this.flush=function(){var e,t,i,n=new d;if(0!==s.length){for(i=-1/0;s.length;)e=s.shift(),o.length&&e.pts>=o[0]&&(i=o.shift(),this.writeMetaDataTags(n,i)),(a.extraData!==r||1e3<=e.pts-i)&&(this.writeMetaDataTags(n,e.pts),r=a.extraData,i=e.pts),(t=new u(u.AUDIO_TAG)).pts=e.pts,t.dts=e.dts,t.writeBytes(e.data),n.push(t.finalize());o.length=0,r=null,this.trigger("data",{track:a,tags:n.list}),this.trigger("done","AudioSegmentStream")}else this.trigger("done","AudioSegmentStream")},this.writeMetaDataTags=function(e,t){var i=new u(u.METADATA_TAG);i.pts=t,i.dts=t,i.writeMetaDataDouble("audiocodecid",10),i.writeMetaDataBoolean("stereo",2===a.channelcount),i.writeMetaDataDouble("audiosamplerate",a.samplerate),i.writeMetaDataDouble("audiosamplesize",16),e.push(i.finalize()),(i=new u(u.AUDIO_TAG,!0)).pts=t,i.dts=t,i.view.setUint16(i.position,a.extraData),i.position+=2,i.length=Math.max(i.length,i.position),e.push(i.finalize())},this.onVideoKeyFrame=function(e){o.push(e)}};b.prototype=new n,(m=function(a){var r,s,i=[];m.prototype.init.call(this),this.finishFrame=function(e,t){var i,n;t&&(r&&a&&a.newMetadata&&(t.keyFrame||0===e.length)&&(i=o(r,t.dts).finalize(),n=c(a,t.dts).finalize(),i.metaDataTag=n.metaDataTag=!0,e.push(i),e.push(n),a.newMetadata=!1,this.trigger("keyframe",t.dts)),t.endNalUnit(),e.push(t.finalize()),s=null)},this.push=function(e){l(a,e),e.pts=Math.round(e.pts/90),e.dts=Math.round(e.dts/90),i.push(e)},this.flush=function(){for(var e,t=new d;i.length&&"access_unit_delimiter_rbsp"!==i[0].nalUnitType;)i.shift();if(0!==i.length){for(;i.length;)"seq_parameter_set_rbsp"===(e=i.shift()).nalUnitType?(a.newMetadata=!0,r=e.config,a.width=r.width,a.height=r.height,a.sps=[e.data],a.profileIdc=r.profileIdc,a.levelIdc=r.levelIdc,a.profileCompatibility=r.profileCompatibility,s.endNalUnit()):"pic_parameter_set_rbsp"===e.nalUnitType?(a.newMetadata=!0,a.pps=[e.data],s.endNalUnit()):"access_unit_delimiter_rbsp"===e.nalUnitType?(s&&this.finishFrame(t,s),(s=new u(u.VIDEO_TAG)).pts=e.pts,s.dts=e.dts):("slice_layer_without_partitioning_rbsp_idr"===e.nalUnitType&&(s.keyFrame=!0),s.endNalUnit()),s.startNalUnit(),s.writeBytes(e.data);s&&this.finishFrame(t,s),this.trigger("data",{track:a,tags:t.list}),this.trigger("done","VideoSegmentStream")}else this.trigger("done","VideoSegmentStream")}}).prototype=new n,(p=function(e){var t,i,n,a,r,s,o,u,d,l,c,f,h=this;p.prototype.init.call(this),e=e||{},this.metadataStream=new g.MetadataStream,e.metadataStream=this.metadataStream,t=new g.TransportPacketStream,i=new g.TransportParseStream,n=new g.ElementaryStream,a=new g.TimestampRolloverStream("video"),r=new g.TimestampRolloverStream("audio"),s=new g.TimestampRolloverStream("timed-metadata"),o=new y,u=new _,f=new v(e),t.pipe(i).pipe(n),n.pipe(a).pipe(u),n.pipe(r).pipe(o),n.pipe(s).pipe(this.metadataStream).pipe(f),c=new g.CaptionStream,u.pipe(c).pipe(f),n.on("data",function(e){var t,i,n;if("metadata"===e.type){for(t=e.tracks.length;t--;)"video"===e.tracks[t].type?i=e.tracks[t]:"audio"===e.tracks[t].type&&(n=e.tracks[t]);i&&!d&&(f.numberOfTracks++,d=new m(i),u.pipe(d).pipe(f)),n&&!l&&(f.numberOfTracks++,l=new b(n),o.pipe(l).pipe(f),d&&d.on("keyframe",l.onVideoKeyFrame))}}),this.push=function(e){t.push(e)},this.flush=function(){t.flush()},this.resetCaptions=function(){c.reset()},f.on("data",function(e){h.trigger("data",e)}),f.on("done",function(){h.trigger("done")})}).prototype=new n,t.exports=p},{"../codecs/adts.js":40,"../codecs/h264":41,"../m2ts/m2ts.js":50,"../utils/stream.js":62,"./coalesce-stream.js":43,"./flv-tag.js":45,"./tag-list.js":47}],49:[function(e,t,i){"use strict";function n(){n.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new r(0,0),new r(0,1),new r(1,0),new r(1,1)],this.reset(),this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data")),e.on("done",this.trigger.bind(this,"done"))},this)}e=e("../utils/stream");(n.prototype=new e).push=function(e){var t,i;"sei_rbsp"===e.nalUnitType&&4===(i=function(e){for(var t=0,i={payloadType:-1,payloadSize:0},n=0,a=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)n+=255,t++;for(n+=e[t++];255===e[t];)a+=255,t++;if(a+=e[t++],!i.payload&&4===n){i.payloadType=n,i.payloadSize=a,i.payload=e.subarray(t,t+a);break}t+=a,a=n=0}return i}(e.escapedRBSP)).payloadType&&(t=181!==(t=i).payload[0]||49!=(t.payload[1]<<8|t.payload[2])||"GA94"!==String.fromCharCode(t.payload[3],t.payload[4],t.payload[5],t.payload[6])||3!==t.payload[7]?null:t.payload.subarray(8,t.payload.length-1))&&(e.dts<this.latestDts_?this.ignoreNextEqualDts_=!0:e.dts===this.latestDts_&&this.ignoreNextEqualDts_?this.ignoreNextEqualDts_=!1:(this.captionPackets_=this.captionPackets_.concat(function(e,t){var i,n,a,r,s=[];if(!(64&t[0]))return s;for(n=31&t[0],i=0;i<n;i++)r={type:3&t[2+(a=3*i)],pts:e},4&t[2+a]&&(r.ccData=t[3+a]<<8|t[4+a],s.push(r));return s}(e.pts,t)),this.latestDts_=e.dts))},n.prototype.flush=function(){this.captionPackets_.length?(this.captionPackets_.forEach(function(e,t){e.presortIndex=t}),this.captionPackets_.sort(function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts}),this.captionPackets_.forEach(function(e){e.type<2&&this.dispatchCea608Packet(e)},this),this.captionPackets_.length=0,this.ccStreams_.forEach(function(e){e.flush()},this)):this.ccStreams_.forEach(function(e){e.flush()},this)},n.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(e){e.reset()})},n.prototype.dispatchCea608Packet=function(e){this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},n.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},n.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)};function s(e){return null===e?"":(e=a[e]||e,String.fromCharCode(e))}function o(){for(var e=[],t=u+1;t--;)e.push("");return e}var a={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},u=14,d=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],r=function(e,t){r.prototype.init.call(this),this.field_=e||0,this.dataChannel_=t||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,i,n,a,r=32639&e.ccData;r!==this.lastControlCode_?(4096==(61440&r)?this.lastControlCode_=r:r!==this.PADDING_&&(this.lastControlCode_=null),t=r>>>8,i=255&r,r===this.PADDING_||(r===this.RESUME_CAPTION_LOADING_?this.mode_="popOn":r===this.END_OF_CAPTION_?(this.clearFormatting(e.pts),this.flushDisplayed(e.pts),a=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=a,this.startPts_=e.pts):r===this.ROLL_UP_2_ROWS_?(this.topRow_=u-1,this.mode_="rollUp"):r===this.ROLL_UP_3_ROWS_?(this.topRow_=u-2,this.mode_="rollUp"):r===this.ROLL_UP_4_ROWS_?(this.topRow_=u-3,this.mode_="rollUp"):r===this.CARRIAGE_RETURN_?(this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts):r===this.BACKSPACE_?"popOn"===this.mode_?this.nonDisplayed_[u]=this.nonDisplayed_[u].slice(0,-1):this.displayed_[u]=this.displayed_[u].slice(0,-1):r===this.ERASE_DISPLAYED_MEMORY_?(this.flushDisplayed(e.pts),this.displayed_=o()):r===this.ERASE_NON_DISPLAYED_MEMORY_?this.nonDisplayed_=o():r===this.RESUME_DIRECT_CAPTIONING_?this.mode_="paintOn":this.isSpecialCharacter(t,i)?(n=s((t=(3&t)<<8)|i),this[this.mode_](e.pts,n),this.column_++):this.isExtCharacter(t,i)?("popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[u]=this.displayed_[u].slice(0,-1),n=s((t=(3&t)<<8)|i),this[this.mode_](e.pts,n),this.column_++):this.isMidRowCode(t,i)?(this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&i)&&this.addFormatting(e.pts,["i"]),1==(1&i)&&this.addFormatting(e.pts,["u"])):this.isOffsetControlCode(t,i)?this.column_+=3&i:this.isPAC(t,i)?((a=d.indexOf(7968&r))!==this.row_&&(this.clearFormatting(e.pts),this.row_=a),1&i&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&r)&&(this.column_=4*((14&r)>>1)),this.isColorPAC(i)&&14==(14&i)&&this.addFormatting(e.pts,["i"])):this.isNormalChar(t)&&(0===i&&(i=null),n=s(t),n+=s(i),this[this.mode_](e.pts,n),this.column_+=n.length))):this.lastControlCode_=null}};r.prototype=new e,r.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){return e.trim()}).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},r.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=o(),this.nonDisplayed_=o(),this.lastControlCode_=null,this.column_=0,this.row_=u,this.formatting_=[]},r.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},r.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&48<=t&&t<=63},r.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&32<=t&&t<=63},r.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&32<=t&&t<=47},r.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&33<=t&&t<=35},r.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&64<=t&&t<=127},r.prototype.isColorPAC=function(e){return 64<=e&&e<=79||96<=e&&e<=127},r.prototype.isNormalChar=function(e){return 32<=e&&e<=127},r.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);t=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,t)},r.prototype.clearFormatting=function(e){var t;this.formatting_.length&&(t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},""),this.formatting_=[],this[this.mode_](e,t))},r.prototype.popOn=function(e,t){var i=this.nonDisplayed_[this.row_];this.nonDisplayed_[this.row_]=i+=t},r.prototype.rollUp=function(e,t){var i=this.displayed_[u];this.displayed_[u]=i+=t},r.prototype.shiftRowsUp_=function(){for(var e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.topRow_;e<u;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[u]=""},r.prototype.paintOn=function(){},t.exports={CaptionStream:n,Cea608Stream:r}},{"../utils/stream":62}],50:[function(e,t,i){"use strict";var o,l,n=e("../utils/stream.js"),a=e("./caption-stream"),c=e("./stream-types"),r=e("./timestamp-rollover-stream").TimestampRolloverStream,f=e("./stream-types.js"),s=function(){var a=new Uint8Array(188),r=0;s.prototype.init.call(this),this.push=function(e){var t,i=0,n=188;for(r?((t=new Uint8Array(e.byteLength+r)).set(a.subarray(0,r)),t.set(e,r),r=0):t=e;n<t.byteLength;)71!==t[i]||71!==t[n]?(i++,n++):(this.trigger("data",t.subarray(i,n)),i+=188,n+=188);i<t.byteLength&&(a.set(t.subarray(i),0),r=t.byteLength-i)},this.flush=function(){188===r&&71===a[0]&&(this.trigger("data",a),r=0),this.trigger("done")}};s.prototype=new n,(o=function(){var n,a,r,s;o.prototype.init.call(this),(s=this).packetsWaitingForPmt=[],this.programMapTable=void 0,n=function(e,t){var i=0;t.payloadUnitStartIndicator&&(i+=e[i]+1),("pat"===t.type?a:r)(e.subarray(i),t)},a=function(e,t){t.section_number=e[7],t.last_section_number=e[8],s.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=s.pmtPid},r=function(e,t){var i,n;if(1&e[5]){for(s.programMapTable={video:null,audio:null,"timed-metadata":{}},i=3+((15&e[1])<<8|e[2])-4,n=12+((15&e[10])<<8|e[11]);n<i;){var a=e[n],r=(31&e[n+1])<<8|e[n+2];a===c.H264_STREAM_TYPE&&null===s.programMapTable.video?s.programMapTable.video=r:a===c.ADTS_STREAM_TYPE&&null===s.programMapTable.audio?s.programMapTable.audio=r:a===c.METADATA_STREAM_TYPE&&(s.programMapTable["timed-metadata"][r]=a),n+=5+((15&e[n+3])<<8|e[n+4])}t.programMapTable=s.programMapTable}},this.push=function(e){var t={},i=4;if(t.payloadUnitStartIndicator=!!(64&e[1]),t.pid=31&e[1],t.pid<<=8,t.pid|=e[2],1<(48&e[3])>>>4&&(i+=e[i]+1),0===t.pid)t.type="pat",n(e.subarray(i),t),this.trigger("data",t);else if(t.pid===this.pmtPid)for(t.type="pmt",n(e.subarray(i),t),this.trigger("data",t);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([e,i,t]):this.processPes_(e,i,t)},this.processPes_=function(e,t,i){i.pid===this.programMapTable.video?i.streamType=c.H264_STREAM_TYPE:i.pid===this.programMapTable.audio?i.streamType=c.ADTS_STREAM_TYPE:i.streamType=this.programMapTable["timed-metadata"][i.pid],i.type="pes",i.data=e.subarray(t),this.trigger("data",i)}}).prototype=new n,o.STREAM_TYPES={h264:27,adts:15},(l=function(){function n(e,t,i){var n,a=new Uint8Array(e.size),r={type:t},s=0,o=0;if(e.data.length&&!(e.size<9)){for(r.trackId=e.data[0].pid,s=0;s<e.data.length;s++)n=e.data[s],a.set(n.data,o),o+=n.data.byteLength;d(a,r),t="video"===t||r.packetLength<=e.size,(i||t)&&(e.size=0,e.data.length=0),t&&u.trigger("data",r)}}var u=this,a={data:[],size:0},r={data:[],size:0},s={data:[],size:0},d=function(e,t){var i;t.packetLength=6+(e[4]<<8|e[5]),t.dataAlignmentIndicator=0!=(4&e[6]),192&(i=e[7])&&(t.pts=(14&e[9])<<27|(255&e[10])<<20|(254&e[11])<<12|(255&e[12])<<5|(254&e[13])>>>3,t.pts*=4,t.pts+=(6&e[13])>>>1,t.dts=t.pts,64&i&&(t.dts=(14&e[14])<<27|(255&e[15])<<20|(254&e[16])<<12|(255&e[17])<<5|(254&e[18])>>>3,t.dts*=4,t.dts+=(6&e[18])>>>1)),t.data=e.subarray(9+e[8])};l.prototype.init.call(this),this.push=function(i){({pat:function(){},pes:function(){var e,t;switch(i.streamType){case c.H264_STREAM_TYPE:case f.H264_STREAM_TYPE:e=a,t="video";break;case c.ADTS_STREAM_TYPE:e=r,t="audio";break;case c.METADATA_STREAM_TYPE:e=s,t="timed-metadata";break;default:return}i.payloadUnitStartIndicator&&n(e,t,!0),e.data.push(i),e.size+=i.data.byteLength},pmt:function(){var e={type:"metadata",tracks:[]},t=i.programMapTable;null!==t.video&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.video,codec:"avc",type:"video"}),null!==t.audio&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.audio,codec:"adts",type:"audio"}),u.trigger("data",e)}})[i.type]()},this.flush=function(){n(a,"video"),n(r,"audio"),n(s,"timed-metadata"),this.trigger("done")}}).prototype=new n;var u,d={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:s,TransportParseStream:o,ElementaryStream:l,TimestampRolloverStream:r,CaptionStream:a.CaptionStream,Cea608Stream:a.Cea608Stream,MetadataStream:e("./metadata-stream")};for(u in c)c.hasOwnProperty(u)&&(d[u]=c[u]);t.exports=d},{"../utils/stream.js":62,"./caption-stream":49,"./metadata-stream":51,"./stream-types":53,"./stream-types.js":53,"./timestamp-rollover-stream":54}],51:[function(e,t,i){"use strict";function n(e,t,i){for(var n="",a=t;a<i;a++)n+="%"+("00"+e[a].toString(16)).slice(-2);return n}function a(e,t,i){return decodeURIComponent(n(e,t,i))}function f(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]}var r=e("../utils/stream"),s=e("./stream-types"),h={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=a(e.data,1,t),e.value=a(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=a(e.data,1,t),e.url=a(e.data,t+1,e.data.length);break}},PRIV:function(e){for(var t,i=0;i<e.data.length;i++)if(0===e.data[i]){e.owner=(t=e.data,unescape(n(t,0,i)));break}e.privateData=e.data.subarray(i+1),e.data=e.privateData}},o=function(e){var t,u={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},d=0,l=[],c=0;if(o.prototype.init.call(this),this.dispatchType=s.METADATA_STREAM_TYPE.toString(16),u.descriptor)for(t=0;t<u.descriptor.length;t++)this.dispatchType+=("00"+u.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,i,n,a,r,s,o;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(c=0,l.length=0),0===l.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))u.debug&&console.log("Skipping unrecognized metadata packet");else if(l.push(e),c+=e.data.byteLength,1===l.length&&(d=f(e.data.subarray(6,10)),d+=10),!(c<d)){for(t={data:new Uint8Array(d),frames:[],pts:l[0].pts,dts:l[0].dts},a=0;a<d;)t.data.set(l[0].data.subarray(0,d-a),a),a+=l[0].data.byteLength,c-=l[0].data.byteLength,l.shift();i=10,64&t.data[5]&&(i+=4,i+=f(t.data.subarray(10,14)),d-=f(t.data.subarray(16,20)));do{if((n=f(t.data.subarray(i+4,i+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.")}while((o={id:String.fromCharCode(t.data[i],t.data[i+1],t.data[i+2],t.data[i+3]),data:t.data.subarray(i+10,i+n+10)}).key=o.id,h[o.id]&&(h[o.id](o),"com.apple.streaming.transportStreamTimestamp"===o.owner&&(s=(1&(r=o.data)[3])<<30|r[4]<<22|r[5]<<14|r[6]<<6|r[7]>>>2,s*=4,s+=3&r[7],o.timeStamp=s,void 0===t.pts&&void 0===t.dts&&(t.pts=o.timeStamp,t.dts=o.timeStamp),this.trigger("timestamp",o))),t.frames.push(o),i+=10,(i+=n)<d);this.trigger("data",t)}}};o.prototype=new r,t.exports=o},{"../utils/stream":62,"./stream-types":53}],52:[function(e,t,i){"use strict";function n(e){var t=31&e[1];return t<<=8,t|=e[2]}function o(e){return!!(64&e[1])}function u(e){var t=0;return 1<(48&e[3])>>>4&&(t+=e[4]+1),t}function s(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}}var a=e("./stream-types.js");t.exports={parseType:function(e,t){e=n(e);return 0===e?"pat":e===t?"pmt":t?"pes":null},parsePat:function(e){var t=o(e),i=4+u(e);return t&&(i+=e[i]+1),(31&e[i+10])<<8|e[i+11]},parsePmt:function(e){var t={},i=o(e),n=4+u(e);if(i&&(n+=e[n]+1),1&e[n+5]){for(var a=3+((15&e[n+1])<<8|e[n+2])-4,r=12+((15&e[n+10])<<8|e[n+11]);r<a;){var s=n+r;t[(31&e[s+1])<<8|e[s+2]]=e[s],r+=5+((15&e[s+3])<<8|e[s+4])}return t}},parsePayloadUnitStartIndicator:o,parsePesType:function(e,t){switch(t[n(e)]){case a.H264_STREAM_TYPE:return"video";case a.ADTS_STREAM_TYPE:return"audio";case a.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(e){if(!o(e))return null;var t=4+u(e);if(t>=e.byteLength)return null;var i=null,n=e[t+7];return 192&n&&((i={}).pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,i.pts*=4,i.pts+=(6&e[t+13])>>>1,i.dts=i.pts,64&n&&(i.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,i.dts*=4,i.dts+=(6&e[t+18])>>>1)),i},videoPacketContainsKeyFrame:function(e){for(var t=4+u(e),i=e.subarray(t),n=0,a=0,r=!1;a<i.byteLength-3;a++)if(1===i[a+2]){n=a+5;break}for(;n<i.byteLength;)switch(i[n]){case 0:if(0!==i[n-1]){n+=2;break}if(0!==i[n-2]){n++;break}for(a+3!==n-2&&"slice_layer_without_partitioning_rbsp_idr"===s(31&i[a+3])&&(r=!0);1!==i[++n]&&n<i.length;);a=n-2,n+=3;break;case 1:if(0!==i[n-1]||0!==i[n-2]){n+=3;break}"slice_layer_without_partitioning_rbsp_idr"===s(31&i[a+3])&&(r=!0),a=n-2,n+=3;break;default:n+=3}return i=i.subarray(a),n-=a,a=0,r=i&&3<i.byteLength&&"slice_layer_without_partitioning_rbsp_idr"===s(31&i[a+3])?!0:r}}},{"./stream-types.js":53}],53:[function(e,t,i){"use strict";t.exports={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21}},{}],54:[function(e,t,i){"use strict";function n(e,t){var i=1;for(t<e&&(i=-1);Math.abs(t-e)>s;)e+=i*r;return e}function a(e){var t,i;a.prototype.init.call(this),this.type_=e,this.push=function(e){e.type===this.type_&&(void 0===i&&(i=e.dts),e.dts=n(e.dts,i),e.pts=n(e.pts,i),t=e.dts,this.trigger("data",e))},this.flush=function(){i=t,this.trigger("done")},this.discontinuity=function(){t=i=void 0}}var e=e("../utils/stream"),r=8589934592,s=4294967296;a.prototype=new e,t.exports={TimestampRolloverStream:a,handleRollover:n}},{"../utils/stream":62}],55:[function(e,t,i){t.exports={generator:e("./mp4-generator"),Transmuxer:e("./transmuxer").Transmuxer,AudioSegmentStream:e("./transmuxer").AudioSegmentStream,VideoSegmentStream:e("./transmuxer").VideoSegmentStream}},{"./mp4-generator":56,"./transmuxer":58}],56:[function(e,t,i){"use strict";var s,n,a,r,o,u,d,l,c,f,h,p,m,g,y,_,v,b,T,S,w,k,O,E,A,L,P,I,C,D,M,U,x,R,B,j,N,F,q,G,H,V=Math.pow(2,32)-1;!function(){if(O={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(var e in O)O.hasOwnProperty(e)&&(O[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);E=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),L=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),A=new Uint8Array([0,0,0,1]),P=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),I=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),C={video:P,audio:I},U=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),M=new Uint8Array([0,0,0,0,0,0,0,0]),x=new Uint8Array([0,0,0,0,0,0,0,0]),R=x,B=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),j=x,D=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),s=function(e){for(var t,i=[],n=0,a=1;a<arguments.length;a++)i.push(arguments[a]);for(a=i.length;a--;)n+=i[a].byteLength;for(t=new Uint8Array(n+8),new DataView(t.buffer,t.byteOffset,t.byteLength).setUint32(0,t.byteLength),t.set(e,4),a=0,n=8;a<i.length;a++)t.set(i[a],n),n+=i[a].byteLength;return t},n=function(){return s(O.dinf,s(O.dref,U))},a=function(e){return s(O.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},r=function(){return s(O.ftyp,E,A,E,L)},_=function(e){return s(O.hdlr,C[e])},o=function(e){return s(O.mdat,e)},y=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(t[12]=e.samplerate>>>24&255,t[13]=e.samplerate>>>16&255,t[14]=e.samplerate>>>8&255,t[15]=255&e.samplerate),s(O.mdhd,t)},g=function(e){return s(O.mdia,y(e),_(e.type),d(e))},u=function(e){return s(O.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},d=function(e){return s(O.minf,"video"===e.type?s(O.vmhd,D):s(O.smhd,M),n(),b(e))},l=function(e,t){for(var i=[],n=t.length;n--;)i[n]=S(t[n]);return s.apply(null,[O.moof,u(e)].concat(i))},c=function(e){for(var t=e.length,i=[];t--;)i[t]=p(e[t]);return s.apply(null,[O.moov,h(4294967295)].concat(i).concat(f(e)))},f=function(e){for(var t=e.length,i=[];t--;)i[t]=w(e[t]);return s.apply(null,[O.mvex].concat(i))},h=function(e){e=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return s(O.mvhd,e)},v=function(e){for(var t,i=e.samples||[],n=new Uint8Array(4+i.length),a=0;a<i.length;a++)t=i[a].flags,n[a+4]=t.dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return s(O.sdtp,n)},b=function(e){return s(O.stbl,T(e),s(O.stts,j),s(O.stsc,R),s(O.stsz,B),s(O.stco,x))},T=function(e){return s(O.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),("video"===e.type?N:F)(e))},N=function(e){for(var t=e.sps||[],i=e.pps||[],n=[],a=[],r=0;r<t.length;r++)n.push((65280&t[r].byteLength)>>>8),n.push(255&t[r].byteLength),n=n.concat(Array.prototype.slice.call(t[r]));for(r=0;r<i.length;r++)a.push((65280&i[r].byteLength)>>>8),a.push(255&i[r].byteLength),a=a.concat(Array.prototype.slice.call(i[r]));return s(O.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s(O.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([t.length]).concat(n).concat([i.length]).concat(a))),s(O.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},F=function(e){return s(O.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),a(e))},m=function(e){e=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return s(O.tkhd,e)},S=function(e){var t,i=s(O.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),n=Math.floor(e.baseMediaDecodeTime/(1+V)),a=Math.floor(e.baseMediaDecodeTime%(1+V)),n=s(O.tfdt,new Uint8Array([1,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,a>>>24&255,a>>>16&255,a>>>8&255,255&a]));return"audio"===e.type?(t=k(e,92),s(O.traf,i,n,t)):(a=v(e),t=k(e,a.length+92),s(O.traf,i,n,t,a))},p=function(e){return e.duration=e.duration||4294967295,s(O.trak,m(e),g(e))},w=function(e){var t=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(t[t.length-1]=0),s(O.trex,t)},q=function(e,t){var i=0,n=0,a=0,r=0;return e.length&&(void 0!==e[0].duration&&(i=1),void 0!==e[0].size&&(n=2),void 0!==e[0].flags&&(a=4),void 0!==e[0].compositionTimeOffset&&(r=8)),[0,0,i|n|a|r,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},G=function(e,t){var i,n,a,r=e.samples||[];for(t+=20+16*r.length,i=q(r,t),a=0;a<r.length;a++)n=r[a],i=i.concat([(4278190080&n.duration)>>>24,(16711680&n.duration)>>>16,(65280&n.duration)>>>8,255&n.duration,(4278190080&n.size)>>>24,(16711680&n.size)>>>16,(65280&n.size)>>>8,255&n.size,n.flags.isLeading<<2|n.flags.dependsOn,n.flags.isDependedOn<<6|n.flags.hasRedundancy<<4|n.flags.paddingValue<<1|n.flags.isNonSyncSample,61440&n.flags.degradationPriority,15&n.flags.degradationPriority,(4278190080&n.compositionTimeOffset)>>>24,(16711680&n.compositionTimeOffset)>>>16,(65280&n.compositionTimeOffset)>>>8,255&n.compositionTimeOffset]);return s(O.trun,new Uint8Array(i))},H=function(e,t){var i,n,a,r=e.samples||[];for(t+=20+8*r.length,i=q(r,t),a=0;a<r.length;a++)n=r[a],i=i.concat([(4278190080&n.duration)>>>24,(16711680&n.duration)>>>16,(65280&n.duration)>>>8,255&n.duration,(4278190080&n.size)>>>24,(16711680&n.size)>>>16,(65280&n.size)>>>8,255&n.size]);return s(O.trun,new Uint8Array(i))},k=function(e,t){return("audio"===e.type?H:G)(e,t)},t.exports={ftyp:r,mdat:o,moof:l,moov:c,initSegment:function(e){var t=r(),i=c(e),e=new Uint8Array(t.byteLength+i.byteLength);return e.set(t),e.set(i,t.byteLength),e}}},{}],57:[function(e,t,i){"use strict";var s=function(e,t){var i,n,a,r=[];if(!t.length)return null;for(i=0;i<e.byteLength;)n=e[i]<<24,n|=e[i+1]<<16,n|=e[i+2]<<8,n|=e[i+3],a=o(e.subarray(i+4,i+8)),n=1<n?i+n:e.byteLength,a===t[0]&&(1===t.length?r.push(e.subarray(i+8,n)):(a=s(e.subarray(i+8,n),t.slice(1))).length&&(r=r.concat(a))),i=n;return r},o=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),t+=String.fromCharCode(e[2]),t+=String.fromCharCode(e[3])},n=function(e){return s(e,["moov","trak"]).reduce(function(e,t){var i,n,a=s(t,["tkhd"])[0];return a?(a=a[n=0===a[0]?12:20]<<24|a[1+n]<<16|a[2+n]<<8|a[3+n],(t=s(t,["mdia","mdhd"])[0])?(i=t[0],e[a]=t[n=0===i?12:20]<<24|t[1+n]<<16|t[2+n]<<8|t[3+n],e):null):null},{})},a=function(n,e){var e=s(e,["moof","traf"]),e=[].concat.apply([],e.map(function(i){return s(i,["tfhd"]).map(function(e){var t=e[4]<<24|e[5]<<16|e[6]<<8|e[7],e=n[t]||9e4,t=s(i,["tfdt"]).map(function(e){var t=e[0],i=e[4]<<24|e[5]<<16|e[6]<<8|e[7];return 1===t&&(i*=Math.pow(2,32),i+=e[8]<<24|e[9]<<16|e[10]<<8|e[11]),i})[0];return(t||1/0)/e})})),e=Math.min.apply(null,e);return isFinite(e)?e:0};t.exports={parseType:o,timescale:n,startTime:a}},{}],58:[function(e,t,i){"use strict";var o,u,d,c,f,h,n=e("../utils/stream.js"),p=e("./mp4-generator.js"),l=e("../m2ts/m2ts.js"),m=e("../codecs/adts.js"),g=e("../codecs/h264").H264Stream,y=e("../aac"),_=e("../data/silence"),v=e("../utils/clock"),b=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],T=["width","height","profileIdc","levelIdc","profileCompatibility"],S=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0}}},w=function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},k=function(e,t){var i;if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0},s=function(e){for(var t=0,i=0;i<e.length;i++)t+=e[i].data.byteLength;return t},O=function(n){var a=[],r=0,t=0,d=0,l=1/0;O.prototype.init.call(this),this.push=function(t){c(n,t),n&&b.forEach(function(e){n[e]=t[e]}),a.push(t)},this.setEarliestDts=function(e){t=e-n.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(e){l=e},this.setAudioAppendStart=function(e){d=e},this.flush=function(){var e,t,i;0!==a.length&&(i=this.trimAdtsFramesByEarliestDts_(a),n.baseMediaDecodeTime=h(n),this.prefixWithSilence_(n,i),n.samples=this.generateSampleTable_(i),t=p.mdat(this.concatenateFrameData_(i)),a=[],e=p.moof(r,[n]),i=new Uint8Array(e.byteLength+t.byteLength),r++,i.set(e),i.set(t,e.byteLength),f(n),this.trigger("data",{track:n,boxes:i})),this.trigger("done","AudioSegmentStream")},this.prefixWithSilence_=function(e,t){var i,n,a,r,s,o=0,u=0;if(t.length&&(i=v.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate),n=Math.ceil(9e4/(e.samplerate/1024)),d&&l&&(a=i-Math.max(d,l),u=(o=Math.floor(a/n))*n),!(o<1||45e3<u))){for(r=(r=_[e.samplerate])||t[0].data,s=0;s<o;s++)t.splice(s,0,{data:r});e.baseMediaDecodeTime-=Math.floor(v.videoTsToAudioTs(u,e.samplerate))}},this.trimAdtsFramesByEarliestDts_=function(e){return n.minSegmentDts>=t?e:(n.minSegmentDts=1/0,e.filter(function(e){return e.dts>=t&&(n.minSegmentDts=Math.min(n.minSegmentDts,e.dts),n.minSegmentPts=n.minSegmentDts,!0)}))},this.generateSampleTable_=function(e){for(var t,i=[],n=0;n<e.length;n++)t=e[n],i.push({size:t.data.byteLength,duration:1024});return i},this.concatenateFrameData_=function(e){for(var t,i=0,n=new Uint8Array(s(e)),a=0;a<e.length;a++)t=e[a],n.set(t.data,i),i+=t.data.byteLength;return n}};O.prototype=new n,(o=function(s,n){var t,i,a=0,r=[],d=[];n=n||{},o.prototype.init.call(this),delete s.minPTS,this.gopCache_=[],this.push=function(e){c(s,e),"seq_parameter_set_rbsp"!==e.nalUnitType||t||(t=e.config,s.sps=[e.data],T.forEach(function(e){s[e]=t[e]},this)),"pic_parameter_set_rbsp"!==e.nalUnitType||i||(i=e.data,s.pps=[e.data]),r.push(e)},this.flush=function(){for(var e,t;r.length&&"access_unit_delimiter_rbsp"!==r[0].nalUnitType;)r.shift();if(0===r.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(t=this.groupNalsIntoFrames_(r),(t=this.groupFramesIntoGops_(t))[0][0].keyFrame||((e=this.getGopForFusion_(r[0],s))?(t.unshift(e),t.byteLength+=e.byteLength,t.nalCount+=e.nalCount,t.pts=e.pts,t.dts=e.dts,t.duration+=e.duration):t=this.extendFirstKeyFrame_(t)),d.length){var i=n.alignGopsAtEnd?this.alignGopsAtEnd_(t):this.alignGopsAtStart_(t);if(!i)return this.gopCache_.unshift({gop:t.pop(),pps:s.pps,sps:s.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),r=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");f(s),t=i}c(s,t),s.samples=this.generateSampleTable_(t),e=p.mdat(this.concatenateNalData_(t)),s.baseMediaDecodeTime=h(s),this.trigger("processedGopsInfo",t.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})),this.gopCache_.unshift({gop:t.pop(),pps:s.pps,sps:s.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),r=[],this.trigger("baseMediaDecodeTime",s.baseMediaDecodeTime),this.trigger("timelineStartInfo",s.timelineStartInfo),i=p.moof(a,[s]),t=new Uint8Array(i.byteLength+e.byteLength),a++,t.set(i),t.set(e,i.byteLength),this.trigger("data",{track:s,boxes:t}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){f(s),i=t=void 0},this.getGopForFusion_=function(e){for(var t,i,n,a=1/0,r=0;r<this.gopCache_.length;r++)i=(n=this.gopCache_[r]).gop,s.pps&&k(s.pps[0],n.pps[0])&&s.sps&&k(s.sps[0],n.sps[0])&&(i.dts<s.timelineStartInfo.dts||-1e4<=(i=e.dts-i.dts-i.duration)&&i<=45e3&&(!t||i<a)&&(t=n,a=i));return t?t.gop:null},this.extendFirstKeyFrame_=function(e){var t;return!e[0][0].keyFrame&&1<e.length&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},this.groupNalsIntoFrames_=function(e){for(var t,i=[],n=[],a=i.byteLength=0;a<e.length;a++)"access_unit_delimiter_rbsp"===(t=e[a]).nalUnitType?(i.length&&(i.duration=t.dts-i.dts,n.push(i)),(i=[t]).byteLength=t.data.byteLength,i.pts=t.pts,i.dts=t.dts):("slice_layer_without_partitioning_rbsp_idr"===t.nalUnitType&&(i.keyFrame=!0),i.duration=t.dts-i.dts,i.byteLength+=t.data.byteLength,i.push(t));return n.length&&(!i.duration||i.duration<=0)&&(i.duration=n[n.length-1].duration),n.push(i),n},this.groupFramesIntoGops_=function(e){var t,i,n=[],a=[];for(n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=e[0].pts,n.dts=e[0].dts,a.byteLength=0,a.nalCount=0,a.duration=0,a.pts=e[0].pts,a.dts=e[0].dts,t=0;t<e.length;t++)(i=e[t]).keyFrame?(n.length&&(a.push(n),a.byteLength+=n.byteLength,a.nalCount+=n.nalCount,a.duration+=n.duration),(n=[i]).nalCount=i.length,n.byteLength=i.byteLength,n.pts=i.pts,n.dts=i.dts,n.duration=i.duration):(n.duration+=i.duration,n.nalCount+=i.length,n.byteLength+=i.byteLength,n.push(i));return a.length&&n.duration<=0&&(n.duration=a[a.length-1].duration),a.byteLength+=n.byteLength,a.nalCount+=n.nalCount,a.duration+=n.duration,a.push(n),a},this.generateSampleTable_=function(e,t){for(var i,n,a,r,s=t||0,o=[],u=0;u<e.length;u++)for(a=e[u],i=0;i<a.length;i++)r=a[i],(n=S()).dataOffset=s,n.compositionTimeOffset=r.pts-r.dts,n.duration=r.duration,n.size=4*r.length,n.size+=r.byteLength,r.keyFrame&&(n.flags.dependsOn=2),s+=n.size,o.push(n);return o},this.concatenateNalData_=function(e){for(var t,i,n,a,r,s=0,o=e.byteLength,u=e.nalCount,d=new Uint8Array(o+4*u),l=new DataView(d.buffer),c=0;c<e.length;c++)for(n=e[c],t=0;t<n.length;t++)for(a=n[t],i=0;i<a.length;i++)r=a[i],l.setUint32(s,r.data.byteLength),d.set(r.data,s+=4),s+=r.data.byteLength;return d},this.alignGopsAtStart_=function(e){for(var t,i,n,a,r=e.byteLength,s=e.nalCount,o=e.duration,u=t=0;u<d.length&&t<e.length&&(i=d[u],n=e[t],i.pts!==n.pts);)n.pts>i.pts?u++:(t++,r-=n.byteLength,s-=n.nalCount,o-=n.duration);return 0===t?e:t===e.length?null:((a=e.slice(t)).byteLength=r,a.duration=o,a.nalCount=s,a.pts=a[0].pts,a.dts=a[0].dts,a)},this.alignGopsAtEnd_=function(e){for(var t,i,n=d.length-1,a=e.length-1,r=null,s=!1;0<=n&&0<=a;){if(t=d[n],i=e[a],t.pts===i.pts){s=!0;break}t.pts>i.pts?n--:(n===d.length-1&&(r=a),a--)}if(!s&&null===r)return null;if(0===(u=s?a:r))return e;var o=e.slice(u),u=o.reduce(function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e},{byteLength:0,duration:0,nalCount:0});return o.byteLength=u.byteLength,o.duration=u.duration,o.nalCount=u.nalCount,o.pts=o[0].pts,o.dts=o[0].dts,o},this.alignGopsWith=function(e){d=e}}).prototype=new n,c=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))},f=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},h=function(e){var t=e.minSegmentDts-e.timelineStartInfo.dts,i=e.timelineStartInfo.baseMediaDecodeTime;return i+=t,i=Math.max(0,i),"audio"===e.type&&(i*=e.samplerate/9e4,i=Math.floor(i)),i},((d=function(e,t){this.numberOfTracks=0,this.metadataStream=t,void 0!==e.remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,d.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBoxes.push(e.boxes),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track),void("audio"===e.track.type&&(this.audioTrack=e.track)))}}).prototype=new n).flush=function(e){var t,i,n,a=0,r={captions:[],captionStreams:{},metadata:[],info:{}},s=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(s=this.videoTrack.timelineStartInfo.pts,T.forEach(function(e){r.info[e]=this.videoTrack[e]},this)):this.audioTrack&&(s=this.audioTrack.timelineStartInfo.pts,b.forEach(function(e){r.info[e]=this.audioTrack[e]},this)),1===this.pendingTracks.length?r.type=this.pendingTracks[0].type:r.type="combined",this.emittedTracks+=this.pendingTracks.length,e=p.initSegment(this.pendingTracks),r.initSegment=new Uint8Array(e.byteLength),r.initSegment.set(e),r.data=new Uint8Array(this.pendingBytes),n=0;n<this.pendingBoxes.length;n++)r.data.set(this.pendingBoxes[n],a),a+=this.pendingBoxes[n].byteLength;for(n=0;n<this.pendingCaptions.length;n++)(t=this.pendingCaptions[n]).startTime=t.startPts-s,t.startTime/=9e4,t.endTime=t.endPts-s,t.endTime/=9e4,r.captionStreams[t.stream]=!0,r.captions.push(t);for(n=0;n<this.pendingMetadata.length;n++)(i=this.pendingMetadata[n]).cueTime=i.pts-s,i.cueTime/=9e4,r.metadata.push(i);r.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",r),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},(u=function(n){var a,r,s=this,i=!0;u.prototype.init.call(this),n=n||{},this.baseMediaDecodeTime=n.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var t={};(this.transmuxPipeline_=t).type="aac",t.metadataStream=new l.MetadataStream,t.aacStream=new y,t.audioTimestampRolloverStream=new l.TimestampRolloverStream("audio"),t.timedMetadataTimestampRolloverStream=new l.TimestampRolloverStream("timed-metadata"),t.adtsStream=new m,t.coalesceStream=new d(n,t.metadataStream),t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioTimestampRolloverStream).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataTimestampRolloverStream).pipe(t.metadataStream).pipe(t.coalesceStream),t.metadataStream.on("timestamp",function(e){t.aacStream.setTimestamp(e.timeStamp)}),t.aacStream.on("data",function(e){"timed-metadata"!==e.type||t.audioSegmentStream||(r=r||{timelineStartInfo:{baseMediaDecodeTime:s.baseMediaDecodeTime},codec:"adts",type:"audio"},t.coalesceStream.numberOfTracks++,t.audioSegmentStream=new O(r),t.adtsStream.pipe(t.audioSegmentStream).pipe(t.coalesceStream))}),t.coalesceStream.on("data",this.trigger.bind(this,"data")),t.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var i={};(this.transmuxPipeline_=i).type="ts",i.metadataStream=new l.MetadataStream,i.packetStream=new l.TransportPacketStream,i.parseStream=new l.TransportParseStream,i.elementaryStream=new l.ElementaryStream,i.videoTimestampRolloverStream=new l.TimestampRolloverStream("video"),i.audioTimestampRolloverStream=new l.TimestampRolloverStream("audio"),i.timedMetadataTimestampRolloverStream=new l.TimestampRolloverStream("timed-metadata"),i.adtsStream=new m,i.h264Stream=new g,i.captionStream=new l.CaptionStream,i.coalesceStream=new d(n,i.metadataStream),i.headOfPipeline=i.packetStream,i.packetStream.pipe(i.parseStream).pipe(i.elementaryStream),i.elementaryStream.pipe(i.videoTimestampRolloverStream).pipe(i.h264Stream),i.elementaryStream.pipe(i.audioTimestampRolloverStream).pipe(i.adtsStream),i.elementaryStream.pipe(i.timedMetadataTimestampRolloverStream).pipe(i.metadataStream).pipe(i.coalesceStream),i.h264Stream.pipe(i.captionStream).pipe(i.coalesceStream),i.elementaryStream.on("data",function(e){var t;if("metadata"===e.type){for(t=e.tracks.length;t--;)a||"video"!==e.tracks[t].type?r||"audio"!==e.tracks[t].type||((r=e.tracks[t]).timelineStartInfo.baseMediaDecodeTime=s.baseMediaDecodeTime):(a=e.tracks[t]).timelineStartInfo.baseMediaDecodeTime=s.baseMediaDecodeTime;a&&!i.videoSegmentStream&&(i.coalesceStream.numberOfTracks++,i.videoSegmentStream=new o(a,n),i.videoSegmentStream.on("timelineStartInfo",function(e){r&&(r.timelineStartInfo=e,i.audioSegmentStream.setEarliestDts(e.dts))}),i.videoSegmentStream.on("processedGopsInfo",s.trigger.bind(s,"gopInfo")),i.videoSegmentStream.on("baseMediaDecodeTime",function(e){r&&i.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}),i.h264Stream.pipe(i.videoSegmentStream).pipe(i.coalesceStream)),r&&!i.audioSegmentStream&&(i.coalesceStream.numberOfTracks++,i.audioSegmentStream=new O(r),i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream))}}),i.coalesceStream.on("data",this.trigger.bind(this,"data")),i.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(e){var t=this.transmuxPipeline_;this.baseMediaDecodeTime=e,r&&(r.timelineStartInfo.dts=void 0,r.timelineStartInfo.pts=void 0,f(r),r.timelineStartInfo.baseMediaDecodeTime=e,t.audioTimestampRolloverStream&&t.audioTimestampRolloverStream.discontinuity()),a&&(t.videoSegmentStream&&(t.videoSegmentStream.gopCache_=[],t.videoTimestampRolloverStream.discontinuity()),a.timelineStartInfo.dts=void 0,a.timelineStartInfo.pts=void 0,f(a),t.captionStream.reset(),a.timelineStartInfo.baseMediaDecodeTime=e),t.timedMetadataTimestampRolloverStream&&t.timedMetadataTimestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){r&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.alignGopsWith=function(e){a&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){var t;i&&((t=w(e))&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),i=!1),this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){i=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new n,t.exports={Transmuxer:u,VideoSegmentStream:o,AudioSegmentStream:O,AUDIO_PROPERTIES:b,VIDEO_PROPERTIES:T}},{"../aac":38,"../codecs/adts.js":40,"../codecs/h264":41,"../data/silence":42,"../m2ts/m2ts.js":50,"../utils/clock":60,"../utils/stream.js":62,"./mp4-generator.js":56}],59:[function(e,t,i){"use strict";var r=e("../m2ts/stream-types.js"),s=e("../m2ts/timestamp-rollover-stream.js").handleRollover,p={};p.ts=e("../m2ts/probe.js"),p.aac=e("../aac/probe.js");var d=9e4,m=188,o=function(e,t){for(var i,n=0,a=m;a<e.byteLength;)if(71!==e[n]||71!==e[a])n++,a++;else{switch(i=e.subarray(n,a),p.ts.parseType(i,t.pid)){case"pat":t.pid||(t.pid=p.ts.parsePat(i));break;case"pmt":t.table||(t.table=p.ts.parsePmt(i))}if(t.pid&&t.table)return;n+=m,a+=m}},u=function(e,t,i){for(var n,a,r,s,o=0,u=m,d=!1;u<e.byteLength;)if(71!==e[o]||71!==e[u])o++,u++;else{if(n=e.subarray(o,u),"pes"===p.ts.parseType(n,t.pid)&&(a=p.ts.parsePesType(n,t.table),r=p.ts.parsePayloadUnitStartIndicator(n),"audio"===a&&r&&(s=p.ts.parsePesTime(n))&&(s.type="audio",i.audio.push(s),d=!0)),d)break;o+=m,u+=m}for(o=(u=e.byteLength)-m,d=!1;0<=o;)if(71!==e[o]||71!==e[u])o--,u--;else{if(n=e.subarray(o,u),"pes"===p.ts.parseType(n,t.pid)&&(a=p.ts.parsePesType(n,t.table),r=p.ts.parsePayloadUnitStartIndicator(n),"audio"===a&&r&&(s=p.ts.parsePesTime(n))&&(s.type="audio",i.audio.push(s),d=!0)),d)break;o-=m,u-=m}},l=function(e,t,i){for(var n,a,r,s,o,u,d,l=0,c=m,f=!1,h={data:[],size:0};c<e.byteLength;)if(71!==e[l]||71!==e[c])l++,c++;else{if(n=e.subarray(l,c),"pes"===p.ts.parseType(n,t.pid))if(a=p.ts.parsePesType(n,t.table),r=p.ts.parsePayloadUnitStartIndicator(n),"video"===a&&(r&&!f&&(s=p.ts.parsePesTime(n))&&(s.type="video",i.video.push(s),f=!0),!i.firstKeyFrame)){if(r&&0!==h.size){for(o=new Uint8Array(h.size),u=0;h.data.length;)d=h.data.shift(),o.set(d,u),u+=d.byteLength;p.ts.videoPacketContainsKeyFrame(o)&&(i.firstKeyFrame=p.ts.parsePesTime(o),i.firstKeyFrame.type="video"),h.size=0}h.data.push(n),h.size+=n.byteLength}if(f&&i.firstKeyFrame)break;l+=m,c+=m}for(l=(c=e.byteLength)-m,f=!1;0<=l;)if(71!==e[l]||71!==e[c])l--,c--;else{if(n=e.subarray(l,c),"pes"===p.ts.parseType(n,t.pid)&&(a=p.ts.parsePesType(n,t.table),r=p.ts.parsePayloadUnitStartIndicator(n),"video"===a&&r&&(s=p.ts.parsePesTime(n))&&(s.type="video",i.video.push(s),f=!0)),f)break;l-=m,c-=m}};t.exports={inspect:function(e,t){var i,n,a=((a=e)[0]==="I".charCodeAt(0)&&a[1]==="D".charCodeAt(0)&&a[2]==="3".charCodeAt(0)?function(e){for(var t,i=!1,n=0,a=null,r=null,s=0,o=0;3<=e.length-o;){switch(p.aac.parseType(e,o)){case"timed-metadata":if(e.length-o<10){i=!0;break}if((s=p.aac.parseId3TagSize(e,o))>e.length){i=!0;break}null===r&&(t=e.subarray(o,o+s),r=p.aac.parseAacTimestamp(t)),o+=s;break;case"audio":if(e.length-o<7){i=!0;break}if((s=p.aac.parseAdtsSize(e,o))>e.length){i=!0;break}null===a&&(t=e.subarray(o,o+s),a=p.aac.parseSampleRate(t)),n++,o+=s;break;default:o++}if(i)return null}if(null===a||null===r)return null;var u=d/a;return{audio:[{type:"audio",dts:r,pts:r},{type:"audio",dts:r+1024*n*u,pts:r+1024*n*u}]}}:function(e){var t,i={pid:null,table:null},n={};for(t in o(e,i),i.table)if(i.table.hasOwnProperty(t))switch(i.table[t]){case r.H264_STREAM_TYPE:n.video=[],l(e,i,n),0===n.video.length&&delete n.video;break;case r.ADTS_STREAM_TYPE:n.audio=[],u(e,i,n),0===n.audio.length&&delete n.audio}return n})(e);return a&&(a.audio||a.video)?(e=t,(t=a).audio&&t.audio.length&&(void 0===(i=e)&&(i=t.audio[0].dts),t.audio.forEach(function(e){e.dts=s(e.dts,i),e.pts=s(e.pts,i),e.dtsTime=e.dts/d,e.ptsTime=e.pts/d})),t.video&&t.video.length&&(void 0===(n=e)&&(n=t.video[0].dts),t.video.forEach(function(e){e.dts=s(e.dts,n),e.pts=s(e.pts,n),e.dtsTime=e.dts/d,e.ptsTime=e.pts/d}),t.firstKeyFrame&&((t=t.firstKeyFrame).dts=s(t.dts,n),t.pts=s(t.pts,n),t.dtsTime=t.dts/d,t.ptsTime=t.dts/d)),a):null}}},{"../aac/probe.js":39,"../m2ts/probe.js":52,"../m2ts/stream-types.js":53,"../m2ts/timestamp-rollover-stream.js":54}],60:[function(e,t,i){var n=function(e){return 9e4*e},a=function(e,t){return e*t},r=function(e){return e/9e4},s=function(e,t){return e/t};t.exports={secondsToVideoTs:n,secondsToAudioTs:a,videoTsToSeconds:r,audioTsToSeconds:s,audioTsToVideoTs:function(e,t){return e/t*9e4},videoTsToAudioTs:function(e,t){return e/9e4*t}}},{}],61:[function(e,t,i){"use strict";var n=function(n){var a=n.byteLength,r=0,s=0;this.length=function(){return 8*a},this.bitsAvailable=function(){return 8*a+s},this.loadWord=function(){var e=n.byteLength-a,t=new Uint8Array(4),i=Math.min(4,a);if(0===i)throw new Error("no bytes available");t.set(n.subarray(e,e+i)),r=new DataView(t.buffer).getUint32(0),s=8*i,a-=i},this.skipBits=function(e){var t;e<s||(e-=s,e-=8*(t=Math.floor(e/8)),a-=t,this.loadWord()),r<<=e,s-=e},this.readBits=function(e){var t=Math.min(s,e),i=r>>>32-t;return 0<(s-=t)?r<<=t:0<a&&this.loadWord(),0<(t=e-t)?i<<t|this.readBits(t):i},this.skipLeadingZeros=function(){for(var e=0;e<s;++e)if(0!=(r&2147483648>>>e))return r<<=e,s-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};t.exports=n},{}],62:[function(e,t,i){"use strict";function n(){this.init=function(){var r={};this.on=function(e,t){r[e]||(r[e]=[]),r[e]=r[e].concat(t)},this.off=function(e,t){return!!r[e]&&(t=r[e].indexOf(t),r[e]=r[e].slice(),r[e].splice(t,1),-1<t)},this.trigger=function(e){var t,i,n,a=r[e];if(a)if(2===arguments.length)for(i=a.length,t=0;t<i;++t)a[t].call(this,arguments[1]);else{for(n=[],t=arguments.length,t=1;t<arguments.length;++t)n.push(arguments[t]);for(i=a.length,t=0;t<i;++t)a[t].apply(this,n)}},this.dispose=function(){r={}}}}n.prototype.pipe=function(t){return this.on("data",function(e){t.push(e)}),this.on("done",function(e){t.flush(e)}),t},n.prototype.push=function(e){this.trigger("data",e)},n.prototype.flush=function(e){this.trigger("done",e)},t.exports=n},{}],63:[function(e,t,i){var n,o;n=this,o={buildAbsoluteURL:function(e,t){if(t=t.trim(),/^[a-z]+:/i.test(t))return t;var i=null,n=null,a=/^([^#]*)(.*)$/.exec(t);a&&(n=a[2],t=a[1]);var r=/^([^\?]*)(.*)$/.exec(t);r&&(i=r[2],t=r[1]);var s=/^([^#]*)(.*)$/.exec(e);s&&(e=s[1]);a=/^([^\?]*)(.*)$/.exec(e);a&&(e=a[1]);r=/^(([a-z]+:)?\/\/[^:\/]+(:[0-9]+)?)?(\/?.*)$/i.exec(e);if(!r)throw new Error("Error trying to parse base URL.");s=r[2]||"",a=r[1]||"",e=r[4];0!==e.indexOf("/")&&""!==a&&(e="/"+e);r=null,r=/^\/\//.test(t)?s+"//"+o.buildAbsolutePath("",t.substring(2)):/^\//.test(t)?a+"/"+o.buildAbsolutePath("",t.substring(1)):o.buildAbsolutePath(a+e,t);return i&&(r+=i),n&&(r+=n),r},buildAbsolutePath:function(e,t){for(var i,n,t=t,a="",r=e.replace(/[^\/]*$/,t.replace(/(\/|^)(?:\.?\/+)+/g,"$1")),s=0;-1<(n=r.indexOf("/../",s));s=n+i)i=/^\/(?:\.\.\/)*/.exec(r.slice(n))[0].length,a=(a+r.substring(s,n)).replace(new RegExp("(?:\\/+[^\\/]*){0,"+(i-1)/3+"}$"),"/");return a+r.substr(s)}},"object"==typeof i&&"object"==typeof t?t.exports=o:"object"==typeof i?i.URLToolkit=o:n.URLToolkit=o},{}],64:[function(a,r,s){!function(e){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(s,"__esModule",{value:!0});function i(e){return isNaN(e)||Math.abs(e)===1/0?Number.MAX_VALUE:e}var n=t(a("global/window")),o=t("undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null);s.default={addTextTrackData:function(r,e,t){var s,a=n.default.WebKitDataCue||n.default.VTTCue;e&&e.forEach(function(e){var t=e.stream;this.inbandTextTracks_[t].addCue(new a(e.startTime+this.timestampOffset,e.endTime+this.timestampOffset,e.text))},r),t&&(s=i(r.mediaSource_.duration),t.forEach(function(e){var n=e.cueTime+this.timestampOffset;e.frames.forEach(function(e){var t,i=new a(n,n,e.value||e.url||e.data||"");i.frame=e,i.value=e,t=i,Object.defineProperties(t.frame,{id:{get:function(){return o.default.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),t.value.key}},value:{get:function(){return o.default.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),t.value.data}},privateData:{get:function(){return o.default.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),t.value.data}}}),this.metadataTrack_.addCue(i)},this)},r),r.metadataTrack_&&r.metadataTrack_.cues&&r.metadataTrack_.cues.length&&function(){for(var e=r.metadataTrack_.cues,t=[],i=0;i<e.length;i++)e[i]&&t.push(e[i]);var n=t.reduce(function(e,t){var i=e[t.startTime]||[];return i.push(t),e[t.startTime]=i,e},{}),a=Object.keys(n).sort(function(e,t){return Number(e)-Number(t)});a.forEach(function(e,t){var e=n[e],i=Number(a[t+1])||s;e.forEach(function(e){e.endTime=i})})}())},durationOfVideo:i},r.exports=s.default}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"global/window":32}],65:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.default={isAudioCodec:function(e){return/mp4a\.\d+.\d+/i.test(e)},parseContentType:function(e){var i={type:"",parameters:{}},e=e.trim().split(";");return i.type=e.shift().trim(),e.forEach(function(e){var t=e.trim().split("=");1<t.length&&(e=t[0].replace(/"/g,"").trim(),t=t[1].replace(/"/g,"").trim(),i.parameters[e]=t)}),i},isVideoCodec:function(e){return/avc1\.[\da-f]+/i.test(e)},translateLegacyCodecs:function(e){return e.map(function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e,t,i){return"avc1."+("00"+Number(t).toString(16)).slice(-2)+"00"+("00"+Number(i).toString(16)).slice(-2)})})}},t.exports=i.default},{}],66:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.default=function(e,t,i){var n,a=t.player_;if(i.captions&&i.captions.length)for(var r in e.inbandTextTracks_||(e.inbandTextTracks_={}),i.captionStreams)e.inbandTextTracks_[r]||(a.tech_.trigger({type:"usage",name:"hls-608"}),n=a.textTracks().getTrackById(r),e.inbandTextTracks_[r]=n||a.addRemoteTextTrack({kind:"captions",id:r,label:r},!1).track);i.metadata&&i.metadata.length&&!e.metadataTrack_&&(e.metadataTrack_=a.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=i.metadata.dispatchType)},t.exports=i.default},{}],67:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.default={TIME_BETWEEN_CHUNKS:1,BYTES_PER_CHUNK:32768},t.exports=i.default},{}],68:[function(f,h,p){!function(e){"use strict";Object.defineProperty(p,"__esModule",{value:!0});var t=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e){return e&&e.__esModule?e:{default:e}}var a,r=i(f("global/document")),s=i("undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null),o=i(f("./flash-source-buffer")),u=i(f("./flash-constants")),d=f("./codec-utils"),l=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,s.default.EventTarget),t(c,[{key:"addSeekableRange_",value:function(){}},{key:"addSourceBuffer",value:function(e){var t=(0,d.parseContentType)(e),e=void 0;if("video/mp2t"!==t.type&&"audio/mp2t"!==t.type)throw new Error("NotSupportedError (Video.js)");return e=new o.default(this),this.sourceBuffers.push(e),e}},{key:"endOfStream",value:function(e){"network"===e?this.tech_.error(2):"decode"===e&&this.tech_.error(3),"ended"!==this.readyState&&(this.readyState="ended",this.swfObj.vjs_endOfStream())}}]),c);function c(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),function(e,t,i){for(var n=!0;n;){var a=e,r=t,s=i,n=!1;null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,r);if(void 0!==o){if("value"in o)return o.value;var u=o.get;return void 0===u?void 0:u.call(s)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=r,i=s,n=!0,o=void 0}}(Object.getPrototypeOf(c.prototype),"constructor",this).call(this),this.sourceBuffers=[],this.readyState="closed",this.on(["sourceopen","webkitsourceopen"],function(e){t.swfObj=r.default.getElementById(e.swfId),t.player_=(0,s.default)(t.swfObj.parentNode),t.tech_=t.swfObj.tech,t.readyState="open",t.tech_.on("seeking",function(){for(var e=t.sourceBuffers.length;e--;)t.sourceBuffers[e].abort()}),t.swfObj&&t.swfObj.vjs_load()})}p.default=l;try{Object.defineProperty(l.prototype,"duration",{get:function(){return this.swfObj?this.swfObj.vjs_getProperty("duration"):NaN},set:function(e){var t=void 0,i=this.swfObj.vjs_getProperty("duration");if(this.swfObj.vjs_setProperty("duration",e),e<i)for(t=0;t<this.sourceBuffers.length;t++)this.sourceBuffers[t].remove(e,i);return e}})}catch(e){l.prototype.duration=NaN}for(a in u.default)l[a]=u.default[a];h.exports=p.default}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./codec-utils":65,"./flash-constants":67,"./flash-source-buffer":69,"global/document":31}],69:[function(y,_,v){!function(e){"use strict";Object.defineProperty(v,"__esModule",{value:!0});var t=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e){return e&&e.__esModule?e:{default:e}}function o(e){u.default.setTimeout(e,m.default.TIME_BETWEEN_CHUNKS)}function a(){return Math.random().toString(36).slice(2,8)}function r(e,t){return("number"!=typeof t||t<0)&&(t=0),t=Math.pow(10,t),Math.round(e*t)/t}var u=i(y("global/window")),s=i("undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null),d=i(y("mux.js/lib/flv")),l=i(y("./remove-cues-from-track")),c=i(y("./create-text-tracks-if-necessary")),f=y("./add-text-track-data"),h=i(y("./flash-transmuxer-worker")),p=i(y("webworkify")),m=i(y("./flash-constants")),t=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(g,s.default.EventTarget),t(g,[{key:"appendBuffer",value:function(e){var t=void 0;if(this.updating)throw(t=new Error("SourceBuffer.append() cannot be called while an update is in progress")).name="InvalidStateError",t.code=11,t;this.updating=!0,this.mediaSource_.readyState="open",this.trigger({type:"update"}),this.transmuxer_.postMessage({action:"push",data:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength},[e.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"abort",value:function(){this.buffer_=[],this.bufferSize_=0,this.mediaSource_.swfObj.vjs_abort(),this.updating&&(this.updating=!1,this.trigger({type:"updateend"}))}},{key:"remove",value:function(e,t){if((0,l.default)(e,t,this.metadataTrack_),this.inbandTextTracks_)for(var i in this.inbandTextTracks_)(0,l.default)(e,t,this.inbandTextTracks_[i]);this.trigger({type:"update"}),this.trigger({type:"updateend"})}},{key:"receiveBuffer_",value:function(t){var i=this;(0,c.default)(this,this.mediaSource_,t),(0,f.addTextTrackData)(this,t.captions,t.metadata),o(function(){var e=i.convertTagsToData_(t);0===i.buffer_.length&&o(i.processBuffer_.bind(i)),e&&(i.buffer_.push(e),i.bufferSize_+=e.byteLength)})}},{key:"processBuffer_",value:function(){var e=this,t=m.default.BYTES_PER_CHUNK;if(this.buffer_.length){var i=this.buffer_[0].subarray(0,t);i.byteLength<t||this.buffer_[0].byteLength===t?this.buffer_.shift():this.buffer_[0]=this.buffer_[0].subarray(t),this.bufferSize_-=i.byteLength;for(var n=[],a=i.byteLength,r=0;r<a;r++)n.push(String.fromCharCode(i[r]));var s=u.default.btoa(n.join(""));u.default[this.flashEncodedDataName_]=function(){return o(e.processBuffer_.bind(e)),delete u.default[e.flashEncodedDataName_],s},this.mediaSource_.swfObj.vjs_appendChunkReady(this.flashEncodedDataName_)}else!1!==this.updating&&(this.updating=!1,this.trigger({type:"updateend"}))}},{key:"convertTagsToData_",value:function(e){var t=0,i=this.mediaSource_.tech_,n=0,a=void 0,r=e.tags.videoTags,s=e.tags.audioTags;isNaN(this.basePtsOffset_)&&(r.length||s.length)&&(c=r[0]||{pts:1/0},d=s[0]||{pts:1/0},this.basePtsOffset_=Math.min(d.pts,c.pts)),i.seeking()&&(this.videoBufferEnd_=NaN,this.audioBufferEnd_=NaN),isNaN(this.videoBufferEnd_)?(i.buffered().length&&(n=i.buffered().end(0)-this.timestampOffset),i.seeking()&&(n=Math.max(n,i.currentTime()-this.timestampOffset)),n*=1e3,n+=this.basePtsOffset_):n=this.videoBufferEnd_+.1;var o=r.length;if(o&&r[o-1].pts>=n){for(;--o;){var u=r[o];if(!(u.pts>n)&&(u.keyFrame||u.metaDataTag))break}for(;o;){if(!r[o-1].metaDataTag)break;o--}}var d=r.slice(o),l=void 0,l=isNaN(this.audioBufferEnd_)?n:this.audioBufferEnd_+.1;for(d.length&&(l=Math.min(l,d[0].pts)),o=0;o<s.length&&!(s[o].pts>=l);)o++;var c=s.slice(o);c.length&&(this.audioBufferEnd_=c[c.length-1].pts),d.length&&(this.videoBufferEnd_=d[d.length-1].pts);var f=this.getOrderedTags_(d,c);if(0!==f.length){if(f[0].pts<n&&i.seeking()){i=i.currentTime()-(n-f[0].pts)/1e3;i<1/30&&(i=0);try{this.mediaSource_.swfObj.vjs_adjustCurrentTime(i)}catch(e){}}for(var h=0;h<f.length;h++)t+=f[h].bytes.byteLength;for(var a=new Uint8Array(t),h=0,p=0;h<f.length;h++)a.set(f[h].bytes,p),p+=f[h].bytes.byteLength;return a}}},{key:"getOrderedTags_",value:function(e,t){for(var i=void 0,n=[];e.length||t.length;)i=(!e.length||t.length&&t[0].dts<e[0].dts?t:e).shift(),n.push(i);return n}},{key:"onHlsReset_",value:function(){this.transmuxer_.postMessage({action:"resetCaptions"})}}]),g);function g(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),function(e,t,i){for(var n=!0;n;){var a=e,r=t,s=i,n=!1;null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,r);if(void 0!==o){if("value"in o)return o.value;var u=o.get;return void 0===u?void 0:u.call(s)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=r,i=s,n=!0,o=void 0}}(Object.getPrototypeOf(g.prototype),"constructor",this).call(this);this.chunkSize_=m.default.BYTES_PER_CHUNK,this.buffer_=[],this.bufferSize_=0,this.basePtsOffset_=NaN,this.mediaSource_=e,this.audioBufferEnd_=NaN,this.videoBufferEnd_=NaN,this.updating=!1,this.timestampOffset_=0;var i=u.default.btoa(String.fromCharCode.apply(null,Array.prototype.slice.call(d.default.getFlvHeader()))),e=this.mediaSource_.player_.id().replace(/[^a-zA-Z0-9]/g,"_");this.flashEncodedHeaderName_="vjs_flashEncodedHeader_"+e+a(),this.flashEncodedDataName_="vjs_flashEncodedData_"+e+a(),u.default[this.flashEncodedHeaderName_]=function(){return delete u.default[t.flashEncodedHeaderName_],i},this.mediaSource_.swfObj.vjs_appendChunkReady(this.flashEncodedHeaderName_),this.transmuxer_=(0,p.default)(h.default),this.transmuxer_.postMessage({action:"init",options:{}}),this.transmuxer_.onmessage=function(e){"data"===e.data.action&&t.receiveBuffer_(e.data.segment)},this.one("updateend",function(){t.mediaSource_.tech_.trigger("loadedmetadata")}),Object.defineProperty(this,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(e){"number"==typeof e&&0<=e&&(this.timestampOffset_=e,this.mediaSource_.swfObj.vjs_discontinuity(),this.basePtsOffset_=NaN,this.audioBufferEnd_=NaN,this.videoBufferEnd_=NaN,this.transmuxer_.postMessage({action:"reset"}))}}),Object.defineProperty(this,"buffered",{get:function(){if(!(this.mediaSource_&&this.mediaSource_.swfObj&&"vjs_getProperty"in this.mediaSource_.swfObj))return s.default.createTimeRange();var e=this.mediaSource_.swfObj.vjs_getProperty("buffered");return e&&e.length&&(e[0][0]=r(e[0][0],3),e[0][1]=r(e[0][1],3)),s.default.createTimeRanges(e)}}),this.mediaSource_.player_.on("seeked",function(){if((0,l.default)(0,1/0,t.metadataTrack_),t.inbandTextTracks_)for(var e in t.inbandTextTracks_)(0,l.default)(0,1/0,t.inbandTextTracks_[e])});var n=this.onHlsReset_.bind(this);this.mediaSource_.player_.tech_.on("hls-reset",n),this.mediaSource_.player_.tech_.hls.on("dispose",function(){t.transmuxer_.terminate(),t.mediaSource_.player_.tech_.off("hls-reset",n)})}v.default=t,_.exports=v.default}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./add-text-track-data":64,"./create-text-tracks-if-necessary":66,"./flash-constants":67,"./flash-transmuxer-worker":70,"./remove-cues-from-track":72,"global/window":32,"mux.js/lib/flv":46,webworkify:76}],70:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e};function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e){return e&&e.__esModule?e:{default:e}}var s=r(e("global/window")),o=r(e("mux.js/lib/flv")),u=(n(d,[{key:"init",value:function(){var e;this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new o.default.Transmuxer(this.options),(e=this.transmuxer).on("data",function(e){s.default.postMessage({action:"data",segment:e})}),e.on("done",function(e){s.default.postMessage({action:"done"})})}},{key:"push",value:function(e){e=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(e)}},{key:"reset",value:function(){this.init()}},{key:"flush",value:function(){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}}]),d);function d(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),this.options=e||{},this.init()}function l(e){e.onmessage=function(e){"init"===e.data.action&&e.data.options?this.messageHandlers=new u(e.data.options):(this.messageHandlers||(this.messageHandlers=new u),e.data&&e.data.action&&"init"!==e.data.action&&this.messageHandlers[e.data.action]&&this.messageHandlers[e.data.action](e.data))}}i.default=function(e){return new l(e)},t.exports=i.default},{"global/window":32,"mux.js/lib/flv":46}],71:[function(c,f,h){!function(e){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var t=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e){return e&&e.__esModule?e:{default:e}}var a=i(c("global/window")),s=i(c("global/document")),o=i("undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null),r=i(c("./virtual-source-buffer")),u=c("./add-text-track-data"),d=c("./codec-utils"),t=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(l,o.default.EventTarget),t(l,[{key:"addSeekableRange_",value:function(e,t){var i=void 0;if(this.duration!==1/0)throw(i=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity")).name="InvalidStateError",i.code=11,i;(t>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration))&&(this.nativeMediaSource_.duration=t)}},{key:"addSourceBuffer",value:function(e){var t,i=void 0,n=(0,d.parseContentType)(e);return/^(video|audio)\/mp2t$/i.test(n.type)?(t=[],n.parameters&&n.parameters.codecs&&(t=n.parameters.codecs.split(","),t=(t=(0,d.translateLegacyCodecs)(t)).filter(function(e){return(0,d.isAudioCodec)(e)||(0,d.isVideoCodec)(e)})),0===t.length&&(t=["avc1.4d400d","mp4a.40.2"]),i=new r.default(this,t),0!==this.sourceBuffers.length&&(this.sourceBuffers[0].createRealSourceBuffers_(),i.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0)):i=this.nativeMediaSource_.addSourceBuffer(e),this.sourceBuffers.push(i),i}}]),l);function l(){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),function(e,t,i){for(var n=!0;n;){var a=e,r=t,s=i,n=!1;null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,r);if(void 0!==o){if("value"in o)return o.value;var u=o.get;return void 0===u?void 0:u.call(s)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=r,i=s,n=!0,o=void 0}}(Object.getPrototypeOf(l.prototype),"constructor",this).call(this);var e=void 0;for(e in this.nativeMediaSource_=new a.default.MediaSource,this.nativeMediaSource_)e in l.prototype||"function"!=typeof this.nativeMediaSource_[e]||(this[e]=this.nativeMediaSource_[e].bind(this.nativeMediaSource_));this.duration_=NaN,Object.defineProperty(this,"duration",{get:function(){return this.duration_===1/0?this.duration_:this.nativeMediaSource_.duration},set:function(e){(this.duration_=e)!==1/0&&(this.nativeMediaSource_.duration=e)}}),Object.defineProperty(this,"seekable",{get:function(){return this.duration_===1/0?o.default.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}}),Object.defineProperty(this,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(this,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),this.sourceBuffers=[],this.activeSourceBuffers_=[],this.updateActiveSourceBuffers_=function(){if(r.activeSourceBuffers_.length=0,1===r.sourceBuffers.length){var e=r.sourceBuffers[0];return e.appendAudioInitSegment_=!0,e.audioDisabled_=!e.audioCodec_,void r.activeSourceBuffers_.push(e)}for(var t=!1,i=!0,n=0;n<r.player_.audioTracks().length;n++){var a=r.player_.audioTracks()[n];if(a.enabled&&"main"!==a.kind){i=!(t=!0);break}}r.sourceBuffers.forEach(function(e){if(e.appendAudioInitSegment_=!0,e.videoCodec_&&e.audioCodec_)e.audioDisabled_=t;else if(e.videoCodec_&&!e.audioCodec_)e.audioDisabled_=!0,i=!1;else if(!e.videoCodec_&&e.audioCodec_&&(e.audioDisabled_=i))return;r.activeSourceBuffers_.push(e)})},this.onPlayerMediachange_=function(){r.sourceBuffers.forEach(function(e){e.appendAudioInitSegment_=!0})},this.onHlsReset_=function(){r.sourceBuffers.forEach(function(e){e.transmuxer_&&e.transmuxer_.postMessage({action:"resetCaptions"})})},this.onHlsSegmentTimeMapping_=function(t){r.sourceBuffers.forEach(function(e){return e.timeMapping_=t.mapping})},["sourceopen","sourceclose","sourceended"].forEach(function(e){this.nativeMediaSource_.addEventListener(e,this.trigger.bind(this))},this),this.on("sourceopen",function(e){var t=s.default.querySelector('[src="'+r.url_+'"]');t&&(r.player_=(0,o.default)(t.parentNode),r.player_.tech_.on("hls-reset",r.onHlsReset_),r.player_.tech_.on("hls-segment-time-mapping",r.onHlsSegmentTimeMapping_),r.player_.audioTracks&&r.player_.audioTracks()&&(r.player_.audioTracks().on("change",r.updateActiveSourceBuffers_),r.player_.audioTracks().on("addtrack",r.updateActiveSourceBuffers_),r.player_.audioTracks().on("removetrack",r.updateActiveSourceBuffers_)),r.player_.on("mediachange",r.onPlayerMediachange_))}),this.on("sourceended",function(e){for(var t=(0,u.durationOfVideo)(r.duration),i=0;i<r.sourceBuffers.length;i++){var n=r.sourceBuffers[i],n=n.metadataTrack_&&n.metadataTrack_.cues;n&&n.length&&(n[n.length-1].endTime=t)}}),this.on("sourceclose",function(e){this.sourceBuffers.forEach(function(e){e.transmuxer_&&e.transmuxer_.terminate()}),this.sourceBuffers.length=0,this.player_&&(this.player_.audioTracks&&this.player_.audioTracks()&&(this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)),this.player_.el_&&(this.player_.off("mediachange",this.onPlayerMediachange_),this.player_.tech_.off("hls-reset",this.onHlsReset_),this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)))})}h.default=t,f.exports=h.default}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./add-text-track-data":64,"./codec-utils":65,"./virtual-source-buffer":75,"global/document":31,"global/window":32}],72:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.default=function(e,t,i){var n,a=void 0;if(i&&i.cues)for(a=i.cues.length;a--;)(n=i.cues[a]).startTime<=t&&n.endTime>=e&&i.removeCue(n)},t.exports=i.default},{}],73:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e};function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e){return e&&e.__esModule?e:{default:e}}var s=r(e("global/window")),o=r(e("mux.js/lib/mp4")),u=(n(d,[{key:"init",value:function(){var e;this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new o.default.Transmuxer(this.options),(e=this.transmuxer).on("data",function(e){var t=e.initSegment;e.initSegment={data:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength};t=e.data;e.data=t.buffer,s.default.postMessage({action:"data",segment:e,byteOffset:t.byteOffset,byteLength:t.byteLength},[e.data])}),e.captionStream&&e.captionStream.on("data",function(e){s.default.postMessage({action:"caption",data:e})}),e.on("done",function(e){s.default.postMessage({action:"done"})}),e.on("gopInfo",function(e){s.default.postMessage({action:"gopInfo",gopInfo:e})})}},{key:"push",value:function(e){e=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(e)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(e){e=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*e))}},{key:"setAudioAppendStart",value:function(e){this.transmuxer.setAudioAppendStart(Math.ceil(9e4*e.appendStart))}},{key:"flush",value:function(e){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())}}]),d);function d(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),this.options=e||{},this.init()}function l(e){e.onmessage=function(e){"init"===e.data.action&&e.data.options?this.messageHandlers=new u(e.data.options):(this.messageHandlers||(this.messageHandlers=new u),e.data&&e.data.action&&"init"!==e.data.action&&this.messageHandlers[e.data.action]&&this.messageHandlers[e.data.action](e.data))}}i.default=function(e){return new l(e)},t.exports=i.default},{"global/window":32,"mux.js/lib/mp4":55}],74:[function(c,e,f){!function(e){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(f,"__esModule",{value:!0});var i=t(c("global/window")),n=t(c("./flash-media-source")),a=t(c("./html-media-source")),r=t("undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null),s=0,o={mode:"auto"};r.default.mediaSources={};function u(e,t){if(!(e=r.default.mediaSources[e]))throw new Error("Media Source not found (Video.js)");e.trigger({type:"sourceopen",swfId:t})}function d(){return!!i.default.MediaSource&&!!i.default.MediaSource.isTypeSupported&&i.default.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')}function l(e){if(e=r.default.mergeOptions(o,e),this.MediaSource={open:u,supportsNativeMediaSources:d},"html5"===e.mode||"auto"===e.mode&&d())return new a.default;if(r.default.getTech("Flash"))return new n.default;throw new Error("Cannot use Flash or Html5 to create a MediaSource for this video")}(f.MediaSource=l).open=u,l.supportsNativeMediaSources=d;e={createObjectURL:function(e){var t=void 0;return e instanceof a.default?(t=i.default.URL.createObjectURL(e.nativeMediaSource_),e.url_=t):e instanceof n.default?(t="blob:vjs-media-source/"+s,s++,r.default.mediaSources[t]=e,t):(t=i.default.URL.createObjectURL(e),e.url_=t)}};f.URL=e,r.default.MediaSource=l,r.default.URL=e}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./flash-media-source":68,"./html-media-source":71,"global/window":32}],75:[function(g,e,y){!function(e){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var t=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var i,n=e.addSourceBuffer(t),a=Object.create(null);for(i in a.updating=!1,a.realBuffer_=n)!function(t){"function"==typeof n[t]?a[t]=function(){return n[t].apply(n,arguments)}:void 0===a[t]&&Object.defineProperty(a,t,{get:function(){return n[t]},set:function(e){return n[t]=e}})}(i);return a}function a(e,t,i){if(!t||!e.length)return[];for(var n=Math.ceil(9e4*(t.currentTime()-i+3)),a=void 0,a=0;a<e.length&&!(e[a].pts>n);a++);return e.slice(a)}var u=i("undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null),s=i(g("./create-text-tracks-if-necessary")),o=i(g("./remove-cues-from-track")),d=g("./add-text-track-data"),l=i(g("webworkify")),c=i(g("./transmuxer-worker")),f=g("./codec-utils");y.gopsSafeToAlignWith=a;function h(e,t,i){if(!t.length)return e;if(i)return t.slice();for(var n=t[0].pts,a=0;a<e.length&&!(e[a].pts>=n);a++);return e.slice(0,a).concat(t)}y.updateGopBuffer=h;function p(e,t,i,n){for(var a=Math.ceil(9e4*(t-n)),r=Math.ceil(9e4*(i-n)),n=e.slice(),s=e.length;s--&&!(e[s].pts<=r););if(-1===s)return n;for(var o=s+1;o--&&!(e[o].pts<=a););return o=Math.max(o,0),n.splice(o,s-o+1),n}y.removeGopBuffer=p;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(m,u.default.EventTarget),t(m,[{key:"data_",value:function(e){var t=e.data.segment;t.data=new Uint8Array(t.data,e.data.byteOffset,e.data.byteLength),t.initSegment=new Uint8Array(t.initSegment.data,t.initSegment.byteOffset,t.initSegment.byteLength),(0,s.default)(this,this.mediaSource_,t),this.pendingBuffers_.push(t)}},{key:"done_",value:function(e){"closed"!==this.mediaSource_.readyState?this.processPendingSegments_():this.pendingBuffers_.length=0}},{key:"createRealSourceBuffers_",value:function(){var n=this,a=["audio","video"];a.forEach(function(t){var e,i;n[t+"Codec_"]&&(n[t+"Buffer_"]||(i=null,n.mediaSource_[t+"Buffer_"]?(i=n.mediaSource_[t+"Buffer_"]).updating=!1:(e=t+'/mp4;codecs="'+n[t+"Codec_"]+'"',i=r(n.mediaSource_.nativeMediaSource_,e),n.mediaSource_[t+"Buffer_"]=i),n[t+"Buffer_"]=i,["update","updatestart","updateend"].forEach(function(e){i.addEventListener(e,function(){if("audio"!==t||!n.audioDisabled_)return"updateend"===e&&(n[t+"Buffer_"].updating=!1),a.every(function(e){return!("audio"!==e||!n.audioDisabled_)||(t===e||!n[e+"Buffer_"]||!n[e+"Buffer_"].updating)})?n.trigger(e):void 0})})))})}},{key:"appendBuffer",value:function(e){var t;this.bufferUpdating_=!0,this.audioBuffer_&&this.audioBuffer_.buffered.length&&(t=this.audioBuffer_.buffered,this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:t.end(t.length-1)})),this.videoBuffer_&&this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:a(this.gopBuffer_,this.mediaSource_.player_,this.timeMapping_)}),this.transmuxer_.postMessage({action:"push",data:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength},[e.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(e){this.gopBuffer_=h(this.gopBuffer_,e.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(e,t){if(this.videoBuffer_&&(this.videoBuffer_.updating=!0,this.videoBuffer_.remove(e,t),this.gopBuffer_=p(this.gopBuffer_,e,t,this.timeMapping_)),!this.audioDisabled_&&this.audioBuffer_&&(this.audioBuffer_.updating=!0,this.audioBuffer_.remove(e,t)),(0,o.default)(e,t,this.metadataTrack_),this.inbandTextTracks_)for(var i in this.inbandTextTracks_)(0,o.default)(e,t,this.inbandTextTracks_[i])}},{key:"processPendingSegments_",value:function(){var e={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]},e=this.pendingBuffers_.reduce(function(e,t){var i=t.type,n=t.data,a=t.initSegment;return e[i].segments.push(n),e[i].bytes+=n.byteLength,e[i].initSegment=a,t.captions&&(e.captions=e.captions.concat(t.captions)),t.info&&(e[i].info=t.info),t.metadata&&(e.metadata=e.metadata.concat(t.metadata)),e},e);this.videoBuffer_||this.audioBuffer_||(0===e.video.bytes&&(this.videoCodec_=null),0===e.audio.bytes&&(this.audioCodec_=null),this.createRealSourceBuffers_()),e.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:e.audio.info}),e.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:e.video.info}),this.appendAudioInitSegment_&&(!this.audioDisabled_&&this.audioBuffer_&&(e.audio.segments.unshift(e.audio.initSegment),e.audio.bytes+=e.audio.initSegment.byteLength),this.appendAudioInitSegment_=!1);var t=!1;this.videoBuffer_&&e.video.bytes?(e.video.segments.unshift(e.video.initSegment),e.video.bytes+=e.video.initSegment.byteLength,this.concatAndAppendSegments_(e.video,this.videoBuffer_),(0,d.addTextTrackData)(this,e.captions,e.metadata)):!this.videoBuffer_||!this.audioDisabled_&&this.audioBuffer_||(t=!0),!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(e.audio,this.audioBuffer_),this.pendingBuffers_.length=0,t&&this.trigger("updateend"),this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(e,t){var i=0,n=void 0;if(e.bytes){n=new Uint8Array(e.bytes),e.segments.forEach(function(e){n.set(e,i),i+=e.byteLength});try{t.updating=!0,t.appendBuffer(n)}catch(e){this.mediaSource_.player_&&this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:e.message,originalError:e})}}}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}}]),t=m;function m(e,t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),function(e,t,i){for(var n=!0;n;){var a=e,r=t,s=i,n=!1;null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,r);if(void 0!==o){if("value"in o)return o.value;var u=o.get;return void 0===u?void 0:u.call(s)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=r,i=s,n=!0,o=void 0}}(Object.getPrototypeOf(m.prototype),"constructor",this).call(this,u.default.EventTarget),this.timestampOffset_=0,this.pendingBuffers_=[],this.bufferUpdating_=!1,this.mediaSource_=e,this.codecs_=t,this.audioCodec_=null,this.videoCodec_=null,this.audioDisabled_=!1,this.appendAudioInitSegment_=!0,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=11<=u.default.browser.IE_VERSION;t={remux:!1,alignGopsAtEnd:this.safeAppend_};this.codecs_.forEach(function(e){(0,f.isAudioCodec)(e)?i.audioCodec_=e:(0,f.isVideoCodec)(e)&&(i.videoCodec_=e)}),this.transmuxer_=(0,l.default)(c.default),this.transmuxer_.postMessage({action:"init",options:t}),this.transmuxer_.onmessage=function(e){return"data"===e.data.action?i.data_(e):"done"===e.data.action?i.done_(e):"gopInfo"===e.data.action?i.appendGopInfo_(e):void 0},Object.defineProperty(this,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(e){"number"==typeof e&&0<=e&&(this.timestampOffset_=e,this.appendAudioInitSegment_=!0,this.gopBuffer_.length=0,this.timeMapping_=0,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e}))}}),Object.defineProperty(this,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(e){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=e),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=e)}}),Object.defineProperty(this,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(this,"buffered",{get:function(){var e=null,t=null,i=0,n=[],a=[];if(!this.videoBuffer_&&!this.audioBuffer_)return u.default.createTimeRange();if(!this.videoBuffer_)return this.audioBuffer_.buffered;if(!this.audioBuffer_)return this.videoBuffer_.buffered;if(this.audioDisabled_)return this.videoBuffer_.buffered;if(0===this.videoBuffer_.buffered.length&&0===this.audioBuffer_.buffered.length)return u.default.createTimeRange();for(var r=this.videoBuffer_.buffered,s=this.audioBuffer_.buffered,o=r.length;o--;)n.push({time:r.start(o),type:"start"}),n.push({time:r.end(o),type:"end"});for(o=s.length;o--;)n.push({time:s.start(o),type:"start"}),n.push({time:s.end(o),type:"end"});for(n.sort(function(e,t){return e.time-t.time}),o=0;o<n.length;o++)"start"===n[o].type?2===++i&&(e=n[o].time):"end"===n[o].type&&1===--i&&(t=n[o].time),null!==e&&null!==t&&(a.push([e,t]),t=e=null);return u.default.createTimeRanges(a)}})}y.default=t}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./add-text-track-data":64,"./codec-utils":65,"./create-text-tracks-if-necessary":66,"./remove-cues-from-track":72,"./transmuxer-worker":73,webworkify:76}],76:[function(e,t,i){var d=arguments[3],l=arguments[4],c=arguments[5],f=JSON.stringify;t.exports=function(e){for(var t=Object.keys(c),i=0,n=t.length;i<n;i++){var a=t[i];if(c[a].exports===e){r=a;break}}if(!r){for(var r=Math.floor(Math.pow(16,8)*Math.random()).toString(16),s={},i=0,n=t.length;i<n;i++)s[a=t[i]]=a;l[r]=[Function(["require","module","exports"],"("+e+")(self)"),s]}var o=Math.floor(Math.pow(16,8)*Math.random()).toString(16),u={};u[r]=r,l[o]=[Function(["require"],"require("+f(r)+")(self)"),u];u="("+d+")({"+Object.keys(l).map(function(e){return f(e)+":["+l[e][0]+","+f(l[e][1])+"]"}).join(",")+"},{},["+f(o)+"])",o=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(o.createObjectURL(new Blob([u],{type:"text/javascript"})))}},{}],77:[function(k,O,e){!function(e){"use strict";var t=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e};function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,i){for(var n=!0;n;){var a=e,r=t,s=i,n=!1;null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,r);if(void 0!==o){if("value"in o)return o.value;var u=o.get;return void 0===u?void 0:u.call(s)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=r,i=s,n=!0,o=void 0}}function i(e){return e&&e.__esModule?e:{default:e}}var r=i(k("global/document")),s=i(k("./playlist-loader")),o=i(k("./playlist")),u=i(k("./xhr")),d=k("aes-decrypter"),l=i(k("./bin-utils")),c=k("videojs-contrib-media-sources"),f=i(k("m3u8-parser")),h=i("undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null),p=k("./master-playlist-controller"),m=i(k("./config")),g=i(k("./rendition-mixin")),y=i(k("global/window")),_=i(k("./playback-watcher")),v=i(k("./reload-source-on-error")),e=k("./playlist-selectors.js"),b={PlaylistLoader:s.default,Playlist:o.default,Decrypter:d.Decrypter,AsyncStream:d.AsyncStream,decrypt:d.decrypt,utils:l.default,STANDARD_PLAYLIST_SELECTOR:e.lastBandwidthSelector,INITIAL_PLAYLIST_SELECTOR:e.lowestBitrateCompatibleVariantSelector,comparePlaylistBandwidth:e.comparePlaylistBandwidth,comparePlaylistResolution:e.comparePlaylistResolution,xhr:(0,u.default)()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach(function(t){Object.defineProperty(b,t,{get:function(){return h.default.log.warn("using Hls."+t+" is UNSAFE be sure you know what you are doing"),m.default[t]},set:function(e){h.default.log.warn("using Hls."+t+" is UNSAFE be sure you know what you are doing"),"number"!=typeof e||e<0?h.default.log.warn("value of Hls."+t+" must be greater than or equal to 0"):m.default[t]=e}})});function T(e,t){for(var i=t.media(),n=-1,a=0;a<e.length;a++)if(e[a].id===i.uri){n=a;break}e.selectedIndex_=n,e.trigger({selectedIndex:n,type:"change"})}b.canPlaySource=function(){return h.default.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")},b.supportsNativeHls=function(){var t=r.default.createElement("video");if(!h.default.getTech("Html5").isSupported())return!1;return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(e){return/maybe|probably/i.test(t.canPlayType(e))})}(),b.isSupported=function(){return h.default.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var e=h.default.getComponent("Component"),S=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(w,e),t(w,[{key:"setOptions_",value:function(){var t=this;this.options_.withCredentials=this.options_.withCredentials||!1,"number"!=typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=4194304),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&4194304===this.options_.bandwidth,["withCredentials","bandwidth"].forEach(function(e){void 0!==t.source_[e]&&(t.options_[e]=t.source_[e])}),this.bandwidth=this.options_.bandwidth}},{key:"src",value:function(e){var t=this;e&&(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=b,this.masterPlaylistController_=new p.MasterPlaylistController(this.options_),this.playbackWatcher_=new _.default(h.default.mergeOptions(this.options_,{seekable:function(){return t.seekable()}})),this.masterPlaylistController_.on("error",function(){h.default.players[t.tech_.options_.playerId].error(t.masterPlaylistController_.error)}),this.masterPlaylistController_.selectPlaylist=(this.selectPlaylist||b.STANDARD_PLAYLIST_SELECTOR).bind(this),this.masterPlaylistController_.selectInitialPlaylist=b.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var e=1/(this.bandwidth||1),t=void 0,t=0<this.throughput?1/this.throughput:0;return Math.floor(1/(e+t))},set:function(){h.default.log.error('The "systemBandwidth" property is read-only')}}}),Object.defineProperties(this.stats,{bandwidth:{get:function(){return t.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return t.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return t.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return t.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return t.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return t.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return t.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return t.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.masterPlaylistController_.on("selectedinitialmedia",function(){(0,g.default)(t)}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.masterPlaylistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.tech_.ready(function(){return t.setupQualityLevels_()}),this.tech_.el()&&this.tech_.src(h.default.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"setupQualityLevels_",value:function(){var i=this,e=h.default.players[this.tech_.options_.playerId];e&&e.qualityLevels&&(this.qualityLevels_=e.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){var t,e;t=i.qualityLevels_,(e=i).representations().forEach(function(e){t.addQualityLevel(e)}),T(t,e.playlists)}),this.playlists.on("mediachange",function(){T(i.qualityLevels_,i.playlists)}))}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(e){this.masterPlaylistController_.setCurrentTime(e)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),a(Object.getPrototypeOf(w.prototype),"dispose",this).call(this)}}]),w);function w(e,t,i){var n=this;if(!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,w),a(Object.getPrototypeOf(w.prototype),"constructor",this).call(this,t,i.hls),t.options_&&t.options_.playerId&&((i=(0,h.default)(t.options_.playerId)).hasOwnProperty("hls")||Object.defineProperty(i,"hls",{get:function(){return h.default.log.warn("player.hls is deprecated. Use player.tech_.hls instead."),t.trigger({type:"usage",name:"hls-player-access"}),n}})),this.tech_=t,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&(t.featuresNativeVideoTracks||t.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");this.on(r.default,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(e){var t=r.default.fullscreenElement||r.default.webkitFullscreenElement||r.default.mozFullScreenElement||r.default.msFullscreenElement;t&&t.contains(n.tech_.el())&&n.masterPlaylistController_.fastQualityChange_()}),this.on(this.tech_,"seeking",function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}e=function i(n){return{canHandleSource:function(e){var t=h.default.mergeOptions(h.default.options,arguments.length<=1||void 0===arguments[1]?{}:arguments[1]);return(!t.hls||!t.hls.mode||t.hls.mode===n)&&i.canPlayType(e.type,t)},handleSource:function(e,t){var i=h.default.mergeOptions(h.default.options,arguments.length<=2||void 0===arguments[2]?{}:arguments[2],{hls:{mode:n}});return"flash"===n&&t.setTimeout(function(){t.trigger("loadstart")},1),t.hls=new S(e,t,i),t.hls.xhr=(0,u.default)(),t.hls.src(e.src),t.hls},canPlayType:function(e){var t=h.default.mergeOptions(h.default.options,arguments.length<=1||void 0===arguments[1]?{}:arguments[1]);return i.canPlayType(e,t)?"maybe":""}}};e.canPlayType=function(e,t){if(h.default.browser.IE_VERSION&&h.default.browser.IE_VERSION<=10)return!1;return!(!t.hls.overrideNative&&b.supportsNativeHls)&&/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i.test(e)},void 0!==h.default.MediaSource&&void 0!==h.default.URL||(h.default.MediaSource=c.MediaSource,h.default.URL=c.URL);t=h.default.getTech("Flash");c.MediaSource.supportsNativeMediaSources()&&h.default.getTech("Html5").registerSourceHandler(e("html5"),0),y.default.Uint8Array&&t&&t.registerSourceHandler(e("flash")),h.default.HlsHandler=S,h.default.HlsSourceHandler=e,h.default.Hls=b,h.default.use||h.default.registerComponent("Hls",b),h.default.m3u8=f.default,h.default.options.hls=h.default.options.hls||{},h.default.registerPlugin?h.default.registerPlugin("reloadSourceOnError",v.default):h.default.plugin("reloadSourceOnError",v.default),O.exports={Hls:b,HlsHandler:S,HlsSourceHandler:e}}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./bin-utils":2,"./config":3,"./master-playlist-controller":5,"./playback-watcher":8,"./playlist":11,"./playlist-loader":9,"./playlist-selectors.js":10,"./reload-source-on-error":13,"./rendition-mixin":14,"./xhr":21,"aes-decrypter":25,"global/document":31,"global/window":32,"m3u8-parser":33,"videojs-contrib-media-sources":74}]},{},[77])(77)});
