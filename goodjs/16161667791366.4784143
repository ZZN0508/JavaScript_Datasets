"object"!=typeof AWS.DA&&(AWS.DA={}),AWS.DA.Logic={ruleSets:{sitewide_page_load:{callType:"setVars",setters:[{eVar12:"{{aws-target-visitor-id}}"},{prop12:"{{eVar12}}"},{eVar69:"cookie"}]},house_ad_impression:{callType:"tl",linkName:"House Ad Impressions",setters:[{eVar17:"{{this.attr(data-da-channel)}}|{{this.attr(data-da-language)}}|{{this.attr(data-da-campaign)}}|{{this.attr(data-da-placement)}}|{{this.attr(data-da-content)}}"},{prop17:"{{eVar17}}"},{events:"event10"},{eVar12:"{{aws-target-visitor-id}}"},{prop12:"{{eVar12}}"},{eVar5:"{{this.attr(data-da-trk)}}"},{prop30:"{{eVar5}}"},{eVar69:"cookie"},{eVar97:"{{eVar97}}"},{prop97:"{{eVar97}}"}]},house_ad_click:{callType:"tl",linkName:"House Ad Clicks",setters:[{eVar18:"{{this.attr(data-da-channel)}}|{{this.attr(data-da-language)}}|{{this.attr(data-da-campaign)}}|{{this.attr(data-da-placement)}}|{{this.attr(data-da-content)}}"},{prop18:"{{eVar18}}"},{eVar60:"{{eVar18}}"},{prop60:"{{eVar18}}"},{events:"event12"},{eVar24:"{{this.attr(data-da-channel)}}"},{prop24:"{{eVar24}}"},{eVar56:"{{this.attr(data-da-campaign)}}"},{prop56:"{{eVar56}}"},{eVar58:"{{this.attr(data-da-placement)}}"},{prop58:"{{eVar58}}"},{eVar57:"{{this.attr(data-da-content)}}"},{prop57:"{{eVar57}}"},{eVar15:"{{this.attr(data-da-language)}}"},{prop15:"{{eVar15}}"},{eVar12:"{{aws-target-visitor-id}}"},{prop12:"{{eVar12}}"},{eVar5:"{{this.attr(data-da-trk)}}"},{prop30:"{{eVar5}}"},{eVar69:"cookie"},{eVar97:"{{eVar97}}"},{prop97:"{{eVar97}}"}]},psf_search:{callType:"tl",linkName:"PSF Search",setters:[{eVar4:"{{this.attr(data-da-search-term)}}|{{this.attr(data-da-shortLanguage)}}|{{this.attr(data-da-result-count)}}"},{prop4:"{{eVar4}}"},{events:"event16"},{eVar69:"cookie"}]},psf_search_no_results:{callType:"tl",linkName:"PSF Search No Results",setters:[{eVar4:"{{this.attr(data-da-search-term)}}|{{this.attr(data-da-shortLanguage)}}|{{this.attr(data-da-result-count)}}"},{prop4:"{{eVar4}}"},{events:"event17"},{eVar69:"cookie"}]},site_optimization_impression:{callType:"tl",linkName:"Site Optimization Impressions",setters:[{eVar6:"{{this.attr(data-da-type)}}|{{this.attr(data-da-so-category)}}|{{this.attr(data-da-so-language)}}|{{this.attr(data-da-so-name)}}|{{this.attr(data-da-so-type)}}|{{this.attr(data-da-so-version)}}|{{this.attr(data-da-so-url)}}"},{prop64:"{{eVar6}}"},{events:"event14"},{eVar12:"{{aws-target-visitor-id}}"},{prop12:"{{eVar12}}"},{eVar5:"{{this.attr(data-da-so-trk)}}"},{prop30:"{{eVar5}}"},{eVar69:"cookie"},{eVar97:"{{eVar97}}"},{prop97:"{{eVar97}}"}]},site_optimization_click:{callType:"tl",linkName:"Site Optimization Clicks",setters:[{eVar7:"{{this.attr(data-da-type)}}|{{this.attr(data-da-so-category)}}|{{this.attr(data-da-so-language)}}|{{this.attr(data-da-so-name)}}|{{this.attr(data-da-so-type)}}|{{this.attr(data-da-so-version)}}|{{this.attr(data-da-so-url)}}"},{prop35:"{{eVar7}}"},{events:"event15"},{eVar24:"{{this.attr(data-da-type)}}"},{prop24:"{{eVar24}}"},{eVar15:"{{this.attr(data-da-so-language)}}"},{prop15:"{{eVar15}}"},{eVar56:"{{this.attr(data-da-so-name)}}"},{prop56:"{{eVar56}}"},{eVar58:"{{this.attr(data-da-so-category)}}_{{this.attr(data-da-so-type)}}"},{prop58:"{{eVar58}}"},{eVar57:"{{this.attr(data-da-so-version)}}"},{prop57:"{{eVar57}}"},{eVar14:"{{this.attr(data-da-so-url)}}"},{prop14:"{{eVar14}}"},{eVar12:"{{aws-target-visitor-id}}"},{prop12:"{{eVar12}}"},{eVar5:"{{this.attr(data-da-so-trk)}}"},{prop30:"{{eVar5}}"},{eVar69:"cookie"},{eVar97:"{{eVar97}}"},{prop97:"{{eVar97}}"}]}},events:[{trigger:"viewport",selector:'.data-attr-wrapper[data-da-type="ha"]:not(div[data-da*="ignore-standard-impression"] .data-attr-wrapper)',ruleSet:"house_ad_impression",optionSet:"IAB_standard_impression"},{trigger:"click",selector:'.data-attr-wrapper[data-da-type="ha"]',notSelector:'a[data-da="carousel-cta-box-cta-button"],a[data-da="vertical-buybox-cta-button"]',explicitUrlAttr:"data-wrapper-url",ruleSet:"house_ad_click"},{trigger:"viewport",selector:'.data-attr-wrapper[data-da-type="so"]:not(div[data-da*="ignore-standard-impression"] .data-attr-wrapper)',ruleSet:"site_optimization_impression",optionSet:"immediate_impression"},{trigger:"click",selector:'.data-attr-wrapper[data-da-type="so"]',ruleSet:"site_optimization_click"},{trigger:"custom",customEventName:"custom_awspsf_search",selector:'.data-attr-wrapper[data-da-type="psf"]',ruleSet:"psf_search"},{trigger:"custom",customEventName:"custom_awspsf_search_no_results",selector:'.data-attr-wrapper[data-da-type="psf-no-results"]',ruleSet:"psf_search_no_results"},{trigger:"pageBottom",ruleSet:"sitewide_page_load"}],viewportTriggerEvents:["custom_lb-comp-content-container_reveal"],optionSets:{immediate_impression:{viewTime:0,viewPercentage:0},IAB_standard_impression:{viewTime:1e3,viewPercentage:50}},aspects:{"aws-target-visitor-id":{type:"cookie",name:"aws-target-visitor-id",defaultValue:"",resolveTime:"pageBottom"}}},function(){"use strict";"object"==typeof window&&"object"==typeof window.document&&(window.console||(console={log:function(){}}));var e=function(){var e,i={info:{warn:!0,error:!0},warn:{error:!0},error:{},debug:{info:!0,warn:!0,error:!0}};function t(e,t){this.namespace=e,this.logLevel=t||this.getLogLevelByQueryString(),this.validateLogLevel()}for(e in t.prototype={getLogLevelByQueryString:function(){var e,e=(e=(e="debug"+this.namespace).replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),null===(e=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search))?"":decodeURIComponent(e[1].replace(/\+/g," ")));return""===e?null:e},validateLogLevel:function(){if(null!==this.logLevel){var e,t=!1;for(e in i)if(i.hasOwnProperty(e)&&this.logLevel===e){t=!0;break}if(t)return!0;throw new Error("DA: Invalid log level")}}},i)i.hasOwnProperty(e)&&function(r){t.prototype[r]=function(){var e,t;null!==this.logLevel&&(r!==this.logLevel&&!i[this.logLevel].hasOwnProperty(r)||(e=Array.prototype.slice.call(arguments),t="["+r+"] AWS."+this.namespace+": "+e[0],console.log.apply(console,[t].concat(e.slice(1)))))}}(e);return t}();AWS.DA.Logger=e}(),function(){"use strict";var e={_DA:{debounceWindowEvent:function(t,e,r,i){var n=i||this,a=0;$(window).on(e,function(){var e=++a;window.setTimeout(function(){e===a&&t.call(n)},r)})},flattenArrayOfObjects:function(e){for(var t={},r=0,i=e.length;r<i;r++){var n,a=e[r];for(n in a)a.hasOwnProperty(n)&&(t[n]=a[n])}return t},getRandomKey:function(){return(new Date).getTime()+Math.floor(999999*Math.random())},generateUUID:function(){var r=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"===e?t:3&t|8).toString(16)})}}};AWS.DA._DA=e._DA}(),function(){"use strict";var e={ElementUtils:{isInViewport:function(e,t,r,i,n,a,o,s){if((a<0||100<a)&&o.error("Invalid range for 'viewPercentage'"),"hidden"===e.css("visibility"))return!1;var l=(s=s||$(window)).scrollTop(),c=l+s.height(),d=0+s.width(),o=t+n,e=r+i,s=t+n*a/100,n=t+n-n*a/100,a=r+80*i/100,i=r+i-80*i/100;return(l<=s&&s<=c&&l<=t&&t<=c||l<=n&&n<=c&&l<=o&&o<=c||t<=l&&c<=o)&&(0<=a&&a<=d&&0<=r&&r<=d||0<=i&&i<=d&&0<=e&&e<=d||r<=0&&d<=e)},isReportableLink:function(e){return null!=e&&""!==e&&!/^(\#$|javascript)/.test(e)},findSignificantInnerHeight:function(e,t){void 0===t&&(t=0);var r=e.outerHeight();if(5<=t)return r;if(0!==r)return r;for(var i=e.children(),n=[],a=0,o=i.length;a<o;a++)n[n.length]=this.findSignificantInnerHeight.call(this,$(i[a]),t+1);var s=0;for(a=0,o=n.length;a<o;a++)s=s>n[a]?s:n[a];return s},isElemVisible:function(e){var t,r=null,i=null,n=window.getComputedStyle(e);if(i="none"!==n.transform?(r=(t=e.getBoundingClientRect()).width,t.height):(r=e.offsetWidth,e.offsetHeight),0===r||0===i&&e.firstElementChild||"hidden"===n.visibility)return!1;for(var a=e;a&&"BODY"!==a.tagName;){var o=window.getComputedStyle(a),s="hidden"===o.overflow&&("0px"===o.maxHeight||"0px"===o.height),l="hidden"===o.overflow&&("0px"===o.maxWidth||"0px"===o.width);if("none"===o.display||"0"===o.opacity||s||l)return!1;a=a.parentNode}return!0}}};AWS.DA.ElementUtils=e.ElementUtils}(),function(){"use strict";var e={EventUtils:{elementEventStore:{},nonElementEventRegistry:{},setElementEventRelationship:function(e,t){e=this.setElementId(e);return!!this.hasElementEventRelationship(e,t)||(this.saveElementEventRelationship(e,t),!1)},setElementId:function(e){var t=e.data("daElemId");return void 0===t&&(t=AWS.DA._DA.generateUUID(),e.attr("data-da-elem-id",t)),t},saveElementEventRelationship:function(e,t){e in this.elementEventStore||(this.elementEventStore[e]={}),this.elementEventStore[e][t._id]=t},hasElementEventRelationship:function(e,t){return e in this.elementEventStore&&t._id in this.elementEventStore[e]},registerNonElementEvent:function(e){this.nonElementEventRegistry[e._id]=e},isNonElementEventRegistered:function(e){return e._id in this.nonElementEventRegistry},getElementEventMessage:function(e,t){return JSON.stringify({trigger:t.trigger,ruleSetKey:t.ruleSet.key,eventId:t._id,className:e[0].className,elemData:e.data()})},isRightClick:function(e){return 3===e.which}}};AWS.DA.EventUtils=e.EventUtils}(),function(){"use strict";var l,e={Decorators:{}};l={},e.Decorators.noRepeatData=function(e,t,r){var i,n,a="noRepeatData",o=$.Deferred();t.parents(".carousel-item").length?"object"==typeof(n=$.extend({},t.data()))&&(delete n.daElemId,i=JSON.stringify(n)):i=t.data("daElemId");var e={elemId:i,eventId:e._id},s=JSON.stringify(e);return l.hasOwnProperty(s)?(r.info("FAIL condition: "+a),o.reject()):(r.info("PASS condition: "+a),o.resolve(function(){l[s]=!0,r.debug("Registered noRepeat signature: "+s)})),o},e.Decorators.inViewport=function(e,t,r,i){var n="inViewport",a=$.Deferred(),o=t.offset().top,s=t.offset().left,l=t.outerWidth(),c=AWS.DA.ElementUtils.findSignificantInnerHeight(t);return"number"!=typeof i.viewPercentage&&(i.viewPercentage=50),"number"!=typeof i.viewTime&&(i.viewTime=1e3),AWS.DA.ElementUtils.isInViewport(t,o,s,l,c,i.viewPercentage,r)?(r.debug("Elem in viewport"),setTimeout(function(){o=t.offset().top,s=t.offset().left,AWS.DA.ElementUtils.isInViewport(t,o,s,l,c,i.viewPercentage,r)?(r.info("Elem reached view time"),r.info("PASS condition: "+n),a.resolve()):(r.info("Elem left viewport"),r.info("FAIL condition: "+n),a.reject())},i.viewTime)):(r.info("FAIL condition: "+n),a.reject()),a},AWS.DA.Decorators=e.Decorators}(),function(){"use strict";var e={};e.Validator={validSetterKeyRegexp:new RegExp("^(eVar[0-9]{1,2}|prop[0-9]{1,2}|event[0-9]{1,2}|events)$"),validSVarRegexp:new RegExp("^(eVar[0-9]{1,2}|prop[0-9]{1,2}|event[0-9]{1,2}|events)$"),validLinkTrackVarListItemRegexp:new RegExp("^(eVar[0-9]{1,2}|prop[0-9]{1,2})$"),isValidSetterKey:function(e){return this.validSetterKeyRegexp.test(e)},isValidSVar:function(e){return this.validSVarRegexp.test(e)},isValidLinkTrackVarListItem:function(e){return this.validLinkTrackVarListItemRegexp.test(e)},validateSetters:function(e,t){if(!Array.isArray(e))throw new Error("DA: 'setters' in ruleSet '"+t+"' must be an array");for(var r=0,i=e.length;r<i;r++)this.validateSetter(e[r],t)},validateSetter:function(e,t){var r,i=0;for(r in e)if(1<++i)throw new Error("DA: More than 1 key in setter in ruleSet '"+t+"'");if(!e.hasOwnProperty(r))throw new Error("DA: setter in ruleSet '"+t+"' does not have any keys of its own");if(!this.isValidSetterKey(r))throw new Error("DA: Invalid setter key '"+r+"' in ruleSet '"+t+"'")}},AWS.DA.Validator=e.Validator}(),function(){"use strict";var e={},a="o";e.Controller={logic:{},viewportQueue:{},trackerVarName:"s",consentStatusVarName:"eVar69",trackerCookieName:"s_fid",isScrollWatchInitialized:!1,resolvedAspects:{},validator:null,logger:null,loadEventRegistry:{documentReady:!1,pageBottom:!1,layoutReadyForViewportEvents:!1},resolvedEvents:[],init:function(e,t){aws_sc&&(this.validator=e,this.logger=t,this.listenForLoadEvents(),this.readExistingLogic(),this.listenForNewContent(),this.listenToViewportTriggerEvents(),this.processLogic(),this.loadEventRegistry.pageBottom=!0)},listenForLoadEvents:function(){var e=this;$(document).ready(function(){e.loadEventRegistry.documentReady=!0,e.logger.info("Saw document ready")})},readExistingLogic:function(){"object"==typeof AWS.DA.Logic?(this.logic=$.extend(!0,{},AWS.DA.Logic),this.logger.debug("Logic: "+JSON.stringify(this.logic))):this.logger.error("No logic to read")},updateLogic:function(e){this.logic=$.extend(!0,{},e),this.logger.debug("Logic: "+JSON.stringify(this.logic))},listenForNewContent:function(){var t=this,r=0;$(document).on("custom_aws_da_new-content",function(){var e=++r;setTimeout(function(){e===r&&(t.logger.info("Saw new content event"),t.processAspects(),t.processEvents())},200)})},listenToViewportTriggerEvents:function(){var t;this.logic.viewportTriggerEvents&&(t=this).logic.viewportTriggerEvents.forEach(function(e){$(document).on(e,function(){t.logger.info("Saw viewportTriggerEvent: "+e),t.processViewportQueue()})})},processLogic:function(){this.processAspects(),this.processEvents(),this.processFunctions()},processAspects:function(){if(this.logic.hasOwnProperty("aspects"))for(var e in this.logic.aspects)this.logic.aspects.hasOwnProperty(e)&&this.resolveAspect(e,this.logic.aspects[e])},resolveAspect:function(e,t){function r(){i.resolvedAspects[e]=i[{cookie:"resolveCookie",css:"resolveCSSAspect"}[t.type]](t)}var i=this;switch(t.resolveTime){case"dynamic":r();break;case"pageBottom":!1===this.loadEventRegistry.pageBottom&&r()}},resolveCookie:function(e){var t;return t=void 0===(t=aws_sc.CookieConsent.hasConsent(e.name)?$.cookie(e.name):t)||""===t?e.defaultValue:t},resolveCSSAspect:function(e){var t=$(e.selector),t=t.length?t.attr(e.attribute):e.defaultValue;return t=void 0===t||""===t?e.defaultValue:t},buildEvents:function(){for(var e=[],t=0,r=this.logic.events.length;t<r;t++){var i=$.extend(!0,{},this.logic.events[t]),n=i.ruleSet;i.ruleSet=$.extend(!0,{},this.logic.ruleSets[n]),i.ruleSet.key=n,i.hasOwnProperty("optionSet")&&(n=i.optionSet,n=$.extend(!0,{},this.logic.optionSets[n]),i.hasOwnProperty("options")?i.options=$.extend({},n,i.options):i.options=n),i._id=AWS.DA._DA.generateUUID(),e.push(i)}return e},processEvents:function(){if(this.logic.hasOwnProperty("events")){this.logic.events.length!==this.resolvedEvents.length&&(this.resolvedEvents=this.buildEvents());for(var e=0,t=this.resolvedEvents.length;e<t;e++){var r=this.resolvedEvents[e];this.setupEvent(r)}}},processFunctions:function(){if(this.logic.hasOwnProperty("functions"))for(var e=0,t=this.logic.functions.length;e<t;e++){var r=this.logic.functions[e],i=this.logic.functions[e].ruleSet;r.ruleSet=$.extend(!0,{},this.logic.ruleSets[i]),r.ruleSet.key=i,this.createCustomFunction(r)}},setupEvent:function(e){switch(e.trigger){case"click":this.setupSelectorBoundEvent(e);break;case"viewport":this.setupViewportEvent(e);break;case"pageBottom":this.setupImmediateEvent(e);break;case"custom":this.setupCustomEvent(e)}},setupImmediateEvent:function(e){AWS.DA.EventUtils.isNonElementEventRegistered(e)?this.logger.info("Did not re-execute event: "+JSON.stringify({trigger:e.trigger,ruleSetKey:e.ruleSet.key,eventId:e._id})):(AWS.DA.EventUtils.registerNonElementEvent(e),this.logger.info("Preprocess event: "+JSON.stringify({trigger:e.trigger,ruleSetKey:e.ruleSet.key,eventId:e._id})),(e=$.extend(!0,{},e.ruleSet)).setters=this.preprocessSetters(e.setters),this.processRuleSet(e))},setupSelectorBoundEvent:function(r){for(var i=this,n=$(r.selector),e=0,t=n.length;e<t;e++)!function(e){var t,e=$(n[e]);AWS.DA.EventUtils.setElementEventRelationship(e,r)?i.logger.info("Did not rebind event: "+AWS.DA.EventUtils.getElementEventMessage(e,r)):(this.logger.info("Preprocess event: "+AWS.DA.EventUtils.getElementEventMessage(e,r)),(t=$.extend(!0,{},r.ruleSet)).setters=this.preprocessSetters(t.setters,e),"click"===r.trigger&&this.setClickHandler(e,r.notSelector,r.explicitUrlAttr,function(){i.processRuleSet(t)}))}.call(this,e)},setupViewportEvent:function(r){for(var i=this,n=$(r.selector),e=0,t=n.length;e<t;e++)!function(e){var t,e=$(n[e]);AWS.DA.EventUtils.setElementEventRelationship(e,r)?i.logger.info("Did not rebind event: "+AWS.DA.EventUtils.getElementEventMessage(e,r)):(i.logger.info("Preprocess event: "+AWS.DA.EventUtils.getElementEventMessage(e,r)),(t=$.extend(!0,{},r.ruleSet)).setters=this.preprocessSetters(t.setters,e),this.viewportQueue[AWS.DA._DA.getRandomKey()]={$elem:e,locked:!1,viewTime:r.options.viewTime,viewPercentage:r.options.viewPercentage,fct:function(){i.processRuleSet(t)}})}.call(this,e);this.isScrollWatchInitialized||this.watchScroll(),$(document).ready(function(){setTimeout(function(){i.loadEventRegistry.layoutReadyForViewportEvents=!0,i.processViewportQueue()},800)})},setupCustomEvent:function(r){var i=this;AWS.DA.EventUtils.setElementEventRelationship($("body"),r)||$(document).on(r.customEventName,function(e){i.logger.info("Saw event: "+r.customEventName);var t,e=$(e.target).find(r.selector).addBack(r.selector);e.length&&(AWS.DA.EventUtils.setElementEventRelationship(e,r),i.logger.info("Preprocess event: "+AWS.DA.EventUtils.getElementEventMessage(e,r)),(t=$.extend(!0,{},r.ruleSet)).setters=i.preprocessSetters(t.setters,e),i.runConditionChain(r,e,function(){i.processRuleSet(t)}))})},runConditionChain:function(e,t,r){this.logger.debug("Test conditions"),"object"!=typeof e.decorators&&(e.decorators=[]);for(var i,n,a,o,s,l=[],c=0,d=e.decorators.length;c<d;c++)l[l.length]=(i=e.decorators[c],n=e,a=t,o=this.logger,s=e.options,o.info("Test condition: "+i),AWS.DA.Decorators[i](n,a,o,s));$.when.apply(this,l).done(function(){for(var e=0,t=arguments.length;e<t;e++)"function"==typeof arguments[e]&&arguments[e]();r()}).fail(function(){for(var e=0,t=arguments.length;e<t;e++)"function"==typeof arguments[e]&&arguments[e]()})},createCustomFunction:function(r){"object"!=typeof AWS.DA.fct&&(AWS.DA.fct={});var i=this;AWS.DA.fct[r.name]=function(e){var t;void 0!==e&&e instanceof jQuery&&e.length?(this.logger.info("Execute function: "+JSON.stringify({name:r.name,ruleSetKey:r.ruleSet.key,elem:e[0].toString(),className:e[0].className})),(t=$.extend(!0,{},r.ruleSet)).setters=i.preprocessSetters(t.setters,e),i.processRuleSet(t)):this.logger.error("Invalid or empty jQuery element passed to function: "+r.name)}},setClickHandler:function(n,i,a,o){function s(e,t){var r=!1;(r=void 0!==i?$.contains(n[0],e.closest(i)[0]):r)?l.logger.debug("Link within notSelector"):(l.logger.debug("Link within element"),t=e.attr(t),AWS.DA.ElementUtils.isReportableLink(t)&&(l.logger.info("Report click"),o()))}var l=this,c=!1;n.on("click.aws-da, mouseup.aws-da",function(e){var t,r,i;AWS.DA.EventUtils.isRightClick(e)||c||(l.logger.debug("Clicked element"),c=!0,setTimeout(function(){c=!1},500),t=$(e.target).closest("a"),r=$.contains(n[0],t[0]),i=n.is(t),r||i?s(t,"href"):(e=$(e.target).closest("["+a+"]"),n.is(e)&&s(e,a)))})},preprocessSetters:function(e,t){return e=this.resolveSetterLogic(e,t),e=this.syncSetters(e)},processRuleSet:function(e){this.logger.info("Process ruleSet: "+e.key),e.setters=this.processSetters(e.setters),"tl"===e.callType?this.callLinkTrack(e.setters,e.callType,e.linkName):"setVars"===e.callType&&this.setSVars(e.setters)},resolveSetterLogic:function(e,t){this.logger.info("Resolve setter logic");for(var r={},i=0,n=(e=$.extend(!0,[],e)).length;i<n;i++){var a,o=e[i];for(a in o)if(o.hasOwnProperty(a))break;for(var s,l,c=o[a],d=this.findDynamicBlocksInSetter(c),p=d.pop();p;)r.hasOwnProperty(p[2])?c=c.substr(0,p[0])+r[p[2]]+c.substr(p[1]+1):null!==(s=p[2].match(/^this.attr\((.*?)\)$/))&&1<s.length&&void 0!==t?(l=s[s.length-1],void 0===(l=t.attr(l))&&(l=""),r[p[2]]=l,c=c.substr(0,p[0])+l+c.substr(p[1]+1)):this.resolvedAspects.hasOwnProperty(p[2])&&(void 0===(l=this.resolvedAspects[p[2]])&&(l=""),r[p[2]]=l,c=c.substr(0,p[0])+l+c.substr(p[1]+1)),p=d.pop();o[a]=c,this.logger.debug("'"+a+"' after replacement: "+c)}return this.logger.debug("Logic-resolved setters: "+JSON.stringify(e)),e},syncSetters:function(e,t,r){e=$.extend(!0,[],e),void 0===t&&(t={}),this.logger.debug("Sync setters at level: "+(r=void 0===r?0:r));for(var i=!1,n=!1,a=0,o=e.length;a<o;a++){var s,l=e[a];for(s in l)if(l.hasOwnProperty(s))break;var c=l[s],d=this.findDynamicBlocksInSetter(c);if(0===d.length)t.hasOwnProperty(s)||(t[s]=c,i=!0,this.logger.debug("'"+s+"' resolved to: "+c));else for(var p,n=!0,g=d.pop();g;)this.validator.isValidSVar(g[2])&&t.hasOwnProperty(g[2])&&(p=t[g[2]],c=c.substr(0,g[0])+p+c.substr(g[1]+1),i=!0,this.logger.debug("'"+s+"' after replacement: "+c)),g=d.pop();l[s]=c}return i&&n?this.syncSetters.call(this,e,t,r+1):(this.logger.info("Synced setters: "+JSON.stringify(e)),e)},processSetters:function(e){for(var t={},r=0,i=(e=$.extend(!0,[],e)).length;r<i;r++){var n,a=e[r];for(n in a)if(a.hasOwnProperty(n))break;for(var o,s=a[n],l=this.findDynamicBlocksInSetter(s),c=l.pop();c;)this.validator.isValidSVar(c[2])&&(o="",t.hasOwnProperty(c[2])?o=t[c[2]]:window[this.trackerVarName].hasOwnProperty(c[2])?(o=window[this.trackerVarName][c[2]],t[c[2]]=o):(t[c[2]]=o="",this.logger.warn("Could not resolve dynamic value: "+c[2])),s=s.substr(0,c[0])+o+s.substr(c[1]+1)),c=l.pop();t[n]=s,a[n]=s,this.logger.debug("'"+n+"' after replacement: "+s)}return e=AWS.DA._DA.flattenArrayOfObjects(e),this.logger.info("Fully-processed setters: "+JSON.stringify(e)),e},findDynamicBlocksInSetter:function(e){for(var t=[],r="",i=!1,n="",a=0,o=0,s=e.length;o<s;o++){var l=e.charAt(o);l===n&&("{"===l?(i=!0,a=o-1):"}"===l&&(i=!1,t[t.length]=[a,o,r.substring(1,r.length-1)],r="")),i&&(r+=l),n=l}return t},setSVars:function(e){for(var t in this.logger.info("Set s-vars: "+JSON.stringify(e)),e)e.hasOwnProperty(t)&&this.validator.isValidSVar(t)&&(window[this.trackerVarName][t]=e[t])},callLinkTrack:function(e,t,r){this.logger.debug("Call linkTrack"),this.setSVars(e);var i,n=this.consentStatusVarName+",";for(i in e)e.hasOwnProperty(i)&&this.validator.isValidLinkTrackVarListItem(i)&&(n+=i+",");n=n.replace(/,$/,""),window[this.trackerVarName].linkTrackVars=n,this.logger.info("linkTrackVars: "+window[this.trackerVarName].linkTrackVars),window[this.trackerVarName].events&&(window[this.trackerVarName].linkTrackEvents=window[this.trackerVarName].events),this.logger.info("linkTrackEvents: "+window[this.trackerVarName].linkTrackEvents),window[this.trackerVarName][t](window[this.trackerVarName],a,r),this.logger.info("Called linkTrack"),window[this.trackerVarName].linkTrackVars="None",window[this.trackerVarName].linkTrackEvents="None"},watchScroll:function(){this.isScrollWatchInitialized=!0,AWS.DA._DA.debounceWindowEvent(function(){this.processViewportQueue()},"scroll",40,this)},processViewportQueue:function(){if(this.loadEventRegistry.layoutReadyForViewportEvents){this.logger.info("Process viewport queue");var e,i=$(window);for(e in this.viewportQueue)this.viewportQueue.hasOwnProperty(e)&&!function(e){var t,r=this.viewportQueue[e];r.$elem.closest("body").length?!r.locked&&AWS.DA.ElementUtils.isElemVisible(r.$elem[0])&&(r.top=r.$elem.offset().top,r.left=r.$elem.offset().left,r.width=r.$elem.outerWidth(),r.height=AWS.DA.ElementUtils.findSignificantInnerHeight(r.$elem),AWS.DA.ElementUtils.isInViewport(r.$elem,r.top,r.left,r.width,r.height,r.viewPercentage,this.logger,i)&&(this.viewportQueue[e].locked=!0,this.logger.info("Elem in viewport"),t=this,setTimeout(function(){t.viewportQueue.hasOwnProperty(e)&&(r.top=r.$elem.offset().top,r.left=r.$elem.offset().left,AWS.DA.ElementUtils.isInViewport(r.$elem,r.top,r.left,r.width,r.height,r.viewPercentage,t.logger)?(t.logger.info("Elem reached view time"),r.fct(),delete t.viewportQueue[e]):(t.viewportQueue[e].locked=!1,t.logger.info("Elem left viewport")))},r.viewTime))):delete this.viewportQueue[e]}.call(this,e)}}},aws_sc&&aws_sc.initialized?e.Controller.init(AWS.DA.Validator,new AWS.DA.Logger("DA")):$(document).on("custom_aws_s_code-loaded",function(){e.Controller.init(AWS.DA.Validator,new AWS.DA.Logger("DA"))}),AWS.DA.Controller=e.Controller}();
