EBG=EBG||{},EBG.Adaptors=EBG.Adaptors||{},EBG.Adaptors.TCFDetector=function(t){this.init(t)},EBG.Adaptors.TCFDetector.prototype={exists:!1,initialized:!1,subscriptions:[],_time:-1,_timeoutActualTime:-1,__tcfapi:function(){window.__tcfapi.apply(window,arguments)},init:function(e){var a=this;if(e=e||{timeout:300,accurateTimeout:0},window.__tcfapi&&"function"==typeof window.__tcfapi?this.exists=!0:this._detectTCFLocator(),!this.exists)return this._setReason(0),void this._setDefaultValue();setTimeout(function(){var t=arguments.callee;if(a._timeoutActualTime=(new Date).getTime()-a._startTime,e.accurateTimeout&&(e.accurateTimeout--,a._timeoutActualTime<e.timeout))return a._timeoutTimeGap||(a._timeoutTimeGap=e.timeout-a._timeoutActualTime),void setTimeout(function(){t.apply(a,[])},Math.max(e.timeout-a._timeoutActualTime,1));a.cmpCheckTimedout=!0,void 0===a.consentData&&(a._setReason(-1),a._setDefaultValue(),a._publishConsentData())},e.timeout),this._startTime=(new Date).getTime();try{!function(){var i=arguments.callee;a.__tcfapi("ping",2,function(t,e){(void 0===e||e)&&t&&t.cmpLoaded?(a.initialized=!0,a._getConsentData(function(t){a.handleConsentReceived(t)})):a.cmpCheckTimedout||setTimeout(function(){i.apply(a,[])},5)})}()}catch(t){a._setDefaultValue(),a._publishConsentData()}},_detectTCFLocator:function(){for(var c,t=window,u={};t;){try{if(t.frames.__tcfapiLocator){c=t;break}}catch(t){}if(t===window.top)break;t=t.parent}c&&(this.exists=!0,this.__tcfapi=function(t,e,i,a){var n,s,o;c?(n=Math.random()+"",s={__tcfapiCall:{command:t,parameter:a,version:e,callId:n}},u[n]=i,c.postMessage(s,"*"),o=setInterval(function(){u[n]?c.postMessage(s,"*"):clearInterval(o)},20)):i({msg:"CMP not found"},!1)},window.addEventListener("message",function(t){var e={};try{e="string"==typeof t.data?JSON.parse(t.data):t.data}catch(t){}(e=e.__tcfapiReturn)&&"function"==typeof u[e.callId]&&(u[e.callId](e.returnValue,e.success),u[e.callId]=null)},!1))},handleConsentReceived:function(t){this._time=(new Date).getTime()-this._startTime,void 0===this.consentData&&(t&&"number"==typeof t.gdprApplies&&(t.gdprApplies=t.gdprApplies+""),this.consentData={gdprApplies:t.gdprApplies,consentData:t.tcString},this._publishConsentData())},_getConsentData:function(e){function a(t){i||(i=!0,n._setReason(1),e.apply(n,[t]))}var n=this,i=!1;try{!function(){n.exists&&n.initialized&&!n.cmpCheckTimedout&&(n.__tcfapi("addEventListener",2,function(t,e){e&&t.tcString&&("tcloaded"==t.eventStatus||"useractioncomplete"==t.eventStatus)&&(a(t),t.listenerId&&n.__tcfapi("removeEventListener",2,function(){},t.listenerId))}),function(){var i=arguments.callee;try{n.__tcfapi("getTCData",2,function(t,e){e&&t.tcString?a(t):n.cmpCheckTimedout||setTimeout(function(){i.apply(n,[])},5)})}catch(t){n.cmpCheckTimedout||setTimeout(function(){i.apply(n,[])},5)}}())}()}catch(t){n._setReason(2),e.apply(n,[null])}},getConsentData:function(t,e){void 0!==this.consentData?t.apply(e,[this.consentData]):this.subscriptions.push({callback:t,context:e||this})},_setDefaultValue:function(){this.initialized=!0,this.consentData=this.defaultConsentData},_publishConsentData:function(){if(void 0!==this.consentData){for(var t=0;t<this.subscriptions.length;t++){var e=this.subscriptions[t];try{e.callback.apply(e.context,[this.consentData])}catch(t){}}this.subscriptions=[]}},_setReason:function(t){void 0===this._reason&&(this._reason=t)},defaultConsentData:null};
