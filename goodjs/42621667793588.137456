"undefined"!=typeof window&&function(f,p){"use strict";var h,v,s,u,i,T,l,S,w,A,r,e,F,C,P,E,N,R,y,Y,c,b,a,M,n,d,g,m;function x(){var e,t,r,n,o,i,a=[],s=[];for(a.push((n=h.timing,o=h.getEntries("resource")[0],{url:p.location.href,start:0,transferSize:o&&void 0!==o.transferSize?o.transferSize:-1,duration:n.responseEnd-n.navigationStart,durationFromNStart:n.responseEnd-n.navigationStart,redirectStart:0===n.redirectStart?0:n.redirectStart-n.navigationStart,redirectDuration:n.redirectEnd-n.redirectStart,appCacheStart:0,appCacheDuration:0,dnsStart:n.domainLookupStart-n.navigationStart,dnsDuration:n.domainLookupEnd-n.domainLookupStart,tcpStart:n.connectStart-n.navigationStart,tcpDuration:n.connectEnd-n.connectStart,sslStart:0<n.secureConnectionStart?n.secureConnectionStart-n.connectStart:0,sslDuration:0<n.secureConnectionStart?n.connectEnd-n.secureConnectionStart:-1,requestStart:n.requestStart-n.navigationStart,requestDuration:n.responseStart-n.requestStart,responseStart:n.responseStart-n.navigationStart,responseDuration:n.responseEnd-n.responseStart})),s=h.getEntriesByType("resource"),e=0;e<s.length;e+=1)"document"!==s[e].name&&a.push(O(s[e]));if((r=document.getElementsByTagName("iframe"))&&r.length){for(t=0;t<r.length;t+=1)try{for(s=r[t].contentWindow.performance.getEntriesByType("resource"),i=r[t].contentWindow.performance.timing.navigationStart-h.timing.navigationStart,e=0;e<s.length;e+=1)"document"!==s[e].name&&a.push(O(s[e],i))}catch(e){}a.sort(function(e,t){return e.start-t.start})}return a}function O(e,t){return{url:e.name,start:e.startTime+(t=!(t&&0<t)?0:t),duration:e.duration,transferSize:e&&void 0!==e.transferSize?e.transferSize:-1,durationFromNStart:0<e.duration?e.duration+e.startTime+t:e.startTime+t,redirectStart:e.redirectStart+t,redirectDuration:e.redirectEnd-e.redirectStart,appCacheStart:0,appCacheDuration:0,dnsStart:e.domainLookupStart+t,dnsDuration:e.domainLookupEnd-e.domainLookupStart,tcpStart:e.connectStart+t,tcpDuration:e.connectEnd-e.connectStart,sslStart:0<e.secureConnectionStart?e.secureConnectionStart-e.connectStart:0,sslDuration:0<e.secureConnectionStart?e.connectEnd-e.secureConnectionStart:-1,requestStart:e.requestStart+t,requestDuration:e.responseStart-e.requestStart,responseStart:e.responseStart+t,responseDuration:0===e.responseStart?0:e.responseEnd-e.responseStart}}function D(){return{win:f,doc:p,docElem:e,viewportWidth:e.clientWidth<f.innerWidth?f.innerWidth:e.clientWidth,viewportHeight:e.clientHeight<f.innerHeight?f.innerHeight:e.clientHeight,getScrollXY:function(){return{x:f.scrollX||f.pageXOffset,y:f.scrollY||f.pageYOffset}},getViewportArea:function(){return this.viewportWidth*this.viewportHeight},getElementBounds:function(e){var t=e,e=this.getScrollXY();return(t=function e(t){var r,n={};for(r in t)"object"==typeof t[r]&&null!==t[r]?n[r]=e(t[r]):n[r]=t[r];return n}(t.getBoundingClientRect())).top=t.top+e.y,t.bottom=t.bottom+e.y,t.left=t.left+e.x,t.right=t.right+e.x,t},isInViewport:function(e,t){var r=this.getElementBounds(e);return r.top<this.viewportHeight&&r.left<this.viewportWidth&&0<=r.bottom&&0<=r.right&&this.isVisible(e,t)},isVisible:function(e,t){var r=!0,n=e;if((r=r&&0<n.offsetWidth&&0<n.offsetHeight)&&!t)for(;"BODY"!==n.tagName&&r;)r=r&&"hidden"!==f.getComputedStyle(n).visibility,n=n.parentElement;return r},getElementCoverage:function(e){var t,r,n=this.getElementBounds(e);return(n=100*(e=(t=n.right<0?0:n.right>this.viewportWidth?0<=n.left?this.viewportWidth-n.left:this.viewportWidth:n.left<0&&0<n.right?n.right:n.width)*(r=n.bottom<0?0:n.bottom>this.viewportHeight?0<=n.top?this.viewportHeight-n.top:this.viewportHeight:n.top<0&&0<n.bottom?n.bottom:n.height))/this.getViewportArea())<1&&(n=Math.ceil(n)),{x:t,y:r,elCoverage:e,elCoveragePerc:n}}}}function L(e,t,r){var n,o,i,a,s,u,l=!1,c=[];for(e=e||[],t&&!r?c=t:!t&&r?c=r:t&&r&&(c=t.concat(r)),c&&c.length&&c.length,n=0,s=e.length;n<s;n+=1)for(i=e[n],o=(a=p.querySelectorAll(YAFT.getModuleSelector(i,F.usePrefixRegex))).length-1;0<=o;o--)u=YAFT.getModuleName(a[o]),l=!1,(l=-1!==c.indexOf(u)?!0:l)||y[u]||(a[o].modName=u,y[u]=a[o]);return y}function I(e,t,r,n){var o,i,a,s=0,u=F.adModules||[],l=u.length;for(i in e)e.hasOwnProperty(i)&&(c[i]||(o=B(e[i]),n&&!o.isAft2Module||(c[i]=o)));if(l)for(a in c)if(c.hasOwnProperty(a))for(c[a].isAdModule=!1,s=0;s<l;s+=1)if(-1!==a.search(u[s])){c[a].isAdModule=!0,F.punishAdsOnNoShow&&c[a].loadTime===r&&(c[a].loadTime=h.now()-t-100);break}return c}function B(e,t){var r,n,o,i,a=!1,s=function(e,t){for(var r=!1;t.parentNode;){if(t.parentNode.id&&-1!==e.indexOf(t.parentNode.id)){r=!0;break}t=t.parentNode}return r}(F.modulesAft2Container,e),u=F.customReportModules&&-1!==F.customReportModules.indexOf(e.modName),l=[],c=h.now(),c=s?c-b:c,d=b?M:F.useNativeStartRender?C||YAFT.getStartRenderTime():T?h.timing.domContentLoadedEventStart-A:0,g=u?c:d,m=e.querySelectorAll(F.whiteListedContainerElements.join()),f=m.length;if(t)a=!0,d=t.modStart||d,g=t.modEnd||g,b&&(b<d?d-=b:d=0,b<g?g-=b:g=0);else if(0<b&&!s)g=d=0;else if(u)a=!0;else{if((o=YAFT.getElemResourceUrl(e))&&(i=h.getEntriesByName(o))&&i.length&&0<i.length&&v.isInViewport(e)&&l.push(O(i[0])),m&&0<f)for(r=0;r<f;r+=1)n=m[r],(o=YAFT.getElemResourceUrl(n))&&(i=h.getEntriesByName(o))&&i.length&&0<i.length&&v.isInViewport(n)&&l.push(O(i[0]));if(0<(f=l.length))for(r=0;r<f;r+=1)0<b&&s&&(l[r].start-=b,l[r].durationFromNStart-=b,l[r].start<=0&&(l[r].start=d),l[r].durationFromNStart<=0&&(l[r].durationFromNStart=g)),l[r].start>d&&(d=l[r].start),l[r].durationFromNStart>g&&(g=l[r].durationFromNStart)}return u=v.getElementCoverage(e),{isCustom:a,isAft2Module:s,start:d,loadTime:g,name:e.modName,resources:l,inViewPort:a?v.isInViewport(e,!0):v.isInViewport(e,!1),coverageWidth:u.x,coverageHeight:u.y,coverageArea:u.elCoverage,coveragePercentage:u.elCoveragePerc}}function q(e){var t,r,n=0;for(t in e)e.hasOwnProperty(t)&&(r=e[t].coveragePercentage,e[t].inViewPort&&0<Math.round(r)&&(n+=r));return n}function k(e){for(var t=e.length,r=0;r<t;r+=1)if(F.useNormalizeCoverage){if(Math.round(e[r])===Math.round(E))return 100*r}else if(Math.round(e[r])===Math.round(P))return 100*r;return 0}function W(e,t){for(var r,n=0,o=0,i=h.now()-b,a=Math.floor(i/100),s=new Array(a),u=new Array(a),l=0,c=0;c<a;c+=1)s[c]=0,u[c]=0;for(r in c=0,e)e.hasOwnProperty(r)&&e[r].inViewPort&&0<Math.round(e[r].coveragePercentage)&&(F.useNormalizeCoverage&&(e[r].normCoveragePercentage=e[r].coveragePercentage/P*100,l+=e[r].normCoveragePercentage),0<=e[r].loadTime&&(s[c=Math.round(e[r].loadTime/100)]+=F.useNormalizeCoverage?e[r].normCoveragePercentage:e[r].coveragePercentage,e[r].isAdModule?u[c=Math.round(t/100)]+=F.useNormalizeCoverage?e[r].normCoveragePercentage:e[r].coveragePercentage:u[c]+=F.useNormalizeCoverage?e[r].normCoveragePercentage:e[r].coveragePercentage));for(F.useNormalizeCoverage?(n+=l-s[0],o+=l-u[0]):(n+=P-s[0],o+=P-u[0]),c=1;c<a;c+=1)s[c]=s[c-1]+s[c],u[c]=u[c-1]+u[c],F.useNormalizeCoverage?(n+=l-s[c],o+=l-u[c]):(n+=P-s[c],o+=P-u[c]);return{aft:n,aftNoAd:o,aftIntervals:s,normTotalCoveragePercentage:l}}function t(){m.push(h.now()),g&&m.length<300&&(u=f.requestAnimationFrame(t))}function o(e,t){var r,n,o,i,a,s=YAFT.getPageLoadTime(),u=YAFT.getDomContentLoaded(),l=YAFT.getDomElementsCount(),c=YAFT.getTTFB(),d=YAFT.getDomInteractive(),g=[],m=[];if(C=YAFT.getStartRenderTime(),(R=x())&&R.length&&0<R.length){if(F.preProcess&&"function"==typeof F.preProcess&&F.preProcess(),F.plugins)for(i=0;i<F.plugins.length;i+=1)window["yaft_"+F.plugins[i].name]&&window["yaft_"+F.plugins[i].name].execute?F.plugins[i].isPre?(g.push(F.plugins[i]),YAFT.logToConsole("YAFT plugin "+F.plugins[i].name+" will be executed before the callback")):(m.push(F.plugins[i]),YAFT.logToConsole("YAFT plugin "+F.plugins[i].name+" will be executed after the callback")):YAFT.logToConsole("YAFT plugin "+F.plugins[i].name+" not found or it does not have execute method");for(v=v||D(),L(F.modules,F.modulesExclude,F.modulesAft2Container),I(y,0,C),o=YAFT.getFinalModulesReport(),P=q(o),n=W(o,C),E=n.normTotalCoveragePercentage,(a=R.slice(0)).sort(function(e,t){return t.duration-e.duration}),a=function(e){var t={},r=0,n=0,o=YAFT.getPageLoadTime(),i=0,a=0;for(t.count=e.length,r=0;r<t.count;r+=1)e[r].start<=o&&(i+=1),e[r].duration<=0&&(n+=1,e[r].start<=o&&(a+=1));return t.cached=n,t.nonCached=t.count-n,t.onloadCount=i,t.onloadCached=a,t.onloadNonCached=i-a,t}(N=a),Y=k(n.aftIntervals),r={aft:n.aft,aftNoAd:n.aftNoAd,pageLoadTime:s,startRender:C,domInteractive:d,domContentLoaded:u,ttfb:c,event:e,modulesReport:o,totalCoveragePercentage:P,normTotalCoveragePercentage:E,domElementsCount:l,resources:R,costlyResources:N,httpRequests:a,visuallyComplete:Y},i=0;i<g.length;i+=1)try{window["yaft_"+g[i].name].execute(g[i].config,r)}catch(e){YAFT.logToConsole("YAFT plugin "+g[i].name+" failed to execute"),YAFT.logToConsole(e)}for(t&&t(r),YAFT.data.push(r),i=0;i<m.length;i+=1)try{window["yaft_"+m[i].name].execute(m[i].config,r)}catch(e){YAFT.logToConsole("YAFT plugin "+m[i].name+" failed to execute"),YAFT.logToConsole(e)}!0===S&&F.canShowVisualReport&&f.YAFT_REPORT&&f.YAFT_REPORT.drawReport&&(YAFT.logToConsole(r),YAFT.logToConsole(n.aftIntervals),f.YAFT_REPORT.drawReport(r,n.aftIntervals)),w&&F.canShowPerfBar&&f.YAFT_PERFBAR.drawReport&&f.YAFT_PERFBAR.drawReport(r)}else t(null,"No timings available")}function z(){return f.performance||f.webkitPerformance||f.msPerformance||f.mozPerformance||f.Performance}void 0===f.YAFT&&(w=!(S=l=T=i=!1),A=(new Date).getTime(),r=!1,e=p.documentElement,F={usePrefixRegex:!0,useNormalizeCoverage:!0,canShowVisualReport:!0,canShowPerfBar:!1,useNativeStartRender:!0,useNativeStartRenderMeaningful:!1,maxWaitTime:3e3,modules:[],adModules:[],modulesExclude:[],modulesAft2Container:[],customReportModules:[],includeOnlyAft2:!1,punishAdsOnNoShow:!1,plugins:[],whiteListedContainerElements:["div","section","ul","ol","li","header","img","a","video","figure","span","picture"],customStartRender:!1,preProcess:!1,getAccurateFirstPaint:!0,fpsMinSampleCount:15,fpsMissLimit:18,preferDataModNameOverId:!1},N=[],R={},y={},d=n=M=a=b=Y=E=P=C=0,g=!(c={}),m=[],(h=z())&&h.timing&&(A=h.timing.navigationStart,h.now=h.now||h.webkitNow||h.msNow||h.mozNow||void 0,h.now&&(void 0===h.getEntriesByType&&void 0===h.webkitGetEntriesByType||void 0===h.getEntriesByName&&void 0===h.webkitGetEntriesByName||(T=!0),f.requestAnimationFrame&&f.cancelAnimationFrame&&(l=!0))),f.YAFT={data:[],triggerPerf:function(e,t){if(!r&&i){if(r=!0,!T)return t(null,"Nav or resource timing or both are not available"),!1;F.maxWaitTime&&0<F.maxWaitTime?n=setTimeout(function(){o(e,t)},F.maxWaitTime):o(e,t)}},triggerCustomTiming:function(e,t,r){if(!T)return!1;var n;YAFT.isInitialized()&&(v=v||D(),(n=p.querySelector(YAFT.getModuleSelector(e,!1)))&&(e=YAFT.getModuleName(n),n.modName=e,-1===F.modulesExclude.indexOf(e)&&(n=(e=y[e]=n).modName,c[n]=B(e,{modStart:t,modEnd:r}))))},getFinalModulesReport:function(){return c},reset:function(){r=!(i=!0),y=[],c={}},perfExists:function(){return T},isInitialized:function(){return i},getConfig:function(){return F},updateConfig:function(e){for(var t in e)F.hasOwnProperty(t)&&e.hasOwnProperty(t)&&void 0!==F[t]&&void 0!==e[t]&&(F[t]=e[t])},getPerformance:z,init:function(e,t){if(this.reset(),!T)return t(null,"Nav or resource timing or both are not available"),!1;this.getQueryStrings().showaft&&(S=!0),"0"===this.getQueryStrings().perfbar&&(w=!1),this.updateConfig(e),h.timing.loadEventStart>h.timing.navigationStart?YAFT.triggerPerf("deferred",t):f.addEventListener?(f.addEventListener("load",function(){YAFT.triggerPerf("load",t)},!1),f.addEventListener("unload",function(){YAFT.triggerPerf("unload",t)},!1)):f.attachEvent&&(f.attachEvent("onload",function(){YAFT.triggerPerf("load",t)}),f.attachEvent("onunload",function(){YAFT.triggerPerf("unload",t)}))},AFT2:{start:function(){if(y={},c={},a=0,!T||!i)return!1;!0===S&&F.canShowVisualReport&&f.YAFT_REPORT&&f.YAFT_REPORT.removeReport&&(f.YAFT_REPORT.removeExtras(),f.YAFT_REPORT.removeReport()),n&&clearTimeout(n),d&&clearTimeout(d);try{h.clearResourceTimings?h.clearResourceTimings():h.webkitClearResourceTimings&&h.webkitClearResourceTimings()}catch(e){}b=h.now()},setAFT2StartRender:function(){if(!T||!i)return!1;0===a&&(a=h.now())},getAFT2StartRender:function(){return a},end:function(e){var t,r,n,o;if(!T||!i)return e(null,"Nav or resource timing or both are not available or YAFT is not initialized"),!1;a=a||h.now(),M=a-b,F.maxWaitTime&&0<F.maxWaitTime&&(d=setTimeout(function(){v=v||D(),R=x(),F.preProcess&&"function"==typeof F.preProcess&&F.preProcess(),o=YAFT.getDomElementsCount(),L(F.modules,F.modulesExclude,F.modulesAft2Container),I(y,b,M,F.includeOnlyAft2),n=YAFT.getFinalModulesReport(),P=q(n),r=W(n,M),E=r.normTotalCoveragePercentage,Y=k(r.aftIntervals),t={aft:r.aft,aftNoAd:r.aftNoAd,startRender:M,event:"aft2",modulesReport:n,totalCoveragePercentage:P,normTotalCoveragePercentage:E,domElementsCount:o,resources:R,visuallyComplete:Y},e&&e(t),YAFT.data.push(t),!0===S&&F.canShowVisualReport&&f.YAFT_REPORT&&f.YAFT_REPORT.drawReport&&(YAFT.logToConsole(t),YAFT.logToConsole(r.aftIntervals),f.YAFT_REPORT.drawReport(t,r.aftIntervals))},F.maxWaitTime))}},FPS:{start:function(e){if(!l)return!1;g=!1,u&&f.cancelAnimationFrame(u),s=e,m.length=0,g=!0,u=f.requestAnimationFrame(t)},stop:function(e,t){var r,n,o,i,a;return g=!1,l?(u&&f.cancelAnimationFrame(u),s!==e?(t&&t("FPS stop action cannot be different than start action"),!1):(o=0,i=m.length,a={median:NaN,worse:NaN,avgFps:NaN,stdev:NaN,miss:NaN,sample:NaN},0===i||i<=F.fpsMinSampleCount||(a.sample=i,n=(m[i-1]-m[0])/(i-1),a.avgFps=Math.round(1e3/n),60<a.avgFps&&(a.avgFps=60),(i=m.map(function(e,t){if(0===t)return NaN;t=e-m[t-1];return t>F.fpsMissLimit&&o++,t})).shift(),a.miss=o,a.stdev=(r=n,n=(n=i.map(function(e){e-=r;return e*e})).reduce(function(e,t){return e+t},0)/n.length,Math.sqrt(n)),i.sort(function(e,t){return e-t}),a.worse=i[i.length-1],n=Math.floor(i.length/2),i.length%2?a.median=i[n]:a.median=(i[n-1]+i[n])/2),(a=a).action=e,a.avgFps?(t&&t(null,a),YAFT.logToConsole(a),a):(t&&t("FPS is not available"),!1))):(t&&t("FPS is not available for this browser"),!1)}},getDomElementsCount:function(){return p.getElementsByTagName("*").length},getTTFB:function(){return T?h.timing.responseStart-A:0},getPageLoadTime:function(){return T?h.timing.loadEventStart-A:0},getDomContentLoaded:function(){return T?h.timing.domContentLoadedEventStart-A:0},getStartRenderTime:function(){var e,t,r,n,o;if(!T)return 0;if(F.customStartRender&&"function"==typeof F.customStartRender)return F.customStartRender();if(e=this.getDomContentLoaded(),(n=f.performance.getEntriesByType("paint"))&&n.length&&0<n.length){if(F.useNativeStartRenderMeaningful)for(o=0;o<n.length;o+=1)if("first-contentful-paint"===n[o].name){i=n[o].startTime;break}if(void 0===i)for(o=0;o<n.length;o+=1)if("first-paint"===n[o].name){i=n[o].startTime;break}}if(void 0===i&&("msFirstPaint"in f.performance.timing?i=f.performance.timing.msFirstPaint-A:"chrome"in f&&"loadTimes"in f.chrome&&f.chrome.loadTimes&&"firstPaintTime"in(t=f.chrome.loadTimes())&&0<t.firstPaintTime&&(r=t.startLoadTime,"requestTime"in t&&0<t.requestTime&&(r=t.requestTime),t.firstPaintTime>=r&&(i=1e3*(t.firstPaintTime-r)))),!0===F.getAccurateFirstPaint&&(void 0===i||i<0||12e4<i)){for(var i=f.performance.timing.responseStart-A,a={},s=p.getElementsByTagName("head")[0].children,u=0;u<s.length;u++){var l=s[u];"SCRIPT"===l.tagName&&l.src&&!l.async&&(a[l.src]=!0),"LINK"===l.tagName&&"stylesheet"===l.rel&&l.href&&(a[l.href]=!0)}for(var c,d=f.performance.getEntriesByType("resource"),g=!1,m=0;m<d.length;m++)g||!a[d[m].name]||"script"!==d[m].initiatorType&&"link"!==d[m].initiatorType?g=!0:(c=d[m].responseEnd,(void 0===i||i<c)&&(i=c))}return void 0===i||i<0||12e4<i&&e<i?e:i},getDomInteractive:function(){return T?h.timing.domInteractive-A:0},getNow:function(){return T?h.now():0},getQueryStrings:function(){if(this.qParams)return this.qParams;for(var e,t={},r=f.location.search.slice(1).split("&"),n=0,o=r.length||0,n=0;n<o;n+=1)t[(e=r[n].split("="))[0]]=e[1]||"";return this.qParams=t},getViewport:function(){return v},getVersion:function(){return"0.3.29"},logToConsole:function(e){T&&S&&console&&console.log&&console.log(e)},getModuleSelector:function(e,t){for(var r=[],n=t?"^":"",t=t?"*":"",o=0,i=F.whiteListedContainerElements.length;o<i;o++)r.push(F.whiteListedContainerElements[o]+"[id"+n+'="'+e+'"]');return r.push(t+"[data-yaft-module"+n+'="'+e+'"]'),r.join(",")},getModuleName:function(e){return F.preferDataModNameOverId?e.getAttribute("data-yaft-module")||e.id||void 0:e.id||e.getAttribute("data-yaft-module")||void 0},getElemResourceUrl:function(e){var t="",r=[];return"VIDEO"===e.nodeName||(e.src?t=e.src:(e=e.currentStyle||window.getComputedStyle(e,!1))&&e.backgroundImage&&(r=e.backgroundImage.match(/url\((["']{0,1})([^'"]+)\1\)$/))&&3===r.length&&(t=r[2])),t}})}(window,document),"undefined"!=typeof module&&module.exports&&("undefined"!=typeof window?module.exports=window.YAFT:module.exports=!1);
