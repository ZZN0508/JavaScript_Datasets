!function(h,y){function P(){return b+"//cdn-gl"+O}function t(e){e&&e.hasOwnProperty("target")&&(M="true"===String(e.target).toLowerCase())}function n(e){if(e&&e.hasOwnProperty("target")&&!isNaN(e.target))for(var t in a)n=void 0,n=a[t],void 0!==n&&n.hasOwnProperty("staticPage")&&n.staticPage.hasOwnProperty("evtParams")&&"static"===n.staticPage.evtParams.param1.type&&n.ggPM("48",e.target,"","","");var n}function r(e){function s(e,t){if((e="string"==typeof e?{type:e}:e).target||(e.target=t),!e.type)throw new Error("Event object missing 'type' property.");if(i[e.type]instanceof Array)for(var n=i[e.type],r=0,a=n.length;r<a;r++)n[r].call(f,t)}function a(e){try{var t="Error in retrieveMeta";if(e&&e.hasOwnProperty("fData")&&e.hasOwnProperty("ad")&&e.hasOwnProperty("content")&&e.hasOwnProperty("plid")){var n,r=function(e){try{if(!e||!e.hasOwnProperty("cmsMap"))return[];var t,n=[];for(t in e.cmsMap)e.cmsMap.hasOwnProperty(t)&&-1!==e.cmsMap[t].indexOf("nol_")&&n.push(e.cmsMap[t].replace(/[{(\[\])}]/g,""));return n}catch(e){}}({cmsMap:h.GLCFG.PLDPR.getCmsMap(e.plid)});for(n in e.fData)if(e.fData.hasOwnProperty(n)){var a=e.fData[n][Object.keys(e.fData[n]).splice(-1,1)];if(void 0!==a)for(var i in a){var s=String(i);-1!==s.indexOf("nol_")&&-1===r.indexOf(s)||(e[n][i]=a[i])}}return e}return e&&e.hasOwnProperty("err")?(e.err=t+": Missing passedFdata, Ad, content or static properties",e):{err:t}}catch(e){}}function c(e){e&&(e.registerListener("ggPM",f),e._listeners&&(e._listeners.addListener("updateCmbStaticPage",f.handleUpdateOfStatic),e._listeners.addListener("removeCmbAssetId",f.removeAsset),e._listeners.addListener("tick",function(){k=Date.now(),S=Math.ceil((k-C)/1e3),s("globalTick",{time:k,seconds:S})}),e._listeners.addListener("dcrHeartbeat",n),e._listeners.addListener("flushQueue",f.emptyQueue),e._listeners.addListener("handleSessionReset",f.handleSessionReset),e._listeners.addListener("flushPauseEventQueue",f.flushPauseEventQueue),e._listeners.addListener("sendOptOutStatus",t)),h.GLCFG=e)}var u,d,i={},o=[],l={},g=String(Date.now())+Math.round(1e4*Math.random()),f={};f.id=g,f.name=e,f.initialized=!1,f.staticPage={},f.modules={allModInit:!1},f.configLoaded=!1,f.apid="",f.sdkv=_,f.sdkvForConfig=D;var r,p,v={_queueEventLog:!1,_eventLog:[],init:function(){try{var e,t=h.controllers.util.queryParam("nol_eventHookDelay");v._queueEventLog=!1,t&&"NaN"!==(e=parseInt(t)).toString()&&(v._queueEventLog=!0,setTimeout(function(){v._queueEventLog=!1},1e3*(e<=20?e:20)))}catch(e){v._queueEventLog=!1}},trigger:function(e,t){try{var n;t&&((n=JSON.parse(JSON.stringify(t))).name=e.name,v._queueEventLog?v._eventLog.push(n):(v._eventLog&&0<v._eventLog.length&&(h.controllers.util.fireCustomEvent("NSDK_EventHook",v._eventLog),v._eventLog=[]),h.controllers.util.fireCustomEvent("NSDK_EventHook",[n])))}catch(e){}}},m=(r=f.name,p=h,function(t,n){try{p.browserSafeAddEventListener({element:y,eventType:"NSDK_Initialized",func:function(e){try{e.detail.instanceName===r&&t(e.detail.instance)}catch(e){n&&n(e.message)}}})}catch(e){n&&n(e.message)}});return f.getOptOutStatus=function(){return M},f.getId=function(){return g},f.GetName=function(){return f.name},f.Initialized=function(e){if(void 0===e)return f.initialized;f.initialized=e},f.getPauseQueueCount=function(){return Object&&Object.keys?Object.keys(l).length:0},f.removeAsset=function(e){void 0!==e&&e.target.param1.hasOwnProperty("assetid")&&(f.staticPage={})},f.handleUpdateOfStatic=function(e){var t;e&&e.target&&(t=e.target.evtInfo,h.GLCFG&&h.GLCFG.PLDCR&&void 0!==t&&t.param1.hasOwnProperty("assetid")&&f.getId()===e.target.plid&&(e=h.GLCFG.PLDCR.latestDcrTick(),0!==Object.keys(f.staticPage).length&&f.staticPage.hasOwnProperty("id")&&f.staticPage.id===t.param1.assetid&&f.staticPage.hasOwnProperty("lastTimeStamp")?f.staticPage.lastTimeStamp=e:f.staticPage={id:t.param1.assetid,evtParams:t,startTimeStamp:e,lastTimeStamp:e}))},f.addListener=function(e,t){t&&(void 0===i[e]&&(i[e]=[]),i[e].push(t))},f.removeListener=function(e,t){if(f._listeners[e]instanceof Array)for(var n=i[e],r=0,a=n.length;r<a;r++)if(n[r]===t){n.splice(r,1);break}},f.handleSessionReset=function(e){var t,n,r;e&&e.target&&e.target.hasOwnProperty("plid")&&g===e.target.plid&&e.target.hasOwnProperty("passedFdata")&&e.target.passedFdata.hasOwnProperty("_dataArrObj")&&e.target.passedFdata._dataArrObj&&(0===a(t={plid:e.target.plid,fData:e.target.passedFdata._dataArrObj,content:{},ad:{},err:0}).err&&e.target.passedFdata.hasOwnProperty("_currVidType")&&(e.target.passedFdata._currVidType,n=0<Object.keys(t.content).length,r=0<Object.keys(t.ad).length,(n||r)&&(f.ggPM("57","1","","",""),n&&!l.hasOwnProperty("content")&&(l.content={evt:"pauseloadmeta",meta:t.content,plid:e.target.plid})))),f._listeners&&f._listeners.fireEvent&&f._listeners.fireEvent("debug",{type:"debug",msg:"Fired handleSessionReset from ggcmb."})},f.flushPauseEventQueue=function(){if(!(Object.keys(l).length<=0)){if(f.modules.PLDPR){for(var e in l)s("ggPM",{evtInfo:{eventType:l[e].evt,param1:l[e].meta},id:g});l={}}f._listeners&&f._listeners.fireEvent&&f._listeners.fireEvent("debug",{type:"debug",msg:"Fired flushPauseEventQueue from ggcmb."})}},f.cloneObj=function(e){return e&&"object"==typeof e?JSON.parse(JSON.stringify(e)):e},f.ggPM=function(e,t,n,r,a){var i;f.initialized&&null!=e&&""!==e&&((i={}).eventType=e,i.param1=f.cloneObj(t),i.param2=f.cloneObj(n),i.param3=f.cloneObj(r),i.param4=f.cloneObj(a),!f.modules.allModInit||2!=f.modules.PLCMB&&2!=f.modules.PLDPR?o.push(i):(f.emptyQueue(),s("ggPM",{evtInfo:i,id:g}),v.trigger(f,i)))},f.getConfigParams=function(){return u},f.emptyQueue=function(){if(!(o.length<=0)&&f.modules.allModInit&&(f.modules.PLCMB||f.modules.PLDPR)){for(var e=0,t=o.length;e<t;e+=1)s("ggPM",{evtInfo:o[e],id:g}),v.trigger(f,o[e]);o=[]}},f.getContainer=function(){return d},f.getEventQue=function(){return o},f.ggInitialize=function(e,t,n,r,a,i){if(f.initialized)return F(function(e,t){e(f)});v.init();var s,o,l="us";if(d=i,u={ggParams:e,uid:n,oldFlashDetect:r,detectBrowser:a,nol_playerId:g},typeof e==typeof String()){for(s=h.loadXmlString("<vi>"+e+"</vi>").firstChild.firstChild,o=0,e={};s&&void 0!==s&&o<20;)null!==s.firstChild&&(e[s.nodeName]=s.firstChild.nodeValue),s=s.nextSibling,o++;u.ggParams=e}return u.ggParams.nol_sdkDebug=h.controllers.util.queryParam("nol_sdkDebug")||u.ggParams.nol_sdkDebug,f.Initialized(!0),_=e.nsdkv||_,l=e.sfcode||l,E=b+w+l+O,L=e.coreaddress?b+"//"+e.coreaddress+"/":P(),D=e.sdkconfigver||D,f.apid=u.ggParams.apid,f.sdkv=_,h.loadLib("GLCFG",L+"novms/js/2/configs/"+("505"===_?"glcfg505.js":"glcfg510.js"),h,c),F(m)},f.isViewable=function(){return!1},h.browserSafeAddEventListener({element:y,eventType:"beforeunload",useCapture:!1,func:function(e){f&&f.staticPage&&(f.staticPage,f.staticPage.hasOwnProperty("evtParams")&&f.ggPM("56",f.staticPage.evtParams.param1,f.staticPage.evtParams.param2,f.staticPage.evtParams.param3,f.staticPage.evtParams.param4))}}),f}if(!h.isBuilt||!h.isBuilt()){var b=-1!==y.location.protocol.indexOf("https")?"https:":"http:",w="//secure-",O=".imrworldwide.com/",_="510",L=P(),E=b+"//secure-us.imrworldwide.com/",a=h.getInstances?h.getInstances():{},C=0,k=0,S=0,e=!1,M=!1,D="bj.5.0.0";Date.now=Date.now||function(){return+new Date};var F=function(e){try{new Promise(function(e,t){});return new Promise(e)}catch(e){}return new function(n){function r(e){i&&i(e)}function a(e){s&&s(e)}var i=null,s=null;return{then:function(e,t){i=e,s=t,n(r,a)}}}(e)};if(h.sdkvForConfig=function(){return D},h.isBuilt=function(){return e},h.getInstance=function(e){e=void 0!==e&&("string"==typeof e||"object"==typeof e&&e.constructor===String)?e:"default";return a.hasOwnProperty(e)||(a[e]=r(e)),a[e]},h.setTotalNumAssetsAllowed=function(e){isNaN(e)||parseInt(e,10)},h.getAddress=function(){return L},h.getConfigAddress=function(){return E},h.getInstances=function(){return a},h.loadXmlString=function(t){var e=null;try{return(e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t),e}catch(e){try{return(new DOMParser).parseFromString(t,"text/xml")}catch(t){}}return null},h.isNielsenTag=function(e){var t,n=!1;return void 0!==e&&(t=e.indexOf("?"),-1<(e=e.indexOf("imrworldwide.com"))&&e<t&&(n=!0)),n},h.getVersion=function(){return _},h.send=function(e){e&&y.console&&y.console.log&&console.log(e.parentNode)},h.browserSafeAddEventListener=function(e){void 0!==e.element&&(e.element.addEventListener?e.element.addEventListener(e.eventType,e.func,e.useCapture):e.element.attachEvent&&e.element.attachEvent("on"+e.eventType,e.func))},h.browserSafeRemoveEventListener=function(e){null!=e&&null!==e.element&&void 0!==e.element&&(e.element.removeEventListener?e.element.removeEventListener(e.eventType,e.func,e.useCapture):e.element.detachEvent&&e.element.detachEvent("on"+e.eventType,e.func))},h.controllers={util:(c=h,"function"!=typeof y.CustomEvent&&(u.prototype=y.Event.prototype,y.CustomEvent=u),{fireCustomEvent:function(e,t,n){try{n=n||y,e&&n&&n.dispatchEvent(new CustomEvent(e,{detail:t}))}catch(e){c&&c._listeners&&c._listeners.fireEvent("error",{type:"error",msg:"Browser error attempting to call element.dispatchEvent()."})}},queryParam:function(t){try{t=t.toString().toLowerCase();var e=y.location.search.substr(1).split("&"),n="";if(e.find)n=e.find(function(e){return 0===e.toLowerCase().indexOf(t+"=")});else for(var r=0,a=e.length;r<a;r++)if(0===e[r].toLowerCase().indexOf(t+"=")){n=e[r];break}if(n){var i=n.split("=");if(i&&1<i.length)return i[1]}}catch(e){c&&c._listeners&&c._listeners.fireEvent("error",{type:"error",msg:"Browser error attempting to retrieve query string parameter."})}return""}})},l={},h.loadLib=function(e,t,n,r){null!=e&&"string"==typeof e&&null!=t&&"string"==typeof t&&(l[e]?l[e].body?r(l[e].body(n)):l[e].callbacks.push({func:r,arg:n}):(l[e]={callbacks:[]},l[e].callbacks.push({func:r,arg:n}),(n=y.document.createElement("script")).async=!0,n.src=t,y.document.getElementsByTagName("head")[0].appendChild(n)))},h.registerLib=function(e,t){try{if(l){var n=l[e];n.body=t;for(var r=n.callbacks.shift();r;)r.func(n.body(r.arg)),r=n.callbacks.shift()}}catch(e){}},y.gg_nol_FlashCallBack){for(var i,s=0,o=y.gg_nol_FlashCallBack.length;s<o;s+=1)y.gg_nol_FlashCallBack[s].hasOwnProperty("callBack")&&(i=document.getElementById(y.gg_nol_FlashCallBack[s].swfId))&&i[y.gg_nol_FlashCallBack[s].callBack]();y.gg_nol_FlashCallBack=void 0}e||(e=!0,C=k=Date.now(),h.BUILDVERSION="5.1.0.44")}var l,c;function u(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}}(window.NOLCMB=window.NOLCMB||{},window);
