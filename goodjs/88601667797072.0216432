!function(n){"function"==typeof define&&define.amd?define("riloadr",["jquery"],n):window.Riloadr=n(jQuery)}(function(K){"use strict";function n(t){function n(){nn=function(){for(var n,t=[En.innerWidth,Qn[Tn],Qn.offsetWidth,$[Tn]],i=[En.innerHeight,Qn[Pn]],e=[t,i],r=function(n){return n[vn]&&Math.max[sn](Math,n)||0},o=function(n,t){var i,e={};return e[ln]=n,e[pn]=t,Gn&&(((i=(Un?Vn[En[Sn]]:Jn?En[Cn]("all and ("+Sn+": "+Wn+")").matches:Qn&&Qn[Tn]/Qn[Pn]<1.1)?Wn:kn)===Wn&&t<n||i===kn&&n<t)&&(e[ln]=t,e[pn]=n)),e},a=0,c=0;n=e[a];a++)for(;c<n[vn];c++)isNaN(n[c])&&(n.splice(c,1),c--);return i=o(r(t),r(i)),o=o(Kn[ln],Kn[pn]),(!isNaN(o[ln])&&i[ln]>o[ln]?o:i)[ln]||0}(),h=function(n,t,i){for(var e,r,o,a,c=0,u=t[0];0<i&&(e=n[c]);c++)r=+e[jn]||en,o=+e[In]||en,a=+e[Bn]||1,(r&&o&&r<=i&&i<=o||r&&!o&&r<=i||o&&!r&&i<=o)&&a<=Xn&&(u=e);return u}(H,i,nn),r=function(n,t){if(Mn in n)for(var i,e=0;i=t[e];e++)if(i.name===n[Mn])return i}(h,H),p=H[H[vn]-1]}function c(){T===un&&Fn.on(un+hn,A[qn]),(L||z)&&Fn.on(bn+hn+" "+zn+hn,Q),L&&(Fn.on(wn+hn,F),R&&d.on(wn+hn,F).on("imageshow"+hn,F))}function u(n,t){var i=n[Mn]?r:h,n=A.buildImageSrc(n,i);return Nn in i&&((n=n.split(".")).pop(),n=n.join(".")+"."+i[Nn]),t&&(n+=(/\?/.test(n)?"&":"?")+"riloadrts="+K.now()),encodeURI(n)}function f(){var n=K(this);0<+(n[ln]()+n[pn]())&&("hidden"!==n.css("visibility")&&"none"!==n.css("display")||n.css("visibility","visible").show(),yn in t&&t[yn][fn](this),e(this))}function s(){function n(n){var t=new Image;t[yn]=function(){i[an]=t[an],f[fn](i)},t[xn]=t[_n]=function(){s[fn](i)},t[an]=n}var i=this;xn in t&&t[xn][fn](i),i[On]<q?(i[On]++,n(u(i,tn))):Mn in h&&!i[Mn]&&r?(i[On]=0,i[Mn]=tn,n(u(i,en))):e(i)}function e(n){n[yn]=n[xn]=n[_n]=rn,0===--V&&(T===un&&Fn.off(un+hn,A[qn]),z||(Fn.off(bn+hn+" "+zn+hn,Q),L&&(Fn.off(wn+hn,F),R&&d.off(wn+hn,F).off("imageshow"+hn,F))),Hn in t&&t[Hn]())}t[An]=t[An]||En;var d,l,i,h,m,r,p,o,a,v,w,g,b,y,O,x,M,W,j,I,_,A=this,N=parseInt(1e7*Math.random()),R=!!t.contentOverflowsContainer,k=R?t[An]:En,C=t[An]===En?"body":t[An],D=t.selector||"img[data-src]",H=t.breakpoints||[{name:"",minWidth:1}],S=t.defer,T=S&&S.mode.toLowerCase(),L="invisible"===T&&!Yn,P=S&&S.threshold||100,q=t[On]||0,S=t.watchViewport,z=!!S,B="wider"===S,E="*"===S,F=(O=function(){A[qn]()},function(){var n=new Date,t=x-(n-_);return M=arguments,j=this,t<=0?(_=n,W=O[sn](j,M)):I=I||Z(J,t),W}),Q=(o=function(){z&&n(),A[qn]()},a=x=250,function(){var n=v&&!y;return w=arguments,b=this,clearTimeout(y),y=Z(G,a),g=n?o[sn](b,w):g}),U=[],V=_=0;function G(){y=rn,v||o[sn](b,w)}function J(){_=new Date,I=rn,O[sn](j,M)}A.getOptions=function(){return t},A[qn]=function(a){!function(n){Z[sn](rn,[n,1].concat(Array[Rn].slice[fn](arguments,1)))}(function(){var i,e,r,n,t,o;for(z&&(i=X(h,p),o=m,e=Y(h)>Y(o),r=X(h,m)),U[vn]&&!a||(a&&c(),K(D,l).each(function(n,t){mn in t&&t[mn]!==N||dn in t||((!z||B&&e||E&&!r||a&&!(mn in t))&&(U.push(t),V++),t[mn]=N,(!z||B&&i)&&(t[dn]=tn))})),z&&B&&i&&(z=en),n=0;t=U[n];n++)L&&!function(n,t,i){n=K(n);return!(function(n,t,i){return(i[0]===En?i[pn]()+i[Dn]():i[gn]()[on]+i[pn]())<=n[gn]()[on]-t}(n,t,i)||function(n,t,i){return(i[0]===En?i[Dn]():i[gn]()[on])>=n[gn]()[on]+n[pn]()+t}(n,t,i)||function(n,t,i){return(i[0]===En?i[ln]()+i[Ln]():i[gn]()[cn]+i[ln]())<=n[gn]()[cn]-t}(n,t,i)||function(n,t,i){return(i[0]===En?i[Ln]():i[gn]()[cn])>=n[gn]()[cn]+n[ln]()+t}(n,t,i))}(t,P,d)||(t[On]=0,t[Mn]=en,t[yn]=f,t[xn]=t[_n]=s,t[an]=u(t,en),U.splice(n,1),n--);m=h})},K(function(){d=K(k),l=K(C),function(n){for(var t,i=0;t=n[i];i++)t[Bn]>Xn&&(n.splice(i,1),i--)}(H),i=H.slice().sort(function(n,t){return Y(n)-Y(t)}),n(),c(),T&&!L||A[qn]()})}function X(n,t){return n&&t?n[jn]===t[jn]&&n[In]===t[In]&&n[Bn]===t[Bn]:en}function Y(n){if(!n)return 0;var t=+n[Bn]||1;return Math.max(+n[jn]||0,+n[In]||0)*(t<=Xn?t:1)}function t(){return void 0!==En[Sn]||/Mobi/.test(En.navigator.userAgent)}function Z(n,t){var i=Array[Rn].slice[fn](arguments,2);return En.setTimeout(function(){return n[sn](rn,i)},t)}var $,o,a,c,nn,i="on",tn=!0,en=!1,rn=null,on="top",an="src",cn="left",un="load",fn="call",sn="apply",dn="_done_",ln="width",hn=".riloadr",mn="_groupid_",pn="height",vn="length",wn="scroll",gn="offset",bn="resize",yn=i+un,On="retries",xn="onerror",Mn="fallback",Wn="portrait",jn="minWidth",In="maxWidth",_n="onabort",An="container",Nn="imgFormat",Rn="prototype",kn="landscape",Cn="matchMedia",Dn=wn+"Top",Hn="oncomplete",Sn="orientation",Tn="clientWidth",Ln=wn+"Left",Pn="clientHeight",qn=un+"Images_",zn=Sn+"change",Bn="minDevicePixelRatio",En=window,Fn=K(En),u=En.document,Qn=u.documentElement,e=K(Qn),Un=Sn in En&&i+zn in En,Vn={0:tn,180:tn},Gn=t(),Jn=Cn in En,Kn=En.screen,Xn=En.devicePixelRatio||1,Yn="[object OperaMini]"===Object[Rn].toString[fn](En.operamini);return e.removeClass("no-js"),K(function(){var n,t,i,e,r;$=u.body,o=K("head"),Un&&(e=En.innerWidth||Fn.width(),r=En.innerHeight||Fn.height(),a=r<e&&50<e-r,c=Vn[En[Sn]],(a&&c||!a&&!c)&&(Vn={"-90":tn,90:tn})),n=o.find("meta[name=viewport]"),t="content",i="width=device-width",e="initial-scale=1",n[vn]?((r=n.attr(t).trim()).indexOf(i)<0&&(r+=(r[vn]?",":"")+i),r.indexOf(e)<0&&(r+=(r[vn]?",":"")+e),n.attr(t,r)):o.append(K('<meta name="viewport" content="'+i+","+e+'">'))}),n.version="2.0.0",n.isOrientationAwareBrowser=t,n[Rn][un]=function(){this[qn](tn)},n[Rn].buildImageSrc=function(n,t){var i=this.getOptions(),n=K(n);return((n.attr("data-base")||i.base||"")+(n.attr("data-src")||n.attr("data-src-"+t.name)||"")).replace(/\{breakpoint-name\}/gi,t.name)},n});
