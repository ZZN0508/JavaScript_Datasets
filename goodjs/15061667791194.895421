define.amd=!1,require.config({baseUrl:"/resource",paths:{text:"js/lib/requirejs-plugins/text"}}),$.extend(So.newsFlow,{logMark:"homecard",eventMark:"so.homecard",currNavCookieMark:"currCard",closeOffensoCookieMark:"closeOftenso",hotNewsFlag:"hot-news-card",$newsFlow:null,$realTimeNews:null,$oftenSo:null,$cardSide:null,$cardContainer:null}),So.newsFlow.observerEvent={addHotNewsCard:So.newsFlow.eventMark+".addHotNewsCard",closeHotNewsCard:So.newsFlow.eventMark+".closeHotNewsCard",infoFlowClickTab:So.newsFlow.eventMark+".infoFlowClickTab",infoFlowTabFixed:So.newsFlow.eventMark+".infoFlowTabFixed",searchboxFixed:So.newsFlow.eventMark+".searchboxFixed",cancelSearchboxFixed:So.newsFlow.eventMark+".cancelSearchboxFixed"},require(["js/home/card/main"],function(){}),define("js/home/card/loader",function(){}),define("text",["module"],function(e){var a,i,n,l,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,r=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,d=c&&location.protocol&&location.protocol.replace(/\:/,""),p=c&&location.hostname,u=c&&(location.port||void 0),f={},m=e.config&&e.config()||{},w={version:"2.0.12",strip:function(e){var t;return e?(t=(e=e.replace(o,"")).match(r))&&(e=t[1]):e="",e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var e,t,o;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){o=s[t];try{e=new ActiveXObject(o)}catch(e){}if(e){s=[o];break}}return e},parseName:function(e){var t,o,s=!1,a=e.indexOf("."),i=0===e.indexOf("./")||0===e.indexOf("../");return-1!==a&&(!i||1<a)?(t=e.substring(0,a),o=e.substring(a+1,e.length)):t=e,-1!==(a=(e=o||t).indexOf("!"))&&(s="strip"===e.substring(a+1),e=e.substring(0,a),o?o=e:t=e),{moduleName:t,ext:o,strip:s}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,o,s){var a,i=w.xdRegExp.exec(e);return!i||(a=i[2],i=(e=(e=i[3]).split(":"))[1],e=e[0],!(a&&a!==t||e&&e.toLowerCase()!==o.toLowerCase()||(i||e)&&i!==s))},finishLoad:function(e,t,o,s){o=t?w.strip(o):o,m.isBuild&&(f[e]=o),s(o)},load:function(t,e,o,s){var a,i,n;s&&s.isBuild&&!s.inlineText?o():(m.isBuild=s&&s.isBuild,i=(a=w.parseName(t)).moduleName+(a.ext?"."+a.ext:""),n=e.toUrl(i),s=m.useXhr||w.useXhr,0!==n.indexOf("empty:")?!c||s(n,d,p,u)?w.get(n,function(e){w.finishLoad(t,a.strip,e,o)},function(e){o.error&&o.error(e)}):e([i],function(e){w.finishLoad(a.moduleName+"."+a.ext,a.strip,e,o)}):o())},write:function(e,t,o,s){var a;f.hasOwnProperty(t)&&(a=w.jsEscape(f[t]),o.asModule(e+"!"+t,"define(function () { return '"+a+"';});\n"))},writeFile:function(o,e,t,s,a){var i=w.parseName(e),e=i.ext?"."+i.ext:"",n=i.moduleName+e,l=t.toUrl(i.moduleName+e)+".js";w.load(n,t,function(e){function t(e){return s(l,e)}t.asModule=function(e,t){return s.asModule(e,l,t)},w.write(o,n,t,a)},a)}};return"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(a=require.nodeRequire("fs"),w.get=function(e,t,o){try{var s=a.readFileSync(e,"utf8");t(s=0===s.indexOf("\ufeff")?s.substring(1):s)}catch(e){o&&o(e)}}):"xhr"===m.env||!m.env&&w.createXhr()?w.get=function(o,s,a,e){var t,i=w.createXhr();if(i.open("GET",o,!0),e)for(t in e)e.hasOwnProperty(t)&&i.setRequestHeader(t.toLowerCase(),e[t]);m.onXhr&&m.onXhr(i,o),i.onreadystatechange=function(e){var t;4===i.readyState&&(399<(t=i.status||0)&&t<600?((t=new Error(o+" HTTP status: "+t)).xhr=i,a&&a(t)):s(i.responseText),m.onXhrComplete&&m.onXhrComplete(i,o))},i.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?w.get=function(e,t){var o,s,e=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),i=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(e),"utf-8")),e="";try{for(o=new java.lang.StringBuffer,null!==(s=(s=i.readLine())&&s.length()&&65279===s.charAt(0)?s.substring(1):s)&&o.append(s);null!==(s=i.readLine());)o.append(a),o.append(s);e=String(o.toString())}finally{i.close()}t(e)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,n=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),l="@mozilla.org/windows-registry-key;1"in i,w.get=function(t,e){var o,s,a={};l&&(t=t.replace(/\//g,"\\")),t=new FileUtils.File(t);try{(o=i["@mozilla.org/network/file-input-stream;1"].createInstance(n.nsIFileInputStream)).init(t,1,0,!1),(s=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(n.nsIConverterInputStream)).init(o,"utf-8",o.available(),n.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(o.available(),a),s.close(),o.close(),e(a.value)}catch(e){throw new Error((t&&t.path||"")+": "+e)}}),w}),define("text!html/news-flow.html!strip",[],function(){return'<% if(tplType == \'tab\'){ %>\n<div class="top-tab">\n    <div class="fixed">\n        <% for(var i = 0, len = data.length; i < len; i++){ %>\n        <a href="javascript:;" class="<%= i==0 ? \'selected\' : \'\' %>" data-log="tab" data-param="<%= data[i].param %>">\n            <%= data[i].txt %>\n            <span class="line"></span>\n        </a>\n        <% } %>\n    </div>\n</div>\n<% }else if(tplType == \'news\'){ %>\n<li data-type="<%= type %>" data-from="news-<%= dataSource %><%= from ? \'-\' + from : \'\' %>"\n    class="respond <%= liClass %> <%= liCoversClass %>" data-ctitle="0" <%= attr %>>\n    <a data-log="link" href="<%= url %>" target="_blank" title="<%= So.lib.escapeHTML(titleFull) %>">\n        \x3c!-- 多图或无图title-start --\x3e\n        <% if(liCoversClass != "single-img"){ %>\n        <p data-log="title" class="sub-title"><%= title %></p>\n        <% } %>\n        \x3c!-- 多图或无图title-end --\x3e\n\n        \x3c!-- 图片-start --\x3e\n        <% if(covers.length > 0){ %>\n        <div class="img">\n            <% for(var i = 0, len = covers.length; i < len; i++){ %>\n            <span class="img-wrap<%= (i != 0 && len - 1 == i) ? \' last\' : \'\' %>">\n                <img onerror="NewsFlow.Tools.checkImg()" data-log="image" <%= covers[i].style %>\n                    width="<%= coversWidth %>px" height="<%= coversHeight %>px" src="<%= covers[i].src %>">\n                <% if(type == "video"){ %>\n                <div class="play"></div>\n                <% } %>\n            </span>\n            <% } %>\n            <% if(corner){ %>\n            <div data-log="image" class="corner"><%= corner %></div>\n            <% } %>\n        </div>\n        <% } %>\n        \x3c!-- 图片-end --\x3e\n\n        \x3c!-- 单图title-start --\x3e\n        <% if(liCoversClass == "single-img"){ %>\n        <div class="con">\n            <p data-log="title" class="sub-title short"><%= title %></p>\n            <p data-log="title" class="sub-title long"><%= titleLong %></p>\n            <% } %>\n            \x3c!-- 单图title-end --\x3e\n\n            <p data-log="desc" class="desc">\n                <%= source %><%= followButton %><%= date %><%= playCount %><%= tag %></p>\n\n            \x3c!-- 单图title-start --\x3e\n            <% if(liCoversClass == "single-img"){ %>\n        </div>\n        <% } %>\n        \x3c!-- 单图title-end --\x3e\n\n    </a>\n    <div class="close"></div>\n</li>\n<% }else if(tplType == \'sad\'){ %>\n\x3c!-- 正常广告：data-from="sad" --\x3e\n\x3c!-- qcms运营位：data-from="sad-qcms" --\x3e\n<li data-from="<%= from %>" class="sad respond <%= liCoversClass %>" data-imptk="<%= imptk %>" data-clktk="<%= clktk %>"\n    data-clstk="<%= clstk %>" data-title="<%= titleFull %>" data-ctitle="0">\n    \x3c!-- 喇叭 --\x3e\n    <% if(type == "video"){ %>\n    <a href="javascript:;" class="horn"></a>\n    <a href="javascript:;" class="play"><i></i><span class="time"><%= duration %></span></a>\n    <% } %>\n\n    <a data-log="link" href="<%= url %>" data-href="<%= url %>" target="_blank" class="bg-url" rel="noopener"></a>\n\n    \x3c!-- title在顶部start：多图 视频 大图 方图 --\x3e\n    <% if(type == "manyImg" || type == "video" || type == "bigImg"  || type == "squareImg"){ %>\n    <a data-log="title" href="<%= url %>" data-href="<%= url %>" target="_blank" class="sub-title"\n        rel="noopener"><%= title %></a>\n    <% } %>\n    \x3c!-- title在顶部end --\x3e\n\n    \x3c!-- 图片start --\x3e\n    <div class="img">\n        <% for(var i = 0, len = img.length; i < len; i++){ %>\n        <a class="img-wrap <%= (i != 0 && len - 1 == i) ? \'last\' : \'\' %>" href="<%= img[i].url %>"\n            data-href="<%= img[i].url %>" target="_blank" rel="noopener">\n            <% if(type == "video"){ %>\n            <video loop muted src="<%= img[i].src %>" data-log="video" <%= img[i].style %>\n                height="<%= imgHeight %>px">您的浏览器不支持 video 标签。</video>\n            <% }else{ %>\n            <img onerror="NewsFlowSad.Tools.checkImg()" data-log="image" <%= img[i].style %> width="<%= imgWidth %>px"\n                height="<%= imgHeight %>px" src="<%= img[i].src %>">\n            <% } %>\n        </a>\n        <% } %>\n    </div>\n    \x3c!-- 图片end --\x3e\n\n    <a href="<%= url %>" data-href="<%= url %>" target="_blank" class="con" rel="noopener">\n        \x3c!-- title在右侧start：单图 --\x3e\n        <% if(type == "singleImg"){ %>\n        <p data-log="title" class="sub-title"><%= title %></p>\n        <% } %>\n        \x3c!-- title在右侧end --\x3e\n\n        <p data-log="desc" class="desc"><span><%= source %></span><%= sadTxt %></p>\n    </a>\n    <div class="close"></div>\n</li>\n<% }else if(tplType == \'sadTest\'){ %>\n<%\n        var imgDom = \'\';\n        if (img) {\n            imgDom = \'<div class="img"><span class="img-wrap"><img class="anim" width="132px" height="84" src="\' + img + \'"/></span></div>\';\n        }\n    %>\n\x3c!-- 搜索广告 --\x3e\n<% if(type == "sd"){ %>\n<li data-from="sad" class="sad respond single-img">\n    <a target="_blank" href="<%= click_url %>" e_href="<%= click_url %>" data-qhp="item-sd"><%= imgDom %>\n        <div class="con">\n            <h3 class="sub-title"><%= title %></h3>\n            <p data-log="desc" class="desc"><%= src %><span class="txt">广告</span></p>\n        </div>\n    </a>\n</li>\n\x3c!-- 联盟广告 --\x3e\n<% }else if(type == "lm"){ %>\n<li data-from="sad" class="sad respond single-img">\n    <a target="_blank" href="<%= click_url %>" data-busiid="<%= id %>" data-qhp="item-lm"><%=  imgDom %>\n        <div class="con">\n            <h3 class="sub-title"><%= title %></h3>\n            <p data-log="desc" class="desc"><%= src %><span class="txt">广告</span></p>\n        </div>\n    </a>\n</li>\n\x3c!-- 信息流广告 --\x3e\n<% }else if(type == "nf"){ %>\n<li data-from="sad" class="sad respond single-img js-i-busi-list-item">\n    <a target="_blank" href="<%= click_url %>" data-busiid="<%= id %>" data-qhp="item-lm"><%=  imgDom %>\n        <div class="con">\n            <h3 class="sub-title"><%= title %></h3>\n            <p data-log="desc" class="desc"><%= src %><span class="txt">广告</span></p>\n        </div>\n    </a>\n</li>\n<% } %>\n<% }else if(tplType == \'noData\'){ %>\n<div class="no-more clearfix">\n    <hr size="1">\n    </hr>\n    <p>没有更多内容了哦 ~</p>\n</div>\n<% }else if(tplType == \'loading\'){ %>\n<div class="loading short"><i class="ico"></i>加载中...</div>\n<% }else if(tplType == \'gotoTop\'){ %>\n<div id="goto-top"><span></span></div>\n<% }else if(tplType == \'closeList\'){ %>\n<div class="close-list">\n    <div class="wrap">\n        <i></i>\n        <a href="javascript:;" data-val="5">不感兴趣</a>\n        <a href="javascript:;" data-val="1">内容不宜</a>\n        <a href="javascript:;" data-val="4">遮挡干扰</a>\n        <a href="javascript:;" data-val="2">屏蔽此类</a>\n    </div>\n</div>\n<% } %>'}),NewsFlow=function(e){var t=this,o={debugTxt:"",$newsFlow:So.newsFlow.$newsFlow,source:So.newsFlow.source||"papi",query:So.comm.q,type:So.newsFlow.type,from:So.newsFlow.from,logMark:So.newsFlow.logMark,eventMark:So.newsFlow.eventMark,guid:So.lib.getUnMid(So.comm.md)||So.lib.getUnMid(So.lib.cookie.get("__md"))||So.comm.guid,template:"",currPage:1,requestPage:1,newsCount:10,gotoTopDis:700,retryGetDataTimes:1,showGotoTop:!0,alwaysShowFlow:!1,onlyShowSingleImg:!1,preventScrollLoad:!1,preferences:{},isShowTag:!1,isShowAtlas:!0,isShowVideo:!0,manyImg:{count:4,width:132,height:84,isShowCorner:!0},singleImg:{width:132,height:84,titleLength:64},atlasImg:{width:268,height:170},noImg:{titleLength:150},initCb:$.noop,scrollCb:$.noop,noDataCb:$.noop,neverDataCb:$.noop,addNewsCb:$.noop,removeFlowCb:$.noop,renderAfterCb:$.noop};t.options=$.extend(!0,{},o,e),t.noData=!1,t.currRetryGetDataTimes=0,t.$flowInner=t.options.$newsFlow.find("ul"),t.$loading=$(NewsFlow.Tools.template(t.options.template,{tplType:"loading"})),t.$gotoTop=$(NewsFlow.Tools.template(t.options.template,{tplType:"gotoTop"})),t.hasSendFollowButtonSrpLog=!1,t.init()},NewsFlow.Tools={getTxt:function(e){return So.lib.escapeHTML($("<p>"+e+"</p>").text())},cutStr:function(e,t){return(e=(e=So.lib.unescapeHTML(So.lib.cutStr(e,t))).replace(/^(.*)(<|<b|<\/|<\/b)\.\.\.$/,"$1...")).indexOf("<b>")!=e.indexOf("</b>")&&(e=e.replace(/(.*)<b>([^<>]*?)\.\.\.$/,"$1<b>$2</b>...")),So.lib.escapeHTML(e)},checkImg:function(){var e=event.srcElement;$(e).remove(),e.onerror=null},formatSeconds:function(e){e=[parseInt(e/60/60),parseInt(e/60%60),parseInt(e%60)];return 0===e[0]&&e.shift(),e.join(":").replace(/\b(\d)\b/g,"0$1")},log:So.lib.log,observer:So.lib.observer,template:So.lib.template,isVisible:So.lib.isVisible1,getPicUrl:So.lib.getPicUrl,formatTime:So.lib.formatTime,sslReplace:So.lib.sslReplace,escapeHTML:So.lib.escapeHTML,unescapeHTML:So.lib.unescapeHTML,localStorage:So.lib.soLocalStorage},NewsFlow.prototype={Source:{papi:{getData:function(t){var o=this,e=o.options;o.noData||(t=$.extend({noRender:!1,newsCount:e.newsCount,beforeCb:$.noop,afterCb:$.noop,failCb:$.noop},t),$.ajax({url:"//papi.look.360.cn/mlist",data:{q:e.query,from:e.from,so_type:e.type,n:So.lib.checkAbv(1240,"pos_test")&&1==e.currPage?2:t.newsCount,u:e.guid,v:1,sv:1,net:5,scene:1,device:2,f:"json_v1",c:"youlike",callfrom:"so",data_type:"jsonp",refer_scene:"so_7",sign:"360_e39369d1",abv:So.lib.checkAbv(1240,"mlist_test")||So.lib.checkAbv(1240,"pos_test")&&1<e.currPage?"1078-mlist_test":""},type:"get",timeout:3e3,dataType:"jsonp",success:function(e){o.noData||(e&&e.items&&e.items.length?(t.beforeCb(),(e=o.Source.papi.formatData.call(o,e.items,e.tc_show)).length&&o.render(e,t.noRender),setTimeout(function(){t.afterCb(o)},0)):(o.setNoData(t),t.failCb(o)))},error:function(){o.setNoData(t),t.failCb(o)}}),e.currPage++)},formatData:function(e,t){for(var o,s,a,i,n,l=[],r={},c=this.options,d=0,p=e.length;d<p;d++)"news"==(r=e[d]).from&&""!=r.attr.image_url&&""!=r.url&&""!=r.title&&(o="news",s=r.attr.image_url?r.attr.image_url.split(";"):[],i=a="",r.ntag&&r.ntag.match(/y3:(.*?);/)&&(i=(n=r.ntag.match(/y3:(.*?);/)[1].split(":"))[n.length-1]),c.isShowAtlas&&"p"==r.s&&1<s.length&&(o="atlas"),n="",c.isShowVideo&&("v"==r.s||"y"==r.s)&&r.duration&&1==s.length&&(o="video",a=NewsFlow.Tools.formatSeconds(r.duration),n=+r.playcnt?"<span>"+r.playcnt+"次观看</span>":""),l.push({type:o,playCount:n,liClass:"papi",date:1e3*r.showtime,title:r.title,from:r.from,url:r.url,source:r.attr.sitename,covers:s,corner:a,attr:'" data-tc-show="'+t+'" data-log-extend="'+r.tc_value+'"',tag:i,zmt:r.zmt||""}));return l}},baoDian:{sid:"",timer:null,baodianPage:1,batch:{},delNewsCookie:"delNews",closeLog:function(e,t){var o=e.Source.baoDian,e=t.find("a[title]").attr("title"),t=NewsFlow.Tools.localStorage.getItem(o.delNewsCookie)||JSON.stringify([]);20==(t=JSON.parse(t)).length&&t.shift(),t.push(e),NewsFlow.Tools.localStorage.setItem(o.delNewsCookie,JSON.stringify(t))},clickLog:function(e,t){var o,s;t.attr("data-a")&&(s=(o=e.options).preferences,$.ajax({url:"//papi.look.360.cn/srv/c",data:{uid:o.guid,sqid:s.sqid,url:t.attr("data-callbackUrl"),sign:s.sign,stype:"portal",market:"so-home",device:2,net:5,channel:o.$newsFlow.find(".top-tab a.selected").attr("data-param"),sid:e.sid,a:t.attr("data-a"),c:t.attr("data-c"),source:t.attr("data-src"),s:t.attr("data-s"),style:5,act:"click",refer_scene:0,refer_subscene:0,where:"list",t:parseInt(+new Date/1e3)},type:"get",dataType:"jsonp"}))},showLog:function(e){var t=e.Source.baoDian,o=e.options,a=o.preferences;clearTimeout(t.timer),t.timer=setTimeout(function(){var s=[];$.each(o.$newsFlow.find("li"),function(e,t){var o=$(t);NewsFlow.Tools.isVisible(t)&&!o.data("isSend")&&o.attr("data-log")&&(s.push(o.attr("data-log")),o.data("isSend",1))}),s.length&&$.ajax({url:"//news.qhstatic.com/srv/c2",data:{uid:o.guid,sign:a.sign,device:2,market:"so-home",func:"pc_news_realshow",net:5,stype:"portal",channel:o.$newsFlow.find(".top-tab a.selected").attr("data-param"),sqid:a.sqid,act:"real_show",refer_scene:0,refer_subscene:0,where:"list",n:s.length,url_pack:"["+s.toString()+"]"},dataType:"jsonp",type:"get"})})},countBatch:function(e){var t=e.Source.baoDian,e=e.options.type;t.batch[e]||(t.batch[e]=0),t.batch[e]++},getData:function(){var e,t=this,o=t.Source.baoDian,s=t.options.preferences;""!==s.qid?(e=JSON.parse(NewsFlow.Tools.localStorage.getItem("flow-sqid")))&&e.guid&&e.guid==s.guid?(s.sqid=e.val,o.getFlowData(t)):o.getSqid(t):o.getFlowData(t)},getSqid:function(t){var o=t.Source.baoDian,s=t.options.preferences;$.ajax({url:"//u.api.look.360.cn/user/sqid",data:{u:s.guid,sign:s.sign,f:"jsonp",cq:s.Q,ct:s.T,device:2},type:"get",dataType:"jsonp",timeout:1e3,success:function(e){e&&e.data&&e.data.sqid&&(NewsFlow.Tools.localStorage.setItem("flow-sqid",JSON.stringify({val:e.data.sqid,guid:s.guid})),t.sqid=e.data.sqid),o.getFlowData(t)},error:function(){o.getFlowData(t)}})},getFlowData:function(t){var e=t.options,o=t.Source.baoDian,s=t.options.preferences;$.ajax({url:"//papi.look.360.cn/mlist",data:{u:e.guid,n:10,sign:s.sign,c:"mylike"==e.type?"youlike":e.type,f:"jsonp",device:2,sv:1,net:5,v:1,sqid:s.sqid,action:1==o.baodianPage?1:2},type:"get",dataType:"jsonp",success:function(e){t.noData||e&&e.data&&e.data.res&&(e.data.res.length?(o.countBatch(t),o.sid=e.sid,(e=t.Source.baoDian.formatData(t,e.data.res)).length&&t.render(e),o.showLog(t),o.baodianPage++):t.setNoData())}}),e.currPage++},formatData:function(e,t){for(var o=[],s={},a=e.options.type,i=e.Source.baoDian,n=(n=NewsFlow.Tools.localStorage.getItem(i.delNewsCookie))?JSON.parse(n):[],l=0,r=t.length;l<r;l++){var c,d,p,u,f,m,s=t[l],w="news";~$.inArray(s.t,n)||"youlike"!=a&&!~$.inArray(s.s,["t","p","q"])||"youlike"==a&&!~$.inArray(s.s,["t","p","q","y"])||((m=[]).push(s.gnid||""),m.push(s.a||""),m.push(s.c||""),m.push(s.source||""),m.push(s.s||""),m.push(s.style||""),m.push(2e3),m.push(e.sid||""),m=" data-log='"+JSON.stringify(m)+"'",p=1e3*s.showtime,d=c=u="","t"==s.a&&s.attr&&s.attr[0]&&"1"==s.attr[0].isdisplay&&"置顶"==s.attr[0].content&&(p='<span style="color:#'+(f=s.attr[0]).color+'">'+f.content+"</span>",u="to-front"),f=s.i&&s.i.split("|")||[],"y"==s.s&&s.duration&&1==f.length&&(w="video",d=NewsFlow.Tools.formatSeconds(s.duration),c=+s.playcnt?"<span>"+s.playcnt+"次观看</span>":""),(m={type:w,playCount:c,liClass:u,date:p,title:s.t,from:"",url:s.pcurl,source:s.f,covers:f,corner:d,coversCount:"p"==s.s&&4<=s.pnum?s.pnum:"",attr:'" data-callbackUrl="'+s.u+'" data-a="'+s.a+'" data-c="'+s.c+'" data-src="'+s.source+'" data-s="'+s.s+'"'+m}).zmt=s.zmt||"",s.zmt&&s.zmt.name&&(m.source=s.zmt.name),o.push(m))}return o}},focus:{getData:function(t){var o=this,s=o.options,e=parseInt((new Date).getTime()/1e3);o.noData||(t=$.extend({noRender:!1,newsCount:s.newsCount,beforeCb:$.noop,afterCb:$.noop,failCb:$.noop},t),$.ajax({url:"//user.360kuai.com/following/getFollowList",data:{sign:"360_fc624efc",uid:s.guid,token:e+"|"+So.lib.md5(s.guid+"fdasof09vni234rk23b498uvo234eo14n123b12v31v23c1y23y1u"+e),f:"jsonp",page:Math.max(s.currPage,s.requestPage)},type:"get",timeout:5e3,dataType:"jsonp",success:function(e){o.noData||(e&&e.data&&!e.data.res.length&&1==s.currPage&&s.neverDataCb?s.neverDataCb(o):(e&&e.data&&e.data.res.length?(t.beforeCb(),(e=o.Source.focus.formatData.call(o,e.data.res)).length&&o.render(e,t.noRender),setTimeout(function(){t.afterCb(o)},0)):(o.setNoData(t),t.failCb(o)),s.currPage++))},error:function(){1==s.currPage&&s.neverDataCb?s.neverDataCb(o):(o.setNoData(t),t.failCb(o))}}),s.requestPage++)},formatData:function(e){for(var t=[],o={},s=0,a=e.length;s<a;s++)(o=e[s]).t&&o.f&&o.pcurl&&o.p&&t.push({type:"news",liClass:"papi",date:1e3*o.p,title:o.t,from:o.f,url:o.pcurl,source:o.f,covers:o.i?o.i.split("|"):[]});return t}}},clearUpData:function(e){for(var t=[],o={},s=0,a=e.length;s<a;s++){var i,n,l,r=(i=e[s]).title,c=this.options,d=i.covers,p="";if(""!=c.guid&&i.zmt&&i.zmt.id&&i.zmt.is_followed&&i.zmt.name&&i.zmt.pic&&(n=i.zmt.id,p='<span class="'+("1"==(l=i.zmt.is_followed)?"res-news-flow-button-cancel-follow":"res-news-flow-button-follow")+'" data-zmt-id="'+n+'" data-zmt-is-followed="'+l+'" data-zmt-name="'+i.zmt.name+'" data-zmt-pic="'+i.zmt.pic+'">'+("1"==l?"已关注":"+关注")+"</span>"),o={dataSource:c.source,from:i.from,type:i.type,playCount:i.playCount,source:i.source,title:"",titleLong:r,titleFull:$.trim(NewsFlow.Tools.getTxt(r)),corner:i.corner,covers:[],coversWidth:0,coversHeight:0,liCoversClass:"",url:i.url,date:i.date,liClass:i.liClass+" "+i.type,attr:i.attr,tag:"",followButton:p},$.isNumeric(o.date)&&(o.date="<span>"+NewsFlow.Tools.formatTime(new Date(o.date),"yyyy-MM-dd hh:mm",1).replace(" 00:00","")+"</span>"),o.source&&(o.source='<span style="margin-right:5px">'+o.source+"</span>"),c.isShowTag&&i.tag&&(o.tag='<span class="vertical-line"></span><span class="tag-weak">'+i.tag+"</span>"),"atlas"==i.type){o.covers=d.slice(0,2),o.coversWidth=c.atlasImg.width,o.coversHeight=c.atlasImg.height;for(var u=0,f=o.covers.length;u<f;u++){var m=NewsFlow.Tools.sslReplace(NewsFlow.Tools.getPicUrl(o.covers[u],"/dmt/"+o.coversWidth+"_"+o.coversHeight+"_"));o.covers[u]={style:' class="anim"',src:m}}o.title=r}else if(d.length>=c.manyImg.count&&!c.onlyShowSingleImg){c.manyImg.isShowCorner||(o.corner=""),o.covers=d.slice(0,c.manyImg.count),o.coversWidth=c.manyImg.width,o.coversHeight=c.manyImg.height;for(u=0,f=o.covers.length;u<f;u++){var m=NewsFlow.Tools.sslReplace(NewsFlow.Tools.getPicUrl(o.covers[u],"/dmt/"+o.coversWidth+"_"+o.coversHeight+"_"));o.covers[u]={style:' class="anim"',src:m}}o.title=r}else 0<d.length?("video"!==i.type&&(o.corner=""),o.liCoversClass="single-img",o.covers=d.slice(0,1),o.coversWidth=c.singleImg.width,o.coversHeight=c.singleImg.height,m=NewsFlow.Tools.sslReplace(NewsFlow.Tools.getPicUrl(o.covers[0],"/dmt/"+o.coversWidth+"_"+o.coversHeight+"_")),o.covers[0]={style:' class="anim"',src:m},o.title=NewsFlow.Tools.cutStr(r,c.singleImg.titleLength)):c.onlyShowSingleImg||(o.title=NewsFlow.Tools.cutStr(r,c.noImg.titleLength));o.title=NewsFlow.Tools.unescapeHTML(o.title),t.push(o)}return t},hideLoading:function(){this.$loading.hide()},render:function(e,t){var o=this,s=o.options,a=s.eventMark;e=o.clearUpData(e);for(var i=[],n=0;n<e.length;n++)i.push(NewsFlow.Tools.template(s.template,$.extend(e[n],{tplType:"news"})));o.$flowInner.append(i.join("")),o.activateFollowButton(),setTimeout(function(){s.renderAfterCb(o),t||NewsFlow.Tools.observer.publish(a+".rendered")},0),o.sendLog({type:"flow-ajax"})},getData:function(e){this.Source[this.options.source].getData.call(this,e)},setNoData:function(e){var t=this,o=t.options,s=o.$newsFlow.find("li").length;if(t.currRetryGetDataTimes<o.retryGetDataTimes)return t.currRetryGetDataTimes++,void t.getData(e);t.noData||(t.noData=!0,o.noDataCb(t,s),t.hideLoading(),0<s?t.$flowInner.after(NewsFlow.Tools.template(o.template,{tplType:"noData"})):t.removeFlow())},removeFlow:function(){var e=this.options;e.removeFlowCb(this),1!=e.alwaysShowFlow&&e.$newsFlow.remove()},gotoTop:function(){this.options.showGotoTop&&($(window).scrollTop()>this.options.gotoTopDis?this.$gotoTop.fadeIn():this.$gotoTop.fadeOut())},scrollLoad:function(e){var t,o,s;(e=e||this).noData||(t=e.options,s=(o=$(window)).height(),$(document).height()-o.scrollTop()-s<s&&(e.getData(),t.$newsFlow.find("li").length&&e.$loading.show()))},sendLog:function(e){var t=this.options;NewsFlow.Tools.log(t.logMark,$.extend({p1:t.from,p2:t.source,datatype:t.type,abid:t.$newsFlow.attr("data-abtest-id")},e))},eventBind:function(){var t,o,a=this,s=a.options,i=$(window),n=s.eventMark,e=s.eventMark.replace(/\./g,""),l=s.$newsFlow,r=0;i.off("."+e+"WinScroll").on("scroll."+e+"WinScroll.haosou",function(e){l.is(":visible")&&!a.noData&&(s.scrollCb(a),s.preventScrollLoad||(clearTimeout(t),t=setTimeout(function(){a.scrollLoad(a)},500)),s.showGotoTop&&a.gotoTop(),NewsFlow.Tools.observer.publish(n+".scroll",i.scrollTop()>r),r=i.scrollTop())}),a.$gotoTop.on("click",function(){a.sendLog({type:"go-top"}),$("html, body").animate({scrollTop:0},300)}).appendTo($("body")),l.on("click",function(e){var t=$(e.target),o=t.closest('li[data-from^="news"]'),e=a.Source[a.options.source];if(o.length)if(t.is(".close-list a")){var s=e.closeLog;s&&s(a,o),a.sendLog({type:"close-news",value:t.attr("data-val")}),o.slideUp(100,function(){o.remove(),l.find("li").length||a.removeFlow(),NewsFlow.Tools.observer.publish(n+".flowHeightChange")}),a.addNews()}else if(t.closest("a").length){s=function(e){a.sendLog({type:e,pos:o.index()+1,p3:o.attr("data-log-extend"),value:t.attr("data-log"),urls:o.find("a:eq(0)").attr("data-mdurl")||o.find("a:eq(0)").attr("href"),viewtype:o.find(".sub-title").text(),source:o.find(".tag").text(),template:o.attr("data-type")})},e=e.clickLog;if(e&&e(a,o),t.is(".desc .tag"))return s("flow-click-tag"),location.href="//www.so.com/s?src=soflow_tag&q="+encodeURIComponent(t.text()),!1;s("flow-click")}}).on("mouseenter","div.close",function(e){$(e.target).closest("li").addClass("curr"),l.find("div.close").removeClass("hover"),l.find(".close-list").remove(),clearTimeout(o),$(this).addClass("hover").append(NewsFlow.Tools.template(s.template,{tplType:"closeList"}))}).on("mouseleave","div.close",function(e){var t=$(this);$(e.target).closest("li").removeClass("curr"),clearTimeout(o),o=setTimeout(function(){t.removeClass("hover").find(".close-list").remove()},200)}),$("body").on("click",function(e){$(e.target).closest(".flow-follow-guider-tip-container-home1").length||$(".flow-follow-guider-tip-container-home1").remove()})},addNews:function(){var e=this.options;this.noData||(e.addNewsCb!=$.noop?e.addNewsCb(this):this.scrollLoad())},subscribe:function(){var e=this,t=e.options.eventMark;NewsFlow.Tools.observer.subscribe(t+".addNews",function(){e.addNews()}),NewsFlow.Tools.observer.subscribe(t+".closeFlow",function(){e.removeFlow()})},activateFollowButton:function(){function a(e){return void 0!==(e=e.attr("data-isLoading"))&&"0"!=e}var e,p=this.options,t=$("span[class^=res-news-flow-button]");t.length&&!this.hasSendFollowButtonSrpLog&&(e="www"==So.comm.pid?"news-flow":"homecard",So.lib.log(e,{type:"button-show"}),this.hasSendFollowButtonSrpLog=!0),t.unbind("mouseenter"),t.on("mouseenter",function(){var e=$(this);if(a(e))return!1;if($(".flow-follow-guider-tip-container").length||$(".flow-follow-guider-tip-container-home").length||$(".flow-follow-guider-tip-container-home1").length)return!1;if($(".flow-follow-error-tip-container").length)return!1;var t=e.closest("a[data-log='link']"),o=t.attr("title");void 0!==o&&(t.attr("data-title-temp",o),t.removeAttr("title"));var s=e.attr("data-zmt-is-followed"),o=$("<div class='res-news-flow-follow-msg-tip'>"+(1==s?"点击取消关注":"点击关注")+"</div>"),t=e.position().top-15,s=e.position().left+36;o.css({top:t,left:s}),o.insertAfter(e)}),t.unbind("mouseleave"),t.on("mouseleave",function(){var e=$(this);if(a(e))return!1;$(".res-news-flow-follow-msg-tip").remove();var t=e.closest("a[data-log='link']"),e=t.attr("data-title-temp");void 0!==e&&(t.attr("title",e),t.removeAttr("data-title-temp"))}),t.unbind("click"),t.on("click",function(){function e(t){s=l,e=$("<div class='follow-button-loading-div'></div>"),s.append(e),s.attr("class","res-news-flow-follow-loading"),s.attr("data-isLoading",1);function o(){(function(e,t){$(".flow-follow-error-tip-container").remove(),errorMsg=1==t?"关注失败，请再试一次":"取消关注失败，请再试一次";var o=e.closest('li[data-from^="news-"]');o.css({overflow:"visible"});var s=$("<div class='flow-follow-error-tip-container'></div>"),a=$("<div class='tip-left-triangle'></div>"),t=$("<div class='error-tip-msg-panel'>"+errorMsg+"</div>");s.append(a),s.append(t);t=e.position().top-2,e=e.position().left+48;s.css({top:t,left:e}),o.append(s),setTimeout(function(){o.css({overflow:"hidden"}),$(".flow-follow-error-tip-container").remove()},2e3)})(l,t),i(t,0),n(r,1==t?2:1),""==p.guid&&So.lib.log("news-flow",{type:"no-uid"})}var e,s,a="www"==So.comm.pid?"360_e39369d1":"360_fc624efc";$.ajax({url:"https://user.360kuai.com/following/add",data:{uid:p.guid,token:(e=p.guid,(s=(new Date).getTime()/1e3)+"|"+So.lib.md5(e+"fdasof09vni234rk23b498uvo234eo14n123b12v31v23c1y23y1u"+s)),do:t,id:r,sign:a,device:2,net:5,scene:1,where:"list",name:c,pic:d,f:"jsonp"},method:"get",dataType:"jsonp",crossDomain:!0,timeout:2e4,success:function(e){e.data!=t?o():(i(t,1),n(r,t),1==t&&function(e){{var t,o,s,a,i;void 0===So.lib.cookie.get("hasUseFollowBtn")&&((s=new Date).setTime(s.getTime()+864e8),s={expires:s.toGMTString()},So.lib.cookie.set("hasUseFollowBtn",1,s),(t=e.closest('li[data-from^="news-"]')).css({overflow:"visible"}),o=$("<div class='flow-follow-guider-tip-container'></div>"),"www"==So.comm.pid?(s=$("<div class='tip-left-triangle'></div>"),i=$("<div class='guider-tip-msg-panel'>关注后可以在屏幕右上方“我的关注”中看到更新内容啦~</div>"),a=$("<a href='javascript:;' class='guider-tip-close-button'></a>"),o.append(s),o.append(i),o.append(a),0):"home"==So.comm.pid&&(o.attr("class","flow-follow-guider-tip-container-home1"),a=$('<div class="tip-close-btn"></div>'),o.append(a),0),i=e.position().top-2,e=e.position().left+48,o.css({top:i,left:e}),t.append(o),a.on("click",function(){t.css({overflow:"hidden"}),o.remove()}),o.show(),setTimeout(function(){t.css({overflow:"hidden"}),o.remove()},1e4))}}(l))},error:function(){o()}})}function i(e,t){var o=0==t?"fail ":"",t="www"==So.comm.pid?"news-flow":"homecard";So.lib.log(t,{type:1==e?o+"like":o+"notlike",mid:So.lib.getUnMid(So.comm.md||So.lib.cookie.get("__md"))})}function n(e,t){e=$("span[class^=res-news-flow-][data-zmt-id='"+e+"']");e.attr("data-isLoading",0),1==t?(e.text("已关注"),e.attr("class","res-news-flow-button-cancel-follow"),e.attr("data-zmt-is-followed",1)):(e.text("+关注"),e.attr("class","res-news-flow-button-follow"),e.attr("data-zmt-is-followed",0))}$(".flow-follow-guider-tip-container-home1").remove();var l=$(this);if(a(l))return!1;$(".res-news-flow-follow-msg-tip").remove(),$(".flow-follow-guider-tip-container").remove();var t=l.attr("data-zmt-is-followed"),r=l.attr("data-zmt-id"),c=l.attr("data-zmt-name"),d=l.attr("data-zmt-pic");return e(1==t?2:1),!1})},init:function(){var e=this,t=e.options;t.initCb(e),e.eventBind(),e.subscribe(),e.sendLog({type:"show"}),e.$flowInner.after(e.$loading),t.showGotoTop&&e.$gotoTop.appendTo($("body")),e.activateFollowButton()}},define("js/news-flow/flow",function(){}),function(){function n(){return So.lib.checkAbv(1078,"ad_test")&&-1!=$.inArray(So.newsFlow.type,["official","weather","famous","video","news"])}var o;NewsFlowSad=function(e){var t=this,o={$newsFlow:So.newsFlow.$newsFlow,showId:So.newsFlow.showId,eventMark:So.newsFlow.eventMark,logMark:So.newsFlow.logMark,type:So.newsFlow.type,qcmsData:null,showQcmsData:!1,startPos:So.newsFlow.flowQcms.resultAdStart,step:So.newsFlow.flowQcms.resultAdStep,onlyShowSingleImg:!1,onlyShowSingleManyImg:!1,jumpShow:!0,guid:So.comm.guid,template:"",video:{height:201},bigImg:{width:540,height:201},squareImg:{count:4,width:132,height:132},bannerImg:{width:540,height:64},manyImg:{count:4,width:132,height:84},singleImg:{width:132,height:84,titleLength:100},insertCb:$.noop};t.options=$.extend(!0,{},o,e),t.currPos=t.options.startPos,t.html=[],t.page=1,t.timer,t.timerVideo,t.deck=!0,t.delCount=20,t.mouseDownTime=0,t.mouseUpTime=0,t.init()},NewsFlowSad.Tools={checkImg:function(){var e=event.srcElement;$(e).remove(),e.onerror=null},formatSeconds:function(e){e=[parseInt(e/60/60),parseInt(e/60%60),parseInt(e%60)];return 0===e[0]&&e.shift(),e.join(":").replace(/\b(\d)\b/g,"0$1")},log:So.lib.log,cutStr:So.lib.cutStr,template:So.lib.template,observer:So.lib.observer,isVisible:So.lib.isVisible1,soLocalStorage:So.lib.soLocalStorage},NewsFlowSad.prototype={init:function(){this.options.showQcmsData&&this.clearUpQcmsData(),this.bindEvent(),this.insert()},bindEvent:function(){var i=this,o=i.options.$newsFlow,s=i.options.eventMark;NewsFlowSad.Tools.observer.subscribe(s+".rendered",function(){i.insert(i)}),NewsFlowSad.Tools.observer.subscribe(s+".scroll",function(e){i.scrollEevent(i,e)}),o.on("mousedown","li[data-from=sad]",function(){i.mouseDownTime=+new Date}).on("mouseup","li[data-from=sad]",function(e){i.mouseUpTime=+new Date;var t,o=$(this),s=$(e.target),a=s.closest("a");a.length&&a.attr("data-href")&&(t=Math.abs(parseInt(s.offset().left-o.offset().left+e.offsetX)),e=Math.abs(parseInt(s.offset().top-o.offset().top+e.offsetY)),a.attr("href",i.macro(a.attr("data-href"),t,e,o.width(),o.height())),i.sendAdLog(i.macro(o.data("clktk"),t,e,o.width(),o.height())),i.sendLog({type:"sad-click",pos:o.index()+1,value:s.attr("data-log")})),n()&&i.sendLog({type:"test-sad-click",pos:o.index()+1})}).on("click","li[data-from=sad] .close-list a",function(e){var t=$(this).closest("li"),e=$(e.target);t.data("clstk")&&i.sendAdLog(i.macroDel(t.data("clstk"),e.attr("data-val"))),NewsFlowSad.Tools.observer.publish(s+".addNews"),i.sendLog({type:"close-sad",pos:t.index()+1,value:e.attr("data-val")}),i.delAd(t)}).on("click","li[data-from=sad] .horn",function(e){var t=$(this).closest("li").find("video")[0],e=$(e.target);e.hasClass("open")?(e.removeClass("open"),t.muted=!0):(o.find(".horn").removeClass("open"),e.addClass("open"),$.each(o.find("video"),function(e,t){t.muted=!0}),t.muted=!1)}).on("click","li[data-from=sad] .play",function(e){var t=$(this).closest("li"),o=t.find("video")[0],s=$(this);i.videoPlayTime(s,o),o.paused?(o.play(),s.addClass("paused"),t.removeClass("manual-stop")):(o.pause(),s.removeClass("paused"),t.addClass("manual-stop"))}).on("click","li[data-from=sad-qcms]",function(e){var t=$(e.target),e=$(this);t.is(".close-list a")?(i.delAd(e),i.sendLog({type:"close-qcms-sad"})):t.closest("a").length&&i.sendLog({type:"sad-qcms-click",pos:e.index()+1,value:t.attr("data-log")})})},videoPlayTime:function(e,t){t.ontimeupdate=function(){e.find(".time").text(NewsFlowSad.Tools.formatSeconds(Math.floor(t.duration-t.currentTime)))}},calculateAdPos:function(e){var t=this.options;this.currPos=e?t.startPos:t.$newsFlow.find('li[data-from="sad"]:last').index()+t.step+1},delAd:function(e){var t=this,o=t.options.$newsFlow,s=t.options.eventMark;e.slideUp(100,function(){e.remove(),o.find("li").length||NewsFlowSad.Tools.observer.publish(s+".closeFlow"),NewsFlowSad.Tools.observer.publish(s+".flowHeightChange"),t.calculateAdPos()})},macroDel:function(e,t){return e.replace(/__DISLIKE_RULE_ID__|__DISLIKE_TAG__/g,function(e){return{__DISLIKE_RULE_ID__:t,__DISLIKE_TAG__:"不感兴趣"}[e]})},macro:function(e,t,o,s,a){var i=this;return e.replace(/__OFFSET_X__|__OFFSET_Y__|__EVENT_TIME_START__|__EVENT_TIME_END__|__ADSPACE_W__|__ADSPACE_H__/g,function(e){return{__OFFSET_X__:t,__OFFSET_Y__:o,__EVENT_TIME_START__:i.mouseDownTime,__EVENT_TIME_END__:i.mouseUpTime,__ADSPACE_W__:s,__ADSPACE_H__:a}[e]})},clearUpQcmsData:function(){var e=this.options,t=e.qcmsData;if(t){var o=(o=NewsFlowSad.Tools.soLocalStorage.getItem("delAd"))?JSON.parse(o):[];if(t&&!~$.inArray(t.title,o)){o.push(t.title),NewsFlowSad.Tools.soLocalStorage.setItem("delAd",JSON.stringify(o));for(var o={from:"sad-qcms",curl:t.curl,isBanner:parseInt(t.isBanner),isShowAd:parseInt(t.isShowAd),title:t.title||"",desc:t.desc||"",src:t.src||""},s=!1,a=0,i=t.imgs.length;a<i;a++)if(""==t.imgs[a].img||""==t.imgs[a].curl){s=!0;break}o.isBanner||s||e.onlyShowSingleImg?o.img=t.imgs[0].img:o.assets=t.imgs,(o.img||o.assets)&&(this.currPos=parseInt(t.pos)),this.sendLog({type:"show-qcms-sad"}),this.clearUpData([o])}}},sendLog:function(e){var t=this.options;NewsFlowSad.Tools.log(t.logMark,$.extend({},{abid:t.$newsFlow.attr("data-abtest-id"),datatype:t.type},e))},sendAdLog:function(e){if(e){var t;e=e.split("||"),window.sadLog={};for(var o=0,s=e.length;o<s;o++)t="log_"+ +new Date,sadLog[t]=new Image,sadLog[t].onload=sadLog[t].onerror=function(){delete sadLog[t]},sadLog[t].src=e[o]}},imptkLog:function(o){var e=(o=o||this).options;$.each(e.$newsFlow.find('li[data-from="sad"]'),function(e,t){t=$(t);!t.data("imptked")&&NewsFlowSad.Tools.isVisible(t[0])&&(t.data("imptked",1),o.sendLog({type:"sad-show"}),o.sendAdLog(t.data("imptk")))})},scrollEevent:function(n,e){var t=(n=n||this).options,l=!1;n.imptkLog(n),clearTimeout(n.timerVideo);var o=t.$newsFlow.find('li[data-from="sad"]'),o=e?$(o.get().reverse()):o;n.timerVideo=setTimeout(function(){$.each(o,function(e,t){var o=$(t),s=o.find("video"),a=s[0],i=o.find(".play");!o.hasClass("manual-stop")&&s.length&&(s=t.getBoundingClientRect(),!l&&NewsFlowSad.Tools.isVisible(t)&&30<s.top&&-100<$(window).height()-s.bottom?(i.addClass("paused"),a.play(),n.videoPlayTime(i,a),l=!0):(i.removeClass("paused"),a.pause()))})},40)},insert:function(e){var t=(e=e||this).html,o=e.currPos,s=e.options,a=s.step,i=s.$newsFlow;t.length<2&&(clearTimeout(e.timer),e.timer=setTimeout(function(){e.getData(e)},1e3)),0<=i.find("li:not([class*=to-front])").length-(o+1)&&0<t.length&&(i.find("li:not([class*=to-front]):eq("+o+")").before(t.shift()),e.deck&&s.jumpShow?(e.currPos+=a,e.deck=!1):(e.currPos+=a+1,e.deck=!0),e.insert(),e.scrollEevent(e,!1),s.insertCb())},clearUpData:function(e){for(var t=this.options,o={},s=0,a=e.length;s<a;s++){var i,n=e[s].title,o={img:[],imgWidth:0,imgHeight:0,liCoversClass:"",url:e[s].curl,source:e[s].src,title:n,titleFull:n,imptk:e[s].imptk&&e[s].imptk.join("||"),clktk:e[s].clktk&&e[s].clktk.join("||"),clstk:e[s].clstk&&e[s].clstk.join("||"),from:"sad",sadTxt:'<span class="txt">广告</span>',type:"",duration:"00:00"};if(!t.onlyShowSingleImg&&!t.onlyShowSingleManyImg)switch(e[s].type){case 4:/msie (6|7|8|9)/gi.test(navigator.userAgent)?o.type="bigImg":o.type="video";break;case 3:o.type="bigImg";break;case 2:!e[s].assets||(i=e[s].assets[0])&&i.imgw&&i.imgh===i.imgw&&(o.type="squareImg")}0===e[s].isShowAd&&(o.sadTxt=""),e[s].from&&(o.from=e[s].from,o.liCoversClass=o.from);var l=e[s].assets||[],r=e[s].img||"";if("video"!=o.type||t.onlyShowSingleManyImg)if("bigImg"!=o.type||t.onlyShowSingleManyImg)if("squareImg"==o.type&&l.length>=t.squareImg.count&&!t.onlyShowSingleManyImg){o.liCoversClass+=" square-img",o.imgWidth=t.squareImg.width,o.imgHeight=t.squareImg.height;for(var c=0,d=t.squareImg.count;c<d;c++)o.img[c]={style:' class="anim"',url:l[c].curl,src:l[c].img}}else if(e[s].isBanner)o.liCoversClass+=" banner-img",o.imgWidth=t.bannerImg.width,o.imgHeight=t.bannerImg.height,o.img[0]={style:' class="anim"',url:o.url,src:r};else if(l.length>=t.manyImg.count&&!t.onlyShowSingleImg){o.type="manyImg",o.imgWidth=t.manyImg.width,o.imgHeight=t.manyImg.height;for(c=0,d=t.manyImg.count;c<d;c++)o.img[c]={style:' class="anim"',url:l[c].curl,src:l[c].img}}else r&&(o.type="singleImg",o.liCoversClass+=" single-img",o.imgWidth=t.singleImg.width,o.imgHeight=t.singleImg.height,o.img[0]={style:' class="anim"',url:o.url,src:r},o.title=NewsFlowSad.Tools.cutStr(n,t.singleImg.titleLength));else o.liCoversClass+=" big-img",o.imgWidth=t.bigImg.width,o.imgHeight=t.bigImg.height,r=e[s].img,o.img[0]={style:' class="anim"',url:o.url,src:r};else o.liCoversClass+=" sad-video",o.imgHeight=t.video.height,e[s].duration&&(o.duration=NewsFlowSad.Tools.formatSeconds(e[s].duration)),r=e[s].video,o.img[0]={style:"",url:o.url,src:r};o.img.length&&this.html.push(NewsFlowSad.Tools.template(t.template,$.extend(o,{tplType:"sad"})))}},getData:function(a){var i=a.options;if(n())if(o)o.renderList();else{var e="";switch(So.newsFlow.type){case"official":e="soflow_official";break;case"weather":e="soflow_weather";break;case"famous":e="soflow_famous";break;case"video":e="soflow_video";break;case"news":e="soflow_news"}var t={src:"so-pc-flow",from:e,n:6,srcg:So.newsFlow.type,isNeedTemplate:!1,query:So.comm.q,adTypes:"1,3,5",imgSize:[132,84],useLianmengTitle:!0,renderItem:function(e,t,o,s){console.log(e,t,o,s),a.html.push(NewsFlowSad.Tools.template(i.template,$.extend(t,{src:t.src?"<span>"+t.src+"</span>":"",type:e,tplType:"sadTest"}))),a.insert(a)}};(o=new qhMultiResourceInnV2(t)).init()}else $.ajax({url:"https:"==location.protocol?"//show-g.mediav.com/s?scheme=https":"//show.g.mediav.com/s",type:"get",jsonp:"jsonp",dataType:"jsonp",data:{of:4,type:1,newf:1,impct:8,uid:i.guid,reqtimes:a.page,showid:i.showId,refurl:document.referrer},success:function(e){a.page++,e&&e.ads&&0<e.ads.length&&(a.clearUpData(e.ads),a.insert(a))}})}}}(),define("js/news-flow/sad",function(){}),define("js/home/card/news-flow",["text!html/news-flow.html!strip","js/news-flow/flow","js/news-flow/sad"],function(a){function i(){c.removeClass("limitation").find(".bottom-arrow").remove()}function t(){var e,t=f.$gotoTop;t.is(":hidden")||(e=$("body").hasClass("widescreen")?20:10,t.css({left:p.offset().left+p.width()-w.scrollLeft()+e}))}function o(){c.prepend(So.lib.template(a,{tplType:"tab",data:b})).find(".top-tab a").on("click",function(){var e,t,o=$(this),s=c.offset().top-76;y=o.attr("data-param"),c.off("click mouseenter mouseleave"),d.empty(),0==S&&(n(),"mylike"==y?(t={type:e=y,template:a,manyImg:{width:178,height:113},singleImg:{width:178,height:113}},f=new NewsFlow($.extend({debugTxt:"home.card.focus",source:"focus",initCb:function(e){e.getData(),setTimeout(l,10)},renderAfterCb:function(e){u.show(),l(),c.find(".close").hide()},neverDataCb:function(){n(),d.before('<div class="focus-top-txt">您还没有关注作者<br>建议您查看“热门资讯推荐”，遇见喜欢的内容可以点击关注～</div>'),d.before('<div class="focus-top-title">热门资讯推荐</div>'),c.off("click mouseenter mouseleave"),r(e)}},t))):r(y)),m.options.type=y,i(),o.addClass("selected").siblings().removeClass("selected"),$("#card_container").css({minHeight:w.height()-100}),0==S&&(g?w.scrollTop(s):$("html, body").animate({scrollTop:s},500),So.lib.log("homecard",{type:"click_"+y}))}),$("#res_news_flow .top-tab a.selected").removeClass("selected"),$("#res_news_flow .top-tab a:eq(1)").addClass("selected")}function s(){var a=$(window).height(),i=$("body").scrollTop()||$("html").scrollTop()||0;c.find("li[data-from^=news]").each(function(e,t){var o=$(t),s=o.offset().top,t=o.height();"1"!==o.attr("data-log-gz")&&s<i+a-t&&90<s-i&&(o.find("span[class^='res-news-flow-button-']").length&&So.lib.log("homecard",{type:"has-follow-button",ext:e}),o.attr("data-log-gz","1"))})}function n(){$(".focus-top-txt").remove(),$(".focus-top-title").remove(),$("#goto-top").remove(),$(".no-more").remove(),c.find(".loading").remove()}function l(){c.find(".card-loading").remove(),c.find(".loading.short").removeClass("short")}function r(e){e={type:e,template:a,manyImg:{width:178,height:113},singleImg:{width:178,height:113}};f=new NewsFlow($.extend({debugTxt:"home.card",source:"baoDian",preferences:{Q:So.lib.cookie.get("Q"),T:So.lib.cookie.get("T"),guid:So.comm.guid,qid:So.comm.user.qid,sign:"360_fc624efc",sqid:""},initCb:function(e){e.getData(),setTimeout(l,10)},renderAfterCb:function(e){u.show(),l()}},e))}var c,d,p,u,f,m,w=$(window),g=!1,h=So.newsFlow.flowQcms.homeAdStart,v=So.newsFlow.observerEvent,b=[{txt:"关注",param:"mylike"},{txt:"热点",param:"youlike"},{txt:"娱乐",param:"fun"},{txt:"房产",param:"estate"},{txt:"体育",param:"sport"},{txt:"国内",param:"domestic"},{txt:"辟谣",param:"refuteRumour"},{txt:"汽车",param:"car"},{txt:"国际",param:"international"}],S=!1,y="youlike";return{init:function(){var e;p=So.newsFlow.$cardContainer,c=So.newsFlow.$newsFlow,d=c.find("ul"),u=c.find(".bottom-arrow"),function(e){var t,e={type:e,template:a,manyImg:{width:178,height:113},singleImg:{width:178,height:113}};if(So.newsFlow.adsQcmsData.length)for(var o=0;o<So.newsFlow.adsQcmsData.length;o++)if(1==So.newsFlow.adsQcmsData[o].isHome){t=So.newsFlow.adsQcmsData[o];break}m=new NewsFlowSad($.extend({showId:"lDwum1",step:So.newsFlow.flowQcms.step,startPos:h,onlyShowSingleManyImg:!0,jumpShow:!1,showQcmsData:!0,qcmsData:t},e))}(y||b[0].param),r(y||b[0].param),o(),w.on("scroll mousewheel DOMMouseScroll",i),u.on("click",i),So.lib.observer.subscribe(v.infoFlowTabFixed,function(e){g=e.isOk}),w.on("resize",function(){clearTimeout(e),e=setTimeout(t,50)}),w.on("scroll",function(){clearTimeout(void 0),e=setTimeout(t,50)}),setTimeout(function(){s()},3e3,!0),So.lib.observer.subscribe(So.newsFlow.eventMark+".scroll",function(){s()})}}}),define("js/home/card/often-so",[],function(){function o(){for(var e=0,t=(n=n.concat(r)).length;e<t;e++)n[e].kw?"hnews"!=n[e].from&&l.push({kw:n[e].kw,icon:So.lib.getPicUrl(n[e].icon,"/dmt/13_13_"),type:"user"}):l.push({kw:n[e],type:"qcms"});if(l=function(e){for(var t=[],o=So.lib.soLocalStorage.getItem("often-del")||JSON.stringify([]),o=JSON.parse(o),s=0,a=e.length;s<a;s++){for(var i=!1,n=0,l=o.length;n<l;n++)if(e[s].kw==o[n]){i=!0;break}i||t.push(e[s])}for(var r=[],s=0,a=t.length;s<a;s++){i=!1;for(n=0,l=r.length;n<l;n++)if(t[s].kw==r[n].kw){i=!0;break}i||r.push(t[s])}return r}(l),a.append(f.tools),!l.length)return a.find(".edit").hide(),void i.html(f.noData);i.html(So.lib.template(f.list,{data:l}))}var s,a,i,n=[],l=[],r=So.newsFlow.oftenSoData,c=50,d=So.lib.cookie.get("__huid")||"",p="//query.rec.360.cn/gasucs/query_rec",u=So.newsFlow.logMark,f={list:["<% for(var i = 0, len = data.length; i < len; i++){ %>","<span>",'   <a class="txt g-ellipsis" href="/s?ie=utf-8&q=<%= encodeURIComponent(So.lib.unescapeHTML(data[i].kw)) %>&src=so_isearch" target="_blank" title="<%= So.lib.escapeHTML(data[i].kw) %>"><%= data[i].icon ? "<img class=ico width=13px height=13px src=" + data[i].icon + ">" : "" %><%= So.lib.escapeHTML(data[i].kw) %></a>','   <a class="del g-icon" href="javascript:;" data-kw="<%= So.lib.escapeHTML(data[i].kw) %>" data-type="<%= data[i].type %>" title="删除"></a>',"</span>","<% } %>"].join(""),tools:['<span class="tools">','<span class="g-icon icon"></span>','<span class="finish">完成</span>','<span class="g-icon">','<div class="g-menu">','<i class="g-icon"></i>','<a href="javascript:;" class="edit">编辑</a>','<a href="javascript:;" class="close">关闭</a>',"</div>","</span>","</span>"].join(""),noData:'<div class="no-data">您暂时没有常搜词哦~</div>'};return{init:function(){1!=So.lib.cookie.get(So.newsFlow.closeOffensoCookieMark)&&(s=$("#often_so"),a=s.find(".title"),i=s.find(".list"),$.ajax({url:p,dataType:"jsonp",data:{src:"so_home",ret_type:"jsonp",req:"kw",mid:So.comm.md,guid:d},jsonp:"callback",timeout:2e3,jsonpCallback:"__query_rec",success:function(e){if(e&&e.status&&"stopped"==e.status.data){var t=new Date;return t.setDate(t.getDate()+30),So.lib.cookie.set(So.newsFlow.closeOffensoCookieMark,1,{expires:t}),void s.remove()}e&&e.data&&e.data.length&&(n=n.concat(e.data)),o()},error:function(){o()}}),a.on("click",function(e){e=$(e.target);e.is(".finish")?s.removeClass("edit"):e.is(".edit")?(s.addClass("edit"),So.lib.log(u,{type:"del-edit"})):e.is(".close")&&So.newsFlow.closeMask({title:"确认关闭常搜服务？",desc:"亲，关闭常搜服务将无法快捷的查询感兴趣的内容～",sureTxt:"确认关闭",callback:function(){var e=new Date;e.setDate(e.getDate()+30),So.lib.cookie.set(So.newsFlow.closeOffensoCookieMark,1,{expires:e});e=+new Date;$.ajax({url:p,dataType:"jsonp",data:{mid:So.comm.md,guid:d,src:"so_home",switch:"off",oa:So.lib.md5(So.comm.md+e+"a%&k*b"),action:"off",_t:e},jsonp:"callback",jsonpCallback:"__query_rec"}),So.lib.log(u,{type:"close-oftenso"})}})}),i.on("click",".del",function(){var e=$(this),t=e.attr("data-kw"),o=So.lib.soLocalStorage.getItem("often-del")||JSON.stringify([]);(o=JSON.parse(o)).length==c&&o.shift(),o.push(t),So.lib.soLocalStorage.setItem("often-del",JSON.stringify(o)),"user"==e.attr("data-type")&&(o=+new Date,$.ajax({url:p,type:"get",dataType:"jsonp",jsonp:"callback",jsonpCallback:"__query_rec",data:{mid:So.comm.md,guid:d,src:"del",del_kw:t,oa:So.lib.md5(So.comm.md+t+o+"a%&k*b"),action:"del",_t:o}})),e.closest("span").remove(),i.find("span:lt(20)").css({display:"inline-block"}),i.find("span").length||(a.find(".edit").hide(),i.html(f.noData)),So.lib.log(u,{type:"del-oftenSo"})}),i.on("click",".txt",function(){So.lib.log(u,{type:"oftenso"})}))}}}),define("js/home/card/real-news",[],function(){function s(){p=18,a.html(So.lib.template(u.list,{data:l,page:d,count:p}))}var e,t,a,i,n=$(window),l=So.newsFlow.realTimeNewsData,r=So.newsFlow.logMark,c=So.newsFlow.observerEvent,d=0,p=9,o=Math.floor(l.length/18);l.length=18*o;var u={list:["<% for(var i = page * count, len = (page + 1) * count; i < len; i++){ %>","<% if(!data[i]){ break; } %>",'<%= i % 9 == 0 ? "<div class=wrap>" : "" %>','<div class="item">',"<% if(data[i].url){ %>",'<a class="g-ellipsis" href="<%= data[i].url.replace("http://www.so.com", "https://www.so.com") %>" target="_blank" title="<%= So.lib.escapeHTML(data[i].title) %>"><%= So.lib.escapeHTML(data[i].title) %></a>',"<% }else{ %>",'<a class="g-ellipsis" href="/s?ie=utf-8&q=<%= encodeURIComponent(So.lib.unescapeHTML(data[i].keyword)) %>&src=home_hot" target="_blank" title="<%= So.lib.escapeHTML(data[i].title) %>"><%= So.lib.escapeHTML(data[i].title) %></a>',"<% } %>","<% if(i < 3){ %>","<% if(data[i].rise == 1){ %>",'<span class="hot g-icon"></span>',"<% }else{ %>",'<span class="cold g-icon"></span>',"<% } %>","<% } %>","</div>",'<%= i % 9 == 8 ? "</div>" : "" %>',"<% } %>"].join(""),noData:'<div class="no-data">暂无数据~</div>'};return{init:function(){l.length?(e=$("#real_time_news"),t=e.find(".title"),a=e.find(".list"),t.append('<span class="date">'+So.lib.formatTime2(new Date(l[0].updateTime.replace(/-/g,"/")))+"更新</span>"),l.length>p&&t.append('<a href="javascript:;" class="change"><span class="g-icon"></span>换一换</a>'),i=t.find(".change"),s(),function(){var t;i.on("click",function(){var e=i.find(".g-icon");++d==Math.ceil(l.length/p)&&(d=0),s(),e.addClass("re-circle"),clearTimeout(t),t=setTimeout(function(){e.removeClass("re-circle")},500)});var e,o=0;So.lib.observer.subscribe(c.infoFlowClickTab,function(){o=0}),n.on("scroll",function(){2e3<(e=n.scrollTop())-o&&(i.trigger("click"),o=e)}),a.on("click","a",function(){So.lib.log(r,{type:"hotdot"})})}()):a.html(u.noData)}}}),define("js/home/card/fixed-top",[],function(){function e(){s.width()<1e3&&a.hasClass(r)?l.css({left:1e3-s.width()-s.scrollLeft()}):l.css({left:""})}function t(){var e=u.find(".top-tab a").first();a.hasClass(f)?e.css({marginLeft:p.offset().left-s.scrollLeft()+21}):e.css({marginLeft:""})}function o(){return So.newsFlow.isReadyHotNews&&So.newsFlow.$cardContainer.hasClass("curr-"+So.newsFlow.hotNewsFlag)&&(u=So.newsFlow.$newsFlow,p=So.newsFlow.$cardContainer,1)}var s,a,i,n,l,r,c,d,p,u,f,m,w,g,h;function v(){a.hasClass(f)&&!h&&(a.removeClass(f),t())}So.lib.soLocalStorage&&(s=$(window),a=$("body"),i=So.newsFlow.observerEvent,n=$("#bd_search"),l=n.find("form"),r="search-input-fixed",f="infoflow-tab-fixed",l.wrap('<div class="fixed" />').prepend('<div class="fixed-logo" />'),setTimeout(function(){$("#input").focus()},0),c=n.find(".fixed"),d=n.find(".fixed-logo"),n.css({height:n.height()}),e(),o()&&t(),g=0,h=!1,So.lib.observer.subscribe(i.infoFlowClickTab,function(){h=!0}),s.on("scroll",function(){(w=s.scrollTop())>=n.offset().top-21?(a.hasClass(r)||(So.lib.observer.publish(i.searchboxFixed),a.addClass(r),d.fadeIn(500),$("#input").blur()),n.find(".ac_wrap").hide()):a.hasClass(r)&&(d.hide(),a.removeClass(r),So.lib.observer.publish(i.cancelSearchboxFixed)),e(),o()&&(w>=u.offset().top-c.height()-20?(So.lib.observer.publish(i.infoFlowTabFixed,{isOk:!0}),w<g?a.hasClass(f)||(a.addClass(f),t(),u.find(".fixed").hide().slideDown(200)):v()):(So.lib.observer.publish(i.infoFlowTabFixed,{isOk:!1}),v()),h=!1,setTimeout(function(){g=w},20))}).on("resize",function(){clearTimeout(m),m=setTimeout(function(){e(),o()&&t()},10)}))}),function(l,e,r){var s={$wrapper:null,$container:l("body"),topDist:0,fixedClass:null,preScrollTop:0},a={$elem:null,options:{},currTopDist:0,innerHeight:0,freezeDist:0,$window:l(e),init:function(e,t){var o=this;o.$elem=l(t),o.options=l.extend({},s,e),o.currTopDist=o.options.topDist,o.freezeDist=o.options.$wrapper.offset().top-o.options.topDist,o.position(),o.$window.on("scroll",function(){o.position()}).on("resize",function(){setTimeout(function(){o.position(o)},60)})},reposition:function(){var e=this,t=e.options.$container.height()+e.options.$container.offset().top-e.$window.scrollTop(),t=e.currTopDist+e.$elem.height()-t;e.$elem.height()>=e.innerHeight&&0<t&&(e.currTopDist-=t,e.position())},position:function(e){var t=e||this,o=t.$window.scrollTop(),s=t.$window.height(),a=t.options.$container.height(),i={position:"",left:"",top:""},n={height:""};if(t.$elem.outerHeight(!0)>=a)return t.$elem.css(i),t.options.$wrapper.css(n),void t.$elem.removeClass(t.options.fixedClass);t.innerHeight=t.$elem.height(),o<t.freezeDist&&(t.freezeDist=t.options.$wrapper.offset().top-t.options.topDist),o>t.freezeDist&&a>t.innerHeight?(e=a+t.options.$container.offset().top,t.options.topDist+t.innerHeight>s-(l(r).height()-e)?t.options.preScrollTop>o?t.currTopDist<=t.options.topDist&&(t.currTopDist=t.currTopDist+(t.options.preScrollTop-o)):(0<t.currTopDist+t.innerHeight-s&&(t.currTopDist=t.currTopDist-(o-t.options.preScrollTop)),a=t.currTopDist+t.innerHeight,e=Math.min(e-o,s),t.currTopDist+t.innerHeight-s<=0&&a!=e&&(t.currTopDist=e-t.innerHeight)):t.options.preScrollTop>o&&(t.currTopDist=t.currTopDist+(t.options.preScrollTop-o)),i={position:So.web.feedback?"":"fixed",left:t.options.$wrapper.offset().left-t.$window.scrollLeft(),top:Math.min(t.currTopDist,t.options.topDist)},t.options.fixedClass&&t.$elem.addClass(t.options.fixedClass),n={height:t.$elem.outerHeight(!0)}):(t.options.fixedClass&&t.$elem.removeClass(t.options.fixedClass),t.currTopDist=t.options.topDist),t.$elem.css(i),t.options.$wrapper.css(n),t.options.preScrollTop=o}};l.fn.freezeSidebar=function(e){if(!(So.lib.browser.isIE()&&So.lib.browser.isIE()<8)){Object.create||(Object.create=function(e){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return o.prototype=e,new o});var t=Object.create(a);return t.init(e,this),{reposition:function(){t.reposition()}}}function o(){}}}(jQuery,window,document),define("js/jqueryplus/freeze-sidebar",function(){}),define("js/home/card/main",["js/home/card/news-flow","js/home/card/often-so","js/home/card/real-news","js/home/card/fixed-top","js/jqueryplus/freeze-sidebar"],function(e,t,o){function s(){l.append(So.lib.template(p,{cardSwitch:c})),r=$("#card_container"),So.newsFlow.$cardContainer=r,n.addClass("has-card"),c.hotNews&&(r.addClass("curr-"+a.hotNewsFlag),r.find(".hot-news").css({display:"inline-block"}),f||(f=!0,So.newsFlow.$newsFlow=$("#res_news_flow"),So.newsFlow.$realTimeNews=$("#real_time_news"),So.newsFlow.$oftenSo=$("#often_so"),So.newsFlow.$cardSide=$("#card_side"),e.init(),t.init(),o.init(),So.newsFlow.isReadyHotNews=!0,$("#card_side_wrap").freezeSidebar({topDist:85,$container:So.newsFlow.$cardContainer,$wrapper:So.newsFlow.$cardSide})))}var a,i,n,l,r,c,d,p,u,f,m;So.lib.soLocalStorage&&(a=So.newsFlow,i=So.newsFlow.observerEvent,n=$("body"),l=$("#main"),c={hotNews:!~$.inArray(So.newsFlow.hotNewsStatus,[0,20])},p=['<div id="card_container">','<div class="card-top-line"></div>','<span class="card-close g-icon"></span>','<div class="hot-news-card clearfix">','<div id="res_news_flow" class="limitation"><ul></ul>'+(d='<div class="card-loading"><p><span class="ico"></span>加载中...</p></div>')+'<a href="javascript:;" class="bottom-arrow g-icon"><i class="g-icon"></i></a></div>','<div id="card_side">','<div id="card_side_wrap">',"<% if(So.lib.cookie.get(So.newsFlow.closeOffensoCookieMark) != 1){ %>",'<div id="often_so">','<p class="title">常用搜索</p>','<div class="list">'+d+"</div>","</div>","<% } %>",'<div id="real_time_news">','<p class="title">实时热点</p>','<div class="list">'+d+"</div>",'<a href="//news.so.com/hotnews?src=hotnews" target="_blank" class="more">查看更多>></a>',"</div>","</div>","</div>","</div>","</div>"].join(""),u=['<div id="close-card-mask">','<div class="bubble">','<a href="javascript:;" class="close"></a>',"<h3><%= title %></h3>","<p><%= desc %></p>",'<a href="javascript:;" class="sure-del"><%= sureTxt %></a>','<a href="javascript:;" class="cancel">取消</a>',"</div>","</div>"].join(""),f=!1,So.newsFlow.closeMask=function(o){n.append(So.lib.template(u,o)),$("#close-card-mask").on("click",function(e){var t=$(this),e=$(e.target);e.hasClass("close")||e.hasClass("cancel")?t.remove():e.hasClass("sure-del")?(o.callback(),window.location.reload()):e.is(".bubble")||e.closest(".bubble").length||t.remove()})},m={mid:So.comm.md},So.lib.observer.subscribe(i.addHotNewsCard,function(){var e=new Date;e.setFullYear(e.getFullYear()+1),So.lib.cookie.set(So.newsFlow.hotNewsFlag,1,{expires:e}),So.lib.cookie.set(So.newsFlow.currNavCookieMark,So.newsFlow.hotNewsFlag),So.lib.log("homecard",$.extend({type:"add-hot-news-card"},m)),location.reload()}),So.lib.observer.subscribe(i.closeHotNewsCard,function(){So.newsFlow.closeMask({title:"确认隐藏卡片？",desc:"亲，隐藏卡片后，您将无法第一时间了解热点啦~<br>隐藏后，可在“设置”中开启。",sureTxt:"确认隐藏",callback:function(){var e=new Date;e.setFullYear(e.getFullYear()+1),So.lib.cookie.set(So.newsFlow.hotNewsFlag,0,{expires:e}),So.lib.log(a.logMark,{type:"sure-close-card"})}}),So.lib.log("homecard",$.extend({type:"close-hot-news-card"},m))}),(21==So.newsFlow.hotNewsStatus&&"1"==So.lib.cookie.get(So.newsFlow.hotNewsFlag)||21!=So.newsFlow.hotNewsStatus)&&(So.lib.browser.isIE()&&So.lib.browser.isIE()<9||!c.hotNews||(s(),r.on("click",".card-close",function(e){So.lib.observer.publish(i.closeHotNewsCard)}))))});
