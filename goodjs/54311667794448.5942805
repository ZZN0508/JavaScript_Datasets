var browser=function(){"use strict";var d=function(){return(d=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function l(e,a,c,s){return new(c=c||Promise)(function(n,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof c?t:new c(function(e){e(t)})).then(r,o)}i((s=s.apply(e,a||[])).next())})}function f(n,r){var o,i,a,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,i=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){c.label=t[1];break}if(6===t[0]&&c.label<a[1]){c.label=a[1],a=t;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(t);break}a[2]&&c.ops.pop(),c.trys.pop();continue}t=r.call(n,c)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function p(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(arguments[t]));return e}function v(e){e=e.getBoundingClientRect();return 0<=e.top&&0<=e.left&&Math.floor(e.bottom)<=(window.innerHeight||document.documentElement.clientHeight)&&Math.floor(e.right)<=(window.innerWidth||document.documentElement.clientWidth)}function e(n,r){var o;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];clearTimeout(o),o=setTimeout(function(){n.apply(void 0,p(e))},r)}}function t(){window.addEventListener("scroll",n,{passive:!0}),window.addEventListener("scroll",E,{passive:!0}),r.observe(document,{childList:!0,subtree:!0})}var h=[],w={invID:"",token:""},m=!1,b=Array.prototype.forEach,E=e(function(){var n;0!==(n=h.filter(function(e){return e.trackingView&&!e.isViewed})).length&&n.forEach(function(e){var t;v(e.element)&&((t=new XMLHttpRequest).open("GET",e.trackingView+"&render=false"),t.withCredentials=!0,t.timeout=2e3,t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&200===t.status&&(e.isViewed=!0,e.element.setAttribute("data-tdn_impressed","true"))},t.send(),window.dispatchEvent(new CustomEvent("impressionTDN",{detail:n})))})},75),n=e(function(){return l(void 0,void 0,void 0,function(){var s,c,u;return f(this,function(e){switch(e.label){case 0:return m?[2]:(m=!0,[4,void(0<(a=document.querySelectorAll('[data-id*="tdn-"]:not([data-triggered="true"])')).length&&b.call(a,function(e){var r,t;v(e)&&(r=Object.assign({},e.dataset),t=Object.keys(r).reduce(function(e,t){var n=t.replace(/([-_][a-z])/g,function(e){return e.toUpperCase().replace("-","").replace("_","")});return Object.assign(e,((e={})[n]=r[t],e))},{element:e}),e.setAttribute("data-triggered","true"),h.push(t))}))]);case 1:return e.sent(),0===(s=h.filter(function(e){return!e.isFetched})).length?(m=!1,[2]):(t=s,n=p(new Set(t.map(function(e){return e.dimenId}))).join(","),i=p(new Set(t.map(function(e){return e.depId}))).join(","),a=p(new Set(t.map(function(e){return e.productId}))).join(","),c=d(d(d(d({dimen_id:n,ep:"banner",device:t[0].device||"desktop",inventory_id:t[0].inventoryId||"0",user_id:t[0].userId||"0",item:t.length},w.token&&t[0].inventoryId===w.invID?{page_token:w.token}:{}),i?{dep_id:i}:{}),a?{product_id:a}:{}),t[0].q?{q:t[0].q}:{}),[4,(r=c,o=s,new Promise(function(t){var n=new XMLHttpRequest,e="https://ta.tokopedia.com/v1.3/display?"+Object.entries(r).map(function(e){return e.map(encodeURIComponent).join("=")}).join("&");n.withCredentials=!0,n.timeout=2e3,n.onreadystatechange=function(){var e;n.readyState===XMLHttpRequest.OPENED&&window.dispatchEvent(new CustomEvent("onStartRequestTDN",{detail:{code:"100",desc:"Request banner ads started",error:!1,bannerData:o,response:null}})),n.readyState===XMLHttpRequest.LOADING&&window.dispatchEvent(new CustomEvent("onProcessRequestTDN",{detail:{code:"101",desc:"Request banner ads in the process",error:!1,bannerData:o,response:null}})),n.readyState===XMLHttpRequest.DONE&&(200===n.status?(e=JSON.parse(n.responseText),t(e),window.dispatchEvent(new CustomEvent("onSuccessRequestTDN",{detail:{code:"200",desc:"Request banner ads was successful",error:!1,bannerData:o,response:e}}))):(t({errors:!0}),window.dispatchEvent(new CustomEvent("onErrorRequestTDN",{detail:{code:"500",desc:"Request banner ads was failed",error:!0,bannerData:o,response:null}}))))},n.onerror=function(){t({errors:!0}),window.dispatchEvent(new CustomEvent("onErrorRequestTDN",{detail:{code:"400",desc:"Request banner ads was failed",error:!0,bannerData:o,response:null}}))},n.ontimeout=function(){t({errors:!0}),window.dispatchEvent(new CustomEvent("onTimeoutRequestTDN",{detail:{code:"408",desc:"Request banner ads was timeout",error:!0,bannerData:o,response:null}}))},n.open("GET",e,!0),n.send()}))]);case 2:return(u=e.sent()).errors?[4,s.forEach(function(e){e.isFetched=!0})]:[3,4];case 3:return e.sent(),m=!1,[2];case 4:return w={invID:s[0].inventoryId||"",token:u.header&&u.header.pagination&&u.header.pagination.next_page_token||""},s.forEach(function(a,c){return l(void 0,void 0,void 0,function(){var t,n,r,o,i;return f(this,function(e){return n=document.createElement("img"),r=document.createElement("a"),o=u.data[c]&&u.data[c].ad_click_url||"",i=u.data[c]&&u.data[c].ad_view_url||"",0<u.data.length&&u.data.forEach(function(e){t=e.banner.images.filter(function(e){return String(e.image_dimension.dimen_id)===a.dimenId}).map(function(e){return e.full_ecs})}),r.href=o||"",n.src=t||"",n.onload=function(){a.element.setAttribute("data-fetched","true")},a.isFetched=!0,a.trackingClick=o,a.trackingView=i,a.responseData=u,a.element.appendChild(r),r.appendChild(n),a.element.addEventListener("click",function(){window.dispatchEvent(new CustomEvent("clickTDN",{detail:u.data[c]}))},!1),a.element.addEventListener("click",function(){window.dispatchEvent(new CustomEvent("clickDataTDN",{detail:s}))},!1),c+1===s.length&&(m=!1),[2]})})}),E(),[2]}var r,o,t,n,i,a})})},50),r=new MutationObserver(function(e){e.length&&b.call(e,function(e){e.addedNodes.length&&b.call(e.addedNodes,function(e){var t;1===e.nodeType&&(t=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector,e instanceof HTMLElement&&t.call(e,'[data-id*=tdn-]:not([data-triggered="true"])'))&&n()})})}),o={init:function(){return l(void 0,void 0,void 0,function(){return f(this,function(e){switch(e.label){case 0:return[4,n()];case 1:return e.sent(),t(),[2]}})})},createAds:function(){return n()},startListener:t,stopListener:function(){window.removeEventListener("scroll",n,!1),r.disconnect()},resetPageToken:function(){w={invID:"",token:""}}};return(window.__LITE_TDN__=o).init(),o}();
