!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("CAAS_AOLCOM",[],t):"object"==typeof exports?exports.CAAS_AOLCOM=t():e.CAAS_AOLCOM=t()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="http://172.17.0.2:8080/public/assets/",n(n.s=409)}({409:function(e,t,n){e.exports=n(410)},410:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(411),a=(i=o)&&i.__esModule?i:{default:i};t.default=new a.default({selector:".aol-notification-bell"})},411:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o={chrome:"https://s.yimg.com/cv/apiv2/default/20190821/settings-chrome.png",firefox:"https://s.yimg.com/cv/apiv2/default/20190821/settings-firefox.png",edge:"https://s.yimg.com/cv/apiv2/default/20190821/settings-edge.png",safari:"https://s.yimg.com/cv/apiv2/default/20190821/settings-safari.png"};t.default=function(){function e(t){var n=t.selector;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elems=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(document.querySelectorAll(n))),this.elems.length){try{this.notifications=JSON.parse(this.elems[0].dataset.configObject)}catch(e){return void console.log("Issue parsing notifications "+e)}this.notificationPanel=document.getElementById("header-notification-panel"),this.notificationBadge=document.getElementById("header-notification-badge"),this.userBrowser=window.NEXUtils.getBrowser(window.navigator.userAgent),this.init()}}return i(e,[{key:"init",value:function(){this.countNewNotifications(),this.eventListeners(),this.buildPanel()}},{key:"eventListeners",value:function(){var e=this,t=document.getElementById("aol-bell-notifications");t.addEventListener("mouseleave",(function(){e.notificationPanel.classList.remove("active"),e.notificationBadge.classList.remove("activeBadge");for(var t=document.getElementsByClassName("breaking-notification"),n=0;n<t.length;++n)t[n].classList.add("already_seen");e.writeIdsToStorage()})),t.addEventListener("mouseenter",(function(){e.notificationPanel.classList.add("active")}))}},{key:"writeIdsToStorage",value:function(){var e=[];this.notifications.forEach((function(t){e.push(t.id)})),window.localStorage.setItem("aol_already_seen",JSON.stringify(e))}},{key:"onClickNotifyMe",value:function(e){var t=this,n=window.document.getElementById("aol-blocked-notifications");e.addEventListener("click",(function(){var i=document.getElementById("aol-notifications-wrap-overlay"),a=document.getElementById("aol-permission-notification-banner"),r=document.getElementById("aol-blocked-notifications-body");window.NEXUtils.requestPermission("aol-notifications-wrap-overlay",(function(s){if(t.notificationPanel.removeChild(e),i.classList.remove("shown"),a.classList.remove("shown"),r.childElementCount>1&&r.removeChild(r.lastChild),!s){var c=o[t.userBrowser];if(c){var d=window.document.createElement("img");d.classList.add("blocked-notifications-body-image"),d.src=c,r.appendChild(d)}else{var l=window.document.createElement("p");l.classList.add("blocked-notifications-body-text"),l.textContent="If you’d like to allow notifications, please go into your browser’s Website or Privacy settings and set the permissions for AOL.com to “Allow.”",r.appendChild(l)}n.classList.add("shown"),n.addEventListener("click",(function(){n.classList.remove("shown")}))}}))}))}},{key:"checkPermission",value:function(){if(Notification&&"default"===Notification.permission){var e=document.createElement("div");e.classList.add("notifications-section"),e.classList.add("notifications-activate");var t=document.createElement("p");t.classList.add("notifications-text"),t.textContent="Get breaking news and big stories on your desktop.",e.appendChild(t);var n=document.createElement("div");n.id="activate-notifications",n.classList.add("btn"),n.classList.add("notifications-cta"),n.textContent="Notify Me",e.appendChild(n),this.notificationPanel.appendChild(e),this.onClickNotifyMe(e),document.addEventListener("NotificationPermissionBanner:click",(function(){e&&e.parentNode.removeChild(e)}))}}},{key:"buildPanel",value:function(){var e=this,t=window.localStorage.getItem("aol_already_seen")||"[]";try{t=JSON.parse(t)}catch(e){return void window.localStorage.removeItem("aol_already_seen")}var n=t.reduce((function(e,t){return e[t]=t,e}),{});this.checkPermission(),this.notifications.forEach((function(t){var i=document.createElement("div");i.classList.add("breaking-notification"),n[t.id]&&i.classList.add("already_seen");var o=document.createElement("div");o.classList.add("breaking-notification_image");var a=document.createElement("a");a.href=t.click_url;var r=document.createElement("img");r.src=t.image_url,a.appendChild(r),o.appendChild(a);var s=document.createElement("div");s.classList.add("breaking-notification_text");var c=document.createElement("a");c.href=t.click_url,c.textContent=t.text,s.appendChild(c);var d=document.createElement("div");d.classList.add("breaking-notification_time");var l=document.createElement("p");l.textContent=t.days_from_publish,d.appendChild(l),i.appendChild(o),i.appendChild(s),i.appendChild(d),e.notificationPanel.appendChild(i)}))}},{key:"countNewNotifications",value:function(){var e=0,t=window.localStorage.getItem("aol_already_seen");if(t){try{t=JSON.parse(t)}catch(e){this.addValueToBadge(5)}var n=t.reduce((function(e,t){return e[t]=t,e}),{});this.notifications.forEach((function(t){n[t.id]||(e+=1)})),e>0&&this.addValueToBadge(e)}else e=5,this.addValueToBadge(e)}},{key:"addValueToBadge",value:function(e){this.notificationBadge.textContent=e,this.notificationBadge.classList.add("activeBadge")}}]),e}()}})}));
//# sourceMappingURL=notification_bell.js.map