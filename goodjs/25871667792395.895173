(window.monolithJsonpFunction=window.monolithJsonpFunction||[]).push([["54e35a8e"],{10955:function(e,n,t){"use strict";var r={};t.r(r),t.d(r,"PHONE_CONFIRM_CODE",function(){return w}),t.d(r,"openChatByChannelId",function(){return y}),t.d(r,"openChat",function(){return i}),t.d(r,"sendTextMessage",function(){return s});var o=t(3956),v=t.n(o),p=t(4326),h=t(6561),b=t(5923),g=t(4206),w=-32060;function m(e,n){n?n.push(e):window.location.href=e}function y(e){var n,t=e.channelId,r=e.draftText,o=e.interlocutorId,i=e.isMiniMessenger,a=e.browserHistory;r&&void 0!==o&&(i||Boolean(null===(e=window.avito)||void 0===e||null===(n=e.messenger)||void 0===n?void 0:n.helpers)?p.c({channelId:t,interlocutorId:o,text:r}):h.e({channelId:t,interlocutorId:o,text:r})),i?p.b(t):m("/profile/messenger/channel/".concat(t),a)}function i(e){return a.apply(this,arguments)}function a(){return(a=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(n){var t,r,o,i,a,s,c,u,l,d,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.itemId,r=n.interlocutorId,o=n.draftText,i=n.isMiniMessenger,a=n.isMobile,s=n.browserHistory,u=n.requestApi,c=void 0===u?v.a.get("httpFallback"):u,u=n.onAuthError,t&&r)throw Error("invalid params, use only one of itemId or interlocutorId");e.next=3;break;case 3:if(t||r){e.next=5;break}throw Error("itemId or interlocutorId is required");case 5:if(l=i?g.a.MINI:g.a.DESKTOP,a&&(l=g.a.MOBILE),d="app_name=".concat(l),l=(-1!==c.indexOf("?")?"".concat(c,"&"):"".concat(c,"?")).concat(d),e.prev=9,d=null,t)return e.next=14,b.a(l,t);e.next=17;break;case 14:d=e.sent,e.next=21;break;case 17:if(r)return e.next=20,b.b(l,r);e.next=21;break;case 20:d=e.sent;case 21:d&&(f=null===(f=d.info)||void 0===f?void 0:f.userId,y({channelId:d.channelId,interlocutorId:f,draftText:o,isMiniMessenger:i,browserHistory:s})),e.next=28;break;case 24:throw e.prev=24,e.t0=e.catch(9),e.t0.code===w?(o&&h.d({itemId:t||void 0,userId:r||void 0,text:o}),i?p.d(t,r):(f=t?"create_chat=".concat(t):"create_user_chat=".concat(r),m("/profile/messenger?".concat(f),s))):401===e.t0.status&&u&&u(),e.t0;case 28:case"end":return e.stop()}},e,null,[[9,24]])}))).apply(this,arguments)}var s=function(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:v.a.get("httpFallback");return b.c(t,e,n)};t.d(n,"b",function(){return c}),t.d(n,"a",function(){return r});var c=i},3956:function(e,n,t){"use strict";var r={};e.exports={init:function(e){r=Object.assign(r,e)},get:function(e){if(!Object.keys(r).length)throw new Error("Please init SiteIntegration before use messenger");return r[e]},set:function(e,n){r[e]=n}}},4038:function(e,n,t){var o=t(4039),i=t(4040),a=Object.prototype.hasOwnProperty;e.exports=function(e,n,t){var r=e[n];a.call(e,n)&&i(r,t)&&(void 0!==t||n in e)||o(e,n,t)}},4039:function(e,n,t){var r=t(4016);e.exports=function(e,n,t){"__proto__"==n&&r?r(e,n,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[n]=t}},4189:function(e,n,t){var r=t(4190);e.exports=function(e,n,t){return null==e?e:r(e,n,t)}},4190:function(e,n,t){var d=t(4038),f=t(4149),v=t(4026),p=t(3980),h=t(4157);e.exports=function(e,n,t,r){if(!p(e))return e;for(var o=-1,i=(n=f(n,e)).length,a=i-1,s=e;null!=s&&++o<i;){var c,u=h(n[o]),l=t;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;o!=a&&(c=s[u],void 0===(l=r?r(c,u,s):void 0)&&(l=p(c)?c:v(n[o+1])?[]:{})),d(s,u,l),s=s[u]}return e}},4191:function(e,n,t){"use strict";t.d(n,"b",function(){return s}),t.d(n,"a",function(){return c}),t.d(n,"d",function(){return u}),t.d(n,"f",function(){return l}),t.d(n,"c",function(){return d}),t.d(n,"e",function(){return f});var r=t(4192),n=t(3956),o=t.n(n),i=Object(r.a)()||{os:"unknown",name:"unknown",version:"unknown"};function a(e){return e.replace(/[.\s]/g,"_")}function s(){var e=window.navigator,e=e.connection||e.mozConnection||e.webkitConnection||e.msConnection||{type:"unknown",effectiveType:"unknown"};return a(e.type||e.effectiveType||"unknown")}function c(e){return{appName:"".concat(e).concat(""),browserName:a(i.name),networkType:s(),os:"_",browserVersion:"_"}}function u(){return navigator&&navigator.onLine}function l(){var e=o.a.get("chatsScrollNodeSelector"),e=e&&document.querySelector(e)||window;e.scrollTo.apply(e,arguments)}var d="undefined"!=typeof window,f=function(e){return window.location.href=e}},4192:function(e,f,v){"use strict";!function(n){v.d(f,"a",function(){return e});var i=function(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;for(var r=Array(e),o=0,n=0;n<t;n++)for(var i=arguments[n],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},a=function(e,n,t){this.name=e,this.version=n,this.os=t,this.type="browser"},t=function(e){this.version=e,this.type="node",this.name="node",this.os=n.platform},s=function(e,n,t,r){this.name=e,this.version=n,this.os=t,this.bot=r,this.type="bot-device"},c=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},r=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},u=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,l=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],d=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function e(e){return e?o(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new r:"undefined"!=typeof navigator?o(navigator.userAgent):void 0!==n&&n.version?new t(n.version.slice(1)):null}function o(e){var r,n=""!==(r=e)&&l.reduce(function(e,n){var t=n[0],n=n[1];if(e)return e;n=n.exec(r);return!!n&&[t,n]},!1);if(!n)return null;var t=n[0],o=n[1];if("searchbot"===t)return new c;n=o[1]&&o[1].split(/[._]/).slice(0,3);n?n.length<3&&(n=i(n,function(e){for(var n=[],t=0;t<e;t++)n.push("0");return n}(3-n.length))):n=[];o=n.join("."),n=function(e){for(var n=0,t=d.length;n<t;n++){var r=d[n],o=r[0];if(r[1].exec(e))return o}return null}(e),e=u.exec(e);return e&&e[1]?new s(t,o,n,e[1]):new a(t,o,n)}}.call(this,v(4193))},4196:function(e,n,t){"use strict";var r=t(4147),i=t.n(r),r=t(4189),o=t.n(r),r=t(4197),a=t.n(r),v=t(4191),s=["isApiFetchEvent"],c="bundle_loading_start",u="bundle_loading_end",l="transport_connect_start",d="session",f="api_fetch_start",p="api_fetch_end",h="result_render",b=(t={},babelHelpers.defineProperty(t,"".concat("navigation_start",".").concat(c),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РћР¶РёРґР°РЅРёРµ РґСЂСѓРіРёС… СЃРєСЂРёРїС‚РѕРІ)"),babelHelpers.defineProperty(t,"".concat(c,".").concat(u),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РЎРµС‚СЊ: РћР¶РёРґР°РЅРёРµ РіРѕС‚РѕРІРЅРѕСЃС‚Рё Р±Р°РЅРґР»Р°)"),babelHelpers.defineProperty(t,"".concat(u,".").concat(l),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РРЅРёС†РёР°Р»РёР·Р°С†РёСЏ)"),babelHelpers.defineProperty(t,"".concat(l,".").concat(d),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РђРїРё: РћР¶РёРґР°РЅРёРµ СЃРµСЃСЃРёРё)"),babelHelpers.defineProperty(t,"".concat(d,".").concat(f),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РћР±СЂР°Р±РѕС‚РєР° СЃРµСЃСЃРёРё)"),babelHelpers.defineProperty(t,"".concat(f,".").concat(p),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РђРїРё: РћР¶РёРґР°РЅРёРµ РґР°РЅРЅС‹С…)"),babelHelpers.defineProperty(t,"".concat(p,".").concat(h),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РћС‚СЂРёСЃРѕРІРєР° СЌРєСЂР°РЅР°)"),babelHelpers.defineProperty(t,"".concat(d,".").concat(h),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РћС‚СЂРёСЃРѕРІРєР° СЌРєСЂР°РЅР°)"),t),g=v.c?window.performance:null,t=(babelHelpers.createClass(w,[{key:"logBundleLoadingStart",value:function(){this.logEvent(c),o()(window,["avito.messenger.perfEventsLog",c],this.eventsLog.bundle_loading_start)}},{key:"logBundleLoadingEnd",value:function(){this.logEvent(u)}},{key:"logTransportConnect",value:function(){this.logEvent(l)}},{key:"logSession",value:function(){this.logEvent(d)}},{key:"logResultRender",value:function(){this.logEvent(h)}},{key:"logApiFetch",value:function(e){var n=this,t=e.isApiFetchEvent,e=babelHelpers.objectWithoutProperties(e,s);return t&&e.fetching&&(this.logEvent(f),e.fetching=e.fetching.then(function(e){return n.logEvent(p),e},function(e){throw n.logEvent(p),e})),e}},{key:"logEvent",value:function(e){this.eventsLog[e]=(g&&g.now?g:Date).now(),g&&g.mark&&g.mark(e)}},{key:"buildInterval",value:function(e,n,t,r){var o="".concat(e,".").concat(t);if(g&&g.measure){var i=b[o];if(i)try{g.measure(i,e,t)}catch(e){}}return[o,Math.round(r-n)]}},{key:"buildPayload",value:function(e){var n=e.appName,t=e.screenName,r=e.transport,o={},i=Object(v.a)(n),a=i.appName,s=i.os,e=i.browserName,n=i.browserVersion,i=i.networkType,c="tm.ui_perf_m.".concat(a,".").concat(s,".").concat(e,".").concat(n,".")+"".concat(i,".").concat(r,".").concat(t),u=Object.entries(this.eventsLog);u.sort(function(e,n){e=babelHelpers.slicedToArray(e,2),e[0],e=e[1],n=babelHelpers.slicedToArray(n,2);return n[0],e-n[1]});for(var l=1;l<u.length;l++){var d=this.buildInterval.apply(this,babelHelpers.toConsumableArray(u[l-1]).concat(babelHelpers.toConsumableArray(u[l]))),f=babelHelpers.slicedToArray(d,2),d=f[0],f=f[1];o["".concat(c,".").concat(d)]=f}return o}},{key:"sendMetrics",value:function(e){var n=e.appName,t=e.screenName,r=e.transport,o=e.metricsUrl;this.isPageLoaded&&g&&g.now&&(this.eventsLog.navigation_start=0);e=i()(window,["avito.messenger.perfEventsLog",c]);e&&(this.eventsLog.bundle_loading_start=e),r=this.buildPayload({appName:n,screenName:t,transport:r}),fetch(o,{method:"post",credentials:"include",body:JSON.stringify(r)}),this.isPageLoaded=!1,this.eventsLog={},a()(window,["avito.messenger.perfEventsLog",c])}}]),w);function w(){babelHelpers.classCallCheck(this,w),this.eventsLog={},this.isPageLoaded=!0}n.a=new t},4197:function(e,n,t){var r=t(4198);e.exports=function(e,n){return null==e||r(e,n)}},4198:function(e,n,t){var r=t(4149),o=t(4199),i=t(4200),a=t(4157);e.exports=function(e,n){return n=r(n,e),null==(e=i(e,n))||delete e[a(o(n))]}},4199:function(e,n){e.exports=function(e){var n=null==e?0:e.length;return n?e[n-1]:void 0}},4200:function(e,n,t){var r=t(4148),o=t(4201);e.exports=function(e,n){return n.length<2?e:r(e,o(n,0,-1))}},4201:function(e,n){e.exports=function(e,n,t){var r=-1,o=e.length;(t=o<t?o:t)<0&&(t+=o),o=t<(n=n<0?o<-n?0:o+n:n)?0:t-n>>>0,n>>>=0;for(var i=Array(o);++r<o;)i[r]=e[r+n];return i}},5923:function(e,n,t){"use strict";function r(){return o.apply(this,arguments)}function o(){return(o=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(n,t,r){var o,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n,{method:"post",credentials:"include",body:JSON.stringify({jsonrpc:"2.0",id:Date.now(),method:t,params:r})});case 2:if(200!==(o=e.sent).status)throw o;e.next=5;break;case 5:return e.next=7,o.json();case 7:if(a=e.sent,i=a.result,a=a.error)throw a;e.next=12;break;case 12:return e.abrupt("return",i);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function i(e,n,t){return r(e,"avito.chatCreateByItemId.v1",{itemId:n,source:t})}function a(e,n){return r(e,"messenger.chatCreateByUserId.v1",{opponentId:n})}function s(e,n,t){return r(e,"avito.sendTextMessage",{channelId:n,text:t,randomId:Date.now()})}t.d(n,"a",function(){return i}),t.d(n,"b",function(){return a}),t.d(n,"c",function(){return s})},6561:function(e,n,t){"use strict";t.d(n,"c",function(){return c}),t.d(n,"f",function(){return u}),t.d(n,"e",function(){return l}),t.d(n,"a",function(){return d}),t.d(n,"d",function(){return f}),t.d(n,"b",function(){return v});function r(e){var n=e.itemId,e=e.userId;return void 0!==n?"".concat(s,"_item_").concat(n):"".concat(s,"_user_").concat(e)}var o=t(6562),i=t(4357),a=t(10963),s="__msgr_deferred_draft",c=function(e){e=o.b.getItem(o.a.DRAFT_MESSAGES,null==e?void 0:e.toString());return e&&JSON.parse(e)},u=function(e,n){return o.b.setItem(o.a.DRAFT_MESSAGES,JSON.stringify(e),null==n?void 0:n.toString())},l=function(e){var n=e.channelId,t=e.text,r=e.interlocutorId,o=e.userId,e=c(o)||void 0,r=Object(a.setDraftMessage)({channelId:n,text:t,interlocutorId:r}),r=Object(i.a)(e,r);u(r,o)},d=function(e){return o.b.removeItem(o.a.DRAFT_MESSAGES,null==e?void 0:e.toString())},f=function(e){var n=e.itemId,t=e.userId,e=e.text;return o.b.setItem(r({itemId:n,userId:t}),e)},v=function(e){var n=e.itemId,e=e.userId;return o.b.getItem(r({itemId:n,userId:e}))}},6562:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(4188),o=t(4191).c?window.localStorage:void 0;function i(e,n,t){n=1<arguments.length&&void 0!==n?n:"",t=2<arguments.length&&void 0!==t?t:"";return"".concat(e,"_").concat(n,"_").concat(t)}n.b={getItem:function(e,n,t){return o?o.getItem(i(e,n,t)):null},setItem:function(e,n,t,r){if(o)try{o.setItem(i(e,t,r),n)}catch(e){}},removeItem:function(e,n,t){o&&o.removeItem(i(e,n,t))}};var a=Object(r.a)({DRAFT_MESSAGES:null})}}]);
