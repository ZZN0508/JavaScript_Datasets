YUI.add("group-status-helper",function(u,t){require("hermes-core/flog")(t);var c=u.mix({langBundles:["common","groups"]},u.Localizable);u.GroupStatusHelper=function(o,a){var s,l,i=a.groupId,r=new u.TemplateLibraryHelper(o,{localizeLib:c}),t={load:function(){var e=this;return u.on("groupStatusHelper:groupStatusChanged",function(t){t.groupId===i&&e.update()}),a.useSearchModel?o.getModel("search-group-models",i).then(function(t){l=t,e.convertGroupInfoModel(t),e.groupRemoteMethods={join:t.registry.remote.join,leave:t.registry.remote.leave}}):o.getModel("group-info-models",i).then(function(t){return l=t,e.convertGroupInfoModel(t),e.groupRemoteMethods={join:t.registry.remote.join,leave:t.registry.remote.leave},t})},initiateJoinGroup:function(){var t=this.getJoinStatus(),e=s.title,n=s.id;return t.canJoin&&!t.signedIn?this.showSignUpModal(n):t.canJoin&&!t.requiresRequest||t.canJoin&&t.isInvited?this.joinGroup(n):!t.hasJoined&&t.hasRequested&&t.requiresRequest?(new u.Views.FluidModal({appContext:o,title:c.intlMessage({intlName:"groups.GROUP_INVITE_ONLY_HEADER",groupName:e}),message:c.intlMessage({intlName:"groups.GROUP_INVITE_PENDING",groupName:e}),actionButtonLabel:c.intlMessage({intlName:"common.OK"}),showCancelButton:!1}).show(),u.Promise.resolve()):t.hasJoined||t.hasRequested||!t.requiresRequest?t.hasJoined?(this.fire("groupJoined"),u.fire("groupStatusHelper:groupJoined",{groupId:n}),u.Promise.resolve()):void 0:this.promptForRules().then(u.bind(function(){this.showInviteRequestModal.call(this,n)},this),u.bind(function(){},this))},initiateLeaveGroup:function(){this.showLeaveGroupModal()},showLeaveGroupModal:function(){var t=s.title,e=s.id,n=null,l="";1===s.memberCount&&s.isMember?l=c.intlMessage({intlName:"groups.GROUPS_LEAVE_WARNING_LAST_MEMBER",title:t}):(l=s.isAdmin?c.intlMessage({intlName:"groups.GROUPS_LEAVE_WARNING_ADMIN",title:t}):c.intlMessage({intlName:"groups.GROUPS_LEAVE_WARNING",title:t}),l+=c.intlHTMLMessage({intlName:"groups.GROUPS_LEAVE_WARNING_REMOVE_PHOTOS"})),(n=new u.Views.FluidModal({appContext:o,title:c.intlMessage({intlName:"groups.GROUPS_LEAVE_WARNING_TITLE",title:t}),htmlMessage:l,actionButtonLabel:c.intlMessage({intlName:"groups.GROUPS_LEAVE_WARNING_LEAVE_BUTTON"}),cancelButtonLabel:c.intlMessage({intlName:"groups.GROUPS_LEAVE_WARNING_CANCEL_BUTTON"}),overlayClassList:"over-droparound-under-modal"})).on("actionClick",u.bind(function(){var t=n.get("container").one("input"),t=t&&t.getDOMNode().checked;this.leaveGroup(e,t)},this)),n.show()},joinGroup:function(){var e=this;return this.promptForRules().then(u.bind(function(){return this.groupRemoteMethods.join({groupModel:l,acceptRules:!0},o).then(function(t){return e.convertGroupInfoModel(t),e.fire("groupJoined"),u.fire("groupStatusHelper:groupJoined",{groupId:i}),u.fire("groupStatusHelper:groupStatusChanged",{groupId:i}),t},function(t){new u.Views.FluidModal({appContext:o,title:c.intlMessage({intlName:"common.OOPS"}),message:c.intlMessage({intlName:"groups.GROUP_JOIN_ERROR"}),actionButtonLabel:c.intlMessage({intlName:"common.OK"}),showCancelButton:!1}).show()})},this),u.bind(function(t){},this))},leaveGroup:function(e,t){var n=this;this.groupRemoteMethods.leave({groupModel:l,deletePhotos:!!t},o).then(function(t){return n.convertGroupInfoModel(t),n.fire("groupLeft"),u.fire("groupStatusHelper:groupLeft",{groupId:e}),u.fire("groupStatusHelper:groupStatusChanged",{groupId:e}),t},function(t){new u.Views.FluidModal({appContext:o,title:c.intlMessage({intlName:"common.OOPS"}),message:c.intlMessage({intlName:"groups.GROUP_LEAVE_ERROR"}),actionButtonLabel:c.intlMessage({intlName:"common.OK"}),showCancelButton:!1}).show()})},showSignUpModal:function(e){var n=u.url("/groups/")+e,t=c.intlMessage({intlName:"groups.SIGN_IN_BEFORE_JOIN_TITLE"}),l=c.intlMessage({intlName:"groups.SIGN_UP_AND_JOIN_MESSAGE",name:s.title});(l=new u.Views.SignUpModal({appContext:o,signUpHeaderClass:"avatar group big",signUpHeaderImage:(void 0!==this.groupModel.getValue("group")?this.groupModel.getValue("group"):this.groupModel).getValue("bestIconURL"),signUpTitle:t,signUpMessage:l,beaconPrefix:"join"})).on("signUpClick",function(t){u.SigninHelper.signUpPendingJoinGroup({id:e},{postLoginUrl:n})}),l.on("signInClick",function(t){u.SigninHelper.addPendingJoinGroup({id:e},{postLoginUrl:n})}),l.show()},promptForRules:function(){return new u.Promise(u.bind(function(t,e){var n=s.secureRules,l=null;n?((l=new u.Views.FluidModal({appContext:o,title:c.intlMessage({intlName:"groups.GROUP_JOIN_RULES_DIALOG_TITLE"}),htmlMessage:c.intlMessage({intlName:"groups.GROUP_JOIN_RULES_DIALOG_MESSAGE"})+"<br /><pre>"+n+"</pre>",showBodyLines:!1,actionButtonLabel:c.intlMessage({intlName:"groups.GROUP_JOIN_RULES_DIALOG_ACCEPT"}),cancelButtonLabel:c.intlMessage({intlName:"groups.GROUP_JOIN_RULES_DIALOG_DECLINE"})})).on("actionClick",function(){setTimeout(function(){t()},500)}),l.on("cancelClick",function(){setTimeout(function(){e()},500)}),l.show()):t()},this))},showInviteRequestModal:function(e){var n,t=c.intlMessage({intlName:"groups.GROUP_INVITE_ONLY_SEND"}),l=c.intlMessage({intlName:"common.CANCEL"}),i=r.getTemplate("join-group-invite-form",a.viewParams);(n=new u.Views.FluidModal({appContext:o,title:c.intlMessage({intlName:"groups.GROUP_INVITE_ONLY_HEADER",groupName:u.Escape.html(s.title)}),htmlMessage:i({groupName:s.title}),actionButtonLabel:t,cancelButtonLabel:l,overlayClassList:"over-droparound-under-modal"})).on("actionClick",function(){var t=n.get("container").one(".group-invite-form");t&&(0<(t=t.get("value")).length?o.callAPI("flickr.groups.joinRequest",{group_id:e,message:t,accept_rules:!0}).then(function(t){u.config.win.location.reload()},function(t){var e=t&&7===t.code?c.intlMessage({intlName:"groups.GROUP_INVITE_PENDING",groupName:u.Escape.html(s.title)}):"message"in t?t.message:c.intlMessage({intlName:"common.ERROR"});new u.Views.FluidModal({appContext:o,title:c.intlMessage({intlName:"common.ERROR"}),message:e,actionButtonLabel:c.intlMessage({intlName:"common.OK"}),showCancelButton:!1}).show()}):setTimeout(function(){new u.Views.FluidModal({appContext:o,title:c.intlMessage({intlName:"common.ERROR"}),message:c.intlMessage({intlName:"groups.GROUP_INVITE_EMPTY_MESSAGE"}),actionButtonLabel:c.intlMessage({intlName:"common.OK"}),showCancelButton:!1}).show()},300))}),n.on("activated",function(){var t=n.get("container"),e=t.one("textarea")||!1;t&&e&&e.focus()}),n.show()},getJoinStatus:function(){var t=o&&o.getViewer(),t=t&&t.signedIn,e=s.isMember,n=s.isInvited,l=s.hasPendingRequestToJoin;return{signedIn:t,canJoin:!e&&!l,hasJoined:e,hasRequested:l,isInvited:n,requiresRequest:2===s.privacy,isAdmin:s.isAdmin}},convertGroupInfoModel:function(t){var e=a.useSearchModel?t:t.getValue("group");s={title:e.getValue("title"),id:e.getValue("id"),memberCount:e.getValue("memberCount"),isMember:e.getValue("isMember"),isModerator:e.getValue("isModerator"),isAdmin:e.getValue("isAdmin"),privacy:e.getValue("privacy"),isInvited:t.getValue("isInvited"),hasPendingRequestToJoin:t.getValue("hasPendingRequestToJoin"),secureRules:t.getValue("secureRules"),muted:e.getValue("muted")}},getInfo:function(){return{groupAttrs:s,joinStatus:this.getJoinStatus()}},toggleNotificationsMute:function(e){var n=a.useSearchModel?l:l.getValue("group");return o.callAPI(e?"flickr.activity.muteObject":"flickr.activity.unmuteObject",{group_id:i}).then(function(t){n.setValue("muted",e),u.fire("groupStatusHelper:groupStatusChanged",{groupId:i})})},toggleMuteGroup:function(e){return this.insertUserPrefs({object_id:i,object_type:1,pref_type:"GroupBatch",pref_val:e?0:1}).then(function(t){u.fire("groupStatusHelper:groupMuteToggled",{groupId:i,isMuted:e}),u.fire("groupStatusHelper:groupStatusChanged",{groupId:i})})},insertUserPrefs:function(t){return o.callAPI("flickr.feed.preferences.insertUserPreferences",t)},update:function(){this.convertGroupInfoModel(l)},declineInvite:function(){return l.declineInvite()}};return u.augment(t,u.EventTarget),t}},"@VERSION@",{requires:["event-custom","template-lib-helper","hermes-template-join-group-invite-form"],langBundles:["common","groups"]}),YUI.add("base-notification-item-view",function(a,t){var l=require("hermes-core/flog")(t);a.namespace("Views")[this.name]=a.Base.create(this.name,a.FlickrView,[],{langBundles:this.details.langBundles,additionalViewClasses:function(){return["base-notification-item"]},initializer:function(t){this.params=t,this.activityItem=t.activityItem,this.notificationsHelper=new a.NotificationsHelper(this.appContext)},loadState:function(){return a.Promise.resolve()},buildContainer:function(){var t=this.notificationsHelper.getTemplateHtml(this.activityItem);this.setContainerHTML(t)},activate:function(){var t=this.get("container").one(".notification-item");return t&&(t.toggleClass("unseen",!this.activityItem.isSeen),t.toggleClass("muted",this.activityItem.isMuted),this.registerEventHandler(t.on("click",this.handleAnalyticsClicks.bind(this))),this.setupContextMenu()),a.Promise.resolve(this)},handleContextMenuClick:function(){var l,t,i,o=this;this.menuConfigData&&(t=(l=this.notificationsHelper.getContextMenuConfig({item:this.params.activityItem,ctxMenuItems:this.menuConfigData})).map(function(t){return{text:t.text,value:t.actionId}}),(i=new a.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,observePageResize:!0,anchorOffsetVertical:0,width:250,dismissOnOverlayClick:!0,anchorElement:this.contextMenuButton,menuItems:t,positionFixed:!0,closeOnScroll:!0,classList:"over-modal notification-context-menu",overlayClassList:"over-modal"})).show(),this.registerEventHandler(i.on("selected",function(e){var t=l.find(function(t){return t.actionId===e.menuItem.value}),n=o.get("container");e.analyticsLocation=n.ancestor(".notifications-panel-view")?"panel":"page",i.close(),t.onSelected(e)})))},setupContextMenu:function(){var e=this,t=this.get("container"),n=this.params.activityItem;if(this.contextMenuButton=t.one(".notification-context-menu-button"),this.contextMenuButton)return this.registerEventHandler(this.contextMenuButton.on("click",this.handleContextMenuClick.bind(this))),this.notificationsHelper.loadContextMenuConfig(n).then(function(t){e.menuConfigData=t}).catch(function(t){return l.error({err:t}),a.Promise.resolve()})},handleAnalyticsClicks:function(t){t=t.target;t.ancestor(".headline-container",!0)&&"A"===t.get("tagName").toUpperCase()?this.beaconAnalytics(this.activityItem,"Headline Click"):t.ancestor(".notification-photo-thumb",!0)?this.beaconAnalytics(this.activityItem,"Photo Thumb Click"):t.ancestor(".avatar",!0)&&!t.ancestor(".photo-thumb",!0)?this.beaconAnalytics(this.activityItem,"Avatar Click"):t.ancestor(".notification-context-menu-button",!0)&&this.beaconAnalytics(this.activityItem,"Context Menu Click")},beaconAnalytics:function(t,e){var n=this.get("container").ancestor(".notifications-panel-view")?"panel":"page";a.Analytics.setDataLayerProp("notifications.notificationType",t.type),a.Analytics.setDataLayerProp("notifications.actionType",e),a.Analytics.setDataLayerProp("notifications.location",n),a.Analytics.sendClick("","Notification Action"),a.Analytics.setDataLayerProp("notifications.notificationType",""),a.Analytics.setDataLayerProp("notifications.actionType",""),a.Analytics.setDataLayerProp("notifications.location","")}})},"@VERSION@",{requires:["flickr-view"],langBundles:["common","relative-dates","notifications"]}),YUI.add("hermes-template-follow",function(n,t){var l=n.Template.Handlebars.revive({1:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"showNoButton"):e,{name:"if",hash:{},fn:t.program(2,i,0),inverse:t.program(4,i,0),data:i,loc:{start:{line:2,column:1},end:{line:14,column:8}}}))?i:""},2:function(t,e,n,l,i){return""},4:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"showUnblockButton"):e,{name:"if",hash:{},fn:t.program(5,i,0),inverse:t.program(7,i,0),data:i,loc:{start:{line:5,column:2},end:{line:13,column:9}}}))?i:""},5:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"\t\t\t<button class='follow alt'>"+t.escapeExpression((o(n,"intlMessage")||e&&o(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"common.UNBLOCK"},data:i,loc:{start:{line:6,column:30},end:{line:6,column:71}}}))+"</button>\n"},7:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"showFollowingButton"):e,{name:"if",hash:{},fn:t.program(8,i,0),inverse:t.program(10,i,0),data:i,loc:{start:{line:8,column:3},end:{line:12,column:10}}}))?i:""},8:function(t,e,n,l,i){return'\t\t\t\t<button class="follow is-following mini"><span class="drop-icon">â–¾</span></button>\n'},10:function(t,e,n,l,i){return'\t\t\t\t<button class="follow mini"></button>\n'},12:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"isFluid"):e,{name:"if",hash:{},fn:t.program(13,i,0),inverse:t.program(23,i,0),data:i,loc:{start:{line:16,column:1},end:{line:46,column:8}}}))?i:""},13:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"showNoButton"):e,{name:"if",hash:{},fn:t.program(2,i,0),inverse:t.program(14,i,0),data:i,loc:{start:{line:17,column:2},end:{line:29,column:9}}}))?i:""},14:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"showUnblockButton"):e,{name:"if",hash:{},fn:t.program(15,i,0),inverse:t.program(17,i,0),data:i,loc:{start:{line:20,column:3},end:{line:28,column:10}}}))?i:""},15:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"\t\t\t\t<button class='follow alt'>"+t.escapeExpression((o(n,"intlMessage")||e&&o(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"common.UNBLOCK"},data:i,loc:{start:{line:21,column:31},end:{line:21,column:72}}}))+"</button>\n"},17:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"showFollowingButton"):e,{name:"if",hash:{},fn:t.program(18,i,0),inverse:t.program(21,i,0),data:i,loc:{start:{line:23,column:4},end:{line:27,column:11}}}))?i:""},18:function(t,e,n,l,i){var o,a=null!=e?e:t.nullContext||{},s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t\t<button class="follow is-following '+(null!=(o=s(n,"if").call(a,null!=e?s(e,"isOnDark"):e,{name:"if",hash:{},fn:t.program(19,i,0),inverse:t.noop,data:i,loc:{start:{line:24,column:40},end:{line:24,column:68}}}))?o:"")+'">'+t.escapeExpression((s(n,"intlMessage")||e&&s(e,"intlMessage")||t.hooks.helperMissing).call(a,{name:"intlMessage",hash:{intlName:null!=e?s(e,"followingIntlKey"):e},data:i,loc:{start:{line:24,column:70},end:{line:24,column:111}}}))+'<span class="drop-icon">â–¾</span></button>\n'},19:function(t,e,n,l,i){return"white"},21:function(t,e,n,l,i){var o,a=null!=e?e:t.nullContext||{},s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t\t<button class="follow '+(null!=(o=s(n,"if").call(a,null!=e?s(e,"isOnDark"):e,{name:"if",hash:{},fn:t.program(19,i,0),inverse:t.noop,data:i,loc:{start:{line:26,column:27},end:{line:26,column:55}}}))?o:"")+'">'+t.escapeExpression((s(n,"intlMessage")||e&&s(e,"intlMessage")||t.hooks.helperMissing).call(a,{name:"intlMessage",hash:{intlName:null!=e?s(e,"followIntlKey"):e},data:i,loc:{start:{line:26,column:57},end:{line:26,column:95}}}))+"</button>\n"},23:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"showNoButton"):e,{name:"if",hash:{},fn:t.program(2,i,0),inverse:t.program(24,i,0),data:i,loc:{start:{line:31,column:2},end:{line:45,column:9}}}))?i:""},24:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t<span class="relationship">\n'+(null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"showUnblockButton"):e,{name:"if",hash:{},fn:t.program(2,i,0),inverse:t.program(25,i,0),data:i,loc:{start:{line:35,column:4},end:{line:43,column:11}}}))?i:"")+"\t\t\t</span>\n"},25:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"showFollowingButton"):e,{name:"if",hash:{},fn:t.program(26,i,0),inverse:t.program(28,i,0),data:i,loc:{start:{line:38,column:5},end:{line:42,column:12}}}))?i:""},26:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"\t\t\t\t\t\t<button class='unfluid follow is-following ui-button ui-button-icon ui-button-transparent ui-button-dropdown'><span>"+t.escapeExpression((o(n,"intlMessage")||e&&o(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"common.FOLLOWING"},data:i,loc:{start:{line:39,column:122},end:{line:39,column:165}}}))+"</span></button>\n"},28:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"\t\t\t\t\t\t<button class='unfluid follow ui-button ui-button-icon'><span>"+t.escapeExpression((o(n,"intlMessage")||e&&o(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"common.FOLLOW"},data:i,loc:{start:{line:41,column:68},end:{line:41,column:108}}}))+"</span></button>\n"},compiler:[8,">= 4.3.0"],main:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"isOnMobile"):e,{name:"if",hash:{},fn:t.program(1,i,0),inverse:t.program(12,i,0),data:i,loc:{start:{line:1,column:0},end:{line:47,column:7}}}))?i:""},useData:!0}),i={};n.Array.each([],function(t){var e=n.Template.get("hermes/"+t);e&&(i[t]=e)}),n.Template.register("hermes/follow",function(t,e){return(e=e||{}).partials=e.partials?n.merge(i,e.partials):i,l(t,e)})},"@VERSION@",{requires:["template-base","handlebars-base"]}),YUI.add("hermes-template-fluid-modal",function(n,t){var l=n.Template.Handlebars.revive({1:function(t,e,n,l,i){return" html-modal"},3:function(t,e,n,l,i){return" subview-modal"},5:function(t,e,n,l,i){return" flex-layout"},7:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="close-x" aria-label="'+t.escapeExpression((o(n,"intlMessage")||e&&o(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"common.CLOSE"},data:i,loc:{start:{line:2,column:53},end:{line:2,column:92}}}))+'" tabindex="0"></div>'},9:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t<div class="head">\n'+(null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"navBarView"):e,{name:"if",hash:{},fn:t.program(10,i,0),inverse:t.program(12,i,0),data:i,loc:{start:{line:5,column:3},end:{line:15,column:10}}}))?i:"")+'\t\t\t<div class="extra"></div>\n\t\t</div>\n'},10:function(t,e,n,l,i){return'\t\t\t\t<div class="nav"></div>\n'},12:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t<div class="title">\n'+(null!=(i=o(n,"if").call(null!=e?e:t.nullContext||{},null!=e?o(e,"title"):e,{name:"if",hash:{},fn:t.program(13,i,0),inverse:t.program(15,i,0),data:i,loc:{start:{line:9,column:5},end:{line:13,column:12}}}))?i:"")+"\t\t\t\t</div>\n"},13:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"\t\t\t\t\t\t"+t.escapeExpression("function"==typeof(o=null!=(o=o(n,"title")||(null!=e?o(e,"title"):e))?o:t.hooks.helperMissing)?o.call(null!=e?e:t.nullContext||{},{name:"title",hash:{},data:i,loc:{start:{line:10,column:6},end:{line:10,column:15}}}):o)+"\n"},15:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"\t\t\t\t\t\t"+t.escapeExpression((o(n,"renderTrustedMarkup")||e&&o(e,"renderTrustedMarkup")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},null!=e?o(e,"htmlTitle"):e,{name:"renderTrustedMarkup",hash:{},data:i,loc:{start:{line:12,column:6},end:{line:12,column:39}}}))+"\n"},17:function(t,e,n,l,i){return" lines"},19:function(t,e,n,l,i){var o,a=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,r=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t<div\n\t\t\t\tclass="content text-only '+(null!=(o=r(n,"if").call(a,null!=e?r(e,"noScroll"):e,{name:"if",hash:{},fn:t.program(20,i,0),inverse:t.noop,data:i,loc:{start:{line:22,column:29},end:{line:22,column:62}}}))?o:"")+(null!=(o=r(n,"if").call(a,null!=e?r(e,"showFooter"):e,{name:"if",hash:{},fn:t.program(22,i,0),inverse:t.noop,data:i,loc:{start:{line:22,column:62},end:{line:22,column:98}}}))?o:"")+'"\n\t\t\t\tstyle="'+(null!=(o=(r(n,"ifDefined")||e&&r(e,"ifDefined")||s).call(a,null!=e?r(e,"contentPadding"):e,{name:"ifDefined",hash:{},fn:t.program(24,i,0),inverse:t.noop,data:i,loc:{start:{line:23,column:11},end:{line:27,column:18}}}))?o:"")+'">\n\t\t\t\t'+t.escapeExpression("function"==typeof(e=null!=(e=r(n,"textMessage")||(null!=e?r(e,"textMessage"):e))?e:s)?e.call(a,{name:"textMessage",hash:{},data:i,loc:{start:{line:28,column:4},end:{line:28,column:19}}}):e)+"\n\t\t\t</div>\n"},20:function(t,e,n,l,i){return" no-scroll"},22:function(t,e,n,l,i){return" has-footer"},24:function(t,e,n,l,i){var o,a=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,r=t.escapeExpression,u=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"\n\t\t\t\t\tpadding-right: "+r("function"==typeof(o=null!=(o=u(n,"contentPadding")||(null!=e?u(e,"contentPadding"):e))?o:s)?o.call(a,{name:"contentPadding",hash:{},data:i,loc:{start:{line:24,column:20},end:{line:24,column:38}}}):o)+"px;\n\t\t\t\t\t"+(null!=(t=u(n,"if").call(a,null!=e?u(e,"showFooter"):e,{name:"if",hash:{},fn:t.noop,inverse:t.program(25,i,0),data:i,loc:{start:{line:25,column:5},end:{line:25,column:67}}}))?t:"")+"\n\t\t\t\t\tpadding-left: "+r("function"==typeof(o=null!=(o=u(n,"contentPadding")||(null!=e?u(e,"contentPadding"):e))?o:s)?o.call(a,{name:"contentPadding",hash:{},data:i,loc:{start:{line:26,column:19},end:{line:26,column:37}}}):o)+"px;\n\t\t\t\t"},25:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return"padding-bottom: "+t.escapeExpression("function"==typeof(o=null!=(o=o(n,"contentPadding")||(null!=e?o(e,"contentPadding"):e))?o:t.hooks.helperMissing)?o.call(null!=e?e:t.nullContext||{},{name:"contentPadding",hash:{},data:i,loc:{start:{line:25,column:39},end:{line:25,column:57}}}):o)+"px;"},27:function(t,e,n,l,i){var o,a=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,r=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t<div\n\t\t\t\tclass="content html-only '+(null!=(o=r(n,"if").call(a,null!=e?r(e,"noScroll"):e,{name:"if",hash:{},fn:t.program(20,i,0),inverse:t.noop,data:i,loc:{start:{line:33,column:29},end:{line:33,column:62}}}))?o:"")+(null!=(o=r(n,"if").call(a,null!=e?r(e,"showFooter"):e,{name:"if",hash:{},fn:t.program(22,i,0),inverse:t.noop,data:i,loc:{start:{line:33,column:62},end:{line:33,column:98}}}))?o:"")+'"\n\t\t\t\tstyle="'+(null!=(o=(r(n,"ifDefined")||e&&r(e,"ifDefined")||s).call(a,null!=e?r(e,"contentPadding"):e,{name:"ifDefined",hash:{},fn:t.program(24,i,0),inverse:t.noop,data:i,loc:{start:{line:34,column:11},end:{line:38,column:18}}}))?o:"")+'">\n\t\t\t\t'+t.escapeExpression((r(n,"renderTrustedMarkup")||e&&r(e,"renderTrustedMarkup")||s).call(a,null!=e?r(e,"htmlMessage"):e,{name:"renderTrustedMarkup",hash:{},data:i,loc:{start:{line:39,column:4},end:{line:39,column:39}}}))+"\n\t\t\t</div>\n"},29:function(t,e,n,l,i){var o,a=null!=e?e:t.nullContext||{},s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t<div\n\t\t\t\tclass="content subview '+(null!=(o=s(n,"if").call(a,null!=e?s(e,"noScroll"):e,{name:"if",hash:{},fn:t.program(20,i,0),inverse:t.noop,data:i,loc:{start:{line:44,column:27},end:{line:44,column:60}}}))?o:"")+(null!=(o=s(n,"if").call(a,null!=e?s(e,"showFooter"):e,{name:"if",hash:{},fn:t.program(22,i,0),inverse:t.noop,data:i,loc:{start:{line:44,column:60},end:{line:44,column:96}}}))?o:"")+'"\n\t\t\t\tstyle="'+(null!=(o=(s(n,"ifDefined")||e&&s(e,"ifDefined")||t.hooks.helperMissing).call(a,null!=e?s(e,"contentPadding"):e,{name:"ifDefined",hash:{},fn:t.program(24,i,0),inverse:t.noop,data:i,loc:{start:{line:45,column:11},end:{line:49,column:18}}}))?o:"")+'"></div>\n'},31:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t<div class="foot">\n'+(null!=(e=o(n,"if").call(null!=e?e:t.nullContext||{},null!=(e=null!=e?o(e,"buttons"):e)?o(e,"visible"):e,{name:"if",hash:{},fn:t.program(32,i,0),inverse:t.noop,data:i,loc:{start:{line:54,column:3},end:{line:66,column:10}}}))?e:"")+"\t\t</div>\n"},32:function(t,e,n,l,i){var o,a=null!=e?e:t.nullContext||{},s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t<div class="buttons">\n\t\t\t\t<div class="flavor-text-container">\n'+(null!=(o=s(n,"if").call(a,null!=(o=null!=e?s(e,"buttons"):e)?s(o,"flavorText"):o,{name:"if",hash:{},fn:t.program(33,i,0),inverse:t.noop,data:i,loc:{start:{line:57,column:5},end:{line:59,column:12}}}))?o:"")+'\t\t\t\t</div>\n\t\t\t\t<div class="button-container">\n\t\t\t\t\t'+(null!=(o=s(n,"if").call(a,null!=(o=null!=(o=null!=e?s(e,"buttons"):e)?s(o,"cancel"):o)?s(o,"visible"):o,{name:"if",hash:{},fn:t.program(36,i,0),inverse:t.noop,data:i,loc:{start:{line:62,column:5},end:{line:62,column:107}}}))?o:"")+"\n\t\t\t\t\t"+(null!=(o=s(n,"if").call(a,null!=(o=null!=(o=null!=e?s(e,"buttons"):e)?s(o,"action"):o)?s(o,"visible"):o,{name:"if",hash:{},fn:t.program(38,i,0),inverse:t.noop,data:i,loc:{start:{line:63,column:5},end:{line:63,column:209}}}))?o:"")+"\n\t\t\t\t</div>\n\t\t\t</div>\n"},33:function(t,e,n,l,i){var o,a=null!=e?e:t.nullContext||{},s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t\t<div class="flavor-text secondary'+(null!=(o=s(n,"unless").call(a,null!=(o=null!=(o=null!=e?s(e,"buttons"):e)?s(o,"flavorText"):o)?s(o,"visible"):o,{name:"unless",hash:{},fn:t.program(34,i,0),inverse:t.noop,data:i,loc:{start:{line:58,column:38},end:{line:58,column:94}}}))?o:"")+'">'+t.escapeExpression((s(n,"renderTrustedMarkup")||e&&s(e,"renderTrustedMarkup")||t.hooks.helperMissing).call(a,null!=(o=null!=(o=null!=e?s(e,"buttons"):e)?s(o,"flavorText"):o)?s(o,"text"):o,{name:"renderTrustedMarkup",hash:{},data:i,loc:{start:{line:58,column:96},end:{line:58,column:143}}}))+"</div>\n"},34:function(t,e,n,l,i){return" hidden"},36:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<button class="mini alt cancel">'+t.escapeExpression(t.lambda(null!=(t=null!=(t=null!=e?o(e,"buttons"):e)?o(t,"cancel"):t)?o(t,"label"):t,e))+"</button>"},38:function(t,e,n,l,i){var o,a=null!=e?e:t.nullContext||{},s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<button class="mini '+(null!=(o=s(n,"if").call(a,null!=(o=null!=(o=null!=e?s(e,"buttons"):e)?s(o,"action"):o)?s(o,"isDangerous"):o,{name:"if",hash:{},fn:t.program(39,i,0),inverse:t.noop,data:i,loc:{start:{line:63,column:55},end:{line:63,column:102}}}))?o:"")+' action"'+(null!=(o=s(n,"if").call(a,null!=(o=null!=(o=null!=e?s(e,"buttons"):e)?s(o,"action"):o)?s(o,"disabled"):o,{name:"if",hash:{},fn:t.program(41,i,0),inverse:t.noop,data:i,loc:{start:{line:63,column:110},end:{line:63,column:168}}}))?o:"")+">"+t.escapeExpression(t.lambda(null!=(o=null!=(o=null!=e?s(e,"buttons"):e)?s(o,"action"):o)?s(o,"label"):o,e))+"</button>"},39:function(t,e,n,l,i){return"danger"},41:function(t,e,n,l,i){return' disabled="disabled"'},compiler:[8,">= 4.3.0"],main:function(t,e,n,l,i){var o,a,s=null!=e?e:t.nullContext||{},r=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="modal'+(null!=(o=r(n,"if").call(s,null!=e?r(e,"htmlMessage"):e,{name:"if",hash:{},fn:t.program(1,i,0),inverse:t.noop,data:i,loc:{start:{line:1,column:17},end:{line:1,column:54}}}))?o:"")+(null!=(o=r(n,"if").call(s,null!=e?r(e,"subview"):e,{name:"if",hash:{},fn:t.program(3,i,0),inverse:t.noop,data:i,loc:{start:{line:1,column:54},end:{line:1,column:90}}}))?o:"")+(null!=(o=r(n,"if").call(s,null!=e?r(e,"flexLayout"):e,{name:"if",hash:{},fn:t.program(5,i,0),inverse:t.noop,data:i,loc:{start:{line:1,column:90},end:{line:1,column:127}}}))?o:"")+" "+t.escapeExpression("function"==typeof(a=null!=(a=r(n,"classList")||(null!=e?r(e,"classList"):e))?a:t.hooks.helperMissing)?a.call(s,{name:"classList",hash:{},data:i,loc:{start:{line:1,column:128},end:{line:1,column:141}}}):a)+'">\n\t'+(null!=(o=r(n,"if").call(s,null!=e?r(e,"showCancelX"):e,{name:"if",hash:{},fn:t.program(7,i,0),inverse:t.noop,data:i,loc:{start:{line:2,column:1},end:{line:2,column:120}}}))?o:"")+"\n"+(null!=(o=r(n,"if").call(s,null!=e?r(e,"showHeader"):e,{name:"if",hash:{},fn:t.program(9,i,0),inverse:t.noop,data:i,loc:{start:{line:3,column:1},end:{line:18,column:8}}}))?o:"")+'\t<div class="body'+(null!=(o=r(n,"if").call(s,null!=e?r(e,"showBodyLines"):e,{name:"if",hash:{},fn:t.program(17,i,0),inverse:t.noop,data:i,loc:{start:{line:19,column:17},end:{line:19,column:51}}}))?o:"")+'">\n'+(null!=(o=r(n,"if").call(s,null!=e?r(e,"textMessage"):e,{name:"if",hash:{},fn:t.program(19,i,0),inverse:t.noop,data:i,loc:{start:{line:20,column:2},end:{line:30,column:9}}}))?o:"")+(null!=(o=r(n,"if").call(s,null!=e?r(e,"htmlMessage"):e,{name:"if",hash:{},fn:t.program(27,i,0),inverse:t.noop,data:i,loc:{start:{line:31,column:2},end:{line:41,column:9}}}))?o:"")+(null!=(o=r(n,"if").call(s,null!=e?r(e,"subview"):e,{name:"if",hash:{},fn:t.program(29,i,0),inverse:t.noop,data:i,loc:{start:{line:42,column:2},end:{line:50,column:9}}}))?o:"")+"\t</div>\n"+(null!=(o=r(n,"if").call(s,null!=e?r(e,"showFooter"):e,{name:"if",hash:{},fn:t.program(31,i,0),inverse:t.noop,data:i,loc:{start:{line:52,column:1},end:{line:68,column:8}}}))?o:"")+"</div>\n"},useData:!0}),i={};n.Array.each([],function(t){var e=n.Template.get("hermes/"+t);e&&(i[t]=e)}),n.Template.register("hermes/fluid-modal",function(t,e){return(e=e||{}).partials=e.partials?n.merge(i,e.partials):i,l(t,e)})},"@VERSION@",{requires:["template-base","handlebars-base"]}),YUI.add("fluid-modal-view",function(c,n){"use strict";var e=require("hermes-core/flog")(n),p={css:{destinationContainer:"body",closeX:".close-x",buttonCancel:"button.cancel",buttonAction:"button.action",navBarContent:".head .nav",subviewContent:".content.subview",modalContent:".body .content"},options:{}};c.namespace("Views").FluidModal=c.FlickrView.create(this.name,c.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.set("isActiveViewAgnostic",!0),this.alreadyShowingModal=!1,this.overlayId=this.appContext.overlayManager.push({view:this,overlayClassList:this.get("overlayClassList"),dismissOnOverlayClick:this.get("dismissOnOverlayClick"),disableBodyScroll:!0,dismissOnEsc:!0}),this.state={supportsTransform:!1,modal:{height:0,width:0}},this},activate:function(){var e=this.get("container"),n=this,t=e.one(p.css.buttonAction);return this.get("showCancelX")&&this.registerEventHandler(e.one(p.css.closeX).on(["click","keydown"],function(t){"click"!==t.type&&13!==t.keyCode||this.handleX(t)},this)),this.get("showFooter")&&this.get("showCancelButton")&&this.get("showButtons")&&this.registerEventHandler(e.one(p.css.buttonCancel).on("click",c.bind(this.handleCancel,this))),this.get("showFooter")&&this.get("showActionButton")&&this.get("showButtons")&&this.registerEventHandler(e.one(p.css.buttonAction).on("click",c.bind(this.handleAction,this))),this.registerEventHandler(c.globalEvents.subscribe("window:resize",function(t){n.reposition()})),this.get("navBarView")&&n.get("navBarView").activate(),this.get("subview")&&(n.get("subview").normalizedActivate(),n.registerEventHandler(n.get("subview").on("actionClick",c.bind(n.handleAction,n))),n.registerEventHandler(n.get("subview").on("contentSizeChanged",c.bind(n.reposition,n))),n.registerEventHandler(n.get("subview").on("readyToClose",c.bind(n.close,n)))),this.get("focusOnFirstTabPress")&&this.registerEventHandler(e.ancestor("body").once("key",this.focusOnFirstTab.bind(this),"down:9")),c.Accessibility.manageFocusOutlines(this),this.registerEventHandler(c.on("modal:updateText",function(t){n.set("title",t.title),n.set("cancelButtonLabel",t.cancelText),n.set("actionButtonLabel",t.actionText),e.one(".title").set("textContent",t.title),e.one(".cancel").set("textContent",t.cancelText),e.one(".action").set("textContent",t.actionText)})),t&&(this.actionButtonText=t.get("text")),this.fire("activated"),this},focusOnFirstTab:function(t){var e=this.get("container").one("[tabindex]");e&&e.focus()},clearOutline:function(){var t=c.one(document.activeElement);t&&t.addClass("no-outline")},restoreOutline:function(){var t=this.get("container").one(":focus");t&&t.removeClass("no-outline")},show:function(){return this.initialize().then(null,function(t){e.error("Error initializing modal",{err:t})}),this.isClosed=!1,c.fire("flickr:setKeyEventScope",this.getKeyEventScope()),this},enableActionButton:function(){var t=this.get("container").one("button.action");t&&t.getAttribute("disabled")&&(t.removeAttribute("disabled"),t.set("text",this.actionButtonText))},disableActionButton:function(t){var e=this.get("container").one("button.action");e&&(e.setAttribute("disabled",!0),t&&e.set("innerHTML",this.templates("flickr-balls")({})))},showFlavorText:function(){var t=this.get("container").one(".buttons .flavor-text");t&&t.removeClass("hidden")},hideFlavorText:function(){var t=this.get("container").one(".buttons .flavor-text");t&&t.addClass("hidden")},setFlavorText:function(t,e){var n=this.get("container").one(".buttons .flavor-text");n&&(n.set("innerHTML",t),n.toggleClass("error",!!e))},buildContainer:function(){var t,n;return this.alreadyShowingModal||(n=this,c.one(p.css.destinationContainer),t={showCancelX:this.get("showCancelX"),title:this.get("title"),htmlTitle:this.get("htmlTitle"),navBarView:!!this.get("navBarView"),noScroll:this.get("noScroll"),textMessage:this.get("textMessage"),htmlMessage:this.get("message")?this.get("message"):this.get("htmlMessage"),subview:!!this.get("subview"),showBodyLines:this.get("showBodyLines"),hideModalOverlay:this.get("hideModalOverlay"),darkOverlay:this.get("darkOverlay"),lightOverlay:this.get("lightOverlay"),showHeader:this.get("showHeader"),showFooter:this.get("showFooter"),buttons:{visible:this.get("showButtons"),action:{visible:this.get("showActionButton"),label:this.get("actionButtonLabel"),disabled:this.get("actionButtonDisabled"),isDangerous:this.get("actionButtonIsDangerous")},cancel:{visible:this.get("showCancelButton"),label:this.get("cancelButtonLabel")}},classList:this.get("classList"),contentPadding:this.get("contentPadding"),flexLayout:this.get("flexLayout")},this.get("buttonFlavorText")&&(t.buttons.flavorText={visible:this.get("showButtonFlavorText"),text:this.get("buttonFlavorText")}),this.setContainerWithTemplate("fluid-modal",t),this.state.modal.width=this.get("width"),this.state.modal.minWidth=this.get("minWidth"),this.state.modal.height=this.get("height"),this.get("navBarView")&&(this.get("navBarView").appContext=n.appContext,this.get("navBarView").initialize().then(function(t){t.on("subviewViewEvent",function(t){t&&t.details&&t.details.length&&((n.get("subview")&&"navigation"===t.details[0]||n.get("subview")&&"search"===t.details[0])&&n.get("subview").fire.apply(n.get("subview"),["parentViewEvent"].concat(t.details)),n.fire.apply(n,t.details))}),n.get("container").one(p.css.navBarContent).appendChild(t.get("container")),n.get("subview")||n.activate()})),this.get("subview")?(this.get("subview").appContext=n.appContext,this.get("subview").set("isActiveViewAgnostic",!0),this.get("subview").initialize().then(function(e){n.on("parentViewEvent",function(t){t&&t.details&&t.details.length&&e.fire.apply(e,["parentViewEvent"].concat(t.details))}),e.on("subviewViewEvent",function(t){t&&t.details&&t.details.length&&(n.get("navBarView")&&"backToList"===t.details[0]&&n.get("navBarView").fire.apply(n.get("navBarView"),["parentViewEvent"].concat(t.details)),n.fire.apply(n,t.details))}),n.get("container").one(p.css.subviewContent).appendChild(e.get("container")),n.appContext.overlayManager.placeViewAfterOverlay(n.overlayId),n.reposition(),n.activate()},function(t){e.error("Error initializing modal subview",{err:t})})):(this.appContext.overlayManager.placeViewAfterOverlay(n.overlayId),this.reposition())),this},reposition:function(){var t,e=this.get("container").one(this.get("modalSelector")),n=c.one(c.config.win),l=parseInt(n.get("innerWidth"),10),i=parseInt(n.get("innerHeight"),10),o=this.state.modal.width?parseInt(this.state.modal.width,10):parseInt(e.getComputedStyle("width"),10),a={},s=e.one(".body"),r=this.get("showFooter")?parseInt(e.one(".foot").getComputedStyle("height"),10):0,u=0,n=parseInt(s.getComputedStyle("borderTopWidth"),10)+parseInt(s.getComputedStyle("borderBottomWidth"),10),s={};this.state.modal.height&&(t=e.one(".head")?parseInt(e.one(".head").getComputedStyle("height"),10):0,u=this.state.modal.height,e.get("showFooter")&&(r=parseInt(e.one(".foot").getComputedStyle("height"),10)),this.state.modal.height+t+r+80+n>=i&&(u=i<=700?i-t-r-n:i-t-r-80-n),e.setStyles({maxHeight:"none"}),this.get("flexLayout")&&e.setStyle("height",this.state.modal.height),this.get("fullWindow")?s.height=this.get("flexLayout")?"auto":u+"px":this.get("maxHeight")&&(s.maxHeight=this.get("flexLayout")?"auto":u+"px"),e.one(p.css.modalContent).setStyles(s)),n=parseInt(e.getComputedStyle("height"),10),u=e.getDOMNode().scrollHeight,s=e.getDOMNode().scrollWidth,a={top:"50%",left:"50%",width:this.state.modal.width?o+"px":"",marginTop:-n/2+"px",marginLeft:-o/2+"px",minWidth:this.state.modal.minWidth?this.state.modal.minWidth+"px":""},i<=n+40||n+1<=u||l<=o+40||o<=s?(i<=700&&this.state.modal.height?a.maxHeight=i-10+"px":(a.maxHeight=i-40+"px",a.overflow="auto"),a.maxWidth=l-40+"px",a.marginTop=-Math.min(parseInt(a.maxHeight,10),n)/2+"px",a.marginLeft=-Math.min(parseInt(a.maxWidth,10),o)/2+"px"):(a.maxHeight="inherit",a.maxWidth="inherit",a.overflow="visible"),e.setStyles(a)},handleX:function(t){var e=this.get("subview");c.rapidTracker.beacon(n,"modalCancelClick"),e&&e.handleX&&e.handleX(),this.close(t),this.fire("cancelClick",t)},handleCancel:function(t){var e=this.get("subview");c.rapidTracker.beacon(n,"modalCancelClick"),e&&e.handleCancel&&!1===e.handleCancel()||(this.fire("cancelClick",t),this.close(t))},handleAction:function(t){var e=this.get("subview");e&&e.handleAction&&!1===e.handleAction()||(this.fire("actionClick",t),this.get("dismissOnActionClick")&&this.close(t))},close:function(t){c.fire("flickr:removeKeyEventScope",this.getKeyEventScope());var e=this.get("container");this.isClosed=!0,c.one("body").removeClass("scroll-fluid-modal"),this.get("subview")&&this.get("subview").destroy(),this.get("navBarView")&&this.get("navBarView").destroy(),e&&e.remove(!0),this.fire("close",t),this.destroy(),this.appContext.overlayManager.pop(this.overlayId)},getKeyEventScope:function(){return this.name+this._yuid},destructor:function(){this.detachAll()}},{ATTRS:{showCancelX:{value:!0},showCancelButton:{value:!0},showBodyLines:{value:!1},showActionButton:{value:!0},hideModalOverlay:{value:!1},darkOverlay:{value:!1},lightOverlay:{value:!1},actionButtonLabel:{valueFn:function(){return this.intlMessage({intlName:"common.OK"})}},actionButtonIsDangerous:{value:!1},cancelButtonLabel:{valueFn:function(){return this.intlMessage({intlName:"common.CANCEL"})}},actionButtonDisabled:{value:!1},showButtons:{value:!0},dismissOnOverlayClick:{value:!1},dismissOnActionClick:{value:!0},title:{value:""},htmlTitle:{value:""},navBarView:{value:null},message:{value:null},textMessage:{value:null},htmlMessage:{value:null},width:{value:0},minWidth:{value:0},height:{value:0},fullWindow:{value:!1},subview:{value:null},classList:{value:""},buttonFlavorText:{value:""},showButtonFlavorText:{value:!0},showHeader:{value:!0},showFooter:{value:!0},noScroll:{value:!1},maxHeight:{value:!0},modalSelector:{value:".modal"},removeOverlayOnClose:{value:!1},overlayClassList:{value:"",validator:function(t,e){return c.AttributeHelpers.validateString(t)},setter:function(t,e){return c.AttributeHelpers.coerceString(t)}},contentPadding:{value:void 0,validator:function(t,e){return c.AttributeHelpers.validateInteger(t)},setter:function(t,e){return c.AttributeHelpers.coerceInteger(t)}},focusOnFirstTabPress:{value:!0},flexLayout:{value:!1}}})},"@VERSION@",{requires:["flickr-view","hermes-template-fluid-modal","attribute-helpers"],optionalRequires:["fluid"],langBundles:["common"]}),YUI.add("hermes-template-signup-modal",function(n,t){var l=n.Template.Handlebars.revive({1:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return" "+t.escapeExpression("function"==typeof(o=null!=(o=o(n,"signUpHeaderClass")||(null!=e?o(e,"signUpHeaderClass"):e))?o:t.hooks.helperMissing)?o.call(null!=e?e:t.nullContext||{},{name:"signUpHeaderClass",hash:{},data:i,loc:{start:{line:2,column:43},end:{line:2,column:64}}}):o)},3:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return" style=\"background-image:url('"+t.escapeExpression("function"==typeof(o=null!=(o=o(n,"signUpHeaderImage")||(null!=e?o(e,"signUpHeaderImage"):e))?o:t.hooks.helperMissing)?o.call(null!=e?e:t.nullContext||{},{name:"signUpHeaderImage",hash:{},data:i,loc:{start:{line:2,column:127},end:{line:2,column:148}}}):o)+"')\""},compiler:[8,">= 4.3.0"],main:function(t,e,n,l,i){var o,a=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,r=t.escapeExpression,u=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="signup-modal-body">\n\t<div class="head'+(null!=(o=u(n,"if").call(a,null!=e?u(e,"signUpHeaderClass"):e,{name:"if",hash:{},fn:t.program(1,i,0),inverse:t.noop,data:i,loc:{start:{line:2,column:17},end:{line:2,column:71}}}))?o:"")+'"'+(null!=(o=u(n,"if").call(a,null!=e?u(e,"signUpHeaderImage"):e,{name:"if",hash:{},fn:t.program(3,i,0),inverse:t.noop,data:i,loc:{start:{line:2,column:72},end:{line:2,column:158}}}))?o:"")+'></div>\n\t<h3 class="signup-title">'+r("function"==typeof(o=null!=(o=u(n,"signUpTitle")||(null!=e?u(e,"signUpTitle"):e))?o:s)?o.call(a,{name:"signUpTitle",hash:{},data:i,loc:{start:{line:3,column:26},end:{line:3,column:41}}}):o)+'</h3>\n\t<p class="signup-message">'+r("function"==typeof(o=null!=(o=u(n,"signUpMessage")||(null!=e?u(e,"signUpMessage"):e))?o:s)?o.call(a,{name:"signUpMessage",hash:{},data:i,loc:{start:{line:4,column:27},end:{line:4,column:44}}}):o)+'</p>\n\t<button class="large action signup-button">'+r((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(a,{name:"intlMessage",hash:{intlName:"common.SIGN_UP"},data:i,loc:{start:{line:5,column:44},end:{line:5,column:85}}}))+'</button>\n</div>\n<div class="signup-modal-footer">\n\t<span>'+r((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(a,{name:"intlMessage",hash:{intlName:"common.HAVE_A_FLICKR_ACCOUNT"},data:i,loc:{start:{line:8,column:7},end:{line:8,column:62}}}))+'</span>\n\t<a href="#" class="signin-link">'+r((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(a,{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:i,loc:{start:{line:9,column:33},end:{line:9,column:74}}}))+"</a>\n</div>\n"},useData:!0}),i={};n.Array.each([],function(t){var e=n.Template.get("hermes/"+t);e&&(i[t]=e)}),n.Template.register("hermes/signup-modal",function(t,e){return(e=e||{}).partials=e.partials?n.merge(i,e.partials):i,l(t,e)})},"@VERSION@",{requires:["template-base","handlebars-base"]}),YUI.add("signup-modal-view",function(t,e){"use strict";t.namespace("Views").SignUpModal=t.FlickrView.create(this.name,t.Views.FluidModal,[],{initializer:function(t){return t.signUpHeaderClass||(t.signUpHeaderClass=""),this.set("showFooter",!1),this.set("showHeader",!1),this.set("showButtonFlavorText",!1),this.set("showButtons",!1),this.set("showActionButton",!1),this.set("showCancelButton",!1),this.set("signUpHeaderClass",t.signUpHeaderClass),this.set("signUpHeaderImage",t.signUpHeaderImage),this.set("signUpTitle",t.signUpTitle),this.set("signUpMessage",t.signUpMessage),this.set("beaconPrefix",t.beaconPrefix),this.set("classList","signup-modal"),this},buildContainer:function(){var t;return this.alreadyShowingModal||(t={signUpHeaderClass:this.get("signUpHeaderClass"),signUpHeaderImage:this.get("signUpHeaderImage"),signUpTitle:this.get("signUpTitle"),signUpMessage:this.get("signUpMessage")},this.set("htmlMessage",this.templates("signup-modal")(t)),this.constructor.superclass.buildContainer.call(this)),this},activate:function(){return this.get("container").one(".signup-button").on("click",this.handleAction.bind(this)),this.get("container").one(".signin-link").on("click",this.handleSignIn.bind(this)),this.constructor.superclass.activate.call(this),this},handleSignIn:function(t){this.fire("signInClick",t),this.constructor.superclass.handleAction.call(this)},handleAction:function(t){this.fire("signUpClick",t),this.constructor.superclass.handleAction.call(this)}})},"@VERSION@",{requires:["flickr-view","fluid-modal-view","hermes-template-signup-modal"],optionalRequires:["fluid"],langBundles:["common"]}),YUI.add("hermes-template-following-dropdown",function(n,t){var l=n.Template.Handlebars.revive({1:function(t,e,n,l,i){return'\t\t\t<label class = "checked">\n\t\t\t\t<input type="checkbox" checked="checked" id="friend-checkbox" />\n'},3:function(t,e,n,l,i){return'\t\t\t<label>\n\t\t\t\t<input type="checkbox" id="friend-checkbox" />\n'},5:function(t,e,n,l,i){return'\t\t\t<label class="checked">\n\t\t\t\t<input type="checkbox" checked="checked" id="family-checkbox" />\n'},7:function(t,e,n,l,i){return'\t\t\t<label>\n\t\t\t\t<input type="checkbox" id="family-checkbox" />\n'},9:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t<button class="follow unfollow">'+t.escapeExpression((o(n,"intlMessage")||e&&o(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"common.UNFOLLOW"},data:i,loc:{start:{line:27,column:35},end:{line:27,column:77}}}))+"</button>\n"},11:function(t,e,n,l,i){var o=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t<a href="#"><i class="ui-icon-tiny-unfollow"></i> '+t.escapeExpression((o(n,"intlMessage")||e&&o(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{intlName:"common.UNFOLLOW"},data:i,loc:{start:{line:29,column:53},end:{line:29,column:95}}}))+"</a>\n"},compiler:[8,">= 4.3.0"],main:function(t,e,n,l,i){var o,a=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,r=t.escapeExpression,u=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<ul>\n\t<li class="following-friend">\n'+(null!=(o=u(n,"if").call(a,null!=e?u(e,"isFriend"):e,{name:"if",hash:{},fn:t.program(1,i,0),inverse:t.program(3,i,0),data:i,loc:{start:{line:3,column:2},end:{line:9,column:9}}}))?o:"")+"\t\t\t"+r((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(a,{name:"intlMessage",hash:{intlName:"common.FRIEND"},data:i,loc:{start:{line:10,column:3},end:{line:10,column:43}}}))+'\n\t\t</label>\n\t</li>\n\t<li class="following-family">\n'+(null!=(o=u(n,"if").call(a,null!=e?u(e,"isFamily"):e,{name:"if",hash:{},fn:t.program(5,i,0),inverse:t.program(7,i,0),data:i,loc:{start:{line:14,column:2},end:{line:20,column:9}}}))?o:"")+"\t\t\t"+r((u(n,"intlMessage")||e&&u(e,"intlMessage")||s).call(a,{name:"intlMessage",hash:{intlName:"common.FAMILY"},data:i,loc:{start:{line:21,column:3},end:{line:21,column:43}}}))+'\n\t\t</label>\n\t</li>\n\t<li class="divider"></li>\n\t<li class="following-unfollow">\n'+(null!=(o=u(n,"if").call(a,null!=e?u(e,"isFluid"):e,{name:"if",hash:{},fn:t.program(9,i,0),inverse:t.program(11,i,0),data:i,loc:{start:{line:26,column:2},end:{line:30,column:9}}}))?o:"")+"\t</li>\n</ul>"},useData:!0}),i={};n.Array.each([],function(t){var e=n.Template.get("hermes/"+t);e&&(i[t]=e)}),n.Template.register("hermes/following-dropdown",function(t,e){return(e=e||{}).partials=e.partials?n.merge(i,e.partials):i,l(t,e)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
