!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}"function"!=typeof window.CustomEvent&&(e.prototype=window.Event.prototype,window.CustomEvent=e)}(),function(){function e(e,t,n){this.domain=e,this.siteDomain=t,this.eventContext=n||window,this.apiObjectName="PrivacyManagerAPI",this.apiObjectParent=window}e.prototype.initialize=function(e){var o=this;this.consentStates={},this.consentTypes=e||["required","functional","advertising"],window.addEventListener("message",function(e){try{var t=JSON.parse(e.data);t.PrivacyManagerAPI&&o.handleApiMessage(t.PrivacyManagerAPI)}catch(e){}},!1),this.approveConsent("required"),this.waitForObject(this.apiObjectParent,this.apiObjectName,10,function(e){o.privacyApi=e;for(var t=0;t<o.consentTypes.length;t++){var n=o.consentTypes[t];o.haveConsent(n)||(o.requestConsentMessaging(n),o.handleResponse(n,o.getConsent(n)))}})},e.prototype.approveConsent=function(e,t){void 0===t&&(t="implied"),this.haveConsent(e)||(this.consentStates[e]=!0,t=new CustomEvent("ConsentManager_approved",{detail:{type:e,source:t}}),this.eventContext.dispatchEvent(t))},e.prototype.callApi=function(e,t){return this.privacyApi.callApi(e,this.domain,this.siteDomain,null,t)},e.prototype.denyConsent=function(e,t){void 0===t&&(t="implied"),!1!==this.consentStates[e]&&(this.consentStates[e]=!1,t=new CustomEvent("ConsentManager_denied",{detail:{type:e,source:t}}),this.eventContext.dispatchEvent(t))},e.prototype.getConsent=function(e){return this.callApi("getConsent",e)},e.prototype.getConsentRaw=function(e){var t=this.getConsent(e);if(window.localStorage){var n=null;try{n=JSON.parse(window.localStorage.getItem("truste.eu.cookie.notice_preferences"))}catch(e){}if(null!==n&&"string"==typeof n.value){var o=n.value.split(":");if(0<o.length)switch(o=parseInt(o[0]),t.source="raw_storage",e){case"required":t.consent="approved";break;case"functional":t.consent=0<o?"approved":"denied";break;default:t.consent=1<o?"approved":"denied"}}}return t},e.prototype.handleApiMessage=function(e){if(e.source&&e.self==this.domain&&"asserted"==e.source)if(e.type)this.handleResponse(e.type,e);else for(var t=0;t<this.consentTypes.length;t++){var n=this.consentTypes[t];"required"!=n&&this.handleResponse(n,this.getConsent(n))}},e.prototype.handleResponse=function(e,t){"approved"==t.consent?this.approveConsent(e,t.source):"denied"==t.consent?this.denyConsent(e,t.source):console.error("Unknown API response",t)},e.prototype.haveConsent=function(e){return"boolean"==typeof this.consentStates[e]&&this.consentStates[e]},e.prototype.requestConsentMessaging=function(e){e={PrivacyManagerAPI:{self:this.domain,action:"getConsent",timestamp:(new Date).getTime(),type:e}};window.top.postMessage(JSON.stringify(e),"*")},e.prototype.waitForObject=function(t,n,e,o){var s=setInterval(function(){var e;void 0!==t[n]&&(e=new CustomEvent("ConsentManager_objectReady",{detail:{parentObj:t,objName:n,obj:t[n]}}),clearInterval(s),"function"==typeof o&&o(t[n]),t.dispatchEvent(e))},e)},window&&void 0===window.ConsentManager&&(window.ConsentManager=e)}();
