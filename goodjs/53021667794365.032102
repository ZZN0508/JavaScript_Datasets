!function(){function t(e,o){return function(){var t=v[o],i=this;t&&clearTimeout(t),v[o]=setTimeout(function(){e.apply(i,arguments)},300)}}function e(t){this.config=function(t,i){var e,o={};for(e in i)i.hasOwnProperty(e)&&(o[e]=(void 0===t[e]?i:t)[e]);return o}(t||{},g),this.init()}var i=window.dui||{},h=[],o=null,n=!(!$.browser||!$.browser.msie||"6.0"!==$.browser.version),d=(0 in window,{}),a={},s="j_close_dialog",c="dui-dialog-close",l="dui-dialog-shd",r="dui-dialog-iframe",u="dui-dialog-msk",f="ä¸‹è½½ä¸­ï¼Œè¯·ç¨å€™...",p='<div id="{ID}" class="dui-dialog {CLS}" style="{CSS_ISHIDE}">                <span class="'+l+'"></span>                <div class="dui-dialog-content">                    {BN_CLOSE}                    {TITLE}                    <div class="bd">{BODY}</div>                </div>            </div>',m={confirm:{text:"ç¡®å®š",method:function(t){t.close()}},cancel:{text:"å–æ¶ˆ",method:function(t){t.close()}}},g={url:"",nodeId:"",cls:"",content:"",title:"æç¤º",width:0,height:0,visible:!1,modal:!1,iframe:!1,maxWidth:960,autoupdate:!1,cache:!0,buttons:[],callback:null,dataType:"text",isStick:!1,isHideClose:!1,isHideTitle:!1};e.prototype={init:function(){if(this.config)return this.render(),this.bind(),this},render:function(t){var i=this.config,e=i.nodeId||"dui-dialog"+h.length;h.push(e);var o=$("body"),n=o.find("."+u),s="object"==typeof i.content?$(i.content).html():i.content;return o.append(p.replace("{ID}",e).replace("{CSS_ISHIDE}",i.visible?"":"visibility:hidden;top:-999em;left:-999em;").replace("{CLS}",i.cls).replace("{TITLE}",'<div class="hd"><h3>{TITLE}</h3></div>'.replace("{TITLE}",i.title)).replace("{BN_CLOSE}",'<a href="#" class="j_close_dialog dui-dialog-close">X</a>').replace("{BODY}",s||t||"")),i.modal&&!n.length?(o.append('<div class="dui-dialog-msk"></div>'),this.msk=$("."+u)):this.msk=n.eq(0),this.nodeId=e,this.node=$("#"+e),this.title=$(".hd",this.node),this.body=$(".bd",this.node),this.btnClose=$("."+c,this.node),this.shadow=$("."+l,this.node),this.iframe=$("."+r,this.node),this.set(i),this},bind:function(){var i=this;return n||$(window).bind({resize:t(function(){i.updatePosition()},"pos"),scroll:t(function(){i.updatePosition()},"pos")}),i.node.delegate("."+s,"click",function(t){i.close(),t.preventDefault()}),i.node.find("."+c).bind("click",function(t){i.close(),t.preventDefault()}),$("body").keypress(function(t){27===t.keyCode&&i.close()}),this},updateSize:function(){var t=this.node.width(),i=$(window).width(),e=$(window).height(),o=this.config;$(".bd",this.node).eq(0).css({height:"auto","overflow-x":"visible","overflow-y":"visible"});var n=this.node.height();return o.maxWidth=Math.min(o.maxWidth,i-16),t>o.maxWidth&&(t=o.maxWidth,this.node.css("width",t+"px")),e<n&&$(".bd",this.node).eq(0).css({height:e-150+"px","overflow-x":"hidden","overflow-y":"auto"}),n=this.node.height(),this.shadow.width(t),this.shadow.height(n),this.iframe.width(t+16).height(n+16),this},updatePosition:function(){if(!this.config.isStick){var t=this.node.width(),i=this.node.height(),e=$(window),o=n?e.scrollTop():0;return this.node.css({left:Math.floor(e.width()/2-t/2)+"px",top:Math.floor(e.height()/2-i/2-8)+o+"px"}),this}},set:function(i){var e,o=this.nodeId,n=this.nodeId||n,s=[],h=this;if(!i)return this;i.width&&(this.node.css("width",i.width+"px"),this.config.width=i.width),i.height&&(this.node.css("height",i.height+"px"),this.config.height=i.height),$.isArray(i.buttons)&&i.buttons[0]?(t=$(".ft",this.node),e=[],$(i.buttons).each(function(){var t=arguments[1],i=(s.push(0),o+"-bn-"+s.length);(t="string"==typeof t?m[t]:t).text&&(t.href?e.push('<a class="'+(t.cls||"")+'" id="'+i+'" href="'+t.href+'">'+t.text+"</a> "):e.push('<span class="bn-flat '+(t.cls||"")+'"><input type="button" id="'+i+'" class="'+n+'-bn" value="'+t.text+'" /></span> '),a[i]=t.method)}),t[0]?t.html(e.join("")):t=this.body.parent().append('<div class="ft">'+e.join("")+"</div>"),this.footer=$(".ft",this.node),$(".ft input, .ft a",this.node).click(function(t){var i,e=this.id&&a[this.id];(i=e?e.call(this,h):i)&&(t.preventDefault(),"string"==typeof i&&alert(i))})):(this.footer=$(".ft",this.node),this.footer.html("")),void 0!==i.isHideClose&&(i.isHideClose?this.btnClose.hide():this.btnClose.show(),this.config.isHideClose=i.isHideClose),void 0!==i.isHideTitle&&(i.isHideTitle?this.title.hide():this.title.show(),this.config.isHideTitle=i.isHideTitle),i.title&&(this.setTitle(i.title),this.config.title=i.title),void 0!==i.iframe&&(i.iframe?this.iframe[0]?this.iframe.show():(this.node.prepend('<iframe class="dui-dialog-iframe"></iframe>'),this.iframe=$("."+r,this.node)):this.iframe.hide(),this.config.iframe=i.iframe),i.content&&(this.body.html("object"==typeof i.content?$(i.content).html():i.content),this.config.content=i.content),i.url&&(i.cache&&d[i.url]?("text"!==i.dataType&&i.dataType||this.setContent(d[i.url]),i.callback&&i.callback(d[i.url],this)):"json"===i.dataType?(this.setContent(f),this.footer&&this.footer.hide(),$.getJSON(i.url,function(t){h.footer.show(),d[i.url]=t,i.callback&&i.callback(t,h)})):(this.setContent(f),this.footer&&this.footer.hide(),$.ajax({url:i.url,dataType:i.dataType,success:function(t){d[i.url]=t,h.footer&&h.footer.show(),h.setContent(t),i.callback&&i.callback(t,h)}})));var t=i.position;return t&&this.node.css({left:t[0]+"px",top:t[1]+"px"}),"boolean"==typeof i.autoupdate&&(this.config.autoupdate=i.autoupdate),"boolean"==typeof i.isStick&&(i.isStick?this.node.css("position","absolute"):this.node.css("position","fixed"),this.config.isStick=i.isStick),this.update()},update:function(){return this.updateSize(),this.updatePosition(),this},setContent:function(t){return this.body.html(t),this.update()},setTitle:function(t){return $("h3",this.title).html(t),this},submit:function(o){var t=$("form",this.node);t.submit(function(t){t.preventDefault();var i=this.getAttribute("action",2),e=this.getAttribute("method")||"get",t=function(t){for(var i,e=t.elements,o=0,n=[],s={"select-one":function(t){return encodeURIComponent(t.name)+"="+encodeURIComponent(t.options[t.selectedIndex].value)},"select-multiple":function(t){for(var i,e=0,o=[];i=t.options[e++];)i.selected&&o.push(encodeURIComponent(t.name)+"="+encodeURIComponent(i.value));return o.join("&")},radio:function(t){if(t.checked)return encodeURIComponent(t.name)+"="+encodeURIComponent(t.value)},checkbox:function(t){if(t.checked)return encodeURIComponent(t.name)+"="+encodeURIComponent(t.value)}};i=e[o++];)s[i.type]?n.push(s[i.type](i)):n.push(encodeURIComponent(i.name)+"="+encodeURIComponent(i.value));return n.join("&").replace(/\&{2,}/g,"&")}(this);$[e.toLowerCase()](i,t,function(t){o&&o(t)},"json")}),t.submit()},open:function(){this.node.appendTo("body").css("visibility","visible").show();var t=this,i=this.config,e=t.body[0];return t.contentHeight=e.offsetHeight,this.watcher=i.autoupdate?setInterval(function(){e.offsetHeight!==t.contentHeight&&(t.update(),t.contentHeight=e.offsetHeight)},100):0,i.modal&&this.msk.show().css({height:$(document).height()}),this},close:function(){return this.node.hide(),this.msk.hide(),this.node.trigger("dialog:close",this),clearInterval(this.watcher),this}},i.Dialog=function(t,i){return!i&&o?t?o.set(t):o:o||i?new e(t):o=new e(t)},window.dui=i;var v={}}();
