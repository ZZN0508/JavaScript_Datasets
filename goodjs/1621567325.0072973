define("pkg/@alife/refly-db/3.x/index",["pkg/@alife/refly-monitor/0.0.x/index","jquery"],function(t,n){return function(t){function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var e={};return n.m=t,n.c=e,n.d=function(exports,t,e){n.o(exports,t)||Object.defineProperty(exports,t,{configurable:!1,enumerable:!0,value:e})},n.n=function(t){var e=t&&t.__esModule?t["default"]:t;return n.d({},"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=6)}([function(n,exports){n.exports=t},function(t,exports,n){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),i=function(){},o=function(){function t(){var n=this;e(this,t),this.sucCbs=[],this.errCbs=[],this.finCbs=[],this.firstCbs=[],this.secondCbs=[],this.catCbs=[],this.status=0;for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];i.length>0&&(Promise.all(i.map(function(t){return t._first()})).then(function(t){n.resolve(t,"FIRST")},function(t){n.reject(t)}),Promise.all(i.map(function(t){return t._sencond()})).then(function(t){n.resolve(t,"SECOND")},function(t){n.reject(t)}))}return r(t,[{key:"done",value:function(t){return this.sucCbs.push(t),this}},{key:"fail",value:function(t){return this.errCbs.push(t),this}},{key:"final",value:function(t){return this.finCbs.push(t),this}},{key:"catch",value:function(t){return this.catCbs.push(t),this}},{key:"fire",value:function(t,n,e){for(var r=0,i=t.length;r<i;r++)t[r](n,e);return this}},{key:"resolve",value:function(t,n){this.fire(this.sucCbs,t,n).fire(this.finCbs,t,n),this.status&&(n&&1===this.status&&(this.firstCbs[0]&&this.firstCbs[0](t),this.status=2),n||(1===this.status&&this.firstCbs[0]&&this.firstCbs[0](t),this.secondCbs[0]&&this.secondCbs[0](t),this.status=3))}},{key:"reject",value:function(t,n){if("dev"===window._ENV_&&0===this.errCbs.length)throw new Error("You need use fail method to get the error: "+JSON.stringify(t));this.fire(this.errCbs,t,n).fire(this.finCbs,t,n),this.status&&(1===this.status?this.firstCbs[1]&&this.firstCbs[1](t):2===this.status&&this.secondCbs[1]&&this.secondCbs[1](t),this.status=0)}},{key:"_first",value:function(){var t=this;return this._first=i,this.status=1,new Promise(function(n,e){t.firstCbs.push(n,e)})}},{key:"_sencond",value:function(){var t=this;return this._sencond=i,this.status=1,new Promise(function(n,e){t.secondCbs.push(n,e)})}}]),t}();t.exports=o},function(t,exports,n){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=function(t){var n="DB("+t.url+")";return"object"===e(t._inject_)&&(n="Component("+t._inject_.name+"@"+t._inject_.version+")."+n),n}},function(t,exports){t.exports=n},function(t,exports,n){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function r(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}function i(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),s=n(5),$=n(3),l=n(7),u=n(9),a=n(1),c=n(8),f=function(t){function n(t){e(this,n);var i=r(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return i.options=$.extend({},t||{},i.constructor.defaultOptions),l(i),u(i),i}return i(n,t),o(n,[{key:"ajax",value:function(t,n){var e=this;n=n||new a;var r=this.applyPluginsWaterfall("options",$.extend({},this.options,t));return this.applyPluginsBailResult("endpoint",r,n)(r).then(c(function(t){!1===e.applyPluginsBailResult("judge",t,r)?(t=e.applyPluginsWaterfall("error",t,r),n.reject(t)):e.applyPlugins("resolve",t,r,n)},n,r),c(function(t){t=e.applyPluginsWaterfall("error",t,r),n.reject(t)},n,r)),n}},{key:"get",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return n.method="GET",n.data=t,this.ajax(n)}},{key:"post",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return n.method="POST",n.data=t,this.ajax(n)}},{key:"jsonp",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return n.dataType="JSONP",n.data=t,this.ajax(n)}}]),n}(s);t.exports=f},function(t,exports){function n(t){"use strict";if(void 0===this||null===this)throw new TypeError;var n=Object(this),e=n.length>>>0;if("function"!=typeof t)throw new TypeError;for(var r=[],i=arguments.length>=2?arguments[1]:void 0,o=0;o<e;o++)if(o in n){var s=n[o];t.call(i,s,o,n)&&r.push(s)}return r}function e(){this._plugins={}}function r(t,n){for(var e in t)n[e]=t[e];return n}t.exports=e,e.mixin=function(t){r(e.prototype,t)},e.prototype.applyPlugins=function(t){if(this._plugins[t])for(var n=Array.prototype.slice.call(arguments,1),e=this._plugins[t],r=0;r<e.length;r++)e[r].apply(this,n)},e.prototype.applyPlugins0=function(t){var n=this._plugins[t];if(n)for(var e=0;e<n.length;e++)n[e].call(this)},e.prototype.applyPlugins1=function(t,n){var e=this._plugins[t];if(e)for(var r=0;r<e.length;r++)e[r].call(this,n)},e.prototype.applyPlugins2=function(t,n,e){var r=this._plugins[t];if(r)for(var i=0;i<r.length;i++)r[i].call(this,n,e)},e.prototype.applyPluginsWaterfall=function(t,n){if(!this._plugins[t])return n;for(var e=Array.prototype.slice.call(arguments,2),r=this._plugins[t],i=n,o=0;o<r.length;o++)i=r[o].apply(this,[i].concat(e));return i},e.prototype.applyPluginsWaterfall0=function(t,n){var e=this._plugins[t];if(!e)return n;for(var r=n,i=0;i<e.length;i++)r=e[i].call(this,r);return r},e.prototype.applyPluginsBailResult=function(t){if(this._plugins[t])for(var n=Array.prototype.slice.call(arguments,1),e=this._plugins[t],r=0;r<e.length;r++){var i=e[r].apply(this,n);if(void 0!==i)return i}},e.prototype.applyPluginsBailResult1=function(t,n){if(this._plugins[t])for(var e=this._plugins[t],r=0;r<e.length;r++){var i=e[r].call(this,n);if(void 0!==i)return i}},e.prototype.applyPluginsAsyncSeries=e.prototype.applyPluginsAsync=function(t){var n=Array.prototype.slice.call(arguments,1),e=n.pop(),i=this._plugins[t];if(!i||0===i.length)return e();var o=0,s=this;n.push(r(e,function(t){return t?e(t):++o>=i.length?e():void i[o].apply(s,n)})),i[0].apply(this,n)},e.prototype.applyPluginsAsyncSeries1=function(t,n,e){var i=this._plugins[t];if(!i||0===i.length)return e();var o=0,s=this,l=r(e,function(t){return t?e(t):++o>=i.length?e():void i[o].call(s,n,l)});i[0].call(this,n,l)},e.prototype.applyPluginsAsyncSeriesBailResult=function(t){var n=Array.prototype.slice.call(arguments,1),e=n.pop();if(!this._plugins[t]||0===this._plugins[t].length)return e();var i=this._plugins[t],o=0,s=this;n.push(r(e,function(){return arguments.length>0?e.apply(null,arguments):++o>=i.length?e():void i[o].apply(s,n)})),i[0].apply(this,n)},e.prototype.applyPluginsAsyncSeriesBailResult1=function(t,n,e){var i=this._plugins[t];if(!i||0===i.length)return e();var o=0,s=this,l=r(e,function(t,r){return arguments.length>0?e(t,r):++o>=i.length?e():void i[o].call(s,n,l)});i[0].call(this,n,l)},e.prototype.applyPluginsAsyncWaterfall=function(t,n,e){if(!this._plugins[t]||0===this._plugins[t].length)return e(null,n);var i=this._plugins[t],o=0,s=this,l=r(e,function(t,n){return t?e(t):++o>=i.length?e(null,n):void i[o].call(s,n,l)});i[0].call(this,n,l)},e.prototype.applyPluginsParallel=function(t){var n=Array.prototype.slice.call(arguments,1),e=n.pop();if(!this._plugins[t]||0===this._plugins[t].length)return e();var i=this._plugins[t],o=i.length;n.push(r(e,function(t){if(!(o<0))return t?(o=-1,e(t)):(o--,0===o?e():void 0)}));for(var s=0;s<i.length;s++)if(i[s].apply(this,n),o<0)return},e.prototype.applyPluginsParallelBailResult=function(t){var e=Array.prototype.slice.call(arguments,1),i=e[e.length-1];if(!this._plugins[t]||0===this._plugins[t].length)return i();for(var o,s=this._plugins[t],l=s.length,u=[],a=0;a<s.length;a++)e[e.length-1]=function(t){return r(i,function(){t>=l||(u.push(t),arguments.length>0&&(l=t+1,u=n.call(u,function(n){return n<=t}),o=Array.prototype.slice.call(arguments)),u.length===l&&(i.apply(null,o),l=0))})}(a),s[a].apply(this,e)},e.prototype.applyPluginsParallelBailResult1=function(t,e,i){var o=this._plugins[t];if(!o||0===o.length)return i();for(var s,l=o.length,u=[],a=0;a<o.length;a++){var c=function(t){return r(i,function(){t>=l||(u.push(t),arguments.length>0&&(l=t+1,u=n.call(u,function(n){return n<=t}),s=Array.prototype.slice.call(arguments)),u.length===l&&(i.apply(null,s),l=0))})}(a);o[a].call(this,e,c)}},e.prototype.plugin=function(t,n){if(Array.isArray(t))return void t.forEach(function(t){this.plugin(t,n)},this);this._plugins[t]?this._plugins[t].push(n):this._plugins[t]=[n]},e.prototype.apply=function(){for(var t=0;t<arguments.length;t++)arguments[t].apply(this)}},function(t,exports,n){"use strict";var e=n(4),r=n(1);e.Defer=r,t.exports=e},function(t,exports,n){"use strict";function e(t){return t?Object.keys(t).filter(function(t){return"_"!==t.charAt(0)}).sort().reduce(function(n,e){return n.push(e+"="+t[e]),n},[]).join("&"):""}function r(t){var n=t.__key__||t.url+"?"+e(t.data);return t.__key__=n,n}function i(t,n){var e=s.get(n.hasCache),r=new Promise(function(t,n){setTimeout(function(){e&&t($.extend({__flag__:"CACHE"},e))},0)});if(n.refresh&&!n.lazy){var i=n.hasCache,o=+i.slice(i.length-13);if(n.refresh>+new Date-o)return r}return this.ajax($.extend({},n,{nocache:"again",hasCache:!1}),t),r}function o(t){if(t.nocache)return!1;var n=s.has(r(t),t.level);if(n&&t.lazy&&t.refresh){var e=+n.slice(n.length-13);if(t.refresh<+new Date-e)return!1}return n}var s=n(10),$=n(3),l=n(0),u=n(2);t.exports=function(t){s.compat()&&(s.init(),t.plugin("options",function(t){return t.hasCache=o(t),t.lazy&&!t.refresh&&(t.refresh=864e5),t}),t.plugin("endpoint",function(n,e){if(n.hasCache)return i.bind(t,e);n.__start__=+new Date}),t.plugin("resolve",function(t,n,e){if(n.nocache&&"again"!==n.nocache||t.__flag__||s.save(r(n),n.level,t),"again"===n.nocache&&n.lazy);else try{e.resolve(t,t.__flag__)}catch(i){throw i.message=u(n)+" "+i.message,l.log("error",i),i}}))}},function(t,exports,n){"use strict";var e=n(2);t.exports=function(t,n,r){var i=e(r);return function(e){try{t(e)}catch(o){var r=window["console"];0===n.catCbs.length&&r&&r.warn&&(r.warn(i+" may have some error, please use catch method to catch error"),r.warn(o.toString())),n.fire(n.catCbs,o)}}}},function(t,exports,n){"use strict";var e=n(0);t.exports=function(t){t.plugin("error",function(t,n){return e.reportState(n.url,!1,t.traceId&&"traceId="+t.traceId||null),t}),t.plugin("resolve",function(t,n){e.reportState(n.url,!0,undefined,+new Date-n.__start__),e.log("debug",{from:n.url,msg:t})})}},function(t,exports,n){"use strict";function e(){d=Object.keys(window.localStorage)}function r(){return!!window.localStorage}function i(t,n){return n>3?"refly"+n+"\u2702$_SYSTEM_$\u2702"+t+"\u2702":"refly"+n+"\u2702"+y+"\u2702"+t+"\u2702"}function o(t){for(var n=0,e=t.length;n<e;n++){var r=t[n],i=d.indexOf(r);i>=0&&d.splice(i,1),localStorage.removeItem(r)}}function s(t){for(var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1,e=i(t,n),r=0,o=d.length;r<o;r++)if(0===d[r].indexOf(e))return d[r];return!1}function l(t,n){for(var e=i(t,n),r=[],s=0,l=d.length;s<l;s++)0===d[s].indexOf(e)&&r.push(d[s]);o(r)}function u(t){var n=[];if(t>4)return d.length=0,void localStorage.clear();if(0===t)for(var e=/refly[1-3]\u2702([^\u2702]+)/,r=0,i=d.length;r<i;r++){var s=d[r].match(e);s&&s[1]!==y&&n.push(d[r])}else for(var l="refly"+t+"\u2702",u=0,a=d.length;u<a;u++)0===d[u].indexOf(l)&&n.push(d[u]);o(n)}function a(t,n,e,r){e={r:e,v:g},setTimeout(function(){l(t,n);var o=JSON.stringify(e);if(o.length>1e5)return void h.log("warn","[API_REPONSE_TOO_BIG]"+t);var s=""+i(t,n)+ +new Date;try{localStorage[s]=o,d.push(s)}catch(c){r<=n&&(u(r),a(t,n,e,r++))}},0)}function c(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1,e=arguments[2];"object"===(void 0===e?"undefined":p(e))&&(v[t]=e,a(t,n,e,0))}function f(t){var n=t.split("\u2702"),e=void 0;if(n>3&&(e=v[n[2]]),!e)try{e=JSON.parse(localStorage[t]),e.v===g?e=e.r:(o([t]),e=!1)}catch(r){d.length=0,localStorage.clear(),e=!1}return e}var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=n(0),y=function(){var t=/(^| )last_mid=([^;]*)(;|$)/,n=document.cookie.match(t);return n?n[2]:"$_stranger_$"}(),g=1,v={},d=[];t.exports={init:e,compat:r,has:s,save:c,get:f}}])});;