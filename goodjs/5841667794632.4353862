!function(n){var i={};function r(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=n,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isString:function(e){return"[object String]"===Object.prototype.toString.call(e)},isNumber:function(e){return"[object Number]"===Object.prototype.toString.call(e)},forEach:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0;if(e.forEach)e.forEach(t,n);else for(var i=0;i<e.length;i++)t.call(n,e[i],i,e)},map:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0;if(e.map)return e.map(t,n);for(var i=[],r=0;r<e.length;r++)i.push(t.call(n,e[r],r,e));return i},filter:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0;if(e.filter)return e.filter(t,n);for(var i=[],r=0;r<e.length;r++)t.call(n,e[r],r,e)&&i.push(e[r]);return i},forEachHash:function(e,t){var n,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(i,n,e[n],e)},extend:function(e){for(var t=1;t<(arguments.length<=1?0:arguments.length-1);t++){var n,i=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},makeRandomString:function(){return Math.floor(1e9*Math.random()).toString(32)}}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.ElementPosition=t.Rect=void 0;var l=n(0),s=function(){try{window.top.document}catch(e){return window}return window.top}(),o=s.document,u=(a(c,[{key:"transfer",value:function(e,t){this.left+=e,this.right+=e,this.top+=t,this.bottom+=t}},{key:"copy",value:function(){return new c(this)}},{key:"getOverlappedArea",value:function(e){var t=Math.max(this.top,e.top),n=Math.min(this.bottom,e.bottom),i=Math.max(this.left,e.left),e=Math.min(this.right,e.right);return new c(0<n-t&&0<e-i?{top:t,bottom:n,left:i,right:e}:{top:0,bottom:0,left:0,right:0})}},{key:"toString",value:function(){return"Rect W:"+this.width+" H:"+this.height+" T:"+this.top+" L:"+this.left+" B:"+this.bottom+" R:"+this.right}}]),c);function c(e){i(this,c),this.top=e.top,this.left=e.left,e.width?(this.width=e.width,this.height=e.height,this.bottom=this.top+this.height,this.right=this.left+this.width):(this.bottom=e.bottom,this.right=e.right,this.width=this.right-this.left,this.height=this.bottom-this.top)}function h(e){return e.ownerDocument.defaultView||e.ownerDocument.parentWindow}function d(e,t,n){t=t||0,n=n||0;var i,r=0,a=0;try{for(var o=h(e).frameElement;o;o=h(o).frameElement){var s=o.getBoundingClientRect();r+=s.top,a+=s.left}}catch(e){}try{i=e.getBoundingClientRect()}catch(e){i={top:0,left:0,bottom:0,right:0}}return new u({top:Math.round(i.top+n+r),left:Math.round(i.left+t+a),bottom:Math.round(i.bottom+n+r),right:Math.round(i.right+t+a)})}function f(){var e=s.innerWidth||o.documentElement.clientWidth,t=s.innerHeight||o.documentElement.clientHeight,n=0,i=0;return o.body&&(n=o.body.scrollLeft||o.documentElement.scrollLeft,i=o.body.scrollTop||o.documentElement.scrollTop),new u({top:Math.round(i),left:Math.round(n),width:Math.round(e),height:Math.round(t)})}function g(){var e=o.body.scrollLeft||o.documentElement.scrollLeft,t=o.body.scrollTop||o.documentElement.scrollTop;return{left:Math.round(e),top:Math.round(t)}}t.Rect=u;a(p,[{key:"calcLayoutPosition",value:function(){var i=[],e=g(),r=e.top,a=e.left;function t(e){for(var t,n=e.parentNode;n!==n.ownerDocument.body;n=n.parentNode)0<=((t=n).currentStyle||h(t).getComputedStyle(t,"")).overflow.indexOf("scroll")&&(i.unshift(n),r+=n.scrollTop,a+=n.scrollLeft)}t(this.elem);for(var n=h(this.elem);n!=s;){i.unshift(n.frameElement);var o=g();r+=o.top,a+=o.left,t(n.frameElement),n=n.parent}this.layoutPosition=d(this.elem,a,r),this.scrollParents=i}},{key:"getLayoutPosition",value:function(){return!(0<arguments.length&&void 0!==arguments[0]&&arguments[0])&&this.layoutPosition||this.calcLayoutPosition(),this.layoutPosition}},{key:"getViewableRect",value:function(){try{this.calcLayoutPosition()}catch(e){return new u({top:0,bottom:0,left:0,right:0})}var e=f(),t=l.default.map(this.scrollParents,function(e){return e});t.push(this.elem);for(var n,i,r=null,a=e,o=0;o<t.length;o++)if(r=d(t[o],e.left,e.top),this.zeroSizeViewableMode&&(n=0===r.width?1:r.width,i=0===r.height?1:r.height,r=new u({top:r.top,left:r.left,width:n,height:i})),0===(a=a.getOverlappedArea(r)).width||0===a.height)break;if(this.trimmedRect){var s=this.trimmedRect.copy();return s.transfer(r.left,r.top),a.getOverlappedArea(s)}return a}}]),n=p;function p(e,t,n){i(this,p),this.elem=e,this.zeroSizeViewableMode=n&&n.zeroSizeViewableMode,this.trimmedRect=null,t&&(this.trimmedRect=t)}t.ElementPosition=n,t.default={traverseAllWindows:function(a,e){!function e(t){if(a(t)){for(var n=t.frames,i=0;i<n.length;i++){var r=n[i];try{r.document.URL}catch(e){continue}if(!e(r))return}return 1}}(e=e||s)},getElementRect:function(e){e=e.getBoundingClientRect();return new u({top:Math.round(e.top),left:Math.round(e.left),bottom:Math.round(e.bottom),right:Math.round(e.right)})},getViewedRect:f,getPageSize:function(){var e=0,t=0;return o.body&&(t=o.body.scrollWidth||o.documentElement.scrollWidth,e=o.body.scrollHeight||o.documentElement.scrollHeight),{width:Math.round(t),height:Math.round(e)}},getScreenSize:function(){var e=s.innerWidth||o.documentElement.clientWidth,t=s.innerHeight||o.documentElement.clientHeight;return{width:Math.round(e),height:Math.round(t)}},getScrollPos:g,getTopWindow:function(){return s},getBoundingClientRectAsRect:d,isIframeCrossDomain:function(e){var t=null;try{t=(e.contentWindow.document||e.contentDocument).body.innerHTML}catch(e){}return null===t},getAdElements:function(e){var t=[];if(l.default.forEach(e.getElementsByTagName("*"),function(e){null!==e.getAttribute("data-ydntxt-item")&&t.push(e)}),0<t.length)return t;e=e.getElementsByTagName("a");return l.default.forEach(e,function(e){null!==e.href.match(/https?:\/\/rd\.ane\.yahoo\.co\.jp\//)&&t.push(e)}),t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(6),n=n(7);t.default=(i=new r.default((new Date).getTime()),n=new n.default.EventManager(i.baseTime),i.set("eventManager",n),{getMaster:function(){return i}})},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),a=n(0),s=n(1),n=(n=[{key:"isBeaconedTarget",value:function(){return this.viewedEnoughTime&&!this.notifiedOnce}},{key:"setAsNotified",value:function(){this.notifiedOnce=!0}},{key:"checkEfpFunction",value:function(){var t=0,e=[],n=this.rawElement.getBoundingClientRect(),i={top:Math.round((n.top+n.bottom)/2),left:Math.round((n.left+n.right)/2)},n={top:n.top+1,left:n.left+1,right:n.right-1,bottom:n.bottom-1};return e.push(document.elementFromPoint(n.left,n.top)),e.push(document.elementFromPoint(n.right,n.top)),e.push(document.elementFromPoint(n.left,n.bottom)),e.push(document.elementFromPoint(n.right,n.bottom)),e.push(document.elementFromPoint(i.left,i.top)),a.default.forEach(e,function(e){null!==e&&t++},this),3<=t}},{key:"calcViewableArea",value:function(e){var t=this.position.getViewableRect(),n=t.width*t.height;if(0==n)return 0;var i,r=this.trimmedRect||s.default.getElementRect(this.rawElement);this.zeroSizeViewableMode&&(i=0===r.width?1:r.width,t=0===r.height?1:r.height,r=new s.Rect({top:r.top,left:r.left,width:i,height:t}));r=r.width*r.height,e=e.width*e.height;return 0==r||0==e?0:n/Math.min(r,e)}},{key:"isAdIframe",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(10<t)return!0;if(s.default.isIframeCrossDomain(e))return e===this.rawElement;var e=(e.contentDocument||e.contentWindow.document).body,n=[];if(a.default.forEach(e.getElementsByTagName("iframe"),function(e){this.isAdIframe(e,t+1)&&n.push(e)},this),0<n.length)return!0;if(a.default.forEach(e.getElementsByTagName("*"),function(e){null!==e.getAttribute("data-ydntxt-item")&&n.push(e)}),0<n.length)return!0;e=e.getElementsByTagName("a");return a.default.forEach(e,function(e){null!==e.href.match(/https?:\/\/rd\.ane\.yahoo\.co\.jp\//)&&n.push(e)}),0<n.length}},{key:"getCenterPoints",value:function(){var e,t=s.default.getBoundingClientRectAsRect(this.rawElement,0,0);this.trimmedRect&&((e=this.trimmedRect.copy()).transfer(t.left,t.top),t=e);var n=[];t.height%2==0?(n.push(t.height/2),n.push(t.height/2-1)):n.push(Math.floor(t.height/2));var i=[];t.width%2==0?(i.push(t.width/2),i.push(t.width/2-1)):i.push(Math.floor(t.width/2));for(var r=[],a=0;a<i.length;++a)for(var o=0;o<n.length;++o)r.push({left:t.left+i[a],top:t.top+n[o]});return r=4===r.length?[r[0],r[3]]:r}},{key:"hasNoObstruction",value:function(){if(this.options.viewableMethod&&"getBoundingClientRect"!==this.options.viewableMethod)return!0;if(!0===this.isNoObstruction)return!0;for(var e=this.getCenterPoints(),t=0;t<e.length;++t)if(this.hasNoObstructionAt(e[t].left,e[t].top))return!0;return!1}},{key:"hasNoObstructionAt",value:function(e,t){var n=this,t=window.top.document.elementFromPoint(e,t);if(null===t)return!1;if("iframe"===t.nodeName.toLowerCase())return this.isAdIframe(t);for(var i=function(e){if(e!==n.rawElement)return!1;if(null!==e.getAttribute("data-ydntxt-item")||e.getAttribute("data-rma-viewable"))return!0;e=e.getAttribute("href");return!(!e||null===e.match(/https?:\/\/rd\.ane\.yahoo\.co\.jp\//))},r=t;null!==r&&r.parentNode;){if(i(r))return!0;r=r.parentNode}for(var a=[{element:t,level:0}];0<a.length;){var o=a.shift();if(!(3<o.level)){if(i(o.element))return!0;for(var s=0;s<o.element.children.length;s++)a.push({element:o.element.children[s],level:o.level+1})}}return!1}},{key:"checkVisibility",value:function(){return"hidden"===window.getComputedStyle(this.rawElement).visibility||document.hidden?(this.lastViewedIn=!1,this.detector.debugLog(this.tagId,{msg:"Target.checkVisibility(), false",target:this}),!1):(this.detector.debugLog(this.tagId,{msg:"Target.checkVisibility(), true",target:this}),!0)}},{key:"check",value:function(e,t){var n,i;this.detector.debugLog(this.tagId,{msg:"Target.check(), enter",target:this}),null!==this.position.trimmedRect&&(n=this.position.trimmedRect.width*this.position.trimmedRect.height,!s.default.isIframeCrossDomain(this.rawElement)&&0==n&&this.resizeCheckCount<5&&(n=this.rawElement.contentDocument||this.rawElement.contentWindow.document,1<=(n=s.default.getAdElements(n.body)).length&&(this.trimmedRect=s.default.getElementRect(n[0]),this.position.trimmedRect=this.trimmedRect),this.resizeCheckCount++)),"IntersectionObserver"===this.options.viewableMethod?(i=this.checkVisibility()&&this.rawElement.dataset.ydnintersectionratio&&this.rawElement.dataset.ydnintersectionratio>=this.VIEWED_AREA_CONDITION,this.detector.debugLog(this.tagId,{msg:"Target.check(), ydnintersectionratio: ".concat(this.rawElement.dataset.ydnintersectionratio)})):"elementFromPoint"===this.options.viewableMethod?i=this.checkVisibility()&&this.checkEfpFunction():(i=(t=this.checkVisibility()?this.calcViewableArea(t):0)>=this.VIEWED_AREA_CONDITION&&this.hasNoObstruction(),this.detector.debugLog(this.tagId,{msg:"Target.check(), viewableArea: ".concat(t)})),this.detector.debugLog(this.tagId,{msg:"Target.check(), nowViewdIn: ".concat(i)}),this.lastViewedIn&&i?this.handleViewContinue():this.lastViewedIn&&!i?this.handleViewOut(e):!this.lastViewedIn&&i&&this.handleViewIn(e),this.detector.debugLog(this.tagId,{msg:"Target.check(), leave"})}},{key:"handleViewIn",value:function(e){this.lastViewedIn=!0,this.lastViewedStart=e,this.currentViewedTime=0,this.viewInTimes.push(this.lastViewedStart)}},{key:"handleViewContinue",value:function(){this.currentViewedTime=r.default.getMaster().getElapsedTime()-this.lastViewedStart,this.currentViewedTime>=this.VIEWED_TIME_CONDITION&&(this.detector.debugLog(this.tagId,{msg:"Target.handleViewContinue(), viewed enough"}),this.viewedEnoughTime=!0)}},{key:"handleViewOut",value:function(e){this.currentViewedTime=e-this.lastViewedStart,this.currentViewedTime>=this.VIEWED_TIME_CONDITION&&(this.detector.debugLog(this.tagId,{msg:"Target.handleViewOut(), viewed enough"}),this.viewedEnoughTime=!0),this.viewOutTimes.push(e),this.lastViewedIn=!1,this.lastViewedStart=0,this.currentViewedTime=0}},{key:"updateRect",value:function(e){e&&(this.trimmedRect=e,this.position.trimmedRect=e)}}],i(o.prototype,n),o);function o(e,t){!function(e){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this),this.VIEWED_TIME_CONDITION=1e3,this.VIEWED_AREA_CONDITION=.5,this.rawElement=e,this.trimmedRect=t&&t.trimmedRect?t.trimmedRect:null,this.zeroSizeViewableMode=t&&t.zeroSizeViewableMode;e={zeroSizeViewableMode:this.zeroSizeViewableMode};this.position=new s.ElementPosition(this.rawElement,this.trimmedRect,e),this.layoutPosition=this.position.getLayoutPosition(),this.lastViewedIn=!1,this.lastViewedStart=0,this.currentViewedTime=0,this.viewedEnoughTime=!1,this.notifiedOnce=!1,this.resizeCheckCount=0,this.viewInTimes=[],this.viewOutTimes=[],this.options=t,this.tagId=t.tagId,this.requestId=t.requestId,this.rank=t.rank,this.viewableInfo=t.viewableInfo,this.viewableTrackingUrlList=t.viewableTrackingUrlList,this.exclusiveId=t.exclusiveId,this.query=t.query||{},this.detector=t.detector,this.rawElement&&this.rawElement.getAttribute("data-ydnnoad")&&(this.isNoObstruction=!0)}t.default=n},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(n);return e=i?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.BeaconQuery=t.BeaconQueryTemplate=t.ArrayBeaconData=t.StringBeaconData=t.BeaconDataBase=void 0;var h=n(0),d=(c(f,[{key:"incrementSize",value:function(e){this.dataSize+=e,this.parent&&this.parent.incrementSize(e)}},{key:"decrementSize",value:function(e){this.dataSize-=e,this.parent&&this.parent.decrementSize(e)}},{key:"getDataSize",value:function(){return this.dataSize}},{key:"exports",value:function(){}}]),f);function f(){l(this,f),this.dataSize=0,this.parent=null}t.BeaconDataBase=d;var g=function(){a(r,d);var i=o(r);function r(e,t){var n;return l(this,r),(n=i.call(this)).value=(t?String:encodeURIComponent)(e),n.incrementSize(n.value.length),n}return c(r,[{key:"exports",value:function(){return this.value}}]),r}();function p(e){return e instanceof d?e:h.default.isString(e)||h.default.isNumber(e)?new g(e.toString(),void 0):null}t.StringBeaconData=g;n=function(){a(i,d);var n=o(i);function i(e){var t;return l(this,i),(t=n.call(this)).sep=encodeURIComponent(e),t.children=[],t}return c(i,[{key:"exports",value:function(){return h.default.map(this.children,function(e){return e.exports()},this).join(this.sep)}},{key:"push",value:function(e){e=p(e);0<this.children.length&&this.incrementSize(this.sep.length),this.incrementSize(e.dataSize),this.children.push(e),e.parent=this}},{key:"clear",value:function(){this.children=[],this.dataSize=0}}]),i}();t.ArrayBeaconData=n;c(m,[{key:"getInstance",value:function(){return new v(this)}},{key:"isDefinedVar",value:function(e){return this.definition[e]&&"var"===this.definition[e].type}},{key:"getStaticValueSize",value:function(){return this.staticValueSize}},{key:"setLazyStaticValue",value:function(e,t){e=this.definition[e];e._encodedValue&&(this.staticValueSize-=e._encodedKey.length,--this.staticValueSize,this.staticValueSize-=e._encodedValue.length,e._encodedValue=null,--this.staticValueNums,0!==this.staticValueNums&&--this.staticValueSize),t&&(e._encodedValue=encodeURIComponent(t),this.staticValueSize+=e._encodedKey.length,this.staticValueSize+=1,this.staticValueSize+=e._encodedValue.length,0<this.staticValueNums&&(this.staticValueSize+=1),this.staticValueNums++)}}]),n=m;function m(e,t){l(this,m),this.options=t||{},this.definition={},this.exportOrder=[],this.staticValueNums=0,this.staticValueSize=0,h.default.forEach(e,function(e){e._encodedKey=encodeURIComponent(e.key),"static"===e.type&&(e._encodedValue=encodeURIComponent(e.value),this.staticValueSize+=e._encodedKey.length,this.staticValueSize+=1,this.staticValueSize+=e._encodedValue.length,0<this.staticValueNums&&(this.staticValueSize+=1),this.staticValueNums++),this.definition[e.name]=e,this.exportOrder.push(e.name)},this)}t.BeaconQueryTemplate=n;var v=(c(y,[{key:"bind",value:function(e,t){t=t instanceof d||!(2<arguments.length&&void 0!==arguments[2]&&arguments[2])?p(t):new g(t,!0);this.template.isDefinedVar(e)&&(this.vars[e]=t)}},{key:"exports",value:function(){var n="";return h.default.forEach(this.template.exportOrder,function(e){var t=this.template.definition[e];"static"===t.type&&(0<n.length&&(n+="&"),n+=t._encodedKey+"="+t._encodedValue),"lazy-static"===t.type?t._encodedValue&&(0<n.length&&(n+="&"),n+=t._encodedKey+"="+t._encodedValue):"random"===t.type?(0<n.length&&(n+="&"),n+=t._encodedKey+"="+h.default.makeRandomString()):"var"===t.type&&this.vars[e]&&(0<n.length&&(n+="&"),n+=t._encodedKey+"="+this.vars[e].exports())},this),n}}]),y);function y(e){l(this,y),this.template=e,this.vars={}}t.BeaconQuery=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),r=n(8),o=n(18),s=n(19);!function(){try{window.top.document,e=window.top}catch(t){e=window}e.YJ_UADF||(e.YJ_UADF={});var e,n,a,t=e.YJ_UADF;t&&t.YADSViewable&&t.YADSViewable.initialized||(e=new s.default,n=new r.default(e),a=new o.default(n),t.YADSViewable={initialized:!0,notifyRendered:function(e){a.notifyRendered(e)},notifyStreamAttached:function(e,t,n){a.notifyStreamAttached(e,t,n)},notifyTimelineAttached:function(e,t,n,i,r){a.notifyTimelineAttached(e,t,n,i,r)},markAdsForDebug:function(e){a.markAdsForDebug(e)},toggleDsDisplayForDebug:function(){a.toggleDsDisplayForDebug()},enableDebugLog:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];n.enableDebugLog(e),t&&i.default.getMaster().get("eventManager").enableDebugLog()}})}()},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0});var r=(i(a.prototype,[{key:"getElapsedTime",value:function(){return(new Date).getTime()-this.baseTime}},{key:"getAutoIncrementedKey",value:function(){return++this.incrementedKey}},{key:"set",value:function(e,t){this.data[e]=t}},{key:"get",value:function(e){return this.data[e]}}]),a);function a(e){!function(e){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this),this.baseTime=e,this.incrementedKey=0,this.data={}}t.default=r},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(n);return e=i?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.Action=t.PollingManager=void 0;var h=n(0),d=n(1),f=(c(g,[{key:"start",value:function(){var e=this,t=d.default.getTopWindow();this.timer=t.setInterval(function(){e.poll()},this.pollInterval)}},{key:"stop",value:function(){d.default.getTopWindow().clearInterval(this.timer),this.timer=null}},{key:"poll",value:function(){var i=(new Date).getTime();h.default.forEach(this.targets,function(e){var t,n;!e.active||(t=i-e.lastFiredAt)>=e.interval&&(n=i-this.manager.baseTime,this.manager.debugLog({msg:"PollingManager.poll, elapsedTime: ".concat(n,", interval: ").concat(t,", lastFiredAt: ").concat(e.lastFiredAt)}),e.method.call(e.context,"Polling",{}),e.lastFiredAt=i)},this)}},{key:"registerHandler",value:function(e,t,n){t={active:!1,interval:e,context:t,method:n,lastFiredAt:(new Date).getTime(),lazyCounter:0},n=this.targets.length;return this.targets.push(t),n}},{key:"activateHandler",value:function(e){this.targets[e].active=!0,0===this.activeNums&&this.start(),this.activeNums++}},{key:"deactivateHandler",value:function(e){this.targets[e].active=!1,this.activeNums--,0===this.activeNums&&this.stop()}}]),g);function g(e,t){l(this,g),this.manager=e,this.pollInterval=t,this.targets=[],this.timer=null,this.activeNums=0}t.PollingManager=f;var p=(c(m,[{key:"registerHandlers",value:function(){h.default.forEach(this.events,function(e){var t=this.manager.getEvent(e),e=t.registerHandler(this,this.fire);this.eventKeys.push({event:t,key:e})},this),0<=this.polling&&(this.pollingKey=this.manager.poller.registerHandler(this.polling,this,this.fire)),this.activate()}},{key:"activate",value:function(){h.default.forEach(this.eventKeys,function(e){e.event.activateHandler(e.key)},this),0<=this.pollingKey&&this.manager.poller.activateHandler(this.pollingKey)}},{key:"deactivate",value:function(){h.default.forEach(this.eventKeys,function(e){e.event.deactivateHandler(e.key)},this),0<=this.pollingKey&&this.manager.poller.deactivateHandler(this.pollingKey)}},{key:"fire",value:function(e,t){var n=(new Date).getTime(),i=!1;(i=0===this.minInterval||0===this.lastFiredAt||n-this.lastFiredAt>this.minInterval||i)&&(t=t||{},n=(this.lastFiredAt=n)-this.manager.baseTime,this.method.call(this.context,n,e,t))}}]),m);function m(e,t){l(this,m),this.manager=e,this.context=t.context,this.method=t.method,this.name=t.name||this.method.name||"UNNAMED",this.events=t.events||[],this.polling=t.polling||-1,this.minInterval=t.minInterval||0,this.lastFiredAt=0,this.eventKeys=[],this.pollingKey=-1,this.registerHandlers()}t.Action=p;c(v,[{key:"newAction",value:function(e){return new p(this,e)}},{key:"getEvent",value:function(e){if(this.events[e])return this.events[e];if(!k[e])return null;var t=new k[e](this);return this.events[e]=t}},{key:"enableDebugLog",value:function(){var i=console;this.debugLog=function(e,t){var n={time:Date.now()};i.debug(Object.assign(n,e))}}}]),n=v;function v(e){l(this,v),this.baseTime=e,this.poller=new f(this,50),this.events={},this.debugLog=function(){}}function y(e,t,n,i){e.addEventListener?e.addEventListener(t,n,i):e.attachEvent&&e.attachEvent("on"+t,n)}function b(e,t,n,i){e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent&&e.detachEvent("on"+t,n)}var w=(c(I,[{key:"registerHandler",value:function(e,t){var n=this.handlers.length;return this.handlers.push({active:!1,context:e,method:t}),n}},{key:"activateHandler",value:function(e){this.handlers[e].active=!0,0===this.activeNums&&this.setup(),this.activeNums++}},{key:"deactivateHandler",value:function(e){this.handlers[e].active=!1,this.activeNums--,0===this.activeNums&&this.cleanup()}},{key:"setup",value:function(){}},{key:"fire",value:function(t){this.manager.debugLog({msg:"MetaEvent.fire, eventName: ".concat(this.eventName),eventData:t}),h.default.forEach(this.handlers,function(e){e.active&&e.method.call(e.context,this.eventName,t)},this)}},{key:"cleanup",value:function(){}}]),I),k={onLoad:function(){i(n,w);var t=o(n);function n(e){return l(this,n),(e=t.call(this,e)).eventName="onLoad",e}return c(n,[{key:"setup",value:function(){var t=this,e=d.default.getTopWindow();this.boundHandler=function(e){t.fire({nativeEvent:e})},y(e,"load",this.boundHandler,!1)}},{key:"cleanup",value:function(){b(d.default.getTopWindow(),"load",this.boundHandler,!1)}}]),n}(),viewPosChange:function(){i(n,w);var t=o(n);function n(e){return l(this,n),(e=t.call(this,e)).eventName="viewPosChange",e.changeThreshold=50,e}return c(n,[{key:"setup",value:function(){var t=this,e=d.default.getTopWindow();this.nativeWrapper=function(e){t.nativeHandler({nativeEvent:e})},y(e,"scroll",this.nativeWrapper,!1),y(e,"touchmove",this.nativeWrapper,!1)}},{key:"fireManually",value:function(){var e={nativeEvent:{},rect:{}};e.rect=d.default.getViewedRect(),this.fire(e)}},{key:"nativeHandler",value:function(e){var t=d.default.getViewedRect();e.rect=t,(!this.lastViewedRect||t.width!==this.lastViewedRect.width||t.height!==this.lastViewedRect.height||Math.abs(t.top-this.lastViewedRect.top)>=this.changeThreshold||Math.abs(t.left-this.lastViewedRect.left)>=this.changeThreshold)&&(this.fire(e),this.lastViewedRect=t)}},{key:"cleanup",value:function(){var e=d.default.getTopWindow();b(e,"scroll",this.nativeWrapper,!1),b(e,"touchmove",this.nativeWrapper,!1)}}]),n}()};function I(e){l(this,I),this.manager=e,this.eventName="",this.handlers=[],this.activeNums=0}t.default={EventManager:n,MetaEvent:w,MetaEventDefinition:k}},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0});var l=n(2),f=n(0),g=n(1),r=n(4),a=n(3),o=n(9),u=n(10),c=n(11),s=n(12),h=n(14),n=(n=[{key:"registerAllActions",value:function(){f.default.forEachHash(this.actions,function(e,t){t=this.registerAction(e,t);this.actions[e]._registered=t},this)}},{key:"registerAction",value:function(e,t){t={context:this,method:this[e],name:e,events:t.events,polling:t.polling,minInterval:t.minInterval};return l.default.getMaster().get("eventManager").newAction(t)}},{key:"isCollectedElem",value:function(e){if(e.__uadfCollectedBy)for(var t=e.__uadfCollectedBy,n=0;n<t.length;n++)if(t[n]===this.serialNumber)return!0;return!1}},{key:"setAsCollected",value:function(e){e.__uadfCollectedBy||(e.__uadfCollectedBy=[]),e.__uadfCollectedBy.push(this.serialNumber)}},{key:"registerTarget",value:function(e,t){if(!this.isCollectedElem(e)||t&&t.canDuplicate){(t=t||{}).bucketManager=this.bucketManager,t.detector=this;var n=new a.default(e,t);return this.targets.push(n),this.setAsCollected(e),this.targetVisualizer.setDebugStyle(n),"IntersectionObserver"===t.viewableMethod&&this.iobserver.observe(e),n}return null}},{key:"checkViewableState",value:function(t,e,n){this.debugLog("any",{msg:"Detector.checkViewableState, eventName: ".concat(e,", targetNum: ").concat(this.targets.length,", elapsedTime: ").concat(t),eventData:n});var i=n.rect||g.default.getViewedRect();f.default.forEach(this.targets,function(e){e.check(t,i)},this),this.sendViewableBeacon(t),f.default.forEach(this.frameNotifyingTargets,function(e){e.check(t,i)},this)}},{key:"_isSessionStorageAvailable",value:function(){try{return window.sessionStorage&&window.sessionStorage.getItem&&window.sessionStorage.setItem}catch(e){return!1}}},{key:"_storeSentViewableInfo",value:function(e,t){if(this._isSessionStorageAvailable()&&t){var n="";if(f.default.isArray(t))f.default.forEach(t,function(e){n+=e.slice(0,64)+","}),n=n.slice(0,-1);else{if("string"!=typeof t)return;n=t.slice(0,64)}t=window.sessionStorage.getItem(e)||"",t=t?"".concat(t,",").concat(n):n;window.sessionStorage.setItem(e,t)}}},{key:"_isAlreadySent",value:function(e,t){if(!this._isSessionStorageAvailable())return!1;e=window.sessionStorage.getItem(e)||"",t=t.slice(0,64);return-1!==e.indexOf(t)}},{key:"_sendMeasurableBeacon",value:function(e,r,a){var t,n,i,o,s=this;!this.beaconSenderForMeasurableBeacon.beaconAllowed||!e||(t=(t=function n(e){return e.reduce(function(e,t){return Array.isArray(t)?e.concat(n(t)):e.concat(t)},[])}(t="string"==typeof e?[e]:e)).filter(function(e){return!s._isAlreadySent("measurable",e)})).length<=0||(this._storeSentViewableInfo("measurable",t),e=navigator.userAgent,n=e.match(/MSIE/)||e.match(/Trident/)?11<=parseInt(e.match(/(MSIE\s|rv:)([\d.]+)/)[2])?5e3:1500:8e3,i=function(e,t,n,i){e=e.getInstance();e.bind("beaconType","5"),e.bind("seqNum",t),e.bind("elapsedTime",l.default.getMaster().getElapsedTime()),e.bind("measurable",r),e.bind("reportData",o.data);e=e.exports();n.sendString(e),i.isSamplingBeaconTarget(a)&&(i=s.bucketManager.getBucketName(a),i=s.bucketManager.getSamplingBeaconData(a,i),h.default(a,e,i))},o=new c.ReportBeaconData,f.default.forEach(t,function(e){"non_ydn"!==e&&(0<o.getDataSize()&&o.getDataSize()+e.length>=n&&(i(this.viewedQueryTmpl,++this.beaconNum,this.beaconSenderForMeasurableBeacon,this.bucketManager),o=new c.ReportBeaconData),o.push(e))},this),0<o.getDataSize()&&i(this.viewedQueryTmpl,++this.beaconNum,this.beaconSenderForMeasurableBeacon,this.bucketManager))}},{key:"sendMeasurableBeacon",value:function(e,t){this._sendMeasurableBeacon(e,"1",t)}},{key:"sendNonMeasurableBeacon",value:function(e,t){this._sendMeasurableBeacon(e,"0",t)}},{key:"registerTargetProxyForStream",value:function(i,r,e,a){var t,o=i.split("-")[0];this.targetProxies[o]=null!==(t=this.targetProxies[o])&&void 0!==t?t:[],f.default.forEach(e,function(e,t){var n=a&&a[t]||[],n=new u.TargetProxy(i,r,t+1,e,n);this.targetProxies[o].push(n)},this),this.procStreamAttachedMessage(o)}},{key:"notifyStreamAttached",value:function(e,t){this.streamAttachedMessageStack.push([e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0]),this.procStreamAttachedMessage(e)}},{key:"procStreamAttachedMessage",value:function(e){if(this.targetProxies[e]){for(var t=[];0<this.streamAttachedMessageStack.length;){var n=this.streamAttachedMessageStack.shift();n[0]===e?this.registerDummyTargetForStream(n[0],n[1],n[2]):t.push(n)}this.streamAttachedMessageStack=t}}},{key:"registerDummyTargetForStream",value:function(i,e,r){e=g.default.getTopWindow().document.getElementById(e);if(e){var t,e=Array.prototype.slice.apply(e.querySelectorAll(".yads_stream [data-ydntxt-item]"));for(t in this.pendingCollectingTextAdsIn)Object.prototype.hasOwnProperty.call(this.pendingCollectingTextAdsIn,t)&&(0,this.pendingCollectingTextAdsIn[t])();f.default.forEach(e,function(e,t){var n;this.isCollectedElem(e)||((n=t-r)<0||(n=this.targetProxies[i][n])&&(n=new u.DummyTarget(e,{rank:t+1,proxy:n,bucketManager:this.bucketManager,detector:this}),this.targets.push(n),this.targetVisualizer.setDebugStyle(n),this.setAsCollected(e)))},this)}}},{key:"registerTargetProxyForTimeline",value:function(e,t,n,i,r,a){if(!this.timelineTargetProxies[e]){this.timelineTargetProxies[e]=[];for(var o=r||[],s=0;s<t;s++){var l=a&&a[s]||[],l=new u.TargetProxy(n,i,s+1,o[s],l);this.timelineTargetProxies[e][s]=l}this.procTimelineAttachedMessage(e)}}},{key:"notifyTimelineAttached",value:function(e,t,n,i,r){this.timelineAttachedMessageStack.push([e,t,n,i,r]),this.procTimelineAttachedMessage(e)}},{key:"procTimelineAttachedMessage",value:function(e){var t=this.timelineTargetProxies[e];if(t){for(var n=[];0<this.timelineAttachedMessageStack.length;){var i=this.timelineAttachedMessageStack.shift();if(i[0]===e){var r=i[3],a=i[4],o=t[r-1];if(!o)return;o=new u.DummyTarget(a,{rank:r,proxy:o,bucketManager:this.bucketManager,detector:this});this.targets.push(o),this.targetVisualizer.setDebugStyle(o),this.setAsCollected(a)}else n.push(i)}this.timelineAttachedMessageStack=n}}},{key:"collectRichAdsIn",value:function(t,n,a,o,s){function e(t){function e(){try{--n<=0&&c.clearInterval(r);var e=u.getRichAds(t);if(0===e.length)return;var i=0;f.default.forEach(e,function(e){var t=o&&o[i]||null,n=s&&s[i]||[];u.registerTarget(e,{tagId:a,exclusiveId:a,viewableInfo:t,query:u.getRichAdsQuery(e),viewableTrackingUrlList:n}),i++},u),c.clearInterval(r)}catch(e){}}var n=1800,r=null,r=c.setInterval(e,100);e()}var i,r,l,u=this,c=g.default.getTopWindow(),h=t.getElementById(n);function d(){try{--r<=0&&c.clearInterval(l);var e=t.getElementById(n);e&&(c.clearInterval(l),i(e))}catch(e){}}h?e(h):(i=e,r=30,l=null,l=c.setInterval(d,100),d())}},{key:"getRichAds",value:function(e){var t=[];return f.default.forEach(e.getElementsByTagName("*"),function(e){null!==e.getAttribute("data-rma-viewable")&&t.push(e)}),t}},{key:"getRichAdsQuery",value:function(e){return e?{getMainshrink:function(){return e.getAttribute("data-rma-mainshrink")},getSidehide:function(){return e.getAttribute("data-rma-sidehide")}}:{getMainshrink:function(){return null},getSidehide:function(){return null}}}},{key:"collectTextAdsIn",value:function(t,r,a,o,s,l){function e(){try{--n<=0&&(delete u.pendingCollectingTextAdsIn[i],h.clearInterval(i));var e=g.default.getAdElements(t);if(0===e.length)return;f.default.forEach(e,function(e){a in u.requestIdTable||(u.requestIdTable[a]=0);var t=++u.requestIdTable[a],n=o&&o[c]||null,i=l&&l[c]||[];u.registerTarget(e,{tagId:r,requestId:a,rank:t,viewableInfo:n,viewableMethod:s,viewableTrackingUrlList:i}),c++},u),delete u.pendingCollectingTextAdsIn[i],h.clearInterval(i)}catch(e){}}var u=this,c=0,n=1800,i=null,h=g.default.getTopWindow(),i=h.setInterval(e,100);(this.pendingCollectingTextAdsIn[i]=e)()}},{key:"getBeaconDataForTarget",value:function(e){return e.viewableInfo}},{key:"sendViewThroughConversionBeacon",value:function(e){e&&e.viewableTrackingUrlList&&f.default.forEach(e.viewableTrackingUrlList,function(e){window.navigator.sendBeacon&&window.navigator.sendBeacon(e)||(document.createElement("img").src=e)})}},{key:"sendViewableBeacon",value:function(i){var r;this.beaconSenderForViewableBeacon.beaconAllowed&&(r=[],f.default.forEach(this.targets,function(e){var t,n,i;e.isBeaconedTarget()&&-1===this.alreadySentBeacon.indexOf(e.exclusiveId)&&(this.targetVisualizer.setDebugStyle(e),(t=this.getBeaconDataForTarget(e))&&!this._isAlreadySent("viewable",t)&&(e.exclusiveId&&this.alreadySentBeacon.push(e.exclusiveId),n=null,e.query&&e.query.getMainshrink&&(n=e.query.getMainshrink()),i=null,e.query&&e.query.getSidehide&&(i=e.query.getSidehide()),e.setAsNotified(),r.push({viewableInfo:t,mainshrink:n,sidehide:i,target:e}),this._storeSentViewableInfo("viewable",t)))},this),0<r.length&&f.default.forEach(r,function(e){var t,n;"non_ydn"!==e.viewableInfo&&((t=new c.ReportBeaconData).push(e.viewableInfo),(n=this.viewedQueryTmpl.getInstance()).bind("reportData",t.data),n.bind("beaconType","2"),n.bind("seqNum",++this.beaconNum),n.bind("elapsedTime",i),e.mainshrink&&n.bind("mainshrink",e.mainshrink),e.sidehide&&n.bind("sidehide",e.sidehide),t=n.exports(),this.beaconSenderForViewableBeacon.sendString(t),this.sendViewThroughConversionBeacon(e.target),this.bucketManager.isSamplingBeaconTarget(e.target.tagId)&&(n=this.bucketManager.getBucketName(e.target.tagId),n=this.bucketManager.getSamplingBeaconData(e.target.tagId,n,e.target),h.default(e.target.tagId,t,n)))},this))}},{key:"registerFrameNotifyingTargets",value:function(e,t){this.frameNotifyingTargets.push(new o.default(t,{tagId:e,bucketManager:this.bucketManager,detector:this}))}},{key:"markAdsForDebug",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0;this.targetVisualizer.enable(),this.targetVisualizer.setIsDsDisplay(e),f.default.forEach(this.targets,function(e){t.targetVisualizer.setDebugStyle(e)})}},{key:"toggleDsDisplayForDebug",value:function(){var t=this;f.default.forEach(this.targets,function(e){t.targetVisualizer.toggleDsDisplay(e)})}},{key:"updateTargetRect",value:function(t,n){f.default.forEach(this.targets,function(e){e.viewableInfo===n&&e.updateRect(t)},this),l.default.getMaster().get("eventManager").getEvent("viewPosChange").fireManually()}},{key:"iObserverCallback",value:function(e){f.default.forEach(e,function(e){e.target.dataset.ydnintersectionratio=e.intersectionRatio})}},{key:"enableDebugLog",value:function(e){var i="string"==typeof e?[e]:e,r=console;this.debugLog=function(t,e){var n;"any"!==t&&!i.some(function(e){return 0==t.indexOf(e)})||(n={adprodset:t,time:Date.now()},r.debug(Object.assign(n,e)))}}}],i(d.prototype,n),d);function d(e){!function(e){if(!(e instanceof d))throw new TypeError("Cannot call a class as a function")}(this),this.actions={checkViewableState:{events:["onLoad","viewPosChange"],polling:95,minInterval:95}};var t=[{name:"rs",type:"static",key:"rs",value:"yads_vb"},{name:"beaconType",type:"var",key:"bt"},{name:"pvRandom",type:"lazy-static",key:"pv"},{name:"beaconRandom",type:"random",key:"rand"},{name:"seqNum",type:"var",key:"seq"},{name:"elapsedTime",type:"var",key:"et"},{name:"retryNum",type:"var",key:"rn"},{name:"mainshrink",type:"var",key:"mainshrink"},{name:"sidehide",type:"var",key:"sidehide"},{name:"reportData",type:"var",key:"vi"},{name:"measurable",type:"var",key:"measurable"}];this.targetVisualizer=e,this.serialNumber=100,this.registerAllActions(),this.targets=[],this.viewedQueryTmpl=new r.BeaconQueryTemplate(t,{}),this.requestIdTable={},this.targetProxies={},this.streamAttachedMessageStack=[],this.timelineTargetProxies={},this.timelineAttachedMessageStack=[],this.frameNotifyingTargets=[],this.pendingCollectingTextAdsIn={},this.alreadySentBeacon=[],this.beaconNum=0,this.beaconSenderForViewableBeacon=new c.BeaconSender({uri:"https://b94.yahoo.co.jp/v",requestType:"sendbeacon"}),this.beaconSenderForMeasurableBeacon=new c.BeaconSender({uri:"https://b94.yahoo.co.jp/m",requestType:"sendbeacon"}),this.pvRandom=f.default.makeRandomString(),this.viewedQueryTmpl.setLazyStaticValue("pvRandom",this.pvRandom),this.messageQueryTmpl=new r.BeaconQueryTemplate(t,{}),"IntersectionObserver"in window&&(this.iobserver=new IntersectionObserver(this.iObserverCallback,{threshold:function(){for(var e=[0],t=1;t<=100;t++)e.push(t/100);return e}()})),this.bucketManager=new s.default(Math.random()),this.debugLog=function(){}}t.default=n},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(n);return e=i?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?u(t):e}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0});var h=n(3),n=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(r,h.default);var e,i=l(r);function r(e,t){var n;return function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this),(n=i.call(this,e,t)).tagId=t.tagId,n.sendNumViewIn=0,n.sendNumViewable=0,n.sendNumViewOut=0,h.default.call(u(n),e,t),n}return e=[{key:"sendNotification",value:function(e,t,n){var i=this.rawElement.contentWindow;i&&i.postMessage&&i.postMessage("vimpsMessage,"+t+","+n+","+e,"*")}},{key:"handleViewIn",value:function(e){o(c(r.prototype),"handleViewIn",this).call(this,e),this.sendNotification(e,"view-in",++this.sendNumViewIn)}},{key:"handleViewContinue",value:function(e){var t=this.viewedEnoughTime;o(c(r.prototype),"handleViewContinue",this).call(this,e),!t&&this.viewedEnoughTime&&this.sendNotification(e,"viewable",++this.sendNumViewable)}},{key:"handleViewOut",value:function(e){o(c(r.prototype),"handleViewOut",this).call(this,e),this.sendNotification(e,"view-out",++this.sendNumViewOut)}},{key:"sendAbortMessage",value:function(){var e=this.rawElement.contentWindow;e.postMessage&&e.postMessage("vimpsMessage,aborted","*")}}],a(r.prototype,e),r}();t.default=n},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(n);return e=i?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?s(t):e}}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.DummyTarget=t.TargetProxy=void 0;var h=n(3),n=(c(d,[{key:"setDummyTarget",value:function(e){this.targets.push(e)}}]),d);function d(e,t,n,i,r){u(this,d),this.tagId=e,this.requestId=t,this.rank=n,this.viewableInfo=i,this.viewableTrackingUrlList=r,this.targets=[]}t.TargetProxy=n;n=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(i,h.default);var n=o(i);function i(e,t){return u(this,i),t.tagId=t.proxy.tagId,t.requestId=t.proxy.requestId,t.viewableInfo=t.proxy.viewableInfo,t.viewableTrackingUrlList=t.proxy.viewableTrackingUrlList,(e=n.call(this,e,t)).proxy=t.proxy,e.proxy.setDummyTarget(s(e)),e}return c(i,[{key:"isBeaconedTarget",value:function(){return this.viewedEnoughTime&&!this.proxy.notifiedOnce}},{key:"setAsNotified",value:function(){this.proxy.notifiedOnce=!0}}]),i}();t.DummyTarget=n},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.ReportBeaconData=t.BeaconSender=void 0;var o=n(4),n=(a(s,[{key:"doRequest",value:function(e){var t=this.uri;0<e.length&&(t+="?"+e+"&EOQ"),"sendbeacon"===this.requestType&&window.navigator.sendBeacon&&window.navigator.sendBeacon(t)||(document.createElement("img").src=t)}},{key:"sendString",value:function(e){(1<arguments.length&&void 0!==arguments[1]&&arguments[1]||this.beaconAllowed)&&this.doRequest(e)}},{key:"setAllowed",value:function(){this.beaconAllowed=!0}},{key:"setDisallowed",value:function(){this.beaconAllowed=!1}},{key:"setUri",value:function(e){this.uri=e}}]),s);function s(e){i(this,s),this.uri=e.uri,this.requestType=e.requestType,this.beaconAllowed=!1}t.BeaconSender=n;a(l,[{key:"push",value:function(e){this.data.push(e)}},{key:"getDataSize",value:function(){return this.data.getDataSize()}}]),n=l;function l(){i(this,l),this.separator="&",this.data=new o.ArrayBeaconData(this.separator)}t.ReportBeaconData=n},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(13),n=(i(a.prototype,[{key:"getBucket",value:function(e){var t={name:"default",rate:1};if(!e)return t;e=e.split("-")[0];if(!this.config[e]||-1===this.selected[e])return t;t=this.selected[e];return this.config[e][t]}},{key:"getBucketName",value:function(e){return this.getBucket(e).name}},{key:"isFeatureEnabled",value:function(e,t){if(window.YJ_UADF&&window.YJ_UADF.bucketManager&&window.YJ_UADF.bucketManager.features&&window.YJ_UADF.bucketManager.features.some(function(e){return e.toLowerCase()===t.toLowerCase()}))return!0;e=this.getBucket(e);return!!e.features&&e.features.some(function(e){return e===t})}},{key:"isSamplingBeaconTarget",value:function(e){return!!this.getBucket(e).beacontarget}},{key:"getSamplingBeaconData",value:function(e,t,n){var i=this.getBucket(e);if(!i.beacondata)return"";try{return i.beacondata(t,n)}catch(e){return"error"}}}]),a);function a(t,n){var i=this;!function(e){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this),n=n||r.default,this.config=n,window.YJ_UADF&&window.YJ_UADF.bucketManager&&"number"==typeof window.YJ_UADF.bucketManager.selectValue&&(t=window.YJ_UADF.bucketManager.selectValue),this.selectValue=t,this.activeFeatures=[],this.selected={},Object.keys(n).forEach(function(e){i.selected[e]=function(e,t){for(var n=0,i=0;i<e.length;++i)if(0<=e[i].rate&&e[i].rate<1&&t<(n+=e[i].rate))return i;return-1}(n[e],t)})}t.default=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15);t.default=function(e,t,n){var i={tk:"b4db4bd2-193f-49c8-b029-1504f702baf5",p:"uadf",d:"sampling_beacon"};i.adprodset=e;t=r.parse(t);i.pv=t.pv,i.rand=t.rand,i.vi=t.vi.substring(0,10),"1"==t.measurable?i.type="m":"0"==t.measurable?i.type="nm":i.type="v",i.tm=(new Date).getTime(),i.aux=n,document.createElement("img").src="https://dsb.yahoo.co.jp/api/v1/clear.gif?"+r.stringify(i)}},function(e,t,n){"use strict";t.decode=t.parse=n(16),t.encode=t.stringify=n(17)},function(e,t,n){"use strict";e.exports=function(e,t,n,i){n=n||"=";var r={};if("string"!=typeof e||0===e.length)return r;var a=/\+/g;e=e.split(t=t||"&");t=1e3;i&&"number"==typeof i.maxKeys&&(t=i.maxKeys);var o=e.length;0<t&&t<o&&(o=t);for(var s=0;s<o;++s){var l,u=e[s].replace(a,"%20"),c=u.indexOf(n),c=0<=c?(l=u.substr(0,c),u.substr(c+1)):(l=u,""),u=decodeURIComponent(l),c=decodeURIComponent(c);Object.prototype.hasOwnProperty.call(r,u)?h(r[u])?r[u].push(c):r[u]=[r[u],c]:r[u]=c}return r};var h=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";function a(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}e.exports=function(n,i,r,e){return i=i||"&",r=r||"=","object"==typeof(n=null===n?void 0:n)?s(l(n),function(e){var t=encodeURIComponent(a(e))+r;return o(n[e])?s(n[e],function(e){return t+encodeURIComponent(a(e))}).join(i):t+encodeURIComponent(a(n[e]))}).join(i):e?encodeURIComponent(a(e))+r+encodeURIComponent(a(n)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function s(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var l=Object.keys||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n}},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0});var l=n(1),u=n(0),n=(n=[{key:"handleVImpsMode",value:function(e){return 0!==e}},{key:"notifyRendered",value:function(i){var r,e,t;i.viewableUrl&&this.detector.beaconSenderForViewableBeacon.setUri(i.viewableUrl),i.measurableUrl?(this.detector.beaconSenderForMeasurableBeacon.setUri(i.measurableUrl),this.detector.beaconSenderForMeasurableBeacon.setAllowed()):this.detector.beaconSenderForMeasurableBeacon.setDisallowed(),this.handleVImpsMode(i.vimpsMode)?(this.detector.beaconSenderForViewableBeacon.setAllowed(),r=l.default.getTopWindow(),"multi"===i.type?(t=i.parentIdList,u.default.forEach(t,function(e,t){var n=r.document.getElementById(e)||window.document.getElementById(e);(n=!n&&i.fif?i.fif.contentDocument.getElementById(e):n)&&(e=i.viewableInfoList&&i.viewableInfoList[t]||null,t=i.viewableTrackingUrlList&&i.viewableTrackingUrlList[t]||[],this.detector.collectTextAdsIn(n,i.adProdSetCode,i.requestId,e,i.viewableMethod,t))},this)):"single_with_parent"===i.type?(e=i.parentId,(t=!(t=r.document.getElementById(e)||window.document.getElementById(e))&&i.fif?i.fif.contentDocument.getElementById(e):t)&&this.detector.collectTextAdsIn(t,i.adProdSetCode,i.requestId,i.viewableInfo,i.viewableMethod,i.viewableTrackingUrlList)):"doc_write"===i.type?this.detector.collectTextAdsIn(i.docWriteCaller.parentNode,i.adProdSetCode,i.requestId,i.viewableInfo,i.viewableMethod,i.viewableTrackingUrlList):"stream"===i.type?i.viewableInfo&&this.detector.registerTargetProxyForStream(i.adProdSetCode,i.requestId,i.viewableInfo,i.viewableTrackingUrlList):"timeline"===i.type?this.detector.registerTargetProxyForTimeline(i.uniqueId,i.adNum,i.adProdSetCode,i.requestId,i.viewableInfo,i.viewableTrackingUrlList):"richad"===i.type&&u.default.forEach(i.parentIdList,function(e){this.detector.collectRichAdsIn(r.document,e,i.adProdSetCode,i.viewableInfo,i.viewableTrackingUrlList)},this),this.detector.sendMeasurableBeacon(i.viewableInfoList||i.viewableInfo,i.adProdSetCode)):this.detector.sendNonMeasurableBeacon(i.viewableInfoList||i.viewableInfo,i.adProdSetCode)}},{key:"notifyStreamAttached",value:function(e,t,n){this.detector.notifyStreamAttached(e,t,n)}},{key:"notifyTimelineAttached",value:function(e,t,n,i,r){this.detector.notifyTimelineAttached(e,t,n,i,r)}},{key:"messageEventHandlers",get:function(){return{frameStarted:{method:this.handleFrameStartedMessage},frameLoaded:{method:this.handleFrameLoadedMessage},frameScrolled:{method:this.handleFrameScrolledMessage},frameUpdateCallbackElement:{method:this.handleFrameUpdateCallbackElement}}}},{key:"setMessageEventHandler",value:function(){function e(e){t.handleMessageEvent(e)}var t=this,n=l.default.getTopWindow();n.addEventListener?n.addEventListener("message",e,!1):n.attachEvent("onmessage",e)}},{key:"handleMessageEvent",value:function(e){var t,n;("http://i.yimg.jp"===e.origin||"https://s.yimg.jp"===e.origin||/\.yahoo\.co\.jp(:[0-9]+)?$/.test(e.origin))&&u.default.isString(e.data)&&(n=(t=e.data.split(","))[0],(n=this.messageEventHandlers[n])&&n.method.call(this,t,e))}},{key:"detectMessagedFrame",value:function(i){var e=l.default.getTopWindow(),r=null;return l.default.traverseAllWindows(function(e){for(var t=e.document.getElementsByTagName("iframe"),n=0;n<t.length;n++)if(t[n].contentWindow===i)return r=t[n],!1;return!0},e),r}},{key:"handleFrameStartedMessage",value:function(e,t){var n;3===e.length&&(n=parseInt(e[1],10),isNaN(n)||!this.handleVImpsMode(n)||(t=this.detectMessagedFrame(t.source))&&(e=e[2],this.detector.registerFrameNotifyingTargets(e,t)))}},{key:"handleFrameLoadedMessage",value:function(e,t){var n,i,r,a,o,s=parseInt(e[1],10);isNaN(s)||(n=e[5],(i=e[6])&&this.detector.beaconSenderForViewableBeacon.setUri(i),n?(this.detector.beaconSenderForMeasurableBeacon.setUri(n),this.detector.beaconSenderForMeasurableBeacon.setAllowed()):this.detector.beaconSenderForMeasurableBeacon.setDisallowed(),r=e[2],this.handleVImpsMode(s)?(this.detector.beaconSenderForViewableBeacon.setAllowed(),(a=this.detectMessagedFrame(t.source))&&("non_ydn"!==(o=e[3])?0!==e[4].indexOf("ERR")&&(t=e[4].split("|"),u.default.forEach(t,function(e,t){var n,i=this.parseViewableInfo(e);i&&(n=i[0],e=i[1],i=i[2],n&&(i={canDuplicate:!0,tagId:r,requestId:o,rank:t+1,viewableInfo:n,viewableTrackingUrlList:i},e&&(i.trimmedRect=e),this.detector.registerTarget(a,i),this.detector.sendMeasurableBeacon(n,r)))},this)):this.detector.registerTarget(a,{tagId:r,requestId:o,rank:"1",viewableInfo:"non_ydn"}))):u.default.forEach(e[4].split("|"),function(e){e=this.parseViewableInfo(e);e&&(e=e[0],this.detector.sendNonMeasurableBeacon(e,r))},this))}},{key:"parseViewableInfo",value:function(e){var t=e.split("/");if(6<t.length)return null;var n=parseInt(t[0],10),i=parseInt(t[1],10),r=parseInt(t[2],10),a=parseInt(t[3],10);if(isNaN(n)||isNaN(i)||isNaN(r)||isNaN(a))return null;var o=t[4]&&0!==t[4].length?t[4]:null,s=[];if(t[5])try{s=JSON.parse(decodeURIComponent(t[5]))}catch(e){}return 0===n&&0===i&&0===r&&0===a?[o,null,s]:[o,new l.Rect({top:n,right:i,bottom:r,left:a}),s]}},{key:"markAdsForDebug",value:function(e){this.detector.markAdsForDebug(e)}},{key:"toggleDsDisplayForDebug",value:function(){this.detector.toggleDsDisplayForDebug()}},{key:"handleFrameScrolledMessage",value:function(e){e=e[4].split("|");u.default.forEach(e,function(e){var t=this.parseViewableInfo(e);t&&(e=t[0],t=t[1],this.detector.updateTargetRect(t,e))},this)}},{key:"handleFrameUpdateCallbackElement",value:function(e,t){var n=e[1].split("/");if(4===n.length){var i=parseInt(n[0],10),r=parseInt(n[1],10),e=parseInt(n[2],10),n=parseInt(n[3],10);if(!(isNaN(i)||isNaN(r)||isNaN(e)||isNaN(n))){var a=new l.Rect({top:i,right:r,bottom:e,left:n}),o=this.detectMessagedFrame(t.source);if(o)for(var s=0;s<this.detector.frameNotifyingTargets.length;s++)if(this.detector.frameNotifyingTargets[s].rawElement==o){this.detector.frameNotifyingTargets[s].updateRect(a);break}}}}}],i(r.prototype,n),r);function r(e){!function(e){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this),this.detector=e,this.setMessageEventHandler()}t.default=n},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0});var r=(i(a.prototype,[{key:"enable",value:function(){this.enabled=!0}},{key:"setIsDsDisplay",value:function(e){void 0!==e&&(this.isDsDisplay=e)}},{key:"setDebugStyle",value:function(e){var t,n,i,r=this;this.enabled&&(i=e.rawElement.getAttribute("data-rma-viewable"),t=/^https:\/\/m\.yahoo\.co\.jp\/.*/.test(location.href),n=e.rawElement,i=i||"A"===n.tagName&&(t||"relative"!==getComputedStyle(n.parentElement).position)?n.parentElement:n,e.viewedEnoughTime?i.style.outline="6px green outset":i.style.outline="6px red outset",i.style.outlineOffset="-3px",e.debugDsElement?e.debugDsElement.style.display=this.isDsDisplay?"block":"none":((t=document.createElement("div")).style.display=this.isDsDisplay?"block":"none",t.style.position="relative",t.style.left="0px",e.rawElement.parentElement.insertAdjacentElement("afterbegin",t),n=e.tagId.split("-")[0],(i=document.createElement("div")).textContent=n,i.dataset.uadfDsLabel=n,i.style.padding="3px",i.style.zIndex="999",i.style.color="#ffffff",i.style.fontSize="12px",i.style.lineHeight="12px",i.style.backgroundColor="#696969",i.style.position="absolute",i.style.top="0px",i.style.left="50%",i.style.transform="translate(-50%, 0)",t.appendChild(i),e.debugDsElement=t),window.requestAnimationFrame(function(){return r.displayCenterPoint(e)}))}},{key:"displayCenterPoint",value:function(e){var t,n=this,i=e.getCenterPoints()[0],r=e.viewedEnoughTime?"green":"red";e.debugCenterElement||((t=document.createElement("div")).style.width="5px",t.style.height="5px",t.style.zIndex="10000",t.style.backgroundColor=r,t.style.position="fixed",t.style.top=i.top+1+"px",t.style.left=i.left+1+"px",e.debugCenterElement=t,document.body.appendChild(t)),i.top<=0||i.left<=0?e.debugCenterElement.style.display="none":(e.debugCenterElement.style.display="block",e.debugCenterElement.style.backgroundColor=r,e.debugCenterElement.style.top=i.top+1+"px",e.debugCenterElement.style.left=i.left+1+"px"),window.requestAnimationFrame(function(){return n.displayCenterPoint(e)})}},{key:"toggleDsDisplay",value:function(e){e=e.debugDsElement;e&&("none"===getComputedStyle(e).display?(e.style.display="block",this.isDsDisplay=!0):(e.style.display="none",this.isDsDisplay=!1))}}]),a);function a(){!function(e){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this),this.enabled=!1,this.isDsDisplay=!1}t.default=r}]);
