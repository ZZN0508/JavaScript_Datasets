(this.$WP=this.$WP||[]).push(["fTyhRT",(e,r)=>{"use strict";var t,l,i,n,u,a,d,s,o,T,c,I,p=e=>{var[,r]=d(n),[l,i]=t.useState({fetching:!1}),u=o("SAVE_TO_TRIP"),a=t.useRef(!0),T=t.useCallback(e=>{a.current&&i(e)},[]);if(t.useEffect(()=>()=>{a.current=!1},[]),!e)return[l,()=>Promise.resolve([null,null])];var c=e;return[l,e=>(T({fetching:!0}),r({tripId:e,referenceId:""+c.id,referenceType:c.type,allowDuplicates:!1}).then(e=>{var r,t,l,i,n,a,d=null==e||null==(r=e.data)||null==(t=r.addItemToTrip)?void 0:t.trip,o=null==e||null==(l=e.data)||null==(i=l.addItemToTrip)||null==(n=i.errors)||null==(a=n[0])?void 0:a.error;if(d){var I=s(d,c);I?(u(),T({fetching:!1,result:{trip:d,tripItem:I}})):"bundleSave"===c.type?T({fetching:!1,result:{trip:d,tripItem:{__typename:"TripItem",id:0,comments:[]}}}):T({fetching:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:o}})}else T({fetching:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:o}});return[d,o]}).catch(e=>(console.error(e),T({fetching:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),[null,null])))]},v=(e,r,t)=>{var[n,u]=p(e),{userId:a}=l(c);return[n,i(()=>{var l=(e=>{var r=T.get("mostRecentlyAddedToTrip");return r&&r.userId===e?r.tripId:null})(a);return r||!l||I.has(null==e?void 0:e.type)?(t&&t(),Promise.resolve([null,null])):u(l)},[r,e,t,u,a]),e=>((e,r)=>{r?T.set("mostRecentlyAddedToTrip",{tripId:e,userId:r},144e5):T.remove("mostRecentlyAddedToTrip")})(e,a)]},f=(e,r,l)=>{var[i,n]=t.useState({fetching:!1,saved:!!l}),[,s]=d(u),[,o]=d(a);return[i,l?()=>l?(n(Object.assign({},i,{fetching:!0})),o({itemId:l.id,tripId:r}).then(e=>{var r,t=null==e||null==(r=e.data)?void 0:r.tripsRemoveItem;return t?(n({fetching:!1,saved:!1,result:{trip:t}}),i):(n({fetching:!1,saved:!0,error:{query:"REMOVE_TRIP_ITEM",tripsError:void 0}}),i)}).catch(()=>(n({fetching:!1,saved:!0,error:{query:"REMOVE_TRIP_ITEM"}}),i))):Promise.resolve(i):()=>(n(Object.assign({},i,{fetching:!0})),s({tripId:r,referenceId:""+e.id,referenceType:e.type,allowDuplicates:!1}).then(e=>{var r,t,l,u,a,d,s,o,T,c=null==e||null==(r=e.data)||null==(t=r.addItemToTrip)?void 0:t.trip,I=null==e||null==(l=e.data)||null==(u=l.addItemToTrip)||null==(a=u.errors)||null==(d=a[0])?void 0:d.error;if(I||!c)return n({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:I||void 0}}),i;var p=null==e||null==(s=e.data)||null==(o=s.addItemToTrip)||null==(T=o.items)?void 0:T[0];return n(p?{fetching:!1,saved:!0,result:{trip:c,tripItem:p}}:{fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),i}).catch(()=>(n({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),i)))]};return[()=>{I=new Set(["savesItem","bundleSave"]),e({useAutosave:v,useSave:p,useTripSaveToggle:f})},[e=>(t=e,l=e.useContext,i=e.useCallback),e=>(n=e.AddItemToTrip,u=e.AddItemWithFullTrip,a=e.RemoveItemWithFullTrip),e=>d=e.useMutation,e=>s=e.getItemByReference,e=>o=e.usePixelCallback,e=>T=e.default,e=>c=e.Visitor]]},["cDcdfi","RXx5aI","5X2em-","eFKnUp","jb_4W2","jaCyxS","2R4xv2"]]);