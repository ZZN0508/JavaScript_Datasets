define("lofty/lang/observer",function(){"use strict";var t={}.toString,r=function(r){return"[object Function]"===t.call(r)},e=Array.isArray||function(r){return"[object Array]"===t.call(r)},o=function(t){return"string"==typeof t},n=Array.prototype.slice,i=function(t,r){var o;if(e(t))for(;o=t.shift();)r(o);else r(t)},s=function(t,r,e,n){if(o(r)){var i=t[r]||(t[r]=[]);i.push({listener:e,context:n})}},c=function(t,r,e,n){var i,s;if(o(r)&&(i=t[r]))if(e||n)for(var c=0;c<i.length;)s=i[c],e&&s.listener===e||n&&s.context===n?i.splice(c,1):c++;else delete t[r]},u=function(t,r,e){var n,i;if(o(r)&&(n=t[r]))for(var s=0,c=n.length;c>s;s++)i=n[s],i.listener.apply(i.context||this._observer_context||this,e)},f=function(t){this._observer_context=t};f.prototype={attach:function(t,e,o){var n;return r(e)?(n=this._observer_group||(this._observer_group={}),i(t,function(t){s(n,t,e,o)}),this):this},detach:function(t,r,e){var o;return(o=this._observer_group)?t?(i(t,function(t){c(o,t,r,e)}),this):(delete this._observer_group,this):this},notify:function(t){var r,e,o;return(r=this._observer_group)?(e=n.call(arguments,1),o=this,i(t,function(t){u.call(o,r,t,e)}),this):this}},f.prototype.on=f.prototype.attach,f.prototype.off=f.prototype.detach,f.prototype.trigger=f.prototype.notify;var a=new f(window);return a.create=function(t){return new f(t)},a.mixTo=function(t){t=t||{};var r=f.prototype;for(var e in r)t[e]=r[e];return t},a});;