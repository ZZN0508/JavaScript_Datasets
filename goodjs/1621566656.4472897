define(["OK/utils/dom","OK/LogSeen","OK/utils/utils","OK/HookModel"],(function(t,e,a,n){function i(e,a,n){var i=t.firstByClass(e,"comments");if(i){var s=i.getAttribute("data-id"),o=i.getAttribute("data-type");s&&o&&require(["OK/DiscussionManager","jquery"],(function(t,i){t.forEachOpened(s,o,(function(){i.contains(e,this.element[0])&&this.focusForm(a,n)}))}))}}return{activate:function(s){s.hasAttribute("data-seen-params")&&e.activate(s),t.byClass(s,"js-scrollToComments").forEach((function(e){var o=parseInt(e.getAttribute("data-scroll-offset")),r=parseInt(e.getAttribute("data-scroll-duration"));e.addEventListener("click",(function(){!function(e,s,o){var r=t.firstByClass(e,"feed-comments-stub");if(r){var u=r.getAttribute("data-link"),c=n.extractHookId(r.getAttribute("id"));a.ajax({type:"POST",url:u}).done((function(t,a,n){null!=t&&(OK.hookModel.setHookContent(c,t),r.classList.remove("feed-comments-stub"),i(e,s,o))}))}else i(e,s,o)}(s,o,r)}))}))},deactivate:function(t){t.hasAttribute("data-seen-params")&&e.deactivate(t)}}}));