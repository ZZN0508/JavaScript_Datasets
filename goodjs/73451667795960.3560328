EBG=window.EBG||{},EBG.declareNamespace&&EBG.declareNamespace("URLUtil"),EBG.URLUtil=function(t,i){this._maximumUrlLength=i?i.maximumUrlLength:null,this._maximumAorgUrls=i?i.maximumAorgUrls:null,this.TOP_WINDOW=EBG.URLUtil.getTopAccessibleWindow(!1),t&&t({referrer:this.getReferrerUrl(),top:this.getTopUrl(),aorg:this.getAncestorOriginsUrls(this._maximumAorgUrls)})},EBG.URLUtil.prototype={capUrl:function(t){return t&&this._maximumUrlLength?t.substring(0,this._maximumUrlLength):t},getReferrerUrl:function(){return this.capUrl(this.TOP_WINDOW.document.referrer)},getTopUrl:function(){return this.capUrl(this.TOP_WINDOW.location.href)},getAncestorOriginsUrls:function(t){var i=[];if(window&&window.location&&window.location.ancestorOrigins&&"function"==typeof window.URL){var r=window.location.ancestorOrigins;if(0<r.length)for(var o=t?Math.min(t,r.length):r.length,n=0;n<o;n++)location.ancestorOrigins[n]&&i.push(this.capUrl(location.ancestorOrigins[n]))}return i}},EBG.URLUtil.getTopAccessibleWindow=function(t){t="boolean"!=typeof t||t;var i=window;return EBG.Adaptors.StdWebAdaptor._walkUpIframes(function(){i=this},null,window,!t),i},EBG.URLUtil._walkUpIframes=function(t,i,r,o){var n=r||window,l=n.location.origin||n.location.protocol+"//"+n.location.host,e=n,a=!1,c="";o=!!o;try{if(n.location.ancestorOrigins){t&&t.call(e);for(var s=0;s<n.location.ancestorOrigins.length;s++){if(0==s&&"null"==l&&(l=n.location.ancestorOrigins[0]),e=e.parent,a=!1,n.location.ancestorOrigins[s]==l)try{c=e.location.origin,a=!0}catch(t){a=!1}if(a)t&&t.call(e);else{try{i&&i.call(e)}catch(t){}if(!o)break}}}else for(t&&t.call(e);e!==e.parent;){e=e.parent,c=null;try{c=e.location.origin||e.location.protocol+"//"+e.location.host,"null"!=l&&"about://"!=l||(l=c)}catch(t){}if(c===l)t&&t.call(e);else{try{i&&i.call(e)}catch(t){}if(!o)break}}}catch(t){}},EBG.declareClass&&EBG.declareClass(EBG.URLUtil,null);
