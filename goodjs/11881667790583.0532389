!function(){"use strict";function t(){S||(S=!0,L&&clearInterval(L),function(){var t=k;if(S&&t.length){k=[];for(var o=0;o<t.length;o+=1)t[o](v)}}())}function a(t){return"function"===(null==(t=t)?t+"":"object"==typeof t||"function"==typeof t?E[C.call(t)]||"object":typeof t)}function n(t){t=t||location.search||location.href;for(var o={},e=/([^\s&?#=\/]+)=([^\s&?#=]+)/g;e.exec(t);){var i=decodeURIComponent(RegExp.$1),n=decodeURIComponent(RegExp.$2.replace("+","%20"));void 0===o[i]?o[i]=n:O(o[i])?o[i].push(n):o[i]=[o[i],n]}return o}function r(t,o){var e,i=0<arguments.length&&void 0!==t?t:{},n=1<arguments.length&&void 0!==o?o:[],r=[];for(e in i)!function(o){var t=i[o];-1===n.indexOf(o)&&""!==t&&null!=t&&(t=!O(t)?[t]:t).forEach(function(t){r.push(encodeURIComponent(o)+"="+encodeURIComponent(t))})}(e);return r.join("&")}function d(){}function e(t,o){var e,i;e=s(t),i=(i=o)||"YK-Module-CSS",document.getElementById(i)||(t=document.getElementsByTagName("head")[0],(o=document.createElement("link")).id=i,o.rel="stylesheet",o.href=e,0<(e=t.getElementsByTagName("style")).length?t.insertBefore(o,e[0]):t.appendChild(o))}function i(t,o,e,i){!function t(o,e,i,n){e="function"==typeof e?(n=i,i=e,{}):e||{};var r,a=document.createElement("script");for(r in e)"retry"!==r&&a.setAttribute(r,e[r]);e.crossOrigin&&(e.retry=1,delete e.crossOrigin),a.src=o;var s=document.getElementsByTagName("head")[0],c=!1;a.onload=a.onreadystatechange=function(){c||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(c=!0,a.onload=a.onreadystatechange=null,s.removeChild(a),i&&i())},a.onerror=function(){a.onerror=null,e.retry?(e.retry--,t(o,e,i,n)):n&&n()},s.appendChild(a)}(s(t),o,e,i)}function s(t){var o=window.YT_STATIC_DOMAIN||"";return t=o&&-1===t.indexOf(o)?t.replace("//g.alicdn.com",o):t}function c(t){var o=((t||{}).stack||"").split("\n"),t=["","",""],e=void 0,i=void 0,n={};for(i=0;i<o.length;i++){var r=M,a=(o[i]||"").match(r);null!==(a=null===(a=null===a?(o[i]||"").match(r=P):a)?(o[i]||"").match(r=T):a)&&(void 0===(a=n[e=a[1]])&&(n[e]="#"+i+"#",a=n[e]),o[i]=o[i].replace(e,a))}if(0<o.length){o.shift();for(var s="",i=0;s.length+(o[i]||"").length<500&&i<o.length;)s+=o[i]+"\n",i++;t[1]=s;for(var c="";c.length+(o[i]||"").length<500&&i<o.length;)c+=o[i]+"\n",i++;t[2]=c}var l="";for(e in n)n.hasOwnProperty(e)&&(l+=e+"@"+n[e]+";");return l=l.replace(/;$/,""),t[0]=l,t}function o(t){return t||""}function l(t,o,e){for(var i in o)o.hasOwnProperty(i)&&(e||void 0===t[i])&&(t[i]=o[i])}function u(){var t="",o="",e=window.goldlog||{},e=e.spmAb||e.spm_ab;return e&&Array.isArray(e)&&(t=e[0],e[1]&&(o=e[1])),{a:t,b:o}}function h(t){if(!(this instanceof h))return new h(t);!1!==(t=t||{}).hotPatch&&this._hotPatch(),!1!==t.global&&"object"==typeof A.__trackerOptions&&l(t,A.__trackerOptions),this.global=null==t.global||!!t.global,this.pid=t.pid,this.sampleRate=t.sampleRate||1,this.uidResolver=t.uidResolver||o,this.userOptions=t,this.requiredFields=t.requiredFields||[],this.releaseResolver=t.releaseResolver||o,this.uaParser=t.uaParser||o,this.beforeLog=t.beforeLog||null,this.msgWhitelist=t.msgWhitelist||t.msgWhiteList||null,this.urlWhitelist=t.urlWhitelist||t.urlWhiteList||null,this.oncePerSession=void 0===t.oncePerSession||t.oncePerSession,this.consoleDisplay=t.consoleDisplay||!1,this.ignoreScriptError=t.ignoreScriptError||!1,this.ignoredQueries=t.ignoredQueries||[],this.global&&(A.__trackerOptions=t),this._inited=!1,this._tracked=[],this._logWaitingQueue=[],this._plugins=t.plugins||[],this._pos="0,0",this._trackMousePos()}function p(){}var f=Array.prototype,g=f.slice,m=Object,_=m.prototype,w=String.prototype,y=Function.prototype;window.console||(window.console={log:p,error:p}),w.trim||(w.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),f.filter||(f.filter=function(t,o){for(var e=[],i=0,n=this.length;i<n;i++)i in this&&t.call(o,this[i],i,this)&&e.push(this[i]);return e}),f.forEach||(f.forEach=function(t,o){for(var e=0,i=this.length;e<i;e++)e in this&&t.call(o,this[e],e,this)}),f.some||(f.some=function(t,o){for(var e=0,i=this.length;e<i;e++)if(e in this&&t.call(o,this[e],e,this))return!0;return!1}),f.map||(f.map=function(t,o){for(var e=0,i=this.length,n=new Array(i);e<i;e++)e in this&&(n[e]=t.call(o,this[e],e,this));return n}),f.indexOf||(f.indexOf=function(t,o){var e=this.length;for((o=parseInt(o)||0)<0&&(o+=e);o<e;o++)if(o in this&&this[o]===t)return o;return-1}),Array.from||(Array.from=function(){return g.call(arguments)}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===_.toString.call(t)}),Date.now||(Date.now=function(){return+new Date}),m.keys||(m.keys=function(t){var o=[],e=void 0;for(e in t)_.hasOwnProperty.call(t,e)&&o.push(e);return o}),m.create||(m.create=function(t){function o(){}return o.prototype=t,new o}),m.assign||(m.assign=function(t){t=m(t);for(var o=arguments.length,e=1;e<o;e++){var i,n=arguments[e];for(i in n)m.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}),y.bind||(y.bind=function(t){function o(){return i.apply(this instanceof n?this:t||window,e.concat(g.call(arguments)))}var e=g.call(arguments,1),i=this,n=function(){};return n.prototype=this.prototype,o.prototype=new n,o});var v=document,y=void 0,b=void 0,L=void 0,S=void 0,k=[];if(document.addEventListener)document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1);else if(window.attachEvent){window.attachEvent("onload",t),b=document.createElement("div");try{y=null===window.frameElement}catch(t){}b.doScroll&&y&&window.external&&(L=setInterval(function(){try{b.doScroll(),t()}catch(t){}},30))}"complete"===document.readyState&&t();var E={},y="Boolean Number String Function Array Date RegExp Object".split(" "),C=Object.prototype.toString;y.forEach(function(t){E["[object "+t+"]"]=t.toLowerCase()});function F(){}var O=Array.isArray,R=(/(msie) ([\w.]+)/.exec(navigator.userAgent),0),y=window.location.host.match(/\.((youku|tudou|laifeng|soku|jingguan)\.(com|ai))$/),y=y&&y[1]||"youku.com",j=function o(t,e){return Array.isArray(t)?t.map(function(t){return o(t,e)}):"https://"+(e?"account.":"")+t}(y,!0),M=/^\s*at .*? ?\(((?:file|https?|blob|chrome-extension|native|eval|<anonymous>).*?)(?::\d+)?(?::\d+)?\)?\s*$/i,P=/^\s*.*?(?:\(.*?\))?(?:^|@)((?:file|https?|blob|chrome|resource|\[native).*?)(?::\d+)?(?::\d+)?\s*$/i,T=/^\s*at (?:(?:\[object object\])?.+ )?\(?((?:file|ms-appx|https?|blob):.*?):\d+(?::\d+)?\)?\s*$/i,A=window,x=A.document,I=x&&x.documentElement,W=A.navigator,D=!1,Y=1,K=+new Date,Q=A.onerror,U={},B=!(h.prototype={log:function(t,o){"object"==typeof t?o=t:"string"==typeof t&&l(o=o||{},{code:1,msg:t}),this._log(o)},captureMessage:function(t,o){return this.log(t,o)},logError:function(t,o){if(n=t,i={}.toString.call(n),!("object"==typeof(e=n)&&null!==e&&"[object Error]"===i||"[object Exception]"===i||n instanceof Error))return this.log(t,o);var e,i,n;(o=o||{}).c1||o.c2||o.c3?this.warn("tracker.logError() ä¸å¯ä¼ å…¥ c1,c2,c3 å­—æ®µï¼Œè¯·æ±‚æœªå‘é€"):(i={},n=c(t),i.msg=t.toString(),i.c1=n[0],i.c2=n[1],i.c3=n[2],l(i,o),this._log(i))},captureException:function(t,o){return this.logError(t,o)},config:function(t,o){return"string"==typeof t?(o=o||{}).pid=t:o=t,l(this,o,!0),l(this.userOptions,o,!0),"object"==typeof A.__trackerOptions&&l(A.__trackerOptions,o,!0),this._checkRequiredFields()&&this._popWaitingQueue(),this},onGlobalError:function(){if(!x)return this;var r=this;if(this.pid&&!this._inited){if(A.onerror=function(t,o,e,i,n){r._handleError(t,o,e,i,n)},this._plugins.length)for(;0<this._plugins.length;){var t=this._plugins.pop(),o=t[0],t=t[1];o.apply(this,[this].concat(t))}this._inited=!0}return this},offGlobalError:function(){return x&&(A.onerror=Q,this._inited=!1,this._plugins=[],this._tracked=[]),this},addPlugin:function(t){if(!x)return this;var o=[].slice.call(arguments,1);return"function"==typeof t&&this._inited?t.apply(this,[this].concat(o)):this._plugins.push([t,o]),this},_handleError:function(t,o,e,i,n){if(Q)try{Q.call(this,t,o,e,i,n)}catch(t){}o=o||"-",e=e||"-",i=i||"-",i=t;i={msg:t=/^script error\.?$/i.test(i)?"Script error":i,code:Y};this.ignoreScriptError&&"Script error"===t||(null!=n&&(1===this.sampleRate||Math.random()<.1)&&(n=c(n),i.c1=n[0],i.c2=n[1],i.c3=n[2]),this._log(i))},_handleMouseDown:function(t){var o=Math.round(t.pageY||t.clientY+x.body.scrollTop+I.scrollTop),t=Math.round(t.pageX||t.clientX+x.body.scrollLeft+I.scrollLeft);t-=Math.max(I.clientWidth,I.offsetWidth,I.scrollWidth)/2,this._pos=String(t)+","+String(o)},_trackMousePos:function(){var t,o,e,i=this;I&&(o="mousedown",e=function(t){i._handleMouseDown(t)},(t=x).addEventListener?t.addEventListener(o,e,!1):t.attachEvent("on"+o,function(){return e.call(t,window.event)}))},_log:function(t){if(!x)return this;if((t=t||{}).type||t.code||(t.type=1),!t.type&&t.code&&(t.type=t.code),!(t.type===Y&&Math.random()>(t.sampleRate||this.sampleRate)||null!=t.sampleRate&&Math.random()>t.sampleRate))if((t=this._enhanceOpitons(t)).pid){for(var o=[(n=t).type,n.uid,n.page,n.msg||"",n.ajaxurl||""].join("_"),e=!1,i=0;i<this._tracked.length;i++)if(this._tracked[i]===o){e=!0;break}if(!((null==t.oncePerSession?this:t).oncePerSession&&e||this.msgWhitelist&&null!==this.msgWhitelist.exec(t.msg)||this.urlWhitelist&&null!==this.urlWhitelist.exec(t.page))){if("function"==typeof this.beforeLog){n=void 0;try{n=this.beforeLog(t)}catch(t){}if(!1===n)return;"object"==typeof n&&(t=n)}(this._tracked.push(o),this.consoleDisplay&&"object"==typeof A&&A.console&&"function"==typeof A.console.log&&A.console.log("[Tracker] %s",t.msg),this._checkRequiredFields())?this._createImg(t):this._pushWaitingQueue(t)}}else this.warn("æœªé…ç½® pidï¼Œè¯·æ±‚æœªå‘é€");var n},_createImg:function(t){(new Image).src="//gm.mmstat.com/"+(t.base||"fsp.1.1")+"?"+r(t,["code","base","sampleRate","oncePerSession"])},_checkRequiredFields:function(){for(var t=0;t<this.requiredFields.length;t++){var o=this.requiredFields[t];if(void 0===this.userOptions[o])return!1}return!0},_popWaitingQueue:function(){if(this._logWaitingQueue&&this._logWaitingQueue.length)for(var t=0;t<this._logWaitingQueue.length;t++){var o=this._logWaitingQueue[t];l(o,this._enhanceOpitonsByUser(this.userOptions),!0),this._createImg(o)}this._logWaitingQueue=[]},_pushWaitingQueue:function(t){this._logWaitingQueue.push(t)},_enhanceOpitonsByUser:function(t){return t.uid||(t.uid=this.uidResolver()),t.pid||(t.pid=this.pid),t.rel||(t.rel=this.releaseResolver()),t.ua||(t.ua=this.uaParser(W?W.userAgent:"")),t},_enhanceOpitons:function(t){(t=this._enhanceOpitonsByUser(t)).page||(t.page=A.location.href.split("?")[0]),t.query||(t.query=r(n(window.location.search),t.ignoredQueries)),t.hash||(t.hash=window.location.hash),t.title||(t.title=x.title),t.spm_a||(t.spm_a=u().a),t.spm_b||(t.spm_b=u().b),t.scr||(t.scr=window.screen.width+"x"+window.screen.height),t.raw_ua=W?W.userAgent:"",t.delay=parseFloat(((+new Date-K)/1e3).toFixed(2)),t.tracker_ver=this.VERSION,t.patch_ver=this.PATCH_VERSION||"-";var o=x.referrer.split("?"),e=o[0],i=2===o.length?r(n(o[1]),t.ignoredQueries):"";return 2===o.length&&0<i.length?t.referrer=e+"?"+i:t.referrer=e,t.last_pos=this._pos,t},warn:function(t){"object"==typeof A&&A.console&&"function"==typeof A.console.warn&&A.console.warn("[Tracker] "+t)},_hotPatch:function(){if(A&&x&&(!D||!A.__trackerPatch)){D=!0;var t=Math.random();if(A.localStorage&&A.localStorage.getItem){var o=A.localStorage.getItem("__tracker_patch__"),e=+new Date;if(o&&e-parseInt(o,10)<432e5)t=o;else{t=e;try{A.localStorage.setItem("__tracker_patch__",e)}catch(t){}}}e=x.createElement("script");e.src="//g.alicdn.com/fsp/tracker-patch/index.js?"+t,e.async=!0,e.crossOrigin=!0,e.id="tracker-patch",(x.head||x.body).appendChild(e);var i=this;A.__trackerPatch=function(){return i}}}}),y=(N.prototype.init=function(){var t=this.config,o=this.loadMode;this._loadFail=this._loadError=!1,U[o]&&(U[o].destory&&U[o].destory(),U[o]=null),"login"===o?B||(B=!0,this._getConfig("login"),this._loadLogin(function(){U[o]=new window.loginFrame(t),B=!1}),window.YKLoginTracker||(window.YKLoginTracker=new h({pid:"passport-login",sampleRate:.01})).onGlobalError()):"component"===o?this._loadComponent(function(){t.initFromLoader=!0,U[o]=new window.YKComponent(t),a(t.componentDidLoad)&&t.componentDidLoad()}):this._loadLogout(function(){U[o]=new window.logoutFrame(t)})},N.prototype.buildLoginDom=function(t){var o=this;this._addTask(function(){U[o.loadMode].buildLoginDom(t)})},N.prototype.buildRegDom=function(t){var o=this;this._addTask(function(){U[o.loadMode].buildRegDom(t)})},N.prototype.initBindComponent=function(){this.initComponent()},N.prototype.initComponent=function(){var t=this;this._addTask(function(){U[t.loadMode].getFlowData(t.config.flowName)})},N.prototype.getThirdPartData=function(r){var t=this;this._addTask(function(){U[t.loadMode].once("configLoaded",function(t){if(a(r)){for(var o=[],e="&protocol="+window.location.protocol,i=t.thirdPartUrlAry&&t.thirdPartUrlAry.length||0,n=0;n<i;n++)o.push({site:t.thirdPartUrlAry[n].site,link:t.thirdPartUrlAry[n].link+"&needRecommend=true"+e});r(o)}}).getCustomConfig()})},N.prototype.closeFrame=function(t){var o=this.loadMode;U[o]&&U[o].closeFrame(t)},N.prototype._addTask=function(t){var o=this;this._loadError||(U[this.loadMode]?a(t)&&t():this._taskTimer=setTimeout(function(){o._addTask(t)},10))},N.prototype._getConfig=function(t){var o,e;-1<window.location.host.indexOf("v.youku.com")||(t="https://"+((o=this.config).accountDomain||j).replace(/^https?:\/\/|^\/\//i,"")+"/getConfig.json"+"?pid="+(o.pid||"")+"&bizType="+(t||"")+"&callback="+encodeURIComponent(o.callbackURL||""),o.configId&&(t+="&configId="+o.configId),e=void 0,window.YKLoginPreLoadConfig=function(t){window.YKLoginPreLoadConfigResult?a(t)&&t(window.YKLoginPreLoadConfigResult):e=t,window.YKLoginPreLoadConfig=null,window.YKLoginPreLoadConfigResult=null},function(t,o,e){function i(){c.parentNode&&c.parentNode.removeChild(c),window[r]=d,l&&clearTimeout(l)}"function"==typeof o&&(e=o,o={});var n=(o=o||{}).prefix||"__jp",r=o.name||n+R++,a=o.param||"callback",s=null!=o.timeout?o.timeout:6e4,n=encodeURIComponent,o=document.getElementsByTagName("script")[0]||document.head,c=void 0,l=void 0;s&&(l=setTimeout(function(){i(),e&&e(new Error("è¯·æ±‚è¶…æ—¶ï¼Œè¯·é‡è¯•"))},s)),window[r]=function(t){i(),e&&e(t)},t=(t+=(-1<t.indexOf("?")?"&":"?")+a+"="+n(r)).replace("?&","?"),(c=document.createElement("script")).src=t,o.parentNode.insertBefore(c,o)}(t,{param:"jsonpCallback",prefix:"__jsonp",timeout:5e3},function(t){t instanceof Error&&window.YKLoginTracker&&window.YKLoginTracker.log({code:11,c1:window.location.href,sampleRate:.01,msg:"é¢„åŠ è½½getConfigè¶…æ—¶"}),a(e)?e(t):window.YKLoginPreLoadConfigResult=t}))},N.prototype._loadLogin=function(t){var o=this;e(this.styleSrc,"YT-loginFrameCss"),setTimeout(function(){window.loginFrame?a(t)&&t():i(o.scriptSrc,{crossOrigin:!0},function(){window.loginFrame?(a(t)&&t(),a(o.loadSuccess)&&o.loadSuccess()):o._loadFail?(o._loadError=!0,a(o.loadFail)&&o.loadFail()):(o._loadFail=!0,o._loadLogin(t))})},this._loadFail?0:50)},N.prototype._loadLogout=function(t){var o=this;i("//g.alicdn.com/static-es6/login/public/logout_ecd3bf5b.js",{crossOrigin:!0},function(){window.logoutFrame?(a(t)&&t(),a(o.loadSuccess)&&o.loadSuccess()):o._loadFail?a(o.loadFail)&&o.loadFail():(o._loadFail=!0,o._loadLogout(t))})},N.prototype._loadComponent=function(t){var o=this;e(this.styleSrc,"YT-ComponentCss"),setTimeout(function(){window.YKComponent?a(t)&&t():i(o.scriptSrc,function(){window.YKComponent?(a(t)&&t(),a(o.loadSuccess)&&o.loadSuccess()):o._loadFail?(o._loadError=!0,a(o.loadFail)&&o.loadFail()):(o._loadFail=!0,o._loadComponent(t))})},this._loadFail?0:50)},N.getInstance=function(){return U[this.loadMode]},N);function N(t){this.config=t=t||{},t.isMobile=t.isMobile||t.template&&-1<t.template.toLowerCase().indexOf("mobile")||!1,t.logoutSuccess=t.logoutSuccess||function(){window.location.reload()},this.loadMode=t.loadMode||t.loadType||t.loginOrLogout||"login",this.loadFail=t.loadFail||t.loadfail||F,this.loadSuccess=t.loadSuccess||t.loadSucess||F,this.styleSrc=t.isMobile?"//g.alicdn.com/static-es6/login/h5/login/css/main_0dade16c.css":"//g.alicdn.com/static-es6/login/pc/login/css/main_70d8d4cb.css",this.scriptSrc=t.isMobile?"//g.alicdn.com/static-es6/login/h5/login/js/main_ee10de6e.js":"//g.alicdn.com/static-es6/login/pc/login/js/main_eba8f3e8.js","bind"===this.loadMode&&(this.loadMode="component",this.config.flowName="BindMobile"),"component"===this.loadMode&&(this.styleSrc=t.isMobile?"//g.alicdn.com/static-es6/login/h5/component/css/main_4bd2dedf.css":"//g.alicdn.com/static-es6/login/pc/component/css/main_9bd343ba.css",this.scriptSrc=t.isMobile?"//g.alicdn.com/static-es6/login/h5/component/js/main_4bd2dedf.js":"//g.alicdn.com/static-es6/login/pc/component/js/main_acec077c.js"),this.init()}y.ready=function t(o){return S?o(v):k.push(o),t},window.YKLoginLoader=window.YKLoginLoader||y,window.YKComponentLoader=window.YKComponentLoader||y,window.getLoginFrame=window.getLoginFrame||y}();
