var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,i){t!=Array.prototype&&t!=Object.prototype&&(t[e]=i.value)},$jscomp.getGlobal=function(t){return("undefined"==typeof window||window!==t)&&"undefined"!=typeof global&&null!=global?global:t},$jscomp.global=$jscomp.getGlobal(this),$jscomp.polyfill=function(t,e,i,o){if(e){for(i=$jscomp.global,t=t.split("."),o=0;o<t.length-1;o++){var n=t[o];n in i||(i[n]={}),i=i[n]}(e=e(o=i[t=t[t.length-1]]))!=o&&null!=e&&$jscomp.defineProperty(i,t,{configurable:!0,writable:!0,value:e})}},$jscomp.underscoreProtoCanBeSet=function(){var t={};try{return t.__proto__={a:!0},t.a}catch(t){}return!1},$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null,$jscomp.polyfill("Object.setPrototypeOf",function(t){return t||$jscomp.setPrototypeOf},"es6","es5");var Horizon,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e=window,o=encodeURIComponent,i=(n.prototype.cleanImg=function(){this.imgArray=[]},n.prototype.ajaxPost=function(t,e){var i;void 0!==this.navigator.sendBeacon&&!1!==this.navigator.sendBeacon(this.horizonUrl,t)||((i=new XMLHttpRequest).open("POST",this.horizonUrl,"boolean"==typeof e.sendDelay?e.sendDelay:void 0===e.sendDelay),i.setRequestHeader("Content-Type","application/json"),i.withCredentials=!0,e.callbackError&&(i.addEventListener("error",e.callbackError),i.addEventListener("abort",e.callbackError),i.addEventListener("load",function(){i.readyState===XMLHttpRequest.DONE&&400<=i.status&&e.callbackError(t)})),i.send(t))},n.prototype.encodeQueryData=function(t){var e,i=[];for(e in t)i.push(o(e)+"="+o(t[e]));return i.join("&")},n.prototype.ajaxImg=function(t){var e=new Image(1,1);this.imgArray.push(e),t=this.horizonActivity+"/"+t.product+"/"+t.operation+"?object="+t.object+"&"+this.encodeQueryData(t.attributes),e.src=t},n.prototype.proxy=function(t,e,i){return function(){t.apply(e,[i])}},n.prototype.getMeta=function(t){return void 0===(t=document.querySelector('meta[property="'+t+'"]')||{}).content?"":t.content},n.prototype.getUrl=function(t){return this.hasFullUrl?o(t):o(t&&t.split("#")[0])},n);function n(t){void 0===t&&(t=!1),this.navigator=e.navigator,this.imgArray=[],this.horizonUrl="//horizon.globo.com/auth-session/stream",this.horizonActivity="//horizon.globo.com/auth-session/activity",this.hasFullUrl=t,this.intervalID=e.setInterval(this.proxy(this.cleanImg,this,{}),1e5)}t.Utils=i}(Horizon=Horizon||{}),function(t){var e=window,o=console;t.send=function(t,e){var i;t.notifySubscribers("collect"),"number"==typeof t.intervalID&&0<t.signalBuffer.length&&(i=JSON.stringify(t.signalBuffer),t.clearSignalBuffer(),e.callbackError=t.utils.proxy(t.restoreBuffer,t,i),t.utils.ajaxPost(i,e))};var i=(n.prototype.subscribe=function(t,e,i){try{this.subscribers[t][e]=i}catch(t){o.log(t.message)}},n.prototype.unsubscribe=function(t,e){try{delete this.subscribers[t][e]}catch(t){o.log(t.message)}},n.prototype.notifySubscribers=function(t){for(var e in t=this.subscribers[t])if(t.hasOwnProperty(e))try{t[e]()}catch(t){o.log(t.message)}},n.prototype.clearSignalBuffer=function(){this.signalBuffer=[]},n.prototype.forceSend=function(){t.send(this,{callbackError:void 0,sendDelay:!1})},n.prototype.sendPostView=function(t){this.sendWithQueue(t,"post-view")},n.prototype.sendPostClick=function(t){this.sendWithQueue(t,"post-click")},n.prototype.sendTrack=function(t){this.sendWithImage(t,"track")},n.prototype.sendPageView=function(t){this.sendWithImage(t,"horizon-pageview")},n.prototype.sendClick=function(t){this.sendWithImage(t,"click")},n.prototype.sendVideoWatch=function(t){this.sendWithImage(t,"watch")},n.prototype.sendVideoWatchLive=function(t){this.sendWithImage(t,"watchlive")},n.prototype.restoreBuffer=function(t){this.signalBuffer=JSON.parse(t).concat(this.signalBuffer).slice(0,200)},n.prototype.sendWithImage=function(t,e){try{t=this.addDefaultParams(t,e),this.utils.ajaxImg(t)}catch(t){o.log(t.message)}},n.prototype.addDefaultParams=function(t,e){return t.operation=e,"object"==typeof t.attributes&&(t.attributes.client_version=this.clientVersion),t},n.prototype.sendLater=function(t){this.signalBuffer.push(t)},n.prototype.sendWithQueue=function(t,e){try{t=this.addDefaultParams(t,e),this.sendLater(t)}catch(t){o.log(t.message)}},n.instance=void 0,n);function n(){return this.clientVersion="0.3.11",this.subscribers={},this.utils=new t.Utils,void 0===n.instance&&((n.instance=this).subscribers.collect={},this.subscribers.focus={},this.subscribers.blur={},this.intervalID=e.setInterval(t.send,1e4,this,{callbackError:void 0,sendDelay:!0}),this.signalBuffer=[],e.addEventListener("beforeunload",this.utils.proxy(this.forceSend,this,{})),e.addEventListener("unload",this.utils.proxy(this.forceSend,this,{}))),n.instance}t.Client=i}(Horizon=Horizon||{}),function(e){var n=window,i=encodeURIComponent,o=location,t=document.body,r=document.documentElement,s=n.glb_realtime_map||{},a=(c.prototype.getUrl=function(){var t=s?s.url:void 0;return t=(t=this.utils.hasFullUrl?o.href:t)||o.protocol+"//"+o.hostname+(o.port?":"+o.port:"")+o.pathname},c.prototype.getSite=function(){var e=s?s.site:void 0;if(!e){try{e=this.getUrl().split("//")[1].replace("www.","").split(".")[0]}catch(t){e=void 0}e=e||o.hostname.replace(".globo.com","").replace(".globoi.com","").replace("www.","")}return e},c.prototype.nextPage=function(t){try{var e=i(t);this.track.reloadTrack(e),this.click.reloadClick(e),this.pageview.sendVirtual(e)}catch(t){console.log(t.message)}},c.instance=void 0,c);function c(){return s=n.glb_realtime_map||{},void 0!==n.pvm&&void 0===c.instance&&(c.instance=n.pvm),void 0===c.instance&&(c.instance=this,s.hasFullUrl=s.hasFullUrl||!1,s.categories=s.categories||[],this.utils=new e.Utils(s.hasFullUrl),s.site=s.site||this.getSite(),s.url=s.url||this.getUrl(),n.glb_realtime_map=s,this.pageview=new d(this.utils),this.track=new f(this.utils),this.click=new y(this.utils)),c.instance}function l(t){this.client=new e.Client,this.utils=t}e.Tracker=a,l.prototype.makeDefaultParams=function(){return{object:this.object||this.utils.getUrl(s.url),product:i(s.site)}},l.prototype.listen=function(t,e){for(var i=0,o=t.length;i<o;i++)document.addEventListener(t[i],e,!1)},l.prototype.handleClickListener=function(t){this.listen(["click","touchstart"],t)};var h,u,p,d=(__extends(b,p=a=l),b.prototype.inArray=function(t,e){if(e.indexOf)return e.indexOf(t);for(var i=0,o=e.length;i<o;i++)if(e[i]===t)return i;return-1},b.prototype.getCategories=function(){var t=s.categories;if(n.REALTIME&&n.REALTIME.categories)for(var e=n.REALTIME.categories(),i=e.length,o=0;o<i;o++)-1==this.inArray(e[o],t)&&(t+=e[o])},b.prototype.makeParams=function(){var t=this.makeDefaultParams();return t.attributes={Referrer:i(document.referrer),tags:i((s.categories||[]).join(","))},t},b.prototype.sendVirtual=function(t){this.object=t,t=this.makeParams(),this.client.sendPageView(t)},b.instance=void 0,b),f=(__extends(m,u=a),m.prototype.handleScrollListener=function(t){this.listen(["scroll","touchmove"],t)},m.prototype.handleFocusListener=function(t){this.listen(["focus","focusin","pageshow","mousemove"],t)},m.prototype.handleBlurListener=function(t){this.listen(["blur","focusout","pagehide"],t)},m.prototype.handleSendActions=function(){var t=this.utils.proxy,e=t(this.handleSend,this,{});this.handleFocusListener(e),this.handleBlurListener(e),this.handleClickListener(e),this.handleScrollListener(e),n.addEventListener("beforeunload",t(this.sendTrack,this,{}),!0)},m.prototype.makeVisibilityListener=function(t,e){var i=this.utils.proxy;this.listen([e],i(this.handleVisibilityChange,this,t)),this.listen([e],i(this.handleSend,this,{}))},m.prototype.handleVisibility=function(){var t=this.utils.proxy;document.visibilityState?(this.makeVisibilityListener("hidden","visibilitychange"),this.makeVisibilityListener("msHidden","msvisibilitychange"),this.makeVisibilityListener("webkitHidden","webkitvisibilitychange")):(this.handleFocusListener(t(this.startTrack,this,"")),this.handleBlurListener(t(this.stopTrack,this,"")))},m.prototype.getAbsScroll=function(){return n.pageYOffset||t.scrollTop||r.scrollTop||0},m.prototype.getTotalHeight=function(){return Math.max(t.scrollHeight||0,r.scrollHeight||0,t.offsetHeight||0,r.offsetHeight||0,t.clientHeight||0,r.clientHeight||0)},m.prototype.getClientHeight=function(){return n.innerHeight||r.clientHeight||t.clientHeight||0},m.prototype.getScroll=function(){var t=this.getTotalHeight();return 0==t?0:(t=(this.getAbsScroll()+this.getClientHeight())/t*100,this.maxScroll=this.maxScroll>t?this.maxScroll:t,parseFloat(this.maxScroll.toString()).toFixed(2))},m.prototype.getMetaType=function(){this.objectType=this.utils.getMeta("metrics:type")||this.utils.getMeta("og:type")||""},m.prototype.makeParams=function(){var t=this.makeDefaultParams();return t.attributes={time:this.totalTime,clicks:this.click.number,scroll:this.getScroll(),scrollabs:this.getAbsScroll(),objecttype:i(this.objectType)},t},m.prototype.calcTime=function(){var t=new Date,e=0;try{e=t.getTime()-this.lastSentDate.getTime()}catch(t){}return e},m.prototype.shouldSend=function(){return 1e4<this.calcTime()},m.prototype.sendTrack=function(){this.stopTrack(),this.client.sendTrack(this.makeParams()),this.startTrack()},m.prototype.handleVisibilityChange=function(t){document[t]?this.stopTrack():this.startTrack()},m.prototype.handleSend=function(){this.shouldSend()&&this.sendTrack()},m.prototype.stopTrack=function(){this.client.notifySubscribers("blur"),this.totalTime+=this.calcTime()},m.prototype.startTrack=function(){this.client.notifySubscribers("focus"),this.lastSentDate=new Date},m.prototype.reloadTrack=function(t){this.sendTrack(),this.object=t,this.getMetaType(),this.maxScroll=this.totalTime=0,this.click.number=0},m.instance=void 0,m),y=(__extends(g,h=a),g.prototype.startListen=function(){var t=this.utils.proxy;this.handleClickListener(t(this.handleClick,this,{}))},g.prototype.handleClick=function(){this.number++},g.prototype.reloadClick=function(t){this.object=t,this.number=0},g.instance=void 0,g);function g(t){return void((t=h.call(this,t)||this).number=0)===g.instance&&(g.instance=t).startListen(),g.instance}function m(t){var e=u.call(this,t)||this;return e.totalTime=0,e.click=void 0,e.objectType=void 0,void(e.maxScroll=0)===m.instance&&((m.instance=e).handleVisibility(),e.handleSendActions(),s.noAutoStartTracker||e.startTrack(),e.getMetaType(),e.click=new y(t)),m.instance}function b(t){return t=p.call(this,t)||this,void 0===b.instance&&(b.instance=t,s.noAutoStartTracker||t.client.sendPageView(t.makeParams())),b.instance}}(Horizon=Horizon||{}),window.pvm=new Horizon.Tracker;
