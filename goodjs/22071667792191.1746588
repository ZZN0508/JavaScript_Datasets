var timestamp=Date.parse(new Date)/1e3,passwordkey=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9"];function passkey(e){for(var t="",r=0;r<e;r++)t+=passwordkey[Math.floor(Math.random()*passwordkey.length)];return t}var nonce=passkey(16),PUBLIC_KEY="MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCfZ2v+re+b8CUFkL5InZvpwe1BEOhzpSqWNiKTGnDnohYXSpVQbIQGnoIiL4mmqdyog+WwnK99Yc8fCUmXf5D/nFXtmCyLyDhOgLJ5Ha7H0JJWNaVKTRHCT+aFjSr08/K/NLPFV2/4q7C1S5cOf6do76PJ+GdxU7V0GpFmAgsIPQIDAQAB",encryptd=new JSEncrypt;function encryptras(e,t){t=CryptoJS.enc.Utf8.parse(t),e=CryptoJS.enc.Utf8.parse(e);return CryptoJS.AES.encrypt(e,t,{iv:t,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}).toString()}encryptd.setPublicKey("-----BEGIN PUBLIC KEY-----"+PUBLIC_KEY+"-----END PUBLIC KEY-----"),function(c,x,j){function b(){return(new Date).getTime()}function e(){return!1}function t(){return!0}function S(e,t){return new S.fn.init(e,t)}x.jQuery;var a,n=x.$,C=x.document,o=/^[^<]*(<[\w\W]+>)[^>]*$|^#([\w-]+)$/,s=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,r=(navigator.userAgent,Object.prototype.toString),i=Object.prototype.hasOwnProperty;Array.prototype.push,Array.prototype.slice,Array.prototype.indexOf;(S.fn=S.prototype={init:function(e,t){var r,n;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if("body"===e&&!t)return this.context=C,this[0]=C.body,this.selector="body",this.length=1,this;if("string"!=typeof e)return S.isFunction(e)?a.ready(e):(e.selector!==j&&(this.selector=e.selector,this.context=e.context),S.makeArray(e,this));if(!(r=o.exec(e))||!r[1]&&t)return!t&&/^\w+$/.test(e)?(this.selector=e,e=(this.context=C).getElementsByTagName(e),S.merge(this,e)):(!t||t.jquery?t||a:S(t)).find(e);if(r[1])return n=t?t.ownerDocument||t:C,(e=s.exec(e))?S.isPlainObject(t)?(e=[C.createElement(e[1])],S.fn.attr.call(e,t,!0)):e=[n.createElement(e[1])]:e=((e=sa([r[1]],[n])).cacheable?e.fragment.cloneNode(!0):e.fragment).childNodes,S.merge(this,e);if(t=C.getElementById(r[2])){if(t.id!==r[2])return a.find(e);this.length=1,this[0]=t}return this.context=C,this.selector=e,this}}).init.prototype=S.fn,S.extend=S.fn.extend=function(){var e,t,r,n,a=arguments[0]||{},o=1,s=arguments.length,i=!1;for("boolean"==typeof a&&(i=a,a=arguments[1]||{},o=2),"object"==typeof a||S.isFunction(a)||(a={}),s===o&&(a=this,--o);o<s;o++)if(null!=(e=arguments[o]))for(t in e)r=a[t],a!==(n=e[t])&&(i&&n&&(S.isPlainObject(n)||S.isArray(n))?(r=r&&(S.isPlainObject(r)||S.isArray(r))?r:S.isArray(n)?[]:{},a[t]=S.extend(i,r,n)):n!==j&&(a[t]=n));return a},S.extend({isFunction:function(e){return"[object Function]"===r.call(e)},isArray:function(e){return"[object Array]"===r.call(e)},isPlainObject:function(e){if(!e||"[object Object]"!==r.call(e)||e.nodeType||e.setInterval)return!1;if(e.constructor&&!i.call(e,"constructor")&&!i.call(e.constructor.prototype,"isPrototypeOf"))return!1;for(var t in e);return t===j||i.call(e,t)}}),a=S(C),C.addEventListener||C.attachEvent;var u="jQuery"+b();S.event={global:{},trigger:function(e,t,r,n){var a=e.type||e;if(!n){if(e="object"==typeof e?e[u]?e:S.extend(S.Event(a),e):S.Event(a),0<=a.indexOf("!")&&(e.type=a=a.slice(0,-1),e.exclusive=!0),r||(e.stopPropagation(),S.event.global[a]&&S.each(S.cache,function(){this.events&&this.events[a]&&S.event.trigger(e,t,this.handle.elem)})),!r||3===r.nodeType||8===r.nodeType)return j;e.result=j,e.target=r,(t=S.makeArray(t)).unshift(e)}e.currentTarget=r,(n=S.data(r,"handle"))&&n.apply(r,t),n=r.parentNode||r.ownerDocument;try{r&&r.nodeName&&S.noData[r.nodeName.toLowerCase()]||r["on"+a]&&!1===r["on"+a].apply(r,t)&&(e.result=!1)}catch(e){}if(!e.isPropagationStopped()&&n)S.event.trigger(e,t,n,!0);else if(!e.isDefaultPrevented()){n=e.target;var o,s=S.nodeName(n,"a")&&"click"===a,i=S.event.special[a]||{};if(!(i._default&&!1!==i._default.call(r,e)||s||n&&n.nodeName&&S.noData[n.nodeName.toLowerCase()])){try{n[a]&&((o=n["on"+a])&&(n["on"+a]=null),S.event.triggered=!0,n[a]())}catch(e){}o&&(n["on"+a]=o),S.event.triggered=!1}}}};C.removeEventListener;(S.Event=function(e){if(!this.preventDefault)return new S.Event(e);e&&e.type?(this.originalEvent=e,this.type=e.type):this.type=e,this.timeStamp=b(),this[u]=!0}).prototype={preventDefault:function(){this.isDefaultPrevented=t;var e=this.originalEvent;e&&(e.preventDefault&&e.preventDefault(),e.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=t;var e=this.originalEvent;e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},isDefaultPrevented:e,isPropagationStopped:e,isImmediatePropagationStopped:e};var E=b(),p=/<script(.|\s)*?\/script>/gi,T=/=\?(&|$)/,w=/\?/,A=/(\?|&)_=.*?(&|$)/,P=/^(\w+:)?\/\/([^\/?#]+)/,l=/%20/g,d=S.fn.load;S.fn.extend({load:function(e,t,r){if("string"!=typeof e)return d.call(this,e);if(!this.length)return this;var n,a=e.indexOf(" ");0<=a&&(n=e.slice(a,e.length),e=e.slice(0,a)),a="GET",t&&(S.isFunction(t)?(r=t,t=null):"object"==typeof t&&(t=S.param(t,S.ajaxSettings.traditional),a="POST"));var o=this;return S.ajax({url:e,type:a,dataType:"html",data:t,complete:function(e,t){"success"!==t&&"notmodified"!==t||o.html(n?S("<div />").append(e.responseText.replace(p,"")).find(n):e.responseText),r&&o.each(r,[e.responseText,t,e])}}),this}}),S.extend({get:function(e,t,r,n){return S.isFunction(t)&&(n=n||r,r=t,t=null),S.ajax({type:"GET",url:e,data:t,success:r,dataType:n})},getJSON:function(e,t,r){return S.get(e,t,r,"json")},ajaxSettings:{url:location.href,global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,xhr:!x.XMLHttpRequest||"file:"===x.location.protocol&&x.ActiveXObject?function(){try{return new x.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}:function(){return new x.XMLHttpRequest},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},ajax:function(e){function r(){u.success&&u.success.call(p,s,o,h),u.global&&t("ajaxSuccess",[h,u])}function n(){u.complete&&u.complete.call(p,h,o),u.global&&t("ajaxComplete",[h,u]),u.global&&!--S.active&&S.event.trigger("ajaxStop")}function t(e,t){(u.context?S(u.context):S.event).trigger(e,t)}var a,o,s,i,c,u=S.extend(!0,{},S.ajaxSettings,e),p=e&&e.context||u,l=u.type.toUpperCase();if(u.data&&u.processData&&"string"!=typeof u.data&&(u.data=S.param(u.data,u.traditional)),"jsonp"===u.dataType&&("GET"===l?T.test(u.url)||(u.url+=(w.test(u.url)?"&":"?")+(u.jsonp||"callback")+"=?"):u.data&&T.test(u.data)||(u.data=(u.data?u.data+"&":"")+(u.jsonp||"callback")+"=?"),u.dataType="json"),"json"===u.dataType&&(u.data&&T.test(u.data)||T.test(u.url))&&(a=u.jsonpCallback||"jsonp"+E++,u.data&&(u.data=(u.data+"").replace(T,"="+a+"$1")),u.url=u.url.replace(T,"="+a+"$1"),u.dataType="script",x[a]=x[a]||function(e){s=e,r(),n(),x[a]=j;try{delete x[a]}catch(e){}f&&f.removeChild(y)}),"script"===u.dataType&&null===u.cache&&(u.cache=!1),!1===u.cache&&"GET"===l&&(i=b(),c=u.url.replace(A,"$1_="+i+"$2"),u.url=c+(c===u.url?(w.test(u.url)?"&":"?")+"_="+i:"")),u.data&&"GET"===l&&(u.url+=(w.test(u.url)?"&":"?")+u.data),u.global&&!S.active++&&S.event.trigger("ajaxStart"),i=(i=P.exec(u.url))&&(i[1]&&i[1]!==location.protocol||i[2]!==location.host),"script"===u.dataType&&"GET"===l){var d,f=C.getElementsByTagName("head")[0]||C.documentElement,y=C.createElement("script");return y.src=u.url,u.scriptCharset&&(y.charset=u.scriptCharset),a||(d=!1,y.onload=y.onreadystatechange=function(){d||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(d=!0,r(),n(),y.onload=y.onreadystatechange=null,f&&y.parentNode&&f.removeChild(y))}),f.insertBefore(y,f.firstChild),j}var m=!1,h=u.xhr();if(h){u.username?h.open(l,u.url,u.async,u.username,u.password):h.open(l,u.url,u.async);try{(u.data||e&&e.contentType)&&h.setRequestHeader("Content-Type",u.contentType),u.ifModified&&(S.lastModified[u.url]&&h.setRequestHeader("If-Modified-Since",S.lastModified[u.url]),S.etag[u.url]&&h.setRequestHeader("If-None-Match",S.etag[u.url])),i||h.setRequestHeader("X-Requested-With","XMLHttpRequest"),h.setRequestHeader("Accept",u.dataType&&u.accepts[u.dataType]?u.accepts[u.dataType]+", */*":u.accepts._default)}catch(e){}if(u.beforeSend&&!1===u.beforeSend.call(p,h,u))return u.global&&!--S.active&&S.event.trigger("ajaxStop"),h.abort(),!1;u.global&&t("ajaxSend",[h,u]);var g=h.onreadystatechange=function(e){if(h&&0!==h.readyState&&"abort"!==e){if(!m&&h&&(4===h.readyState||"timeout"===e)){var t;if(m=!0,h.onreadystatechange=S.noop,"success"===(o="timeout"===e?"timeout":S.httpSuccess(h)?u.ifModified&&S.httpNotModified(h,u.url)?"notmodified":"success":"error"))try{s=S.httpData(h,u.dataType,u)}catch(e){o="parsererror",t=e}"success"===o||"notmodified"===o?a||r():S.handleError(u,h,o,t),n(),"timeout"===e&&h.abort(),u.async&&(h=null)}}else m||n(),m=!0,h&&(h.onreadystatechange=S.noop)};try{var v=h.abort;h.abort=function(){h&&v.call(h),g("abort")}}catch(e){}u.async&&0<u.timeout&&setTimeout(function(){h&&!m&&g("timeout")},u.timeout);try{h.send("POST"===l||"PUT"===l||"DELETE"===l?u.data:null)}catch(e){S.handleError(u,h,null,e),n()}return u.async||g(),h}},handleError:function(e,t,r,n){e.error&&e.error.call(e.context||e,t,r,n),e.global&&(e.context?S(e.context):S.event).trigger("ajaxError",[t,e,n])},active:0,httpSuccess:function(e){try{return!e.status&&"file:"===location.protocol||200<=e.status&&e.status<300||304===e.status||1223===e.status||0===e.status}catch(e){}return!1},httpNotModified:function(e,t){var r=e.getResponseHeader("Last-Modified"),n=e.getResponseHeader("Etag");return r&&(S.lastModified[t]=r),n&&(S.etag[t]=n),304===e.status||0===e.status},httpData:function(e,t,r){var n=e.getResponseHeader("content-type")||"",a="xml"===t||!t&&0<=n.indexOf("xml");return e=a?e.responseXML:e.responseText,a&&"parsererror"===e.documentElement.nodeName&&S.error("parsererror"),"string"==typeof(e=r&&r.dataFilter?r.dataFilter(e,t):e)&&("json"===t||!t&&0<=n.indexOf("json")?e=S.parseJSON(e):("script"===t||!t&&0<=n.indexOf("javascript"))&&S.globalEval(e)),e},param:function(e,a){function o(e,t){t=S.isFunction(t)?t():t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)}var r=[];if(a===j&&(a=S.ajaxSettings.traditional),S.isArray(e)||e.jquery)S.each(e,function(){o(this.name,this.value)});else for(var t in e)!function r(n,e){S.isArray(e)?S.each(e,function(e,t){a||/\[\]$/.test(n)?o(n,t):r(n+"["+("object"==typeof t||S.isArray(t)?e:"")+"]",t)}):a||null==e||"object"!=typeof e?o(n,e):S.each(e,function(e,t){r(n+"["+e+"]",t)})}(t,e[t]);return r.join("&").replace(l,"+")},noop:function(){}});function f(){}f.isChinese=function(e){return!!/^[\u4E00-\u9FA5]+$/.test(e)},f.isUsrId=function(e){return!!/^[0-9]{11}$/.test(e)},f.isEmail=function(e){return!!/^[^@]+@[^@]+$/.test(e)};function y(){}y.success="ok",y.usernameError="error_001",y.passwordError="error_002";var m={type:y.success,msg:y.success,usrid:"",user_seq_id:"",errorCode:"0"};y.checkUsername=function(e,t){m={type:y.success,msg:y.success,errorCode:"0"};var r=e.username.value,n=y.success;""!=r&&"璇疯緭鍏ラ偖绠�/鎵嬫満鍙�"!=r?"bjccpwj@126.com"==r||"2012052510115567280"==r?(n="閭寮傚父锛岃鍒版寚瀹氶〉闈㈢櫥褰�",m.errorCode="-201"):(e=0)==(e=f.isEmail(r)||f.isUsrId(r)?1:e)&&(n="杈撳叆鏍煎紡鏈夎锛岃浣跨敤閭鎴栨墜鏈哄彿鐧诲綍",m.errorCode="-1"):(n="璇疯緭鍏ュ笎鍙�",m.errorCode="-202"),y.success!=n&&(m.msg=n,m.type=y.usernameError),t&&t(m)},y.checkPassword=function(e,t){m={type:y.success,msg:y.success,errorCode:"0"};var r=e.password.value,e=y.success;""==r&&(e="璇疯緭鍏ュ瘑鐮�",m.errorCode="-2"),y.success!=e&&(m.msg=e,m.type=y.passwordError),t&&t(m)},y.handleSso=function(e,t,r,n,a,o,s){var i;e&&t>=e.length?"post"==r?(-1<n.indexOf("?")?n+="&ticket=":n+="?ticket=",n+=a,location.href=n):"jsonp"==r?o(s):"logout"==r&&o&&o():(i=e[t].split(":")[1],S.getJSON(i,function(){y.handleSso(e,++t,r,n,a,o,s)}))},y.formSubmit=function(a,o,s){var e,t,i,r;y.checkUsername(a),y.success==m.msg?(y.checkPassword(a),y.success==m.msg?(m={type:y.success,msg:y.success,errorCode:"0"},e=a.username.value,t=a.password.value,a.from.value,i="",a.service&&(i=a.service.value),a.remuser&&a.remuser.checked&&a.remuser.value,r=new Array,encryptdata="account="+e.toLowerCase()+"&appid=dgtgyfxwn9gcr7ow&captcha_type=3&nonce="+nonce.toLowerCase()+"&password="+t.toLowerCase()+"&rem_login=1&ts="+timestamp,r.push(c+"/openapi/v2/user/login","?timestamp=",timestamp),r=r.join(""),n.ajax({url:r,type:"post",dataType:"json",data:{account:encryptras(e,nonce),appid:encryptras("DGTGYFXWN9GCR7OW",nonce),captcha_type:encryptras("3",nonce),nonce:encryptd.encrypt(nonce),password:encryptras(t,nonce),rem_login:encryptras("1",nonce),ts:encryptras(timestamp,nonce),encryptdata:sha512(encryptdata)},success:function(e){var t,r,n=e.code;"0"==n?(t=e.data.sso,r=e.data.ticket,m.usrid=e.usrid,m.user_seq_id=e.user_seq_id,y.handleSso(t,0,s,i,r,o,m)):"post"!=s||"106"!=n||a.isMobile?(m.errorCode=n,m.msg=e.errMsg,"105"==n?m.type=y.passwordError:(m.type=y.usernameError,"100"==n&&(m.msg="鐜板湪鎴戞湁鐐瑰繖锛岃绋嶅悗鍐嶈瘯")),o(m)):a.submit()}})):o(m)):o(m)},y.checkForm=function(e,t){y.formSubmit(e,t,"post")},y.checkJsonpForm=function(e,t){y.formSubmit(e,t,"jsonp")},y.logout=function(e,t){var r=new Array;r.push(c+"/login/logout.action?callback=?&version=2.0","&service=client_transaction","&from=",encodeURIComponent(e));r=r.join("");S.getJSON(r,function(e){"0"==e.errType?(e=e.sso,y.handleSso(e,0,"logout",null,null,t,null)):alert("鐜板湪鎴戞湁鐐瑰繖锛岃绋嶅悗鍐嶈瘯")})},y.isLoginedStatus=function(){for(var e=!1,t=document.cookie.split(";"),r=0;r<t.length;r++)if("verifycode"==t[r].split("=")[0].replace(/ /g,"")){e=!0;break}return e},y.registerSuccess="0";var h={errtype:"",msg:"",seqId:"",usrid:"",email:""};y.jsonpRegister=function(e,r){h={errtype:"",msg:"",seqId:"",usrid:"",email:""};var t=e.mailAdd.value,n=e.passWd.value,a=e.verificationCode.value,o=e.addons.value,e=new Array;e.push(c+"/api/register.action?callback=?","&mailAdd=",encodeURIComponent(t),"&passWd=",encodeURIComponent(n),"&verificationCode=",encodeURIComponent(a),"&addons=",encodeURIComponent(o));e=e.join("");S.getJSON(e,function(e){var t=e.errtype;"0"==t&&(h.seqId=e.seqId,h.usrid=e.usrid,h.email=e.email),h.errtype=t,h.msg=e.msg,r(h)})},x.passport=y}("https://reg.cctv.com",window);
