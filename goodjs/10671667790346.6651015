var isSessionStorageAvailable=function(){try{return!!window.sessionStorage}catch(e){return!1}}();isSessionStorageAvailable&&"true"===sessionStorage.getItem("DefaultSignInCalledBefore")&&(document.body.style.display="block"),$(function(){HomePage.init();var e,n,o="NewUserView";e=document.getElementById("sharedClientStartupContext"),n=e&&e.textContent&&JSON.parse(e.textContent)||{},(e=document.getElementById("unauthConfig"))&&e.textContent&&JSON.parse(e.textContent),n={ariaCollectorUrl:n.ariaCollectorUrl,ariaTenant:n.ariaTenant,authTypeString:"",authVersion:"",cookieConsentRequired:!1,corpNet:n.corpNet,correlationId:n.correlationId,deploymentEnvironment:n.deploymentEnvironment,devEnvironment:n.devEnvironment,features:"",flights:n.flights,geoName:n.geoName,puid:"",requestOrigin:n.requestOrigin,serverBuildDate:n.buildDateUtc,serverBuildId:n.buildId,sessionId:n.sessionId,tenantId:"",testTraffic:n.testTraffic},StandaloneAriaLogger.Logger.Initialize(n,!0),awa&&awa.init({coreData:{appId:"www.office.com-unauth",pageName:"UnauthOhp"}}),n={behavior:(n=[]).length?awa.behavior.EXPERIMENTATION:0,pageTags:{metaTags:{expid:n.join(","),expname:[].join(","),variationid:[].join(","),variationname:[].join(",")}}},awa&&awa.ct.captureContentUpdate(n),$("button, a").click(function(){var e=$(this).attr("id");e&&StandaloneAriaLogger.Logger.LogUnauthClick(o,e)}),StandaloneAriaLogger.Logger.LogEvent("unauth_generic","unauth_page_loaded"),isSessionStorageAvailable&&"true"===sessionStorage.getItem("DefaultSignInCalledBefore")&&StandaloneAriaLogger.Logger.LogUnauthPageView(o)});var viewType,myConfigOptions,el=document.getElementById("unauthConfig"),config=el&&JSON.parse(el.textContent)||{},signInUrl=config.loginUrl;function setShellOptions(e){window.msCommonShell?window.msCommonShell.load(e):window.onShellReadyToLoad=function(){window.onShellReadyToLoad=null,window.msCommonShell.load(e)}}isSessionStorageAvailable&&"true"!==sessionStorage.getItem("DefaultSignInCalledBefore")?"SignoutUserView"!==(viewType="NewUserView")&&(myConfigOptions={msaConfig:{replyUri:"https://www.office.com/",host:"login.live.com"},aadConfig:{replyUri:"https://www.office.com/",host:"login.microsoftonline.com",appId:"4345a7b9-9a63-4910-a426-35363201d503"},preferredIdp:AuthType.aad,enableConsoleLogging:!1,msaFedEnabled:!0},DefaultSignInHandler.DefaultSignInAdapter.signIn(signInUrl,myConfigOptions,500).then(function(e){isSessionStorageAvailable&&sessionStorage.setItem("DefaultSignInCalledBefore","true"),e?window.location.href=e:(document.body.style.display="block",StandaloneAriaLogger.Logger.LogUnauthPageView(viewType))})):StandaloneAriaLogger.Logger.LogEvent("unauth_generic","DefaultSignin_Called_Before");var SendMeControlSignInEvent=function(){awa&&awa.isInitialized&&awa.ct.capturePageAction($("#meControl"),{isManual:!0,behavior:awa.behavior.SIGNIN,actionType:awa.actionType.CLICKLEFT}),"undefined"!=typeof StandaloneAriaLogger&&void 0!==StandaloneAriaLogger.Logger&&void 0!==StandaloneAriaLogger.Logger.LogUnauthClick&&StandaloneAriaLogger.Logger.LogUnauthClick("NewUserView","meLnkSignin")};function SetConsent(){}var shellOptions={meControlOptions:{rpData:{aadInfo:{signInUrl:signInUrl,signOutUrl:"https://login.microsoft.com/logout.srf"},msaInfo:{meUrl:null},preferredIdp:"aad"},events:{onEventLog:function(e){"SignIn"===e&&(SetConsent(),SendMeControlSignInEvent())}}}};setShellOptions(shellOptions),window.history&&window.history.replaceState&&config.pathAndQuery&&window.history.replaceState(window.history.state||{},"",config.pathAndQuery);var aadUserForgetUrlFormat="https://login.microsoftonline.com/forgetuser?sessionid=";function clearStorage(){try{var e,n;window&&window.sessionStorage&&clearStorageWithExceptions(window.sessionStorage,["DefaultSignInCalledBefore","msameid"]),window&&window.localStorage&&(e="",document&&document.getElementById&&((n=document.getElementById("workload"))&&(e=n.innerText)),e&&"pwa"===e?clearStorageWithExceptions(window.localStorage,["officeHome-"]):clearStorageWithExceptions(window.localStorage))}catch(e){console.log(e)}}function clearStorageWithExceptions(t,a){if(a&&0!==a.length){for(var i=[],e=0;e<t.length;e++)i.push(t.key(e));for(e=0;e<i.length;e++)!function(e){var n=i[e],o=!0;a.forEach(function(e){-1!==(null==n?void 0:n.lastIndexOf(e))&&(o=!1)}),n&&o&&t.removeItem(n)}(e)}else t.clear()}clearStorage();
