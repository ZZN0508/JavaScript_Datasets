window.b$=window.b$||{},window.b$.module=window.b$.module||function(){throw new Error("b$.module is not defined")}(),window.b$.module("gadgets.pubsub",function(){"use strict";var n=window.b$.Class,u=n.extend(function(){this.callbacks=[]},{queue:[],subscribe:function(s){this.callbacks.push(s),this.queue.forEach(function(n){s(n)})},unsubscribe:function(s){this.callbacks=s?this.callbacks.filter(function(n){return n!=s}):[]},publish:function(s,n){n&&this.flush(),this.callbacks.forEach(function(n){n(s)}),this.queue.push(s)},flush:function(){this.queue=[]}}),c=new(n.extend(function(){this.channels={}},{subscribe:function(n,s){this.channels[n]||(this.channels[n]=new u),this.channels[n].subscribe(s)},unsubscribe:function(n,s){this.channels[n]&&this.channels[n].unsubscribe(s)},publish:function(n,s,i){this.channels[n]||(this.channels[n]=new u),this.channels[n].publish(s,i)},flush:function(n){this.channels[n]&&this.channels[n].flush()}}));this.publish=function(n,s,i){c.publish(n,s,i="boolean"!=typeof i?!0:i)},this.subscribe=function(n,s){c.subscribe(n,s)},this.unsubscribe=function(n,s){c.unsubscribe(n,s)},this.flush=function(n){c.flush(n)}});
