!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("wafer-uac",[],t):"object"==typeof exports?exports["wafer-uac"]=t():(e.wafer=e.wafer||{},e.wafer.wafers=e.wafer.wafers||{},e.wafer.wafers["wafer-uac"]=t())}("undefined"!=typeof self?self:this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="https://s.yimg.com/aaq/wf/",t(t.s="./src/entry.js")}({"./src/base.js":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=function(){function e(e,t){var n=[],i=!0,a=!1,r=void 0;try{for(var o,d=e[Symbol.iterator]();!(i=(o=d.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){a=!0,r=e}finally{try{!i&&d.return&&d.return()}finally{if(a)throw r}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=window.wafer,c=s.base,l=s.features,u=s.utils,f=s.WaferBaseClass,h=u.fetchWithCache,y=u.elementInView,p=u.throttle,m=u.convertNodeListToArray,w="/_td/remote",v=["scroll"],g={adType:"gemini",apiKey:"C5VPNN3HH87ZR8M33TBQ"},b=100,_={uac:"uac:item",gemini:"gemini:item"},A=["onAdReady","loadElement","bindMutationObserver","injectMarkupBesideNode","destroy"],E={GEMINI_NO_ADS:"GEMINI: NO ADS RETURNED"},k=[["display_0",0],["display_480",480],["display_754",754],["display_900",900],["display_1128",1128],["display_1265",1265],["display_1450",1450]],N=function(){var e=document.documentElement.clientWidth,t=k[0],n=!0,i=!1,a=void 0;try{for(var r,o=k.entries()[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var s=d(r.value,2),c=s[0];e>d(s[1],2)[1]&&(t=k[c])}}catch(e){i=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw a}}return t},O=function(e){var t=e.ads,n=void 0===t?{}:t;if(0===Object.keys(n).length)return{};var i=document.documentElement.clientWidth,a=n.display_0||{},r=!0,o=!1,s=void 0;try{for(var c,l=k.values()[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var u=d(c.value,2),f=u[0],h=u[1],y=n[f];y&&(i>h&&y&&(a=y))}}catch(e){o=!0,s=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw s}}return a},C=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,{},{})),r=e.dataset.wfUacConfig,o=void 0===r?{}:r;n._util={elem:e,trigger:e.getAttribute("data-wf-trigger")||"onLoad",tdv2AjaxPath:e.getAttribute("data-wf-tdv2-path")||w},n._state={isLoaded:!1,hasAdsRotate:null!==window.location.host.match(/aol.com/)};try{n.adConfig=JSON.parse(o)}catch(e){return a(n)}return window.headerBiddingConfigured=window.headerBiddingConfigured||!1,n.isMobile()&&n.setupMobileHeaderBidding(),A.forEach(function(e){n[e]=n[e].bind(n)}),n.syncWithThrottle=p(function(){n.loadElement()},b,n),n.activeBreakpoint=N(),n.addWaferListeners(),n.loadElement(),n}return r(t,e),o(t,[{key:"isMobile",value:function(){var e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t=Math.max(document.documentElement.clientHeight,window.innerHeight||0);return e>t&&t<=500&&e<=900||e<t&&e<=500&&t<=900}},{key:"setupMobileHeaderBidding",value:function(){this._util.elem;if(!window.headerBiddingConfigured&&window.atwHeaderBid){window.headerBiddingConfigured=!0;var e=m(document.getElementsByClassName("wafer-uac")),t=[],n=[],i=!0,a=!1,r=void 0;try{for(var o,d=e[Symbol.iterator]();!(i=(o=d.next()).done);i=!0){var s=o.value,c=s.dataset.wfUacConfig,l=void 0===c?{}:c,u=void 0;try{u=JSON.parse(l)}catch(e){return}var f=u,h=f.ads,y=h.display_0;if(void 0!==y){var p=y.magicNumber,w=y.width,v=y.height;p&&(!function(e){var t=e.width,n=void 0===t?"":t,i=e.height,a=void 0===i?"":i,r=Number(n),o=Number(a);return"mm"===String(n).toLowerCase()||728===r&&90===o||300===r&&250===o||320===r&&50===o}(y)||n.indexOf(p)>-1||(n.push(p),w&&"mm"===w.toLowerCase()?t.push({mn:p,width:"mm"}):w&&v&&t.push({mn:p,sizes:[[w,v]]})))}}}catch(e){a=!0,r=e}finally{try{!i&&d.return&&d.return()}finally{if(a)throw r}}window.atwPreBid={resizePortrait:"1",mns:t},window.atwHeaderBid()}}},{key:"onAdReady",value:function(e){var t=this,n=e.adConfig,i=e.placementNode,a=i.closest(".wafer-uac");a&&(a.classList.add("is-ready"),!0===n.isBlank?a.classList.add("is-blank"):a.classList.remove("is-blank"),i.id.indexOf("ad_dl")>=0&&this.getDLAdData(i).then(function(e){var n=t.adConfig.index;return e.index=n,t.fetchSlideMarkup({modId:"tdv2-wafer-dl",ctrl:"DLPagination",data:e})}).then(function(e){var n=e.html;t.injectMarkupBesideNode(i,n)}))}},{key:"addWaferListeners",value:function(){var e=this;window.wafer.ready(function(t){v.forEach(function(t){window.wafer.on(t,e.syncWithThrottle)})})}},{key:"removeWaferListeners",value:function(){var e=this;window.wafer.ready(function(t){v.forEach(function(t){window.wafer.removeListener(t,e.syncWithThrottle)})})}},{key:"handleResize",value:function(){if(!document.getElementById("act-labs-holder")){var e=N();d(e,2)[1]!==d(this.activeBreakpoint,2)[1]&&(this.activeBreakpoint=e,this._state.isLoaded=!1,this.addWaferListeners(),this.loadElement())}}},{key:"loadElement",value:function(){var e=this._util,n=e.elem,i=e.trigger,a=this._state,r=a.isLoaded,o=a.hasAdsRotate;if(!r&&("onView"!==i||y(n,{},c.viewport))){this._state.isLoaded=!0,this.removeWaferListeners();var d=this.adConfig,s=d.placement,u=d.index,f=document.getElementById(s),h=O(this.adConfig);if(h){var p=h.isGeminiAd,m=h.geminiApiKey,w=void 0===m?g.apiKey:m,v=h.geminiAdUnitCode,b=h.magicNumber,A=h.adSetType,E=h.height,k=h.width,N=h.dynamicSizes;if(p)return void this.fetchGeminiAd({apiKey:w,adType:g.adType,adUnitCode:v}).then(this.fetchMarkupAndRenderAd(_.gemini,u,f));if(b)try{if(l.mutationObserver&&this.bindMutationObserver(),o&&window.adsRotateMult(s),N&&""!==N)return void window.htmlAdWHDyn(b,N,A,s);window.htmlAdWH(b,k,E,A,s),n.classList.add(t.prototype.configs.successClass)}catch(e){this.destroy()}}}}},{key:"bindMutationObserver",value:function(){var e=this,t=this._util.elem,n=this.adConfig.placement,i={childList:!0,attributes:!0,attributeFilter:["style"],subtree:!0},a=document.getElementById(n),r=O(this.adConfig),o=0,d=!0,s=!1,c=!(t.id.indexOf("ad_dl")>=0&&"filelesstext"===r.adSetType);new MutationObserver(function(n){if(o>=20)return void this.disconnect();n.length>20&&(n=n.slice(n.length-20));for(var i=0;i<n.length;i++){var l=n[i],u=l.target;c?"childList"===l.type?(l.addedNodes&&l.addedNodes.length&&"DIV"===l.addedNodes[0].tagName&&l.addedNodes[0].className.indexOf("gemini")>=0&&(u=l.target.previousElementSibling),(d=u.getBoundingClientRect().height<50)&&"0"!==r.adSetInView&&(r.adIsBlank=!1)):"attributes"===l.type&&"style"===l.attributeName&&("none"===t.style.display||"0px"===t.style.height)&&a.getBoundingClientRect().height<50&&(r.adIsBlank=!0):"childList"===l.type&&l.addedNodes.length&&"DIV"===l.addedNodes[0].tagName&&(c=!0,s=!0)}c&&e.onAdReady({elem:t,adConfig:r,placementNode:a}),r.isBlank=d,s&&this.disconnect(),o++}).observe(a,i)}},{key:"fetchMarkupAndRenderAd",value:function(e,t,n){var i=this;return function(a){a.placementType=e,a.index=t,i.fetchSlideMarkup({modId:"tdv2-wafer-dl",ctrl:"DLPagination",data:a}).then(function(e){var t=e.html;i.injectMarkupBesideNode(n,t)})}}},{key:"fetchGeminiAd",value:function(e){var t=this,n=e.apiKey,i=e.adUnitCode,a=e.adType;return n&&a===g.adType&&i?new Promise(function(e,a){var r=window.location.href.match(/http:\/\/localhost/)?"www.aol.com":window.location.href,o="?cb=__fetchGeminiAdCb&local=en_us&agentVersion=205&adTrackingEnabled=true&totalAds=10&publisherUrl="+r+"&apiKey="+n+"&adUnitCode="+i;window.__fetchGeminiAdCb=function(n){try{e(t.extractGeminiAdData(n))}catch(e){a(e)}};var d=document.createElement("script");d.src="https://ads.yap.yahoo.com/nosdk/wj/v1/getAds.do"+o,document.getElementsByTagName("head")[0].appendChild(d)}):Promise.reject(new Error("FetchGeminiAd failed: required params (apiKey, adUnitCode, adType)"))}},{key:"extractGeminiAdData",value:function(e){if(!e||e.error)throw new Error(e);var t=e.ads;if(!t||t.length<=0)throw new Error(E.GEMINI_NO_ADS);var n=Math.floor(Math.random()*t.length);return void 0!==t[n]?t[n]:t[0]}},{key:"fetchSlideMarkup",value:function(e){var t=e.mode,n=void 0===t?"json":t,i=e.modId,a=e.ctrl,r=e.data,o=this._util.tdv2AjaxPath,d=JSON.stringify({m_mode:n,m_id:i,ctrl:a,data:[r]});return h(o,{body:d})}},{key:"injectMarkupBesideNode",value:function(e,t){try{var n=document.createElement("div");n.innerHTML=t;var i=n.querySelector(".slides .dl__slide");n.innerHTML=i&&i.innerHTML||t,e.nextSibling&&e.parentNode.removeChild(e.nextSibling),e.insertAdjacentElement("afterend",n),setTimeout(function(){c.emitWaferEvent("uac:adinjected",{elem:e.parentNode,ad:e,adMarkup:n}),c.sync(e.parentNode)},25)}catch(e){this.destroy()}}},{key:"isGeminiPlacement",value:function(e){return e&&("gemini"===e||"NATIVE"===e)}},{key:"getDLAdData",value:function(e){var t=this,n=JSON.parse(e.getElementsByClassName("ad-code")[0].textContent),i=n.adType,a=n.apiKey,r=n.adUnitCode,o=n.views,d=void 0===o?[]:o;return new Promise(function(e,o){if(!t.isGeminiPlacement(i))return n.placementType=_.uac,e(n);t.fetchGeminiAd({apiKey:a,adUnitCode:r,adType:i}).then(function(t){return t.tag=t.tag||{},t.tag.imprTrackingUrl=t.tag.imprTrackingUrl||[],t.tag.imprTrackingUrl=t.tag.imprTrackingUrl.concat(d),t.placementType=_.gemini,e(t)}).catch(function(e){o(e)})})}},{key:"destroy",value:function(){this._state.isLoaded=!1}}]),t}(f);C.prototype.configs={selector:".wafer-uac",successClass:"wafer-uac-done"},t.default=C,e.exports=t.default},"./src/controller.js":function(e,t,n){"use strict";function i(){return s=a(n("./src/base.js"))}function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s,c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=window.wafer,f=u.controllers.WaferBaseController,h=u.utils,y=h.bindEvent,p=h.loadScriptAsync,m=h.getConfigFromJSONScriptNode,w=[9,24,39],v=["fi_1374016173","fi_ad_leaderboard"],g=0,b=function(){return"function"==typeof window.htmlAdWH},_=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.root,a=void 0===n?document:n,d=e.selector,l=void 0===d?".wafer-uac":d;r(this,t);var u=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{root:a,selector:l,WaferClass:(s||i()).default})),f=m(document.getElementById("wafer-uac-config"));return u._utils=c({},u._util,f),u._state=c({},u._state,{asyncUacLibLoadComplete:!1}),u.ensureUacLibraryIsReady().then(function(){u.sync()}).catch(function(e){}),window.wafer.ready(function(){u.addEventListeners()}),u}return d(t,e),l(t,[{key:"ensureUacLibraryIsReady",value:function(){var e=this,t=this._state.asyncUacLibLoadComplete,n=this._utils,i=n.adsWrapperScript,a=n.useIntlAdsWrapper,r=void 0!==a&&a,o=r?"https://s.aolcdn.com/ads/adsWrapperIntlAOL.min.js":"https://s.aolcdn.com/ads/adsWrapperAOL.min.js";return t||b()?Promise.resolve(!0):new Promise(function(t,n){p({src:i||o},function(i){if(i)return e._state.asyncUacLibLoadComplete=!0,void n();e._state.asyncUacLibLoadComplete=!0,t(!0)})})}},{key:"reloadAd",value:function(e){var t=e.detail;if(t&&window.adsReloadAd){var n=document.getElementById(t);n&&window.adsReloadAd(n)}}},{key:"loadElement",value:function(e,t){t&&this.sync()}},{key:"willValidate",value:function(e){var t=this._state.elementInstances;e.forEach(function(e){var n=t.get(e);n.instance._state.isLoaded||n.instance.loadElement()})}},{key:"addEventListeners",value:function(){y(window,"uac:reload",this.reloadAd),window.wafer.on("dl:change",this.refreshAds)}},{key:"refreshAds",value:function(e){var t=e.elem,n=e.meta,i=void 0===n?{index:!1}:n;if(t.classList.contains("dl")&&i.index){var a=t.dataset||{},r=a.wfAdRefreshLimit,o=a.wfAdRefreshIndexes,d=a.wfAdRefreshIds,s=3,c=w,l=v;if(r){var u=parseInt(r,10);window.isNaN&&!window.isNaN(u)&&(s=u)}if(o)try{c=JSON.parse(o)}catch(e){}if(d)try{l=JSON.parse(d)}catch(e){}g>=s||-1===c.indexOf(i.index)||!window.adsReloadAd||!window.adsRotateMult||(g++,l.forEach(function(e){var t=document.getElementById(e),n=!!document.getElementById("act-labs-holder"),i=n&&"fi_ad_leaderboard"===e;t&&!i&&(window.adsReloadAd&&window.adsReloadAd(t),window.adsRotateMult&&window.adsRotateMult(e))}))}}}]),t}(f);_.prototype.configs={selector:".wafer-uac",successClass:"wafer-uac-done",allowPrefetch:!0},t.default=_,e.exports=t.default},"./src/entry.js":function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a;t.default=new((a||function(){return a=i(n("./src/controller.js"))}()).default)({}),e.exports=t.default}})});