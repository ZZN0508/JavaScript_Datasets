"use strict";Array.from||(Array.from=function(){function a(e){return"function"==typeof e||"[object Function]"===t.call(e)}function s(e){return e=function(e){e=+e;return isNaN(e)?0:0!=e&&isFinite(e)?(0<e?1:-1)*Math.floor(Math.abs(e)):e}(e),Math.min(Math.max(e,0),9007199254740991)}var t=Object.prototype.toString;Math.pow(2,53);return function(e){var t=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var i,n=1<arguments.length?arguments[1]:void 0;if(void 0!==n){if(!a(n))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(i=arguments[2])}for(var r,o=s(t.length),l=a(this)?Object(new this(o)):Array(o),d=0;d<o;)r=t[d],l[d]=n?void 0===i?n(r,d):n.call(i,r,d):r,d+=1;return l.length=o,l}}()),function(e){function t(e){(function(e,t){v("dynamicAdsItems",x);var i=x[t].landingurl,n=x[t].productid,t=x[t].summary;T.innerHTML+='<li id="'+n+'" data-url="'+i+'"><div class="boxLine"></div><div id="img'+n+'" class="adImg"></div><div class="adText"><div class="title">'+t.substr(0,33)+'...</div><div class="cta">按此閱讀更多></div></div></li>',c("img"+n).style.background='url("'+$AD.config.Format.directory+'anim_loading_sm.gif") center center no-repeat',c(n).style.height=y+"px",o(n,e)})(x[e=e].imageurl,e),x[e].imgLoaded=!0}function i(){for(var e=T.querySelectorAll("li"),t=m.div.offsetWidth,i=0;i<e.length;i++)e[i].style.width=t+"px";N=t,T.style.width=t*I+"px",T.style.marginLeft=-N+"px"}function n(){E=!0===w?setInterval(function(){r("nextAd",!1)},1e3*b):null}function r(e,t){var i="prevAd"==e?N:-N,n="prevAd"==e?"Dynamic Ads Previous Button Clicked":"Dynamic Ads Next Button Clicked";u.removeEventListener("click",B.controlPrev),p.removeEventListener("click",B.controlNext),h.innerHTML="@keyframes slideAnimate{from{transform:translateX(0);}to{transform:translateX("+i+"px);}}",T.style.animation="slideAnimate 0.5s ease-in forwards",t&&$AD.event(n,A),function(){for(var e=0;e<I;e++)x[e].imgLoaded||(x[e].imgLoaded=!0,o(x[e].productid,x[e].imageurl))}(),setTimeout(function(){T.style.animation="",D="prevAd"==e?(T.insertBefore(T.childNodes[I-1].cloneNode(!0),T.firstChild),T.removeChild(T.lastChild),D--<=1?I:D):(T.appendChild(T.firstChild.cloneNode(!0)),T.removeChild(T.firstChild),D++>=I?1:D),u.addEventListener("click",B.controlPrev),p.addEventListener("click",B.controlNext),f.div.textContent=D+" / "+I,t?l("userClick"):l()},550)}function o(e,t){var i,n;c(e).style.background="none",""!==t&&"null"!==t&&void 0!==t&&(i=new Image,n=c(e).querySelectorAll(".adImg"),i.onload=function(){c(n[0].id).style.background='url("'+t+'") center top / cover no-repeat'},i.src=t,i.onerror=i.onabort=function(){c(e).innerHTML='<p class="noPhoto">No Photo</p>'})}function l(e){for(var t=T.querySelectorAll("LI"),i=[],n=0;n<t.length;n++)if(t[n].offsetLeft==N)for(var r,o=t[n].id.replace(L,""),l=k+o,d={firstShow:l+" : First Show",userClick:l+" : User Click"},a=0;a<I;a++)if(1<(r=x[a]).productid.indexOf(o)&&(i.push(r),1!=I&&("userClick"==e&&1==i.length&&$AD.event(d.userClick,C),!i[0].shown&&0<i.length))){for(var s=0;s<i.length;s++)i[s].shown=!0,i[s].firstshow=!0;""!==i[0].dotpixeltype&&"impression"==i[0].dotpixeltype&&""!==i[0].dotpixel&&g.dotPixel(o,g),$AD.event(d.firstShow,C)}}var d=e[$AD.config.Creative.library.espresso.version],a=(d.Align,d.Remove,d.Border,d.Load,d.DelivrUtils,d.Sprite),s=(d.Apply,d.Create,d.SVG),d=(d.EventManager,d.UA,e.utils),c=d.byId,v=d.logger,h=document.createElement("style");document.head.appendChild(h);var p,u,f,g=e.dynamicAdConfig,m=g.mainDiv,x=g.dynamicAdsItems,y=(g.formatWidth,g.formatHeight),d=(g.hasContents,g.hasRandom),w=g.hasAutoplay,b=g.speed,e=g.itemsNum,A=g.userInteraction,C=g.nonInteraction,k=g.viewCollection,L=/adid_|fake_adid_/,I=Math.min(e,x.length),E=null,D=1,N=null;!0===d&&g.shuffle(x),x.splice(I);var M=Array.from(x);if(v("originalDAIS",M),x.unshift(M[I-1]),x.splice(-1,1),I<3)for(var P,S=1;0<=S;S--)(P=Object.assign({},M[S])).productid="fake_"+P.productid,x.push(P),I=x.length;d=new a("headerDiv");d.style={position:"relative",width:"calc(100% - 22px)",height:"20px"},d.div.innerHTML=g.adTitle,m.addChild(d);d=new a("brandBar");d.style={background:"#500095",top:0,left:0,width:"calc(100% + 2px)",height:"2px",zIndex:9999},m.addChild(d);d=new a("sliderDiv");d.style={width:"100%",height:y+"px",zIndex:2},m.addChild(d);var T=document.createElement("ul");d.addChild(T);var B={controlNext:function(){r("nextAd",!0)},controlPrev:function(){r("prevAd",!0)},controlEnter:function(){p.div.style.opacity=.8,u.div.style.opacity=.8,clearInterval(E)},controlLeave:function(){p.div.style.opacity=.5,u.div.style.opacity=.5,n()}};window.addEventListener("resize",i),function(){for(var e=0;e<I;e++)t(e);1<I?(function(){var e=new a("controller");e.style={top:"18px",left:"auto",right:"12px",width:"auto",height:"20px",color:"#abaeb7",overflow:"hidden",zIndex:9999},m.addChild(e),p=new a("controlNext"),(u=new a("controlPrev")).style=p.style={position:"relative",cursor:"pointer",width:"20px",height:"19px",marginLeft:"2px",border:"1px solid #abaeb7",boxSizing:"border-box",float:"right"},p.style={transform:"scaleX(-1)"},e.addChild(p),e.addChild(u),m.addEventListener("mouseenter",B.controlEnter),m.addEventListener("mouseleave",B.controlLeave);var t=new s("controlNextIcon",'<?xml version="1.0" encoding="utf-8"?><svg version="1.1" id="sailormoon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 36 36" style="enable-background:new 0 0 36 36;" xml:space="preserve"><style type="text/css">.cls-1{fill:#abaeb7;}</style><g><path class="cls-1" d="M14.7 3.58 21.63 3.58 13.38 15.42 21.17 27.27 14.35 27.27 6.51 15.35 14.7 3.58Z"/></g></svg>'),i=new s("controlPrevIcon",'<?xml version="1.0" encoding="utf-8"?><svg version="1.1" id="sailormoon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 36 36" style="enable-background:new 0 0 36 36;" xml:space="preserve"><style type="text/css">.cls-1{fill:#abaeb7;}</style><g><path class="cls-1" d="M14.7 3.58 21.63 3.58 13.38 15.42 21.17 27.27 14.35 27.27 6.51 15.35 14.7 3.58Z"/></g></svg>');p.addChild(t),u.addChild(i),t.scale=i.scale=.45,t.x=i.x=(20-t.div.offsetWidth)/2,t.y=i.y=(19-t.div.offsetHeight)/2,(f=new a("numbertextDiv")).style={position:"relative",height:"19px",width:"auto",marginLeft:"2px",padding:"3px 4px 0 0",float:"right"},e.addChild(f),f.div.textContent=D+" / "+I}(),n(),u.addEventListener("click",B.controlPrev),p.addEventListener("click",B.controlNext)):clearInterval(E),T.style.height="165px",i(),l(),T.addEventListener("click",function(e){e.preventDefault();var t=e.target.parentNode;if("LI"===t.tagName){for(var e=t.dataset.url,i=t.id,n=0;n<I;n++)x[n].productid==i&&""!==x[n].dotpixeltype&&"click"==x[n].dotpixeltype&&window.ACT.DotPixel(i);void 0!==e&&!1!==e&&(t=g.clickCollection+i.replace(/^adid/,""),$AD.click(t,{overrides:{url:e}}))}})}()}(window.ACT);
