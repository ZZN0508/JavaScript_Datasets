(()=>{"use strict";var a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),r=new Uint8Array(16);const t=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,s=function(e){return"string"==typeof e&&t.test(e)};for(var e,n,o,i,c=[],d=0;d<256;++d)c.push((d+256).toString(16).substr(1));function l(e,t,n){var o=(e=e||{}).random||(e.rng||function(){if(!a)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(r)})();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=o[i];return t}return function(e,t){t=1<arguments.length&&void 0!==t?t:0,t=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!s(t))throw TypeError("Stringified UUID is invalid");return t}(o)}const u="HABU_1P_ID",m="__Habu_questionList",p="__Habu^bowline",g="siteConfig",h="habu-question-slot",f={missingContainer:new Error("Missing Parent Container"),missingConfiguration:new Error("Missing configuration ID")},y={recordAnswers:"RECORD_ANSWER",recordEmail:"RECORD_EMAIL",transmitQuestions:"SENDQ",wave:"WAVE"},w="cringle",b="forefoot",_="4.2.0",I=e=>({propertyID:e.propertyID,quarterdeckID:e.ID,organizationID:e.orgID,domain:window.location.hostname,pageUrl:`${window.location.hostname}${window.location.pathname}`});function v(t,n,o){if(0!==o)for(let e=0;e<n.length;e+=1){if(n[e]===t)return n[e];if(n[e]instanceof Object){var i=E(t,n[e],o-1);if(i)return i}else if(n[e]instanceof Array){i=v(t,n[e],o-1);if(i)return i}}}function E(t,n,o){if(0!==o){var i=Object.keys(n);for(let e=0;e<i.length;e+=1){if(i[e]===t)return n[i[e]];if(n[i[e]]instanceof Object){var a=E(t,n[i[e]],o-1);if(a)return a}else if(n[i[e]]instanceof Array){a=v(t,n[i[e]],o-1);if(a)return a}}}}const C=async(e,t={},n=3)=>{var o=new Headers([["Accept","application/json"],["Access-Control-Allow-Credentials","true"]]);try{const n=await fetch(e,{credentials:"include",headers:o,...t});return n.ok?n.json():void 0}catch(o){return 1<n?C(e,t,n-1):void 0}},A=(e,t)=>{var n=new Headers([["Accept","application/json"],["Access-Control-Allow-Credentials","true"],["Content-Type","application/x-www-form-urlencoded"]]);return fetch(e,{method:"POST",mode:"no-cors",credentials:"include",headers:n,body:t})},O=()=>document.cookie.split(";").reduce((e,t)=>Object.assign(e,{[t.split("=")[0].trim()]:t.split("=")[1]}),{}),D=()=>l(),T=t=>Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&"),S=(e="")=>{try{return JSON.parse(e)}catch(e){return{}}},R=()=>{const e=document.querySelector("[data-confuid]");return e?e.getAttribute("data-confuid"):void 0},U=(e,t)=>{if("string"==typeof e&&0!==e.length)try{return e.split(".").reduce((e,t)=>{if(0<=t.indexOf("[")){var n=t.slice(t.indexOf("[")+1,t.indexOf("]"));return e[parseInt(n,10)]}return e[t]},t)}catch(e){return e instanceof TypeError?void 0:void console.warn(e)}},H="https://fulcrum-antenna.imhd.io/collect/registration/3087a8ff-41b4-401c-98a9-9a4c8706a3ca/imhd",N="https://fulcrum-antenna.imhd.io/collect/registration/2b85ffa6-2fbd-4fad-93f7-dba57b2c782b/imhd",P={adh_asics:"https://fulcrum-antenna.imhd.io/getuid/imhd/google-adh?account_id=asics_adh",amazon_us:"https://fulcrum-antenna.imhd.io/getuid/imhd/amazon-us",liveramp:"https://fulcrum-antenna.imhd.io/getuid/imhd/liveramp",throtle:"https://fulcrum-antenna.imhd.io/getuid/imhd/throttle"},j={INFO:"Info",WARN:"Warn",ERROR:"Error"},k=(e=.1)=>1<Math.random()+e?(e={})=>{let t;t=e instanceof Array?{msg:e.join("; "),pageUrl:`${window.location.hostname}${window.location.pathname}`,type:j.INFO}:"object"!=typeof e?{msg:e,pageUrl:`${window.location.hostname}${window.location.pathname}`,type:j.INFO}:e;e=Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&");return A("https://fulcrum-antenna.imhd.io/collect/jserrors/2041517b-a8db-4bd8-902c-a5eea719db61/imhd",e)}:()=>{},$=j;function B(e){e=e||L()||D();(e=>{const t=encodeURIComponent("HABU_1P_ID"),n=encodeURIComponent(e),o=new Date,i=o.getTime()+2592e7;o.setTime(i);e=`expires=${o.toUTCString()};max-age=25920000`;document.cookie=`${t}=${n};${e};path='/';secure; samesite=none`})(e),sessionStorage.setItem(u,e),localStorage.setItem(u,e)}function L(){var e=O().HABU_1P_ID,t=sessionStorage.getItem(u),n=localStorage.getItem(u);return e||t||n||null}function x(e){const t=function(){const t=[],n=()=>{},o=["fill","pop","reverse","shift","sort","splice","unshift"];return Object.getOwnPropertyNames(Array.prototype).filter(e=>o.includes(e)).forEach(e=>{t[e]=n}),t}(),n=(!(o=window.__Habu||S(localStorage.getItem(p)))||o.version!==_||1728e5<Date.now()-o.ts?null:o)||{};var o;n[e]&&Array.isArray(n[e].bowline)&&t.push(...n[e].bowline),n.huid=n.huid||L(),n.ts=Date.now(),n.version=_,n.ns=e,n[e]={ns:e,bowline:t},window.__Habu=n,localStorage.setItem(p,JSON.stringify(window.__Habu))}function q(e,t){window.__Habu[e].bowline.push(t),localStorage.setItem(p,JSON.stringify(window.__Habu))}const F=function(e,t,n){e=window.__Habu[e].bowline.filter(e=>e===t||"object"==typeof e&&Object.keys(e).includes(t)).pop();return e?e[t]:n},M=[{code:"identity_management"},{code:"targeted_advertising"},{code:"personalization_optimization"},{code:"segmentation"},{code:"modeling"},{code:"activation"},{code:"analytics_insights"},{code:"data_sales"}],J=e=>{const t=[];return L()&&t.push({type:"HABU_1P_ID",userID:L()}),window.__Habu.huid&&t.push({type:"HABU_3P_ID",userID:window.__Habu.huid}),e&&(B(e),t.push({type:"CLIENT_ID",userID:e})),t},Q={getConsent:([e,n,o,t])=>{e=F(e,g);let i,a;t?(i="CLIENT_ID",a=t):L()?(i="HABU_1P_ID",a=L()):window.__Habu.huid?(i="HABU_3P_ID",a=window.__Habu.huid):o({success:!1,error:"Missing Identity",flags:M}),C(`https://origin-gangway.habu.com/gangway/${e.orgID}/user-consent/type/${i}/user/${a}`,{method:"GET"},1).then(e=>{var t=e&&e.processingActivitiesUserConsent;e&&t?t&&0!==t.length?n({success:!0,flags:t}):o({success:!1,error:"Consent not set",flags:M}):o({success:!1,error:"Internal Service Error: Gangway. Please contact us",flags:M})}).catch(e=>o({success:!1,flags:M,error:e}))},setConsent:([e,t,n,o,i])=>{if(!i)return n(new Error("Missing consent signals"));if(!Array.isArray(i))return n(new Error("Expected Array"));if(0===i.length)return n(new Error("Empty Array"));const a=F(e,g),r=I(a),s="boolean"==typeof i[0]?M.map(e=>({...e,allowed:i[0]})):i,c={...r,identities:JSON.stringify(J(o)),consentJson:JSON.stringify(s)};return q(e,{CONSENT_FLAGS:c}),A("https://fulcrum-antenna.imhd.io/collect/consent/c2661ce9-a421-465e-8b08-4c3e223b8ce3/imhd",T(c)).then(()=>t({success:!0,flags:s})).catch(e=>n({error:e,success:!1}))},portability:([e,t,n,o])=>{const i=D(),a=F(e,g),r={...I(a),identities:JSON.stringify(J(o)),requestID:i};A("https://fulcrum-antenna.imhd.io/collect/portability/203f3c3a-c0cf-4629-9f76-9b70093059de/imhd",T(r)).then(()=>t({success:!0,requestID:i})).catch(e=>n({error:e,success:!1}))},rtbf:([e,t,n,o,i])=>{const a=D(),r=F(e,g),s={...I(r),identities:JSON.stringify(J(o)),requestID:a};i&&(s.email=i),A("https://fulcrum-antenna.imhd.io/collect/rtbf/7014021d-f07a-45d0-8bd8-c21d44eb291e/imhd",T(s)).then(()=>t({success:!0,requestID:a})).catch(e=>n({error:e,success:!1}))}},V={CAPTURE_CONSENT:"CAPTURE_CONSENT",GET_CONSENT:"GET_CONSENT",REQUEST_PORTABILITY:"REQUEST_PORTABILITY",REQUEST_RTBF:"REQUEST_RTBF"},W={CAPTURE_CONSENT:Q.setConsent,GET_CONSENT:Q.getConsent,REQUEST_PORTABILITY:Q.portability,REQUEST_RTBF:Q.rtbf},G=[],z=n=>(e,...t)=>(e=>!!V[e])(e)?(G.push([e,t]),new Promise((e,t)=>{setTimeout(()=>{((e,t,n)=>{var[o,i]=G.pop();W[o]([e,t,n,...i])})(n,e,t)},1e3)})):Promise.reject(new Error("Invalid Ask"));const Y=async e=>{var t=F(e,g);let n={};n={...n,...function(){const n=[void 0,null,""],e=new Date;let o={};if(window.location.ancestorOrigins&&0<window.location.ancestorOrigins.length)o={Url1:window.location.ancestorOrigins[0]};else{o={Url1:window.location.hostname,Url2:window.location.pathname,Url3:window.location.search};const n=["utm_source","utm_medium","utm_campaign"];window.location.search.substring(1).split("&").forEach(e=>{var[t,e]=e.split("=").map(e=>decodeURIComponent(e));n.includes(t)&&(o[t]=e)})}const t={...o,userAgent:window.navigator.userAgent,os:window.navigator.platform,tod:e.getTime(),dow:e.getUTCDay()},i={};return Object.keys(t).forEach(e=>{-1===n.indexOf(t[e])&&(i[e]=t[e])}),i}()};var o=function(){const t=document.getElementsByTagName("meta"),n={};let o,i;for(let e=0;e<t.length;e+=1)o=t[e].getAttribute("property")||t[e].getAttribute("name"),i=t[e].getAttribute("content"),o&&i&&(n[o.substring(o.indexOf(":")+1)]=i);return n}();0<Object.keys(o).length&&(n.metaTags=JSON.stringify(o));var i,e=L();e&&(n={...n,HABU_1P_ID:e}),o=(i=t.details)&&Object.hasOwnProperty.call(i,"partners")?Object.keys(P).filter(e=>i.partners.includes(e)).map(e=>P[e]):[],e=document.createDocumentFragment(),o.reduce((e,t)=>((e,t=document.createDocumentFragment())=>{const n=document.createElement("img");return e.forEach(e=>n.setAttribute(e.key,e.value)),t.appendChild(n),t})([{key:"width",value:"1px"},{key:"height",value:"1px"},{key:"src",value:t}],e),e),document.getElementsByTagName("head")[0].appendChild(e);var r,e=(r=t,e=new Promise(e=>e(void 0)),await(!r.details.bowline||!Array.isArray(r.details.bowline.highlights)||0===r.details.bowline.highlights.length?e:new Promise(n=>{let o,i=600;const a=setInterval(()=>{var e,t;o=function(e){if(e&&e.details){const t=e.details.bowline||{},o=U(t.match,window);if(o&&(o instanceof Array||o instanceof Object)){if(Array.isArray(t.highlights)){const i=[];return t.highlights.forEach(e=>{let t;var n;e.match?t=localStorage.getItem(e.match)||O()[e.match]||U(e.match,o):Array.isArray(o)?t=v(e.key,o,3):o instanceof Object&&(t=E(e.key,o,3)),t&&(n=Array.isArray(t)?t.join(","):t,i.push({key:e.key,value:n,type:e.type}))}),i}k(.05)({type:$.ERROR,msg:"Corrupt Configuration: "+t.highlights,action:"Bowline: Iterate through highlights",...I(e)})}}}(r),--i,o?(clearInterval(a),n(([e=[],t]=[o,["bowline","$type","$key"]],!Array.isArray(t)||!Array.isArray(e)||0===t.length?{}:e.map(n=>({[t.map(e=>{return t=n,(e=e).startsWith("$")?t[e.substring(1)]:e;var t}).join(".")]:n.value})).reduce((e,t)=>({...e,...t}),{})))):0===i&&(k()({type:$.ERROR,msg:"Cannot find client DL: "+r.details.bowline.match,action:"Bowline: Locate client dl",...I(r)}),n())},100)})));return e&&(n={...n,...e}),async function(e,t){return C("https://fulcrum-antenna.imhd.io/collect/pageview/297c2761-8f57-4e48-9846-c406b915ce0b/imhd",{method:"POST",mode:"no-cors",credentials:"include",body:T({...e,...I(t)}),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}(n,t)},Z={html:'\n    <div class="habu-entity-text">\n      <form action="#" autocomplete="on" onsubmit="window.__Habu.sendEmail(localStorage.getItem(\'__Habu_currentAnswerValue\')); return false;">\n        <label style="display: block">\n          <p class="template-questions">Sign up for exclusive content and offers so you can be first in the know.</p>\n          <input class="habu-email" name="user-input" type="email" placeholder="Email" required />\n        </label>\n        <br />\n        <button class="habu-primary-btn" type="submit"><span>Submit</span></button>\n      </form>\n    </div>\n  ',viewUrl:N,type:"email",submitUrl:H},K={html:'\n    <div class="habu-entity-text">\n      <form>\n        <p class="template-questions">Thank You!</p>\n      </form>\n    </div>\n  ',type:"neutral",viewUrl:!1},X=k(.1),ee=()=>document.getElementById(h),te=e=>{window.__Habu.widgetConfigID=e||R()},ne=()=>window.__Habu.widgetConfigID,oe=(()=>{const n={},o=L();return function(e){if(n[e])return n[e];{const t={widgetConfigID:e};return o&&(t.userID=o),n[e]=t,n[e]}}})();async function ie(){var e=ne(),e=await C("https://origin-getafix.imhd.io/getafix/questions/fetch",{method:"POST",body:JSON.stringify(oe(e))});e&&localStorage.setItem(m,JSON.stringify(e.entityScripts))}function ae(){var e=localStorage.getItem(m);let t=S(e);if(!(t instanceof Array))return"";0===t.length&&(t=[Z,K]);var n=t.splice(0,1).pop(),e=JSON.stringify(t);return localStorage.setItem(m,e),localStorage.setItem("__Habu_currentQuestionId",n.entityID),n}function re(e,t){var n=F(e,g),e=ne();let o,i={};if(Object.hasOwnProperty.call(t,"type")&&"email"===t.type)o=N;else{if(Object.hasOwnProperty.call(t,"type")&&"neutral"===t.type)return;o="https://fulcrum-antenna.imhd.io/collect/declared/947f14e3-a1d5-4048-818e-4f916200945c/imhd",i={questionID:t.entityID}}C(o,{method:"POST",body:T({...I(n),...oe(e),...i}),mode:"no-cors",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function se(e){var t=ae();((e,t)=>{if(!e)throw k()({type:$.ERROR,msg:"Client error: Missing parent container: habu-question-slot",action:"Forefoot: Render into container",pageUrl:`${window.location.hostname}${window.location.pathname}`}),f.missingContainer;const n=document.createDocumentFragment(),o=document.createElement("div");o.style.height="100%",o.style.width="100%",o.innerHTML=t;t=o.getElementsByClassName("habu-entity-styles")[0];if(n.appendChild(o),t)e.firstElementChild?e.replaceChild(n,e.firstElementChild):e.appendChild(n);else{const i=e.getElementsByClassName("habu-entity-text")[0];i.parentNode.replaceChild(n,i)}})(ee(),t.html),re(e,t),Object.hasOwnProperty.call(t,"type")&&"neutral"===t.type||(()=>{const t=["radio","email"],e=document.getElementById(h).querySelector("div form");e?e.querySelectorAll("input").forEach(e=>{t.includes(e.type)&&e.addEventListener("change",e=>localStorage.setItem("__Habu_currentAnswerValue",e.target.value),!1)}):k()({type:$.INFO,msg:"Wrong html structure. Expected: questionSlot > div > form",action:"Utils: Init User Input Widget with event listeners",pageUrl:`${window.location.hostname}${window.location.pathname}`})})()}function ce({ns:e,widgetConfigID:t},n){const o=oe(t),i=F(e,g),a=I(i);return function(e,t){C("https://fulcrum-antenna.imhd.io/collect/declared/4a2fc4b9-60f8-4a90-a8af-e830308e5495/imhd",{method:"POST",body:T({...a,...o,questionID:e,answer:t}),mode:"no-cors",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(n)}}function de({ns:e,widgetConfigID:t},n){const o=oe(t),i=F(e,g),a=I(i);return function(e){C(H,{method:"POST",body:T({...a,...o,email:e}),mode:"no-cors",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(n)}}const le={ID:"8416018b-1fcb-4c56-a99d-e18e13e35753",CreatedAt:"2021-02-12T18:51:32.117948Z",CreatedByUserID:"712da422-c774-4192-a71d-a2d7da509853",UpdatedAt:"2021-04-22T23:31:34.399469Z",UpdatedByUserID:"712da422-c774-4192-a71d-a2d7da509853",DeletedAt:null,propertyID:"08ebc1ef-cb36-4d75-9dd3-bbd672bb4b19",orgID:"dcb23cff-c1dd-4d41-9b54-ddd56b1cd280",details:{bowline:{highlights:[{key:"author",match:"dataLayer.[0].author",type:"pageAttribute"},{key:"category",match:"dataLayer.[0].category",type:"pageAttribute"},{key:"datePublished",match:"dataLayer.[0].datePublished",type:"pageAttribute"},{key:"pageType",match:"dataLayer.[0].pageType",type:"pageAttribute"},{key:"paywallState",match:"dataLayer.[0].paywallState",type:"pageAttribute"},{key:"vertical",match:"dataLayer.[0].vertical",type:"pageAttribute"},{key:"secondaryVerticals",match:"dataLayer.[0].secondaryVerticals",type:"pageAttribute"},{key:"anonymous_id",match:"anonymous_id",type:"userIdentifier"},{key:"permutive-id",match:"permutive-id",type:"userIdentifier"}],match:"window"},collectPageViews:"true",partners:["throtle"],version:"steady"},namespace:"8416018b-1fcb-4c56-a99d-e18e13e35753"};Object.hasOwnProperty.call(le,"details")&&Object.hasOwnProperty.call(le.details,"version")?(o=le.details,e=le.ID,B(),x(e),q(e,{[g]:le}),n=e,window.__Habu&&window.__Habu[n]||x(n),window.__Habu[n].do=z(n),window.__Habu.do=z(window.__Habu.ns),o=o,i=e,Object.hasOwnProperty.call(o,"accelerator")&&"data"===o.accelerator&&setTimeout(()=>(e=>{(ee()?function(e){var t=R(),n=F(e,g);if(!t)throw X({type:$.ERROR,msg:"Client error: Missing configurationID",action:"Forefoot: Locate native data accelerator div",...I(n)}),f.missingConfiguration;window.__Habu={...window.__Habu,sendAnswer:ce({ns:e,widgetConfigID:t},()=>se(e)),sendEmail:de({ns:e,widgetConfigID:t},()=>se(e))},te(t),ie().then(()=>se(e))}:function(o){const e=F(o,g),i=I(e);window.addEventListener("message",e=>{var t=e["data"];if(t&&t.from===w&&t.to===b&&Object.values(y).includes(t.type))if(t.type===y.wave){var n=t["widgetConfigID"];if(!n)throw X({type:$.ERROR,msg:"Client error: Missing configurationID",action:"Forefoot: Locate iframe with data accelerator",...i}),f.missingConfiguration;window.__Habu={...window.__Habu,sendAnswer:ce({ns:o,widgetConfigID:n}),sendEmail:de({ns:o,widgetConfigID:n})},te(n),ie().then(()=>e.source.postMessage({to:w,from:b,type:y.wave},e.origin))}else if(t.type===y.transmitQuestions){const i=ae();re(o,i),e.source.postMessage({...i,to:w,from:b,type:y.transmitQuestions},e.origin)}else e.isTrusted&&t.type===y.recordAnswers?window.__Habu.sendAnswer(t.questionID,t.answer):e.isTrusted&&t.type===y.recordEmail?window.__Habu.sendEmail(t.email):console.trace(e)})})(e)})(i)),o.collectPageViews&&setTimeout(()=>Y(i))):k()({type:$.ERROR,msg:"Quarterdeck: Missing/Malformed config",action:"Habu.js: Load config",domain:window.location.hostname,pageUrl:`${window.location.hostname}${window.location.pathname}`,...le})})();
