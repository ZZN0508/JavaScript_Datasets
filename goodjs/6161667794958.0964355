!function(){var h;function i(e){return"v="+e+"@"}function c(e){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.textContent=e,e=t,document.getElementsByTagName("head")[0].appendChild(e),t}function u(e,t){var n="."+document.domain.match(/([^.]+(?:\.com?)?\.)?[^.]+$/)[0];document.cookie="zm="+encodeURIComponent(e)+"; expires="+t+"; domain="+n+"; path=/"}function e(){this.ls=this.checkLs()?window.localStorage:null,this.timing={fromLs:!1}}window.home=window.home||{},h="undefined"!=typeof global?global:this,home.loadCss=function(e,t){var n,o,r,t=t||{},e=function(e,t,n,o){var r,i,s=h.document,a=s.createElement("link");i=t||(r=(s.body||s.getElementsByTagName("head")[0]).childNodes)[r.length-1];var l=s.styleSheets;a.rel="stylesheet",a.href=e,a.media=o?n||"all":"only x",function e(t){return s.body?t():void setTimeout(function(){e(t)})}(function(){i.parentNode.insertBefore(a,t?i:i.nextSibling)});function c(e){for(var t=a.href,n=l.length;n--;)if(l[n].href===t)return e();setTimeout(function(){c(e)})}function d(){a.addEventListener&&a.removeEventListener("load",d),o||(a.media=n||"all")}return a.addEventListener&&a.addEventListener("load",d),a.onloadcssdefined=c,c(d),a}(e,t.before,t.media,t.noFlash);function i(){!r&&o&&(r=!0,o.call(n))}t.callback&&(n=e,o=t.callback,n.addEventListener&&n.addEventListener("load",i),n.attachEvent&&n.attachEvent("onload",i),"isApplicationInstalled"in navigator&&"onloadcssdefined"in n&&n.onloadcssdefined(i))},e.prototype.init=function(e){this.config=e},e.prototype.checkLs=function(){try{return"localStorage"in window&&null!==window.localStorage&&(localStorage.setItem("test","1"),"1"===localStorage.getItem("test"))}catch(e){return!1}},e.prototype.clearLs=function(e){var t,n,o,r,i,s=[];if(this.ls)try{for(r=0,i=this.ls.length;r<i;++r)(t=this.ls.key(r))&&-1!==t.indexOf(".")&&(o=this.ls.getItem(t))&&"v="===o.substr(0,2)&&-1<o.indexOf("@")&&((n=o.substr(2,o.indexOf("@")-2))&&!e[t]||e[t].version!==n)&&s.push(t);for(r=0,i=s.length;r<i;++r)this.ls.removeItem(s[r])}catch(e){}},e.prototype.load=function(n){var e,o=this,r=Object.keys(n).length,i={};for(e in n)n.hasOwnProperty(e)&&function(t){o.loadFile(n[t],t,function(e){i[t]=e,setTimeout(function(){0==--r&&o.onAllFilesLoaded(n,i)},0)})}(e)},e.prototype.onAllFilesLoaded=function(e,t){var n,o,r,i={},s=[];for(n in t)t.hasOwnProperty(n)&&(i[o="m-"+t[n].name+":"+t[n].version+":"]||(i[o]={0:0,1:0,2:0}),i[o][String(t[n].result)]++);for(n in i)i.hasOwnProperty(n)&&(r=n,(o=i[n])[0]||(!o[1]&&o[2]?r+="l":o[1]&&(r+="c"),s.push(r)));if(this.clearLs(e),s.length){for(var a=decodeURIComponent((document.cookie.match(/zm=([^;]+)/)||[])[1]||""),l=a,l=function(e){for(var t,n,o,r=l.split("|"),i=[],s=0,a=r.length;s<a;s++)r[s]&&"m-"===(o=r[s].split(":"))[0].substr(0,2)&&(t=o[0].substr(2),n=o[1],e[t=(t=t.replace(/-https/,"")).replace(/-www/,"")]&&e[t].version===n&&i.push(r[s]));return i.join("|")}(e),c=0,d=s.length;c<d;c++)l=function(e,t){var n,o=t.split(":"),r=[],i=!1;if(3!==o.length)return e;for(var s=o[0],a=0,l=(n=e.split("|")).length;a<l;a++)n[a]&&(n[a].split(":")[0]===s?(r.push(t),i=!0):r.push(n[a]));return i||r.push(t),r.join("|")}(l,s[c]);l&&l!==a&&u(l,new Date(+new Date+12096e5).toUTCString())}else u("","Thu, 01 Jan 1970 00:00:01 GMT")},e.prototype.loadFile=function(e,t,n){var o,r,i=e.version,s=this;if(e.fresh){if(o=new Date,a=this.loadFromLs(t,e),o=new Date-o,a)return l=new Date,c(a),l=new Date-l,e.isMainCss&&this.sendStat("zcookie.timing",{lsTime:o,appendTime:l}),void n({version:i,name:e.name,result:2});e.isMainCss&&(r=c("body{display:none}"),setTimeout(function(){r&&(r.parentNode.removeChild(r),r=null,s.sendStat("zcookie.error.nocss"))},5e3),this.sendStat("zcookie.error.missing")),home.loadCss(e.url,{callback:function(){r&&(r.parentNode.removeChild(r),r=null)}}),n({version:i,name:e.name,result:0})}else{var a,l=document.querySelector('[data-css-name="'+e.name+'"]');l&&(a=l.textContent)?(a=s.saveToLs(t,i,e,a),n({version:i,name:e.name,result:a?2:1})):n({version:i,name:e.name,result:1})}},e.prototype.loadFromLs=function(e,t){if(!this.ls)return"";var n,o=i(t.version),r=o.length;try{n=this.ls.getItem(e)}catch(e){return""}if(n){if(n.substr(0,r)===o){o=parseInt(n.substr(r+2),10),r=n.substr(r+3+(o+"").length);if(o===r.length){if(function(e){for(var t=2166136261,n=e.length,o=0;o<n;o++)t=16777619*(t^(0|e.charCodeAt(o)))|0;return t.toString(36)}(r)===t.hash)return r;this.sendStat("zcookie.error.hash")}else this.sendStat("zcookie.error.get")}try{this.ls.removeItem(e)}catch(e){}}return""},e.prototype.sendStat=function(e,t){var n,o=location.href.replace("'","%27"),r=this.config.clickHost;r&&(n="",t&&(n=Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join(",")),(new Image).src=location.protocol+"//"+r+"/jclck/dtype=clck/lid="+this.config.statRoot+"."+e+"/sid="+this.config.showId+"/rnd="+((new Date).getTime()+Math.round(100*Math.random()))+"/vars=-eventtype=tech"+(n?","+n:"")+"/*data="+encodeURIComponent("url="+encodeURIComponent(o)))},e.prototype.saveToLs=function(e,t,n,o){if(!this.ls)return!1;if(n.size!==o.length)return this.sendStat("zcookie.error.load"),!1;var r;try{if(r=i(t)+"s="+o.length+"@"+o,this.ls.setItem(e,r),this.ls.getItem(e).length!==r.length)return this.ls.removeItem(e),this.sendStat("zcookie.error.set"),!1}catch(e){return!1}return!0},window.pl=new e}();
