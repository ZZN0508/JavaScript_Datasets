!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("wafer-sticky",[],e):"object"==typeof exports?exports["wafer-sticky"]=e():(t.wafer=t.wafer||{},t.wafer.wafers=t.wafer.wafers||{},t.wafer.wafers["wafer-sticky"]=e())}("undefined"!=typeof self?self:this,function(){return o={"./src/base.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o,r=arguments[e];for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},f=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var o=[],r=!0,n=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(o.push(s.value),!e||o.length!==e);r=!0);}catch(t){n=!0,i=t}finally{try{!r&&a.return&&a.return()}finally{if(n)throw i}}return o}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,o){return e&&a(t.prototype,e),o&&a(t,o),t},n=window.wafer,i=n.constants,s=n.utils,n=n.WaferBaseClass,c=s.findAncestor,u=i.ATTR_PREFIX,r=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(y,n),r(y,[{key:"addSticky",value:function(){var t=this._util,e=t.targetElem,o=t.offsetTop,r=t.offsetLeft,n=t.offsetRight,t={};o&&(t.top=o),r?t.left=r:n&&(t.right=n),this._state.isSticky=!0,Object.assign(e.style,{position:"fixed"},t),e.classList.add("sticky-active")}},{key:"makeStickyFlow",value:function(){var t=this._util,e=t.elem,o=t.offsetLeft,r=t.offsetRight,n=t.offsetBottom,i=t.targetElem,t=e.getBoundingClientRect(),e=i.getBoundingClientRect().height,n={top:t.bottom-e-parseInt(n,10)+"px"};o?n.left=o:r&&(n.right=r),this._state.isSticky=!0,Object.assign(i.style,{position:"fixed"},n),i.classList.add("sticky-flow")}},{key:"removeSticky",value:function(){var t=this._util.targetElem;t.classList.remove("sticky-flow","sticky-active"),this._state.isSticky=!1,Object.assign(t.style,this._state.previousPositionValue)}},{key:"config",get:function(){var t=this._util,e=t.offsetBottom,o=t.offsetTop,r=t.stickyAllowed,t=t.targetElem;return{isSticky:this._state.isSticky,offsetBottom:e,offsetTop:o,stickyAllowed:r,targetElem:t}}}]),y);function y(t){var e=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).selector;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,t,{selector:e},{})),r=t.getAttribute(u+"sticky-boundary"),n=t.getAttribute(u+"sticky-target"),i=(t.getAttribute(u+"sticky-offset")||"").split(" "),s=f(i,4),a=s[0],e=s[1],i=s[2],s=s[3];o._util=l({},o._util,{elem:t,targetElem:n&&(r&&c(t,r)||document.body).querySelector(n)||t,offsetBottom:void 0!==s&&s,offsetLeft:void 0!==e&&e,offsetRight:void 0!==i&&i,offsetTop:void 0!==a&&a});r=o._util.targetElem,n=r.style,s=n.bottom,e=n.left,i=n.position,a=n.right,n=n.top,r=r.getBoundingClientRect().height,t=t.getBoundingClientRect().height;return o._util.stickyAllowed=r<=t,o._state={isSticky:!1,previousPositionValue:{bottom:s,left:e,position:i,right:a,top:n}},o}function a(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.default=r,t.exports=e.default},"./src/controller.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,o=function(t,e,o){return e&&u(t.prototype,e),o&&u(t,o),t},r=window.wafer,l=r.base,s=r.controllers,r=r.utils,f=r.elementInView,a=r.throttle,s=s.WaferBaseController,o=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(c,s),o(c,[{key:"handleScroll",value:function(){this._validateWithThrottle()}},{key:"handleResize",value:function(){this._validateWithThrottle()}},{key:"didSync",value:function(){var t=this._state,e=t.elementInstances,t=t.mounted;0===e.size||t||(this._state.mounted=!0)}},{key:"willValidate",value:function(t){var a=this._state.elementInstances;t.forEach(function(t){var e,o=a.get(t).instance,r=f(t,{},l.viewport),n=o.config,i=n.isSticky,s=n.stickyAllowed;r&&s?(e=o.config.targetElem.getBoundingClientRect().height,r=(n=t.getBoundingClientRect()).bottom,s=n.top,n=(t=o.config).offsetTop,r-(e+(t=(t=t.offsetBottom)&&parseInt(t,10))+(n=n&&parseInt(n,10)))<0?o.makeStickyFlow():i&&0<=s-n?o.removeSticky():s-n<0&&o.addSticky()):i&&o.removeSticky()})}}]),c);function c(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.root,o=void 0===e?document:e,e=t.selector,t=t.validateDelay,t=void 0===t?15:t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,{root:o,selector:e,props:{selector:e},WaferClass:(i||(e=n("./src/base.js"),i=e&&e.__esModule?e:{default:e})).default}));return r._validateWithThrottle=a(function(){r.validate()},t,r),r.sync(),r}function u(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.default=o,t.exports=e.default},"./src/entry.js":function(t,e,o){"use strict";var r,n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=new(r||(n=o("./src/controller.js"),r=n&&n.__esModule?n:{default:n})).default({selector:".wafer-sticky"}),t.exports=e.default}},n={},r.m=o,r.c=n,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="https://s.yimg.com/aaq/wf/",r(r.s="./src/entry.js");function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return o[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}var o,n});
