define(function(){"use strict";function e(t){this.$elem=$(t),this.options=$.extend({},o,this.$elem.data()),this.$scrollIndicator=this.$elem.find(this.options.scrollIndicatorSelector),this.$scrollArrows=this.$elem.find(this.options.scrollArrowsSelector),this.$scrollText=this.$elem.find(this.options.scrollTextSelector),this.$sectionMenu=this.$elem.find(this.options.sectionMenuSelector),this.$sectionFlag=$(this.options.sectionIndicatorFlagSelector),this.$footer=$(this.options.pageFooterSelector),this.$header=$(this.options.pageHeaderSelector),this.lastSectionItem=this.options.lastSectionItemSelector,this.isActive=this.options.activeClassSelector;var e=this;this.addScrollIndicator(),this.$sectionMenu.length?(this.createFlagIds(),this.addSectionItems(),this.toggleSectionTitles(),this.enableSectionIndicator()):($(window).on("scroll",function(){e.resetScrollIndicator()}),$(window).on("resize",function(){e.resetScrollIndicator()}))}var o={scrollIndicatorSelector:".lb-scroll-indicator",scrollArrowsSelector:".lb-scroll-arrows",scrollTextSelector:".lb-scroll-text",sectionIndicatorFlagSelector:".lb-section-indicator-flag",sectionMenuSelector:".lb-section-menu",lastSectionItemSelector:".lb-section-menu a:last-of-type",pageFooterSelector:"#aws-page-footer",pageHeaderSelector:"#aws-page-header",activeClassSelector:"lb-active",pageTopBoundary:20,pageBottomPadding:500,scrollDelay:3e3,scrollPadding:35};return e.prototype.getHeaderHeight=function(){return 0<this.$header.length&&"fixed"===this.$header.css("position")?this.$header.height():0},e.prototype.addScrollIndicator=function(){var t=this,e=this.options.pageTopBoundary,o=$(window).scrollTop();this.scrollTimer=setTimeout(function(){t.$scrollArrows.show(),o<=e&&t.$scrollText.show()},this.options.scrollDelay)},e.prototype.removeScrollIndicator=function(){this.$scrollIndicator.children().hide()},e.prototype.resetScrollIndicator=function(){var t=this.options.pageBottomPadding;clearTimeout(this.scrollTimer),"block"===this.$scrollIndicator.css("display")&&this.removeScrollIndicator();var e=this.$footer.position().top;$(window).scrollTop()+$(window).height()+t<e&&this.addScrollIndicator()},e.prototype.createFlagIds=function(){this.$sectionFlag.each(function(t){t="lb-section-indicator-"+t;$(this).attr("id",t)})},e.prototype.addSectionItems=function(){var t=this;this.$sectionFlag.each(function(){$("<a/>",{href:"#"+$(this).attr("id")}).appendTo(t.$sectionMenu),$(t.lastSectionItem).append("<div>"+$(this).attr("data-section-name")+"</div>")})},e.prototype.toggleSectionTitles=function(){var t=this;this.$sectionMenu.on("mouseenter","a",function(){t.$sectionMenu.find("div").removeClass(t.isActive),$(this).find("div").addClass(t.isActive)}),this.$sectionMenu.on("mouseleave",function(){$(this).find("div").removeClass(t.isActive)})},e.prototype.enableSectionIndicator=function(){var i=this,s=this.getHeaderHeight()+this.options.scrollPadding,t=this.options.pageTopBoundary;$(window).on("scroll",function(){var o=$(this).scrollTop();clearTimeout(i.scrollTimer),o<=t?(i.$sectionMenu.removeClass(i.isActive),i.addScrollIndicator()):(i.$sectionMenu.addClass(i.isActive),i.removeScrollIndicator(),$(document).width()<980&&i.resetScrollIndicator()),i.$sectionFlag.each(function(){var t=$(this).offset().top-s,e=$(this).attr("id");t<=o&&(i.$sectionMenu.children().removeClass(i.isActive),i.$sectionMenu.find('a[href="#'+e+'"]').addClass(i.isActive))})}),$(window).on("resize",function(){"1"===i.$sectionMenu.css("opacity")&&(clearTimeout(i.scrollTimer),i.removeScrollIndicator())})},Libra.Comp.register({name:"section-indicator",initFct:function(t){new e(t)},initTime:"documentReady"}),e});
