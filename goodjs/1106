function q(t){throw t}define("modules/clean/deprecated_ajax/ajax",["require","exports","tslib","modules/clean/devtools/panels/performance/perf_hub_action_types","modules/clean/deprecated_ajax/job_progress","modules/core/persistence/storage","modules/constants/ajax_strings","modules/constants/page_load","modules/constants/request","modules/core/browser","modules/core/exception","modules/core/transport/fetch_utils","modules/core/html","modules/core/notify","modules/core/uri","modules/clean/csrf","modules/clean/viewer"],function(t,e,n,r,a,o,s,i,c,u,l,h,p,d,f,_,m){"use strict";function y(t){return t}function g(t,e){null==e&&(e=[]);var r=new j(t=null==t?{}:t),s=b(r,e),n=s.options().type||"POST",r=h.serialize(s.data()),o=s.dataType(),e=s.headers(),t={method:n,mode:"same-origin",credentials:"same-origin",headers:e,signal:t.signal};"POST"===n&&(t.body=r),e.append("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");var i=fetch(String(s.url()),t);return new Promise(function(r,e){i.then(function(e){return e.text().then(function(t){return{response:e,responseText:t}})}).then(function(t){var e=t.response,t=t.responseText;if(!e.ok)throw new h.FetchResponseError(e,t);if("abort"===e.statusText)throw new h.FetchAbortError(e,e.statusText);if("failed"===e.statusText)throw new h.FetchFailError(e,e.statusText);r({response:e,responseText:t})}).catch(function(t){return e(t)})}).then(function(t){var e=t.response,r=t.responseText;if("json"===o)try{var n=JSON.parse(r);s.success(n,r,"success",e),s.complete(e,"success",r)}catch(t){s.error(e,"parsererror",t),s.complete(e,"parsererror")}else s.success(void 0,r,"success",e),s.complete(e,"success",r)}).catch(function(t){var e=new Response;h.errorIsFetchFailError(t)?(s.error(t.response,"failed",t),s.complete(t.response,"failed")):h.errorIsFetchResponseError(t)?(s.error(t.response,"error",t),s.complete(t.response,"error")):h.errorIsFetchAbortError(t)?(s.error(t.response,"aborted",t),s.complete(t.response,"aborted")):"AbortError"===t.name?(s.error(e,"aborted",t),s.complete(e,"aborted")):(s.error(e,"error",t),s.complete(e,"error"))}),s.request(i),i}Object.defineProperty(e,"__esModule",{value:!0}),e.SilentBackgroundBeaconRequest=e.SilentBackgroundRequest=e.BackgroundRequest=e.WebProgressRequest=e.FormWebRequest=e.WebRequestOref=e.WebRequest=e.Request=void 0,a=n.__importStar(a),o=n.__importStar(o),s=n.__importStar(s),i=n.__importStar(i),c=n.__importStar(c),u=n.__importStar(u),l=n.__importStar(l),e.Request=g;var v,b=function(t,e){for(var r=[t],n=0,s=Array.from(e.slice(0).reverse());n<s.length;n++){var o=s[n];r.push(new o)}for(var i=t,a=0,c=r;a<c.length;a++){var u=c[a];i&&u.type===v.CHAINED&&(u.next=i),i=u}return i};(X=v=v||{}).BASE="base",X.CHAINED="chained";var w,j=function(t){this.type=v.BASE;var e=t||{};this.options=function(){return e},this.url=function(){return String(e.url||"")},this.data=function(){return e.data||{}},this.dataType=function(){return e.dataType||"text"},this.headers=function(){return e.headers||new Headers},this.success=e.success||y,this.error=e.error||y,this.complete=e.complete||y,this.request=y},x=(S.prototype.options=function(){return this.next.options()},S.prototype.url=function(){return this.next.url()},S.prototype.contentType=function(){return this.next.contentType()},S.prototype.data=function(){return this.next.data()},S.prototype.dataType=function(){return this.next.dataType()},S.prototype.headers=function(){return this.next.headers()},S.prototype.success=function(t,e,r,n){this.next.success(t,e,r,n)},S.prototype.error=function(t,e,r){this.next.error(t,e,r)},S.prototype.complete=function(t,e,r){this.next.complete(t,e,r)},S.prototype.request=function(t){this.next.request(t)},S),A=(w=x,n.__extends(E,w),E.initClass=function(){},E.prototype.data=function(){if(this.options().skipInjectCsrf)return this.next.data();l.assert(this._is_db_domain(),"injecting CSRF token into request to non-dropbox domain");var t={is_xhr:!0};return"POST"===(this.options().type||"POST")&&(t.t=_.readCsrfToken()),n.__assign(n.__assign({},t),this.next.data())},E.prototype._is_db_domain=function(){var t=f.URI.parse(String(this.url())).getAuthority();if(!t)return!0;var n=t.split(".");return this.SUPPORTED_TLDS.reduce(function(t,e){var r=e.split("."),r=n.slice(-1*r.length).join(".");return t||e===r},!1)},E);function E(){var t=null!==w&&w.apply(this,arguments)||this;return t.SUPPORTED_TLDS=["dropbox.com"],t}function S(){this.type=v.CHAINED}A.initClass();var R,D,T,k,O,q,C,P,I,B,F,L,N,M=(N=x,n.__extends(ft,N),ft.prototype.data=function(){var t=this.next.data(),e=this.options();return e.subject_user&&!t._subject_uid&&(t._subject_uid=String(e.subject_user)),t},ft.prototype.headers=function(){var t=this.next.headers(),e=this.options();return e.subject_user&&t.set("X-DROPBOX-UID",String(e.subject_user)),t},ft),U=(L=x,n.__extends(dt,L),dt.prototype.headers=function(){var t=this.next.headers(),e=this.options().teamAuthParams||{},r=e.team_id||m.Viewer.get_viewer().team_id;r&&t.set("X-Dropbox-Teamid",String(r));r=e.auth_role||m.Viewer.get_viewer().auth_role,e=e.auth_action_type||m.Viewer.get_viewer().auth_action_type;return(r||e)&&t.set("X-Dropbox-Team-Authorization",JSON.stringify({auth_role:String(r),auth_action_type:String(e)})),t},dt),H=(F=x,n.__extends(pt,F),pt.prototype.error=function(t,e,r){var n,s;return(h.errorIsFetchFailError(r)||h.errorIsFetchResponseError(r)&&403===r.response.status)&&(n=o.SessionStorage.get("reload-timestamp"),s=(new Date).getTime(),(!n||3e4<s-n)&&(o.SessionStorage.set("reload-timestamp",s),window.location.reload(!0))),this.next.error(t,e,r)},pt),$=(B=x,n.__extends(ht,B),ht.prototype.data=function(){var t=this.next.data();return c.REQUEST_TRACING_ENABLED?n.__assign({parent_request_id:c.REQUEST_ID},t):t},ht.prototype.headers=function(){var t=this.next.headers(),e=this.options().type||"POST";return c.REQUEST_TRACING_ENABLED&&"POST"===e&&t.append(r.PerfHubHeaderNames.FORCE_REQUEST_TRACING_HEADER,"ON"),t},ht),V=(I=x,n.__extends(lt,I),lt.prototype.data=function(){var t=this.next.data(),e={};return i.PUBLIC_MODE_OVERRIDE&&(e.public_mode_override="1"),i.COUNTRY_OVERRIDE&&(e.country_override=i.COUNTRY_OVERRIDE),n.__assign(n.__assign({},e),t)},lt),J=(P=x,n.__extends(ut,P),ut.prototype.error=function(t,e,r){return this._notify_dev(e,r),this.next.error(t,e,r)},ut.prototype._notify_dev=function(t,e){(h.errorIsFetchFailError(e)||h.errorIsFetchResponseError(e))&&e.response.headers.get("X-Debug-Url")},ut),G=(C=x,n.__extends(ct,C),ct.prototype.success=function(t,e,r,n){var s;if(!e.length)return this.next.error(n,r,new Error("AJAX Response was empty."));var o=this.options(),i=!0,a=!1;if(0===e.indexOf("err:"))s=e.substr("err:".length),["{","["].includes(s[0])&&(i=!1);else{if(0!==e.indexOf("htmlerr:"))return this.next.success(t,e,r,n);s=e.substr("htmlerr:".length),a=!0}r=this.next.error(n,r,new Error(s));return i&&!o.skipNotifyError&&(o=s,a&&(o=new p.HTML(s)),d.Notify.error(o)),r},ct.prototype.error=function(t,e,r){return"aborted"!==e&&d.Notify.error(s.PROBLEM_COMPLETING_REQUEST),this.next.error(t,e,r)},ct),W=(q=x,n.__extends(at,q),at.prototype.success=function(t,e,r,n){if(!this.options().skipErrorHandling){if(!e.length)return this.next.error(n,r,new Error("AJAX Form response was empty."));if(0===e.indexOf("err:")){var s=e.substr("err:".length);return this.next.error(n,r,new Error(s))}}return this.next.success(t,e,r,n)},at),z=(O=x,n.__extends(it,O),it.prototype.request=function(t){var e=this,r=!1;return t.catch(function(){}).then(function(){r=!0}),setTimeout(function(){r||e._should_show_working_msg()&&(e._show_working_msg(),t.catch(function(){}).then(function(){e._clear_working_msg()}))},4e3),this.next.request(t)},it.prototype._should_show_working_msg=function(){return d.Notify.isShown()},it.prototype._show_working_msg=function(){return this.notification=d.Notify.success(s.STILL_WORKING),this.notification},it.prototype._clear_working_msg=function(){if(d.Notify.isShown()&&this.notification===d.Notify.current())return d.Notify.clear()},it),Q=(k=x,n.__extends(ot,k),ot.prototype.data=function(){this.job_id=ot.generate_job_id();var t=this.next.data(),e=t._subject_uid,r=this.options().subject_user;return e&&"string"==typeof e?this.uid=e:r&&(this.uid=String(r)),n.__assign({job_id:this.job_id},t)},ot.prototype.request=function(t){return this._interval=1e3,this._failures=0,this._watch_count=0,this._watch_id=setInterval(this._watch,this._interval),this.next.request(t)},ot.prototype.success=function(t,e,r,n){return this.next.success(t,e,r,n)},ot.prototype.error=function(t,e,r){return this.next.error(t,e,r)},ot.prototype.complete=function(t,e,r){return this._stop(),a.Job.handled(this.job_id),this.next.complete(t,e,r)},ot.prototype._watch=function(){return a.Job.peek(this.job_id)?this._stop():(this._watch_count++,this._watch_count%10==0&&(clearInterval(this._watch_id),this._interval=Math.min(Math.floor(1.5*this._interval),3e4),this._watch_id=setInterval(this._watch,this._interval)),this._show_progress_modal(),this._fetch_progress())},ot.prototype._stop=function(){clearInterval(this._watch_id),a.ModalProgress.hide()},ot.prototype._show_progress_modal=function(){var t;this._modal_shown||(this._modal_shown=!0,(t=this.options()).progress_text&&a.ModalProgress.show(t.progress_text))},ot.prototype._fetch_progress=function(){var n=this,t={};return this.uid&&(t._subject_uid=this.uid),yt({url:"/job_status/"+this.job_id,data:t,dataType:"text",success:function(t,e,r,n){e=0===e.indexOf("done")?"1/1":e;a.ModalProgress.update(e)},error:function(t,e,r){if(n._failures++,!(n._failures<3))return n._stop(),n.next.error(t,e,r)}})},ot.generate_job_id=function(){var t=(new Date).getTime().toString(),e=Math.floor(1e6*Math.random()).toString();return t+("000000"+e).substring(e.length)},ot),X=(T=x,n.__extends(st,T),st.prototype.data=function(){var t=this.next.data();this.uid=String(t._subject_uid);var e=this.options().subject_user;return!this.uid&&e&&(this.uid=String(e)),t},st.prototype.success=function(t,e,r,n){return this._is_async_job_response(e)?(this.job_id=e.split(":")[1],this._interval=1e3,this._failures=0,this._watch_count=0,this._watch_id=setInterval(this._watch,this._interval)):this.next.success(t,e,r,n)},st.prototype.complete=function(t,e,r){if(!this._is_async_job_response(r))return this.next.complete(t,e,r)},st.prototype._is_async_job_response=function(t){return!(!t||0!==t.indexOf("async_task_started:"))&&t.split(":")[1].match(/^[A-Za-z0-9_\-=]*$/)},st.prototype._watch=function(){return a.Job.peek(this.job_id)?this._stop():(this._watch_count++,this._watch_count%10==0&&(clearInterval(this._watch_id),this._interval=Math.min(Math.floor(1.5*this._interval),3e4),this._watch_id=setInterval(this._watch,this._interval)),this._show_progress_modal(),this._fetch_progress())},st.prototype._stop=function(){clearInterval(this._watch_id),a.ModalProgress.hide()},st.prototype._show_progress_modal=function(){var t;this._modal_shown||(this._modal_shown=!0,(t=this.options().progress_text)&&a.ModalProgress.show(t))},st.prototype._fetch_progress=function(){var i=this,t={};return this.uid&&(t._subject_uid=this.uid),bt({url:"/async_task_status/"+this.job_id,data:t,dataType:"text",success:function(t,e,r,n){var s=e;if(0===s.indexOf("done:"))return a.Job.handled(i.job_id),i._stop(),e=s=s.substr("done:".length),i.next.success(t,e,r,n),i.next.complete(n,r,e);if(0===s.indexOf("err:")){a.Job.handled(i.job_id),i._stop();var o=s.substr("err:".length);return d.Notify.error(o),i.next.error(n,r,new Error(o)),i.next.complete(n,r,e)}if(0===s.indexOf("async_task_err:")){a.Job.handled(i.job_id),i._stop();o=s.substr("async_task_err:".length);return d.Notify.error(new p.HTML(o)),i.next.complete(n,r,e)}a.ModalProgress.update(s)},error:function(t,e,r){if(i._failures++,!(i._failures<3))return i._stop(),i.next.error(t,e,r),i.next.complete(t,e,"")}})},st),K=(D=x,n.__extends(nt,D),nt.prototype.data=function(){var t,e=u.get_uri().getQuery().oref;return null!==(t=this.next.data())&&void 0!==t&&t.oref||!e?this.next.data():n.__assign({oref:e},this.next.data())},nt),Y=[(R=x,n.__extends(rt,R),rt.prototype.browser_unload_handler=function(){this.is_browser_unloading=!0},rt.prototype.request=function(t){return window.addEventListener("beforeunload",this.browser_unload_handler),this.next.request(t)},rt.prototype.error=function(t,e,r){return"error"===e&&this.is_browser_unloading?this.next.error(t,"aborted",new Error("unload")):this.next.error(t,e,r)},rt.prototype.complete=function(t,e,r){return window.removeEventListener("beforeunload",this.browser_unload_handler),this.next.complete(t,e,r)},rt)],Z=[M,U,A,H],z=[z],tt=[J,$,V],X=[X],et=[].concat(Y,z,G,tt,Z,X);function rt(){var t=R.call(this)||this;return t.browser_unload_handler=t.browser_unload_handler.bind(t),t.is_browser_unloading=!1,t}function nt(){return null!==D&&D.apply(this,arguments)||this}function st(){var t=T.call(this)||this;return t._watch=t._watch.bind(t),t}function ot(){var t=k.call(this)||this;return t._watch=t._watch.bind(t),t}function it(){var t=O.call(this)||this;return t._clear_working_msg=t._clear_working_msg.bind(t),t}function at(){return null!==q&&q.apply(this,arguments)||this}function ct(){return null!==C&&C.apply(this,arguments)||this}function ut(){return null!==P&&P.apply(this,arguments)||this}function lt(){return null!==I&&I.apply(this,arguments)||this}function ht(){return null!==B&&B.apply(this,arguments)||this}function pt(){return null!==F&&F.apply(this,arguments)||this}function dt(){return null!==L&&L.apply(this,arguments)||this}function ft(){return null!==N&&N.apply(this,arguments)||this}e.WebRequest=function(t){return g(t=null==t?{}:t,et)},e.WebRequestOref=function(t){return g(t=null==t?{}:t,[].concat(K,et))};var _t=[].concat(Y,z,W,tt,Z,X);e.FormWebRequest=function(t){return g(t=null==t?{}:t,_t)};var mt=[].concat(Y,z,G,tt,Z,Q,X);function yt(t){return g(t=null==t?{}:t,[].concat(Y,tt,Z))}e.WebProgressRequest=function(t){return g(t=null==t?{}:t,mt)},e.BackgroundRequest=yt;var gt=[M,U,A],vt=[].concat(Y,tt,gt);function bt(t){return g(t=null==t?{}:t,vt)}e.SilentBackgroundRequest=bt,e.SilentBackgroundBeaconRequest=function(t){if(null==t&&(t={}),!navigator.sendBeacon)return bt(t);var e=new j(t),t=b(e,[].concat(gt,$)),e=t.url(),t=function(r){for(var n=new FormData,t=0,e=Object.keys(r);t<e.length;t++)!function(e){var t=r[e];(null===t?[]:Array.isArray(t)?t:[t]).forEach(function(t){void 0!==t&&(t=!0===t?"true":!1===t?"false":"number"==typeof t?String(t):t,n.append(e,t))})}(e[t]);return n}(t.data());navigator.sendBeacon(String(e),t)||console.warn("Beacon request failed: "+e)}}),define("api_v2/client_base",["require","exports","tslib","api_v2/types","api_v2/transport/fetch","modules/clean/devtools/panels/performance/perf_hub_action_types","modules/constants/request","modules/constants/request","modules/core/browser","modules/core/cookies","modules/core/uri"],function(t,e,c,o,r,u,l,h,p,n,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ApiV2ClientBase=e.DefaultApiV2Transport=void 0,l=c.__importStar(l),p=c.__importStar(p);var s,i=(s=r.FetchAsyncTransport,c.__extends(a,s),a);function a(){return null!==s&&s.apply(this,arguments)||this}e.DefaultApiV2Transport=i;f.prototype._upload=function(t,e,r,n){return this._uploadWithResponseHeaders(t,e,r,n).then(function(t){return t.result})},f.prototype._uploadWithResponseHeaders=function(t,e,r,n){var s=c.__assign(((s={})[o.ApiV2HeaderNames.CsrfToken]=this.csrfToken(),s[o.ApiV2HeaderNames.DropboxApiArg]=JSON.stringify(e),s),this._headers(n));return this.executeRpc(t,s,r,"application/octet-stream",n.signal)},f.prototype._rpc=function(t,e,r){return this._rpcWithResponseHeaders(t,e,r).then(function(t){return t.result})},f.prototype._rpcWithResponseHeaders=function(t,e,r){var n=c.__assign(((n={})[o.ApiV2HeaderNames.CsrfToken]=this.csrfToken(),n),this._headers(r)),e=JSON.stringify(e||null);return this.executeRpc(t,n,e,"application/json",r.signal)},f.prototype.csrfToken=function(){return n.Cookies.read("__Host-js_csrf")||""},f.prototype.executeRpc=function(n,s,o,i,a){return c.__awaiter(this,void 0,void 0,function(){var e,r;return c.__generator(this,function(t){switch(t.label){case 0:return r="client-web.dropbox.com"===p.get_hostname()?"client-web.dropbox.com":"www.dropbox.com",l.REQUEST_TRACING_ENABLED&&(e={parent_request_id:h.REQUEST_ID},s[u.PerfHubHeaderNames.FORCE_REQUEST_TRACING_HEADER]="ON"),r=new d.URI({scheme:"https",authority:r,path:"/2/"+n,query:e}),[4,this.transport.executeRpc(r,s,o,i,a)];case 1:return[2,t.sent()]}})})},r=f;function f(t){this.transport=t||new i}(e.ApiV2ClientBase=r).prototype.ns=function(s){var o=this;return{rpc:function(t,e,r){return o._rpc(s+"/"+t,e,r)},rpcWithResponseHeaders:function(t,e,r){return o._rpcWithResponseHeaders(s+"/"+t,e,r)},upload:function(t,e,r,n){return o._upload(s+"/"+t,e,r,n)},uploadWithResponseHeaders:function(t,e,r,n){return o._uploadWithResponseHeaders(s+"/"+t,e,r,n)}}}}),define("api_v2/error",["require","exports","tslib","modules/core/html","modules/core/i18n"],function(t,e,r,i,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.catchApiError=e.isRateLimitError=e.isServerError=e.isAppError=e.isAuthError=e.isBadRequestError=e.isApiError=e.RateLimitError=e.ServerError=e.AppError=e.AuthError=e.BadRequestError=e.ApiError=void 0;var n=(c.prototype.toString=function(){return void 0===this.message?"ApiError":"string"==typeof this.message?this.message:this.message.toString()},c.parseResponse=function(t,e,r,n){var s="";null==(n=void 0===n?null:n)&&(n=t in x?x[t]:500<=t?y:c);e={raw:{status:t,responseBody:r},summary:null,error:{},headers:e};try{var o=JSON.parse(r)||{};e.error=o.error,e.summary=o.error_summary,s=null!=o.user_message?o.user_message.text:""}catch(t){}o=void 0;return(s=429===t&&!s?a.intl.formatMessage({id:"HQLtn1",defaultMessage:"Folder updates in progress â€” please try again later. <a>Learn more</a>"},{a:function(t){return'<a href="/help/9259" target="_blank" rel="noopener">'+t+"</a>"}}):s)&&(o=new i.HTML(s)),Object.assign(new n(o),e)},c);function c(t){this.message=t}e.ApiError=n;var s,o=(s=n,r.__extends(u,s),u);function u(){return null!==s&&s.apply(this,arguments)||this}e.BadRequestError=o;var l,h=(l=n,r.__extends(p,l),p);function p(){return null!==l&&l.apply(this,arguments)||this}e.AuthError=h;var d,f=(d=n,r.__extends(_,d),_);function _(){return null!==d&&d.apply(this,arguments)||this}e.AppError=f;var m,y=(m=n,r.__extends(g,m),g);function g(){return null!==m&&m.apply(this,arguments)||this}e.ServerError=y;var v,b=(v=n,r.__extends(w,v),w);function w(){return null!==v&&v.apply(this,arguments)||this}function j(t){return t instanceof n}e.RateLimitError=b,e.isApiError=j,e.isBadRequestError=function(t){return t instanceof o},e.isAuthError=function(t){return t instanceof h},e.isAppError=function(t){return t instanceof f},e.isServerError=function(t){return t instanceof y},e.isRateLimitError=function(t){return t instanceof b},e.catchApiError=function(e){return function(t){if(j(t))return e(t);throw t}};var x={400:o,401:h,409:f,429:b}}),define("api_v2/transport/fetch",["require","exports","tslib","api_v2/error","modules/core/transport/fetch_utils"],function(t,e,a,c,u){"use strict";function l(t){var r={};return t.forEach(function(t,e){r[e]=t}),r}Object.defineProperty(e,"__esModule",{value:!0}),e.FetchSyncTransport=e.FetchAsyncTransport=void 0;var r=(n.prototype.executeRpc=function(t,n,s,o,i){return new Promise(function(r,e){return fetch(t.toString(),{method:"POST",mode:"same-origin",credentials:"same-origin",headers:a.__assign(a.__assign({},n),{"Content-Type":o}),body:s,signal:i}).then(function(e){return e.text().then(function(t){return{response:e,responseText:t}})}).then(function(t){var e=t.response,t=t.responseText;if(e.ok)return{response:e,responseText:t};throw new u.FetchResponseError(e,t)}).then(function(t){var e=t.response,t=t.responseText;return r({headers:l(e.headers),result:JSON.parse(t)})}).catch(function(t){return u.errorIsFetchResponseError(t)?e(c.ApiError.parseResponse(t.response.status,l(t.response.headers),t.message)):e(c.ApiError.parseResponse(0,{},""))})})},n);function n(){}e.FetchAsyncTransport=r;s.prototype.executeRpc=function(t,e,r,n,s){return fetch(t.toString(),{method:"POST",mode:"same-origin",credentials:"same-origin",headers:a.__assign(a.__assign({},e),{"Content-Type":n}),keepalive:!0,body:r,signal:s}),Promise.resolve({headers:{},result:{}})},r=s;function s(){}e.FetchSyncTransport=r}),define("api_v2/transport/beacon",["require","exports","tslib","api_v2/types","api_v2/transport/fetch","sjcl"],function(t,e,c,u,r,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BeaconTransport=void 0,l=c.__importStar(l);var n=(s.prototype.executeRpc=function(s,o,i,a){return navigator.sendBeacon?new Promise(function(t,e){var r=(n=null!==(r=o[u.ApiV2HeaderNames.CsrfToken])&&void 0!==r?r:"",r=s.getPath(),n=l.codec.utf8String.toBits(n),n=new l.misc.hmac(n,l.hash.sha256).encrypt(r),l.codec.base64url.fromBits(n));s.updateQuery({t:r});var n=new Blob([i,JSON.stringify(c.__assign(c.__assign({},o),{"Content-Type":a}))],{type:a}),r=navigator.sendBeacon(s.toString(),n),n={result:JSON.parse(JSON.stringify({beacon:r})),headers:o};return(r?t:e)(n)}):(new r.FetchAsyncTransport).executeRpc(s,o,i,a)},s);function s(){}e.BeaconTransport=n}),define("api_v2/types",["require","exports","tslib"],function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UnionStruct=e.UnionScalar=e.Union=e.TeamAuthRequestActionType=e.TeamAuthRequestRole=e.ApiV2HeaderNames=void 0,(n=e.ApiV2HeaderNames||(e.ApiV2HeaderNames={})).DropboxApiArg="Dropbox-API-Arg",n.DropboxApiSelectAdmin="Dropbox-API-Select-Admin",n.DropboxPathRoot="X-Dropbox-Path-Root",n.DropboxUid="X-Dropbox-Uid",n.DropboxTeamId="X-Dropbox-Teamid",n.DropboxTeamAuthorization="X-Dropbox-Team-Authorization",n.CsrfToken="X-CSRF-Token",(n=e.TeamAuthRequestRole||(e.TeamAuthRequestRole={}))[n.TeamAdminRole=0]="TeamAdminRole",n[n.MTARole=1]="MTARole",n[n.FederationAdminRole=2]="FederationAdminRole",(n=e.TeamAuthRequestActionType||(e.TeamAuthRequestActionType={}))[n.AdminAction=0]="AdminAction",n[n.AssumeAction=1]="AssumeAction",n[n.OnBehalfOfAction=2]="OnBehalfOfAction";var n=(s.parse=function(t){var e=t[".tag"];return 2===Object.keys(t).length&&null!=t[e]?new i(e,t[e]):new u(e,t)},s);function s(t,e,r){this.type=t,this.value=e,this.isScalar=r}e.Union=n;var o,i=(o=n,r.__extends(a,o),a.prototype.toJSON=function(){var t={".tag":this.type};return null!=this.value&&(t[this.type]=this.value),t},a);function a(t,e){return o.call(this,t,e=void 0===e?null:e,!0)||this}e.UnionScalar=i;var c,u=(c=n,r.__extends(l,c),l.prototype.toJSON=function(){return r.__assign({".tag":this.type},this.value)},l);function l(t,e){return c.call(this,t,e=void 0===e?{}:e,!1)||this}e.UnionStruct=u}),define("api_v2/noauth_client",["require","exports","tslib","api_v2/types","api_v2/client_base","modules/constants/request"],function(t,e,r,n,s,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoAuthApiV2Client=void 0;var i,s=(i=s.ApiV2ClientBase,r.__extends(a,i),a.prototype._headers=function(t){var e;return r.__assign(((e={})[n.ApiV2HeaderNames.DropboxUid]=String(o.LOGGED_OUT_X_DROPBOX_UID),e),t.headers)},a);function a(t){return i.call(this,t)||this}e.NoAuthApiV2Client=s}),define("api_v2/user_client",["require","exports","tslib","api_v2/types","api_v2/client_base","modules/clean/viewer"],function(t,e,n,s,r,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UserApiV2Client=void 0;var i,r=(i=r.ApiV2ClientBase,n.__extends(a,i),a.prototype._headers=function(t){var e,r=o.Viewer.get_viewer().get_user_by_id(t.subjectUserId);return n.__assign(((e={})[s.ApiV2HeaderNames.DropboxUid]=String(r.id),e[s.ApiV2HeaderNames.DropboxPathRoot]=String(r.root_ns_id),e),t.headers)},a);function a(t){return i.call(this,t)||this}e.UserApiV2Client=r}),define("modules/clean/devtools/panels/performance/perf_hub_actions",["require","exports","modules/clean/devtools/panels/performance/perf_hub_action_types","modules/clean/flux/dispatcher"],function(t,e,s,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PerfHubActions=void 0;var r=(n.prototype.add_ajax_profile=function(t,e,r,n){return o.Dispatcher.dispatch({type:s.ActionTypes.PROFILED_AJAX_LOAD_FINISHED,data:{url:t,serverResponseTime:e,profileRequestId:r,traceId:n}})},n.prototype.add_web_timing_details=function(t){return o.Dispatcher.dispatch({type:s.ActionTypes.WEB_TIMING_FETCHED,data:t})},n);function n(){}e.PerfHubActions=new r}),define("modules/clean/flux/dispatcher",["require","exports","tslib","flux","modules/core/exception"],function(t,e,r,n,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DispatcherClass=e.Dispatcher=void 0,n=r.__importStar(n),s=r.__importStar(s);var o,i=null,r=(o=n.Dispatcher,r.__extends(a,o),a.prototype.dispatch=function(t){s.assert(null!=t.type,"Invariant error: cannot dispatch action without 'type' property."),s.assert(null===i,"Invariant error: cannot dispatch "+t.type+" while also dispatching "+i+"."),i=t.type;try{"function"==typeof this.dispatch_begin&&this.dispatch_begin();try{return o.prototype.dispatch.call(this,{action:t})}catch(t){return s.reportException({err:t}),console.error(t)}finally{"function"==typeof this.dispatch_end&&this.dispatch_end()}}finally{i=null}},a);function a(){return null!==o&&o.apply(this,arguments)||this}r=new(e.DispatcherClass=r);e.Dispatcher=r}),define("modules/core/transport/fetch_utils",["require","exports","tslib"],function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.serialize=e.errorIsFetchResponseError=e.errorIsFetchFailError=e.errorIsFetchAbortError=e.FetchResponseError=e.FetchFailError=e.FetchAbortError=void 0;var n,s=(n=Error,r.__extends(o,n),o);function o(t,e){e=n.call(this,e)||this;return e.name="FetchAbortError",e.response=t,e}e.FetchAbortError=s;var i,s=(i=Error,r.__extends(a,i),a);function a(t,e){e=i.call(this,e)||this;return e.name="FetchFailError",e.response=t,e}e.FetchFailError=s;var c,r=(c=Error,r.__extends(u,c),u);function u(t,e){e=c.call(this,e)||this;return e.name="FetchResponseError",e.response=t,e}e.FetchResponseError=r,e.errorIsFetchAbortError=function(t){return"FetchAbortError"===t.name},e.errorIsFetchFailError=function(t){return"FetchFailError"===t.name},e.errorIsFetchResponseError=function(t){return"FetchResponseError"===t.name},e.serialize=function(t){function o(t,e){void 0!==e&&(e=null==e?"":e,r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(e))}function i(t){return"object"==typeof t&&null!==t}function a(r,t){if(Array.isArray(t))t.forEach(function(t,e){/\[\]$/.test(r)?o(r,t):i(t)?a(r+"["+e+"]",t):a(r,t)});else if(i(t))for(var e=0,n=Object.keys(t);e<n.length;e++){var s=n[e];a(r+"["+s+"]",t[s])}else o(r,t)}var r=[];if(Array.isArray(t))t.forEach(function(t,e){a(name,t)});else for(var e=0,n=Object.keys(t);e<n.length;e++){var s=n[e];a(s,t[s])}return r.join("&").replace(/%20/g,"+")}}),define("modules/clean/uuid/insecure_uuid",["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InsecureUUID=void 0;var r=function(){for(var t,e=[],r=t=0;t<=255;r=++t)e.push((r+256).toString(16).substr(1));return e}(),n=(s.bytesToHex=function(t){return t.map(function(t){return r[t]}).join("")},s.toByte=function(t){return 255&t},s.bytesToUUIDString=function(t){var e=this;return[t.slice(0,4),t.slice(4,6),t.slice(6,8),t.slice(8,10),t.slice(10,16)].map(function(t){return e.bytesToHex(t)}).join("-")},s.getRandomBytes=function(){var e=this,t=new Array(16);return this.getInsecureRandomValues(t),t.map(function(t){return e.toByte(t)})},s.getInsecureRandomValues=function(t){for(var e=Math.pow(2,8),r=0;r<t.length;r++)t[r]=Math.floor(Math.random()*e);return t},s.v4=function(){var t=this.getRandomBytes();return t[6]=15&t[6]|64,t[8]=63&t[8]|128,this.bytesToUUIDString(t)},s);function s(){}e.InsecureUUID=n}),define("modules/core/transport/query_string_helpers",["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TRACKING_PARAMS_LIST=e.parseQueryString=e.filterQueryObject=e.getQueryString=e.getTrackingParamsAsJSON=e.getTrackingParams=e.getParsedQueryString=void 0;var r=["gclid","oqa","trigger","_tk","_camp","_ad","_net","_kw","utm_campaign","utm_content","utm_medium","utm_source","utm_term","cont"];function n(t){return(t=void 0===t?window:t).location.search}function s(t){var e={};if(t.length)for(var r=0,n=t.substring(1).replace(/&amp;/g,"&").split("&");r<n.length;r++){var s=n[r].split("="),o=s[0],s=s[1];o&&s&&(o=o.trim(),s=s.trim(),o.length&&s.length&&(e[o]=decodeURIComponent(s.replace(/\+/g," "))))}return e}function o(r,t){return t.reduce(function(t,e){return r.hasOwnProperty(e)&&(t[e]=r[e]),t},{})}function i(t){return o(t||s(n()),r)}e.TRACKING_PARAMS_LIST=r,e.getQueryString=n,e.parseQueryString=s,e.getParsedQueryString=function(){return s(n())},e.filterQueryObject=o,e.getTrackingParams=i,e.getTrackingParamsAsJSON=function(){var t=i();return JSON.stringify(t)}}),define("prod_assets_web_modules/eventemitter3",["./common/_commonjsHelpers"],function(t){"use strict";return t.createCommonjsModule(function(t){var n=Object.prototype.hasOwnProperty,d="~";function r(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function s(t,e,r,n,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");s=new o(r,n||t,s),e=d?d+e:e;return t._events[e]?t._events[e].fn?t._events[e]=[t._events[e],s]:t._events[e].push(s):(t._events[e]=s,t._eventsCount++),t}function c(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function e(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(d=!1)),e.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)n.call(t,e)&&r.push(d?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},e.prototype.listeners=function(t){var t=d?d+t:t,e=this._events[t];if(!e)return[];if(e.fn)return[e.fn];for(var r=0,n=e.length,s=new Array(n);r<n;r++)s[r]=e[r].fn;return s},e.prototype.listenerCount=function(t){t=d?d+t:t,t=this._events[t];return t?t.fn?1:t.length:0},e.prototype.emit=function(t,e,r,n,s,o){var i=d?d+t:t;if(!this._events[i])return!1;var a,c=this._events[i],u=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,r),!0;case 4:return c.fn.call(c.context,e,r,n),!0;case 5:return c.fn.call(c.context,e,r,n,s),!0;case 6:return c.fn.call(c.context,e,r,n,s,o),!0}for(p=1,a=new Array(u-1);p<u;p++)a[p-1]=arguments[p];c.fn.apply(c.context,a)}else for(var l,h=c.length,p=0;p<h;p++)switch(c[p].once&&this.removeListener(t,c[p].fn,void 0,!0),u){case 1:c[p].fn.call(c[p].context);break;case 2:c[p].fn.call(c[p].context,e);break;case 3:c[p].fn.call(c[p].context,e,r);break;case 4:c[p].fn.call(c[p].context,e,r,n);break;default:if(!a)for(l=1,a=new Array(u-1);l<u;l++)a[l-1]=arguments[l];c[p].fn.apply(c[p].context,a)}return!0},e.prototype.on=function(t,e,r){return s(this,t,e,r,!1)},e.prototype.once=function(t,e,r){return s(this,t,e,r,!0)},e.prototype.removeListener=function(t,e,r,n){t=d?d+t:t;if(!this._events[t])return this;if(!e)return c(this,t),this;var s=this._events[t];if(s.fn)s.fn!==e||n&&!s.once||r&&s.context!==r||c(this,t);else{for(var o=0,i=[],a=s.length;o<a;o++)(s[o].fn!==e||n&&!s[o].once||r&&s[o].context!==r)&&i.push(s[o]);i.length?this._events[t]=1===i.length?i[0]:i:c(this,t)}return this},e.prototype.removeAllListeners=function(t){return t?(t=d?d+t:t,this._events[t]&&c(this,t)):(this._events=new r,this._eventsCount=0),this},e.prototype.off=e.prototype.removeListener,e.prototype.addListener=e.prototype.on,e.prefixed=d,t.exports=e.EventEmitter=e})}),define("prod_assets_web_modules/flux",["exports"],function(t){"use strict";function n(t,e,r,n,s,o,i,a){var c,u;if(!t)throw(e=void 0===e?new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings."):(c=[r,n,s,o,i,a],u=0,new Error("Invariant Violation: "+e.replace(/%s/g,function(){return c[u++]})))).framesToPop=1,e}var r=1;function e(){this.$Dispatcher_callbacks={},this.$Dispatcher_isPending={},this.$Dispatcher_isHandled={},this.$Dispatcher_isDispatching=!1,this.$Dispatcher_pendingPayload=null}e.prototype.register=function(t){var e="ID_"+r++;return this.$Dispatcher_callbacks[e]=t,e},e.prototype.unregister=function(t){n(this.$Dispatcher_callbacks[t],"Dispatcher.unregister(...): `%s` does not map to a registered callback.",t),delete this.$Dispatcher_callbacks[t]},e.prototype.waitFor=function(t){n(this.$Dispatcher_isDispatching,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var e=0;e<t.length;e++){var r=t[e];this.$Dispatcher_isPending[r]?n(this.$Dispatcher_isHandled[r],"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",r):(n(this.$Dispatcher_callbacks[r],"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",r),this.$Dispatcher_invokeCallback(r))}},e.prototype.dispatch=function(t){n(!this.$Dispatcher_isDispatching,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this.$Dispatcher_startDispatching(t);try{for(var e in this.$Dispatcher_callbacks)this.$Dispatcher_isPending[e]||this.$Dispatcher_invokeCallback(e)}finally{this.$Dispatcher_stopDispatching()}},e.prototype.isDispatching=function(){return this.$Dispatcher_isDispatching},e.prototype.$Dispatcher_invokeCallback=function(t){this.$Dispatcher_isPending[t]=!0,this.$Dispatcher_callbacks[t](this.$Dispatcher_pendingPayload),this.$Dispatcher_isHandled[t]=!0},e.prototype.$Dispatcher_startDispatching=function(t){for(var e in this.$Dispatcher_callbacks)this.$Dispatcher_isPending[e]=!1,this.$Dispatcher_isHandled[e]=!1;this.$Dispatcher_pendingPayload=t,this.$Dispatcher_isDispatching=!0},e.prototype.$Dispatcher_stopDispatching=function(){this.$Dispatcher_pendingPayload=null,this.$Dispatcher_isDispatching=!1};var s={Dispatcher:e};t.Dispatcher=e,t.default=s,Object.defineProperty(t,"__esModule",{value:!0})}),define("prod_assets_web_modules/reselect",["exports"],function(t){"use strict";function s(t,e){return t===e}function l(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:s,r=null,n=null;return function(){return function(t,e,r){if(null!==e&&null!==r&&e.length===r.length){for(var n=e.length,s=0;s<n;s++)if(!t(e[s],r[s]))return;return 1}}(e,r,arguments)||(n=t.apply(null,arguments)),r=arguments,n}}function e(c){for(var t=arguments.length,u=Array(1<t?t-1:0),e=1;e<t;e++)u[e-1]=arguments[e];return function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=0,s=e.pop(),o=function(t){if((t=Array.isArray(t[0])?t[0]:t).every(function(t){return"function"==typeof t}))return t;throw t=t.map(function(t){return typeof t}).join(", "),new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+t+"]")}(e),i=c.apply(void 0,[function(){return n++,s.apply(null,arguments)}].concat(u)),a=l(function(){for(var t=[],e=o.length,r=0;r<e;r++)t.push(o[r].apply(null,arguments));return i.apply(null,t)});return a.resultFunc=s,a.recomputations=function(){return n},a.resetRecomputations=function(){return n=0},a}}var r=e(l);t.createSelector=r,t.createSelectorCreator=e,t.createStructuredSelector=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var n=Object.keys(e);return t(n.map(function(t){return e[t]}),function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.reduce(function(t,e,r){return t[n[r]]=e,t},{})})},t.defaultMemoize=l,Object.defineProperty(t,"__esModule",{value:!0})});var F,G,H,I,J,K,s=void 0,u=!1,sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};function w(t,e,r){4!==e.length&&q(new sjcl.exception.invalid("invalid aes block size"));var n=t.b[r],s=e[0]^n[0],o=e[r?3:1]^n[1],i=e[2]^n[2];e=e[r?1:3]^n[3];var a,c,u,l=n.length/4-2,h=4,p=[0,0,0,0];t=(a=t.k[r])[0];for(var d=a[1],f=a[2],_=a[3],m=a[4],y=0;y<l;y++)a=t[s>>>24]^d[o>>16&255]^f[i>>8&255]^_[255&e]^n[h],c=t[o>>>24]^d[i>>16&255]^f[e>>8&255]^_[255&s]^n[h+1],u=t[i>>>24]^d[e>>16&255]^f[s>>8&255]^_[255&o]^n[h+2],e=t[e>>>24]^d[s>>16&255]^f[o>>8&255]^_[255&i]^n[h+3],h+=4,s=a,o=c,i=u;for(y=0;y<4;y++)p[r?3&-y:y]=m[s>>>24]<<24^m[o>>16&255]<<16^m[i>>8&255]<<8^m[255&e]^n[h++],a=s,s=o,o=i,i=e,e=a;return p}function x(t,e){for(var r,n,s=e.slice(0),e=t.r,o=t.b,i=e[0],a=e[1],c=e[2],u=e[3],l=e[4],h=e[5],p=e[6],d=e[7],f=0;f<64;f++)r=(r=f<16?s[f]:(r=s[f+1&15],n=s[f+14&15],s[15&f]=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+s[15&f]+s[f+9&15]|0))+d+(l>>>6^l>>>11^l>>>25^l<<26^l<<21^l<<7)+(p^l&(h^p))+o[f],d=p,p=h,h=l,l=u+r|0,u=c,c=a,i=r+((a=i)&c^u&(a^c))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;e[0]=e[0]+i|0,e[1]=e[1]+a|0,e[2]=e[2]+c|0,e[3]=e[3]+u|0,e[4]=e[4]+l|0,e[5]=e[5]+h|0,e[6]=e[6]+p|0,e[7]=e[7]+d|0}function C(t,e){var r,n=sjcl.random.w[t],s=[];for(r in n)n.hasOwnProperty(r)&&s.push(n[r]);for(r=0;r<s.length;r++)s[r](e)}function E(t){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?sjcl.random.addEntropy(window.performance.now(),t,"loadtime"):sjcl.random.addEntropy((new Date).valueOf(),t,"loadtime")}function A(t){t.b=B(t).concat(B(t)),t.A=new sjcl.cipher.aes(t.b)}function B(t){for(var e=0;e<4&&(t.f[e]=t.f[e]+1|0,!t.f[e]);e++);return t.A.encrypt(t.f)}function D(t,e){return function(){e.apply(t,arguments)}}"undefined"!=typeof module&&module.exports&&(module.exports=sjcl),"function"==typeof define&&define("prod_assets_web_modules/sjcl",[],function(){return sjcl}),sjcl.cipher.aes=function(t){this.k[0][0][0]||this.D();var e,r,n,s,o=this.k[0][4],i=this.k[1],a=1;for(4!==(e=t.length)&&6!==e&&8!==e&&q(new sjcl.exception.invalid("invalid aes key size")),this.b=[n=t.slice(0),s=[]],t=e;t<4*e+28;t++)r=n[t-1],(0==t%e||8===e&&4==t%e)&&(r=o[r>>>24]<<24^o[r>>16&255]<<16^o[r>>8&255]<<8^o[255&r],0==t%e&&(r=r<<8^r>>>24^a<<24,a=a<<1^283*(a>>7))),n[t]=n[t-e]^r;for(e=0;t;e++,t--)r=n[3&e?t:t-4],s[e]=t<=4||e<4?r:i[0][o[r>>>24]]^i[1][o[r>>16&255]]^i[2][o[r>>8&255]]^i[3][o[255&r]]},sjcl.cipher.aes.prototype={encrypt:function(t){return w(this,t,0)},decrypt:function(t){return w(this,t,1)},k:[[[],[],[],[],[]],[[],[],[],[],[]]],D:function(){for(var t,e,r,n,s,o,i=this.k[0],a=this.k[1],c=i[4],u=a[4],l=[],h=[],p=0;p<256;p++)h[(l[p]=p<<1^283*(p>>7))^p]=p;for(t=e=0;!c[t];t^=r||1,e=h[e]||1)for(s=(s=e^e<<1^e<<2^e<<3^e<<4)>>8^255&s^99,o=16843009*(n=l[p=l[r=l[u[c[t]=s]=t]]])^65537*p^257*r^16843008*t,n=257*l[s]^16843008*s,p=0;p<4;p++)i[p][t]=n=n<<24^n>>>8,a[p][s]=o=o<<24^o>>>8;for(p=0;p<5;p++)i[p]=i[p].slice(0),a[p]=a[p].slice(0)}},sjcl.bitArray={bitSlice:function(t,e,r){return t=sjcl.bitArray.P(t.slice(e/32),32-(31&e)).slice(1),r===s?t:sjcl.bitArray.clamp(t,r-e)},extract:function(t,e,r){var n=Math.floor(-e-r&31);return(-32&(e+r-1^e)?t[e/32|0]<<32-n^t[e/32+1|0]>>>n:t[e/32|0]>>>n)&(1<<r)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var r=t[t.length-1],n=sjcl.bitArray.getPartial(r);return 32===n?t.concat(e):sjcl.bitArray.P(e,n,0|r,t.slice(0,t.length-1))},bitLength:function(t){var e=t.length;return 0===e?0:32*(e-1)+sjcl.bitArray.getPartial(t[e-1])},clamp:function(t,e){if(32*t.length<e)return t;var r=(t=t.slice(0,Math.ceil(e/32))).length;return e&=31,0<r&&e&&(t[r-1]=sjcl.bitArray.partial(e,t[r-1]&2147483648>>e-1,1)),t},partial:function(t,e,r){return 32===t?e:(r?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(sjcl.bitArray.bitLength(t)!==sjcl.bitArray.bitLength(e))return u;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 0===r},P:function(t,e,r,n){var o=0;for(n===s&&(n=[]);32<=e;e-=32)n.push(r),r=0;if(0===e)return n.concat(t);for(o=0;o<t.length;o++)n.push(r|t[o]>>>e),r=t[o]<<32-e;return o=t.length?t[t.length-1]:0,t=sjcl.bitArray.getPartial(o),n.push(sjcl.bitArray.partial(e+t&31,32<e+t?r:n.pop(),1)),n},l:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]},byteswapM:function(t){for(var e,r=0;r<t.length;++r)e=t[r],t[r]=e>>>24|e>>>8&65280|(65280&e)<<8|e<<24;return t}},sjcl.codec.utf8String={fromBits:function(t){for(var e,r="",n=sjcl.bitArray.bitLength(t),s=0;s<n/8;s++)0==(3&s)&&(e=t[s/4]),r+=String.fromCharCode(e>>>24),e<<=8;return decodeURIComponent(escape(r))},toBits:function(t){t=unescape(encodeURIComponent(t));for(var e=[],r=0,n=0;n<t.length;n++)r=r<<8|t.charCodeAt(n),3==(3&n)&&(e.push(r),r=0);return 3&n&&e.push(sjcl.bitArray.partial(8*(3&n),r)),e}},sjcl.codec.hex={fromBits:function(t){for(var e="",r=0;r<t.length;r++)e+=(0xf00000000000+(0|t[r])).toString(16).substr(4);return e.substr(0,sjcl.bitArray.bitLength(t)/4)},toBits:function(t){var e,r=[],n=(t=t.replace(/\s|0x/g,"")).length;for(t+="00000000",e=0;e<t.length;e+=8)r.push(0^parseInt(t.substr(e,8),16));return sjcl.bitArray.clamp(r,4*n)}},sjcl.codec.base64={J:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,r){var n="",s=0,o=sjcl.codec.base64.J,i=0,a=sjcl.bitArray.bitLength(t);for(r&&(o=o.substr(0,62)+"-_"),r=0;6*n.length<a;)n+=o.charAt((i^t[r]>>>s)>>>26),s<6?(i=t[r]<<6-s,s+=26,r++):(i<<=6,s-=6);for(;3&n.length&&!e;)n+="=";return n},toBits:function(t,e){t=t.replace(/\s|=/g,"");var r,n,s=[],o=0,i=sjcl.codec.base64.J,a=0;for(e&&(i=i.substr(0,62)+"-_"),r=0;r<t.length;r++)(n=i.indexOf(t.charAt(r)))<0&&q(new sjcl.exception.invalid("this isn't base64!")),26<o?(s.push(a^n>>>(o-=26)),a=n<<32-o):a^=n<<32-(o+=6);return 56&o&&s.push(sjcl.bitArray.partial(56&o,a,1)),s}},sjcl.codec.base64url={fromBits:function(t){return sjcl.codec.base64.fromBits(t,1,1)},toBits:function(t){return sjcl.codec.base64.toBits(t,1)}},sjcl.hash.sha256=function(t){this.b[0]||this.D(),t?(this.r=t.r.slice(0),this.o=t.o.slice(0),this.h=t.h):this.reset()},sjcl.hash.sha256.hash=function(t){return(new sjcl.hash.sha256).update(t).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this.r=this.N.slice(0),this.o=[],this.h=0,this},update:function(t){"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t));var e=this.o=sjcl.bitArray.concat(this.o,t),r=this.h;for(t=this.h=r+sjcl.bitArray.bitLength(t),r=512+r&-512;r<=t;r+=512)x(this,e.splice(0,16));return this},finalize:function(){for(var t=this.o,e=this.r,r=(t=sjcl.bitArray.concat(t,[sjcl.bitArray.partial(1,1)])).length+2;15&r;r++)t.push(0);for(t.push(Math.floor(this.h/4294967296)),t.push(0|this.h);t.length;)x(this,t.splice(0,16));return this.reset(),e},N:[],b:[],D:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}var e,r=0,n=2;t:for(;r<64;n++){for(e=2;e*e<=n;e++)if(0==n%e)continue t;r<8&&(this.N[r]=t(Math.pow(n,.5))),this.b[r]=t(Math.pow(n,1/3)),r++}}},sjcl.mode.ccm={name:"ccm",encrypt:function(t,e,r,n,s){var o,i=e.slice(0),a=sjcl.bitArray,c=a.bitLength(r)/8,u=a.bitLength(i)/8;for(s=s||64,n=n||[],c<7&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")),o=2;o<4&&u>>>8*o;o++);return r=a.clamp(r,8*(15-(o=o<15-c?15-c:o))),e=sjcl.mode.ccm.L(t,e,r,n,s,o),i=sjcl.mode.ccm.p(t,i,r,e,s,o),a.concat(i.data,i.tag)},decrypt:function(t,e,r,n,s){s=s||64,n=n||[];var o=sjcl.bitArray,i=o.bitLength(r)/8,a=o.bitLength(e),c=o.clamp(e,a-s),u=o.bitSlice(e,a-s),a=(a-s)/8;for(i<7&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")),e=2;e<4&&a>>>8*e;e++);return r=o.clamp(r,8*(15-(e=e<15-i?15-i:e))),c=sjcl.mode.ccm.p(t,c,r,u,s,e),t=sjcl.mode.ccm.L(t,c.data,r,n,s,e),o.equal(c.tag,t)||q(new sjcl.exception.corrupt("ccm: tag doesn't match")),c.data},L:function(t,e,r,n,s,o){var i=[],a=sjcl.bitArray,c=a.l;if(((s/=8)%2||s<4||16<s)&&q(new sjcl.exception.invalid("ccm: invalid tag length")),(4294967295<n.length||4294967295<e.length)&&q(new sjcl.exception.bug("ccm: can't deal with 4GiB or more data")),o=[a.partial(8,(n.length?64:0)|s-2<<2|o-1)],(o=a.concat(o,r))[3]|=a.bitLength(e)/8,o=t.encrypt(o),n.length)for((r=a.bitLength(n)/8)<=65279?i=[a.partial(16,r)]:r<=4294967295&&(i=a.concat([a.partial(16,65534)],[r])),i=a.concat(i,n),n=0;n<i.length;n+=4)o=t.encrypt(c(o,i.slice(n,n+4).concat([0,0,0])));for(n=0;n<e.length;n+=4)o=t.encrypt(c(o,e.slice(n,n+4).concat([0,0,0])));return a.clamp(o,8*s)},p:function(t,e,r,n,s,o){var i=sjcl.bitArray,a=i.l,c=e.length,u=i.bitLength(e);if(r=i.concat([i.partial(8,o-1)],r).concat([0,0,0]).slice(0,4),n=i.bitSlice(a(n,t.encrypt(r)),0,s),!c)return{tag:n,data:[]};for(a=0;a<c;a+=4)r[3]++,s=t.encrypt(r),e[a]^=s[0],e[a+1]^=s[1],e[a+2]^=s[2],e[a+3]^=s[3];return{tag:n,data:i.clamp(e,u)}}},sjcl.mode.ocb2={name:"ocb2",encrypt:function(t,e,r,n,s,o){128!==sjcl.bitArray.bitLength(r)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits"));var i,a=sjcl.mode.ocb2.H,c=sjcl.bitArray,u=c.l,l=[0,0,0,0];r=a(t.encrypt(r));var h,p=[];for(n=n||[],s=s||64,i=0;i+4<e.length;i+=4)l=u(l,h=e.slice(i,i+4)),p=p.concat(u(r,t.encrypt(u(r,h)))),r=a(r);return h=e.slice(i),e=c.bitLength(h),i=t.encrypt(u(r,[0,0,0,e])),h=c.clamp(u(h.concat([0,0,0]),i),e),l=u(l,u(h.concat([0,0,0]),i)),l=t.encrypt(u(l,u(r,a(r)))),n.length&&(l=u(l,o?n:sjcl.mode.ocb2.pmac(t,n))),p.concat(c.concat(h,c.clamp(l,s)))},decrypt:function(t,e,r,n,s,o){128!==sjcl.bitArray.bitLength(r)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits")),s=s||64;var i,a,c=sjcl.mode.ocb2.H,u=sjcl.bitArray,l=u.l,h=[0,0,0,0],p=c(t.encrypt(r)),d=sjcl.bitArray.bitLength(e)-s,f=[];for(n=n||[],r=0;r+4<d/32;r+=4)i=l(p,t.decrypt(l(p,e.slice(r,r+4)))),h=l(h,i),f=f.concat(i),p=c(p);return i=t.encrypt(l(p,[0,0,0,a=d-32*r])),i=l(i,u.clamp(e.slice(r),a).concat([0,0,0])),h=l(h,i),h=t.encrypt(l(h,l(p,c(p)))),n.length&&(h=l(h,o?n:sjcl.mode.ocb2.pmac(t,n))),u.equal(u.clamp(h,s),u.bitSlice(e,d))||q(new sjcl.exception.corrupt("ocb: tag doesn't match")),f.concat(u.clamp(i,a))},pmac:function(t,e){for(var r=sjcl.mode.ocb2.H,n=sjcl.bitArray,s=n.l,o=[0,0,0,0],i=s(i=t.encrypt([0,0,0,0]),r(r(i))),a=0;a+4<e.length;a+=4)i=r(i),o=s(o,t.encrypt(s(i,e.slice(a,a+4))));return a=e.slice(a),n.bitLength(a)<128&&(i=s(i,r(i)),a=n.concat(a,[-2147483648,0,0,0])),o=s(o,a),t.encrypt(s(r(s(i,r(i))),o))},H:function(t){return[t[0]<<1^t[1]>>>31,t[1]<<1^t[2]>>>31,t[2]<<1^t[3]>>>31,t[3]<<1^135*(t[0]>>>31)]}},sjcl.mode.gcm={name:"gcm",encrypt:function(t,e,r,n,s){var o=e.slice(0);return e=sjcl.bitArray,t=sjcl.mode.gcm.p(!0,t,o,n=n||[],r,s||128),e.concat(t.data,t.tag)},decrypt:function(t,e,r,n,s){var o=e.slice(0),i=sjcl.bitArray,a=i.bitLength(o);return n=n||[],o=(s=s||128)<=a?(e=i.bitSlice(o,a-s),i.bitSlice(o,0,a-s)):(e=o,[]),t=sjcl.mode.gcm.p(u,t,o,n,r,s),i.equal(t.tag,e)||q(new sjcl.exception.corrupt("gcm: tag doesn't match")),t.data},Z:function(t,e){for(var r,n,s=sjcl.bitArray.l,o=[0,0,0,0],i=e.slice(0),a=0;a<128;a++){for((r=0!=(t[Math.floor(a/32)]&1<<31-a%32))&&(o=s(o,i)),n=0!=(1&i[3]),r=3;0<r;r--)i[r]=i[r]>>>1|(1&i[r-1])<<31;i[0]>>>=1,n&&(i[0]^=-520093696)}return o},g:function(t,e,r){var n,s=r.length;for(e=e.slice(0),n=0;n<s;n+=4)e[0]^=4294967295&r[n],e[1]^=4294967295&r[n+1],e[2]^=4294967295&r[n+2],e[3]^=4294967295&r[n+3],e=sjcl.mode.gcm.Z(e,t);return e},p:function(t,e,r,n,s,o){var i,a,c,u=sjcl.bitArray,l=r.length,h=u.bitLength(r),p=u.bitLength(n),d=u.bitLength(s),f=e.encrypt([0,0,0,0]);for(s=96===d?(s=s.slice(0),u.concat(s,[1])):(s=sjcl.mode.gcm.g(f,[0,0,0,0],s),sjcl.mode.gcm.g(f,s,[0,0,Math.floor(d/4294967296),4294967295&d])),d=sjcl.mode.gcm.g(f,[0,0,0,0],n),c=s.slice(0),n=d.slice(0),t||(n=sjcl.mode.gcm.g(f,d,r)),a=0;a<l;a+=4)c[3]++,i=e.encrypt(c),r[a]^=i[0],r[a+1]^=i[1],r[a+2]^=i[2],r[a+3]^=i[3];return r=u.clamp(r,h),t&&(n=sjcl.mode.gcm.g(f,d,r)),t=[Math.floor(p/4294967296),4294967295&p,Math.floor(h/4294967296),4294967295&h],n=sjcl.mode.gcm.g(f,n,t),i=e.encrypt(s),n[0]^=i[0],n[1]^=i[1],n[2]^=i[2],n[3]^=i[3],{tag:u.bitSlice(n,0,o),data:r}}},sjcl.misc.hmac=function(t,e){this.M=e=e||sjcl.hash.sha256;var r,n=[[],[]],s=e.prototype.blockSize/32;for(this.n=[new e,new e],t.length>s&&(t=e.hash(t)),r=0;r<s;r++)n[0][r]=909522486^t[r],n[1][r]=1549556828^t[r];this.n[0].update(n[0]),this.n[1].update(n[1]),this.G=new e(this.n[0])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(t){return this.Q&&q(new sjcl.exception.invalid("encrypt on already updated hmac called!")),this.update(t),this.digest(t)},sjcl.misc.hmac.prototype.reset=function(){this.G=new this.M(this.n[0]),this.Q=u},sjcl.misc.hmac.prototype.update=function(t){this.Q=!0,this.G.update(t)},sjcl.misc.hmac.prototype.digest=function(){var t=this.G.finalize(),t=new this.M(this.n[1]).update(t).finalize();return this.reset(),t},sjcl.misc.pbkdf2=function(t,e,r,n,s){r=r||1e3,(n<0||r<0)&&q(sjcl.exception.invalid("invalid params to pbkdf2")),"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t)),"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),t=new(s=s||sjcl.misc.hmac)(t);for(var o,i,a,c=[],u=sjcl.bitArray,l=1;32*c.length<(n||1);l++){for(s=o=t.encrypt(u.concat(e,[l])),i=1;i<r;i++)for(o=t.encrypt(o),a=0;a<o.length;a++)s[a]^=o[a];c=c.concat(s)}return c=n?u.clamp(c,n):c},sjcl.prng=function(t){this.c=[new sjcl.hash.sha256],this.i=[0],this.F=0,this.s={},this.C=0,this.K={},this.O=this.d=this.j=this.W=0,this.b=[0,0,0,0,0,0,0,0],this.f=[0,0,0,0],this.A=s,this.B=t,this.q=u,this.w={progress:{},seeded:{}},this.m=this.V=0,this.t=1,this.u=2,this.S=65536,this.I=[0,48,64,96,128,192,256,384,512,768,1024],this.T=3e4,this.R=80},sjcl.prng.prototype={randomWords:function(t,e){var r=[];if((s=this.isReady(e))===this.m&&q(new sjcl.exception.notReady("generator isn't seeded")),s&this.u){var n,s=!(s&this.t),o=[],i=0;for(this.O=o[0]=(new Date).valueOf()+this.T,n=0;n<16;n++)o.push(4294967296*Math.random()|0);for(n=0;n<this.c.length&&(o=o.concat(this.c[n].finalize()),i+=this.i[n],this.i[n]=0,s||!(this.F&1<<n));n++);for(this.F>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.i.push(0)),this.d-=i,i>this.j&&(this.j=i),this.F++,this.b=sjcl.hash.sha256.hash(this.b.concat(o)),this.A=new sjcl.cipher.aes(this.b),s=0;s<4&&(this.f[s]=this.f[s]+1|0,!this.f[s]);s++);}for(s=0;s<t;s+=4)0==(s+1)%this.S&&A(this),o=B(this),r.push(o[0],o[1],o[2],o[3]);return A(this),r.slice(0,t)},setDefaultParanoia:function(t,e){0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e&&q("Setting paranoia=0 will ruin your security; use it only for testing"),this.B=t},addEntropy:function(t,e,r){r=r||"user";var n,o,i=(new Date).valueOf(),a=this.s[r],c=this.isReady(),u=0;switch((n=this.K[r])===s&&(n=this.K[r]=this.W++),a===s&&(a=this.s[r]=0),this.s[r]=(this.s[r]+1)%this.c.length,typeof t){case"number":e===s&&(e=1),this.c[a].update([n,this.C++,1,e,i,1,0|t]);break;case"object":if("[object Uint32Array]"===(r=Object.prototype.toString.call(t))){for(o=[],r=0;r<t.length;r++)o.push(t[r]);t=o}else for("[object Array]"!==r&&(u=1),r=0;r<t.length&&!u;r++)"number"!=typeof t[r]&&(u=1);if(!u){if(e===s)for(r=e=0;r<t.length;r++)for(o=t[r];0<o;)e++,o>>>=1;this.c[a].update([n,this.C++,2,e,i,t.length].concat(t))}break;case"string":e===s&&(e=t.length),this.c[a].update([n,this.C++,3,e,i,t.length]),this.c[a].update(t);break;default:u=1}u&&q(new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string")),this.i[a]+=e,this.d+=e,c===this.m&&(this.isReady()!==this.m&&C("seeded",Math.max(this.j,this.d)),C("progress",this.getProgress()))},isReady:function(t){return t=this.I[t!==s?t:this.B],this.j&&this.j>=t?this.i[0]>this.R&&(new Date).valueOf()>this.O?this.u|this.t:this.t:this.d>=t?this.u|this.m:this.m},getProgress:function(t){return t=this.I[t||this.B],this.j>=t||this.d>t?1:this.d/t},startCollectors:function(){this.q||(this.a={loadTimeCollector:D(this,this.aa),mouseCollector:D(this,this.ba),keyboardCollector:D(this,this.$),accelerometerCollector:D(this,this.U),touchCollector:D(this,this.da)},window.addEventListener?(window.addEventListener("load",this.a.loadTimeCollector,u),window.addEventListener("mousemove",this.a.mouseCollector,u),window.addEventListener("keypress",this.a.keyboardCollector,u),window.addEventListener("devicemotion",this.a.accelerometerCollector,u),window.addEventListener("touchmove",this.a.touchCollector,u)):document.attachEvent?(document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)):q(new sjcl.exception.bug("can't attach event")),this.q=!0)},stopCollectors:function(){this.q&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,u),window.removeEventListener("mousemove",this.a.mouseCollector,u),window.removeEventListener("keypress",this.a.keyboardCollector,u),window.removeEventListener("devicemotion",this.a.accelerometerCollector,u),window.removeEventListener("touchmove",this.a.touchCollector,u)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.q=u)},addEventListener:function(t,e){this.w[t][this.V++]=e},removeEventListener:function(t,e){var r,n,s=this.w[t],o=[];for(n in s)s.hasOwnProperty(n)&&s[n]===e&&o.push(n);for(r=0;r<o.length;r++)delete s[n=o[r]]},$:function(){E(1)},ba:function(t){var e,r;try{e=t.x||t.clientX||t.offsetX||0,r=t.y||t.clientY||t.offsetY||0}catch(t){r=e=0}0!=e&&0!=r&&sjcl.random.addEntropy([e,r],2,"mouse"),E(0)},da:function(t){t=t.touches[0]||t.changedTouches[0],sjcl.random.addEntropy([t.pageX||t.clientX,t.pageY||t.clientY],1,"touch"),E(0)},aa:function(){E(2)},U:function(t){var e;t=t.accelerationIncludingGravity.x||t.accelerationIncludingGravity.y||t.accelerationIncludingGravity.z,window.orientation&&"number"==typeof(e=window.orientation)&&sjcl.random.addEntropy(e,1,"accelerometer"),t&&sjcl.random.addEntropy(t,2,"accelerometer"),E(0)}},sjcl.random=new sjcl.prng(6);t:try{if(I="undefined"!=typeof module){if(J=module.exports){try{K=require("crypto")}catch(t){K=null}J=(G=K)&&G.randomBytes}I=J}if(I)F=G.randomBytes(128),F=new Uint32Array(new Uint8Array(F).buffer),sjcl.random.addEntropy(F,1024,"crypto['randomBytes']");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(H=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(H);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)break t;window.msCrypto.getRandomValues(H)}sjcl.random.addEntropy(H,1024,"crypto['getRandomValues']")}}catch(t){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(t))}sjcl.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},Y:function(t,e,r,n){r=r||{},n=n||{};var s,o=sjcl.json,i=o.e({iv:sjcl.random.randomWords(4,0)},o.defaults);return o.e(i,r),r=i.adata,"string"==typeof i.salt&&(i.salt=sjcl.codec.base64.toBits(i.salt)),"string"==typeof i.iv&&(i.iv=sjcl.codec.base64.toBits(i.iv)),(!sjcl.mode[i.mode]||!sjcl.cipher[i.cipher]||"string"==typeof t&&i.iter<=100||64!==i.ts&&96!==i.ts&&128!==i.ts||128!==i.ks&&192!==i.ks&&256!==i.ks||i.iv.length<2||4<i.iv.length)&&q(new sjcl.exception.invalid("json encrypt: invalid parameters")),"string"==typeof t?(t=(s=sjcl.misc.cachedPbkdf2(t,i)).key.slice(0,i.ks/32),i.salt=s.salt):sjcl.ecc&&t instanceof sjcl.ecc.elGamal.publicKey&&(s=t.kem(),i.kemtag=s.tag,t=s.key.slice(0,i.ks/32)),"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),"string"==typeof r&&(i.adata=r=sjcl.codec.utf8String.toBits(r)),s=new sjcl.cipher[i.cipher](t),o.e(n,i),n.key=t,i.ct=sjcl.mode[i.mode].encrypt(s,e,i.iv,r,i.ts),i},encrypt:function(t,e,r,n){var s=sjcl.json,o=s.Y.apply(s,arguments);return s.encode(o)},X:function(t,e,r,n){r=r||{},n=n||{};var s,o=sjcl.json,i=(e=o.e(o.e(o.e({},o.defaults),e),r,!0)).adata;return"string"==typeof e.salt&&(e.salt=sjcl.codec.base64.toBits(e.salt)),"string"==typeof e.iv&&(e.iv=sjcl.codec.base64.toBits(e.iv)),(!sjcl.mode[e.mode]||!sjcl.cipher[e.cipher]||"string"==typeof t&&e.iter<=100||64!==e.ts&&96!==e.ts&&128!==e.ts||128!==e.ks&&192!==e.ks&&256!==e.ks||!e.iv||e.iv.length<2||4<e.iv.length)&&q(new sjcl.exception.invalid("json decrypt: invalid parameters")),"string"==typeof t?(t=(s=sjcl.misc.cachedPbkdf2(t,e)).key.slice(0,e.ks/32),e.salt=s.salt):sjcl.ecc&&t instanceof sjcl.ecc.elGamal.secretKey&&(t=t.unkem(sjcl.codec.base64.toBits(e.kemtag)).slice(0,e.ks/32)),"string"==typeof i&&(i=sjcl.codec.utf8String.toBits(i)),s=new sjcl.cipher[e.cipher](t),i=sjcl.mode[e.mode].decrypt(s,e.ct,e.iv,i,e.ts),o.e(n,e),n.key=t,1===r.raw?i:sjcl.codec.utf8String.fromBits(i)},decrypt:function(t,e,r,n){var s=sjcl.json;return s.X(t,s.decode(e),r,n)},encode:function(t){var e,r="{",n="";for(e in t)if(t.hasOwnProperty(e))switch(e.match(/^[a-z0-9]+$/i)||q(new sjcl.exception.invalid("json encode: invalid property name")),r+=n+'"'+e+'":',n=",",typeof t[e]){case"number":case"boolean":r+=t[e];break;case"string":r+='"'+escape(t[e])+'"';break;case"object":r+='"'+sjcl.codec.base64.fromBits(t[e],0)+'"';break;default:q(new sjcl.exception.bug("json encode: unsupported type"))}return r+"}"},decode:function(t){(t=t.replace(/\s/g,"")).match(/^\{.*\}$/)||q(new sjcl.exception.invalid("json decode: this isn't json!")),t=t.replace(/^\{|\}$/g,"").split(/,/);for(var e,r={},n=0;n<t.length;n++)(e=t[n].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i))||q(new sjcl.exception.invalid("json decode: this isn't json!")),e[3]?r[e[2]]=parseInt(e[3],10):e[4]?r[e[2]]=e[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(e[4]):unescape(e[4]):e[5]&&(r[e[2]]="true"===e[5]);return r},e:function(t,e,r){if(t===s&&(t={}),e===s)return t;for(var n in e)e.hasOwnProperty(n)&&(r&&t[n]!==s&&t[n]!==e[n]&&q(new sjcl.exception.invalid("required parameter overridden")),t[n]=e[n]);return t},fa:function(t,e){var r,n={};for(r in t)t.hasOwnProperty(r)&&t[r]!==e[r]&&(n[r]=t[r]);return n},ea:function(t,e){for(var r={},n=0;n<e.length;n++)t[e[n]]!==s&&(r[e[n]]=t[e[n]]);return r}},sjcl.encrypt=sjcl.json.encrypt,sjcl.decrypt=sjcl.json.decrypt,sjcl.misc.ca={},sjcl.misc.cachedPbkdf2=function(t,e){var r=sjcl.misc.ca,n=(e=e||{}).iter||1e3;return(n=(r=r[t]=r[t]||{})[n]=r[n]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):sjcl.random.randomWords(2,0)})[r=e.salt===s?n.firstSalt:e.salt]=n[r]||sjcl.misc.pbkdf2(t,r,e.iter),{key:n[r].slice(0),salt:r.slice(0)}};
