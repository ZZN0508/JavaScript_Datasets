!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("wafer-toggle",[],t):"object"==typeof exports?exports["wafer-toggle"]=t():(e.wafer=e.wafer||{},e.wafer.wafers=e.wafer.wafers||{},e.wafer.wafers["wafer-toggle"]=t())}("undefined"!=typeof self?self:this,function(){return r={"./src/base.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);return void 0!==o?"value"in o?o.value:void 0!==(o=o.get)?o.call(r):void 0:null===(e=Object.getPrototypeOf(e))?void 0:n(e,t,r)}var f=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],o=!0,n=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(o=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){n=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(n)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},o=function(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),e},a=window.wafer,i=a.constants,s=a.utils,a=a.WaferBaseClass,c=s.bindEvent,d=s.convertNodeListToArray,p=s.findAncestor,y=s.setTimeout,l=s.unbindEvent,g=i.ATTR_PREFIX,m=["key"],b=["click","mouseenter","mouseEnterDelay","mouseleave","mouseLeaveDelay","onLoad","touchend","touchmove","touchstart"],w=window.wafer.base,o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(_,a),o(_,[{key:"addAria",value:function(){var e=this._util,t=e.ariaExpanded,r=e.elem,e=e.targetSelector;r.setAttribute("aria-expanded",Boolean(Number(t)));e=e.substring(1);document.getElementById(e)&&r.setAttribute("aria-controls",e)}},{key:"addEventListeners",value:function(){var e=this._util,t=e.elem,r=e.events;if(0!==r.size){var o=!0,n=!1,a=void 0;try{for(var i,s=r.keys()[Symbol.iterator]();!(o=(i=s.next()).done);o=!0){var l=i.value,u=this._state.isClickAndMouseExit="clickAndMouseExit"===l;"click"===l||u?t.classList.add("has-toggle-click","has-wafer-click"):"onLoad"!==l&&("clickOutside"!==l?0===l.indexOf("swipe")?(c(t,"touchstart",this.touchstart),c(t,"touchend",this.touchend),c(t,"touchmove",this.touchmove,{passive:!1})):0===l.indexOf("touch")||c(t,l,this[l]):this._state.isClickOutside=!0)}}catch(e){n=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(n)throw a}}}}},{key:"removeEventListeners",value:function(){var e=this._util.elem;l(e,"touchstart",this.touchstart),l(e,"touchend",this.touchend),l(e,"touchmove",this.touchmove,{passive:!1}),l(e,"mouseenter",this.mouseEnterDelay),l(e,"mouseleave",this.mouseLeaveDelay),l(e,"mouseenter",this.mouseenter),l(e,"mouseleave",this.mouseleave)}},{key:"click",value:function(e){this._util.preventBrowserDefaultBehavior&&(e.preventDefault(),e.stopPropagation()),this._state.isClickAndMouseExit&&(e=this._util.elem,c(e,"mouseenter",this.mouseEnterDelay),c(e,"mouseleave",this.mouseLeaveDelay)),this.processTargets("click")}},{key:"onLoad",value:function(){this.processTargets("onLoad")}},{key:"mouseenter",value:function(){this.processTargets("mouseenter")}},{key:"mouseEnterDelay",value:function(){clearTimeout(this._state.clickAndMouseExitTimeout)}},{key:"mouseleave",value:function(){this.processTargets("mouseleave")}},{key:"mouseLeaveDelay",value:function(){var e=this;this._state.clickAndMouseExitTimeout&&clearTimeout(this._state.clickAndMouseExitTimeout);var t=this._util.delay;this._state.clickAndMouseExitTimeout=y(function(){e.processTargets("clickAndMouseExit")},t,this)}},{key:"touchstart",value:function(e){var t=this._util.drag,r=e.touches[0],e=r.clientY,r=r.pageX;t.startX=r,t.startY=e}},{key:"touchend",value:function(e){this.clearDrag()}},{key:"touchmove",value:function(e){var t=this._util.drag;t.endX=e.touches[0].pageX,t.endY=e.touches[0].clientY;var r=0;t.startX!==t.endX&&(r=t.startX>t.endX?1:-1),t.overallDirectionX=r,this.isValidSwipe()&&(e.cancelable&&e.preventDefault(),this.triggerSwipe(),this.clearDrag(),this.touchstart(e))}},{key:"isValidSwipe",value:function(){var e=this._util,t=Math.abs(e.drag.startX-e.drag.endX);return 30<t&&t>Math.abs(e.drag.startY-e.drag.endY)}},{key:"triggerSwipe",value:function(){var e=this._util;1===e.drag.overallDirectionX?this.swipeleft():-1===e.drag.overallDirectionX&&this.swiperight()}},{key:"swipeleft",value:function(){this.processTargets("swipeleft")}},{key:"swiperight",value:function(){this.processTargets("swiperight")}},{key:"clearDrag",value:function(){this._util.drag={endX:0,endY:0,overallDirectionX:0,startX:0,startY:0}}},{key:"executeAction",value:function(e,t,r,o,n,a){var i,s=this._util,l=s.ariaExpanded,u=s.ariaExpandedClass,c=s.elem,f=s.focusTarget,d=s.preventScroll,h=s.setFocus,s=s.syncDelay;t.classList[o](n),a&&y(function(){window.wafer.base.sync(t)},s,this),h&&(i=d?{preventScroll:!0}:void 0,y(function(){f.focus(i),f!==document.activeElement&&(f.setAttribute("tabIndex","-1"),f.focus(i))},5)),l&&("true"===c.getAttribute("aria-expanded")?(c.setAttribute("aria-expanded","false"),c.classList.remove(u)):(c.setAttribute("aria-expanded","true"),c.classList.add(u))),w._emit({elem:c,meta:{action:r,className:n,eventName:e,target:t},name:_.name},"toggle:change")}},{key:"processTargets",value:function(s){var t,l=this,e=this._util,u=e.boundaryElem,c=e.delay,r=e.events,o=e.focusSelector,n=e.setFocus,e=e.targetSelector;r.has(s)&&(t=r.get(s),this.getTargets(e,u).forEach(function(i){var e=(l._util.focusTarget||Boolean(n&&o))&&i.querySelector(o)||i;l._util.focusTarget=l._util.focusTarget||e,t.forEach(function(e){var t=f(e,2),r=t[0],o=t[1],e=i.classList,n=r.replace("WithSyncDelay","").replace("WithSync","").replace("WithDelay",""),t=-1!==r.indexOf("WithSyncDelay"),a=t||-1!==r.indexOf("WithSync"),t=t||-1!==r.indexOf("WithDelay");"removeFromOthers"===n?d((u||document).getElementsByClassName(o)).forEach(function(e){e!==i&&e.classList.remove(o)}):e[n]&&(e=e.contains(o),l.didComplete(null),("toggle"===n||"remove"===n&&e||"add"===n&&!e)&&(t?y(function(){l.executeAction(s,i,r,n,o,a)},c,l):l.executeAction(s,i,r,n,o,a)))})}))}},{key:"getTargets",value:function(e,t){return e&&"string"==typeof e?d((t||document).querySelectorAll(e)):[this._util.elem]}},{key:"remove",value:function(){this._util.elem.remove()}},{key:"handleClickOutside",value:function(e){this._state.isClickOutside&&((0,e.waferComposedMap)().get(this._util.elem)||this.processTargets("clickOutside"))}},{key:"stateDidUpdate",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).stateAttr,t=this._util.events;"key"===e&&t.has("stateChange")&&("1"===this._util.key?t.get("stateChange")[0][0]="add":t.get("stateChange")[0][0]="remove",this.processTargets("stateChange"))}},{key:"destroy",value:function(){this.removeEventListeners(),n(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"destroy",this).call(this)}}]),_);function _(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,_);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(_.__proto__||Object.getPrototypeOf(_)).call(this,e,{},{STATE_ATTRS:m})),r=e.getAttribute(g+"toggle-aria-expanded"),o=e.getAttribute(g+"toggle-delay"),n=e.getAttribute(g+"toggle-class")||"",a=e.getAttribute(g+"toggle-prevent-browser-default-behavior"),i=e.getAttribute(g+"toggle-prevent-scroll"),s=e.getAttribute(g+"sync-delay"),l=e.getAttribute(g+"toggle-target"),u=e.getAttribute(g+"toggle-boundary"),c=e.getAttribute(g+"toggle-aria-expanded-class"),f=e.getAttribute(g+"toggle-set-focus"),d=null;"string"==typeof f&&"NaN"===String(Number(f))&&(d=f,f="1");var h,l=t._util=v({},t._util,{ariaExpanded:r,ariaExpandedClass:null==c?0:c,boundaryElem:u&&p(e,u),delay:null==o?0:Number(o),drag:{endX:0,endY:0,overallDirectionX:0,startX:0,startY:0},elem:e,focusSelector:d,focusTarget:null,preventBrowserDefaultBehavior:null==a?0:Number(a),preventScroll:null==i?0:Number(i),setFocus:null==f?0:Number(f),syncDelay:null==s?0:Number(s),targetSelector:l});return t._state=v({},t._state,{clickAndMouseExitTimeout:null,isClickAndMouseExit:!1}),r&&t.addAria(),n&&(b.forEach(function(e){t[e]=t[e].bind(t)}),l.events=(n=n,h=new Map,n&&"string"==typeof n&&n.split(";").forEach(function(e){var t=e.split(":");3===t.length&&(e=t[0],h.has(e)||h.set(e,[]),h.get(e).push(t.slice(1)))}),h),l.events.get("onLoad")&&t.processTargets("onLoad"),t.addEventListeners()),t}function u(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}o.events={click:[["has-toggle-click","click"]]},t.default=o,e.exports=t.default},"./src/controller.js":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);return void 0!==o?"value"in o?o.value:void 0!==(o=o.get)?o.call(r):void 0:null===(e=Object.getPrototypeOf(e))?void 0:n(e,t,r)}var a,r=function(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),e},i=window.wafer.controllers.WaferBaseController,s=window.wafer.utils,l=s.bindEvent,u=s.unbindEvent,c=["_handleKeyDown"],r=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,i),r(f,[{key:"addEventListeners",value:function(){l(document,"keydown",this._handleKeyDown)}},{key:"_handleKeyDown",value:function(e){if(27===(e=e||window.event).keyCode){var t=this._state.elementInstances,r=!0,o=!1,n=void 0;try{for(var a,i=t.values()[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value.instance;s.processTargets("clickOutside"),s.processTargets("clickAndMouseExit")}}catch(e){o=!0,n=e}finally{try{!r&&i.return&&i.return()}finally{if(o)throw n}}}}},{key:"destroy",value:function(e){n(f.prototype.__proto__||Object.getPrototypeOf(f.prototype),"destroy",this).call(this,e),e||u(document,"keydown",this._handleKeyDown)}}]),f);function f(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.root,t=void 0===t?document:t,e=e.selector,e=void 0===e?".wafer-toggle":e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,{root:t,selector:e,WaferClass:(a||(e=o("./src/base.js"),a=e&&e.__esModule?e:{default:e})).default}));return r.sync(),c.forEach(function(e){r[e]=r[e].bind(r)}),r.addEventListeners(),r}function d(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}t.default=r,e.exports=t.default},"./src/entry.js":function(e,t,r){"use strict";var o,n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=new(o||(n=r("./src/controller.js"),o=n&&n.__esModule?n:{default:n})).default({}),e.exports=t.default}},n={},o.m=r,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="https://s.yimg.com/aaq/wf/",o(o.s="./src/entry.js");function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}var r,n});
