(this.$WP=this.$WP||[]).push(["VANuRt",(e,r)=>{"use strict";var o,a,n,t,l,i,s,d,u,c,h,p,m,f,w=({options:e,onReady:r,onShowOverlay:a})=>{var[n,t]=o.useState(),[i,s]=o.useState(),[d,u]=o.useState(!1),c=f(),{onSuccess:w,isFullWidthMobile:g,roundedCorners:v}=e,C=o.useCallback(e=>{var r,o=e.resultData||"";if(o){var a=(e=>{var r={};try{r=JSON.parse(e)}catch(r){return console.error("Error parsing controller result data: "+e),null}return"object"!=typeof r?(console.error("Parsed controller result is not an object."),null):{userId:r.user_id,hasCreatedMember:!!r.hasCreatedMember,hasAcceptedTermsOfUse:!!r.hasAcceptedTermsOfUse,loginProvider:r.loginProvider}})(o);null==a||a.hasCreatedMember,c((null==a?void 0:a.hasCreatedMember)?"CREATE":"LOGIN",null==a?void 0:a.userId,"SUCCESS"),w&&w(a)}else w&&w(null);e.jsCallback&&(r=e.jsCallback)&&console.error("Non-empty JSCallback is returned from RegController: "+r)},[w,c]),{viewportCategory:S}=o.useContext(l),O=o.useCallback(e=>{e>100&&t("MOBILE"===S&&g?"100%":e)},[S,g]),{displayOnShowOverlay:y,onClose:b,onFailure:k}=e,I=o.useCallback(e=>{var o=e,n=(e=>{if(!e)return null;if(!e.origin||0!==e.origin.indexOf("https")||e.origin!==document.location.origin)return null;if(!e.data||!e.data.indexOf||-1===e.data.indexOf("action"))return null;try{var r=JSON.parse(e.data);return r.action?r:null}catch(e){return null}})(o);if((e=>{e&&e.origin&&0===e.origin.indexOf("https://smartlock.google.com")&&e.data&&e.data.type&&e.source&&e.source.postMessage({type:"verifyAck",data:e.data.data},"https://smartlock.google.com")})(o),n){var{action:t}=n;switch(t){case"successClose":C(n);break;case"reloadWindow":console.error("Unexpected reload window message is received from RegController iframe");break;case"fwdToRelativeUrl":var l=n.url||"";l||console.error("No url specified to forward to."),0!==l.indexOf("/")&&console.error("Cannot forward to absolute url: "+l),window.location=l;break;case"resizeFrame":O(n.width),n.height>100&&s(Math.min(n.height,window.innerHeight));break;case"domReady":u(!0),r&&r();break;case"dismiss":b&&b();break;case"showOverlay":y&&a&&a();break;case"generalError":k&&k()}}},[C,y,a,b,r,O,k]);p("message",I);var x=o.useMemo(()=>{var r=e.extraQueryParams||{};Object.keys(r).forEach(e=>{void 0===r[e]&&delete r[e]});var o=new URLSearchParams(Object.assign({flow:e.flow,flowOrigin:e.flowOrigin,pid:""+e.pid,hideNavigation:"true",userRequestedForce:"true",returnTo:"",isLithium:"true"},r));return e.mcid&&o.append("mcid",""+e.mcid),e.locationId&&o.append("locationId",""+e.locationId),e.stateToken&&o.append("stateToken",e.stateToken),void 0!==e.requireSecure&&o.append("requireSecure",""+String(!!e.requireSecure)),"/RegistrationController?"+o.toString()},[e.extraQueryParams,e.flow,e.flowOrigin,e.locationId,e.mcid,e.pid,e.requireSecure,e.stateToken]);return o.createElement("div",{className:h("_8RLaCUf_",{"_1ic0q52-":v}),style:{width:n,height:i}},o.createElement(m,{className:"_30pzQStV",src:x,title:"regcontroller",style:{width:n,height:i,display:d?"block":"none"}}))},g=({options:e,closeX:r})=>{var[a,n]=o.useState(!1),t=o.useCallback(()=>{e.displayOnShowOverlay||n(!0)},[e.displayOnShowOverlay]),l=o.useCallback(()=>{n(!0)},[]),i=o.useMemo(()=>o.createElement(w,{options:e,onReady:t,onShowOverlay:l}),[t,e,l]);return o.createElement(u,{onClose:e.onClose,containerProps:{backgroundColor:"transparent",disableBodyScroll:!0},bodyProps:{isFullBleed:!0},enableCloseIcon:a&&r,roundedCorners:e.roundedCorners,hideBoxShadow:e.hideBoxShadow},o.createElement("div",{style:{display:a?"block":"none"}},i),!a&&o.createElement("div",{className:"nUBQ6pZw"},o.createElement(c,{size:"large",variant:"primary"})))},v=()=>{var{userId:e}=o.useContext(i),[r]=o.useContext(s),l=o.useContext(d),u=r.params.geoId||void 0,[c,h]=o.useState({flow:"CORE_COMBINED",flowOrigin:"join",pid:-1}),[p,m]=o.useState({closeX:!0}),f=t(),w=o.useRef(void 0),v=n(()=>o.createElement(g,{options:c,closeX:p.closeX}),{},[c,p]);return{login:o.useCallback(o=>e&&!o.forceLogin?Promise.resolve({userId:e,hasCreatedMember:null}):w.current?w.current:a()?("undefined"!=typeof window&&(window.location=`/RegistrationController?flow=${encodeURIComponent(o.flow||"CORE_COMBINED")}&pid=${encodeURIComponent(String(o.pid||-1))}&returnTo=${encodeURIComponent(r.path)}&fullscreen=true`),new Promise(()=>{})):(w.current=new Promise(e=>{h({flow:o.flow||"CORE_COMBINED",flowOrigin:o.flowOrigin||"join",pid:o.pid||-1,isFullWidthMobile:o.isFullWidthMobile||!1,roundedCorners:o.roundedCorners||!1,hideBoxShadow:o.hideBoxShadow||!1,extraQueryParams:o.extraQueryParams||{},displayOnShowOverlay:o.deferShowOverlay,requireSecure:o.requireSecure||!1,locationId:u||-1,onSuccess:r=>{var a={userId:(null==r?void 0:r.userId)||null,hasCreatedMember:!!(null==r?void 0:r.hasCreatedMember),loginProvider:null==r?void 0:r.loginProvider};o.onSuccess&&o.onSuccess(a),v.close(),w.current=null,l({userId:a.userId}),e(a)},onClose:()=>{f({module:"regoverlay",action:"closed",context:[u||"",o.flow].join("|"),value:o.pid||void 0,nonInteraction:!1}),v.close(),w.current=null,o.onClose&&o.onClose()},onFailure:()=>{o.onFailure&&o.onFailure()}}),m({closeX:!1!==o.closeX}),v.open()}),w.current),[e,r.path,u,v,l,f]),close:v.close}},C=({flow:e,flowOrigin:r="login",pid:a=-1,isFullWidthMobile:n=!1,forceLogin:t=!1,extraQueryParams:l={},deferShowLogin:s=!0,requireSecure:u=!1,onLoginSuccess:c,onLoginFailure:h,onShowOverlay:p})=>{var{userId:m}=o.useContext(i),f=o.useContext(d),g={flow:e,flowOrigin:r,pid:a,isFullWidthMobile:n,extraQueryParams:l,displayOnShowOverlay:s,requireSecure:u,onSuccess:e=>{c&&c(),f({userId:(null==e?void 0:e.userId)||null})},onFailure:()=>{h&&h()}};return m&&!t?null:o.createElement(w,{options:g,onShowOverlay:p})};return[()=>{e("default",v),e("AuthGate",C)},[e=>o=e,e=>a=e.default,e=>n=e.useVDOMPortal,e=>t=e.useGARecorder,e=>(l=e.Device,i=e.Visitor,s=e.Route,d=e.Authenticate),e=>u=e.default,e=>c=e.LoadingSpinner,e=>h=e.default,e=>p=e.useWindow,e=>m=e.EmbeddedContent,e=>f=e.useUserAccountSiftTrackingAction]]},["cDcdfi","SfdMbo","vq6MSq","fsml46","2R4xv2","O8LbtK","V08PS7","jSLlaY","Dg5_-9","m5ZZFI","f9x1OV"]]);