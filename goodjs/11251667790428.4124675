define(["require","exports","tslib","classnames","react","modules/core/i18n","modules/clean/auth/common/inputs/checkbox","modules/clean/auth/common/inputs/text","modules/clean/auth/common/captcha","modules/clean/auth/common/types","modules/clean/auth/register/google_register_button","modules/clean/auth/register/name_fields","modules/clean/react/file_viewer/conversions/conversion_utils","modules/clean/auth/common/stats"],function(e,t,a,P,k,R,x,w,A,I,T,V,L,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterFormView=void 0,P=a.__importDefault(P);var o,a=(o=(k=a.__importDefault(k)).default.Component,a.__extends(r,o),r.prototype.handleCaptchaErrors=function(e){return A.handle_captcha_errors(this.captchaComponent,e)},r.prototype.getCaptchaComponent=function(){return this.captchaComponent},r.prototype.getCaptchaResponses=function(){return A.get_captcha_responses(this.captchaComponent)},r.prototype.onContinue=function(){this.setState({splitSignupStep:1}),s.EmailAuthUXAnalyticsLogger.logSplitSignupContinue()},r.prototype.render=function(){var e=this,t=this.props,a=t.className,s=t.variant,o=t.thirdPartyInitiatedSignup,r=t.tosCheckboxProps,i=t.onGoogleRegisterClick,n=t.disabled,l=t.isSubmitting,p=t.maestroStyle,m=t.onInputChange,u=t.showMarketingOptIn,d=t.marketingOptInChecked,c=t.splitSignupEnabled,h=P.default("form_shown","login-form-container","register",a,s,{third_party_auth:o,"login-form-container--maestro":p}),f=r||{},g=void 0;f.unsafeLabelHTML||(g=R.intl.formatMessage({id:"mOJi1I",defaultMessage:"I agree to the <a>Dropbox Terms</a>"},{a:function(e){return k.default.createElement("a",{href:"/terms",target:"_blank",rel:"noreferrer noopener"},e)}}));var b=this.props.submitButtonProps||{},S=P.default("login-button","button-primary",b.className,{"button-small":b.variant===I.AuthButtonVariant.SMALL,"button-big":b.variant===I.AuthButtonVariant.BIG}),C=P.default("continue-button","button-primary",b.className,{"button-small":b.variant===I.AuthButtonVariant.SMALL,"button-big":b.variant===I.AuthButtonVariant.BIG}),E=this.props.thirdPartyInitiatedSignup,_=!!this.props.googleRegisterProps&&!E,M=this.props.googleRegisterProps||{},v=k.default.createElement(T.GoogleRegisterButton,{onClick:i,disabled:n||l,buttonProps:M.buttonProps}),y=k.default.createElement("div",{className:"hr-label"},k.default.createElement("span",{className:"hr-label__text"},R.intl.formatMessage({id:"F1g1bb",defaultMessage:"or"}))),N=this.props.emailProps||{},t=P.default("input-email","text-input__margin-right",N.className),a=this.props.passwordProps||{},o=P.default("input-password",a.className),r=this.props.maestroStyle;"TOP"===M.position?r=!0:"BOTTOM"===M.position&&(r=!1);i=f.variant||s,l=void 0===f.inline||f.inline,M=E?R.intl.formatMessage({id:"j7O6M6",defaultMessage:"Create and continue"}):b.text||R.intl.formatMessage({id:"P09UfX",defaultMessage:"Create an account"}),E=R.intl.formatMessage({id:"pV/Btf",defaultMessage:"Continue"}),N=k.default.createElement(w.AuthTextField,{value:this.props.emailValue,className:t,onChange:m,disabled:n||N.readonly||!1,label:N.label||(p?R.intl.formatMessage({id:"ZuKPpH",defaultMessage:"Email"}):void 0),placeholder:N.placeholder||(this.props.maestroStyle?R.intl.formatMessage({id:"87vAZJ",defaultMessage:"you@mail.com"}):R.intl.formatMessage({id:"ZbTBdC",defaultMessage:"Email"})),error:this.props.emailError,maestroStyle:p,name:"email",type:I.AuthTextInputType.EMAIL,variant:s});return c&&0===this.state.splitSignupStep?k.default.createElement("div",{className:h},k.default.createElement("form",{className:"clearfix credentials-form register-form",onSubmit:this.props.onClickSignUp,method:"post"},k.default.createElement("div",{className:"credentials-form__fields"},k.default.createElement("div",{className:"register-form__credential-fields"}),k.default.createElement("div",{className:"split-signup-fields"},N,k.default.createElement("button",{className:C,type:"submit","data-uxa-log":"register_form_continue_button",onClick:function(){return e.onContinue()}},k.default.createElement("span",null,E)))),_&&k.default.createElement("div",{className:"hr-split-signup"}),_&&v,_&&k.default.createElement(A.Captcha,{ref:this.setCaptchaComponent,email:this.props.emailValue,onSubmit:this.props.onSubmit,onReady:this.props.onCaptchaReady,source:"REGISTER"}))):k.default.createElement("div",{className:h},k.default.createElement("form",{className:"clearfix credentials-form register-form",onSubmit:this.props.onClickSignUp,method:"post"},r&&_&&v,r&&_&&y,k.default.createElement("div",{className:"credentials-form__fields"},k.default.createElement(V.RegisterFormNameFields,{maestroStyle:p,onInputChange:m,combinedName:this.props.combinedName,fnameError:this.props.fnameError,fnameProps:this.props.fnameProps,lnameProps:this.props.lnameProps,fnameValue:this.props.fnameValue,lnameValue:this.props.lnameValue,disabled:n,variant:s}),k.default.createElement("div",{className:"register-form__credential-fields"},N,!this.props.thirdPartyInitiatedSignup&&k.default.createElement(w.AuthTextField,{value:this.props.passwordValue,placeholder:a.placeholder||(this.props.maestroStyle?R.intl.formatMessage({id:"klwYHA",defaultMessage:"Minimum 6 characters"}):R.intl.formatMessage({id:"i+PJQ7",defaultMessage:"Password"})),name:"password",className:o,inputClassName:"password-input",onChange:m,measureStrength:a.measureStrength,label:a.label||(p?R.intl.formatMessage({id:"i+PJQ7",defaultMessage:"Password"}):void 0),error:this.props.passwordError,maestroStyle:p,disabled:n,variant:s,passwordStrengthProps:a.strengthMeterProps,type:I.AuthTextInputType.PASSWORD}))),!L.shouldShowSimplifiedModal()&&k.default.createElement(A.Captcha,{ref:this.setCaptchaComponent,email:this.props.emailValue,onSubmit:this.props.onSubmit,onReady:this.props.onCaptchaReady,source:"REGISTER"}),k.default.createElement(x.AuthCheckbox,{variant:i,className:"agree",disabled:f.disabled||n,maestroStyle:p,error:this.props.tosError,inline:l,onChange:m,name:"tos_agree",checked:this.props.tosChecked,label:f.label||g,unsafeLabelHTML:f.unsafeLabelHTML}),u&&k.default.createElement(x.AuthCheckbox,{variant:i,className:"agree marketing-opt-in-checkbox",disabled:n,maestroStyle:p,inline:l,onChange:m,checked:d,name:"marketing_opt_in",label:R.intl.formatMessage({id:"vRE9NS",defaultMessage:"Iâ€™d like to receive direct marketing email updates from Dropbox"})}),k.default.createElement("button",{className:S,type:"submit","data-uxa-log":"register_form_submit_button",disabled:this.props.disabled||b.disabled||this.props.isSubmitting},k.default.createElement("span",null,M)),!r&&_&&!L.shouldShowSimplifiedModal()&&y,!r&&_&&v,L.shouldShowSimplifiedModal()&&k.default.createElement(A.Captcha,{ref:this.setCaptchaComponent,email:this.props.emailValue,onSubmit:this.props.onSubmit,onReady:this.props.onCaptchaReady,source:"REGISTER"})))},r);function r(){var t=null!==o&&o.apply(this,arguments)||this;return t.state={splitSignupStep:0},t.setCaptchaComponent=function(e){t.captchaComponent=e},t}t.RegisterFormView=a});
