define("liveProgram",[],function(){return function(){function seedfn(e,t,i){window.setInterval(function(){SetRemainTime(e,t,i)},1e3)}function SetRemainTime(nowTime,obj,data){var saveNowTime=nowTime,datas=null;seed++,nowTime+=seed;var datas=obj,showTime=timestampToTime(nowTime);timestampToTime(saveNowTime)!=showTime&&(datas=eval(data[Number(showTime.replace(/\./g,""))])),$.each(datas,function(e,t){nowTime>=t.timeU&&(nNextIndex=e)}),(nThisIndex<nNextIndex||0==nNextIndex)&&(templatefn(showTime,datas[nNextIndex]),nThisIndex=nNextIndex)}function templatefn(e,t){t='<ul><li class="fl"><span>'+e+"</span><em>"+t.time+'</em></li>       <li class="fl cctv6-live-title">'+t.title+'</li>       <li class="fr ctv6-live-right"><i></i><b>鐩存挱涓�</b></li></ul>';$(".module-cctv6-item").empty().append(t)}function timestampToTime(e){var t=new Date(1e3*e),i=t.getFullYear()+".",l=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+".",e=(t.getDate()<10?"0"+t.getDate():t.getDate())+" ";return t.getHours(),t.getHours(),t.getMinutes(),t.getMinutes(),t.getSeconds(),t.getSeconds(),i+l+e}var nThisIndex=0,nNextIndex=0,seed=0;$.ajax({type:"GET",url:"/inc/2020/getEpginfo.json",jsonpCallback:"epginfo2020",dataType:"jsonp",success:function(data,status,xhr){var servertime,nowTime,curDate,showTime,datas_current,defaultList,thisIndex,nextIndex;data?(servertime=xhr.getResponseHeader("Date"),nowTime=Date.parse(servertime)/1e3,curDate=timestampToTime(nowTime).replace(/\./g,""),showTime=timestampToTime(nowTime),datas_current=eval(data[Number(curDate)]),defaultList="",thisIndex=0,nextIndex=0,$.each(datas_current,function(e,t){nowTime>=datas_current[e].timeU&&(nextIndex=e)}),(thisIndex<nextIndex||0==nextIndex)&&(defaultList='<ul><li class="fl"><span>'+showTime+"</span><em>"+datas_current[nextIndex].time+'</em></li>          <li class="fl cctv6-live-title">'+datas_current[nextIndex].title+'</li>          <li class="fr ctv6-live-right"><i></i><b>鐩存挱涓�</b></li></ul>',$(".module-cctv6-item").empty().append(defaultList),thisIndex=nextIndex),seedfn(nowTime,datas_current,data)):$(".module-cctv6-item").empty().append('<ul><li class="cctv6-live-title">鑺傜洰鍗曡幏鍙栧け璐�</li></ul>')},error:function(e){$(".module-cctv6-item").empty().append('<ul><li class="cctv6-live-title">鑺傜洰鍗曡幏鍙栧け璐�</li></ul>')}})}}),define("liveVideo",["//js.static.m1905.cn/player/2.0.0/liveplayer.min.js"],function(t){return function(e){return new t({container:$(".live-common"),cid:e.cid,live:0!=e.live||e.live,flash:{configUrl:e.configUrl},video:{url:e.video,pic:e.pic}})}}),define("mvideo",["liveVideo"],function(u){return function(){function l(e){switch(s&&s.destroy(),m&&m.destroy(),e.status){case 0:(s=u({cid:e.cid,live:!1,configUrl:e.lookback_xml_url,video:e.lookback_rtmp_url})).init(),$(".m-live-notice,.m_live,.m_notice,.icon_live,.icon_yg").hide(),$(".m_back").find("strong").html(e.title),$(".live-common,.m_back").show();break;case 1:(s=u({cid:e.cid,live:!0,configUrl:e.live_xml_url,video:e.live_rtmp_url})).init(),$(".m-live-notice,.m_back,.m_notice,.icon_yg").hide(),$(".m_live .cctv6-live-title").html(e.title),$(".m_live,.live-common,.m_live .ctv6-live-right,.icon_live").show(),v=setInterval(function(){n(!1,!0)},6e4);break;case 2:$(".live-common").css("background-image","url(//static.m1905.cn/homepage2020/PC/images/m_nodata.jpg)"),$(".m_back,.m-live-notice,.m_notice,.m_live .ctv6-live-right,.icon_yg").hide(),$(".live-common,.m_live,icon_live").show(),$(".m_live .cctv6-live-title").html(e.title),d=setInterval(function(){n(!0,!1)},6e4);break;case 3:$(".live-common,.m_live,.m_back,.icon_live").hide(),$(".notice-first").html(e.title),$(".m-live-notice,.m_notice,.icon_yg").show(),$(".leftTime").find("em").html(e.start_time_info),a(e.targetTime,e.stime,function(e,t,i,l){0==e&&0==t&&0==i&&0==l?(clearInterval(r),n(!0,!0)):($(".m_day").html(e),$(".m_hour").html(t),$(".m_mins").html(i),$(".m_secs").html(l))})}}function n(i,l){$.ajax({type:"GET",url:"/api/content/?m=Live&a=m1905HomeLive&type=live",dataType:"jsonp",cache:!1,success:function(e){var t;200==e.code?(t=e.info.status,$(".icon_live").show(),$(".icon_yg").hide(),1!==t?(clearInterval(v),localStorage.setItem("mvideo_status",JSON.stringify({status:t})),o(l,e.info)):(clearInterval(d),localStorage.setItem("mvideo_status",JSON.stringify({status:t})),o(i,e.info))):300==e.code?(t=e.info.status,clearInterval(v),clearInterval(d),localStorage.setItem("mvideo_status",JSON.stringify({status:t})),s&&s.destroy(),(s=u({status:e.info.status,cid:e.info.cid,live:!1,configUrl:e.info.lookback_xml_url,video:e.info.lookback_rtmp_url})).init(),$(".m_live,.m_notice,.m-live-notice,.icon_live,.icon_yg").hide(),$(".live-common,.m_back").show(),$(".m_back").find("strong").html(e.info.title)):(clearInterval(v),clearInterval(d),localStorage.setItem("mvideo_status",JSON.stringify({status:t})),$(".m_back,.m-live-notice,.m_notice,.icon_yg,.icon_live").hide(),$(".live-common,.m_live").show(),$(".m_live .cctv6-live-title").html(e.info.title),$(".live-common").css("background-image","url(//static.m1905.cn/homepage2020/PC/images/m_nodata.jpg)"))},error:function(e){clearInterval(v),clearInterval(d),$(".m_back,.m-live-notice,.m_notice").hide(),$(".live-common,.m_live").show(),$(".m_live .cctv6-live-title").html(window.liveObj.mvideo.title),$(".live-common").css("background-image","url(//static.m1905.cn/homepage2020/PC/images/m_nodata.jpg)")}})}function o(e,t){e&&l({cid:t.cid,live:t.live,status:t.status,title:t.title,start_time_info:t.start_time_info,live_xml_url:t.live_xml_url,live_rtmp_url:t.live_rtmp_url,lookback_xml_url:t.lookback_xml_url,lookback_rtmp_url:t.lookback_rtmp_url})}function a(e,t,n){var o=e-t;r=setInterval(function(){var e,t,i,l;0<--o?(e=Math.floor(o%60),t=Math.floor(o/60%60),i=Math.floor(o/3600%24),l=Math.floor(o/3600/24),n(l=l<=9?"0"+l:l,i=i<=9?"0"+i:i,t=t<=9?"0"+t:t,e=e<=9?"0"+e:e)):(n(0,0,0,0),clearInterval(r))},1e3)}var t,c=!0,s=(JSON.parse(localStorage.getItem("mvideo_status")),null),m=u(window.liveObj.cctv6),r=null,v=null,d=null;clearInterval(null),$.ajax({type:"GET",url:"/api/content/?m=Live&a=m1905HomeLive",dataType:"jsonp",success:function(e,t,i){if(200==e.code){var l=e.info,i=i.getResponseHeader("Date");switch(Date.parse(i),localStorage.setItem("mvideo_status",JSON.stringify({status:l.status})),l.status){case 1:(s=u({cid:l.cid,live:!0,configUrl:l.live_xml_url,video:l.live_rtmp_url})).init(),$(".live-module-left h3 span.active").removeClass("active").siblings().addClass("active"),$(".infosWrap").eq(1).show().siblings().hide(),$(".m-live-notice,.m_back,.m_notice,.icon_yg").hide(),$(".m_live .cctv6-live-title").html(l.title),$(".m_live,.live-common,.m_live .ctv6-live-right,.icon_live").show(),c=!c,v=setInterval(function(){n(!1,!0)},6e4);break;case 2:$(".live-module-left h3 span.active").removeClass("active").siblings().addClass("active"),$(".infosWrap").eq(1).show().siblings().hide(),$(".live-common").css("background-image","url(//static.m1905.cn/homepage2020/PC/images/m_nodata.jpg)"),$(".m_back,.m-live-notice,.m_notice,.m_live .ctv6-live-right,.icon_yg").hide(),$(".live-common,.m_live,.icon_live").show(),$(".m_live .cctv6-live-title").html(l.title),c=!c,d=setInterval(function(){n(!0,!1)},6e4);break;case 3:m.init(),$(".icon_yg").show(),$(".icon_live").hide();break;default:m.init()}}},error:function(e){console.log(e)}}),$(".live-module-left h3 span").click(function(){t=JSON.parse(localStorage.getItem("mvideo_status"));var e=$(this).index();e!=$(".live-module-left span.active").index()&&($("video").each(function(){$(this).attr("src",""),$(this).remove()}),c?(clearInterval(null),m.destroy(),t&&t.status==window.liveObj.mvideo.status?3==t.status?$.ajax({type:"GET",url:"/inc/2020/getEpginfo.json",jsonpCallback:"epginfo2020",dataType:"jsonp",success:function(e,t,i){e&&(i=i.getResponseHeader("Date"),i=Date.parse(i)/1e3,$(".live-common,.m_live").hide(),$(".m-live-notice,.m_notice").show(),$(".notice-first").html(window.liveObj.mvideo.title),$(".leftTime").find("em").html(window.liveObj.mvideo.start_time_info),a(window.liveObj.mvideo.start_time,i,function(e,t,i,l){0==e&&0==t&&0==i&&0==l?(clearInterval(r),n(!0,!0)):($(".m_day").html(e),$(".m_hour").html(t),$(".m_mins").html(i),$(".m_secs").html(l))}))},error:function(e){console.log(e)}}):l(window.liveObj.mvideo):$.ajax({type:"GET",url:"/api/content/?m=Live&a=m1905HomeLive",dataType:"jsonp",success:function(e,t,i){200==e.code&&(e=e.info,i=i.getResponseHeader("Date"),i=Date.parse(i)/1e3,localStorage.setItem("mvideo_status",JSON.stringify({status:e.status})),l({cid:e.cid,live:e.live,status:e.status,targetTime:e.start_time,stime:i,title:e.title,start_time_info:e.start_time_info,live_xml_url:e.live_xml_url,live_rtmp_url:e.live_rtmp_url,lookback_xml_url:e.lookback_xml_url,lookback_rtmp_url:e.lookback_rtmp_url}))},error:function(e){console.log(e)}})):(clearInterval(r),clearTimeout(null),clearInterval(v),clearInterval(d),s&&s.destroy(),(m=u(window.liveObj.cctv6)).init(),$(".live-common").show(),$(".m-live-notice,.m_notice").hide()),c=!c,$(this).addClass("active").siblings().removeClass("active"),$(".infosWrap").eq(e).show().siblings().hide())})}}),require.config({baseUrl:"js"}),require(["liveProgram","mvideo"],function(e,t){$(function(){e(),t()})}),define("index",function(){});
