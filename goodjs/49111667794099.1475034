(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{1543:function(e,t,n){"use strict";n.r(t),n(7);var o=n(0),s=(n(29),n(24));n(6),n(4),n(158);var i,r=(n(19),n(11),n(14),n(13),n(1));function a(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach(function(e){Object(r.a)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var u={methods:{trackEvent:function(e){var t="page"===e.event?["olog"]:["olog","snowplow"];return this.$tracker.track(c(c({},e),{},{trackers:t}))},logEvent:function(n){var r=this;return Object(o.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=c({},n),{}.hasOwnProperty.call(n.data||{},"id")&&(t.data.id=r.$store.state.context.user.uid),e.next=5,r.trackEvent(t);case 5:case"end":return e.stop()}},e)}))()},logImpressionEvent:function(t,n){var r=this;return Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!i&&n)return e.next=3,r.logEvent(n);e.next=4;break;case 3:i=!0;case 4:return e.next=6,r.logEvent(t);case 6:case"end":return e.stop()}},e)}))()},extendLogData:function(e,t){return c(c({},e),{},{data:c(c({},e.data||{}),t)})}}},n=n(2),u={mixins:[Object(n.a)(u,void 0,void 0,!1,null,null,null).exports],props:{clientId:{type:String,required:!0}},methods:{authorize:function(e){this.processGoogleOneTapUser(e)},logWidget:function(e,t){this.logEvent({event:e,sublocation:"one_tap_sign_up",label:t})},processGoogleOneTapUser:function(n){var r=this;return Object(o.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.$iovation.bbPromise;case 2:return t=e.sent,e.next=5,r.signUpWithOneTap(n,t);case 5:case"end":return e.stop()}},e)}))()},signUpWithOneTap:function(i,a){var c=this;return Object(o.a)(regeneratorRuntime.mark(function e(){var t,n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.authorizeWithOneTap(i);case 2:if(r=e.sent,o=r.login,t=r.redirectTo,o)return e.next=8,c.logIn(a,o,i);e.next=19;break;case 8:if(n=e.sent){e.next=11;break}return e.abrupt("return");case 11:if(r=n.success,o=n.mode,r||"password"!==o){e.next=15;break}return function(e){var r=document.createElement("form");r.method="post",r.action="/ab/account-security/sso",Object.entries({id_token:e,state:"?ssoProvider=google"}).forEach(function(e){var t=Object(s.a)(e,2),n=t[0],e=t[1],t=document.createElement("input");t.name=n,t.value=e,r.appendChild(t)}),document.body.appendChild(r),r.submit()}(i),e.abrupt("return");case 15:c.logWidget("click","existing_user_with_one_tap"),window.location.href="/signup/home/",e.next=20;break;case 19:t&&(c.logWidget("click","new_user_with_one_tap"),window.location.href=t);case 20:case"end":return e.stop()}},e)}))()},authorizeWithOneTap:function(e){return this.$http({handleApiErrors:!1}).url("/signup/one-tap-redirect-url?credential=".concat(encodeURI(e))).get().json()},logIn:function(n,r,o){var i=this;return this.$http({handleApiErrors:!1}).url("/ab/account-security/login").get().json().then(function(e){var t=e.fields,e=e.redirectUrl;if(!t)return e&&(window.location.href=e),!1;e={};return e[t.mode]="sso",e[t.iovation]=n,e[t.sso_user_data]={email:r,authResponse:{id_token:o},provider:"google"},i.$http({handleApiErrors:!1}).url("/ab/account-security/login").post(e).json()})}},head:function(){var n=this;return{script:[{hid:"google-qsi-client",src:"https://accounts.google.com/gsi/client",defer:!0,callback:function(){var e,t;e=n.clientId,t=n.authorize,(0,n.logWidget)("impression","show_widget"),window.google.accounts.id.initialize({client_id:e,callback:function(e){t(e.credential)},cancel_on_tap_outside:!1}),window.google.accounts.id.prompt()}}]}}},u=Object(n.a)(u,function(){var e=this.$createElement;return(this._self._c||e)("div")},[],!1,null,null,null);t.default=u.exports}}]);
