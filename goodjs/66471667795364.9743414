!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):e.videojsPlaylist=t(e.videojs)}(this,function(r){"use strict";r=r&&r.hasOwnProperty("default")?r.default:r;var a=function(e){var t=e.playlist.autoadvance_;t.timeout&&e.clearTimeout(t.timeout),t.trigger&&e.off("ended",t.trigger),t.timeout=null,t.trigger=null},l=function t(r,n){var e;a(r),"number"==typeof(e=n)&&!isNaN(e)&&0<=e&&e<1/0?(r.playlist.autoadvance_.delay=n,r.playlist.autoadvance_.trigger=function(){function e(){return t(r,n)}r.one("play",e),r.playlist.autoadvance_.timeout=r.setTimeout(function(){a(r),r.off("play",e),r.playlist.next()},1e3*n)},r.one("ended",r.playlist.autoadvance_.trigger)):r.playlist.autoadvance_.delay=null},c=function(e,t){var r=!e.paused()||e.ended();return e.trigger("beforeplaylistitem",t),e.poster(t.poster||""),e.src(t.sources),function(e){for(var t=e.remoteTextTracks(),r=t&&t.length||0;r--;)e.removeRemoteTextTrack(t[r])}(e),e.ready(function(){(t.textTracks||[]).forEach(e.addRemoteTextTrack.bind(e)),e.trigger("playlistitem",t),r&&e.play(),l(e,e.playlist.autoadvance_.delay)}),e},s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(e){return this._invoke("next",e)},e.prototype.throw=function(e){return this._invoke("throw",e)},e.prototype.return=function(e){return this._invoke("return",e)};function f(e){this.value=e}function e(o){var i,u;function a(e,t){try{var r=o[e](t),n=r.value;n instanceof f?Promise.resolve(n.value).then(function(e){a("next",e)},function(e){a("throw",e)}):l(r.done?"return":"normal",r.value)}catch(e){l("throw",e)}}function l(e,t){switch(e){case"return":i.resolve({value:t,done:!0});break;case"throw":i.reject(t);break;default:i.resolve({value:t,done:!1})}(i=i.next)?a(i.key,i.arg):u=null}this._invoke=function(r,n){return new Promise(function(e,t){t={key:r,arg:n,resolve:e,reject:t,next:null};u?u=u.next=t:(i=u=t,a(r,n))})},"function"!=typeof o.return&&(this.return=void 0)}var d=function(e,t){for(var r,n,o,i=0;i<e.length;i++){var u=e[i].sources;if(Array.isArray(u))for(var a=0;a<u.length;a++){var l=u[a];if(l&&(o=n=void 0,o=r=t,"object"===(void 0===(n=l=l)?"undefined":s(l))&&(n=l.src),"object"===(void 0===r?"undefined":s(r))&&(o=r.src),/^\/\//.test(n)&&(o=o.slice(o.indexOf("//"))),(n=/^\/\//.test(o)?n.slice(n.indexOf("//")):n)===o))return i}}return-1},y=function(e){for(var t=-1,r=e.length-1;++t<e.length;){var n=t+Math.floor(Math.random()*(r-t+1)),o=e[n];e[n]=e[t],e[t]=o}return e};function t(e,t){!function(n,e,t){var t=2<arguments.length&&void 0!==t?t:0,o=null,i=!1,u=n.playlist=function(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(i)throw new Error("do not call playlist() during a playlist change");return Array.isArray(e)&&(t=Array.isArray(o)?o.slice():null,o=e.slice(),i=!0,n.trigger({type:"duringplaylistchange",nextIndex:r,nextPlaylist:o,previousIndex:u.currentIndex_,previousPlaylist:t||[]}),i=!1,-1!==r&&u.currentItem(r),t&&n.setTimeout(function(){n.trigger("playlistchange")},0)),o.slice()};n.on("loadstart",function(){-1===u.currentItem()&&a(n)}),u.currentIndex_=-1,u.player_=n,u.autoadvance_={},u.repeat_=!1,u.currentItem=function(e){return i||("number"==typeof e&&u.currentIndex_!==e&&0<=e&&e<o.length?(u.currentIndex_=e,c(u.player_,o[u.currentIndex_])):u.currentIndex_=u.indexOf(u.player_.currentSrc()||"")),u.currentIndex_},u.contains=function(e){return-1!==u.indexOf(e)},u.indexOf=function(e){if("string"==typeof e)return d(o,e);for(var t=Array.isArray(e)?e:e.sources,r=0;r<t.length;r++){var n=t[r];if("string"==typeof n)return d(o,n);if(n.src)return d(o,n.src)}return-1},u.currentIndex=function(){return u.currentItem()},u.lastIndex=function(){return o.length-1},u.nextIndex=function(){var e=u.currentItem();if(-1===e)return-1;var t=u.lastIndex();return u.repeat_&&e===t?0:Math.min(e+1,t)},u.previousIndex=function(){var e=u.currentItem();return-1===e?-1:u.repeat_&&0===e?u.lastIndex():Math.max(e-1,0)},u.first=function(){if(!i)return o.length?o[u.currentItem(0)]:void(u.currentIndex_=-1)},u.last=function(){if(!i)return o.length?o[u.currentItem(u.lastIndex())]:void(u.currentIndex_=-1)},u.next=function(){if(!i){var e=u.nextIndex();return e!==u.currentIndex_?o[u.currentItem(e)]:void 0}},u.previous=function(){if(!i){var e=u.previousIndex();return e!==u.currentIndex_?o[u.currentItem(e)]:void 0}},u.autoadvance=function(e){l(u.player_,e)},u.repeat=function(e){return void 0===e?u.repeat_:"boolean"==typeof e?(u.repeat_=!!e,u.repeat_):void r.log.error("videojs-playlist: Invalid value for repeat",e)},u.sort=function(e){o.length&&(o.sort(e),i||n.trigger("playlistsorted"))},u.reverse=function(){o.length&&(o.reverse(),i||n.trigger("playlistsorted"))},u.shuffle=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).rest,t=0,r=o;e&&(t=u.currentIndex_+1,r=o.slice(t)),r.length<=1||(y(r),e&&o.splice.apply(o,[t,r.length].concat(r)),i||n.trigger("playlistsorted"))},Array.isArray(e)?u(e.slice(),t):o=[]}(this,e,t)}return(r.registerPlugin||r.plugin)("playlist",t),t});
