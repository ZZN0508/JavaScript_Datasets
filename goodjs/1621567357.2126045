(this.$WP=this.$WP||[]).push(["eFKnUp",(e,t)=>{"use strict";var o,r,i,n,a,s,c,p,l,d,u,m=e=>e.photo&&e.photo.photoSizes[e.photo.photoSizes.length-1]?e.photo.photoSizes[e.photo.photoSizes.length-1]:null,v=e=>{var t=e.owner||e.userProfile,r=t?[t]:[];if(o("trips_2018_collab")){var i=(e.collaborators||[]).map(e=>e.user).filter(Boolean);r=r.concat(i)||[]}return r},P=(e,t)=>v(e).some(e=>e.isMe||e.userId&&e.userId===t||e.id&&e.id===t),f=e=>{var t;return(null==(t=e.owner)?void 0:t.isMe)?"OWNER":e&&P(e)?"COLLABORATOR":"PUBLIC"},h=(e,t)=>o("trips_2018_collab")?e.actionPermissions:{canAddCollaborators:t,canAddItem:t,canChangePrivacy:t,canDelete:t,canEdit:t,canUploadCoverPhoto:e.actionPermissions&&e.actionPermissions.canUploadCoverPhoto&&t},y=(e,t)=>o("trips_2018_collab")?e.actionPermissions:{canRemove:t},_=(e,t)=>o("trips_2018_collab")?e.actionPermissions:{canAddComment:t,canEdit:t,canRemove:t},b=(e,t)=>o("trips_2018_collab")?e.actionPermissions:{canEdit:t,canRemove:t},I=(e,t,o,r)=>{var i=v(e);if(i=i.slice(0,t),o>0){var n=0;i=i.filter(e=>(n=e.displayName.length+n)<o)}return r&&(i=i.reverse()),i},T=(e,t,r)=>{var i=r&&r.id,n=o("trips_2018_collab")?()=>!0:t=>t.author.id===i||"ITEM"===t.targetType&&t.targetId!==e.id;return(t||[]).filter(n).sort((e,t)=>e.created>t.created?1:-1)},g=e=>{var t;return null==e||null==(t=e.owner)?void 0:t.isMe},w=e=>e.owner&&e.owner.isMe?"OWNER":P(e)?"COLLABORATOR":"VIEWER",O=(e,t)=>(e.items||[]).find(e=>{var o,r=e.reference&&e.reference.type&&e.reference.type.toLowerCase(),i=null==(o=e.reference)?void 0:o.id,n=t.type.toLowerCase(),a=t.id.toString(),s=t.originalObject&&t.originalObject.type&&t.originalObject.type.toLowerCase(),c=t.originalObject&&t.originalObject.id.toString();return r===n&&i===a||r===s&&i===c}),R=(e,t)=>{var o=O(e,t);return o?o.id:null},S={locationinformation:"location",attractionproductinformation:"attractionProduct",forumpost:"post",tripitem:"savesItem",linkpost:"link",linkpost_linkpostv2:"link",photo:"photo",video:"video",review:"review",repost:"repost",trip:"bundleSave",tripnotes_tripnote:"note"},L={locationinformation:"LOCATION",attractionproductinformation:"ATTRACTIONPRODUCT",forumpost:"POST",tripitem:"SAVESITEM",linkpost:"LINK",photo:"PHOTO",video:"VIDEO",review:"REVIEW",repost:"REPOST",trip:"TRIPCONTENT"},k=e=>({statQuery:e}),C=e=>S[e.toLowerCase()],j=e=>L[e.toLowerCase()],E=["LocationInformation","AttractionProductInformation","ForumPost","LinkPost","LinkPost_LinkPostV2","Review","Photo","Video","Repost","Trip","TripNotes_TripNote"],A=e=>{switch(e.__typename){case"AttractionProductInformation":case"LocationInformation":return[e];case"Photo":case"Review":return[e.location];case"Video":return e.orderedLocations;case"ForumPost":case"LinkPost":case"TripNote":default:return[]}},F=(e,t)=>{if(!e)return null;var o=(e=>e.locationId||e.attractionProductId||e.postId||e.repostId||e.linkPostId||e.id||void 0)(e),r=e.__typename?C(e.__typename):null;if(o&&r){if(E.includes(e.__typename))return{type:r,id:o};var i={id:e.reference.id,type:"attractionproduct"===e.reference.type?"attractionProduct":e.reference.type};if("TripItem"===e.__typename&&e.reference&&e.reference.id&&e.reference.type)return t&&"note"!==i.type?i:{type:r,id:o,originalObject:i}}return null},N=e=>({id:""+e.id,type:e.type}),V=(e,t)=>`/Trips/${e}${t?"?itemId="+t:""}`,U=e=>{var t=u[e.type];return t?Object.assign({},e,{query:t.statQuery,variables:{ids:[e.id]}}):null},z=e=>{var t,o;return["LinkPost","Photo","Review","Video"].includes(null==e||null==(t=e.object)||null==(o=t.repostedObject)?void 0:o.__typename)},B=(e,t)=>{if("_blank"===t){var o=window.open("about:blank",t);return()=>{o.location=e}}return()=>{window.open(e,t)}};function M(e,t){return e.reduce((e,o)=>(t(o)?e[0].push(o):e[1].push(o),e),[[],[]])}var W=e=>{if("LinkPost_LinkPostV2"===e.__typename){var t=e.preview&&e.preview.media||[];if(!t.length)return[];t=t.reduce((e,t)=>t&&t.object?[...e,t]:e,[]).sort((e,t)=>t.id-e.id);var[o,r]=M(t,e=>"LinkPreview_PhotoRefV2"===e.__typename);if(o.length){var[i]=o;return i.object&&i.object.photoSizes||[]}if(r.length){var[n]=r;return n.object?[n.object]:[]}}if("LinkPost"===e.__typename){var a=e.preview&&e.preview.media||[];if(!a.length)return[];var s=e=>e.photoId||e.previewId||0;a=a.filter(Boolean).sort((e,t)=>s(t)-s(e));var[c,p]=M(a,e=>"Photo"===e.__typename);if(c.length){var[l]=c;return l.photoSizes||[]}if(p.length)return[p[0]]}return[]};return[()=>{u=Object.freeze({location:k(d),attractionProduct:k(r),post:k(i),savesItem:k(n),link:k(a),review:k(s),photo:k(c),video:k(p),repost:k(l)}),e({buildPublicTripShareUrl:V,getCollabPermissions:y,getCommentPermissions:b,getCommentsForDisplay:T,getItemByReference:O,getItemIdByReference:R,getItemPermissions:_,getPhotoSizesForLinkPost:W,getQueryReferenceTypeFromObjectType:j,getReferenceTypeFromObjectType:C,getTripCoverPhoto:m,getTripPermissions:h,getTripUsers:v,getTripUsersForDisplay:I,isOwner:g,isRepostSaveable:z,isTripUser:P,locationsForItem:A,objectStatisticQuery:U,toReference:N,toSavesObject:F,userRelation:w,userTypeFromTrip:f,windowOpener:B})},[e=>o=e.featureIsEnabled,e=>(r=e.AttractionStatistics,i=e.ForumStatistics,n=e.TripItemStatistics,a=e.LinkPostStatistics,s=e.ReviewStatistics,c=e.PhotoStatistics,p=e.VideoStatistics,l=e.RepostStatistics,d=e.LocationStatistics)]]},["-i3PJS","RXx5aI"]]);