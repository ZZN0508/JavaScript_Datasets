"undefined"==typeof orangesearch&&(orangesearch={}),orangesearch.moteur=orangesearch.moteur||{},orangesearch.moteur.completion=orangesearch.moteur.completion||{},function(){var wink,define,namespace=orangesearch.moteur.completion;namespace.plugin=namespace.plugin||{},namespace.tools=namespace.tools||{},void 0===define&&(define=function(e,t,i){void 0===wink&&(wink={});var n,s=arguments,o=s.length;return 1==o?n=s[0]:2==o?(n=s[1],"array"==typeof s[0]||Array):n=s[2],n(wink)},define.amd={vendor:"winktoolkit.org"}),define(function(){return wink=void 0===wink?{}:wink}),define(["../../_kernel/js/kernel"],function(h){h.version="1.4.4",h.api={},h.mm={},h.net={},h.plugins={},h.ui={form:{},layout:{},xy:{},xyz:{}},h.ux={};var o=Array.prototype.slice,p=window;h.byId=function(e){return h.isString(e)?document.getElementById(e):e},h.query=function(e,t){return new i(e,t)};var u,i=(u=a.prototype={init:function(){u.each(["pop","push","reverse","shift","sort","splice","unshift","slice","indexOf","lastIndexOf","forEach"],function(e,t){u[t]=[][t]}),h.query.extend(h,["getPosition","getTopPosition","getLeftPosition"],!0),h.query.extend(h.fx,["getTransformPosition","hasClass"],!0),h.query.extend(h.fx,["translate","rotate","scale","addClass","removeClass","apply","applyTransition","applyTransformTransition","onTransitionEnd"],!1),h.query.extend(h.ux.gesture,["listenTo","unlistenTo"],!1),u.each(["start","move","end"],function(e,o){u[o]=function(){var e=this.size();if(0!=e)for(var t=this.toArray(),i=this.splice.call(arguments,0),n=h.ux.touch,s=0;s<e;s++)n.addListener.apply(n,[t[s],o].concat(i))}}),u.initialized=!0},extend:function(e,t,i,n){for(var s=n||u,o={},a=t.length,r=0;r<a;r++){var l=t[r],c=e?e[l]:null;h.isFunction(c)&&(o[l]={c:e,f:c,r:i})}u.each(o,function(e,t){var o=t.f,a=t.c,r=t.r;s[e]=function(){var e=this.size();if(0!=e){for(var t=this.toArray(),i=[],n=this.splice.call(arguments,0),s=0;s<e;s++)i.push(o.apply(a,[t[s]].concat(n)));return r?1==i.length?i[0]:i:this}}})},size:function(){return this.length},toArray:function(){return o.call(this,0)},each:function(e,t){for(var i in e){var n=e[i];t.call(n,i,n)}}},a);function a(e,t){var i;h.isUndefined(a.prototype.initialized)&&this.init();try{i=o.call((t||document).querySelectorAll(e))}catch(t){i=[]}for(var n=this.length=i.length,s=0;s<n;s++)this[s]=i[s];return this.selector=e,this}h.query.extend=i.prototype.extend;var s="en_EN";h.setLocale=function(e){s=e},h.translate=function(e,t){var i=e,n=window.i18n||{},t=(n=h.isSet(t)&&h.isSet(t.i18n)?t.i18n:n)[s],e=(t=h.isUndefined(t)?n:t)[e];return i=!h.isUndefined(e)?e:i},h.isUndefined=function(e){return void 0===e},h.isNull=function(e){return null===e},h.isSet=function(e){return!h.isUndefined(e)&&!h.isNull(e)},h.isCallback=function(e){return!!(e&&e.method||h.isFunction(e))},h.isString=function(e){return"string"==typeof e||e instanceof String},h.isInteger=function(e){return parseInt(e)===e},h.isNumber=function(e){return"number"==typeof e||e instanceof Number},h.isArray=function(e){return"array"==typeof e||e instanceof Array},h.isBoolean=function(e){return"boolean"==typeof e||e instanceof Boolean},h.isFunction=function(e){return"[object Function]"===Object.prototype.toString.call(e)},h.trim=function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},h.bind=function(t,i){var n=o.call(arguments,2);return function(){var e=n.concat(o.call(arguments,0));return t.apply(i,e)}},h.call=function(e,t){if(h.isFunction(e))return e.apply(p,h.isArray(t)?t:[t]);var i,n=p,s=e.method,o=[];return h.isSet(e.context)&&(n=e.context),2==arguments.length&&(o=[t]),h.isSet(e.arguments)&&(i=e.arguments,h.isArray(i)||(i=[e.arguments]),o=o.concat(i)),n[s].apply(n,o)},h.connect=function(a,e,t){var i=h.isFunction(t);i||h.isSet(t.context)||(t.context=p);var r,n=a[e];(h.isNull(n)||h.isUndefined(n.cbs))&&((r=function(){for(var e=r.target,t=[].splice.call(arguments,0),e=e&&e.apply(a,t),i=r.cbs.slice(0),n=i.length,s=0;s<n;s++){var o=i[s];h.isFunction(o)?h.call(o,t):h.call({context:o.context,method:o.method,arguments:t.concat(o.arguments)})}return e}).target=n,r.cbs=[],n=a[e]=r);for(var s=n.cbs,o=s.length,l=0;l<o;l++){var c=s[l];if(i&&t==c||!i&&c.context==t.context&&c.method==t.method)return}s.push(t)},h.disconnect=function(e,t,i){var n=h.isFunction(i);n||h.isSet(i.context)||(i.context=p);t=e[t];if(!h.isUndefined(t.cbs))for(var s=t.cbs,o=s.length,a=0;a<o;a++){var r=s[a];if(n&&i==r||!n&&r.context==i.context&&r.method==i.method){s.splice(a,1);break}}},h.setTimeout=function(e,t,i){var n=o.call(arguments,3);return setTimeout(function(){e[t].apply(e,n)},i)},h.setInterval=function(e,t,i){var n=o.call(arguments,3);return setInterval(function(){e[t].apply(e,n)},i)},h.getPosition=function(e,t,i){for(var n={x:0,y:0},s=e;s&&s!=t;)n.x+=s.offsetLeft,n.y+=s.offsetTop,i&&(n.x+=h.fx.getTransformPosition(s).x,n.y+=h.fx.getTransformPosition(s).y),s=s.offsetParent;return n},h.getTopPosition=function(e,t,i){return h.getPosition(e,t,i).y},h.getLeftPosition=function(e,t,i){return h.getPosition(e,t,i).x};var e=100;return h.getUId=function(){return e+=1},h}),define(["../../../_amd/core"],function(){return wink.error={logLevel:0,log:function(e){1==this.logLevel&&("undefined"!=typeof console?console.log(e):alert(e))}},wink.log=wink.bind(wink.error.log,wink.error),wink.error}),define(["../../../_amd/core"],function(){var windowJson=window.JSON;return wink.json={parse:function(str){if(wink.has("json-parse"))return windowJson.parse(str);var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON;return str=String(str),cx.lastIndex=0,cx.test(str)&&(str=str.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(str.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))&&(JSON=eval("("+str+")")),JSON},concat:function(e,t){for(var i in t)e[i]=t[i];return e}},wink.parseJSON=wink.bind(wink.json.parse,wink.json),wink.mixin=wink.bind(wink.json.concat,wink.json),wink.json}),define(["../../../_amd/core"],function(){function e(e,t){wink.isCallback(t)&&(t=[e.toLowerCase(),t],r.push(t))}function t(e,t){for(var i=e.toLowerCase(),n=wink.isFunction(t),s=r.length,o=0;o<s;o++){var a=r[o];if(a[0]==i&&(n&&t==a[1]||!n&&a[1].method==t.method&&a[1].context==t.context)){r.splice(o,1);break}}}function i(e,t){n(e.toLowerCase(),t)}var r=[];wink.topics={_getTopics:function(){return r}},wink.topics.subscribe=e,wink.topics.unsubscribe=t,wink.topics.publish=i;var n=function(e,t){for(var i=r.length,n=0;n<i;n++){var s=r[n];s&&s[0]==e&&wink.isSet(s[1])&&wink.call(s[1],t)}};return wink.publish=i,wink.subscribe=e,wink.unsubscribe=t,wink.topics}),define(["../../../_amd/core"],function(){var e,t,i,n,s,o,a;t=i=n=s=h=o=a=m=!1,f=C=_=p=u=d=v=k=b=0;function r(e,t){return RegExp(e).test(t)}function l(e,t){return RegExp(e).exec(t)}function c(e,t,i){var n={v:0,r:0,u:0},t=l(t,e);return w(t)&&1<t.length&&(e=t[2],t=l("[^\\"+i+"0-9]",e),0<(i=(e=w(t)?e.slice(0,t.index):e).split(i)).length&&(n.v=i[0]),1<i.length&&(n.r=i[1]),2<i.length&&(n.u=i[2]),3<i.length&&(n.u+="."+i[3])),n}var h,p,u,d,m,g,f,C,_,v,k,b,w=wink.isSet,y=(D=navigator||{}).userAgent,S=D.platform,I=D.appVersion,P=r(" AppleWebKit/",y),x=r(/bada/gi,y),E=r(/Opera/gi,y),L=r(/Tizen/gi,y),D=r(/IEMobile/gi,y);return w(S)&&(r(/iphone/i,S)&&(t=!0),r(/ipod/i,S)&&(i=!0),r(/ipad/i,S)&&(n=!0),r(/blackberry/i,S)&&(a=!0),r(/BB10/i,S)&&(t=i=n=!(a=!0))),w(I)&&(r(/android/i,I)&&(s=!0),r(/safari/i,I)&&(h=!0,p=(g=c(I,"( Version/)([^ ]+)",".")).v,u=g.r,d=g.u),r(/MSIE/i,I)&&(m=!0,p=(g=c(I,"( MSIE )([^ ]+)",".")).v,u=g.r)),h||P||m||(o=r(/mozilla/i,y)),e=t||i||s||a||x||L||D||r(" Mobile/",y),P&&(f=(g=c(y,"( AppleWebKit/)([^ ]+)",".")).v,C=g.r,_=g.u),e&&w(I)&&(v=(I=c(I,(I=L?["( Tizen )([^ ]+)","."]:a?["( BlackBerry )([^ ]+)","."]:s?["( Android )([^ ]+)","."]:["( OS )([^ ]+)","_"])[0],I[1])).v,k=I.r,b=I.u),wink.ua={isWebkit:P,isMobile:e,isIPhone:t,isIPod:i,isIPad:n,isIOS:t||i||n,isAndroid:s,isBlackBerry:a,isBada:x,isOpera:E,isSafari:h,isMozilla:o,isIE:m,isTizen:L,webkitVersion:f,webkitMinorVersion:C,webkitUpdateVersion:_,browserVersion:p,browserMinorVersion:u,browserUpdateVersion:d,osVersion:v,osMinorVersion:k,osUpdateVersion:b},wink.ua}),define(["../../../_amd/core"],function(){function n(e,t,i){var n;wink.isBoolean(s[e])||(n=t,i&&a(t)&&(n=t()),s[e]=n)}function i(e,t){o[e]=t}var s={},o={},a=wink.isFunction;return wink.has=function(e){return a(s[e])&&(s[e]=s[e]()),s[e]},wink.has.prefixes=["-webkit-","-moz-","-o-","ms-","-khtml-"],wink.has.prefix=null,wink.has.inquire=n,wink.has.inquireMap=function(e,t){if(e&&0!=e.length)for(var i in e)n(i,e[i],t)},wink.has.setProp=i,wink.has.deferProp=function(e,t){a(t)?i(e,t):i(e,function(){wink.has(t)})},wink.has.prop=function(e){var t=o[e];return a(t)&&(t(),t=o[e],a(t)&&(t=e)),t||e},wink.has.getFeatures=function(){return s},wink.has.getProperties=function(){return o},wink.has}),define(["../../../_amd/core"],function(){var e=wink.has,t=e.inquireMap,i=window;return t({"json-parse":function(){var e,t=!1;return t=i.JSON&&"function"==typeof JSON.parse?!(!(e=JSON.parse('{"w":1}'))||!e.w):t},"json-stringify":function(){var e=!1;return e=i.JSON&&"function"==typeof JSON.stringify?'{"w":true}'==JSON.stringify({w:!0}):e}}),e}),define(["../../../_amd/core"],function(){function i(e){var t=!1;if(typeof c[e]==p)l(e,e),t=!0;else for(var i=wink.has.prefix,n=null!=i?[i]:h,s=n.length,o=0;o<s;o++){var a=function(e){for(var t=e,i=/(-)([a-z])/,n=e.match(i);null!=n;)n=(t=t.replace(i,RegExp.$2.toUpperCase())).match(i);return t}(n[o]+e);if(typeof c[a]==p){wink.has.prefix=n[o],l(e,a),t=!0;break}}return t}function e(e){return function(){i(e)}}var n=wink.has,t=n.inquireMap,l=n.setProp,s=n.deferProp,o=window,a=o.document,r=a.createElement("div"),c=r.style,h=n.prefixes,p="string",u="transform-property",d="transition-property",m="transition-duration",g="transition-delay",f="transition-timing-function",C="border-radius",_="text-shadow",v="box-shadow",k="gradient",b="perspective",w="transform-origin",y="transform-style",S="transform",I="css-transition",P="css-perspective",x="css-transform",E="perspective-origin",L="backface-visibility",D="tap-highlight-color",O="user-select",N="background-image",T="transition",A="animation",R="cssmatrix",U="classList";return s(u,x),s(S,x),s(d,I),s(m,I),s(g,I),s(f,I),s(C,"css-border-radius"),s(_,"css-text-shadow"),s(v,"css-box-shadow"),s(k,"css-gradient"),s(b,P),s(w,P),s(y,P),s(E,P),s(T,I),s(A,"css-animation"),s(R,"css-matrix"),s(U,U),s(L,e(L)),s(D,e(D)),s(O,e(O)),t({"css-transform":function(){var e=i(S),t=S;return typeof c[t]!=p&&(t=wink.has.prefix+t),l(u,e?n.prop(S):S),l(S,t),e},"css-transition":function(){return i(d)&&i(m)&&i(g)&&i(f)&&i(T)},"css-animation":function(){return i(A)},"css-translate3d":function(){return n("css-matrix")},"css-border-radius":function(){return i(C)},"css-text-shadow":function(){return i(_)},"css-box-shadow":function(){return i(v)},"css-gradient":function(){for(var e=k,t=N,i=e,n=wink.has.prefix,s=null!=n?["",n]:[""].concat(h),o=s.length,a=0;a<o;a++){var r=s[a]+i;if(c.cssText=t+":"+(r+"(linear,left top,right bottom,from(#9f9),to(white));"),c[t]&&-1!=c[t].indexOf(e))return l(e,r),!0}return!1},"css-perspective":function(){var e=i(b)&&i(w)&&i(y)&&i(E);if(wink.ua.isIE)return e;if(!(e=e&&i(w+"-x")&&i(w+"-y")&&i(w+"-z")))return!1;var t=wink.has.prefix||"",e=a.createElement("style");e.textContent="@media ("+t+"transform-3d){#wink_has{height:2px}}",a.getElementsByTagName("head")[0].appendChild(e),r.id="wink_has",a.documentElement.appendChild(r);t=2===r.offsetHeight;return e.parentNode.removeChild(e),r.parentNode.removeChild(r),t},"css-matrix":function(){var e="WebKitCSSMatrix",t=o.WebKitCSSMatrix;if(l(R,"WebKitCSSMatrix"),void 0===t&&(t=o[e="MSCSSMatrix"],l(R,e),void 0===t))return!1;var i=new t("matrix(1,0,0,1,6,7)"),e=6==i.m41&&7==i.m42&&i.m41==i.e&&i.m42==i.f;return e&&(t=new t("matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,6,7,8,1)"),e=e&&i.m41==t.m41&&i.m42==t.m42&&8==t.m43),e},"css-matrix-stack-inversed":function(){var e=wink.ua;if(!n("css-matrix")||!e)return!1;var t=e.isIOS?parseInt(""+e.osVersion+e.osMinorVersion+e.osUpdateVersion):500,e=e.isAndroid?parseInt(""+e.osVersion+e.osMinorVersion+e.osUpdateVersion):300;return t<421||e<300},preserve3d:function(){if(!n("css-perspective"))return!1;var e=n.prop(y),t="preserve-3d";c[e]=t;t=c[e]==t;return c[e]="",t},"css-position-fixed":function(){var e=wink.ua;if(e.isAndroid&&2==e.osVersion&&1==e.osMinorVersion||e.isBada)return!1;if(e.isIOS)return!(e.osVersion<5);var t=document.body;if(document.createElement&&t&&t.appendChild&&t.removeChild){if(!r.getBoundingClientRect)return null;r.innerHTML="x",r.style.cssText="position:fixed;top:100px;",t.appendChild(r);var i=t.style.height,n=t.scrollTop;t.style.height="3000px",t.scrollTop=500;e=r.getBoundingClientRect().top;t.style.height=i;e=100===e;return t.removeChild(r),t.scrollTop=n,e}return!1},"css-overflow-scrolling":function(){return i("overflow-scrolling")},"css-touch-action":function(){return i("touch-action")},classlist:function(){return U in r}}),n}),define(["../../../_amd/core"],function(){function t(e){return"on"+r[e]in a}var i=wink.has,e=i.inquireMap,n=i.setProp,s=i.deferProp,o=window,a=o.document.documentElement,r={ts:"touchstart",tm:"touchmove",te:"touchend",gs:"gesturestart",gc:"gesturechange",ge:"gestureend",tre:"transitionend",msd:"mspointerdown",msm:"mspointermove",msu:"mspointerup",msgs:"msgesturestart",msgc:"msgesturechange",msge:"msgestureend"};return s(r.ts,r.ts),s(r.tm,r.tm),s(r.te,r.te),s(r.gs,r.gs),s(r.gc,r.gc),s(r.ge,r.ge),s(r.tre,r.tre),e({touchstart:function(){var e=t("ts");return e?n(r.ts,r.ts):(e=i("mspointer")&&t("msd"),n(r.ts,e?"MSPointerDown":"mousedown")),e},touchmove:function(){var e=t("tm");return e?n(r.tm,r.tm):(e=i("mspointer")&&t("msm"),n(r.tm,e?"MSPointerMove":"mousemove")),e},touchend:function(){var e=t("te");return e?n(r.te,r.te):(e=i("mspointer")&&t("msu"),n(r.te,e?"MSPointerUp":"mouseup")),e},touch:function(){return i(r.ts)&&i(r.tm)&&i(r.te)},mspointer:function(){return!0===o.navigator.msPointerEnabled},gesturestart:function(){var e=t("gs");return e?n(r.gs,r.gs):(e=i("mspointer")&&t("msgs"),n(r.gs,e?"MSGestureStart":"gesturestart")),e},gesturechange:function(){var e=t("gc");return e?n(r.gc,r.gc):(e=i("mspointer")&&t("msgc"),n(r.gc,e?"MSGestureChange":"gesturechange")),e},gestureend:function(){var e=t("ge");return e?n(r.ge,r.ge):(e=i("mspointer")&&t("msge"),n(r.ge,e?"MSGestureEnd":"gestureend")),e},gesture:function(){return i(r.gs)&&i(r.gc)&&i(r.ge)},transitionend:function(){if(i("css-transition")){var e=wink.has.prefix,t=r.tre;return"-webkit-"==e?t="webkitTransitionEnd":"-o-"==e&&(t="oTransitionEnd"),n(r.tre,t),!0}return!1},hashchange:function(){return"onhashchange"in o},orientationchange:function(){return"onorientationchange"in o}}),i}),define(["../../../_amd/core"],function(){var e=wink.has.inquireMap,r=window.document,l=r.documentElement;return e({dynamicBase:function(){var e,t=function(e){return r.createElement(e)},i=t("head"),n=t("body"),s=r.getElementsByTagName("base"),o=location.protocol+"//"+location.host,a=o+"/old/";l.appendChild(i),l.appendChild(n),0<s.length?a=(e=s[0]).href:((e=t("base")).href=a,i.appendChild(e));s=t("a");s.href="rlt",n.appendChild(s);t=s.pathname;e.href=o+"/new/";s=s.pathname;return l.removeChild(i),l.removeChild(n),e.href=a,t!==s}}),wink.has}),define(["../../../_amd/core"],function(){function e(e,t){if(wink.has("classlist"))for(var i,n=(i=t.split(" ")).length,s=0;s<n;s++)e.classList.add(i[s]);else(" "+(i=e.className)+" ").indexOf(" "+t+" ")<0&&(e.className=i+(i?" ":"")+t)}function t(e,t){if(wink.has("classlist"))for(var i=t.split(" "),n=i.length,s=0;s<n;s++)e.classList.remove(i[s]);else{t=wink.trim((" "+e.className+" ").replace(" "+t+" "," "));e.className!=t&&(e.className=t)}}function i(e,t){return wink.has("classlist")?e.classList.contains(t):0<=(" "+e.className+" ").indexOf(" "+t+" ")}function o(e,t){var i,n=e.style;for(i in t){var s,o=_(p(i));wink.ua.isIE&&"perspective"==i&&(s=t[i],(""+parseFloat(s)).length==(""+s).length&&(t[i]=s+"px")),n[o=wink.ua.isIE&&"-ms-touch-action"==i?i:o]=t[i]}}function s(e,t,i,n,s){o(e,{"transition-property":C(t),"transition-duration":i,"transition-delay":n,"transition-timing-function":s})}function n(e,t,i,n){d(e,t,i,u.u,u.u,u.u,n)}function a(e,t,i){d(e,u.u,u.u,t,i,u.u,u.u)}function r(e,t){d(e,u.u,u.u,u.u,u.u,t,u.u)}function l(e){return window.getComputedStyle(e)[p("transform-property")]}function c(e,t){o(e,{"transform-property":t})}var h=wink.isSet,p=wink.has.prop,u={u:void 0};wink.fx={},wink.fx.addClass=e,wink.fx.removeClass=t,wink.fx.hasClass=i,wink.fx.apply=o,wink.fx.applyTransition=s,wink.fx.applyTransformTransition=function(e,t,i,n){s(e,"transform",t,i,n)},wink.fx.onTransitionEnd=function(t,i,n){function s(e){!0!==n&&t.removeEventListener(o,s,!1),i(e)}var o=p("transitionend");return t.addEventListener(o,s,!1),s},wink.fx.getTransformPosition=function(e){var t,i={x:null,y:null},e=l(e);return wink.has("css-matrix")?("none"==e&&(e=""),t=new window[wink.has.prop("cssmatrix")](e),i.x=t.m41,i.y=t.m42):(t=new RegExp(/matrix/i)).test(e)&&(t=new RegExp("[, ()]+","g"),6<(t=e.split(t)).length&&"matrix"==t[0]&&(i.x=parseInt(t[5]),i.y=parseInt(t[6]))),i},wink.fx.applyTranslate=n,wink.fx.translate=n,wink.fx.applyScale=a,wink.fx.scale=a,wink.fx.applyRotate=r,wink.fx.rotate=r,wink.fx.getTransform=l,wink.fx.setTransform=c;var d=function(e,t,i,n,s,o,a){var r=e._cssT||{},n=(r=e._cssT={t:h(t)||h(i)?{tx:t,ty:i}:r.t,s:h(n)||h(s)?{sx:n,sy:s}:r.s,r:h(o)?{a:o}:r.r}).t&&(h(r.t.tx)||h(r.t.ty)),s=r.s&&(h(r.s.sx)||h(r.s.sy)),o=r.r&&h(r.r.a),a=a;(!wink.has("css-translate3d")||wink.ua.isAndroid&&(s||o))&&(a=!0);a=n?m(r.t.tx,r.t.ty,a):"",s=s?g(r.s.sx,r.s.sy):"",r=o?f(r.r.a):"";c(e,wink.trim(a+" "+s+" "+r))},m=function(e,t,i){var n=e;h(n)||(n=0);e=t;h(e)||(e=0);t="0";return wink.isString(n)&&-1!=n.indexOf("%",0)||wink.isString(e)&&-1!=e.indexOf("%",0)||(n+="px",e+="px",t+="px"),i?"translate("+n+", "+e+")":"translate3d("+n+", "+e+", "+t+")"},g=function(e,t){h(e)||(e=1);return h(t)||(t=1),wink.has("css-perspective")?"scale3d("+e+", "+t+", 1)":"scale("+e+", "+t+")"},f=function(e){var t=e;return"rotate("+(t=!h(e)?0:t)+"deg)"},C=function(e){var t=e;if(-1==e.indexOf(","))t=p(e);else{for(var i=e.split(","),n=i.length,s=0;s<n;s++)i[s]=p(wink.trim(i[s]));t=i.join(",")}return t},_=function(e){return e.replace(/-([a-z])/gi,v)},v=function(e,t){return(t+"").toUpperCase()};return wink.addClass=e,wink.removeClass=t,wink.hasClass=i,wink.fx}),define(["../../../_amd/core"],function(){return wink.math={round:function(e,t){wink.isSet(t)||(t=0);t=Math.pow(10,t);return Math.round(e*t)/t},modulo:function(e,t){e%=t;return e<0?e+t:e}},wink.math}),define(["../../../_amd/core"],function(){var s=(wink.isUndefined,wink.isSet);wink.ux.Event=function(e){this.uId=wink.getUId(),this.type=null,this.x=null,this.y=null,this.timestamp=null,this.target=null,this.srcEvent=null,this.multitouch=null,wink.mixin(this,e),this._validateProperties()},wink.ux.Event.prototype={preventDefault:function(){this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},dispatch:function(e,t){var i=this.srcEvent,n=i.type;s(t)&&(n=t);n=o(i,n);e.dispatchEvent(n)},_validateProperties:function(){return!0}};var o=function(e,t){var i=e,n="HTMLEvents";/blur|focus|resize|scroll/i.test(t)?n="UIEvent":/click|mouse(down|move|up)/i.test(t)?n="MouseEvent":/touch(start|move|end|cancel)/i.test(t)?n="TouchEvent":/MSPointer/i.test(t)&&(n="MSPointerEvent");var s,o,a,r,l=document.createEvent(n),c=i.changedTouches;return"HTMLEvents"==n?l.initEvent(t,i.bubbles,i.cancelable):"UIEvent"==n?l.initUIEvent(t,i.bubbles,i.cancelable,window,i.detail):"MouseEvent"==n?(s=i.screenX,o=i.screenY,a=i.clientX,r=i.clientY,i.initTouchEvent&&c&&0<c.length&&(s=(e=c[0]).screenX,o=e.screenY,a=e.clientX,r=e.clientY),l.initMouseEvent(t,i.bubbles,i.cancelable,document.defaultView,i.detail,s,o,a,r,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget)):"TouchEvent"==n?l.initTouchEvent(t,i.bubbles,i.cancelable,window,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.touches,i.targetTouches,c,i.scale,i.rotation):"MSPointerEvent"==n&&l.initPointerEvent(t,i.bubbles,i.cancelable,window,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget,i.offsetX,i.offsetY,i.width,i.height,i.pressure,i.rotation,i.tiltX,i.tiltY,i.pointerId,i.pointerType,i.hwTimestamp,i.isPrimary),l};return wink.ux.Event}),define(["../../../_amd/core"],function(){var C=wink.isSet,_=wink.isArray;return wink.net.Xhr=function(e){this.uId=wink.getUId(),this.request={xhrObject:null,params:e},this._create()},wink.net.Xhr.prototype={sendData:function(e,t,i,n,s,o,a){var r=this.request,l=r.xhrObject,c=encodeURIComponent,i=i.toUpperCase(),h=null;if(!C(t)||_(t)){if(C(a)&&(h=wink.setTimeout(this,"_abort",a,s)),!l)return!1;var p=null;if(C(t)){var u=t.length;for(g=0;g<u;g++){var d=t[g],m=d.name,d=d.value;"GET"==i?0==g&&-1==e.indexOf("?")?e+="?"+c(m)+"="+c(d):e+="&"+c(m)+"="+c(d):0==g?p=c(m)+"="+c(d):p+="&"+c(m)+"="+c(d)}}try{if(l.open(i,e,!0),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),C(o)&&_(o)){var g,u=o.length;for(g=0;g<u;g++){var f=o[g];l.setRequestHeader(f.name,f.value)}}l.send(p)}catch(i){return!1}return l.onreadystatechange=function(){var e;4==l.readyState&&(clearTimeout(h),200<=(e=l.status)&&e<400||0==e?C(n)&&wink.call(n,r):C(s)&&wink.call(s,r))},!0}},_abort:function(e){this.request.xhrObject.onreadystatechange=null,this.request.xhrObject.abort(),C(e)&&wink.call(e,this.request)},_create:function(){var t,e=window.XMLHttpRequest;if(e){try{t=new e}catch(e){t=!1}this.request.xhrObject=t}}},wink.Xhr=wink.net.Xhr,wink.Xhr}),define(["../../../../_amd/core"],function(a){return a.ui.layout.Accordion=function(e){this.uId=a.getUId(),this.openMultipleSections=!1,this.autoScroll=!0,this.smoothOpening=!1,this._sectionsList=[],this._selectedSection=0,this._height=0,this._visibleContent=0,this._animated=!1,this._domNode=null,a.mixin(this,e),!1!==this._validateProperties()&&this._initDom()},a.ui.layout.Accordion.prototype={DURATION:500,addSection:function(e,t){t=new a.ui.layout.Accordion.Section({title:e,content:t,position:this._sectionsList.length,accordion:this});return this._sectionsList.push(t),this._domNode.appendChild(t.containerNode),this._updateHeight(),t.uId},deleteSection:function(e){for(var t,i=-1,n=-1,s=this._sectionsList.length,o=0;o<s;o++)1==i&&(this._sectionsList[o].position=o-1),this._sectionsList[o].uId,this._selectedSection,this._sectionsList[o].uId==e&&(i=1,n=o,this._domNode.removeChild(this._sectionsList[o].containerNode),this._sectionsList[o].uId==this._selectedSection&&(t=(0<o?this._sectionsList[o-1]:this._sectionsList[0]).uId));-1!=n&&this._sectionsList.splice(n,1),this._updateHeight(),e==this._selectedSection&&this.selectSection(t)},selectSection:function(e){for(var t,i=this._sectionsList,n=i.length,s=this._visibleContent,o=this._visibleContent=0;o<n;o++)i[o].uId==e?(i[t=o].show(this._visibleContent),this._selectedSection=e,1==i[o].opened&&(this._visibleContent+=i[o].contentNode.scrollHeight)):(i[o].hide(this._visibleContent),this.openMultipleSections&&1==i[o].opened&&(this._visibleContent+=i[o].contentNode.scrollHeight));this.smoothOpening?(this._animated||(a.fx.applyTransition(this._domNode,"height",this.DURATION+"ms","","ease-in-out"),this._animated=!0),this._updateHeight()):s>this._visibleContent?a.has("css-transition")&&a.fx.onTransitionEnd(i[t].contentNode,a.bind(this._updateHeight,this)):this._updateHeight()},refreshContentHeight:function(){for(var e=this._sectionsList,t=e.length,i=this._visibleContent=0;i<t;i++)1==e[i].opened?(e[i].opened=!1,e[i].show(this._visibleContent),this._visibleContent+=e[i].contentNode.scrollHeight):e[i].hide(this._visibleContent);this._updateHeight()},getDomNode:function(){return this._domNode},getSections:function(){return this._sectionsList},_updateHeight:function(){var e=0,t=this._sectionsList;l=t.length;for(var i=0;i<l;i++)0!=t[i].contentNode.offsetHeight?e+=t[i].titleNodeContainer.offsetHeight:e+=t[i].TITLE_HEIGHT+t[i].PADDING;this._height=e+this._visibleContent,this._domNode.style.height=this._height+"px"},_selectSection:function(e){this.selectSection(e)},_initDom:function(){this._domNode=document.createElement("div"),this._domNode.className="w_list w_border_top ac_accordion"},_validateProperties:function(){return!0}},a.ui.layout.Accordion.Section=function(e){this.uId=a.getUId(),this.title,this.content,this.position,this.opened=!1,this.DURATION=500,this.HIGHER_INDEX=999,this.TITLE_HEIGHT=44,this.titleNode=null,this.chevronNode=null,this.contentNode=null,this.containerNode=null,this.accordion,a.mixin(this,e),!1!==this._validateProperties()&&this._initDom()},a.ui.layout.Accordion.Section.prototype={PADDING:0,BACKGROUND:"transparent",show:function(e){var t=this.contentNode,i=this.chevronNode,n=this.accordion;a.fx.translate(this.containerNode,0,e),a.has("css-transition")&&n.autoScroll&&a.fx.onTransitionEnd(t,a.bind(this._scroll,this)),!1===this.opened?(a.fx.translate(t,0,t.scrollHeight),a.fx.rotate(i,90),this.opened=!0):(a.fx.translate(t,0,0),a.fx.rotate(i,0),this.opened=!1),!a.has("css-transition")&&n.autoScroll&&this._scroll()},hide:function(e){a.fx.translate(this.containerNode,0,e),this.accordion.openMultipleSections||(this.opened=!1,a.fx.translate(this.contentNode,0,0),a.fx.rotate(this.chevronNode,0))},_scroll:function(){this.accordion._updateHeight(),scrollTo(0,a.getTopPosition(this.titleNode,null,!0))},_validateProperties:function(){return!0},_initDom:function(){this.containerNode=document.createElement("div"),this.containerNode.className="ac_section",this.containerNode.style.zIndex=this.HIGHER_INDEX-this.position,a.fx.translate(this.containerNode,0,0),a.has("css-transition")&&a.fx.applyTransformTransition(this.containerNode,this.DURATION+"ms","","ease-in-out"),this.contentNode=document.createElement("div"),this.contentNode.className="w_bloc w_box w_border ac_content",a.fx.translate(this.contentNode,0,0),a.has("css-transition")&&a.fx.applyTransformTransition(this.contentNode,this.DURATION+"ms","","ease-in-out"),a.isString(this.content)?this.contentNode.innerHTML=this.content:(this.contentNode.innerHTML="",this.contentNode.appendChild(this.content)),this.titleNodeContainer=document.createElement("div"),this.titleNodeContainer.className="w_box ac_title_container",a.fx.translate(this.titleNodeContainer,0,0),a.fx.apply(this.titleNodeContainer,{paddingTop:this.PADDING+"px",backgroundColor:this.BACKGROUND}),this.titleNode=document.createElement("div"),this.titleNode.innerHTML=this.title,this.titleNode.className="w_box w_list_item w_no_wrap w_border_bottom w_border_left w_border_right w_bg_light ac_title",this.titleNode.onclick=a.bind(function(){this.accordion._selectSection(this.uId),a.publish("/section/events/selectsection",{sectionId:this.uId,accordionId:this.accordion.uId})},this),this.chevronNode=document.createElement("div"),this.chevronNode.className="w_icon w_chevron",a.fx.rotate(this.chevronNode,0),a.fx.applyTransformTransition(this.chevronNode,this.DURATION+"ms","","ease-in-out"),this.titleNode.appendChild(this.chevronNode),this.titleNodeContainer.appendChild(this.titleNode),this.containerNode.appendChild(this.titleNodeContainer),this.containerNode.appendChild(this.contentNode)}},a.ui.layout.Accordion}),wink.ui.layout.Accordion.Section.prototype.show=function(e){var t=this.contentNode,i=this.chevronNode,n=this.accordion;wink.fx.translate(this.containerNode,0,e),wink.has("css-transition")&&n.autoScroll&&wink.fx.onTransitionEnd(t,wink.bind(this._scroll,this)),!1===this.opened?(wink.fx.translate(t,0,t.scrollHeight),wink.fx.rotate(i,180),this.opened=!0):(wink.fx.translate(t,0,0),wink.fx.rotate(i,0),this.opened=!1),!wink.has("css-transition")&&n.autoScroll&&this._scroll()},wink.ui.layout.Accordion.prototype.addSection=function(e,t,i){t={title:e,content:t,position:this._sectionsList.length,accordion:this};i&&wink.mixin(t,i);t=new wink.ui.layout.Accordion.Section(t);return this._sectionsList.push(t),this._domNode.appendChild(t.containerNode),this._updateHeight(),t.uId};var Component=function(e){return Component.count+=1,this._abortSubmit=!1,this._abortDisplay=!1,this.additionalParams=null,this.applyDelayOnMouseOver=0,this.blocks=[],this.currentBlocks=[],this._cacheActivated=!0,this._callbacks=[],this.changeOnMouseOver=!1,this.checkInput=!0,this.clearAccents=!1,this.clearSeparatorChars=!1,this.closeCompletionOnBlur=!0,this._completionDiv=null,this._completionDivId=null,this._completionCloseLink=!1,this._completionDivContainer=null,this.completionDivUnrollDelay=0,this.cssPrefix="",this.toptrend118712=!1,this._currentFieldValue="",this.debugMode=!1,this._disableOnBlur=!0,this._enabled=!1,this.field=null,this._fieldForm=null,this._highlightedSuggestionIndex=0,this.isFormSubmit=!0,this.maxNbChar=!1,this.maxNbSuggestions=10,this.resultsUrl118712="https://annuaire.118712.fr",this.type118712="annuaire",this.type118712v="annuaire_villes",this.kw118712="",this.kw118712Param="s",this.geoloc118712="geo",this.minQueryLength=1,this.nameOfInstanceForJsonP=!1,this._uid=Component.count,this._oldInputFieldValue="",this.plugins=[],this._positionReference=null,this._properties={},this.queryParamName="kw",this._resultCache=null,this._serviceStatus="",this._selectedSuggestionIndex=0,this._started=!1,this.submitCallback=null,this._suggestionsList=new namespace.SuggestionList,this._suggestionPrefixId="completionResultLine_",this.useBoldInCompletion=!0,this.url=null,this.onClickCompletion=!1,this.onClickCompletionKeyword="basic",this.onClickCompletionId="0",this.onClickCompletionBaseUrl=!1,this.onClickCompletionVersion=!1,this.onClickCompletionAuthKey=!1,this.onClickCompletionCategory=!1,this.onClickCompletionUrl=!1,this._xhrManager=new wink.Xhr,this.isTargetBlank=!1,e&&this.setProperties(e),this};Component.count=0,Component.prototype={keyCode:{keyBad:0,keyOtherEnter:3,keyTab:9,keyEnter:13,keyShift:16,keyAlt:18,keyCapsLock:20,keyEscape:27,keyLeft:37,keyUp:38,keyRight:39,keyDown:40,keyBackspace:8,keyDelete:46},setProperties:function(e){return this._started?(wink.log("The autocompleter is started, you can not set properties"),!1):wink.isUndefined(e)||wink.isNull(e)?(wink.log("You try to set invalid properties"),!1):(namespace.tools.mixin(this._properties,e),!0)},start:function(){return this._started?(wink.log("Error : Completion already started"),!1):namespace.tools.checkEventCompatibility()?this._initProperties()?(this._initUrl(),this._initDom(),this._initPlugins(),this._initPluginProperties(),this._initSubscriptions(),!!this.enable()&&(this._started=!0)):(wink.log("Completion properties has not been set correctly"),!1):(wink.log("Error : Completion need attachEvent or addEventListener navigator support"),!1)},disable:function(){return this._started&&this._enabled?(this.hideCompletionDiv(),this.disableCompletionDisplay(),this.emptyCompletionResults(),this._disableListeners(),this._disableOnBlur=!0,!(this._enabled=!1)):(wink.log("Error : Could not disable a non started or disabled completion"),!1)},enable:function(){return this._enabled?(wink.log("Error : Could not enable an already enabled completion"),!1):(this._enableListeners(),this._disableOnBlur=!1,this.enableCompletionDisplay(),this._enabled=!0)},isEnabled:function(){return this._enabled},restart:function(e){return!!e&&!!this.disable()&&(this._started=!1,this._removeSubscriptions(),this._removePlugins(),this._removeDom(),!!this.setProperties(e)&&this.start())},isStarted:function(){return this._started},_enableListeners:function(){this._initFormListener(),this._initFieldListeners(),this._initPluginFieldListeners(),this._initOnBlurListener()},_disableListeners:function(){this._removeFormListener(),this._removeFieldListeners(),this._removePluginFieldListeners(),this._removeOnBlurListener()},disableCompletionDisplay:function(){this._abortDisplay=!0},enableCompletionDisplay:function(){this._abortDisplay=!1},_initFieldListeners:function(){namespace.tools.addEventListener(this.field,"keydown",this.manageFieldOnKeyDown),namespace.tools.addEventListener(this.field,"keyup",this.manageFieldOnKeyUp),this.onClickCompletion&&namespace.tools.addEventListener(this.field,"click",this.manageFieldOnClick)},_removeFieldListeners:function(){namespace.tools.removeEventListener(this.field,"keydown",this.manageFieldOnKeyDown),namespace.tools.removeEventListener(this.field,"keyup",this.manageFieldOnKeyUp),namespace.tools.removeEventListener(this.field,"click",this.manageFieldOnClick)},_initPluginFieldListeners:function(){for(var e=0;e<this.plugins.length;e++)if(this.plugins[e].initFieldListeners){this.plugins[e].initFieldListeners();break}},_removePluginFieldListeners:function(){for(var e=0;e<this.plugins.length;e++)if(this.plugins[e].removeFieldListeners){this.plugins[e].removeFieldListeners();break}},_initOnBlurListener:function(){namespace.tools.addEventListener(document,"click",wink.bind(this.manageFieldOnBlur,this.field),!1),namespace.tools.addEventListener(document,"touchstart",wink.bind(this.manageFieldOnBlur,this.field),!1)},_removeOnBlurListener:function(){},_initFormListener:function(){this._fieldForm&&(this._submitListener=wink.bind(function(e){namespace.tools.stopEvent(e),this.manageFormOnSubmit(this,e)&&this._fieldForm.submit()},this),namespace.tools.addEventListener(this._fieldForm,"submit",this._submitListener))},_removeFormListener:function(){this._fieldForm&&(namespace.tools.removeEventListener(this._fieldForm,"submit",this._submitListener),this._submitListener=!1)},_initDom:function(){return this._properties.divCompletion?(namespace.tools.addClass(this._completionDiv,this.getCssPrefix()),this._positionReference=null,this._completionDiv.style.visibility="hidden",this._completionDiv.style.display="none"):(this._positionReference=document.createElement("div"),this._positionReference.style.position="relative",this._positionReference.style.margin="0",this._positionReference.style.padding="0",this._positionReference.style.width="100%",this._positionReference.style.height="0",this._properties.positionReferenceContainer?(e=this._properties.positionReferenceContainer).firstChild?this._properties.positionReferenceContainer.insertBefore(this._positionReference,e.firstChild):this._properties.positionReferenceContainer.appendChild(this._positionReference):this.field.parentNode.insertBefore(this._positionReference,this.field),this._completionDivContainer=document.createElement("div"),this._completionDivContainer.style.position="absolute",this._completionDivContainer.style.margin="0",this._completionDivContainer.style.padding="0",this._completionDivContainer.style.border="0",this._completionDivContainer.style.width="100%",this._completionDivContainer.style.top=this.field.offsetHeight+"px",this._positionReference.appendChild(this._completionDivContainer),this._completionDiv=document.createElement("div"),this._completionDivId?this._completionDiv.setAttribute("id",this._completionDivId):this._completionDiv.setAttribute("id","divCompletion_"+this._uid),namespace.tools.addClass(this._completionDiv,this.getCssPrefix()+" box"),this._completionDiv.style.position="relative",this._completionDiv.style.visibility="hidden",this._completionDiv.style.display="none",this._completionDivContainer.appendChild(this._completionDiv)),!0;var e},_removeDom:function(){this._positionReference&&this._positionReference.parentNode&&this._positionReference.parentNode.removeChild(this._positionReference)},_initPlugins:function(){if(!this._properties.plugins)return!1;for(var e=null,t=0;t<this._properties.plugins.length;t++)namespace.plugin[this._properties.plugins[t]]?(e=new namespace.plugin[this._properties.plugins[t]])?e.canBeUsed&&!e.canBeUsed()||(e.setCompletionComponent(this),e.initPlugin&&e.initPlugin(),this.plugins.push(e)):wink.log("The plugin "+this._properties.plugins[t]+" does not exists !"):wink.log("The plugin "+this._properties.plugins[t]+" does not exists !");return!0},_removePlugins:function(){for(var e=0;e<this.plugins.length;e++)this.plugins[e].removePlugin&&this.plugins[e].removePlugin();this.plugins=[]},_initSubscriptions:function(){for(var e=0;e<this.plugins.length;e++)this.plugins[e].initSubscription&&this.plugins[e].initSubscription()},_removeSubscriptions:function(){for(var e=0;e<this.plugins.length;e++)this.plugins[e].removeSubscription&&this.plugins[e].removeSubscription()},_initPluginProperties:function(){for(var e=0;e<this.plugins.length;e++)this.plugins[e].initProperties&&this.plugins[e].initProperties()},setDebugMode:function(e){if(!wink.error)return!1;e?(this.debugMode=!0,wink.error.logLevel=1):(this.debugMode=!1,wink.error.logLevel=0)},_initProperties:function(){if(!this._properties)return wink.log("properties is missing"),!1;if(wink.isUndefined(this._properties.url)||!this._properties.url)return wink.log("property 'url' cannot be null"),!1;if(this.url=this._properties.url,wink.isUndefined(this._properties.field)||!this._properties.field)return wink.log("property 'field' cannot be null"),!1;if(this.field=this._properties.field,this.field.form&&(this._fieldForm=this.field.form),this.field.autoCompleter=this,wink.isUndefined(this._properties.onClickCompletion)||(this.onClickCompletion=this._properties.onClickCompletion),!wink.isUndefined(this._properties.divCompletion))if("object"==typeof this._properties.divCompletion)this._completionDiv=this._properties.divCompletion;else{if("string"!=typeof this._properties.divCompletion)return wink.log("property 'divCompletion' must be an HTMLElement or a string identifier"),!1;this._completionDiv=wink.byId(this._properties.divCompletion)}if(!wink.isUndefined(this._properties.blocks)){if(this._properties.blocks.constructor!=Object&&this._properties.blocks.constructor!=Array)return!1;if(void 0!==this._properties.blocks.length&&0<this._properties.blocks.length)this.blocks={default:namespace.tools.clone(this._properties.blocks)};else{if(this._properties.blocks.constructor!=Object)return!1;if(!this._properties.blocks.default)return!1;this.blocks=namespace.tools.clone(this._properties.blocks)}}return this._properties.callbacks&&(this._callbacks=this._properties.callbacks),this._properties.nameOfInstanceForJsonP&&(this.nameOfInstanceForJsonP=this._properties.nameOfInstanceForJsonP),this._properties.onClickCompletionKeyword&&(this.onClickCompletionKeyword=this._properties.onClickCompletionKeyword),this._properties.onClickCompletionId&&(this.onClickCompletionId=this._properties.onClickCompletionId),this._properties.onClickCompletionUrl&&(this.onClickCompletionUrl=this._properties.onClickCompletionUrl),this._properties.onClickCompletionBaseUrl&&(this.onClickCompletionBaseUrl=this._properties.onClickCompletionBaseUrl),this._properties.onClickCompletionVersion&&(this.onClickCompletionVersion=this._properties.onClickCompletionVersion),this._properties.onClickCompletionCategory&&(this.onClickCompletionCategory=this._properties.onClickCompletionCategory),this._properties.onClickCompletionAuthKey&&(this.onClickCompletionAuthKey=this._properties.onClickCompletionAuthKey),wink.isUndefined(this._properties.checkInput)||(this.checkInput=this._properties.checkInput),this._properties.divCompletionId&&(this._completionDivId=this._properties.divCompletionId),this._properties.completionDivUnrollDelay&&(this.completionDivUnrollDelay=this._properties.completionDivUnrollDelay),this._properties.applyDelayOnMouseOver&&this.setDelayOnMouseOver(this._properties.applyDelayOnMouseOver),wink.isUndefined(this._properties.closeCompletionOnBlur)||(this.closeCompletionOnBlur=this._properties.closeCompletionOnBlur),this._properties.disableCache&&(this._cacheActivated=!1),this._properties.queryParamName&&(this.queryParamName=this._properties.queryParamName),this._properties.additionalParams&&(this.additionalParams=this._properties.additionalParams),this._properties.cssPrefix&&(this.cssPrefix=this._properties.cssPrefix),this._properties.toptrend118712&&(this.toptrend118712=this._properties.toptrend118712),this._properties.isDesktop&&(this.isDesktop=this._properties.isDesktop),!wink.isUndefined(this._properties.maxNbChar)&&(!1===this._properties.maxNbChar||0<wink.isInteger(this._properties.maxNbChar))&&(this.maxNbChar=this._properties.maxNbChar),this._properties.maxNbSuggestions&&0<wink.isInteger(this._properties.maxNbSuggestions)&&(this.maxNbSuggestions=this._properties.maxNbSuggestions),this._properties.minQueryLength&&(this.minQueryLength=this._properties.minQueryLength),wink.isUndefined(this._properties.clearAccents)||(this.clearAccents=this._properties.clearAccents),wink.isUndefined(this._properties.clearSeparatorChars)||(this.clearSeparatorChars=this._properties.clearSeparatorChars),this._properties.closeLink&&(this._completionCloseLink=this._properties.closeLink),!1===this._properties.isFormSubmit&&(this.isFormSubmit=!1),this._properties.changeOnMouseOver&&(this.changeOnMouseOver=!0),this._properties.useBoldInCompletion&&(this.useBoldInCompletion=!0),wink.isUndefined(this._properties.isTargetBlank)?this.isTargetBlank=!1:this.isTargetBlank=this._properties.isTargetBlank,this._resultCache=new Array,!0},_initOnClickCompletionUrl:function(){this.onClickCompletionUrl||this.onClickCompletionBaseUrl&&this.onClickCompletionVersion&&this.onClickCompletionAuthKey&&(this.onClickCompletionUrl=this.onClickCompletionBaseUrl,this.onClickCompletionUrl+="/"+this.onClickCompletionVersion,this.onClickCompletionUrl+="?authkey="+this.onClickCompletionAuthKey,this.onClickCompletionUrl+="&output=json",this.onClickCompletionUrl+=this.onClickCompletionCategory?"&source="+this.onClickCompletionCategory:""),this.onClickCompletionUrl&&this.nameOfInstanceForJsonP&&(this.onClickCompletionUrl+="&jsonp="+this.nameOfInstanceForJsonP+".completionCallBack")},_initUrl:function(){this.blocks&&0!=this.blocks.length||(this.blocks={default:[{label:!1,baseId:!1,max:this.maxNbSuggestions}]}),this.isDesktop&&this.toptrend118712&&(this.blocks={default:[{label:"",baseId:"-hporange",max:this.maxNbSuggestions+1}]}),this.onClickCompletion&&this._initOnClickCompletionUrl();var e=this.blocks.default,t=[];if(1===e.length){var i=!!e[0].baseId&&e[0].baseId;!1!==i&&t.push("id="+i)}else{for(var n=[],s=[],o=0,a=0;o<e.length;o++)e[o].baseId&&(n[a]=e[o].baseId,!e[o].max&&this.maxNbSuggestions&&(e[o].max=this.maxNbSuggestions),e[o].max&&(s[a]="an"+(a+1)+"="+e[o].max),a++);0<n.length&&t.push("id="+n.join(",")),0<s.length&&t.push(s.join("&"))}return!1!==this.maxNbSuggestions&&t.push("an="+this.maxNbSuggestions),this.additionalParams&&t.push(this.additionalParams),this.nameOfInstanceForJsonP&&t.push("jsonp="+this.nameOfInstanceForJsonP+".completionCallBack"),0<t.length&&(this.url+="?"+t.join("&")),!0},_unHighlightAllSuggestions:function(){if(!(this.getSizeOfSuggestionsList()<=0))for(var e=1;e<=this.getSizeOfSuggestionsList();e++)namespace.tools.removeClass(wink.byId(this.getSuggestionPrefix()+e),"highlighted")},resetCompletion:function(){!this.checkInput||""!=this._currentFieldValue&&0!=this.getSizeOfSuggestionsList()||this.hideCompletionDiv(),wink.publish("/callback/resetCompletion/reset",{uid:this._uid}),this._unHighlightAllSuggestions(),this._highlightedSuggestionIndex=0,this._selectedSuggestionIndex=0},manageDivOnMouseDown:function(e,t,i){e.field.value=e.getSuggestionParam(i.id,"v"),e._currentFieldValue=e.field.value,e._selectedSuggestionIndex=e._highlightedSuggestionIndex,e.hideCompletionDiv(),e.pushFieldCursor(),e.field.form&&e.callSubmit(t)},manageDivOnMouseOver:function(e,t,i){var n;e.applyDelayOnMouseOver?(n=e.getSuggestionParam(i.id,"index"),e._highlightedSuggestionIndex=n,setTimeout(function(){e.checkDivOnMouseOverSuggestion(n,t,i)},e.applyDelayOnMouseOver)):e.highlightNewValueOnMouseOver(t,i)},checkDivOnMouseOverSuggestion:function(e,t,i){this._highlightedSuggestionIndex==e&&document.activeElement==this.field&&this.highlightNewValueOnMouseOver(t,i)},highlightNewValueOnMouseOver:function(e,t){var i=this.getSuggestionParam(t.id,"index");i&&(this._cursorUpDownPressed=!1,this.highlightNewValue(i),this.changeOnMouseOver&&(this.field.value=this.getSuggestionParam(t.id,"v"),this._selectedSuggestionIndex=this._highlightedSuggestionIndex))},highlightNewValueOnKeyDown:function(e){var t;this.highlightNewValue(e),this._selectedSuggestionIndex=this._highlightedSuggestionIndex,0<this._highlightedSuggestionIndex&&(t=this.getSuggestionParam(this._getSuggestionId(this._highlightedSuggestionIndex),"v"))&&(this.field.value=t)},manageDivOnMouseOut:function(e,t,i){e.changeOnMouseOver&&(e.field.value=e._currentFieldValue)},_getSuggestionId:function(e){return e?this.getSuggestionPrefix()+e:null},getSuggestionNode:function(e){return e?wink.byId(this._getSuggestionId(e)):null},isSelectedSuggestion:function(){return 0<this._selectedSuggestionIndex},callSubmit:function(e,t){this.manageFormOnSubmit(this,e,t)&&this.field.form.submit()},manageFormOnSubmit:function(e,t,i){if(!e._currentFieldValue&&!this.field.value)return namespace.tools.stopEvent(),namespace.tools.focusOnInputEnd(e.field),!1;if(e.hideCompletionDiv(),namespace.tools.focusOnInputEnd(e.field),e._abortSubmit=!1,wink.publish("/callback/manageFormOnSubmit/beforeSubmit",{uid:e._uid,autoCompleter:e,event:t,query:e.field.value}),e._abortSubmit)return e._abortSubmit=!1;var n=e._highlightedSuggestionIndex;if((i=!wink.isSet(i)||"object"!=typeof i?{}:i).id=e.field.id,i.div=e.getSuggestionNode(n),i.query=e.field.value,0<n){t=e.getSuggestionParam(e._getSuggestionId(n),"v"),n=e.getSuggestionParam(e._getSuggestionId(n),"blockId");if(e.currentBlocks[n].submitCallback&&e._currentFieldValue==t)if(!1===wink.call(e.currentBlocks[n].submitCallback,i))return!1}if(e._callbacks&&e._callbacks.submit&&wink.isCallback(e._callbacks.submit)&&!1===wink.call(e._callbacks.submit,i))return!1;return!!e.isFormSubmit},manageFieldOnClick:function(e){if(!(0<this.value.length))return!!(e=!e&&window.event?window.event:e)&&this.autoCompleter.defaultFieldOnClickCallBack(e)},defaultFieldOnClickCallBack:function(e){this.nameOfInstanceForJsonP?this.onClickCompletionUrl?namespace.tools.writeScript(this.onClickCompletionUrl,"jsonCompletionCallBackScriptId"):wink.log("Error : Completion URL invalid"):this.onClickCompletionUrl?this._xhrManager.sendData(this.onClickCompletionUrl,null,"GET",{context:this,method:"completionCallBack"},{context:this,method:"completionFailureCallBack"},null):wink.log("Error : Completion URL invalid")},manageFieldOnKeyUp:function(e){return!!(e=!e&&window.event?window.event:e)&&this.autoCompleter.defaultFieldOnKeyUpCallBack(e)},defaultFieldOnKeyUpCallBack:function(e){switch(e.keyCode){case this.keyCode.keyAlt:case this.keyCode.keyCapsLock:case this.keyCode.keyTab:case this.keyCode.keyEnter:case this.keyCode.keyOtherEnter:void 0!==this.toptrend118712&&this.toptrend118712&&this._highlightedSuggestionIndex===this.getSizeOfSuggestionsList()&&0<this.getSizeOfSuggestionsList()&&"suggestion-annuaire-118712 highlighted"==document.getElementById(this.getSuggestionPrefix()+this._highlightedSuggestionIndex).className&&(this.hasResult118712v?location.href=this.resultsUrl118712+"/?"+this.kw118712Param+"="+this.kw118712:location.href=this.resultsUrl118712+"/?"+this.kw118712Param+"="+this.kw118712+"&"+this.geoloc118712+"=1");break;case this.keyCode.keyShift:return;case this.keyCode.keyEscape:return this.field.value=this._currentFieldValue,void this.hideCompletionDiv();case this.keyCode.keyDown:case this.keyCode.keyUp:this._cursorUpDownPressed=!0,this.pushFieldCursor();break;case this.keyCode.keyBackspace:case this.keyCode.keyDelete:default:this._cursorUpDownPressed=!1,this._currentFieldValue=this.field.value}var t;this._currentFieldValue=namespace.tools.cleanQuery(this._currentFieldValue),this._oldInputFieldValue!=this._currentFieldValue&&(""!=(t=encodeURIComponent(this._currentFieldValue))&&t.length>=this.minQueryLength&&void 0!==t?(e=this._currentFieldValue.substring(0,this._currentFieldValue.length-1),(e=!!this._resultCache.hasOwnProperty(e)&&this._resultCache[e])&&0==e.length?(this.addCacheResult(this._currentFieldValue,new Array),this.hideCompletionDiv()):(e=!!this._resultCache.hasOwnProperty(this._currentFieldValue)&&this._resultCache[this._currentFieldValue].data,this.kw118712=this._resultCache.hasOwnProperty(this._currentFieldValue)?this._resultCache[this._currentFieldValue].kw118712:"",this.hasResult118712v=!!this._resultCache.hasOwnProperty(this._currentFieldValue)&&this._resultCache[this._currentFieldValue].hasResult118712v,this.hasResult118712=!!this._resultCache.hasOwnProperty(this._currentFieldValue)&&this._resultCache[this._currentFieldValue].hasResult118712,e?(this._currentJsonResultsData=e,this.displayCompletionResults(this._currentFieldValue.toString())):(t=this.url+"&"+this.queryParamName+"="+t,this.nameOfInstanceForJsonP?namespace.tools.writeScript(t,"jsonCompletionCallBackScriptId"):this._xhrManager.sendData(t,null,"GET",{context:this,method:"completionCallBack"},{context:this,method:"completionFailureCallBack"},null),this.field.focus()))):this.hideCompletionDiv()),this._oldInputFieldValue=this._currentFieldValue},manageFieldOnKeyDown:function(e){return!!(e=!e&&window.event?window.event:e)&&this.autoCompleter.defaultFieldOnKeyDownCallBack(e)},handleDirectLinkGaLabel:function(){var e;"link"===this.getSuggestionParam(this._getSuggestionId(this._highlightedSuggestionIndex),"t")&&(e=this.field.value,this.field.setAttribute("data-tagging-label","directLink | "+e))},defaultFieldOnKeyDownCallBack:function(e){var t=this.field.getAttribute("data-tagging-label");switch(this.field.removeAttribute("data-tagging-label"),e.keyCode){case this.keyCode.keyDown:this.highlightNewValueOnKeyDown(this._highlightedSuggestionIndex+1),this.handleDirectLinkGaLabel();break;case this.keyCode.keyUp:this.highlightNewValueOnKeyDown(this._highlightedSuggestionIndex-1),this.handleDirectLinkGaLabel();break;case this.keyCode.keyEnter:case this.keyCode.keyOtherEnter:t&&this.field.setAttribute("data-tagging-label",t),void 0!==this.toptrend118712&&this.toptrend118712&&this._highlightedSuggestionIndex===this.getSizeOfSuggestionsList()&&0<this.getSizeOfSuggestionsList()&&"suggestion-annuaire-118712 highlighted"==document.getElementById(this.getSuggestionPrefix()+this._highlightedSuggestionIndex).className&&(this.hasResult118712v?location.href=this.resultsUrl118712+"/?"+this.kw118712Param+"="+this.kw118712:location.href=this.resultsUrl118712+"/?"+this.kw118712Param+"="+this.kw118712+"&"+this.geoloc118712+"=1");break;case this.keyCode.keyAlt:case this.keyCode.keyCapsLock:case this.keyCode.keyTab:case this.keyCode.keyBad:case this.keyCode.keyShift:break;default:return void this.resetCompletion()}},manageFieldOnBlur:function(e){if(e=e||window.event,this.autoCompleter&&this.autoCompleter.closeCompletionOnBlur&&!this.autoCompleter._disableOnBlur){var t=e.target||e.srcElement;if(t!==this){do{if(this.autoCompleter._completionDiv===t)return}while(t=!!t.parentNode&&t.parentNode);this.autoCompleter._cursorUpDownPressed||this.autoCompleter.hideCompletionDiv(),this.autoCompleter._cursorUpDownPressed=!1}}},highlightNewValue:function(e){0!=this.getSizeOfSuggestionsList()&&(this.showCompletionDiv(),this._unHighlightAllSuggestions(),e<0?e=this.getSizeOfSuggestionsList():e>this.getSizeOfSuggestionsList()&&(e=0),0==e?(this.field.value=this._currentFieldValue,this._highlightedSuggestionIndex=0):(this._highlightedSuggestionIndex=e,0<this._highlightedSuggestionIndex&&(namespace.tools.addClass(this.getSuggestionNode(this._highlightedSuggestionIndex),"highlighted"),this._completionDiv.scrollTop=e*this.getSuggestionNode(this._highlightedSuggestionIndex).offsetHeight)),wink.publish("/callback/highlightNewValue/suggestionHighlighted",{uid:this._uid,div:this.getSuggestionNode(this._highlightedSuggestionIndex),index:this._highlightedSuggestionIndex}))},completionCallBack:function(e){if(!this._abortDisplay){var t=null;if(this.nameOfInstanceForJsonP)t=e;else{if(!e.xhrObject.responseText)return;t=wink.parseJSON(e.xhrObject.responseText)}switch(t.serviceStatus){case"SUSPENDED":case"KO_CONFIG":case"KO_PARSE":case"KO_MISC":case"LOCK":return void this.disable();case"NO_STATUS":case"TO":case"KO_HTTP":case"KO_CONNECT":this._currentJsonResultsData=this.getEmptyResultTemplate();break;default:this.hasResult118712=!1,this.hasResult118712v=!1,this.isDesktop&&this.toptrend118712&&2<=this._currentFieldValue.length&&("j"in t.data[0][0].d&&"champ"in t.data[0][0].d.j&&t.data[0][0].d.j.champ==this.type118712?(this.kw118712=t.data[0][0].v,t.kw118712=t.data[0][0].v,t.data[0].shift(),this.hasResult118712=!0,this.hasResult118712v=!1,t.hasResult118712=!0,"j"in t.data[0][0].d&&"champ"in t.data[0][0].d.j&&t.data[0][0].d.j.champ==this.type118712v?t.data[0].shift():t.data[0].pop()):"j"in t.data[0][0].d&&"champ"in t.data[0][0].d.j&&t.data[0][0].d.j.champ==this.type118712v?(this.kw118712=t.data[0][0].v,t.kw118712=t.data[0][0].v,t.data[0].shift(),t.data[0].pop(),this.hasResult118712v=!0,this.hasResult118712=!1,t.hasResult118712v=!0):(this.hasResult118712=!1,this.hasResult118712v=!1,t.data[0].pop(),t.data[0].pop())),this.addCacheResult(t.query,t),this._currentJsonResultsData=t.data}t.blocks?this.displayCompletionResults(t.query,t.blocks):this._currentFieldValue==t.query&&this.displayCompletionResults(t.query)}},getEmptyResultTemplate:function(){for(var e=[],t=0;t<this.blocks.length;t++)e.push([]);return e},completionFailureCallBack:function(){},addCacheResult:function(e,t){e&&1==this._cacheActivated&&(this._resultCache[e]=t)},_getNewBlockLabel:function(e,t){var i=document.createElement("div");i.id="blockLabel"+t+"_"+this.getUid()+"_"+e;var n=this.currentBlocks[e].type;if(namespace.tools.addClass(i,"label block"+t),!n)return this.populateNewBlockLabel(i,e,t),i;for(var s=0;s<this.plugins.length;s++)if(this.plugins[s].isValidType(n))return this.plugins[s].populateNewBlockLabel(i,e,t),i;return wink.log("Error: The plugin "+n+" has not been found in the list of loaded plugins !"),null},populateNewBlockLabel:function(e,t,i){var n="label";"Bottom"==i&&(n="bottomLabel"),this.currentBlocks[t].decoratorCallback&&wink.isCallback(this.currentBlocks[t].decoratorCallback)?wink.call(this.currentBlocks[t].decoratorCallback,{element:e,position:i}):this.currentBlocks[t][n]&&(e.innerHTML=this.currentBlocks[t][n])},_getNewSuggestionRow:function(e,t,i){var n=document.createElement("div");namespace.tools.addClass(n,"suggestion"),n.id=this.getSuggestionPrefix()+i;var s=t.t;this.clearAccents&&(t.v=namespace.tools.stripAccents(t.v)),this.clearSeparatorChars&&(t.v=namespace.tools.stripSeparatorChars(t.v)),t.d&&t.d.params&&this.addSuggestionParam(n.id,"params",t.d.params);var o=wink.isUndefined(this._properties.tracking)||wink.isUndefined(this._properties.tracking.category)||""===this._properties.tracking.category?"page_result":this._properties.tracking.category,a=e,r=t.v;"link"===s&&(r="directLink | "+r),n.setAttribute("data-oevent-category",o),n.setAttribute("data-oevent-action",a),n.setAttribute("data-oevent-label",r);for(var l=0;l<this.plugins.length;l++)if(this.plugins[l].isValidType(s))return namespace.tools.addClass(n,s),this.plugins[l].populateNewSuggestionRow(e,n,t,i),this.plugins[l].addEventListenerOnNewSuggestionRow(n),n;return s&&wink.log("Error: The plugin "+s+" has not been found in the list of loaded plugin !"),this.populateNewSuggestionRow(e,n,t,i),this.addEventListenerOnNewSuggestionRow(n),n},populateNewSuggestionRow:function(e,t,i,n){var s=document.createElement("div"),o=document.createElement("span"),a=i.v;wink.isString(a)||(a=""),this.maxNbChar&&(a=a.cutString(this.maxNbChar)),o.appendChild(document.createTextNode(a)),this.useBoldInCompletion&&(o=namespace.tools.getBoldInvNode(o,e,this.clearAccents,this.clearSeparatorChars)),this.debugMode&&i.d&&i.d.baseId&&o.insertBefore(document.createTextNode("["+i.d.baseId+"] "),o.firstChild),this.addSuggestionParam(t.id,"v",i.v),this.addSuggestionParam(t.id,"t",i.t),this.addSuggestionParam(t.id,"d",i.d),namespace.tools.addClass(o,"content"),s.appendChild(o),t.appendChild(s)},addEventListenerOnNewSuggestionRow:function(e){var t=this;namespace.tools.addEventListener(e,"mousedown",function(e){t.manageDivOnMouseDown(t,e,this)}),namespace.tools.addEventListener(e,"mouseover",function(e){t.manageDivOnMouseOver(t,e,this)}),namespace.tools.addEventListener(e,"mouseout",function(e){t.manageDivOnMouseOut(t,e,this)})},_addNewSuggestionRow118712:function(e){var t=document.createElement("div");t.id=this.getSuggestionPrefix()+e;var i=document.createElement("a");namespace.tools.addClass(i,"a-annuaire-118712"),i.setAttribute("id","ida118712href");var n=document.createElement("div");namespace.tools.addClass(n,"logo-text-118712");var s=document.createElement("img");namespace.tools.addClass(s,"logo-annuaire-118712"),s.setAttribute("src","https://img.ke.woopic.com/resources/img/common/118712_logo.png"),s.setAttribute("alt","");e=document.createElement("span");return namespace.tools.addClass(e,"text-annuaire"),n.appendChild(e),n.appendChild(s),i.appendChild(n),t.appendChild(i),t},_addNewSuggestionRow118712Completion:function(e){var t=this._addNewSuggestionRow118712(e);namespace.tools.addClass(t,"suggestion-annuaire-118712");var i,n=t.firstChild;i=this.hasResult118712v?this.resultsUrl118712+"/?"+this.kw118712Param+"="+this.kw118712:this.resultsUrl118712+"/?"+this.kw118712Param+"="+this.kw118712+"&"+this.geoloc118712+"=1",n.setAttribute("mousedown",i),n.setAttribute("title",this.kw118712+" avec 118712");var s=n.firstChild,o=s.firstChild,a=document.createElement("span");namespace.tools.addClass(a,"kw118712"),a.innerHTML=this.kw118712,s.insertBefore(a,o),o.innerHTML=" avec ";a=wink.isUndefined(this._properties.tracking)||wink.isUndefined(this._properties.tracking.category)||""===this._properties.tracking.category?"page_result":this._properties.tracking.category,o=this.kw118712;return t.setAttribute("data-oevent-category",a),t.setAttribute("data-oevent-action",o),t.setAttribute("data-oevent-label","cmpl 118712"),this.addSuggestionParam(t.id,"index",e),this.addSuggestionParam(t.id,"url",i),this.addSuggestionParam(t.id,"blockId",0),this.addSuggestionParam(t.id,"v","Completion 118712"),this.addEventListenerOnNewSuggestionRow118712(n,t,i),t},addEventListenerOnNewSuggestionRow118712:function(e,t,i){var n=this;namespace.tools.addEventListener(e,"mousedown",function(){location.href=i}.bind(this)),namespace.tools.addEventListener(t,"mouseover",function(e){n.manageDivOnMouseOver(n,e,this)}),namespace.tools.addEventListener(t,"mouseout",function(e){n.manageDivOnMouseOut(n,e,this)})},_getBottomActionBar:function(){var e=document.createElement("div");namespace.tools.addClass(e,"footer actionBar");for(var t,i=0;i<this.plugins.length;i++)!this.plugins[i].getBottomAction||(t=this.plugins[i].getBottomAction())&&(t.style.display="inline-block",t.style.cssFloat="right",t.style.styleFloat="right",e.appendChild(t));var n=this,s=document.createElement("a");return!0===this._completionCloseLink&&(this._completionCloseLink="fermer"),s.innerHTML=this._completionCloseLink,s.style.display="inline-block",namespace.tools.addClass(s,"rightClose"),namespace.tools.addEventListener(s,"click",function(e){n.hideCompletionDiv()}),e.appendChild(s),e},displayCompletionResults:function(e,t){this.currentBlocks=this.blocks.default,void 0!==t&&0<t.length&&this.blocks[t]&&(this.currentBlocks=this.blocks[t]),wink.publish("/callback/displayCompletionResults/beforeDisplay",{uid:this._uid,query:e,block:this.currentBlocks}),this.emptyCompletionResults();t=this._currentJsonResultsData;this._checkNotEmptyList(t)||(this.hasResult118712||this.hasResult118712v)&&""!=this.kw118712?(this.showCompletionDiv(),this._addNewSuggestionRowRecursive(e,0,t,0,1),this.showCompletionDiv()):this.hideCompletionDiv()},_checkNotEmptyList:function(e){if(!e||e.length<=0)return!1;if(this.checkInput&&!this.onClickCompletion&&""==this.field.value)return!1;for(var t=0;t<e.length;t++)if(0<e[t].length)return!0;return!1},_addNewSuggestionRowRecursive:function(e,t,i,n,s){var o;if(n>=this.currentBlocks.length||this.maxNbSuggestions&&s>this.maxNbSuggestions)return"toptrend"!=e&&this.isDesktop&&this.toptrend118712&&2<=this._currentFieldValue.length&&(this.hasResult118712||this.hasResult118712v)&&(o=this._addNewSuggestionRow118712Completion(s),this._completionDiv.appendChild(o)),this._finalizeCompletionConstruction(s);if(!i[n]||0===i[n].length||this.currentBlocks[n].max&&t>=this.currentBlocks[n].max)return n++,t=0,this._addNewSuggestionRowRecursive(e,t,i,n,s);0!=t||(wink.isUndefined(this.currentBlocks[n].label)||!1===this.currentBlocks[n].label)&&wink.isUndefined(this.currentBlocks[n].decoratorCallback)||(o=this._getNewBlockLabel(n,"Top"))&&this._completionDiv.appendChild(o);var a,r=this._getNewSuggestionRow(e,i[n][t],s);r&&(this.addSuggestionParam(r.id,"blockId",n),this.addSuggestionParam(r.id,"index",s),this._completionDiv.appendChild(r),this.completionDivUnrollDelay&&0<this.completionDivUnrollDelay?(a=this,setTimeout(function(){a._publishNewSuggestionRow(e,r,t,i,n,s)},this.completionDivUnrollDelay)):this._publishNewSuggestionRow(e,r,t,i,n,s))},_publishNewSuggestionRow:function(e,t,i,n,s,o){wink.publish("/callback/displayCompletionResults/elementAdded",{uid:this._uid,position:o,div:t,data:n[s][i]}),o++,++i>=n[s].length&&(wink.isUndefined(this.currentBlocks[s].bottomLabel)&&wink.isUndefined(this.currentBlocks[s].decoratorCallback)||(t=this._getNewBlockLabel(s,"Bottom"))&&this._completionDiv.appendChild(t),i=0,s++),this._addNewSuggestionRowRecursive(e,i,n,s,o)},_finalizeCompletionConstruction:function(e){return this._completionCloseLink&&this._completionDiv.appendChild(this._getBottomActionBar()),this.resetCompletion(),wink.publish("/callback/displayCompletionResults/allElementsAdded",{uid:this._uid,position:e}),!0},emptyCompletionResults:function(){if(this._completionDiv)for(this.resetSuggestionsList();0<this._completionDiv.childNodes.length;)this._completionDiv.removeChild(this._completionDiv.childNodes[0])},showCompletionDiv:function(){this._completionDiv&&"visible"!=this._completionDiv.style.visibility&&"block"!=this._completionDiv.style.display&&(this._callbacks&&this._callbacks.show&&wink.isCallback(this._callbacks.show)&&wink.call(this._callbacks.show),wink.publish("/callback/showCompletionDiv/show",{uid:this._uid}),this._completionDiv&&(this._completionDiv.style.display="block",this._completionDiv.style.visibility="visible"))},hideCompletionDiv:function(){this._completionDiv&&"hidden"!=this._completionDiv.style.visibility&&(this._callbacks&&this._callbacks.hide&&wink.isCallback(this._callbacks.hide)&&wink.call(this._callbacks.hide),wink.publish("/callback/hideCompletionDiv/hide",{uid:this._uid}),this._completionDiv&&(this._completionDiv.style.display="none",this._completionDiv.style.visibility="hidden"))},pushFieldCursor:function(){this.field.value&&(oldValue=this.field.value,this.field.value="",this.field.value=oldValue)},enableCache:function(){this._cacheActivated=!0},disableCache:function(){this._cacheActivated=!1},getSuggestionPrefix:function(){return this._suggestionPrefixId+this._uid+"_"},getHighlightedSuggestionIndex:function(){return this._highlightedSuggestionIndex},getSelectedSuggestionIndex:function(){return this._selectedSuggestionIndex},getSelectedSuggestion:function(){return this.getAllSuggestionParams(this.getSuggestionPrefix()+this.getSelectedSuggestionIndex())},setDelayOnMouseOver:function(e){e=namespace.tools.integerValue(e);this.applyDelayOnMouseOver=!e||e<=0?0:e},getDelayOnMouseOver:function(){return this.applyDelayOnMouseOver||0},hasPositionReference:function(){return!!this._positionReference},getPositionReference:function(){return this._positionReference},getCompletionDiv:function(){return this._completionDiv},getCssPrefix:function(){return this.cssPrefix},getUid:function(){return this._uid},abortSubmit:function(){this._abortSubmit=!0},updateCurrentFieldValue:function(){this._currentFieldValue=this.field.value},updateSelectedIndex:function(){this._selectedSuggestionIndex=this._highlightedSuggestionIndex},hasForm:function(){return!!this.field.form},setCheckInputValue:function(e){this.checkInput=e},addSuggestionParam:function(e,t,i){this._suggestionsList.addSuggestionParam(e,t,i)},getSuggestionParam:function(e,t){return this._suggestionsList.getSuggestionParam(e,t)},getAllSuggestionParams:function(e){return this._suggestionsList.getAllSuggestionParams(e)},getSizeOfSuggestionsList:function(){return this._suggestionsList.getSize()},getSuggestionsList:function(){return this._suggestionsList.getAllSuggestions()},resetSuggestionsList:function(){this._suggestionsList.resetAllParams()}},namespace.Component=Component;var SuggestionList=function(){this._size=0,this._suggestions={}};SuggestionList.prototype={addSuggestionParam:function(e,t,i){this._suggestions[e]||(this._suggestions[e]={},this._size++),this._suggestions[e][t]=i},getSuggestionParam:function(e,t){return!e||!this._suggestions[e]||wink.isUndefined(this._suggestions[e][t])?null:this._suggestions[e][t]},getAllSuggestionParams:function(e){return!e||wink.isUndefined(this._suggestions[e])?null:this._suggestions[e]},resetAllParams:function(){this._size=0,this._suggestions={}},getSize:function(){return this._size},getAllSuggestions:function(){return this._suggestions}},namespace.SuggestionList=SuggestionList,namespace.tools={eventHash:[],ieGetUniqueID:function(e){return e===window?"theWindow":e===document?"theDocument":e.uniqueID},arrayKeyExists:function(e,t){return!(!t||t.constructor!==Array&&t.constructor!==Object)&&void 0!==t[e]},integerValue:function(e){var t=typeof e;return"number"==t?e:"string"==t?parseInt(e):"boolean"==t&&e?1:0},ucFirst:function(e){return 0<e.length?e.charAt(0).toUpperCase()+e.substring(1):e},lcFirst:function(e){return 0<e.length?e.charAt(0).toLowerCase()+e.substring(1):e},clone:function(e){var t,i=e instanceof Array?[]:{};for(t in e)e[t]&&"object"==typeof e[t]?i[t]=namespace.tools.clone(e[t]):i[t]=e[t];return i},mixin:function(e,t){for(var i in t)"_"!=i.substr(0,1)&&(e[i]=t[i]);return e},stripAccents:function(e){e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace("/Ã©/g","e")).replace("/Ã¨/g","e")).replace("/Ãª/g","e")).replace("/Ã«/g","e")).replace("/Ã /g","a")).replace("/Ã¢/g","a")).replace("/Ã¤/g","a")).replace("/Ã¬/g","i")).replace("/Ã®/g","i")).replace("/Ã¯/g","i")).replace("/Ã´/g","o")).replace("/Ã¶/g","o")).replace("/Ã²/g","o")).replace("/Ã»/g","u")).replace("/Ã¼/g","u")).replace("/Ã¹/g","u")).replace("/Ã§/g","c")).replace("/Ã±/g","n")).replace("/Ã¿/g","y");for(var t="àâäáÀÁÄÂëèéêÊÉÈËïîíìÌÍÎÏòóôöÒÓÔÖüùûúÚÙÛÜãõñÃÕÑç",i=0;i<t.length;i++)e=e.split(t.charAt(i)).join("aaaaAAAAeeeeEEEEiiiiIIIIooooOOOOuuuuUUUUaonAONc".charAt(i));return e},stripSeparatorChars:function(e){return e.replace(/[-._']/g," ")},cleanQuery:function(e){return e.toLowerCase().replace(/[ ]+/g," ").replace(/^ /,"")},clearSpace:function(e){return e.toLowerCase().replace(/[ ]+/g," ").replace(/^ /,"").replace(/ $/,"")},focusOnInputEnd:function(e){var t;e.focus(),this.setSelectionRange?(t=2*e.value.length,this.setSelectionRange(t,t)):(t=e.value,e.value="",e.value=t)},writeScript:function(e,t){var i,n=document.getElementsByTagName("head")[0],s=document.createElement("script");document.getElementById(t)&&(i=document.getElementById(t),n.removeChild(i)),s.setAttribute("id",t),s.setAttribute("type","text/javascript"),s.setAttribute("src",e),n.appendChild(s)},getBoldInvNode:function(e,t,i,n){var s,o=document.createElement(e.tagName),a=e.firstChild.nodeValue;if(wink.isUndefined(t)||0==t.length)return(s=document.createElement("b")).appendChild(document.createTextNode(a)),o.appendChild(s),o;t=this.clearSpace(t);var r=this.stripAccents(this.stripSeparatorChars(t)).toLowerCase(),l=this.stripAccents(this.stripSeparatorChars(a)).toLowerCase();n&&i?a=this.stripAccents(this.stripSeparatorChars(a)):n?a=this.stripSeparatorChars(a):i&&(a=this.stripAccents(a));for(var c=0,h=l.indexOf(r,c);-1!=h;){0==h||" "==l.charAt(h-1)?(c<h&&((s=document.createElement("b")).appendChild(document.createTextNode(a.substring(c,h))),o.appendChild(s)),c=h+r.length,o.appendChild(document.createTextNode(a.substring(h,c)))):((s=document.createElement("b")).appendChild(document.createTextNode(a.substring(c,h+r.length))),o.appendChild(s),c=h+r.length);h=l.indexOf(r,c)}return l.length>c&&((s=document.createElement("b")).appendChild(document.createTextNode(a.substring(c))),o.appendChild(s)),o},addClass:function(e,t){var i=e.className;(" "+i+" ").indexOf(" "+t+" ")<0&&(e.className=i+(i?" ":"")+t)},removeClass:function(e,t){t=wink.trim((" "+e.className+" ").replace(" "+t+" "," "));e.className!=t&&(e.className=t)},hasClass:function(e,t){return 0<=(" "+e.className+" ").indexOf(" "+t+" ")},fullDate:function(e){var t=new Array("janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"),i=new Array("dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"),n=new Date;return void 0!==e&&1==e?n.getDate()+" "+t[n.getMonth()]+" "+n.getFullYear():i[n.getDay()]+" "+n.getDate()+" "+t[n.getMonth()]+" "+n.getFullYear()},getNowDay:function(){var e="";switch((new Date).getDay()){case 0:e="dimanche";break;case 1:e="lundi";break;case 2:e="mardi";break;case 3:e="mercredi";break;case 4:e="jeudi";break;case 5:e="vendredi";break;case 6:e="samedi"}return e},getNowDate:function(){var e=new Date;switch(str=e.getDate()+" ",e.getMonth()){case 0:str+="janvier";break;case 1:str+="février";break;case 2:str+="mars";break;case 3:str+="avril";break;case 4:str+="mai";break;case 5:str+="juin";break;case 6:str+="juillet";break;case 7:str+="août";break;case 8:str+="septembre";break;case 9:str+="octobre";break;case 10:str+="novembre";break;case 11:str+="décembre"}return str},getSimpleFavIconUrl:function(e){return!(!e||e.length<=0)&&(e="//"!=(e="https://"==(e="http://"==e.substr(0,7)?e.substring(5):e).substr(0,8)?e.substring(6):e).substr(0,2)?"//"+e:e)+"/favicon.ico"},stopEvent:function(e){(e=e||window.event).stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1},simpleHash:function(e,t){for(var i=0,n=0;n<e.length;n++)i+=e.charCodeAt(n)*(n+1);return Math.abs(i)%t},addEventListener:function(t,i,n,s){if(void 0!==t&&t){if(void 0===s&&(s=!1),t.attachEvent){if("touchtap"===i)return;var o="{FNKEY::obj_"+namespace.tools.ieGetUniqueID(t)+"::evt_"+i+"::fn_"+namespace.tools.simpleHash(n.toString(),1e6)+"}";if(namespace.tools.eventHash[o])return;function a(){n.call(t)}return namespace.tools.eventHash[o]=a,t.attachEvent("on"+i,a)}var r;if(t.addEventListener)return"touchtap"!==i?t.addEventListener(i,n,s):[namespace.tools.addEventListener(document,"touchstart",function(e){r=e.touches[0]||e.changedTouches[0]},!1),namespace.tools.addEventListener(document,"touchend",wink.bind(function(t){t=t.touches[0]||t.changedTouches[0];3<Math.abs(r.x-t.x)||3<Math.abs(t.y-r.y)||this.autoCompleter.manageFieldOnBlur(e)},this.field),!1)]}},removeEventListener:function(e,t,i,n){if(void 0!==e&&e){if(void 0===n&&(n=!1),e.detachEvent){var s="{FNKEY::obj_"+namespace.tools.ieGetUniqueID(e)+"::evt_"+t+"::fn_"+namespace.tools.simpleHash(i.toString(),1e6)+"}",o=namespace.tools.eventHash[s];return o?(delete namespace.tools.eventHash[s],e.detachEvent("on"+t,o)):void 0}return e.removeEventListener?e.removeEventListener(t,i,n):void 0}},checkEventCompatibility:function(){return window.attachEvent||window.addEventListener},setOpacity:function(e,t){t=wink.byId(t);t&&(t.style.opacity=e/100,t.style.MozOpacity=e/100,t.style.KhtmlOpacity=e/100,t.style.filter="alpha(opacity="+e+")")}},String.prototype.cutString||(String.prototype.cutString=function(e){return 0<e&&this.length>e?this.substring(0,e-3)+"...":this});var Plugin=function(){return this.completionComponent=null,this};Plugin._extendPluginChildren=[],Plugin.prototype={setCompletionComponent:function(e){this.completionComponent=e},getTypeOfSuggestion:function(){return null},populateNewBlockLabel:function(e,t){this.completionComponent.populateNewBlockLabel(e,t)},populateNewSuggestionRow:function(e,t,i,n){this.completionComponent.populateNewSuggestionRow(e,t,i,n)},addEventListenerOnNewSuggestionRow:function(e){this.completionComponent.addEventListenerOnNewSuggestionRow(e)},extendFromPlugin:function(e){if(Plugin._extendPluginChildren[e])return!0;for(var t in namespace.plugin.Plugin.prototype)"extendFromPlugin"!=t&&(e.prototype[t]||(e.prototype[t]=namespace.plugin.Plugin.prototype[t]));return Plugin._extendPluginChildren[e]=!0}},namespace.plugin.Plugin=Plugin;var DirectLink=function(){return namespace.plugin.Plugin.call(this),(new namespace.plugin.Plugin).extendFromPlugin(namespace.plugin.DirectLink),this.displayUrlAsTitle=!1,this._currentLink="",this._textAppend="&nbsp;&nbsp;(acces direct)",this._directLinkClickHandler=function(e){this.completionComponent.isTargetBlank?window.open(e):window.location.href=e},this};DirectLink.prototype={getTypeOfSuggestion:function(){return"link"},isValidType:function(e){return e==this.getTypeOfSuggestion()},initProperties:function(){this.completionComponent._properties.displayUrlAsTitle&&(this.displayUrlAsTitle=this.completionComponent._properties.displayUrlAsTitle),wink.isUndefined(this.completionComponent._properties.directLinkTextAppend)||(this._textAppend=this.completionComponent._properties.directLinkTextAppend),wink.isUndefined(this.completionComponent._properties.directLinkClickHandler)||(this._directLinkClickHandler=this.completionComponent._properties.directLinkClickHandler)},initSubscription:function(){wink.subscribe("/callback/manageFormOnSubmit/beforeSubmit",{context:this,method:"checkDirectLinks"})},removeSubscription:function(){wink.unsubscribe("/callback/manageFormOnSubmit/beforeSubmit",{context:this,method:"checkDirectLinks"})},populateNewSuggestionRow:function(e,t,i,n){var s;this.displayUrlAsTitle&&i.d&&i.d.display_url?i.v=i.d.display_url:i.d&&i.d.title&&(i.v=i.d.title),this.completionComponent.populateNewSuggestionRow(e,t,i,n),t.firstChild&&(s=document.createElement("span"),namespace.tools.addClass(s,"rightLabel"),s.innerHTML=this._textAppend,t.insertBefore(s,t.firstChild)),i.d.url&&(this.completionComponent.addSuggestionParam(t.id,"url",i.d.url),s=document.createElement("div"),namespace.tools.addClass(s,"picAnchor"),t.insertBefore(s,t.firstChild)),t=this.createLinkContainerElement(t,i),namespace.tools.addEventListener(t,"mousedown",function(e){e.stopPropagation()})},createLinkContainerElement:function(e,t){var i=document.createElement("div"),n=document.createElement("a");return n.setAttribute("href",t.d.url),this.completionComponent.isTargetBlank&&n.setAttribute("target","_blank"),namespace.tools.addClass(n,"linkContainer"),n.innerHTML=e.innerHTML,i.appendChild(n),e.innerHTML=i.innerHTML,e},addEventListenerOnNewSuggestionRow:function(e){var t=this.completionComponent;namespace.tools.addEventListener(e,"mousedown",function(e){t.manageDivOnMouseDown(t,e,this)}),namespace.tools.addEventListener(e,"mouseover",function(e){t.manageDivOnMouseOver(t,e,this)}),namespace.tools.addEventListener(e,"mouseout",function(e){t.manageDivOnMouseOut(t,e,this)})},checkDirectLinks:function(e){if(e.uid!=this.completionComponent.getUid())return!1;e=this.completionComponent._getSuggestionId(this.completionComponent._selectedSuggestionIndex);if(this.completionComponent.getSuggestionParam(e,"t")!==this.getTypeOfSuggestion())return!1;e=this.completionComponent.getSuggestionParam(e,"url");return!!e&&(this.completionComponent.resetCompletion(),this.completionComponent.abortSubmit(),this._directLinkClickHandler(e),!0)}},namespace.plugin.DirectLink=DirectLink;var Petale=function(){return namespace.plugin.Plugin.call(this),(new namespace.plugin.Plugin).extendFromPlugin(namespace.plugin.Petale),this._identifierOfElement=[],this._idOfElement=[],this._petaleDdata=[],this._petaleThematics={boutique:"mboutique",people:"mpeople",shopping:"mshopping",meteo:"mmeteo"},this._smoothShow=!1,this._smoothShowDelay=20,this._smoothShowIncrement=3,this._petaleInfoSize=50,this._petaleTitleSize=25,this._petaleDefaultImages={},this._borderBottomOfCompletionContainer=0,this._navigateInPetale=!1,this._justExit=!1,this._currentPetaleId=0,this._currentPetaleLinkId=0,this._petaleContainerIdentifier="petaleContainerId_",this._petaleSubContainerIdentifier="petaleSubContainerId_",this._petaleContainerCssClass="petaleBox",this._petaleContainerTitleCssClass="petaleBoxTitle",this._petaleSubContainerCssClass="petaleSubContainer",this._petaleReferenceContainerCssClass="petaleReferenceContainer",this._petaleReferenceContainerFullCssClass="petaleReferenceFullContainer",this._petaleSubReferenceContainerCssClass="petaleSubReferenceContainer",this._petaleSubReferenceContainerFullCssClass="petaleSubReferenceFullContainer",this._petaleReferenceImageTableCssClass="petaleReferenceImageTable",this._petaleReferenceImageTrCssClass="petaleReferenceImageTr",this._petaleReferenceImageTdCssClass="petaleReferenceImageTd",this._petaleReferenceImageContainerCssClass="petaleReferenceImageContainer",this._petaleReferenceImageCssClass="petaleReferenceImage",this._petaleReferenceInfoContainerCssClass="petaleReferenceInfoContainer",this._petaleReferenceInfoTopContainerCssClass="petaleReferenceInfoTopContainer",this._petaleReferenceInfoCssClass="petaleReferenceInfo",this._petaleReferenceUrlDisplayCssClass="petaleReferenceUrlDisplay",this._petaleReferenceUrlDisplayFaviconCssClass="petaleReferenceUrlDisplayFavicon",this._petaleActionLinkContainerCssClass="petaleActionLinkContainer",this._petaleActionLinkSeparatorCssClass="petaleActionLinkSeparator",this._petaleActionLinkCssClass="petaleActionLink",this._petaleActionUrlDisplayCssClass="petaleActionUrlDisplay",this._petaleActionUrlDisplayTextCssClass="petaleActionUrlDisplayText",this._petaleActionTextCssClass="petaleActionText",this._petaleGeneralActionOverCssClass="highlighted",this._petaleClickHandler=function(e){window.location.href=e},this};Petale.prototype={canBeUsed:function(){return!("ontouchstart"in document.documentElement)},getTypeOfSuggestion:function(){return"petale"},isValidType:function(e){return e==this.getTypeOfSuggestion()},populateNewSuggestionRow:function(e,t,i,n){var s;(i.d.links||i.d.ref)&&(s=document.createElement("div"),namespace.tools.addClass(s,"chevron"),t.appendChild(s)),this.completionComponent.populateNewSuggestionRow(e,t,i,n)},initProperties:function(){wink.isUndefined(this.completionComponent._properties.petaleSmoothShow)||(this._smoothShow=this.completionComponent._properties.petaleSmoothShow),!wink.isUndefined(this.completionComponent._properties.petaleSmoothShowDelay)&&wink.isInteger(this.completionComponent._properties.petaleSmoothShowDelay)&&(this._smoothShowDelay=this.completionComponent._properties.petaleSmoothShowDelay),!wink.isUndefined(this.completionComponent._properties.petaleSmoothShowIncrement)&&wink.isInteger(this.completionComponent._properties.petaleSmoothShowIncrement)&&(this._smoothShowIncrement=this.completionComponent._properties.petaleSmoothShowIncrement),!wink.isUndefined(this.completionComponent._properties.petaleBorderBottomOfContainer)&&wink.isInteger(this.completionComponent._properties.petaleBorderBottomOfContainer)&&(this._borderBottomOfCompletionContainer=this.completionComponent._properties.petaleBorderBottomOfContainer),wink.isUndefined(this.completionComponent._properties.petaleImageWidthHeight)||(this.petaleImageWidthHeight=this.completionComponent._properties.petaleImageWidthHeight),!wink.isUndefined(this.completionComponent._properties.petaleInfoSize)&&3<this.completionComponent._properties.petaleInfoSize&&(this._petaleInfoSize=this.completionComponent._properties.petaleInfoSize),!wink.isUndefined(this.completionComponent._properties.petaleTitleSize)&&3<this.completionComponent._properties.petaleTitleSize&&(this._petaleTitleSize=this.completionComponent._properties.petaleTitleSize),wink.isUndefined(this.completionComponent._properties.petaleThematics)||(this._petaleThematics=this.completionComponent._properties.petaleThematics),wink.isUndefined(this.completionComponent._properties.petaleDefaultImages)||(this._petaleDefaultImages=this.completionComponent._properties.petaleDefaultImages),wink.isUndefined(this.completionComponent._properties.petaleClickHandler)||(this._petaleClickHandler=this.completionComponent._properties.petaleClickHandler)},initPlugin:function(){var e=document.createElement("div");e.style.position="relative",e.style.width="100%",e.style.height="0px",e.style.margin="0px",e.style.padding="0px",e.style.zIndex="910",this._petaleDivObjectContainer=e,this.completionComponent.hasPositionReference()?this.completionComponent.getPositionReference().parentNode.insertBefore(e,this.completionComponent.getPositionReference()):this.completionComponent.getCompletionDiv().parentNode.insertBefore(e,this.completionComponent.getCompletionDiv())},removePlugin:function(){this._petaleDivObjectContainer&&(this.completionComponent.hasPositionReference()&&this.completionComponent.getPositionReference().parentNode?this.completionComponent.getPositionReference().parentNode.removeChild(this._petaleDivObjectContainer):this.completionComponent.getCompletionDiv().parentNode&&this.completionComponent.getCompletionDiv().parentNode.removeChild(this._petaleDivObjectContainer))},initSubscription:function(){wink.subscribe("/callback/highlightNewValue/suggestionHighlighted",{context:this,method:"highLightPetaleElement"}),wink.subscribe("/callback/displayCompletionResults/elementAdded",{context:this,method:"_savePositionForPetaleSuggestion"}),wink.subscribe("/callback/displayCompletionResults/allElementsAdded",{context:this,method:"_createAllPetaleElementsCall"}),wink.subscribe("/callback/hideCompletionDiv/hide",{context:this,method:"hideAllPetaleElements"}),wink.subscribe("/callback/resetCompletion/reset",{context:this,method:"hideAllPetaleElements"}),wink.subscribe("/callback/displayCompletionResults/beforeDisplay",{context:this,method:"_resetPetaleData"})},removeSubscription:function(){wink.unsubscribe("/callback/highlightNewValue/suggestionHighlighted",{context:this,method:"highLightPetaleElement"}),wink.unsubscribe("/callback/displayCompletionResults/elementAdded",{context:this,method:"_savePositionForPetaleSuggestion"}),wink.unsubscribe("/callback/displayCompletionResults/allElementsAdded",{context:this,method:"_createAllPetaleElementsCall"}),wink.unsubscribe("/callback/hideCompletionDiv/hide",{context:this,method:"hideAllPetaleElements"}),wink.unsubscribe("/callback/resetCompletion/reset",{context:this,method:"hideAllPetaleElements"}),wink.unsubscribe("/callback/displayCompletionResults/beforeDisplay",{context:this,method:"_resetPetaleData"})},initFieldListeners:function(){var t=this;namespace.tools.removeEventListener(this.completionComponent.field,"keydown",this.completionComponent.manageFieldOnKeyDown),this.onKeyDownFunctionHandler=function(e){t.manageFieldOnKeyDown(e)},namespace.tools.addEventListener(this.completionComponent.field,"keydown",this.onKeyDownFunctionHandler),namespace.tools.removeEventListener(this.completionComponent.field,"keyup",this.completionComponent.manageFieldOnKeyUp),this.onKeyUpFunctionHandler=function(e){t.manageFieldOnKeyUp(e)},namespace.tools.addEventListener(this.completionComponent.field,"keyup",this.onKeyUpFunctionHandler)},removeFieldListeners:function(){namespace.tools.removeEventListener(this.completionComponent.field,"keydown",this.onKeyDownFunctionHandler),namespace.tools.removeEventListener(this.completionComponent.field,"keyup",this.onKeyUpFunctionHandler)},manageFieldOnKeyUp:function(e){return!(!(e=!e&&window.event?window.event:e)||!e.keyCode)&&(!this._justExit&&!this._navigateInPetale||(this._justExit=!1,e.keyCode!=this.completionComponent.keyCode.keyDown&&e.keyCode!=this.completionComponent.keyCode.keyUp&&e.keyCode!=this.completionComponent.keyCode.keyLeft&&e.keyCode!=this.completionComponent.keyCode.keyRight&&e.keyCode!=this.completionComponent.keyCode.keyEnter))&&this.completionComponent.defaultFieldOnKeyUpCallBack(e)},manageFieldOnKeyDown:function(e){if(!(e=!e&&window.event?window.event:e)||!e.keyCode)return!1;switch(e.keyCode){case this.completionComponent.keyCode.keyRight:if(this._enterInPetaleContainer(e))return!0;break;case this.completionComponent.keyCode.keyLeft:if(this._exitFromPetaleContainer(e))return!0;break;case this.completionComponent.keyCode.keyUp:if(this._upInPetaleContainer(e))return!0;break;case this.completionComponent.keyCode.keyDown:if(this._downInPetaleContainer(e))return!0;break;case this.completionComponent.keyCode.keyEnter:if(this._validateInPetaleContainer(e))return!0}return this.completionComponent.defaultFieldOnKeyDownCallBack(e)},_enterInPetaleContainer:function(e){if(this._navigateInPetale)return!0;var t=this.completionComponent.getHighlightedSuggestionIndex();if(!t)return!1;if(this._navigateInPetale=!0,this._currentPetaleId=this.completionComponent.getUid()+"_"+t,this._currentPetaleLinkId=1,!wink.byId(this._petaleContainerIdentifier+this._currentPetaleId))return!1;if(!this.completionComponent.getSuggestionParam(this.completionComponent.getSuggestionPrefix()+t,"linkCount"))return!1;t=wink.byId("petaleActionLink_"+this._currentPetaleId+"_1");return!!t&&(namespace.tools.addClass(t,this._petaleGeneralActionOverCssClass),!0)},_exitFromPetaleContainer:function(e){if(!this._navigateInPetale)return!1;if(!this._currentPetaleId||!this._currentPetaleLinkId)return!1;var t=wink.byId("petaleActionLink_"+this._currentPetaleId+"_"+this._currentPetaleLinkId);if(!t)return!1;namespace.tools.removeClass(t,this._petaleGeneralActionOverCssClass),this._currentPetaleId=0,this._currentPetaleLinkId=0,this._justExit=!0;var i=this;return setTimeout(function(){i._navigateInPetale=!1,namespace.tools.focusOnInputEnd(i.completionComponent.field)},30),!0},_upInPetaleContainer:function(e){if(!this._navigateInPetale)return!1;if(!this._currentPetaleId||!this._currentPetaleLinkId)return!1;var t=this.completionComponent.getHighlightedSuggestionIndex();if(!t)return!1;var i=this.completionComponent.getSuggestionParam(this.completionComponent.getSuggestionPrefix()+t,"linkCount");if(!i)return!1;t=this._currentPetaleLinkId-1;if((t=t<1?i:t)==this._currentPetaleLinkId)return!0;i=wink.byId("petaleActionLink_"+this._currentPetaleId+"_"+this._currentPetaleLinkId);return!!i&&(namespace.tools.removeClass(i,this._petaleGeneralActionOverCssClass),this._currentPetaleLinkId=t,!!(i=wink.byId("petaleActionLink_"+this._currentPetaleId+"_"+this._currentPetaleLinkId))&&(namespace.tools.addClass(i,this._petaleGeneralActionOverCssClass),!0))},_downInPetaleContainer:function(e){if(!this._navigateInPetale)return!1;if(!this._currentPetaleId||!this._currentPetaleLinkId)return!1;var t=this.completionComponent.getHighlightedSuggestionIndex();if(!t)return!1;var i=this.completionComponent.getSuggestionParam(this.completionComponent.getSuggestionPrefix()+t,"linkCount");if(!i)return!1;t=this._currentPetaleLinkId+1;if((t=i<t?1:t)===this._currentPetaleLinkId)return!0;i=wink.byId("petaleActionLink_"+this._currentPetaleId+"_"+this._currentPetaleLinkId);return!!i&&(namespace.tools.removeClass(i,this._petaleGeneralActionOverCssClass),this._currentPetaleLinkId=t,!!(i=wink.byId("petaleActionLink_"+this._currentPetaleId+"_"+this._currentPetaleLinkId))&&(namespace.tools.addClass(i,this._petaleGeneralActionOverCssClass),!0))},_validateInPetaleContainer:function(e){if(!this._navigateInPetale)return!1;if(!this._currentPetaleId||!this._currentPetaleLinkId)return!1;var t=this.completionComponent.getHighlightedSuggestionIndex();if(!t)return!1;this._justExit=!0;var i,n=this.completionComponent.getSuggestionParam(this.completionComponent.getSuggestionPrefix()+t,"link_url_action_"+this._currentPetaleLinkId);return n&&(namespace.tools.stopEvent(e),i=this,setTimeout(function(){i._petaleClickHandler(n)},250)),!0},_getFormattedText:function(e,t){return e.length>t?e.substring(0,t-3)+"...":e},createOnePetaleElement:function(e,t){var i=this.completionComponent,n=this._petaleThematics.people;switch(n=t.d.them?t.d.them.toLowerCase():n){case this._petaleThematics.meteo:this._createMeteoPetaleElement(i,this,e,t);break;case this._petaleThematics.shopping:this._createShoppingPetaleElement(i,this,e,t);break;case this._petaleThematics.boutique:this._createBoutiquePetaleElement(i,this,e,t);break;default:this._petaleThematics.people;this._createPeoplePetaleElement(i,this,e,t)}},_createPetaleContainer:function(e,t,i){this.completionComponent.addSuggestionParam(this._idOfElement[e],"them",i);var n=document.createElement("div");namespace.tools.addClass(n,this._petaleContainerCssClass+" "+this.completionComponent.getCssPrefix()+" "+this._petaleContainerIdentifier+this._identifierOfElement[e]),n.id=this._petaleContainerIdentifier+this.completionComponent.getUid()+"_"+this._identifierOfElement[e],this._petaleDivObjectContainer.appendChild(n);i=document.createElement("div");namespace.tools.addClass(i,this._petaleContainerTitleCssClass),t.d.title?(i.innerHTML=this._getFormattedText(t.d.title,this._petaleTitleSize),i.title=t.d.title):i.innerHTML="&nbsp;",n.appendChild(i);i=document.createElement("div");return namespace.tools.addClass(i,this._petaleSubContainerCssClass),i.id=this._petaleSubContainerIdentifier+this.completionComponent.getUid()+"_"+this._identifierOfElement[e],n.appendChild(i),i},_createPetaleReferenceContainer:function(e,t,i,n){var s,o=(this.completionComponent,this),a=document.createElement("div");return t?(namespace.tools.addClass(a,this._petaleReferenceContainerCssClass),namespace.tools.addClass(a,this._petaleReferenceContainerCssClass+"_"+n)):(namespace.tools.addClass(a,this._petaleReferenceContainerFullCssClass),namespace.tools.addClass(a,this._petaleReferenceContainerFullCssClass+"_"+n)),!1!==i&&(a.id="petaleActionLink_"+this.completionComponent.getUid()+"_"+this._identifierOfElement[e]+"_1",namespace.tools.addEventListener(a,"mouseover",function(){namespace.tools.addClass(this,o._petaleGeneralActionOverCssClass)}),namespace.tools.addEventListener(a,"mouseout",function(){namespace.tools.removeClass(this,o._petaleGeneralActionOverCssClass)}),namespace.tools.addEventListener(a,"click",(s=i,function(e){namespace.tools.removeClass(this,o._petaleGeneralActionOverCssClass),o._petaleClickHandler(s)})),this.completionComponent.addSuggestionParam(this._idOfElement[e],"link_url_action_1",i)),a},_createPetaleReferenceSubContainer:function(e,t){var i=document.createElement("div");return e?(namespace.tools.addClass(i,this._petaleSubReferenceContainerCssClass),namespace.tools.addClass(i,this._petaleSubReferenceContainerCssClass+"_"+t)):(namespace.tools.addClass(i,this._petaleSubReferenceContainerFullCssClass),namespace.tools.addClass(i,this._petaleSubReferenceContainerFullCssClass+"_"+t)),i},_createPetaleReferenceUrl:function(e,t,i,n){var s,o=document.createElement("div");namespace.tools.addClass(o,this._petaleReferenceUrlDisplayCssClass),namespace.tools.addClass(o,this._petaleReferenceUrlDisplayCssClass+"_"+n),i&&0<i.length&&(s=t.d.ref.urlDisplay)&&(a=document.createElement("img"),namespace.tools.addClass(a,this._petaleReferenceUrlDisplayFaviconCssClass),a.src=namespace.tools.getSimpleFavIconUrl(s),namespace.tools.addEventListener(a,"error",function(){this.parentNode.removeChild(this)}),o.appendChild(a));var a=document.createElement("span");return a.innerHTML=t.d.ref.urlDisplay,o.appendChild(a),o},_createPetaleActionLinks:function(e,t,i,n){var s=(this.completionComponent,this);!1!==i?this.completionComponent.addSuggestionParam(this._idOfElement[e],"linkCount",t.d.links.length+1):this.completionComponent.addSuggestionParam(this._idOfElement[e],"linkCount",t.d.links.length);var o=document.createElement("div");namespace.tools.addClass(o,this._petaleActionLinkContainerCssClass),namespace.tools.addClass(o,this._petaleActionLinkContainerCssClass+"_"+n);var a=1;!1!==i&&a++;for(var r,l,c,h=0;h<t.d.links.length;h++)t.d.links[h].act&&t.d.links[h].type&&t.d.links[h].url&&t.d.links[h].urlDisplay&&(c=document.createElement("div"),namespace.tools.addClass(c,this._petaleActionLinkSeparatorCssClass),namespace.tools.addClass(c,this._petaleActionLinkSeparatorCssClass+"_"+n),o.appendChild(c),(r=document.createElement("div")).id="petaleActionLink_"+this.completionComponent.getUid()+"_"+this._identifierOfElement[e]+"_"+a,namespace.tools.addClass(r,this._petaleActionLinkCssClass),namespace.tools.addClass(r,this._petaleActionLinkCssClass+"_"+n),namespace.tools.addEventListener(r,"mouseover",function(){namespace.tools.addClass(this,s._petaleGeneralActionOverCssClass)}),namespace.tools.addEventListener(r,"mouseout",function(){namespace.tools.removeClass(this,s._petaleGeneralActionOverCssClass)}),l=document.createElement("div"),namespace.tools.addClass(l,t.d.links[h].type+"ActionClass"),c=t.d.links[h].url,this.completionComponent.addSuggestionParam(this._idOfElement[e],"link_url_"+(h+1),c),namespace.tools.addEventListener(r,"click",function(e){return function(){namespace.tools.removeClass(this,s._petaleGeneralActionOverCssClass),s._petaleClickHandler(e)}}(c)),this.completionComponent.addSuggestionParam(this._idOfElement[e],"link_url_action_"+a,c),(c=document.createElement("span")).innerHTML=t.d.links[h].act,namespace.tools.addClass(c,this._petaleActionTextCssClass),l.appendChild(c),r.appendChild(l),l=document.createElement("div"),namespace.tools.addClass(l,this._petaleActionUrlDisplayCssClass),(c=document.createElement("span")).innerHTML=t.d.links[h].urlDisplay,namespace.tools.addClass(c,this._petaleActionUrlDisplayTextCssClass),l.appendChild(c),r.appendChild(l),o.appendChild(r),a++);return o},_createPetaleImage:function(e,t,i){var n=document.createElement("table");namespace.tools.addClass(n,this._petaleReferenceImageTableCssClass),namespace.tools.addClass(n,this._petaleReferenceImageTableCssClass+"_"+i),n.cellPadding=0,n.cellSpacing=0;var s=n.insertRow(-1);namespace.tools.addClass(s,this._petaleReferenceImageTrCssClass),namespace.tools.addClass(s,this._petaleReferenceImageTrCssClass+"_"+i);var o=s.insertCell(-1);namespace.tools.addClass(o,this._petaleReferenceImageTdCssClass),namespace.tools.addClass(o,this._petaleReferenceImageTdCssClass+"_"+i);var a=document.createElement("div");namespace.tools.addClass(a,this._petaleReferenceImageContainerCssClass),namespace.tools.addClass(a,this._petaleReferenceImageContainerCssClass+"_"+i);var r=!1;e._petaleDefaultImages&&e._petaleDefaultImages.default&&(r=e._petaleDefaultImages.default),e._petaleDefaultImages&&e._petaleDefaultImages[i]&&(r=e._petaleDefaultImages[i]);s=document.createElement("img");return namespace.tools.addClass(s,this._petaleReferenceImageCssClass),"string"==typeof t&&0<t.length?("https:"==location.protocol&&(t=t.replace("http:","https:")),s.src=t,namespace.tools.addClass(s,this._petaleReferenceImageCssClass+"_"+i)):(r&&(s.src=r),namespace.tools.addClass(s,this._petaleReferenceImageCssClass+"_"+i+"_default")),namespace.tools.addEventListener(s,"error",function(){r&&(this.src=r),namespace.tools.removeClass(this,e.completionComponent.getCssPrefix()+e._petaleReferenceImageCssClass+"_"+i),namespace.tools.addClass(this,e.completionComponent.getCssPrefix()+e._petaleReferenceImageCssClass+"_"+i+"_default")}),a.appendChild(s),o.appendChild(a),n},_createPetaleInfos:function(e,t,i,n,s){var o=document.createElement("div");namespace.tools.addClass(o,this._petaleReferenceInfoContainerCssClass),namespace.tools.addClass(o,this._petaleReferenceInfoContainerCssClass+"_"+n),e.appendChild(o);e=document.createElement("div");namespace.tools.addClass(e,this._petaleReferenceInfoTopContainerCssClass),namespace.tools.addClass(e,this._petaleReferenceInfoTopContainerCssClass+"_"+n),o.appendChild(e),e.setAttribute("data-oevent-category","header_search_preview"),e.setAttribute("data-oevent-action",i.v),e.setAttribute("data-oevent-label",s),this._createPetaleBasicInfos(i,e,n),i.d.ref.urlDisplay&&s&&(n=this._createPetaleReferenceUrl(t,i,s,n),o.appendChild(n))},_createPetaleBasicInfos:function(e,t,i){for(var n=0;n<e.d.ref.info.length;n++)if(0!=e.d.ref.info[n].length){var s=document.createElement("div");switch(namespace.tools.addClass(s,this._petaleReferenceInfoCssClass+"_"+(n+1)),i){case"boutique":if(1==n){var o=Math.round(2*parseFloat(e.d.ref.info[n]));o<0?o=0:10<o&&(o=10),namespace.tools.addClass(s,this._petaleReferenceInfoCssClass+"_"+i+"_mark"),s.style.backgroundPosition="left -"+14*o+"px";break}default:namespace.tools.addClass(s,this._petaleReferenceInfoCssClass+"_"+i+"_"+(n+1)),s.innerHTML=this._getFormattedText(e.d.ref.info[n],this._petaleInfoSize)}t.appendChild(s)}},_finalizePetale:function(e,t,i,n){var s=this._identifierOfElement[t];namespace.tools.addEventListener(n.parentNode,"mouseover",function(){e._disableOnBlur=!0,e._highlightedSuggestionIndex=s}),namespace.tools.addEventListener(n.parentNode,"mouseout",function(){e._disableOnBlur=!1}),namespace.tools.addEventListener(n.parentNode,"click",function(){e.field.focus()}),n.parentNode.style.position="absolute",n.parentNode.style.zIndex="950",n.parentNode.style.visibility="hidden"},_checkPetaleData:function(e,t){if(t){if(!e.d.ref||!e.d.links||0==e.d.links.length)return!1}else if(!e.d.ref)return!1;return!0},_createPetaleWithAction:function(e,t,i,n,s){var o,a,r,l;void 0!==s&&void 0!==s.type&&void 0!==s.centerImage?this._checkPetaleData(n,!0)?(o=this._createPetaleContainer(i,n,s.type),a=n.d.ref.url,r=this._createPetaleReferenceContainer(i,!0,a,s.type),l=this._createPetaleReferenceSubContainer(!0,s.type),r.appendChild(l),o.appendChild(r),n.d.ref.image?l.appendChild(this._createPetaleImage(t,n.d.ref.image,s.type,s.centerImage)):l.appendChild(this._createPetaleImage(t,!1,s.type,s.centerImage)),n.d.ref.info&&this._createPetaleInfos(l,i,n,s.type,a),s=this._createPetaleActionLinks(i,n,a,s.type),o.appendChild(s),this._finalizePetale(e,i,n,o)):wink.log("Error: people petale must have reference and at least one action link"):wink.log("Error: petale must have a type and centerImage value")},_createPetaleBasic:function(e,t,i,n,s){var o,a,r,l;void 0!==s&&void 0!==s.type&&void 0!==s.centerImage?this._checkPetaleData(n,!1)?(o=this._createPetaleContainer(i,n,s.type),a=n.d.ref.url,r=this._createPetaleReferenceContainer(i,!1,a,s.type),l=this._createPetaleReferenceSubContainer(!1,s.type),r.appendChild(l),o.appendChild(r),n.d.ref.image?l.appendChild(this._createPetaleImage(t,n.d.ref.image,s.type,s.centerImage)):l.appendChild(this._createPetaleImage(t,!1,s.type,s.centerImage)),n.d.ref.info&&this._createPetaleBasicInfos(n,l,s.type),(t=document.createElement("div")).style.clear="left",t.style.height="0px",l.appendChild(t),n.d.ref.urlDisplay&&(s=this._createPetaleReferenceUrl(i,n,a,s.type),r.appendChild(s)),!1!==a&&this.completionComponent.addSuggestionParam(this._idOfElement[i],"linkCount",1),this._finalizePetale(e,i,n,o)):wink.log("Error: people petale must have reference and at least one action link"):wink.log("Error: petale must have a type and centerImage value")},_createPeoplePetaleElement:function(e,t,i,n){this._createPetaleWithAction(e,t,i,n,{type:"people",centerImage:!1})},_createBoutiquePetaleElement:function(e,t,i,n){this._createPetaleWithAction(e,t,i,n,{type:"boutique",centerImage:!0})},_createShoppingPetaleElement:function(e,t,i,n){this._createPetaleBasic(e,t,i,n,{type:"shopping",centerImage:!1})},_createMeteoPetaleElement:function(e,t,i,n){this._createPetaleBasic(e,t,i,n,{type:"meteo",centerImage:!1})},hideAllPetaleElements:function(e){if(e.uid&&e.uid==this.completionComponent.getUid()){if(this._petaleDivObjectContainer){this._currentPetaleId=0,this._currentPetaleLinkId=0,this._navigateInPetale=!1;var t=this._petaleDivObjectContainer.children;if(0<t.length)for(var i=0;i<t.length;i++)t[i].style.visibility="hidden"}return!0}},_destroyAllPetaleElements:function(){this._petaleDivObjectContainer&&(this._petaleDivObjectContainer.innerHTML="")},_resetPetaleData:function(e){e.uid&&e.uid==this.completionComponent.getUid()&&(this._identifierOfElement=[],this._idOfElement=[],this._petaleDdata=[])},highLightPetaleElement:function(e){var t,i;e.uid&&e.uid==this.completionComponent.getUid()&&wink.isInteger(e.index)&&(t=e.index,(i=wink.byId(this._petaleContainerIdentifier+this.completionComponent.getUid()+"_"+t))?"visible"!=i.style.visibility&&(this.hideAllPetaleElements(e),this._smoothShow&&namespace.tools.setOpacity(0,this._petaleContainerIdentifier+this.completionComponent.getUid()+"_"+t),i.style.visibility="visible",this._smoothShow&&this._upOpacityRecursive(this._smoothShowIncrement,100,this._petaleContainerIdentifier+this.completionComponent.getUid()+"_"+t,this._smoothShowDelay)):this.hideAllPetaleElements(e))},_savePositionForPetaleSuggestion:function(e){var t,i;e.uid&&e.uid==this.completionComponent.getUid()&&(t=e.position,i=e.div,(e=e.data).t&&this.isValidType(e.t)&&(this._identifierOfElement[t]=t,this._idOfElement[t]=i.id,this._petaleDdata[t]=e))},_createAllPetaleElementsCall:function(e){var t;e.uid&&e.uid==this.completionComponent.getUid()&&(t=this,setTimeout(function(){t._createAllPetaleElements(e)},1))},_createAllPetaleElements:function(e){this._destroyAllPetaleElements();for(var t=e.position,i=1;i<t;i++){var n=this._petaleDdata[i];n&&this.createOnePetaleElement(i,n)}wink.publish("/callback/createAllPetaleElements/allPetaleElementsAdded")},_upOpacityRecursive:function(e,t,i,n){var s=wink.byId(i);if(s){if("hidden"==s.style.visibility)return s.style.opacity=1,s.style.MozOpacity=1,s.style.KhtmlOpacity=1,void(s.style.filter="alpha(opacity=100)");var o,a=!0,r=100*s.style.opacity;t<(r+=e)&&(r=t,a=!1),s.style.opacity=r/100,s.style.MozOpacity=r/100,s.style.KhtmlOpacity=r/100,s.style.filter="alpha(opacity="+r+")",1==a&&(o=this,setTimeout(function(){o._upOpacityRecursive(e,t,i,n)},n))}}},namespace.plugin.Petale=Petale;var PetaleMobile=function(){return namespace.plugin.Plugin.call(this),(new namespace.plugin.Plugin).extendFromPlugin(namespace.plugin.PetaleMobile),this.boldSuggestion=!0,this.clearAccents=!1,this.clearSeparatorChars=!1,this._ready=!1,this.titleHeight=30,this.statPetaleFunctionCallback=!1,this.displayStatDelay=2e3,this._lastDisplayStatTimers={},this._petaleThematics={people:"mpeople",marque:"mmarque",meteo:"mmeteo"},this.sections={},this.callbacks={},this};PetaleMobile.prototype={getTypeOfSuggestion:function(){return"petale"},isValidType:function(e){return e==this.getTypeOfSuggestion()},populateNewSuggestionRow:function(e,t,i,n){var s=this._createSuggestionElement(i.v,i.d,t);i.css&&wink.isString(i.css)&&namespace.tools.addClass(t,i.css),namespace.tools.addClass(t,"petalemobile"),this.completionComponent.addSuggestionParam(t.id,"v",i.v),this.completionComponent.addSuggestionParam(t.id,"t",i.t),this.completionComponent.addSuggestionParam(t.id,"d",i.d),t.appendChild(s)},_createSuggestionElement:function(e,t,i){var n=document.createElement("div");n.appendChild(document.createTextNode(e)),this.boldSuggestion&&(n=namespace.tools.getBoldInvNode(n,this.completionComponent._currentFieldValue,this.clearAccents,this.clearSeparatorChars));var s=document.createElement("div"),o=this._petaleThematics.people;switch(o=t.them?t.them.toLowerCase():o){case this._petaleThematics.meteo:var a={type:"meteo",title:e,infoIndexToAdd:[1],suggestionNode:i,openedSection:!0},r=this._createPetaleBasic(t,a);s.appendChild(r),s=this._createAccordion(s,n,a);break;case this._petaleThematics.marque:a={type:"marque",title:e,suggestionNode:i,openedSection:!0};r=this._createPetaleBasic(t,a),s.appendChild(r),s=this._createAccordion(s,n,a);break;default:this._petaleThematics.people;a={type:"people",title:e,suggestionNode:i,disableMultipleSections:!0};r=this._createPetaleWithAction(t,a),s.appendChild(r),s=this._createAccordion(s,n,a)}return s},_createAccordion:function(e,t,i){wink.addClass(i.suggestionNode,i.type);var n=new wink.ui.layout.Accordion({autoScroll:!1}),s=n.addSection(i.title,e,{TITLE_HEIGHT:this.titleHeight}),o=n.getSections()[0];this.sections[s]=o;var a=n.getDomNode();o.titleNode.innerHTML="",o.titleNode.appendChild(t),i.hideChevron||o.titleNode.appendChild(o.chevronNode),namespace.tools.addClass(o.contentNode,"content");var r,l,c,h,p,u,t=o.titleNode.onclick;return namespace.tools.addEventListener(o.chevronNode,"mousedown",(h=this,p=i,u=t,function(e){e.stopPropagation(),wink.addClass(p.suggestionNode,"opening"),wink.fx.onTransitionEnd(o.contentNode,function(){wink.removeClass(p.suggestionNode,"opening")}),o.opened||h.displayStat(p.type,p.title),u(e)})),o.titleNode.onclick=null,namespace.tools.addEventListener(o.titleNode,"mousedown",wink.bind(function(e){this.manageDivOnMouseDown(this,e,a.parentNode)},this.completionComponent)),i.disableMultipleSections&&wink.subscribe("/section/events/selectsection",{context:this,method:"toggleOtherAccordions",arguments:n.uId}),i.openedSection&&(t=setTimeout((r=this,l=i.type,c=i.title,function(){r.displayStat(l,c)}),this.displayStatDelay),this._lastDisplayStatTimers[t]=!0,setTimeout(function(){wink.addClass(i.suggestionNode,"first_open"),n.selectSection(s)},1),setTimeout(function(){wink.removeClass(i.suggestionNode,"first_open")},500)),namespace.tools.addEventListener(window,"onorientationchange"in window?"orientationchange":"resize",wink.bind(n.refreshContentHeight,n)),a},toggleOtherAccordions:function(e,t){if(e.accordionId==t&&this.sections[e.sectionId])for(var i in this.sections)i!=e.sectionId&&(this.sections[i].hide(),this.sections[i].accordion._visibleContent=0,this.sections[i].accordion._updateHeight())},_createPetaleWithAction:function(e,t){var i=document.createDocumentFragment();return e.ref&&e.ref.info&&i.appendChild(this._createInfos(e,t)),i.appendChild(this._createLinks(e,t)),i},_createPetaleBasic:function(e,t){void 0===t&&(t={});var i=document.createElement("div");namespace.tools.addClass(i,"info link");var n=this._createLinkContainerElement(e);n.appendChild(this._createImageElement(e.ref.image));var s=!1,o=document.createElement("span");if(o.innerHTML=t.title,n.appendChild(o),e.ref.info){var a=document.createElement("div");namespace.tools.addClass(a,"url");for(var r,l,c=0;c<e.ref.info.length;c++)t.infoIndexToAdd&&t.infoIndexToAdd.indexOf(c)<0||(-1!==(l=(r=e.ref.info[c]).indexOf("[[gambling]]"))&&(s=!0,r=r.slice(0,l)+r.slice(l+12)),(l=document.createElement("span")).innerHTML=r,a.appendChild(l));n.appendChild(a),s&&(o=document.createElement("div"),namespace.tools.addClass(o,"gambling"),o.innerHTML="Jouer comporte des risques : endettement, dépendance, isolement. Appelez le 09&nbsp;74&nbsp;75&nbsp;13&nbsp;13 (appel non surtaxé).",namespace.tools.addEventListener(o,"mousedown",function(e){e.preventDefault(),e.stopPropagation(),window.open("http://www.joueurs-info-service.fr")}),n.appendChild(o)),i.appendChild(n);var h={domNode:i,url:e.ref.url,callback:e.ref.callback,type:t.type,title:t.title};namespace.tools.addEventListener(i,"mousedown",wink.bind(function(e){this._onLinkElementClick(e,h),e.stopPropagation()},this))}return i},_createLinks:function(e,t){for(var i,n,s,o=document.createDocumentFragment(),a=wink.isSet(e.links)?e.links.length:0,r=0;r<a;r++)e.links[r]&&e.links[r].act&&e.links[r].type&&(s=e.links[r].urlDisplay.replace(/^https?:\/\//,""),n={url:e.links[r].url,type:t.type,title:t.title,label:"<span>"+e.links[r].act+' : </span><span class="url">'+s+"</span>"},s=this._createSingleLinkElement(n),o.appendChild(s));var l=this.completionComponent;return n={callback:function(e){l.manageDivOnMouseDown(l,e,t.suggestionNode)},label:"<span>Tous les résultats "+t.title+"</span>",type:t.type,title:t.title},i=this._createSingleLinkElement(n),o.appendChild(i),o},_onLinkElementClick:function(e,t){return e.stopPropagation(),t.callback&&(this.clickStat(t.type,t.title),wink.call(t.callback,e)),t.url&&this.clickStat(t.type,t.title,t.url),!0},_createSingleLinkElement:function(e){var t=document.createElement("div");namespace.tools.addClass(t,"link");var i,n={domNode:t,url:e.url,callback:e.callback,type:e.type,title:e.title};return void 0!==n.url?((i=this._createLinkContainerElement(n)).innerHTML=e.label,t.appendChild(i)):t.innerHTML=e.label,namespace.tools.addEventListener(t,"mousedown",wink.bind(function(e){this._onLinkElementClick(e,n),e.stopPropagation()},this)),t},_createInfos:function(e,t){var i=document.createElement("div"),n={url:e.ref.url,callback:e.ref.callback,domNode:i,type:t.type,title:t.title};namespace.tools.addClass(i,"info link");var s=this._createLinkContainerElement(n);return s.appendChild(this._createImageElement(e.ref.image)),s.appendChild(this._createTextInfosElement(e,t.type)),i.appendChild(s),namespace.tools.addEventListener(i,"mousedown",wink.bind(function(e){this._onLinkElementClick(e,n),e.preventDefault(),e.stopPropagation()},this)),i},_createLinkContainerElement:function(e){var t=document.createElement("a");return void 0!==e.url?t.setAttribute("href",e.url):void 0!==e.ref.url&&t.setAttribute("href",e.ref.url),this.completionComponent.isTargetBlank&&t.setAttribute("target","_blank"),namespace.tools.addClass(t,"linkContainer"),t},_createImageElement:function(e){var t=document.createElement("img");return namespace.tools.addClass(t,"icon"),"string"==typeof e&&0<e.length?t.src=e:namespace.tools.addClass(t,"error"),t},_createTextInfosElement:function(e,t){var i,n=document.createDocumentFragment();return 0==e.ref.info.length||((i=document.createElement("span")).innerHTML=e.ref.info[0],n.appendChild(i),e=this._createUrlElement(e),namespace.tools.addClass(e,"url"),n.appendChild(e)),n},_createUrlElement:function(e){var t=document.createElement("span");return t.innerHTML=e.ref.urlDisplay,namespace.tools.addClass(t,"url"),t},CLICK_STAT_ACTION:"click",DISPLAY_STAT_ACTION:"display",_stat:function(e,t,i,n){return(e==this.CLICK_STAT_ACTION||e==this.DISPLAY_STAT_ACTION)&&(this.statPetaleFunctionCallback?this.statPetaleFunctionCallback(e,t,i,n):void 0)},displayStat:function(e,t){return this._stat(this.DISPLAY_STAT_ACTION,e,t)},clickStat:function(e,t,i){return this._stat(this.CLICK_STAT_ACTION,e,t,i)},resetGtatDisplayStatsTimer:function(){for(var e in this._lastDisplayStatTimers)clearTimeout(e);this._lastDisplayStatTimers={}},initProperties:function(){this.completionComponent._properties.statPetaleFunctionCallback&&(this.statPetaleFunctionCallback=this.completionComponent._properties.statPetaleFunctionCallback),this.completionComponent._properties.petaleMobileTitleHeight&&(this.titleHeight=this.completionComponent._properties.petaleMobileTitleHeight)},initPlugin:function(){},removePlugin:function(){},initSubscription:function(){wink.subscribe("/callback/displayCompletionResults/beforeDisplay",{context:this,method:"resetGtatDisplayStatsTimer"})},removeSubscription:function(){wink.unsubscribe("/callback/displayCompletionResults/beforeDisplay",{context:this,method:"resetGtatDisplayStatsTimer"})}},namespace.plugin.PetaleMobile=PetaleMobile}();
