(window.shark_room_jsonp=window.shark_room_jsonp||[]).push([["KplReward_dc5210a"],{"15d90c":function(e,t,a){"use strict";var r=a("441a6e");t.default=r.default},"195bca":function(e,t,a){"use strict";var r=a("e5dd00");t.default=r.default},"43ca20":function(e,t,a){},"441a6e":function(e,t,a){"use strict";var r,n=a("1a22b7"),i=a.n(n),l=a("292183"),o=a.n(l),s=a("54992a"),c=(a("dc54d9"),"/shark/live/src/pages/roomPage/playerDialogModule/components/KplReward/Gift/Gift.js");function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function _inherits(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function _defaults(e,t){for(var a=Object.getOwnPropertyNames(t),r=0;r<a.length;r++){var n=a[r],i=Object.getOwnPropertyDescriptor(t,n);i&&i.configurable&&void 0===e[n]&&Object.defineProperty(e,n,i)}return e}(e,t))}var u=Object(s.log)(r=function(e){function Gift(){var t,a;!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Gift);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t=a=_possibleConstructorReturn(this,e.call.apply(e,[this].concat(n))),a.handleGiftClick=function(e){return function(){(0,a.props.handleSelectGid)(e)}},_possibleConstructorReturn(a,t)}return _inherits(Gift,e),Gift.prototype.render=function render(){var e=this,t=this.props,a=t.redTeamInfo,r=t.blueTeamInfo,n=t.selectTeamId,l=t.backTeam,o=t.selectGiftId,s=n===a.id?a:r;return i.a.createElement("div",{className:"kplRewardGift",__source:{fileName:c,lineNumber:25},__self:this},i.a.createElement("i",{className:"kplRewardGift-back",onClick:l,__source:{fileName:c,lineNumber:26},__self:this}),i.a.createElement("p",{className:"kplRewardGift-title",__source:{fileName:c,lineNumber:27},__self:this},"\u652f\u6301",s.name),i.a.createElement("p",{className:"kplRewardGift-tip",__source:{fileName:c,lineNumber:28},__self:this},"\u8d60\u9001\u793c\u7269\u4e3a\u652f\u6301\u7684\u6218\u961f\u589e\u52a0\u4eba\u6c14\uff0c\u6218\u961f\u53ef\u76f4\u63a5\u83b7\u5f97\u9001\u793c\u6536\u76ca\uff0c\u9001\u793c\u7269\u7684\u7528\u6237\u6709\u673a\u4f1a\u5728\u5b98\u65b9\u76f4\u64ad\u6d41\u4e2d\u83b7\u5f97\u66dd\u5149"),i.a.createElement("ul",{className:"kplRewardGift-giftList",__source:{fileName:c,lineNumber:29},__self:this},Array.isArray(s.gids)?s.gids.slice(0,3).map(function(t){return i.a.createElement("li",{className:"kplRewardGift-gift "+(o===t.gid?"is-active":""),key:t.gid,onClick:e.handleGiftClick(t.gid),__source:{fileName:c,lineNumber:33},__self:e},i.a.createElement("div",{className:"kplRewardGift-gift-imgWrap",__source:{fileName:c,lineNumber:38},__self:e},t.gift_icon?i.a.createElement("img",{className:"kplRewardGift-gift-img",src:t.gift_icon,__source:{fileName:c,lineNumber:41},__self:e}):null),i.a.createElement("div",{className:"kplRewardGift-gift-info",__source:{fileName:c,lineNumber:45},__self:e},i.a.createElement("p",{className:"kplRewardGift-gift-name text-ellipsis",title:t.gname,__source:{fileName:c,lineNumber:46},__self:e},t.gname),i.a.createElement("p",{className:"kplRewardGift-gift-score text-ellipsis",title:"\u4eba\u6c14\u503c+"+(t.popularity||0),__source:{fileName:c,lineNumber:47},__self:e},"\u4eba\u6c14\u503c+",t.popularity||0)))}):null))},Gift}(i.a.Component))||r;u.propTypes={selectTeamId:o.a.string,selectGiftId:o.a.string,redTeamInfo:o.a.object,blueTeamInfo:o.a.object,backTeam:o.a.func,handleSelectGid:o.a.func},t.default=u},"5fb15e":function(e,t,a){},"67c7ec":function(e,t,a){"use strict";var r,n,i,l,o,s,c=a("1a22b7"),u=a.n(c),m=a("292183"),f=a.n(m),p=a("7ca7dc"),d=a("54992a"),_=a("eb3e22"),b=a("ed7240"),h=a("3b65fe"),N=(a("43ca20"),"/shark/live/src/pages/roomPage/playerDialogModule/components/KplReward/Vote/Vote.js");function _initDefineProp(e,t,a,r){a&&Object.defineProperty(e,t,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(r):void 0})}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function _inherits(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function _defaults(e,t){for(var a=Object.getOwnPropertyNames(t),r=0;r<a.length;r++){var n=a[r],i=Object.getOwnPropertyDescriptor(t,n);i&&i.configurable&&void 0===e[n]&&Object.defineProperty(e,n,i)}return e}(e,t))}function _applyDecoratedDescriptor(e,t,a,r,n){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=a.slice().reverse().reduce(function(a,r){return r(e,t,a)||a},i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var k=p.default.Service,w={1:.1,6:.6,100:10,666:66.6,1000:100},v=(r=k(h.default),n=k(_.DataCenter.global),Object(d.log)((l=function(e){function Vote(){var t,a;!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Vote);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t=a=_possibleConstructorReturn(this,e.call.apply(e,[this].concat(n))),_initDefineProp(a,"kplRewardService",o,a),_initDefineProp(a,"global",s,a),a.state={currentVote:"6",batterCount:0,showBatter:!1,downCount:0,showPayModal:!1},a.roomId=a.global.get("$ROOM.room_id"),a.showBatterTimer=null,a.batterCountTimer=null,a.handleVoteClick=function(e){return function(){a.setState(function(t){return t.currentVote===e?{}:{currentVote:e}})}},a.handleSupportClick=function(e){return function(){var t=a.props,r=t.selectTeamId,n=t.selectGiftId,i=t.matchId,l=a.state.currentVote;if(r){var o={team_id:r,gift_id:n,num:Number(l),rid:a.roomId,sid:i,ct:3};a.kplRewardService.sendGift(o,e).then(function(){a.showBatterTimer&&(clearTimeout(a.showBatterTimer),a.showBatterTimer=null),a.batterCountTimer&&(clearTimeout(a.batterCountTimer),a.batterCountTimer=null),a.setState(function(e){return{batterCount:e.batterCount+1,showBatter:!0,downCount:50}},function(){a.showBatterTimer=setTimeout(function(){a.setState({showBatter:!1})},3e3),a.batterCountTimer=setTimeout(function(){a.downCount()},1e3)})}).catch(function(e){3===e.error&&a.setState({showPayModal:!0})})}}},a.handleShowPayIframe=function(){a.setState({showPayModal:!1}),a.kplRewardService.showPayIframe()},a.handleShowPayClose=function(){a.setState({showPayModal:!1})},_possibleConstructorReturn(a,t)}return _inherits(Vote,e),Vote.prototype.componentWillReceiveProps=function componentWillReceiveProps(e){e.selectGiftId!==this.props.selectGiftId&&(this.showBatterTimer&&(clearTimeout(this.showBatterTimer),this.showBatterTimer=null),this.batterCountTimer&&(clearTimeout(this.batterCountTimer),this.batterCountTimer=null),this.setState({batterCount:0,showBatter:!1,downCount:0}))},Vote.prototype.downCount=function downCount(){var e=this;this.setState(function(e){var t=e.downCount-1;return{downCount:t>=0?t:0,batterCount:0===t?0:e.batterCount}},function(){e.state.downCount>0&&(e.batterCountTimer=setTimeout(function(){e.downCount()},1e3))})},Vote.prototype.render=function render(){var e=this,t=this.props,a=t.selectTeamId,r=t.redTeamInfo,n=t.blueTeamInfo,i=t.selectGiftId,l=this.state,o=l.currentVote,s=l.batterCount,m=l.showBatter,f=l.downCount,p=l.showPayModal,d=((a===r.id?r.gids:n.gids)||[]).find(function(e){return e.gid===i})||{};return u.a.createElement(c.Fragment,{__source:{fileName:N,lineNumber:175},__self:this},u.a.createElement("div",{className:"kplRewardVote",__source:{fileName:N,lineNumber:176},__self:this},a?u.a.createElement(c.Fragment,{__source:{fileName:N,lineNumber:179},__self:this},u.a.createElement("ul",{className:"kplRewardVote-voteList",__source:{fileName:N,lineNumber:180},__self:this},Object.keys(w).map(function(t){return u.a.createElement("li",{className:"kplRewardVote-vote "+(o===t?"is-active":""),key:t,onClick:e.handleVoteClick(t),__source:{fileName:N,lineNumber:183},__self:e},t)})),u.a.createElement("p",{className:"kplRewardVote-noselectTip",__source:{fileName:N,lineNumber:191},__self:this},d.price,"\u9c7c\u7fc5\u6bcf\u4e2a\uff0c\u8bf7\u9009\u62e9\u6570\u91cf")):u.a.createElement("p",{className:"kplRewardVote-noselectTip",__source:{fileName:N,lineNumber:194},__self:this},"\u8bf7\u9009\u62e9\u6218\u961f\u8fdb\u884c\u652f\u6301"),u.a.createElement("div",{className:"kplRewardVote-vwrap",__source:{fileName:N,lineNumber:197},__self:this},m&&s?u.a.createElement("div",{className:"kplRewardVote-batter",__source:{fileName:N,lineNumber:200},__self:this},s):null,u.a.createElement("div",{className:"kplRewardVote-vbtn "+(a?"":"is-disabled"),onClick:this.handleSupportClick(d.popularity),__source:{fileName:N,lineNumber:203},__self:this},u.a.createElement("i",{className:"kplRewardVote-vbg",style:{width:f>0?2*f+"%":0},__source:{fileName:N,lineNumber:207},__self:this}),u.a.createElement("span",{className:"kplRewardVote-text",__source:{fileName:N,lineNumber:213},__self:this},f>0?u.a.createElement("span",{__source:{fileName:N,lineNumber:216},__self:this},"\u8fde\u51fb\xa0\xa0",u.a.createElement("span",{className:"text-highlight",__source:{fileName:N,lineNumber:216},__self:this},f)):u.a.createElement("span",{__source:{fileName:N,lineNumber:218},__self:this},"\u4e00\u952e\u652f\u6301"))))),u.a.createElement(b.default,{visible:p,mask:!0,width:380,center:!0,title:"\u6e29\u99a8\u63d0\u793a",okText:"\u524d\u53bb\u5145\u503c",needCancelBtn:!1,onOk:this.handleShowPayIframe,onCancel:this.handleShowPayClose,__source:{fileName:N,lineNumber:225},__self:this},"\u5f53\u524d\u4f59\u989d\u4e0d\u8db3"))},Vote}(u.a.Component),o=_applyDecoratedDescriptor(l.prototype,"kplRewardService",[r],{enumerable:!0,initializer:null}),s=_applyDecoratedDescriptor(l.prototype,"global",[n],{enumerable:!0,initializer:null}),i=l))||i);v.propTypes={selectTeamId:f.a.string,selectGiftId:f.a.string,matchId:f.a.string,redTeamInfo:f.a.object,blueTeamInfo:f.a.object},t.default=v},"7f717b":function(e,t,a){"use strict";var r=a("67c7ec");t.default=r.default},"8b644f":function(e,t,a){"use strict";var r,n,i,l,o,s,c=a("1a22b7"),u=a.n(c),m=a("292183"),f=a.n(m),p=a("447d8e"),d=a("7ca7dc"),_=a("54992a"),b=a("97a851"),h=a.n(b),N=a("eb3e22"),k=a("e854a7"),w=a("3b65fe"),v=a("c9a986"),g=a("7f717b"),y=a("15d90c"),R=a("195bca"),T=(a("fc628f"),"/shark/live/src/pages/roomPage/playerDialogModule/components/KplReward/KplReward.js");function _initDefineProp(e,t,a,r){a&&Object.defineProperty(e,t,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(r):void 0})}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function _inherits(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function _defaults(e,t){for(var a=Object.getOwnPropertyNames(t),r=0;r<a.length;r++){var n=a[r],i=Object.getOwnPropertyDescriptor(t,n);i&&i.configurable&&void 0===e[n]&&Object.defineProperty(e,n,i)}return e}(e,t))}function _applyDecoratedDescriptor(e,t,a,r,n){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=a.slice().reverse().reduce(function(a,r){return r(e,t,a)||a},i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var C=d.default.Service,E=k.default.socketStream,I=h.a.decode,S=(r=C(w.default),n=C(N.DataCenter.common),Object(_.log)((l=function(e){function KplReward(){var t,a;!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,KplReward);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t=a=_possibleConstructorReturn(this,e.call.apply(e,[this].concat(n))),_initDefineProp(a,"kplRewardService",o,a),_initDefineProp(a,"common",s,a),a.state={currentStep:"none",selectTeamId:"",selectGiftId:"",bannerSrc:""},a.rankRef=null,a.hasAct=!1,a.showRank=function(){a.rankRef&&a.rankRef.toggleVisible&&a.rankRef.toggleVisible(!0)()},a.handleClosePanel=function(){a.kplRewardService.togglePanelShow()},a.handleSelectTeamId=function(e){var t=a.props,r=t.redTeamInfo,n=t.blueTeamInfo,i=(e===r.id?r:n).gids,l=void 0===i?[]:i;a.setState({selectTeamId:e,selectGiftId:l[1].gid,currentStep:"gift"})},a.handleSelectGid=function(e){a.setState({selectGiftId:e})},a.handleBackTeam=function(){a.setState({selectTeamId:"",selectGiftId:"",currentStep:"team"})},_possibleConstructorReturn(a,t)}return _inherits(KplReward,e),KplReward.prototype.componentDidMount=function componentDidMount(){var e=this;this.common.get("$DATA").subscribe(function(t){var a=(t.get("room")||{}).giftActivity,r=(a=void 0===a?{}:a).fold,n=void 0===r?[]:r,i=a.unfold;[].concat(n,void 0===i?[]:i).find(function(e){return"KplReward"===e.activity_flag})&&(e.hasAct=!0,e.kplRewardService.getMatchInfo(),e.subsribeMatch())}),this.setBannerPic()},KplReward.prototype.componentWillReceiveProps=function componentWillReceiveProps(e){this.props.matchId!==e.matchId&&this.setState({currentStep:e.matchId?"team":"none"})},KplReward.prototype.setBannerPic=function setBannerPic(){var e=this;this.kplRewardService.getBannerPicConfig().subscribe(function(t){if(t&&0===+t.error){var a=t.data;if(a&&"string"===typeof a)try{a=JSON.parse(a)}catch(e){console.log(e)}if("[object Object]"===Object.prototype.toString.apply(a)){var r=a.web_banner_bg_open;e.setState({bannerSrc:r||""})}}})},KplReward.prototype.subsribeMatch=function subsribeMatch(){var e=this;E.subscribe("bizcomact",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.act_name,r=t.kplreward_carnival;if("kpl_reward"===a){var n=I(r),i=e.props.matchId;2!==Number(n.st)?(i!==n.sid&&1===Number(n.st)&&e.kplRewardService.getConfig(),e.kplRewardService.saveMatchInfo(n)):e.kplRewardService.gameEnd()}})},KplReward.prototype.genRewardBody=function genRewardBody(e){var t=this.props,a=t.redTeamInfo,r=t.blueTeamInfo,n=t.flagConfig,i=this.state,l=i.selectTeamId,o=i.selectGiftId,s=i.bannerSrc;return"team"===e?u.a.createElement(v.default,{redTeamInfo:a,blueTeamInfo:r,flagConfig:n,handleSelectTeamId:this.handleSelectTeamId,__source:{fileName:T,lineNumber:172},__self:this}):"gift"===e?u.a.createElement(y.default,{selectTeamId:l,selectGiftId:o,redTeamInfo:a,blueTeamInfo:r,backTeam:this.handleBackTeam,handleSelectGid:this.handleSelectGid,__source:{fileName:T,lineNumber:183},__self:this}):u.a.createElement("div",{className:"kplReward-noMatch",__source:{fileName:T,lineNumber:195},__self:this},s?u.a.createElement("img",{className:"kplReward-noMatchImg",alt:"",src:s,__source:{fileName:T,lineNumber:199},__self:this}):null)},KplReward.prototype.render=function render(){var e=this,t=this.props,a=t.panelShow,r=t.redTeamInfo,n=t.blueTeamInfo,i=t.matchId,l=t.rankList,o=this.state,s=o.currentStep,c=o.selectTeamId,m=o.selectGiftId;return a?u.a.createElement("div",{className:"kplReward",__source:{fileName:T,lineNumber:216},__self:this},u.a.createElement("div",{className:"kplReward-header",__source:{fileName:T,lineNumber:217},__self:this},u.a.createElement("span",{className:"kplReward-header-logo",__source:{fileName:T,lineNumber:218},__self:this},"\u4eba\u6c14PK\u70b9\u4eae\u6218\u65d7"),u.a.createElement("span",{className:"kplReward-header-func",__source:{fileName:T,lineNumber:219},__self:this},u.a.createElement("span",{className:"kplReward-header-rank",onClick:this.showRank,__source:{fileName:T,lineNumber:220},__self:this},"\u6392\u884c\u699c"),u.a.createElement("i",{className:"kplReward-header-close",onClick:this.handleClosePanel,__source:{fileName:T,lineNumber:221},__self:this}))),u.a.createElement("div",{className:"kplReward-body",__source:{fileName:T,lineNumber:224},__self:this},this.genRewardBody(s)),"none"!==s?u.a.createElement("div",{className:"kplReward-footer clearfix",__source:{fileName:T,lineNumber:229},__self:this},u.a.createElement(g.default,{selectTeamId:c,selectGiftId:m,matchId:i,redTeamInfo:r,blueTeamInfo:n,__source:{fileName:T,lineNumber:230},__self:this})):null,u.a.createElement(R.default,{ref:function ref(t){e.rankRef=t},redTeamInfo:r,blueTeamInfo:n,matchId:i,rankList:l,__source:{fileName:T,lineNumber:240},__self:this})):null},KplReward}(u.a.Component),o=_applyDecoratedDescriptor(l.prototype,"kplRewardService",[r],{enumerable:!0,initializer:null}),s=_applyDecoratedDescriptor(l.prototype,"common",[n],{enumerable:!0,initializer:null}),i=l))||i);S.propTypes={panelShow:f.a.bool,matchId:f.a.string,redTeamInfo:f.a.object,blueTeamInfo:f.a.object,flagConfig:f.a.array,rankList:f.a.array};t.default=Object(p.connect)(function mapStateToProps(e){return{panelShow:e.kplRewardData.panelShow,matchId:e.kplRewardData.matchId,redTeamInfo:e.kplRewardData.redTeamInfo,blueTeamInfo:e.kplRewardData.blueTeamInfo,flagConfig:e.kplRewardData.flagConfig,rankList:e.kplRewardData.rankList}})(S)},c9a986:function(e,t,a){"use strict";var r=a("d7a495");t.default=r.default},d7a495:function(e,t,a){"use strict";var r,n=a("1a22b7"),i=a.n(n),l=a("292183"),o=a.n(l),s=a("54992a"),c=a("fc7947"),u=a.n(c),m=(a("e81f68"),"/shark/live/src/pages/roomPage/playerDialogModule/components/KplReward/Team/Team.js");function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function _inherits(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function _defaults(e,t){for(var a=Object.getOwnPropertyNames(t),r=0;r<a.length;r++){var n=a[r],i=Object.getOwnPropertyDescriptor(t,n);i&&i.configurable&&void 0===e[n]&&Object.defineProperty(e,n,i)}return e}(e,t))}var f=Object(s.log)(r=function(e){function Team(){var t,a;!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Team);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t=a=_possibleConstructorReturn(this,e.call.apply(e,[this].concat(n))),a.handleTeamClick=function(e){return function(){u.a.check()?e&&(0,a.props.handleSelectTeamId)(e):u.a.show()}},_possibleConstructorReturn(a,t)}return _inherits(Team,e),Team.prototype.formatScore=function formatScore(e){return e?e>=1e4?Math.floor(e/1e4*100)/100+"\u4e07":e:""},Team.prototype.checkFlagActive=function checkFlagActive(e,t){return t>=Number(e.score)?"active":""},Team.prototype.genProgressWidth=function genProgressWidth(e,t,a){var r=e+t;return e===t?"50%":"red"===a?20+e/r*60+"%":"blue"===a?20+t/r*60+"%":"50%"},Team.prototype.render=function render(){var e=this,t=this.props,a=t.redTeamInfo,r=void 0===a?{}:a,n=t.blueTeamInfo,l=void 0===n?{}:n,o=t.flagConfig;return i.a.createElement("div",{className:"kplRewardTeam",__source:{fileName:m,lineNumber:74},__self:this},i.a.createElement("div",{className:"kplRewardTeam-supportBtn kplRewardTeam-supportBtn--red",onClick:this.handleTeamClick(r.id),__source:{fileName:m,lineNumber:75},__self:this},"\u524d\u5f80\u652f\u6301"),i.a.createElement("div",{className:"kplRewardTeam-team",__source:{fileName:m,lineNumber:79},__self:this},i.a.createElement("div",{className:"kplRewardTeam-team-red",onClick:this.handleTeamClick(r.id),__source:{fileName:m,lineNumber:80},__self:this},r.logo?i.a.createElement("img",{className:"kplRewardTeam-team-img",src:r.logo,__source:{fileName:m,lineNumber:86},__self:this}):null),i.a.createElement("div",{className:"kplRewardTeam-info",__source:{fileName:m,lineNumber:90},__self:this},i.a.createElement("div",{className:"kplRewardTeam-name",__source:{fileName:m,lineNumber:91},__self:this},i.a.createElement("span",{className:"kplRewardTeam-name-red text-ellipsis",title:r.name,__source:{fileName:m,lineNumber:92},__self:this},r.name),i.a.createElement("span",{className:"kplRewardTeam-name-blue text-ellipsis",title:l.name,__source:{fileName:m,lineNumber:96},__self:this},l.name)),i.a.createElement("div",{className:"kplRewardTeam-progress",__source:{fileName:m,lineNumber:101},__self:this},i.a.createElement("div",{className:"kplRewardTeam-progress-red",style:{width:this.genProgressWidth(r.score,l.score,"red")},__source:{fileName:m,lineNumber:102},__self:this}),i.a.createElement("i",{className:"kplRewardTeam-progress-shine",__source:{fileName:m,lineNumber:108},__self:this}),i.a.createElement("div",{className:"kplRewardTeam-progress-blue",style:{width:this.genProgressWidth(r.score,l.score,"blue")},__source:{fileName:m,lineNumber:109},__self:this}),i.a.createElement("div",{className:"kplRewardTeam-progress-score kplRewardTeam-progress-score--red",__source:{fileName:m,lineNumber:115},__self:this},this.formatScore(r.score)),i.a.createElement("div",{className:"kplRewardTeam-progress-score kplRewardTeam-progress-score--blue",__source:{fileName:m,lineNumber:118},__self:this},this.formatScore(l.score))),i.a.createElement("div",{className:"kplRewardTeam-flag",__source:{fileName:m,lineNumber:122},__self:this},i.a.createElement("ul",{className:"kplRewardTeam-flag-red",__source:{fileName:m,lineNumber:123},__self:this},Array.isArray(o)?o.slice(0,3).map(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.a.createElement("li",{key:t.score,className:"kplRewardTeam-flag-item text-ellipsis "+e.checkFlagActive(t,r.score),__source:{fileName:m,lineNumber:126},__self:e},e.formatScore(t.score))}):null),i.a.createElement("ul",{className:"kplRewardTeam-flag-blue",__source:{fileName:m,lineNumber:133},__self:this},Array.isArray(o)?o.slice(0,3).reverse().map(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.a.createElement("li",{key:t.score,className:"kplRewardTeam-flag-item text-ellipsis "+e.checkFlagActive(t,l.score),__source:{fileName:m,lineNumber:136},__self:e},e.formatScore(t.score))}):null))),i.a.createElement("div",{className:"kplRewardTeam-team-blue",onClick:this.handleTeamClick(l.id),__source:{fileName:m,lineNumber:145},__self:this},l.logo?i.a.createElement("img",{className:"kplRewardTeam-team-img",src:l.logo,__source:{fileName:m,lineNumber:151},__self:this}):null)),i.a.createElement("div",{className:"kplRewardTeam-supportBtn kplRewardTeam-supportBtn--blue",onClick:this.handleTeamClick(l.id),__source:{fileName:m,lineNumber:156},__self:this},"\u524d\u5f80\u652f\u6301"))},Team}(i.a.Component))||r;f.propTypes={redTeamInfo:o.a.object,blueTeamInfo:o.a.object,flagConfig:o.a.array,handleSelectTeamId:o.a.func},t.default=f},dc54d9:function(e,t,a){},e5dd00:function(e,t,a){"use strict";var r,n,i,l,o=a("1a22b7"),s=a.n(o),c=a("292183"),u=a.n(c),m=a("ed7240"),f=a("7ca7dc"),p=a("54992a"),d=a("f2b8b7"),_=a("3b65fe"),b=(a("5fb15e"),"/shark/live/src/pages/roomPage/playerDialogModule/components/KplReward/Rank/Rank.js");function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function _inherits(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function _defaults(e,t){for(var a=Object.getOwnPropertyNames(t),r=0;r<a.length;r++){var n=a[r],i=Object.getOwnPropertyDescriptor(t,n);i&&i.configurable&&void 0===e[n]&&Object.defineProperty(e,n,i)}return e}(e,t))}var h=[{key:"now",nav:"\u52a9\u5a01\u699c",checkMatch:!0,rank:[{key:"match",name:"\u672c\u573a\u52a9\u5a01\u699c"},{key:"red",name:"\u4e1c\u90e8\u52a9\u5a01\u699c"},{key:"blue",name:"\u897f\u90e8\u52a9\u5a01\u699c"}]},{key:"week",nav:"\u5468\u699c",checkMatch:!1,rank:[{key:"fans",name:"\u7c89\u4e1d\u8d21\u732e\u5468\u699c"},{key:"team",name:"\u6218\u961f\u4eba\u6c14\u5468\u699c"}]},{key:"total",nav:"\u603b\u699c",checkMatch:!1,rank:[{key:"fans",name:"\u7c89\u4e1d\u8d21\u732e\u603b\u699c"},{key:"team",name:"\u6218\u961f\u4eba\u6c14\u603b\u699c"}]}],N={0:1,1:0,2:2},k={now:1,week:2,total:3},w=(r=(0,f.default.Service)(_.default),Object(p.log)((i=function(e){function Rank(){var t,a;!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Rank);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t=a=_possibleConstructorReturn(this,e.call.apply(e,[this].concat(n))),function _initDefineProp(e,t,a,r){a&&Object.defineProperty(e,t,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(r):void 0})}(a,"kplRewardService",l,a),a.state={currentNav:"week",currentTab:"fans",visible:!1},a.handleNavClick=function(e){return function(){a.setState(function(t){return t.currentNav===e?{}:{currentNav:e,currentTab:"now"===e?"match":"fans"}},function(){a.getRankList()})}},a.handleTabClick=function(e){return function(){a.setState(function(t){return t.currentTab===e?{}:{currentTab:e}},function(){a.getRankList()})}},a.toggleVisible=function(e){return function(){e&&a.getRankList(),a.setState({visible:e})}},_possibleConstructorReturn(a,t)}return _inherits(Rank,e),Rank.prototype.componentDidMount=function componentDidMount(){this.setState({currentNav:this.props.matchId?"now":"week",currentTab:this.props.matchId?"match":"fans"})},Rank.prototype.componentWillReceiveProps=function componentWillReceiveProps(e){!this.props.matchId&&e.matchId&&this.setState({currentNav:"now",currentTab:"match"}),this.props.matchId&&!e.matchId&&this.setState({currentNav:"week",currentTab:"fans"})},Rank.prototype.getRankList=function getRankList(){var e=this.state,t=e.currentNav,a=e.currentTab,r=this.props,n=r.redTeamInfo,i=void 0===n?{}:n,l=r.blueTeamInfo,o=void 0===l?{}:l,s=r.matchId;if("now"===t||"fans"===a){var c={rank_type:2,time_type:k[t]};return"blue"!==a&&"red"!==a||(c.rank_type=1,c.team_id="red"===a?i.id:o.id),"now"===t&&(c.schedule_id=s),void this.kplRewardService.getRankList(c,"user")}this.kplRewardService.getRankList({type:k[t]},"team")},Rank.prototype.formatScore=function formatScore(e){return e?e>=1e4?Math.floor(e/1e4*10)/10+"\u4e07":e:""},Rank.prototype.genTabName=function genTabName(e,t){var a=this.props,r=a.redTeamInfo,n=void 0===r?{}:r,i=a.blueTeamInfo,l=void 0===i?{}:i;return"now"===t&&"red"===e.key?n.name:"now"===t&&"blue"===e.key?l.name:e.name},Rank.prototype.render=function render(){var e=this,t=this.state,a=t.currentNav,r=t.currentTab,n=t.visible,i=this.props,l=i.rankList,o=void 0===l?[]:l,c=i.matchId,u=h.find(function(e){return e.key===a}).rank,f="now"===a||"fans"===r,p=f?"\u8d21\u732e\u503c":"\u4eba\u6c14\u503c",_=f?o.slice(0,10):o,k=!!c;return s.a.createElement(m.default,{visible:n,footer:null,mask:!1,closable:!1,center:!0,width:380,className:"kplRewardRank",__source:{fileName:b,lineNumber:224},__self:this},s.a.createElement("i",{className:"kplRewardRank-close",onClick:this.toggleVisible(!1),__source:{fileName:b,lineNumber:233},__self:this}),s.a.createElement("p",{className:"kplRewardRank-title",__source:{fileName:b,lineNumber:234},__self:this},"\u6392\u884c\u699c"),s.a.createElement("ul",{className:"kplRewardRank-navList",__source:{fileName:b,lineNumber:235},__self:this},h.map(function(t){return t.checkMatch&&!k?null:s.a.createElement("li",{className:"kplRewardRank-navItem "+(a===t.key?"is-active":"")+" "+(k?"":"is-two"),key:t.key,onClick:e.handleNavClick(t.key),__source:{fileName:b,lineNumber:244},__self:e},t.nav)})),s.a.createElement("ul",{className:"kplRewardRank-tabList",__source:{fileName:b,lineNumber:253},__self:this},u.map(function(t){return s.a.createElement("li",{className:"kplRewardRank-tabItem "+(r===t.key?"is-active":"")+" "+("now"===a?"is-now":"")+" text-ellipsis",key:a+"-"+t.key,onClick:e.handleTabClick(t.key),title:e.genTabName(t,a),__source:{fileName:b,lineNumber:256},__self:e},e.genTabName(t,a))})),s.a.createElement("div",{className:"kplRewardRank-rankWrap",__source:{fileName:b,lineNumber:265},__self:this},s.a.createElement("ul",{className:"kplRewardRank-topList",__source:{fileName:b,lineNumber:266},__self:this},new Array(3).fill({}).map(function(t,a){var r=_[N[a]]||{},n=f?r.nick_name:r.team_name,i=f?r.contribution:r.popularity,l=f?r.avatar:r.team_logo;return s.a.createElement("li",{className:"kplRewardRank-top",key:"top"+(N[a]+1),__source:{fileName:b,lineNumber:275},__self:e},s.a.createElement("div",{className:"kplRewardRank-top-imgWrap is-top"+(N[a]+1),__source:{fileName:b,lineNumber:276},__self:e},l?s.a.createElement("img",{className:"kplRewardRank-top-img",src:l,__source:{fileName:b,lineNumber:279},__self:e}):null),s.a.createElement("div",{className:"kplRewardRank-top-name text-ellipsis",title:n,__source:{fileName:b,lineNumber:283},__self:e},n||"\u865a\u4f4d\u4ee5\u5f85"),s.a.createElement("div",{className:"kplRewardRank-top-score text-ellipsis",title:p+"\uff1a"+e.formatScore(i),__source:{fileName:b,lineNumber:284},__self:e},p,"\uff1a",s.a.createElement("span",{className:"score-highlight",__source:{fileName:b,lineNumber:285},__self:e},e.formatScore(i)||0)))})),s.a.createElement(d.Scrollbars,{style:{height:280},autoHide:!0,className:"kplRewardRank-rankList",__source:{fileName:b,lineNumber:292},__self:this},s.a.createElement("ul",{__source:{fileName:b,lineNumber:299},__self:this},_.slice(3).map(function(t,a){var r=f?t.nick_name:t.team_name,n=f?t.contribution:t.popularity,i=f?t.avatar:t.team_logo;return s.a.createElement("li",{className:"kplRewardRank-rank",key:r+"-"+a,__source:{fileName:b,lineNumber:307},__self:e},s.a.createElement("div",{className:"kplRewardRank-rank-idx",__source:{fileName:b,lineNumber:308},__self:e},a+4),s.a.createElement("div",{className:"kplRewardRank-rank-imgWrap",__source:{fileName:b,lineNumber:309},__self:e},i?s.a.createElement("img",{className:"kplRewardRank-rank-img",src:i,__source:{fileName:b,lineNumber:312},__self:e}):null),s.a.createElement("div",{className:"kplRewardRank-rank-name text-ellipsis",title:r,__source:{fileName:b,lineNumber:316},__self:e},r),s.a.createElement("div",{className:"kplRewardRank-rank-score text-ellipsis",title:p+"\uff1a"+e.formatScore(n),__source:{fileName:b,lineNumber:317},__self:e},p,"\uff1a",s.a.createElement("span",{className:"score-highlight",__source:{fileName:b,lineNumber:318},__self:e},e.formatScore(n))))})))))},Rank}(s.a.Component),l=function _applyDecoratedDescriptor(e,t,a,r,n){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=a.slice().reverse().reduce(function(a,r){return r(e,t,a)||a},i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}(i.prototype,"kplRewardService",[r],{enumerable:!0,initializer:null}),n=i))||n);w.propTypes={redTeamInfo:u.a.object,blueTeamInfo:u.a.object,matchId:u.a.string,rankList:u.a.array},t.default=w},e81f68:function(e,t,a){},fc628f:function(e,t,a){},ff026f:function(e,t,a){"use strict";a.r(t);var r=a("8b644f");t.default=r.default}}]);
//# sourceMappingURL=http://sourcemap.douyucdn.cn:4567/room/online/sourcemaps/KplReward_dc5210a_e07b49d.js.map