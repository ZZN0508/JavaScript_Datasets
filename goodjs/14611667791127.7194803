!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.echo_js=t():e.echo_js=t()}(window,function(){return i=[function(e,t,i){void 0===(t=function(e){"use strict";var t=!1,i={INFO:0,WARN:1,ERROR:2},n=i.ERROR;function r(e,t){"object"==typeof console&&"function"==typeof console[e]&&console[e](t)}return{enable:function(){t=!0},disable:function(){t=!1},getState:function(){return t},getLevel:function(){return n},setLevel:function(e){n=i.ERROR<e?i.ERROR:e<i.INFO?i.INFO:e},info:function(e){t&&n===i.INFO&&r("log","ECHO_DEBUG [info]: "+e)},warn:function(e){t&&n<=i.WARN&&r("log","ECHO_DEBUG [warning]: "+e)},error:function(e){if(t&&n<=i.ERROR)throw new Error("ECHO_DEBUG: "+e)},DebugLevels:i}}.call(t,i,t,e))||(e.exports=t)},function(e,t,i){void 0===(t=function(e){"use strict";var n=i(0);function a(t){var i,n={};for(i in t)try{t[i].constructor===Object?n[i]=a(t[i]):n[i]=t[i]}catch(e){n[i]=t[i]}return n}function s(e,t,i){var n,r=i?e:a(e);for(n in t)try{t[n].constructor===Object?r[n]=s(r[n],t[n]):r[n]=t[n]}catch(e){r[n]=t[n]}return r}function r(e,t){for(var i in e)if(e.hasOwnProperty(i)&&e[i]===t)return!0;return!1}function o(e,t){for(var i=(t?a(e):e)||{},n=arguments,r=2,o=n.length;r<o;r++)"object"==typeof n[r]?s(i,n[r],!0):i[n[r]]=n[++r];return i}function c(e,t,i){return e||(i?n.warn("AssertionFailed: "+t):n.error("AssertionFailed: "+t)),e}return{clone:a,combineObjects:s,addKV:function(e,t,i){return i?o(e,!0,t,i):o(e,!0,t)},containsValue:r,startsWith:function(e,t){return 0===e.indexOf(t)},extend:o,assert:c,assertContainsValue:function(e,t,i){return c(r(e,t),i)},trim:function(e){if("string"==typeof e)return String.prototype.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}}}.call(t,i,t,e))||(e.exports=t)},function(e,t,_){void 0===(t=function(e){"use strict";var t=_(10),i=_(5),n=_(14),r=_(11),o=_(3),a=_(6),s={};Object.keys(t).map(function(e){s[e]=e});var c={};Object.keys(i).map(function(e){c[e]=e});var u={};Object.keys(n).map(function(e){u[e]=e});var l={};Object.keys(r).map(function(e){l[e]=e});n="18897612";function d(e,t,i,n){var r={};return r[o.COMSCORE_CUSTOMER_ID]=e,r[o.COMSCORE_SITE]=t,r[o.COMSCORE_HOST]=i,r[o.SSC_HOSTNAME]=n,r}function h(e){return d("16060501",e,"sa.bbc.co.uk",".co.uk")}function p(e,t){return d(e,t,"scorecardresearch.com",".com")}r={};return r.PUBLIC_SERVICE=h("bbc"),r.PUBLIC_SERVICE_STAGE=h("stage"),r.PUBLIC_SERVICE_TEST=h("test"),r.PUBLIC_SERVICE_INT=h("int"),r.PUBLIC_SERVICE_INTRANET=h("intranet"),r.GNL=p("19293874","bbc"),r.GNL_ACCEPTANCE=p(n,"gnl-test"),r.WORLD_SERVICE=p("19999701","bbc"),r.WORLD_SERVICE_ACCEPTANCE=p(n,"ws-test"),r.WORLDWIDE_FEATURES=p("19774467","bbc"),r.WORLDWIDE_FEATURES_ACCEPTANCE=p(n,"features-test"),r.STORE_NONCOMMERCIAL=p("19774474","bbc"),r.STORE_COMMERCIAL=p("19774472","bbc"),r.BRITBOX_ACCEPTANCE=p("18897612","bbc-global-test"),r.BRITBOX=p("23239715","bbc"),{ApplicationType:{WEB:"web",MOBILE_WEB:"mobile-web",RESPONSIVE:"responsive",MOBILE_APP:"mobile-app",BIGSCREEN_HTML:"bigscreen-html",BIGSCREEN_FLASH:"bigscreen-flash",BIGSCREEN_APP:"bigscreen-app",BIGSCREEN_CAST:"bigscreen-cast",DESKTOP_APP:"desktop-app",AMP:"amp"},WindowState:{FULL:"full",NORMAL:"norm",MINIMISED:"min",MAXIMISED:"max",PICTUREINPICTURE:"picture-in-picture"},MediaIdType:{VERSION:"version",CLIP:"clip",EPISODE:"episode",SERVICE:"service",VPID:"vpid",NONPIPSCONTENTID:"nonpipscontentid",PRODUCER:"producer",BRAND:"brand",SERIES:"series",WSPARTNERID:"ptnrID"},MediaClipType:{UNDEFINED:void 0,CLIP:"clip",EPISODE:"episode"},MediaInitiationType:{UNDEFINED:void 0,USER:"user",AUTO:"auto"},AvType:{AUDIO:"audio",VIDEO:"video"},RetrievalType:{STREAM:"stream",DOWNLOAD:"download"},Form:{LONG:"long",SHORT:"short"},PIPsType:{CLIP:"clip",EPISODE:"ep"},MediaConsumptionMode:{ON_DEMAND:"ondemand",LIVE:"live",DOWNLOAD:"download"},EchoCacheMode:{NEVER:"never",OFFLINE:"offline",ALL:"all"},ManagedLabels:{EVENT_MASTER_BRAND:"event_master_brand",BBC_SITE:"bbc_site",IPLAYER_STATE:"iplayer_state",STORE_ED_TYPE:"store_ed_type",IPLAYER_AVAIL:"iplayer_avail",STORE_REFERRAL:"store_referral",BBC_HASHED_ID:"bbc_hid"},ReportingProfiles:r,EssError:{STATUS_CODE:"status_code",TIMEOUT:"timeout",JSON:"json",RUNTIME:"runtime_error"},Destinations:s,Producers:c,NationsProducer:u,Masterbrands:l,EchoLabelKeys:a}}.call(t,_,t,e))||(e.exports=t)},function(e,t,i){void 0===(t=function(){"use strict";return{ECHO_ENABLED:"enabled",ECHO_AUTO_START:"auto_start",ECHO_TRACE:"trace",ECHO_DEVICE_ID:"device_id",REPORTING_PROFILE:"reporting_profile",ECHO_CACHE_MODE:"cache_mode",DEBUG_MODE:"disabled",ECHO_NAME:"lib_name",ECHO_VERSION:"lib_version",USE_SSC:"use_ssc",SSC_HOSTNAME:"ssc_hostname",COMSCORE_ENABLED:"comscore.enabled",COMSCORE_HOST:"comscore.host",COMSCORE_SITE:"comscore.site",COMSCORE_CUSTOMER_ID:"comscore.customer_id",COMSCORE_PUBLISHER_SECRET:"comscore.publisher_secret",ATI_ENABLED:"ati.enabled",ATI_LOG:"ati.log",ATI_SSL_LOG:"ati.ssl_log",ATI_DOMAIN:"ati.domain",ATI_PIXEL_PATH:"ati.pixel_path",ATI_FORCE_HTTP:"ati.force_http",ATI_FORCE_HTTPS:"ati.force_https",ATI_CACHE_MODE_ALWAYS:"always",ATI_CACHE_MODE_REQUIRED:"required",ATI_CACHE_MODE_NEVER:"never",APP_CATEGORY:"app_category",ATI_DISABLE_COOKIE:"ati.disable_cookie",ATI_USE_DEFAULT_COOKIE_DOMAIN:"ati.use_default_cookie_domain",KEEPALIVE_DURATION:"keepalive_duration",ATI_COLLECT_DOMAIN:"ati.collect_domain",ATI_COLLECT_DOMAIN_SSL:"ati.collect_domain_ssl",DESTINATION:"bbc_destination",PRODUCER:"bbc_producer",TEST_SERVICE_ENABLED:"test.enabled",TEST_SERVICE_URL:"test.url",BARB_ENABLED:"barb.enabled",BARB_SITE_CODE:"barb.site_code",BARB_DEBUG:"barb.debug",USE_ESS:"use_ess",ESS_HOSTNAME:"ess.hostname",REMOTE_CONFIG_MANAGER:"remote_config_manager",REMOTE_CONFIG_URL:"remote_config_url",PRODUCER_CONFIG_FILENAME:"producer_config_filename",MASTERBRAND_CONFIG_FILENAME:"masterbrand_config_filename"}}.call(t,i,t,e))||(e.exports=t)},function(e,t,p){void 0===(t=function(e){"use strict";var o=p(1),a=p(0),t=p(2),s=p(27),i=["player_name","ns_st_ws","bbc_site","app_type","app_name","bbc_store_pf","bbc_store_ed","bbc_store_fr","bbc_store_src"],n=["token","guardianToken","nonce","dateOfBirthDay","dateOfBirthMonth","dateOfBirthYear","dateOfBirth","permissionToken"],c={name:s.COUNTERNAME};c[t.ManagedLabels.EVENT_MASTER_BRAND]=s.EVENT_MASTER_BRAND;for(var r=0;r<i.length;r++)c[i[r]]=s.STRICT;function u(e){return e&&e.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/(^_+)|(_+$)/g,"")}function l(e){var t=u(e);return o.assert(e===t,'Label key can only contain: [a-z0-9_], and no consecutive "_"s or "_" at the begining or end, got "'+e+'". This will be sent as "'+t+'"',!0),t}function d(e){var t=e&&e.toLowerCase().replace(/[^a-z0-9\.]+/g,"_").replace(/\.+/g,".").replace(/(^_+)|(_+$)/g,"")||"no.name.page";return e!==t&&(e&&-1!==e.search(/-/)?a.warn('Submitted countername ("'+e+'") contains at least one "-". Dashes are not permitted but, for legacy reasons, "-" and "_" are equivalent in DAx. Echo converts dashes to underscores, so the countername will be sent as "'+t+'"'):a.warn('countername may only contain: [a-z0-9._], got "'+e+'". This will be cleaned up and sent as "'+t+'"')),-1===t.search(/\.page$/)&&(t+=".page"),t}function h(e,t){var i="",n=t,r=c.hasOwnProperty(r=e)?c[r]:s.CUSTOM;if("number"==typeof(t=r===s.COUNTERNAME?d(t):t)||"boolean"==typeof t)return t.toString();if("string"==typeof t){switch(r){case s.EVENT_MASTER_BRAND:i='Label value can only contain [0-9a-z], and no consecutive "_"s and no "_"s or whitespace at the start or end.',n=u(t);break;case s.STRICT:i='Strict Label values can only contain [ 0-9a-z-], and no consecutive "-"s and no "-"s or whitespace at the start or end.',n=t&&t.toLowerCase().replace(/(^\s+)|(\s+$)/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-+)|(-+$)/g,"");break;case s.NO_CLEANSING:break;default:i="Custom Label value cannot contain whitespace at start or end or pipes (|).",n=t&&t.replace(/(^\s+)|(\s+$)/g,"").replace(/\|/g,"!")}return o.assert(t===n,i+='Got "'+t+'", will be replaced with "'+n+'"',!0),n}a.error("Label "+e+" must have number, boolean or string value")}return{cleanCounterName:d,cleanLabelKey:l,cleanLabelValue:h,cleanLanguage:function(e){if("number"==typeof e||"boolean"==typeof e)return e.toString();var t=e&&e.replace(/(^\s*)|(\s*$)/g,"").replace(/[^0-9a-zA-Z._]+/g,"-").replace(/(^-)|(-$)/g,"")||"";return o.assert(e===t,'Language label value can only contain [0-9a-zA-Z._-], and no consecutive "-"s and no - at the start or end. Got "'+e+'", will be replaced with "'+t+'"',!0),t},cleanLabels:function(e){var t,i,n={};for(i in e)n[t=l(i)]=h(t,e[i]);return n},cleanCustomVariable:function(e){return e&&e.toString().replace(/[\u200B-\u200D\uFEFF]+/g,"").trim().replace(/\[|\]/g,"").replace(/&/g,"$").replace(/\s{1,}/g," ")},cleanMediaId:function(e){return"string"!=typeof e?e:e&&e.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9/.~\-_]/g,"")},removeSensitiveInfo:function(e){if(e&&"string"==typeof e)for(r=0;r<n.length;r++){var t=new RegExp(n[r]+"=[^&]*","g");e=e.replace(t,n[r]+"=XXXX")}return e},removeUndefined:function(t){return Object.keys(t).forEach(function(e){void 0===t[e]&&(a.info("Removing key "+e+" as value is undefined"),delete t[e])}),t}}}.call(t,p,t,e))||(e.exports=t)},function(e,t,i){void 0===(t=function(){"use strict";return{ACADEMY:125,ACCOUNT:1,AFAAN_OROMOO:2,AFRIQUE:3,AMHARIC:4,ARABIC:5,AZERI:6,BBC:7,BBC_ALBA:8,BBC_ARCHIVE:127,BBC_ARTS:9,BBC_ASIAN_NETWORK:10,BBC_FOOD:11,BBC_FOUR:12,BBC_HD:13,BBC_MUSIC:14,BBC_NEWS_CHANNEL:15,BBC_ONE:16,BBC_PARLIAMENT_CHANNEL:17,BBC_RADIO:18,BBC_RADIO_1:19,BBC_RADIO_1XTRA:20,BBC_RADIO_2:21,BBC_RADIO_3:22,BBC_RADIO_4:23,BBC_RADIO_4_EXTRA:24,BBC_RADIO_5_LIVE:25,BBC_RADIO_6_MUSIC:26,BBC_SCOTLAND:120,BBC_SEND:121,BBC_STUDIOS:128,BBC_THREE:28,BBC_TWO:29,BBC_WORLD_NEWS:30,BENGALI:31,BITESIZE:32,BRASIL:33,BRITBOX:34,BRITBOX_AU:132,BURMESE:35,CBBC:36,CBEEBIES:37,CHINESE:38,ENGLISH_REGIONS:39,GAHUZA:40,GATEWAY:41,GNL_AUTOS:42,GNL_CAPITAL:43,GNL_CULTURE:44,GNL_EARTH:45,GNL_FUTURE:46,GNL_HOMEPAGE:47,GNL_STORYWORKS:48,GNL_TRAVEL:49,GUJARATI:50,HAUSA:51,HINDI:52,IGBO:53,INDONESIAN:54,IPLAYER:55,JAPANESE:56,KOREAN:57,KYRGYZ:58,MARATHI:59,MEDIA_ACTION:60,MONITORING:61,MUNDO:62,NEPALI:63,NEWS:64,NEWS_LABS:129,NEWSROUND:65,NORTHERN_IRELAND:66,OTHER:67,OWN_IT:118,PARTICIPATION:130,PASHTO:68,PERSIAN:69,PIDGIN:70,PROGRAMMES:71,PS_HOMEPAGE:72,PUNJABI:73,RD:126,RECEPTION:124,REEL:74,RUSSIAN:75,S4C:76,SCHOOL_RADIO:77,SCHOOL_REPORT:78,SCOTLAND:79,SEARCH:80,SERBIAN:81,SINHALA:82,SOMALI:83,SOUNDS:84,SPORT:85,SWAHILI:86,TAMIL:87,TASTER:88,TEACH:119,TELUGU:89,THAI:90,TIGRINYA:91,TURKISH:92,TV_CERTIFICATION:131,UK_CHINA:93,UKRAINIAN:94,URDU:95,UZBEK:96,VIETNAMESE:97,VOICE:98,VOICE_FIRST_FORMATS:99,VOLT:122,WALES:100,WEATHER:101,WEATHER_WATCHERS:102,WORLD_SERVICE_ENGLISH:103,WORKLIFE:104,WS_LEARNING_ENGLISH:105,WS_PARTNERS_B2B:106,YORUBA:107,NEWS_ENGLISH_REGIONS:108,SPORT_ENGLISH_REGIONS:109,NEWS_SCOTLAND:110,SPORT_SCOTLAND:111,NEWS_WALES:112,SPORT_WALES:113,NEWS_NORTHERN_IRELAND:114,SPORT_NORTHERN_IRELAND:115,AUDIENCE_SERVICES:116,WORLD_NEWS_PROGRAMMES:117,getId:function(e){var t;return t=e?this[e.toUpperCase()]:t}}}.call(t,i,t,e))||(e.exports=t)},function(e,t,i){e.exports={BBC_COUNTER_NAME:"name",ECHO_EVENT_NAME:"echo_event",APP_VERSION:"apvr",HASHED_ID:"at",LEVEL_1_SITE:"site",LEVEL_2_SITE:"level2",SECTION:"section",CHAPTER_1:"chapter1",CONTENT_ID:"bbc_content_id",APP_TYPE:"bbc_app_type",APP_NAME:"bbc_app_name",APP_CATEGORY:"app_category",LANGUAGE:"language",URL:"bbc_url",REFERRER_URL:"bbc_referrer_url",CONTENT_TYPE:"bbc_content_type",NATIONS_PRODUCER:"nations_producer",LIBRARY_VERSION:"bbc_library_version",PAGE_TITLE:"page_title",CUSTOM_VAR_1:"custom_var_1",CUSTOM_VAR_2:"custom_var_2",CUSTOM_VAR_3:"custom_var_3",CUSTOM_VAR_4:"custom_var_4",CUSTOM_VAR_5:"custom_var_5",CUSTOM_VAR_6:"custom_var_6",CUSTOM_VAR_7:"custom_var_7",CUSTOM_VAR_8:"custom_var_8",CUSTOM_VAR_9:"custom_var_9",CUSTOM_VAR_10:"custom_var_10",MEDIA_PLAYER:"bbc_media_player",LOGGED_IN:"bbc_identity",BBC_HID:"bbc_hid",MEDIA_BRAND:"brand",MEDIA_SERIES:"series",MEDIA_WS_PARTNER_ID:"ptnrID",CASTING_DEVICE_REFERRER:"devR",IS_BACKGROUND:"is_background",SOURCE:"source",CONTAINER:"container",METADATA:"metadata",PERSONALISATION:"personalisation",RESULT:"result",TEST_COOKIE_DOMAIN:"testCookieDomain",CHANNEL:"src_channel",MEDIUM:"src_medium",CAMPAIGN:"src_campaign",CAMPAIGN_GROUP:"src_campaign_group",VENDOR:"src_vendor",CREATION:"src_creation",FORMAT:"src_format",AFFILIATE_TYPE:"src_aff_type"}},function(e,t,i){e.exports={BBC_APPLICATION_NAME:"app_name",BBC_APPLICATION_TYPE:"app_type",BBC_APPLICATION_VERSION:"app_version",BBC_COUNTER_NAME:"name",DESTINATION:"bbc_destination",PRODUCER:"bbc_producer",BBC_LANGUAGE:"language",DEVICE_ID:"ns_alias",COMSCORE_C1:"c1",COMSCORE_C7:"c7",BBC_MEASUREMENT_LIB_NAME:"ml_name",BBC_MEASUREMENT_LIB_VERSION:"ml_version",ECHO_TRACE:"trace",ECHO_EVENT_NAME:"echo_event",EVENT_TRIGGERED_BY_USER:"ns_st_ui",STREAMSENSE_CUSTOM_EVENT_TYPE:"ns_st_ev",USER_ACTION_TYPE:"action_type",USER_ACTION_NAME:"action_name",PLAYLIST_END:"ns_st_pe",REWIND_FF_RATE:"ffrw_rate",COMSCORE_SITE:"ns_site",COMSCORE_CUSTOMER:"c2",COMSCORE_ENDPOINT:"comscore_endpoint",PLAYER_NAME:"ns_st_mp",PLAYER_VERSION:"ns_st_mv",PLAYER_WINDOW_STATE:"ns_st_ws",PLAYER_VOLUME:"ns_st_vo",PLAYER_POPPED:"bbc_st_pop",PLAYER_SUBTITLED:"bbc_st_sub",PLAYLIST_NAME:"ns_st_pl",PLAYLIST_CLIP_COUNT:"ns_st_cp",PLAYLIST_LENGTH:"ns_st_ca",MEDIA_PID:"ns_st_ci",MEDIA_LENGTH:"ns_st_cl",MEDIA_STREAM_TYPE:"ns_st_ty",MEDIA_IS_LIVE:"ns_st_li",MEDIA_EPISODE_ID:"episode_id",MEDIA_CLIP_ID:"clip_id",MEDIA_CLIP_NUMBER:"ns_st_cn",MEDIA_PART_NUMBER:"ns_st_pn",MEDIA_TOTAL_PARTS:"ns_st_tp",MEDIA_MEDIUM:"bbc_st_med",MEDIA_LIVE_OR_ONDEMAND:"bbc_st_lod",MEDIA_FORM:"bbc_st_mf",MEDIA_RETRIEVAL_TYPE:"bbc_st_ret",MEDIA_SCHEDULE_INDICATOR:"bbc_st_sch",MEDIA_VERSION_ID:"version_id",MEDIA_SERVICE_ID:"service_id",MEDIA_NON_PIPS_CONTENT_ID:"non_pips_content_id",MEDIA_AMBIGUOUS_ID:"ambig_ci",MEDIA_TIMESTAMP:"bbc_st_live_ts",ESS_SUCCESS:"ess_success",ESS_ERROR:"ess_error",ESS_STATUS_CODE:"ess_status_code",APP_PLATFORM_NAME:"ns_ap_pn",APP_PLATFORM_RUNTIME:"ns_ap_pfm",APP_OS_VERSION:"ns_ap_pfv",APP_DEVICE_NAME:"ns_ap_device",APP_SCREEN_RESOLUTION:"ns_ap_res",APP_LANGUAGE:"ns_ap_lang",ENV_CHAR_SET:"ns_c",ENV_TITLE:"c8",ENV_URL:"c7",ENV_REFERRER:"c9",APP_NAME:"ns_ap_an",APP_VERSION:"ns_ap_ver",NO_COOKIES:"ns_nc",COOKIE_POLICY:"bbc_mc",BBC_ID_LOGGED_IN:"bbc_identity",WEB_SCREEN_RES:"screen_resolution",ESS_ENABLED:"ess_enabled",ESS_ENRICHED:"ess_enriched"}},function(e,t,l){void 0===(t=function(e){"use strict";var t,n,r,i=l(4),o=l(9),a=l(28),s=!1,c=[];function u(){var e=window.screen||{},t=window.navigator||{},i=window.document||{};this._platformRuntimeEnvironment="html",this._platformOSVersion="5",this._screenResolution=(e.width||"-")+"x"+(e.height||"-"),this._language=t.language||"",this._platformName=t.platform||"",this._charset=i.characterSet||i.defaultCharset||"",this._title=i.title||"",this._url=i.URL||"",this._referrer=i.referrer||"",this._deviceName=null,this._httpGet=null,this._executeCrossDomainGet=null,this._getCookie=null,this._setCookie=null,this._setLocalStorageItem=null,this._getLocalStorageItem=null}return u._defaultHttpGet=a.httpGet,u._defaultGetCookie=o.getCookieValueByName,u.prototype.getPlatformName=function(){return this._platformName},u.prototype.getPlatformRuntimeEnvironment=function(){return this._platformRuntimeEnvironment},u.prototype.getPlatformOSVersion=function(){return this._platformOSVersion},u.prototype.getDeviceName=function(){return this._deviceName},u.prototype.getScreenResolution=function(){return this._screenResolution},u.prototype.getLanguage=function(){return this._language},u.prototype.getHttpGet=function(){return this._httpGet},u.prototype.setExecuteCrossDomainGet=function(e){this._executeCrossDomainGet=e},u.prototype.getExecuteCrossDomainGet=function(){return this._executeCrossDomainGet||a.executeCrossDomainGet},u.prototype.getCookieGetter=function(){return this._getCookie},u.prototype.getCookieSetter=function(){return this._setCookie},u.prototype.getCharSet=function(){return this._charset},u.prototype.getTitle=function(){return this._title},u.prototype.getURL=function(){return this._url},u.prototype.getProtocol=function(){return 0!==this.getURL().toLowerCase().indexOf("http:",0)?"https:":"http:"},u.prototype.getReferrer=function(){return this._referrer},u.prototype.setSetLocalStorageItem=function(e){this._setLocalStorageItem=e},u.prototype.getSetLocalStorageItem=function(){return this._setLocalStorageItem},u.prototype.setGetLocalStorageItem=function(e){this._getLocalStorageItem=e},u.prototype.getGetLocalStorageItem=function(){return this._getLocalStorageItem},u.prototype.setPlatformName=function(e){return this._platformName=e,this},u.prototype.setPlatform=function(e,t){return this._platformRuntimeEnvironment=e,this._platformOSVersion=t,this},u.prototype.setDeviceName=function(e){return this._deviceName=e,this},u.prototype.setScreenResolution=function(e){return this._screenResolution=e,this},u.prototype.setLanguage=function(e){return this._language=i.cleanLanguage(e),this},u.prototype.setHttpGet=function(e){return this._httpGet=e,this},u.prototype.setCookieGetter=function(e){return this._getCookie=e,this},u.prototype.setCookieSetter=function(e){return this._setCookie=e,this},u.prototype.setCharSet=function(e){return this._charset=e,this},u.prototype.setTitle=function(e){return this._title=e,this},u.prototype.setURL=function(e){return this._url=e,this},u.prototype.setReferrer=function(e){return this._referrer=e,this},u.setOrbCookies=function(e){return t=e,this},u.getOrbCookies=function(){return t},u.getOrbCookiesPolicy=function(){if(t&&"function"==typeof t.readPolicy)return t.readPolicy()},u.setOrbIdCta=function(e){return n=e,this},u.getOrbIdCta=function(e){function t(e,t){e&&"function"==typeof e&&e(t)}var i;void 0===n?!1!==r?(c.push(e),i=window.require,void 0===r&&i?!(r="function"==typeof i.defined&&i.defined("idcta/idcta-1"))&&i.s&&i.s.contexts&&i.s.contexts._&&i.s.contexts._.config&&i.s.contexts._.config.paths&&i.s.contexts._.config.paths.idcta&&(r=!0):r=!1,r&&!s?(s=!0,window.require(["idcta/idcta-1"],function(e){for(n=e;0<c.length;c++)c[0]&&"function"==typeof c[0]&&t(c[0],n)})):!1===r&&t(e)):t(e):t(e,n)},u}.call(t,l,t,e))||(e.exports=t)},function(e,t,i){void 0===(t=function(){"use strict";return{getCookieValueByName:function(e,t){var i,n=e+"=",t=(t||window).document;if(void 0===t||"string"!=typeof t.cookie)return null;for(var r=0,o=(i=t.cookie.split(";")).length;r<o;r++){var a=i[r];if(0===(a=" "===a.charAt(0)?a.substring(1,a.length):a).indexOf(n))return a.substring(n.length,a.length)}return null}}}.call(t,i,t,e))||(e.exports=t)},function(e,t,i){void 0===(t=function(){"use strict";var e=i(5);return{DEFAULT:{id:"596068",defaultProducer:e.BBC,isTest:!0},ACCOUNT:{id:"598250",defaultProducer:e.ACCOUNT,isTest:!1},ACCOUNT_TEST:{id:"598252",defaultProducer:e.ACCOUNT,isTest:!0},AUDIENCE_PORTAL:{id:"602136",defaultProducer:e.AUDIENCE_SERVICES,isTest:!1},AUDIENCE_PORTAL_TEST:{id:"602137",defaultProducer:e.AUDIENCE_SERVICES,isTest:!0},AUDIENCE_SERVICES_PS:{id:"602167",defaultProducer:e.AUDIENCE_SERVICES,isTest:!1},AUDIENCE_SERVICES_PS_TEST:{id:"602168",defaultProducer:e.AUDIENCE_SERVICES,isTest:!0},BBC_ARCHIVE_PS:{id:"605565",defaultProducer:e.BBC_ARCHIVE,isTest:!1},BBC_ARCHIVE_PS_TEST:{id:"605566",defaultProducer:e.BBC_ARCHIVE,isTest:!0},BBC_CORPORATE_PS:{id:"603550",defaultProducer:e.BBC,isTest:!1},BBC_CORPORATE_PS_TEST:{id:"603551",defaultProducer:e.BBC,isTest:!0},BBC_SYNDICATION:{id:"601718",defaultProducer:e.BBC,isTest:!1},BBC_SYNDICATION_TEST:{id:"601719",defaultProducer:e.BBC,isTest:!0},BBC_STUDIOS_PLAYER:{id:"606296",defaultProducer:e.BBC_STUDIOS,isTest:!1},BBC_STUDIOS_PLAYER_TEST:{id:"606293",defaultProducer:e.BBC_STUDIOS,isTest:!0},BBC_THREE:{id:"598255",defaultProducer:e.BBC_THREE,isTest:!1},BBC_THREE_TEST:{id:"598256",defaultProducer:e.BBC_THREE,isTest:!0},BITESIZE:{id:"598257",defaultProducer:e.BITESIZE,isTest:!1},BITESIZE_TEST:{id:"598258",defaultProducer:e.BITESIZE,isTest:!0},BLOGS_PS:{id:"603546",defaultProducer:e.BBC,isTest:!1},BLOGS_PS_TEST:{id:"603547",defaultProducer:e.BBC,isTest:!0},BRITBOX:{id:"598259",defaultProducer:e.BRITBOX,isTest:!1},BRITBOX_TEST:{id:"598260",defaultProducer:e.BRITBOX,isTest:!0},CBBC:{id:"598261",defaultProducer:e.CBBC,isTest:!1},CBBC_TEST:{id:"598262",defaultProducer:e.CBBC,isTest:!0},CBEEBIES:{id:"598263",defaultProducer:e.CBEEBIES,isTest:!1},CBEEBIES_TEST:{id:"598264",defaultProducer:e.CBEEBIES,isTest:!0},FEATURE_SITES_GNL:{id:"598265",defaultProducer:e.GNL_HOMEPAGE,isTest:!1},FEATURE_SITES_GNL_TEST:{id:"598266",defaultProducer:e.GNL_HOMEPAGE,isTest:!0},FOOD:{id:"598267",defaultProducer:e.BBC_FOOD,isTest:!1},FOOD_TEST:{id:"598268",defaultProducer:e.BBC_FOOD,isTest:!0},GAMES_PS:{id:"599452",defaultProducer:e.BBC,isTest:!1},GAMES_PS_TEST:{id:"599454",defaultProducer:e.BBC,isTest:!0},GATEWAY:{id:"598269",defaultProducer:e.GATEWAY,isTest:!1},GATEWAY_TEST:{id:"598270",defaultProducer:e.GATEWAY,isTest:!0},HOMEPAGE_GNL:{id:"598271",defaultProducer:e.GNL_HOMEPAGE,isTest:!1},HOMEPAGE_GNL_TEST:{id:"598272",defaultProducer:e.GNL_HOMEPAGE,isTest:!0},HOMEPAGE_PS:{id:"598273",defaultProducer:e.PS_HOMEPAGE,isTest:!1},HOMEPAGE_PS_TEST:{id:"598274",defaultProducer:e.PS_HOMEPAGE,isTest:!0},IDEAS:{id:"598275",defaultProducer:e.BBC,isTest:!1},IDEAS_TEST:{id:"598276",defaultProducer:e.BBC,isTest:!0},IPLAYER:{id:"598277",defaultProducer:e.IPLAYER,isTest:!1},IPLAYER_TEST:{id:"598278",defaultProducer:e.IPLAYER,isTest:!0},MEDIA_ACTION:{id:"598279",defaultProducer:e.MEDIA_ACTION,isTest:!1},MEDIA_ACTION_TEST:{id:"598280",defaultProducer:e.MEDIA_ACTION,isTest:!0},MONITORING:{id:"598281",defaultProducer:e.MONITORING,isTest:!1},MONITORING_TEST:{id:"598282",defaultProducer:e.MONITORING,isTest:!0},MUSIC:{id:"598283",defaultProducer:e.BBC_MUSIC,isTest:!1},MUSIC_TEST:{id:"598284",defaultProducer:e.BBC_MUSIC,isTest:!0},NATIONAL_MOMENTS_PS:{id:"605567",defaultProducer:e.BBC,isTest:!1},NATIONAL_MOMENTS_PS_TEST:{id:"605568",defaultProducer:e.BBC,isTest:!0},NEWS_PS:{id:"598285",defaultProducer:e.NEWS,isTest:!1},NEWS_PS_TEST:{id:"598286",defaultProducer:e.NEWS,isTest:!0},NEWS_GNL:{id:"598287",defaultProducer:e.NEWS,isTest:!1},NEWS_GNL_TEST:{id:"598288",defaultProducer:e.NEWS,isTest:!0},NEWS_LANGUAGES_GNL:{id:"598289",defaultProducer:e.NEWS,isTest:!1},NEWS_LANGUAGES_GNL_TEST:{id:"598290",defaultProducer:e.NEWS,isTest:!0},NEWS_LANGUAGES_PS:{id:"598291",defaultProducer:e.NEWS,isTest:!1},NEWS_LANGUAGES_PS_TEST:{id:"598292",defaultProducer:e.NEWS,isTest:!0},NEWSROUND:{id:"598293",defaultProducer:e.NEWSROUND,isTest:!1},NEWSROUND_TEST:{id:"598294",defaultProducer:e.NEWSROUND,isTest:!0},OTHER:{id:"598295",defaultProducer:e.OTHER,isTest:!1},OTHER_TEST:{id:"598297",defaultProducer:e.OTHER,isTest:!0},OWN_IT:{id:"598298",defaultProducer:e.CBBC,isTest:!1},OWN_IT_TEST:{id:"598299",defaultProducer:e.CBBC,isTest:!0},PROGRAMMES_PS:{id:"598300",defaultProducer:e.PROGRAMMES,isTest:!1},PROGRAMMES_PS_TEST:{id:"598301",defaultProducer:e.PROGRAMMES,isTest:!0},PS_AUDIENCE_ENGAGEMENT:{id:"609581",defaultProducer:e.PARTICIPATION,isTest:!1},PS_AUDIENCE_ENGAGEMENT_TEST:{id:"609582",defaultProducer:e.PARTICIPATION,isTest:!0},RED_BUTTON_PS:{id:"601192",defaultProducer:e.BBC,isTest:!1},RED_BUTTON_PS_TEST:{id:"601193",defaultProducer:e.BBC,isTest:!0},REWIND_PS:{id:"603552",defaultProducer:e.BBC,isTest:!1},REWIND_PS_TEST:{id:"603553",defaultProducer:e.BBC,isTest:!0},R_AND_D_PS:{id:"607103",defaultProducer:e.RD,isTest:!1},R_AND_D_PS_TEST:{id:"607104",defaultProducer:e.RD,isTest:!0},SEARCH_GNL:{id:"598302",defaultProducer:e.SEARCH,isTest:!1},SEARCH_GNL_TEST:{id:"598303",defaultProducer:e.SEARCH,isTest:!0},SEARCH_PS:{id:"598304",defaultProducer:e.SEARCH,isTest:!1},SEARCH_PS_TEST:{id:"598305",defaultProducer:e.SEARCH,isTest:!0},SILVER_PS:{id:"607105",defaultProducer:e.BBC,isTest:!1},SILVER_PS_TEST:{id:"607106",defaultProducer:e.BBC,isTest:!0},SOUNDS:{id:"598306",defaultProducer:e.SOUNDS,isTest:!1},SOUNDS_TEST:{id:"598307",defaultProducer:e.SOUNDS,isTest:!0},SPORT_GNL:{id:"598308",defaultProducer:e.SPORT,isTest:!1},SPORT_GNL_TEST:{id:"598309",defaultProducer:e.SPORT,isTest:!0},SPORT_PS:{id:"598310",defaultProducer:e.SPORT,isTest:!1},SPORT_PS_TEST:{id:"598311",defaultProducer:e.SPORT,isTest:!0},STORYWORKS_GNL:{id:"598312",defaultProducer:e.GNL_STORYWORKS,isTest:!1},STORYWORKS_GNL_TEST:{id:"598313",defaultProducer:e.GNL_STORYWORKS,isTest:!0},SUBTITLES_PS:{id:"603548",defaultProducer:e.PROGRAMMES,isTest:!1},SUBTITLES_PS_TEST:{id:"603549",defaultProducer:e.PROGRAMMES,isTest:!0},SYNDICATION_PARTNERS_GNL:{id:"598314",defaultProducer:e.WS_PARTNERS_B2B,isTest:!1},SYNDICATION_PARTNERS_GNL_TEST:{id:"598315",defaultProducer:e.WS_PARTNERS_B2B,isTest:!0},TASTER:{id:"598316",defaultProducer:e.TASTER,isTest:!1},TASTER_TEST:{id:"598317",defaultProducer:e.TASTER,isTest:!0},TEACH:{id:"598318",defaultProducer:e.BBC,isTest:!1},TEACH_TEST:{id:"598320",defaultProducer:e.BBC,isTest:!0},TOPICS_GNL:{id:"612991",defaultProducer:e.BBC,isTest:!1},TOPICS_GNL_TEST:{id:"614559",defaultProducer:e.BBC,isTest:!0},TOPICS_PS:{id:"612261",defaultProducer:e.BBC,isTest:!1},TOPICS_PS_TEST:{id:"612262",defaultProducer:e.BBC,isTest:!0},VOICE:{id:"598326",defaultProducer:e.VOICE,isTest:!1},VOICE_TEST:{id:"598328",defaultProducer:e.VOICE,isTest:!0},WEATHER_GNL:{id:"598330",defaultProducer:e.WEATHER,isTest:!1},WEATHER_GNL_TEST:{id:"598332",defaultProducer:e.WEATHER,isTest:!0},WEATHER_PS:{id:"598338",defaultProducer:e.WEATHER,isTest:!1},WEATHER_PS_TEST:{id:"598339",defaultProducer:e.WEATHER,isTest:!0},WS_LEARNING_ENGLISH:{id:"598340",defaultProducer:e.WS_LEARNING_ENGLISH,isTest:!1},WS_LEARNING_ENGLISH_TEST:{id:"598341",defaultProducer:e.WS_LEARNING_ENGLISH,isTest:!0},WS_NEWS_LANGUAGES:{id:"598342",defaultProducer:e.BBC_WORLD_NEWS,isTest:!1},WS_NEWS_LANGUAGES_TEST:{id:"598343",defaultProducer:e.BBC_WORLD_NEWS,isTest:!0},WS_PARTNERS_B2B:{id:"598820",defaultProducer:e.WS_PARTNERS_B2B,isTest:!1},WS_PARTNERS_B2B_TEST:{id:"598823",defaultProducer:e.WS_PARTNERS_B2B,isTest:!0},WS_PROGRAMMES:{id:"598344",defaultProducer:e.PROGRAMMES,isTest:!1},WS_PROGRAMMES_TEST:{id:"598345",defaultProducer:e.PROGRAMMES,isTest:!0},WS_SYNDICATION_PARTNERS:{id:"598346",defaultProducer:e.WS_PARTNERS_B2B,isTest:!1},WS_SYNDICATION_PARTNERS_TEST:{id:"598347",defaultProducer:e.WS_PARTNERS_B2B,isTest:!0},get:function(e){var t;return t=e?this[e.toUpperCase()]:t}}}.call(t,i,t,e))||(e.exports=t)},function(e,t,i){void 0===(t=function(){"use strict";var e=i(5);return{BBC_NEWS:e.BBC_NEWS_CHANNEL,BBC_NEWS24:e.BBC_NEWS_CHANNEL,BBC_WORLD_NEWS:e.BBC_WORLD_NEWS,BBC_AFRIQUE_RADIO:e.AFRIQUE,BBC_AFRIQUE_TV:e.AFRIQUE,BBC_AMHARIC_RADIO:e.AMHARIC,BBC_ARABIC_RADIO:e.ARABIC,BBC_ARABIC_TV:e.ARABIC,BBC_BENGALI_RADIO:e.BENGALI,BBC_BRASIL:e.BRASIL,BBC_BURMESES_RADIO:e.BURMESE,BBC_BURMESES_TV:e.BURMESE,BBC_CANTONESE_RADIO:e.CHINESE,BBC_DARI_RADIO:e.PERSIAN,BBC_GAHUZA_RADIO:e.GAHUZA,BBC_GUJARATI_TV:e.GUJARATI,BBC_HAUSA_RADIO:e.HAUSA,BBC_HAUSA_TV:e.HAUSA,BBC_HINDI_RADIO:e.HINDI,BBC_HINDI_TV:e.HINDI,BBC_IGBO_RADIO:e.IGBO,BBC_IGBO_TV:e.IGBO,BBC_INDONESIAN_RADIO:e.INDONESIAN,BBC_KOREAN_RADIO:e.KOREAN,BBC_KOREAN_TV:e.KOREAN,BBC_KYRGYZ_RADIO:e.KYRGYZ,BBC_KYRGYZ_TV:e.KYRGYZ,BBC_LEARNING_ENGLISH:e.WS_LEARNING_ENGLISH,BBC_MARATHI_TV:e.MARATHI,BBC_MUNDO:e.MUNDO,BBC_NEPALI_RADIO:e.NEPALI,BBC_OROMO_RADIO:e.AFAAN_OROMOO,BBC_PARLIAMENT:e.BBC_PARLIAMENT_CHANNEL,BBC_PASHTO_RADIO:e.PASHTO,BBC_PASHTO_TV:e.PASHTO,BBC_PERSIAN_RADIO:e.PERSIAN,BBC_PERSIAN_TV:e.PERSIAN,BBC_PIDGIN_RADIO:e.PIDGIN,BBC_PIDGIN_TV:e.PIDGIN,BBC_PUNJABI_TV:e.PUNJABI,BBC_RUSSIAN_RADIO:e.RUSSIAN,BBC_RUSSIAN_TV:e.RUSSIAN,BBC_SINHALA_RADIO:e.SINHALA,BBC_SOMALI_RADIO:e.SOMALI,BBC_SOMALI_TV:e.SOMALI,BBC_SWAHILI_RADIO:e.SWAHILI,BBC_SWAHILI_TV:e.SWAHILI,BBC_TAMIL_RADIO:e.TAMIL,BBC_TAMIL_TV:e.TAMIL,BBC_TELUGU_TV:e.TELUGU,BBC_THAI:e.THAI,BBC_TIGRINYA_RADIO:e.TIGRINYA,BBC_UKRAINIAN_TV:e.UKRAINIAN,BBC_URDU_RADIO:e.URDU,BBC_URDU_TV:e.URDU,BBC_UZBEK_RADIO:e.UZBEK,BBC_UZBEK_TV:e.UZBEK,BBC_WEATHER:e.WEATHER,BBC_WORLD_SERVICE:e.WORLD_SERVICE_ENGLISH,BBC_WORLD_SERVICE_TV:e.WORLD_SERVICE_ENGLISH,BBC_YORUBA_RADIO:e.YORUBA,BBC_YORUBA_TV:e.YORUBA,PARLIAMENTS_ONLINE:e.BBC_PARLIAMENT_CHANNEL,BBC_ALBA:e.BBC_ALBA,BBC_CYMRU:e.WALES,BBC_FOUR:e.BBC_FOUR,BBC_HD:e.BBC_HD,BBC_LONDON:e.ENGLISH_REGIONS,BBC_MUSIC:e.BBC_MUSIC,BBC_MUSIC_JAZZ:e.BBC_MUSIC,BBC_ONE:e.BBC_ONE,BBC_ONE_EAST:e.ENGLISH_REGIONS,BBC_ONE_EAST_MIDLANDS:e.ENGLISH_REGIONS,BBC_ONE_EAST_YORKSHIRE:e.ENGLISH_REGIONS,BBC_ONE_LONDON:e.ENGLISH_REGIONS,BBC_ONE_NORTH_EAST:e.ENGLISH_REGIONS,BBC_ONE_NORTH_WEST:e.ENGLISH_REGIONS,BBC_ONE_NORTHERN_IRELAND:e.NORTHERN_IRELAND,BBC_ONE_SCOTLAND:e.SCOTLAND,BBC_ONE_SOUTH:e.ENGLISH_REGIONS,BBC_ONE_SOUTH_EAST:e.ENGLISH_REGIONS,BBC_ONE_SOUTH_WEST:e.ENGLISH_REGIONS,BBC_ONE_WALES:e.WALES,BBC_ONE_WEST:e.ENGLISH_REGIONS,BBC_ONE_WEST_MIDLANDS:e.ENGLISH_REGIONS,BBC_ONE_YORKS:e.ENGLISH_REGIONS,BBC_SCOTLAND:e.BBC_SCOTLAND,BBC_TEES:e.ENGLISH_REGIONS,BBC_THREE:e.BBC_THREE,BBC_TWO:e.BBC_TWO,BBC_TWO_ENGLAND:e.ENGLISH_REGIONS,BBC_TWO_NORTHERN_IRELAND:e.NORTHERN_IRELAND,BBC_TWO_NORTHERN_IRELAND_DIGITAL:e.NORTHERN_IRELAND,BBC_TWO_SCOTLAND:e.SCOTLAND,BBC_TWO_WALES:e.WALES,BBC_WALES:e.WALES,BBC_WM:e.ENGLISH_REGIONS,CBBC:e.CBBC,CBEEBIES:e.CBEEBIES,BBC_1XTRA:e.BBC_RADIO_1XTRA,BBC_6MUSIC:e.BBC_RADIO_6_MUSIC,BBC_7:e.BBC_RADIO_4_EXTRA,BBC_ASIAN_NETWORK:e.BBC_ASIAN_NETWORK,BBC_RADIO_BERKSHIRE:e.ENGLISH_REGIONS,BBC_RADIO_BRISTOL:e.ENGLISH_REGIONS,BBC_RADIO_CAMBRIDGE:e.ENGLISH_REGIONS,BBC_RADIO_CORNWALL:e.ENGLISH_REGIONS,BBC_RADIO_COVENTRY_WARWICKSHIRE:e.ENGLISH_REGIONS,BBC_RADIO_CUMBRIA:e.ENGLISH_REGIONS,BBC_RADIO_CYMRU:e.WALES,BBC_RADIO_CYMRU_2:e.WALES,BBC_RADIO_CYMRU_MWY:e.WALES,BBC_RADIO_DERBY:e.ENGLISH_REGIONS,BBC_RADIO_DEVON:e.ENGLISH_REGIONS,BBC_RADIO_ESSEX:e.ENGLISH_REGIONS,BBC_RADIO_FIVE_LIVE:e.BBC_RADIO_5_LIVE,BBC_RADIO_FIVE_LIVE_OLYMPICS_EXTRA:e.BBC_RADIO_5_LIVE,BBC_RADIO_FIVE_LIVE_SPORTS_EXTRA:e.BBC_RADIO_5_LIVE,BBC_RADIO_FOUR:e.BBC_RADIO_4,BBC_RADIO_FOUR_EXTRA:e.BBC_RADIO_4_EXTRA,BBC_RADIO_FOYLE:e.NORTHERN_IRELAND,BBC_RADIO_GLOUCESTERSHIRE:e.ENGLISH_REGIONS,BBC_RADIO_GUERNSEY:e.ENGLISH_REGIONS,BBC_RADIO_HEREFORD_WORCESTER:e.ENGLISH_REGIONS,BBC_RADIO_HUMBERSIDE:e.ENGLISH_REGIONS,BBC_RADIO_JERSEY:e.ENGLISH_REGIONS,BBC_RADIO_KENT:e.ENGLISH_REGIONS,BBC_RADIO_LANCASHIRE:e.ENGLISH_REGIONS,BBC_RADIO_LEEDS:e.ENGLISH_REGIONS,BBC_RADIO_LEICESTER:e.ENGLISH_REGIONS,BBC_RADIO_LINCOLNSHIRE:e.ENGLISH_REGIONS,BBC_RADIO_MANCHESTER:e.ENGLISH_REGIONS,BBC_RADIO_MERSEYSIDE:e.ENGLISH_REGIONS,BBC_RADIO_NAN_GAIDHEAL:e.SCOTLAND,BBC_RADIO_NEWCASTLE:e.ENGLISH_REGIONS,BBC_RADIO_NORFOLK:e.ENGLISH_REGIONS,BBC_RADIO_NORTHAMPTON:e.ENGLISH_REGIONS,BBC_RADIO_NOTTINGHAM:e.ENGLISH_REGIONS,BBC_RADIO_ONE:e.BBC_RADIO_1,BBC_RADIO_ONE_VINTAGE:e.BBC_RADIO_1,BBC_RADIO_OXFORD:e.ENGLISH_REGIONS,BBC_RADIO_SCOTLAND:e.SCOTLAND,BBC_RADIO_SCOTLAND_FM:e.SCOTLAND,BBC_RADIO_SCOTLAND_MUSIC_EXTRA:e.SCOTLAND,BBC_RADIO_SHEFFIELD:e.ENGLISH_REGIONS,BBC_RADIO_SHROPSHIRE:e.ENGLISH_REGIONS,BBC_RADIO_SOLENT:e.ENGLISH_REGIONS,BBC_RADIO_SOMERSET_SOUND:e.ENGLISH_REGIONS,BBC_RADIO_STOKE:e.ENGLISH_REGIONS,BBC_RADIO_SUFFOLK:e.ENGLISH_REGIONS,BBC_RADIO_SURREY:e.ENGLISH_REGIONS,BBC_RADIO_SUSSEX:e.ENGLISH_REGIONS,BBC_RADIO_SWINDON:e.ENGLISH_REGIONS,BBC_RADIO_THREE:e.BBC_RADIO_3,BBC_RADIO_TWO:e.BBC_RADIO_2,BBC_RADIO_TWO_COUNTRY:e.BBC_RADIO_2,BBC_RADIO_TWO_EUROVISION:e.BBC_RADIO_2,BBC_RADIO_TWO_FIFTIES:e.BBC_RADIO_2,BBC_RADIO_ULSTER:e.NORTHERN_IRELAND,BBC_RADIO_WALES:e.WALES,BBC_RADIO_WILTSHIRE:e.ENGLISH_REGIONS,BBC_RADIO_YORK:e.ENGLISH_REGIONS,BBC_SOUNDS_MIXES:e.SOUNDS,BBC_SOUNDS_PODCASTS:e.SOUNDS,BBC_SOUTHERN_COUNTIES_RADIO:e.ENGLISH_REGIONS,BBC_THREE_COUNTIES_RADIO:e.ENGLISH_REGIONS,CBEEBIES_RADIO:e.CBEEBIES,BBC_SPORT:e.SPORT,getProducerId:function(e){var t;return t=e?this[e.toUpperCase()]:t}}}.call(t,i,t,e))||(e.exports=t)},function(e,t,i){void 0===(t=function(e){"use strict";var t=i(50).version;return{getLibraryName:function(){return"echo_js"},getLibraryVersion:function(){return t}}}.call(t,i,t,e))||(e.exports=t)},function(e,t,i){e.exports={NAME:"echo_js",VERSION:"12.17.0"}},function(e,t,i){void 0===(t=function(){"use strict";return{WALES:"wales",ENGLAND:"england",SCOTLAND:"scotland",NORTHERN_IRELAND:"northern_ireland",NONE:"",getName:function(e){var t;return t=void 0!==e?e?this[e.toUpperCase()]:this.NONE:t}}}.call(t,i,t,e))||(e.exports=t)},function(e,t,c){void 0===(t=function(){"use strict";var n,r,o=c(0),a=c(3),i={},s={};function e(e,t){this._config=e,this._env=t;var i=(i=e[a.REMOTE_CONFIG_URL])||"https://mybbc-analytics.files.bbci.co.uk/analytics-remote-config/",t=(t=e[a.PRODUCER_CONFIG_FILENAME])||"producers.json",e=e[a.MASTERBRAND_CONFIG_FILENAME];n=i+t,r=i+(e=e||"masterbrands.json"),this.fetchRemoteData(n,r)}return e.prototype.getData=function(e,n){this._env.getExecuteCrossDomainGet()(e,{onSuccess:function(e){n(e)},onError:function(e,t){var i="error";"json"===e?i="json":"object"==typeof e&&"timeout"===e.type&&(i="timeout"),o.error("There was a problem requesting the remote config data",i,t),n()}})},e.prototype.fetchRemoteData=function(e,t){e||o.error("There was no Producer URL found"),this.getData(e,function(e){i=e}),t||o.error("There was no Masterbrand URL found"),this.getData(t,function(e){s=e})},e.prototype.getProducers=function(){return i},e.prototype.getMasterbrands=function(){return s},e}.call(t,c,t,e))||(e.exports=t)},function(e,t,i){void 0===(t=function(){"use strict";function e(){this.reset()}return e.prototype.start=function(){!0!==this._isPlaying&&(this._isPlaying=!0,this._startTime=this._getCurrentTime())},e.prototype.reset=function(){this._isPlaying=!1,this._position=0,this._startTime=0},e.prototype.stop=function(){this._isPlaying&&(this._isPlaying=!1,this._position+=this._getCurrentTime()-this._startTime,this._startTime=0)},e.prototype.getPosition=function(){var e=this._position;return!0===this._isPlaying&&(e+=this._getCurrentTime()-this._startTime),e},e.prototype._getCurrentTime=function(){return Date.now||(Date.now=function(){return(new Date).getTime()}),Date.now()},e}.call(t,i,t,e))||(e.exports=t)},function(e,t,i){var i=[i(1),i(0),i(2)];void 0===(i=function(e,a,i){"use strict";function r(e,t,i){this._schedule=[],this.serviceId=null,this._media=e,this._environment=t,this._echoClient=i,this._fetchData()}return r.prototype.getBroadcast=function(e){for(var t,i=0;i<this._schedule.length;i++)if(e<(t=this._schedule[i].published_time).end&&e>=t.start)return this._schedule[i]},r.essHost="ess.api.bbci.co.uk",r.prototype._fetchData=function(){var n=this,e=this._environment.getExecuteCrossDomainGet(),t=this._environment.getProtocol()+r.essHost.replace(/^(\/+)?/,"//")+"/schedules";if(this._media){if(this._media.getServiceId())t+="?serviceId="+encodeURIComponent(this._media.getServiceId()),a.info("Get ServiceID: "+t);else if(this._media.getVersionId())t+="?versionId="+encodeURIComponent(this._media.getVersionId()),a.info("Get VersionID: "+t);else{if(!this._media.getVpId())return a.info("Unable to determine serviceId, versionId or VpId for schedule"),void a.info(t);a.info("Get VPid: "+t),t+="?vpid="+encodeURIComponent(this._media.getVpId())}e(t,{onSuccess:function(e){n._dataSuccessHandler(e)},onError:function(e,t){var i="error";"json"===e?i="json":"object"==typeof e&&"timeout"===e.type&&(i="timeout"),n._dataErrorHandler(i,t)}})}},r.prototype.hasData=function(){return 0<this._schedule.length},r.prototype._dataSuccessHandler=function(e){var t,i,n,r,o=[];if(a.info("Cross-domain schedule request success."),e){for(this._echoClient.setEssSuccess(!0),this.serviceId=e.service.id,e.items=e.items||[],t=0;t<e.items.length;t++)n=e.items[t].published_time.start,r=e.items[t].published_time.end,(i=e.items[t]).published_time.start=new Date(n).getTime(),i.published_time.end=new Date(r).getTime(),o.push(i);this._schedule=o}},r.prototype._dataErrorHandler=function(e,t){this._schedule=[],a.warn("There was a problem requesting the schedule from ESS: "+e),this._echoClient.setEssSuccess(!1),"json"===e?this._echoClient.setEssError(i.EssError.JSON,t):"timeout"===e?this._echoClient.setEssError(i.EssError.TIMEOUT,t):"error"===e&&void 0!==t?this._echoClient.setEssError(i.EssError.STATUS_CODE,t):this._echoClient.setEssError(i.EssError.RUNTIME,"0")},r}.apply(t,i))||(e.exports=i)},function(e,t,h){void 0===(t=function(e){"use strict";function t(e,t){this.avType=e===o.AvType.AUDIO||e===o.AvType.VIDEO?e:null,this.consumptionMode=t===d.ON_DEMAND||t===d.DOWNLOAD||t===d.LIVE?t:null,a.assert(this.avType,"Media: Invalid avType: "+this.avType,!0),a.assert(this.consumptionMode,"Media: Invalid consumptionMode: "+this.consumptionMode,!0),this.serviceIdObject=new r(o.MediaIdType.SERVICE,!0),this.versionIdObject=new r(o.MediaIdType.VERSION,!0),this.clipIdObject=new r(o.MediaIdType.CLIP,!0),this.episodeIdObject=new r(o.MediaIdType.EPISODE,!0),this.vpIdObject=new r(o.MediaIdType.VPID,!0),this.nonPipsContentIdObject=new r(o.MediaIdType.NONPIPSCONTENT,!1),this.producer=0,this.masterbrand=0,this.useMasterbrandProducer=!1,this.brand="",this.series="",this.length=0,this.bufferLength=0,this.supplier=null,this.mediaSet=null,this.transferFormat=null,this.essEnrichedData=!1,this._isPlaying=!1,this._isBuffering=!1,this._isEmbedded=!1,this.name="",this.type=o.MediaClipType.UNDEFINED,this.playlist="",this.wsPartnerId="",this.initiationType=o.MediaInitiationType.UNDEFINED,this.adsEnabled=!1,this.mediaPlayerName="",this.mediaPlayerVersion="",this.transportMode="",this.castingDeviceReferrer="",this.remoteProducers=null,this.remoteMasterbrands=null}var i=h(5),n=h(11),r=h(19),o=h(2),a=h(1),s=h(6),c=h(7),u=h(4),l=h(0),d=o.MediaConsumptionMode;return t.prototype.setRemoteProducers=function(e){this.remoteProducers=e},t.prototype.setRemoteMasterbrands=function(e){this.remoteMasterbrands=e},t.prototype.isEssEnriched=function(){return!0===this.essEnrichedData},t.prototype.setEssEnriched=function(e){this.essEnrichedData=e},t.prototype.getAvType=function(){return this.avType},t.prototype.getMediaConsumptionMode=function(){return this.consumptionMode},t.prototype.getClone=function(){var e=new t(this.avType,this.consumptionMode);return e.brand=this.brand,e.series=this.series,e.serviceIdObject=this.serviceIdObject,e.versionIdObject=this.versionIdObject,e.clipIdObject=this.clipIdObject,e.episodeIdObject=this.episodeIdObject,e.vpIdObject=this.vpIdObject,e.name=this.name,e.type=this.type,e.playlist=this.playlist,e.initiationType=this.initiationType,e.adsEnabled=this.adsEnabled,e.mediaPlayerVersion=this.mediaPlayerVersion,e.mediaPlayerName=this.mediaPlayerName,e.transportMode=this.transportMode,e.castingDeviceReferrer=this.castingDeviceReferrer,e.wsPartnerId=this.wsPartnerId,e.nonPipsContentIdObject=this.nonPipsContentIdObject,e.appName=this.appName,e.appType=this.appType,e.producer=this.producer,e.masterbrand=this.masterbrand,e.remoteProducers=this.remoteProducers,e.remoteMasterbrands=this.remoteMasterbrands,e.useMasterbrandProducer=this.useMasterbrandProducer,e.bufferLength=this.bufferLength,e.mediaSet=this.mediaSet,e.supplier=this.supplier,e.transferFormat=this.transferFormat,e.length=this.length,e.essEnrichedData=this.essEnrichedData,e},t.prototype.isEmbedded=function(){return this._isEmbedded},t.prototype.setIsEmbedded=function(e){return this._isEmbedded=e,this},t.prototype.setVersionId=function(e){return this.versionIdObject.setValue(e),this},t.prototype.setBrand=function(e){return this.brand=u.cleanLabelValue(s.MEDIA_BRAND,e),this},t.prototype.setSeries=function(e){return this.series=u.cleanLabelValue(s.MEDIA_SERIES,e),this},t.prototype.setWsPartnerId=function(e){return this.wsPartnerId=u.cleanLabelValue(s.MEDIA_WS_PARTNER_ID,e),this},t.prototype.setClipId=function(e){return this.clipIdObject.setValue(e),this},t.prototype.setServiceId=function(e){return this.serviceIdObject.setValue(e),this},t.prototype.setEpisodeId=function(e){return this.episodeIdObject.setValue(e),this},t.prototype.setVpId=function(e){return this.vpIdObject.setValue(e),this},t.prototype.setNonPipsContentId=function(e){return this.nonPipsContentIdObject.setValue(u.cleanLabelValue(c.MEDIA_NON_PIPS_CONTENT_ID,e)),this},t.prototype.getSupplier=function(){return this.supplier},t.prototype.setSupplier=function(e){return null===e||0!==(e=a.trim(e)).length&&(this.supplier=e),this},t.prototype.setMediaSet=function(e){return null===e||0!==(e=a.trim(e)).length&&(this.mediaSet=e),this},t.prototype.getTransferFormat=function(){return this.transferFormat},t.prototype.setTransferFormat=function(e){return null===e||0!==(e=a.trim(e)).length&&(this.transferFormat=e),this},t.prototype.isAdsEnabled=function(){return this.adsEnabled},t.prototype.setAdsEnabled=function(e){return this.adsEnabled=e,this},t.prototype.getName=function(){return this.name},t.prototype.setName=function(e){return this.name=e,this},t.prototype.getAppName=function(){return this.appName},t.prototype.setAppName=function(e){return this.appName=e,this},t.prototype.getAppType=function(){return this.appType},t.prototype.setAppType=function(e){return this.appType=e,this},t.prototype.getType=function(){return this.type},t.prototype.setType=function(e){return this.type=e,this},t.prototype.getPlaylist=function(){return this.playlist},t.prototype.setPlaylist=function(e){return this.playlist=e,this},t.prototype.getInitiationType=function(){return this.initiationType},t.prototype.setInitiationType=function(e){return this.initiationType=e,this},t.prototype.getMediaPlayerName=function(){return this.mediaPlayerName},t.prototype.setMediaPlayerName=function(e){return this.mediaPlayerName=e,this},t.prototype.getMediaPlayerVersion=function(){return this.mediaPlayerVersion},t.prototype.setMediaPlayerVersion=function(e){return this.mediaPlayerVersion=e,this},t.prototype.getTransportMode=function(){return this.transportMode},t.prototype.setTransportMode=function(e){return this.transportMode=e,this},t.prototype.setCastingDeviceReferrer=function(e){return this.castingDeviceReferrer=u.cleanLabelValue(s.CASTING_DEVICE_REFERRER,e),this},t.prototype.getLength=function(){return this.length},t.prototype.setLength=function(e){return(void 0===(e=null!=e?Math.floor(e):e)||isNaN(e)||!isFinite(e)||e<0)&&(l.warn("Media: length must be an integer of 0 or greater. Echo will report as 0."),e=0),this.length=e,this},t.prototype.getProducer=function(){return this.producer},t.prototype.getMasterbrand=function(){return this.masterbrand},t.prototype.setProducer=function(e){this.useMasterbrandProducer=!1,this.producer=e?e.toUpperCase():null},t.prototype.getProducerId=function(){return this.useMasterbrandProducer?this.getProducerIdFromMasterbrand():this.getProducerIdFromProducer()},t.prototype.getProducerIdFromMasterbrand=function(){return this.remoteProducers&&this.remoteMasterbrands&&this.remoteMasterbrands[this.masterbrand]&&this.remoteProducers[this.remoteMasterbrands[this.masterbrand]]?this.remoteProducers[this.remoteMasterbrands[this.masterbrand]]:n.getProducerId(this.masterbrand)?n.getProducerId(this.masterbrand):(null===this.masterbrand||this.masterbrand&&"NULL"===this.masterbrand.toUpperCase()||""===this.masterbrand||l.info("Masterbrand ["+this.masterbrand+"] not recognised, producer will be set to undefined (0)"),0)},t.prototype.getProducerIdFromProducer=function(){return this.remoteProducers&&this.remoteProducers[this.producer]?this.remoteProducers[this.producer]:i.getId(this.producer)?i.getId(this.producer):0},t.prototype.setProducerById=function(e){return e&&(this.producer=e),this},t.prototype.setProducerByMasterbrand=function(e){this.useMasterbrandProducer=!0,this.masterbrand=e?e.toUpperCase():null},t.prototype.getVersionIdObject=function(){return this.versionIdObject},t.prototype.getClipIdObject=function(){return this.clipIdObject},t.prototype.getServiceIdObject=function(){return this.serviceIdObject},t.prototype.getWsPartnerId=function(){return this.wsPartnerId},t.prototype.getCastingDeviceReferrer=function(){return this.castingDeviceReferrer},t.prototype.getEpisodeIdObject=function(){return this.episodeIdObject},t.prototype.getVpIdObject=function(){return this.vpIdObject},t.prototype.getNonPipsContentIdObject=function(){return this.nonPipsContentIdObject},t.prototype.getBrand=function(){return this.brand},t.prototype.getSeries=function(){return this.series},t.prototype.getMediaSet=function(){return this.mediaSet},t.prototype.getVersionId=function(){return this.versionIdObject.getValue()},t.prototype.getClipId=function(){return this.clipIdObject.getValue()},t.prototype.getServiceId=function(){return this.serviceIdObject.getValue()},t.prototype.getEpisodeId=function(){return this.episodeIdObject.getValue()},t.prototype.getVpId=function(){return this.vpIdObject.getValue()},t.prototype.getNonPipsContentId=function(){return this.nonPipsContentIdObject.getValue()},t.prototype.getRetrievalType=function(){return null===this.consumptionMode?null:this.consumptionMode===d.DOWNLOAD?o.RetrievalType.DOWNLOAD:o.RetrievalType.STREAM},t.prototype.isOnDemand=function(){return this.consumptionMode===d.ON_DEMAND},t.prototype.isDownload=function(){return this.consumptionMode===d.DOWNLOAD},t.prototype.isLive=function(){return this.consumptionMode===d.LIVE},t.prototype.isVideo=function(){return this.avType===o.AvType.VIDEO},t.prototype.getPlayerId=function(){return"1"},t.prototype.setPlaying=function(e){return this._isPlaying=Boolean(e),this},t.prototype.getPlaying=function(){return this._isPlaying},t.prototype.setBuffering=function(e){return this._isBuffering=Boolean(e),this},t.prototype.getBuffering=function(){return this._isBuffering},t}.call(t,h,t,e))||(e.exports=t)},function(e,t,r){void 0===(t=function(e){"use strict";function t(e,t){this.idType=e,this.value=null,this.isSet=!1,this.isValid=!1,this.requiresValidation=t}var i=r(1),n=r(4);return t.prototype.getIdType=function(){return this.idType},t.prototype.setValue=function(e){this.isSet=!0,null==e||"string"!=typeof e||0===e.length?(i.assert(!1,"MediaId: The value for "+this.idType+"Id is invalid",!0),this.isValid=!1):this.isValid=!0,this.value=n.cleanMediaId(e)},t.prototype.getValue=function(){return this.value},t.prototype.isValueSet=function(){return this.isSet},t.prototype.isValueValid=function(){return this.isValid},t.prototype._validateValue=function(e){return"string"==typeof e&&this.validValueRegex.test(e)},t}.call(t,r,t,e))||(e.exports=t)},function(e,t,n){void 0===(t=function(){"use strict";var t=n(0),i=n(21).Promise;function r(){}return r.get=function(){return window&&window.bbcpage?i.all(["getDestination","getProducer","getSection","getContentId","getContentType","getLanguage","getAdditionalProperties","getName"].map(function(e){return window.bbcpage[e]&&"function"==typeof window.bbcpage[e]?window.bbcpage[e]():i.resolve(null)})).then(function(e){return e=r._decodeFromOrbit(e),t.info("Got Orbit Variables: "+JSON.stringify(e)),{destination:e[0],producer:e[1],section:e[2],contentId:e[3],contentType:e[4],language:e[5],additionalProperties:e[6],pageName:e[7]}}):i.resolve(void 0)},r.getUser=function(){return window&&window.bbcuser?i.all(["getHashedId","isSignedIn"].map(function(e){return window.bbcuser[e]&&"function"==typeof window.bbcuser[e]?window.bbcuser[e]():i.resolve(null)})).then(function(e){return t.info("Got Orbit User Variables: "+JSON.stringify(e)),{hashedId:e[0],isSignedIn:e[1]}}):i.resolve(void 0)},r._decodeFromOrbit=function(e){for(var t,i=Object.keys(e),n=0;n<i.length;n++)e[i[n]]&&"object"!=typeof e[i[n]]?(t=new RegExp("&#x2F;","g"),e[i[n]]=e[i[n]].replace(t,"/")):e[i[n]]&&"object"==typeof e[i[n]]&&(e[i[n]]=r._decodeFromOrbit(e[i[n]]));return e},r}.call(t,n,t,e))||(e.exports=t)},function(e,t,i){!function(x,G){e.exports=function(){"use strict";function u(e){return"function"==typeof e}var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=0,t=void 0,r=void 0,s=function(e,t){d[n]=e,d[n+1]=t,2===(n+=2)&&(r?r(h):E())},e="undefined"!=typeof window?window:void 0,o=e||{},a=o.MutationObserver||o.WebKitMutationObserver,c="undefined"==typeof self&&void 0!==x&&"[object process]"==={}.toString.call(x),o="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function l(){var e=setTimeout;return function(){return e(h,1)}}var d=new Array(1e3);function h(){for(var e=0;e<n;e+=2)(0,d[e])(d[e+1]),d[e]=void 0,d[e+1]=void 0;n=0}var p,_,f,E=void 0;function g(e,t){var i=this,n=new this.constructor(C);void 0===n[T]&&w(n);var r,o=i._state;return o?(r=arguments[o-1],s(function(){return D(o,n,r,i._result)})):L(i,n,e,t),n}function m(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(C);return b(t,e),t}var E=c?function(){return x.nextTick(h)}:a?(_=0,a=new a(h),f=document.createTextNode(""),a.observe(f,{characterData:!0}),function(){f.data=_=++_%2}):o?((p=new MessageChannel).port1.onmessage=h,function(){return p.port2.postMessage(0)}):(void 0===e?function(){try{var e=Function("return this")().require("vertx");return void 0===(t=e.runOnLoop||e.runOnContext)?l():function(){t(h)}}catch(e){return l()}}:l)(),T=Math.random().toString(36).substring(2);function C(){}var I=void 0,v=1,S=2,y={error:null};function A(e){try{return e.then}catch(e){return y.error=e,y}}function O(e,t,i){var n,r,o,a;t.constructor===e.constructor&&i===g&&t.constructor.resolve===m?(o=e,(a=t)._state===v?R(o,a._result):a._state===S?N(o,a._result):L(a,void 0,function(e){return b(o,e)},function(e){return N(o,e)})):i===y?(N(e,y.error),y.error=null):void 0!==i&&u(i)?(n=t,r=i,s(function(t){var i=!1,e=function(e,t,i,n){try{e.call(t,i,n)}catch(e){return e}}(r,n,function(e){i||(i=!0,(n!==e?b:R)(t,e))},function(e){i||(i=!0,N(t,e))},t._label);!i&&e&&(i=!0,N(t,e))},e)):R(e,t)}function b(e,t){var i;e===t?N(e,new TypeError("You cannot resolve a promise with itself")):(i=typeof t,null===t||"object"!=i&&"function"!=i?R(e,t):O(e,t,A(t)))}function P(e){e._onerror&&e._onerror(e._result),B(e)}function R(e,t){e._state===I&&(e._result=t,e._state=v,0!==e._subscribers.length&&s(B,e))}function N(e,t){e._state===I&&(e._state=S,e._result=t,s(P,e))}function L(e,t,i,n){var r=e._subscribers,o=r.length;e._onerror=null,r[o]=t,r[o+v]=i,r[o+S]=n,0===o&&e._state&&s(B,e)}function B(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var n,r=void 0,o=e._result,a=0;a<t.length;a+=3)n=t[a],r=t[a+i],n?D(i,n,r,o):r(o);e._subscribers.length=0}}function D(e,t,i,n){var r=u(i),o=void 0,a=void 0,s=void 0,c=void 0;if(r){if((o=function(e,t){try{return e(t)}catch(e){return y.error=e,y}}(i,n))===y?(c=!0,a=o.error,o.error=null):s=!0,t===o)return void N(t,new TypeError("A promises callback cannot return that same promise."))}else o=n,s=!0;t._state!==I||(r&&s?b(t,o):c?N(t,a):e===v?R(t,o):e===S&&N(t,o))}var M=0;function w(e){e[T]=M++,e._state=void 0,e._result=void 0,e._subscribers=[]}var U=(H.prototype._enumerate=function(e){for(var t=0;this._state===I&&t<e.length;t++)this._eachEntry(e[t],t)},H.prototype._eachEntry=function(t,e){var i,n,r=this._instanceConstructor,o=r.resolve;o===m?(i=A(t))===g&&t._state!==I?this._settledAt(t._state,e,t._result):"function"!=typeof i?(this._remaining--,this._result[e]=t):r===k?(O(n=new r(C),t,i),this._willSettleAt(n,e)):this._willSettleAt(new r(function(e){return e(t)}),e):this._willSettleAt(o(t),e)},H.prototype._settledAt=function(e,t,i){var n=this.promise;n._state===I&&(this._remaining--,e===S?N(n,i):this._result[t]=i),0===this._remaining&&R(n,this._result)},H.prototype._willSettleAt=function(e,t){var i=this;L(e,void 0,function(e){return i._settledAt(v,t,e)},function(e){return i._settledAt(S,t,e)})},H),k=(V.prototype.catch=function(e){return this.then(null,e)},V.prototype.finally=function(t){var i=this.constructor;return u(t)?this.then(function(e){return i.resolve(t()).then(function(){return e})},function(e){return i.resolve(t()).then(function(){throw e})}):this.then(t,t)},V);function V(e){this[T]=M++,this._result=this._state=void 0,this._subscribers=[],C!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof V?function(t,e){try{e(function(e){b(t,e)},function(e){N(t,e)})}catch(e){N(t,e)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}function H(e,t){this._instanceConstructor=e,this.promise=new e(C),this.promise[T]||w(this.promise),i(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?R(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&R(this.promise,this._result))):N(this.promise,new Error("Array Methods must be provided an Array"))}return k.prototype.then=g,k.all=function(e){return new U(this,e).promise},k.race=function(r){var o=this;return i(r)?new o(function(e,t){for(var i=r.length,n=0;n<i;n++)o.resolve(r[n]).then(e,t)}):new o(function(e,t){return t(new TypeError("You must pass an array to race."))})},k.resolve=m,k.reject=function(e){var t=new this(C);return N(t,e),t},k._setScheduler=function(e){r=e},k._setAsap=function(e){s=e},k._asap=s,k.polyfill=function(){var e=void 0;if(void 0!==G)e=G;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var i=null;try{i=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===i&&!t.cast)return}e.Promise=k},k.Promise=k}()}.call(this,i(32),i(33))},function(e,t){var i,n,r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);r?(i=new Uint8Array(16),e.exports=function(){return r(i),i}):(n=new Array(16),e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n})},function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,t=n;return[t[e[i++]],t[e[i++]],t[e[i++]],t[e[i++]],"-",t[e[i++]],t[e[i++]],"-",t[e[i++]],t[e[i++]],"-",t[e[i++]],t[e[i++]],"-",t[e[i++]],t[e[i++]],t[e[i++]],t[e[i++]],t[e[i++]],t[e[+i]]].join("")}},function(e,t,i){e.exports=i(25)},function(e,t,i){var i=[i(26)];void 0===(i=function(e){"use strict";return window&&window.bbccookies&&e.Environment.setOrbCookies(window.bbccookies),e}.apply(t,i))||(e.exports=i)},function(e,t,n){void 0===(t=function(e){"use strict";var t=n(13),i=n(8);return{EchoClient:n(29),Media:n(18),MediaId:n(19),Environment:i,Enums:n(2),ConfigKeys:n(3),Debug:n(0),getImplementationVersion:function(){return t.VERSION}}}.call(t,n,t,e))||(e.exports=t)},function(e,t,i){e.exports={STRICT:"strict",COUNTERNAME:"countername",EVENT_MASTER_BRAND:"event_master_brand",NO_CLEANSING:"no_cleansing",CUSTOM:"custom"}},function(e,t,i){void 0===(t=function(){"use strict";return{httpGet:function(e,t,i){var n=new Image;n.onload=t,n.onerror=i,n.src=e},executeCrossDomainGet:function(e,i){function t(e,t){i.onError&&i.onError(e,t)}var n,r,o=r=!1;if(o=window.JSON&&window.JSON.parse&&void 0!==window.XMLHttpRequest&&"withCredentials"in(n=new XMLHttpRequest)?!0:o){try{n.open("GET",e,!0),n.onload=function(){(void 0===n.status||n.status<400)&&null!==n.responseText?function(){var e;if(i.onSuccess){try{e=window.JSON.parse(n.responseText)}catch(e){t("json")}"object"==typeof e&&setTimeout(function(){i.onSuccess(e)})}}():t(n.responseText,n.status)},n.onerror=function(e){t(e)},n.timeout=1e4,n.ontimeout=function(e){t(e)}}catch(e){r||t(e)}try{n.send(null)}catch(e){r=!0,n.onload=n.onerror=n.onreadystatechange=null,n.abort(),t(e)}}else t()}}}.call(t,i,t,e))||(e.exports=t)},function(e,t,m){void 0===(t=function(e){"use strict";var c=m(0),u=m(1),l=m(3),t=m(10),d=m(15),r=m(11),o=m(5),i=m(14),h=m(2),n=m(30),a=m(31),s=m(7),p=m(17),_=m(9),f=m(20),E=m(21).Promise;function g(e,t,i,n,r){var o=this;i=i||{},u.assertContainsValue(h.ApplicationType,t,'appType should be one of Enums.ApplicationType, got "'+t+'"'),this.state={counterNameSet:!1};var a,s=g.ConfigGenerator.generate(i);if(this._env=null!=n?n:new g.Environment,setInterval(function(){o._remoteConfigManager=new d(i,o._env)},36e5),this._remoteConfigManager=new d(i,this._env),s&&(s[l.REMOTE_CONFIG_MANAGER]=this._remoteConfigManager),s&&"string"==typeof s[l.ECHO_DEVICE_ID]&&(0<(a=u.trim(s[l.ECHO_DEVICE_ID])).length?(s[l.ECHO_DEVICE_ID]=a,this._deviceId=a):s[l.ECHO_DEVICE_ID]=void 0),s&&"scorecardresearch.com"!==s[l.COMSCORE_HOST]&&!s[l.ECHO_DEVICE_ID]&&((a=!(a=_.getCookieValueByName("ckns_echo_device_id"))?_.getCookieValueByName("ckpf_echo_device_id"):a)&&(this._deviceId=a,s[l.ECHO_DEVICE_ID]=a)),s&&!1===s[l.ECHO_AUTO_START]?this._autoStart=!1:this._autoStart=!0,this._setConsumers(e,t,s,this._env),s&&s[l.USE_ESS]?this._essEnabled=!0:this._essEnabled=!1,s&&s[l.ESS_HOSTNAME]&&(p.essHost=s[l.ESS_HOSTNAME]),s&&!1===s[l.ECHO_ENABLED]?this._isEnabled=!1:this._isEnabled=!0,s)switch(s[l.DEBUG_MODE]){case!0:c.enable();break;case"error":c.enable(),c.setLevel(c.DebugLevels.ERROR);break;case"warn":c.enable(),c.setLevel(c.DebugLevels.WARN);break;case"info":c.enable(),c.setLevel(c.DebugLevels.INFO);break;default:c.disable()}this._liveBroker=null,this._onDemandBroker=null,this._suppressingPlayEvent=!1,this._suppressedPlayEventLabels=null,this.addLabel("bbc_id_wait","1"),f.getUser().then(function(e){this.removeLabel("bbc_id_wait"),e&&e.isSignedIn&&(e=e.hashedId?encodeURIComponent(e.hashedId):"unidentified-user",this.addLabels({bbc_identity:"1",bbc_hid:e}))}.bind(this)),s&&s[l.ECHO_CACHE_MODE]&&(this._cacheMode=s[l.ECHO_CACHE_MODE]),this._atiDisableCookie=!!s&&!!s[l.ATI_DISABLE_COOKIE],this._isEnabled&&this._autoStart&&("function"==typeof r?this.start().then(r):this.start())}return g.prototype.getDebugMode=function(){return c.getState()},g.prototype.start=function(){var t;return this._isEnabled&&!this._hasStarted?(this._hasStarted=!0,f.get().then(function(e){t=e,this._delegate("start",[e])}.bind(this)).then(function(){t&&t.pageName&&""!==t.pageName&&"orb.page"!==t.pageName&&this.setCounterName(t.pageName)}.bind(this),function(e){c.error("failed to start delegates: "+e)})):E.reject()},g.prototype.enable=function(){return this._isEnabled||(this._isEnabled=!0,this._delegate("enable"),this._autoStart&&!this._hasStarted&&this.start()),this},g.prototype.disable=function(){return this._isEnabled&&(this._clearMedia(),this._isEnabled=!1,this._delegate("disable")),this},g.prototype.isEnabled=function(){return this._isEnabled},g.prototype.getComScoreDeviceId=function(){var e;return this.consumers[g.Consumers.COMSCORE]&&(e=this.consumers[g.Consumers.COMSCORE])instanceof g.ComScoreDelegate&&"function"==typeof e.getDeviceId?e.getDeviceId():null},g.prototype.getAtiDeviceId=function(){var e;return this.consumers[g.Consumers.ATI]&&(e=this.consumers[g.Consumers.ATI])instanceof g.AtiDelegate&&"function"==typeof e.getDeviceId?e.getDeviceId():null},g.prototype.getDeviceId=function(){return this._deviceId},g.prototype.setDeviceId=function(e){this._deviceId=e,this._delegate("setDeviceId",[e])},g.prototype.setTraceId=function(e){this._delegate("setTraceId",[e])},g.ConfigGenerator=m(34),g.LabelCleanser=m(4),g.Util=m(1),g.ComScoreDelegate=m(35),g.SpringDelegate=m(39),g.AtiDelegate=m(43),g.Environment=m(8),g.prototype._eventsEnabled=function(){return this._isEnabled&&this._hasStarted},g.prototype._setConsumers=function(e,t,i,n){this.consumers={};e=g.LabelCleanser.cleanLabelValue("app_name",e);return i&&i[l.COMSCORE_ENABLED]&&(this.consumers[g.Consumers.COMSCORE]=new g.ComScoreDelegate(e,t,i,n)),i&&i[l.ATI_ENABLED]&&(this.consumers[g.Consumers.ATI]=new g.AtiDelegate(e,t,i,n)),i&&i[l.BARB_ENABLED]&&(this.consumers[g.Consumers.BARB]=new g.SpringDelegate(e,t,i,n)),this},g.prototype._shouldClearDeviceIdOnLogOut=function(){return this._atiDisableCookie},g.prototype._delegate=function(e,t,i){var n,r,o=[];for(n in this.consumers)n&&(r=this.consumers[n],i&&r.requiresLabelCleansing()?o.push(r[e].apply(r,i)):o.push(r[e].apply(r,t)));return E.all(o)},g.prototype.addLabels=function(e){return this.addProperties(e)},g.prototype.addLabel=function(e,t){return this.addProperty(e,t)},g.prototype.addProperties=function(e){return e=g.LabelCleanser.removeUndefined(e),this._delegate("addProperties",[g.LabelCleanser.cleanLabels(e)]),this},g.prototype.addCampaignProperties=function(e){return(e=g.LabelCleanser.removeUndefined(e)).hasOwnProperty("src_channel")&&e.hasOwnProperty("src_medium")&&e.hasOwnProperty("src_campaign")?this._delegate("addCampaignProperties",[e]):c.error("Campaign properties must contain channel, medium, and campaign"),this},g.prototype.addProperty=function(e,t){if("string"==typeof e){if(null!=t){var i={};return i[e]=t,this.addProperties(i)}c.error("Property cannot be null/undefined")}else c.error("Property key must be a string")},g.prototype.addManagedLabel=function(e,t){return this._delegate("addManagedLabel",[g.LabelCleanser.cleanLabelKey(e),g.LabelCleanser.cleanLabelValue(e,t)]),this},g.prototype.removeLabels=function(e){return this.removeProperties(e)},g.prototype.removeLabel=function(e){return this.removeProperty(e)},g.prototype.removeProperties=function(e){for(var t=[],i=0,n=e.length;i<n;i++)t.push(g.LabelCleanser.cleanLabelKey(e[i]));return this._delegate("removeProperties",[t]),this},g.prototype.removeProperty=function(e){return this.removeProperties([e])},g.prototype.setLoggedInToBBCId=function(e){return this._delegate("setLoggedInToBBCId",[e]),this},g.prototype.setLoggedOutOfBBCId=function(){return this._delegate("setLoggedOutOfBBCId"),this._shouldClearDeviceIdOnLogOut()&&(c.info("Clearing device id on logout"),this.setDeviceId(void 0)),this},g.prototype.setAppVersion=function(e){return this._delegate("setAppVersion",[e]),this},g.prototype.setDestination=function(e){return this._delegate("setDestination",[t.get(e)]),this},g.prototype.setProducer=function(e){return this._setProducer(e,!1)},g.prototype.setNationsProducer=function(e){var t=i.getName(e);void 0!==t?t&&t!==i.NONE?this.addProperty(h.EchoLabelKeys.NATIONS_PRODUCER,t):this.removeProperty(h.EchoLabelKeys.NATIONS_PRODUCER):c.info("Setting nations producer failed: nations producer "+e+" is not valid")},g.prototype.setProducerByMasterbrand=function(e){return this._setProducer(e,!0)},g.prototype._setProducer=function(e,t){var i=this._remoteConfigManager.getProducers(),n=this._remoteConfigManager.getMasterbrands(),i=e&&"NULL"!==e.toUpperCase()?t?i&&n&&n[e]&&i[n[e]]?i[n[e]]:r.getProducerId(e):i&&i[e]?i[e]:o.getId(e):"0";return i||c.warn((t?"Masterbrand":"Producer")+" ["+e+"] not recognised"),i&&this._delegate("setProducer",[i]),this},g.prototype.setCounterName=function(e){var t=g.LabelCleanser.cleanCounterName(e),t=this._delegate("setCounterName",[e],[t]);return this.state.counterNameSet=!0,t},g.prototype.setContentLanguage=function(e){return this._delegate("setContentLanguage",[e]),this},g.prototype.setCacheMode=function(e){return this._delegate("setCacheMode",[e]),this._cacheMode=e,this},g.prototype.getCacheMode=function(){return this._cacheMode},g.prototype.clearCache=function(){this._isEnabled&&this._delegate("clearCache")},g.prototype.flushCache=function(){this._isEnabled&&this._delegate("flushCache")},g.prototype.viewEvent=function(e,t){if(this._eventsEnabled()){var i=g.LabelCleanser.cleanCounterName(e),n=g.LabelCleanser.cleanLabels(t);this.consumers[g.Consumers.COMSCORE]&&(this.state.comscoreEventSent=!0);n=this._delegate("viewEvent",[e,t],[i,n]);return this.state.counterNameSet=!0,this.consumers[g.Consumers.COMSCORE]&&(this.state.comscoreEventSent=!0),n}},g.prototype.userActionEvent=function(e,t,i){if(this._eventsEnabled())return this.state.counterNameSet?(this._delegate("userActionEvent",[e,t,g.LabelCleanser.cleanLabels(i)]),this.consumers[g.Consumers.COMSCORE]&&(this.state.comscoreEventSent=!0)):c.error("userActionEvent not available before a call to viewEvent (to set counter name)."),this},g.prototype.errorEvent=function(e,t){if(this._eventsEnabled())return this._delegate("errorEvent",[e,g.LabelCleanser.cleanLabels(t)]),this},g.prototype.setPlayerName=function(e){u.assert("string"==typeof e&&0<e.length,'setPlayerName: name must be string with length, got "'+e+'"');var t=g.LabelCleanser.cleanLabelValue("player_name",e);return this._delegate("setPlayerName",[e],[t])},g.prototype.setPlayerVersion=function(e){u.assert("string"==typeof e&&0<e.length,'setPlayerVersion: version must be string with length, got "'+e+'"');var t=g.LabelCleanser.cleanLabelValue("player_version",e);return this._delegate("setPlayerVersion",[e],[t])},g.prototype.setPlayerIsPopped=function(e){return u.assert("boolean"==typeof e,'setPlayerIsPopped: isPopped must be boolean, got "'+e+'"'),this._delegate("setPlayerIsPopped",[e]),this},g.prototype.setPlayerWindowState=function(e){return u.assertContainsValue(h.WindowState,e,'The window state must be set as a member of Enums.WindowState, got "'+e+'"'),this._delegate("setPlayerWindowState",[e]),this},g.prototype.setPlayerVolume=function(e){return u.assert(e<=100&&0<=e,"volume must be 0-100, got: "+e),e<=100&&0<=e&&this._delegate("setPlayerVolume",[e]),this},g.prototype.setPlayerIsSubtitled=function(e){return u.assert("boolean"==typeof e,'setPlayerIsSubtitled: isSubtitled must be a boolean, got "'+e+'"'),this._delegate("setPlayerIsSubtitled",[e]),this},g.prototype.setPlayerDelegate=function(e){e=e||{};for(var t,i,n=["getTimestamp","getPosition"],r=!1,o=0;o<n.length;o++)i=e.hasOwnProperty(t=n[o])&&"function"==typeof e[t],u.assert(i,'The player delegate must implement "'+t+'"'),i||(r=!0);return r||(this._playerDelegate=e),this},g.prototype.setMedia=function(e){var t,i=this;this._eventsEnabled()&&(this._clearMedia(),e=e.getClone(),this.state.counterNameSet?(this.media=e,this.addLabel(s.ESS_ENABLED,this._essEnabled?"true":"false"),e=h.MediaConsumptionMode.LIVE,this.media.getMediaConsumptionMode()===e?this._initLiveBroker():this._initOnDemandBroker(),this.media.setRemoteProducers(this._remoteConfigManager.getProducers()),this.media.setRemoteMasterbrands(this._remoteConfigManager.getMasterbrands()),t=t||setInterval(function(){i.media&&(i.media.setRemoteProducers(i._remoteConfigManager.getProducers()),i.media.setRemoteMasterbrands(i._remoteConfigManager.getMasterbrands()))},36e5),this._delegate("setMedia",[this.media])):c.error("setMedia: Must have a countername set or view event sent first"))},g.prototype.liveMediaUpdate=function(e,t,i){this._eventsEnabled()&&this._avEventsEnabled()&&e&&(this._suppressingPlayEvent=!1,this.media=e,this._delegate("liveMediaUpdate",[e,t,i]))},g.prototype.setMediaLength=function(e){return this.media?this.media.isOnDemand()?"number"!=typeof(e=this._cleanPosition(e))?c.error("setMediaLength: Length must be a positive number"):(this._delegate("setMediaLength",[e]),this.media.setLength(e)):c.error("setMediaLength: Length should be set to zero prior to passing the media object to Echo for live media"):c.error("setMediaLength: Must call setMedia first"),this},g.prototype.setMediaBitrate=function(){},g.prototype.setMediaCodec=function(){},g.prototype.setMediaCDN=function(){},g.prototype.setEssSuccess=function(e){this.addLabel(s.ESS_SUCCESS,e?"true":"false")},g.prototype.setEssError=function(e,t){this.addLabel(s.ESS_ERROR,e.toString().toLowerCase()),e.toString()===h.EssError.STATUS_CODE.toString()&&this.addLabel(s.ESS_STATUS_CODE,t),this._delegate("liveEnrichmentFailed")},g.prototype._avEventsEnabled=function(){return u.assert(Boolean(this.media),"setMedia() must be called prior to this method",!0)&&u.assert(Boolean(this._playerDelegate),"setPlayerDelegate not called or not configured correctly",!0)},g.prototype.getLiveBroker=function(){return this._liveBroker},g.prototype._initLiveBroker=function(){this._avEventsEnabled()&&this.media.getMediaConsumptionMode()===h.MediaConsumptionMode.LIVE&&(this._liveBroker=new n(this._playerDelegate,this.media,this,this._env,this._essEnabled),this._delegate("setBroker",[this._liveBroker]))},g.prototype.getOnDemandBroker=function(){return this._onDemandBroker},g.prototype._initOnDemandBroker=function(){this._avEventsEnabled()&&this.media.getMediaConsumptionMode()!==h.MediaConsumptionMode.LIVE&&(this._onDemandBroker=new a(this._playerDelegate,this.media,this),this._delegate("setBroker",[this._onDemandBroker]))},g.prototype._cleanPosition=function(e){return e=void 0===(e=null!=e?Math.floor(e):e)||isNaN(e)||!isFinite(e)||e<0?0:e},g.prototype.avPlayEvent=function(e,t){if(this._eventsEnabled()&&this._avEventsEnabled()){var i=this.media.isLive();if(this._isPlaying=!0,i&&this._liveBroker)e=this._liveBroker.getPosition(),this._liveBroker.start();else if(!i&&this._onDemandBroker){if(e=this._cleanPosition(e),this._previousPlayPosition=e,this._positionExceedsMediaLength(e))return;this._onDemandBroker.setPosition(e),this._onDemandBroker.start()}return i&&this.media.isEssEnriched()&&this._suppressingPlayEvent?this._suppressedPlayEventLabels=t:(this._delegate("avPlayEvent",[e,g.LabelCleanser.cleanLabels(t)]),this.media.setBuffering(!1),this.media.setPlaying(!0)),this.consumers[g.Consumers.COMSCORE]&&(this.state.comscoreEventSent=!0),this}},g.prototype._avNavigationEvent=function(e,t,i,n){this._avEventsEnabled()&&(this._isPlaying=!1,this.media.isLive()?(this._liveBroker&&(this._liveBroker.stop(),t=this._liveBroker.getPosition()),this.media.isEssEnriched()&&!this._suppressingPlayEvent&&(this._suppressingPlayEvent=!0)):this._onDemandBroker&&(t=this._cleanPosition(t),t=this._preventPositionExceedingMediaLength(t),this._onDemandBroker.stop()),"avRewindEvent"===e||"avFastForwardEvent"===e?this._delegate(e,[t,n,g.LabelCleanser.cleanLabels(i)]):this._delegate(e,[t,g.LabelCleanser.cleanLabels(i)]))},g.prototype.avPauseEvent=function(e,t){if(this._eventsEnabled()&&this._avEventsEnabled())return this.media.setPlaying(!1),this._avNavigationEvent("avPauseEvent",e,t),this},g.prototype.avBufferEvent=function(e,t){if(this._eventsEnabled()&&this._avEventsEnabled()&&this.media.getPlaying())return this.media.setPlaying(!1),this._avNavigationEvent("avBufferEvent",e,t),this.media.setBuffering(!0),this},g.prototype.avEndEvent=function(e,t){if(this._eventsEnabled()&&this._avEventsEnabled())return this.media.setPlaying(!1),this._avNavigationEvent("avEndEvent",e,t),this.media=null,this},g.prototype.avRewindEvent=function(e,t,i){if(this._eventsEnabled()&&this._avEventsEnabled())return this._avNavigationEvent("avRewindEvent",e,i,t),this},g.prototype.avFastForwardEvent=function(e,t,i){if(this._eventsEnabled()&&this._avEventsEnabled())return this._avNavigationEvent("avFastForwardEvent",e,i,t),this},g.prototype.avSeekEvent=function(e,t){if(this._eventsEnabled()&&this._avEventsEnabled())return this._avNavigationEvent("avSeekEvent",e,t),this},g.prototype.avUserActionEvent=function(e,t,i,n){if(this._eventsEnabled()&&this._avEventsEnabled()){i=this._liveBroker?this._liveBroker.getPosition():(i=this._cleanPosition(i),this._preventPositionExceedingMediaLength(i));n=g.LabelCleanser.cleanLabels(n);return this._delegate("avUserActionEvent",[e,t,i,n]),this}},g.prototype.releaseSuppressedPlay=function(){if(this._eventsEnabled()&&this._avEventsEnabled())return this._suppressingPlayEvent&&(this._suppressingPlayEvent=!1,this.avPlayEvent(this._liveBroker.getPosition(),this._suppressedPlayEventLabels)),this},g.prototype._clearMedia=function(){this.removeLabel(s.MEDIA_TIMESTAMP),this.removeLabel(s.ESS_ENABLED),this.removeLabel(s.ESS_ENRICHED),this.removeLabel(s.ESS_SUCCESS),this.removeLabel(s.ESS_ERROR),this.removeLabel(s.ESS_STATUS_CODE),null!==this.media&&(this.media=null),this._liveBroker instanceof n&&(this._liveBroker.stop(),this._liveBroker=null),this._onDemandBroker instanceof a&&(this._onDemandBroker.stop(),this._onDemandBroker=null),this._isPlaying=void 0,this._previousPlayPosition=void 0},g.prototype._positionExceedsMediaLength=function(e){return!!(this.media&&0<this.media.length&&e>=this.media.length-1e3)},g.prototype._preventPositionExceedingMediaLength=function(e){return this._positionExceedsMediaLength(e)?this.media.length:e},g.Consumers={COMSCORE:1,BARB:2,ATI:4},g}.call(t,m,t,e))||(e.exports=t)},function(e,t,i){var i=[i(16),i(7),i(17),i(18)];void 0===(i=function(o,s,a){"use strict";var c="no-broadcast";function e(e,t,i,n,r){this._playerDelegate=e,this._playhead=new o,this._isStarted=!1,this._interval=null,this._echoClient=i,this._broadcast=c,this._playerDelegateTimestamp=0,this._previousPosition=0,this._playingTime=0,this._media=t,this._environment=n,this._essEnabled=r,this._hb3NotSentYet=!0,this._hb5NotSentYet=!0,this._isRecievingPlayerTimestamp=!1,this._updateTime=0,this._essEnabled&&(this._schedule=new a(t,n,i))}return e.prototype.start=function(){var e=this;this._isStarted||(this._interval=setInterval(function(){e._update()},1e3),this._isStarted=!0,this._isRecievingPlayerTimestamp||this._playhead.start())},e.prototype.stop=function(){clearInterval(this._interval),this._playhead.stop(),this._isStarted=!1},e.prototype._update=function(){var e=parseInt(this._playerDelegate.getTimestamp(),10),t=!1,i=!1,n=!1,r=this.getTimestamp(),o=new Date,a=(o=o.getTime())-this._updateTime;this._updateTime=o,"number"==typeof e&&0<e&&(this._isRecievingPlayerTimestamp=i=!0,this._playerDelegateTimestamp!==e&&(t=!0,this._echoClient.addLabel(s.MEDIA_TIMESTAMP,e)),o=e-r,i&&(0===this._playerDelegateTimestamp||o<0-a-1500||1500+a<o)&&(n=!0,this._playerDelegateTimestamp=e,this._playingTime+=this._playhead.getPosition(),this._restartPlayhead(),r=this.getTimestamp())),n||(0!==this._playerDelegateTimestamp&&!t||this._isRecievingPlayerTimestamp&&!i?this._playhead.stop():this._playhead.start()),this._updateSchedule(r)?(this._playingTime=0,this._playerDelegateTimestamp=e,this._restartPlayhead(),this._hb3NotSentYet=!0,this._hb5NotSentYet=!0):t&&this._echoClient.releaseSuppressedPlay(),this._updateHeartbeats(),this._previousPosition=this.getPosition()},e.prototype._updateSchedule=function(e){var t,i,n,r=!1;return this._essEnabled&&this._schedule.hasData()&&0<e&&(t=this._schedule.getBroadcast(e),(i=this._media.getClone()).setServiceId(this._schedule.serviceId),t||this._broadcast===c?!t||this._broadcast!==c&&t.version.id===this._broadcast.version.id||(e=(e=(this._broadcast=t).published_time).end-e.start,i.setEssEnriched(!0),i.setVersionId(t.version.id),i.setLength(e),t.masterbrand&&t.masterbrand.id&&(n=t.masterbrand.id),i.setProducerByMasterbrand(n),t.episode&&t.episode.id&&i.setEpisodeId(t.episode.id),this._updateMedia(i),r=!0):(this._broadcast=c,this._updateMedia(i),r=!0)),r},e.prototype._updateHeartbeats=function(){var e,t;this._broadcast!==c&&(this._hb3NotSentYet||this._hb5NotSentYet)&&(e=this._playingTime+this._playhead.getPosition(),t=this.getPosition(),3e3<=e&&this._hb3NotSentYet&&(this._echoClient.avUserActionEvent("echo_hb","echo_hb_3",t),this._hb3NotSentYet=!1),5e3<=e&&this._hb5NotSentYet&&(this._echoClient.avUserActionEvent("echo_hb","echo_hb_5",t),this._hb5NotSentYet=!1))},e.prototype._updateMedia=function(e){var t=this.getPosition();this._echoClient.liveMediaUpdate(e,t,this._previousPosition),this._previousPosition=t},e.prototype._restartPlayhead=function(){this._playhead.reset(),this._playhead.start()},e.prototype.getPosition=function(){return this._broadcast&&this._broadcast!==c?this._playerDelegateTimestamp-this._broadcast.published_time.start+this._playhead.getPosition():this._playhead.getPosition()},e.prototype.getTimestamp=function(){return this._playerDelegateTimestamp+this._playhead.getPosition()},e}.apply(t,i))||(e.exports=i)},function(e,t,i){var i=[i(16)];void 0===(i=function(n){"use strict";function e(e,t,i){this._playerDelegate=e,this._media=t,this._echoClient=i,this._playhead=new n,this._isStarted=!1,this._interval=null,this._playerDelegatePosition=0,this._playingTime=0,this._currentIntervalMaxPosition=0,this._hb3NotSentYet=!0,this._hb5NotSentYet=!0,this._previousPlayingTime=0}return e.prototype.setPlayhead=function(e){this._playhead=e},e.prototype.start=function(){var e=this;this._isStarted||(this._interval=setInterval(function(){e._update()},1e3),this._isStarted=!0,this._playhead.start())},e.prototype.stop=function(){clearInterval(this._interval),this._playhead.stop(),this._isStarted=!1},e.prototype.setPosition=function(e){"number"==typeof e&&0<=e&&!this.arePositionsWithinTolerance(this.getPosition(),e)&&(this._playerDelegatePosition=e,this._playingTime+=this._playhead.getPosition(),this._restartPlayhead(),this._currentIntervalMaxPosition=e)},e.prototype.getCurrentIntervalMaxPosition=function(){return this._currentIntervalMaxPosition},e.prototype._update=function(){var e=parseInt(this._playerDelegate.getPosition(),10),t=this.getPosition(),i=this._playingTime+this._playhead.getPosition(),n=Math.abs(i-(this._previousPlayingTime||i));this._previousPlayingTime=i,"number"==typeof e&&e!==this._playerDelegatePosition&&0<e&&(0!==this._playerDelegatePosition&&this.arePositionsWithinTolerance(e,t)||(this._playerDelegatePosition=e,t=this._playerDelegatePosition,this._restartPlayhead())),t>this._currentIntervalMaxPosition&&(this._currentIntervalMaxPosition=t),3e3<=i&&this._hb3NotSentYet&&n<1500&&(this._echoClient.avUserActionEvent("echo_hb","echo_hb_3",t),this._hb3NotSentYet=!1),5e3<=i&&this._hb5NotSentYet&&n<1500&&(this._echoClient.avUserActionEvent("echo_hb","echo_hb_5",t),this._hb5NotSentYet=!1),0<this._media.length&&t>=this._media.length&&this._echoClient.avPauseEvent(this._media.length,{echo_pause_at_media_length:1})},e.prototype._restartPlayhead=function(){this._playhead.reset(),this._playhead.start()},e.prototype.getPosition=function(){var e=this._playhead.getPosition();return this._playerDelegatePosition+e},e.prototype.getTimestamp=function(){return 0},e.prototype.arePositionsWithinTolerance=function(e,t){t=e-t;return-1500<=t&&t<=1500},e}.apply(t,i))||(e.exports=i)},function(e,t){var i,n,e=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(i===setTimeout)return setTimeout(t,0);if((i===r||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:r}catch(e){i=r}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var s,c=[],u=!1,l=-1;function d(){u&&s&&(u=!1,s.length?c=s.concat(c):l=-1,c.length&&h())}function h(){if(!u){var e=a(d);u=!0;for(var t=c.length;t;){for(s=c,c=[];++l<t;)s&&s[l].run();l=-1,t=c.length}s=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function _(){}e.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];c.push(new p(e,t)),1!==c.length||u||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=_,e.addListener=_,e.once=_,e.off=_,e.removeListener=_,e.removeAllListeners=_,e.emit=_,e.prependListener=_,e.prependOnceListener=_,e.listeners=function(e){return[]},e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},function(e,t){var i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){void 0===(t=function(e){"use strict";var r=i(0),o=i(2),a=i(1),t=i(13),s=i(3),c={};c[s.ECHO_ENABLED]=!0,c[s.ECHO_AUTO_START]=!0,c[s.ECHO_DEVICE_ID]=null,c[s.REPORTING_PROFILE]="PUBLIC_SERVICE",c[s.ECHO_CACHE_MODE]="NEVER",c[s.COMSCORE_ENABLED]=!1,c[s.ATI_ENABLED]=!0,c[s.BARB_ENABLED]=!1,c[s.BARB_DEBUG]=!1,c[s.BARB_SITE_CODE]="bbcdotcom",c[s.TEST_SERVICE_ENABLED]=!1,c[s.USE_ESS]=!1,c[s.ESS_HOSTNAME]="ess.api.bbci.co.uk",c[s.USE_SSC]=!1,c[s.SSC_HOSTNAME]=null;var u={};function l(e){return"string"==typeof e&&0<e.length}function d(e){return"string"==typeof e&&(e=e.toUpperCase(),o.ReportingProfiles.hasOwnProperty(e))?o.ReportingProfiles[e]:null}function h(e){return"string"==typeof e&&(e=e.toUpperCase(),o.EchoCacheMode.hasOwnProperty(e))?o.EchoCacheMode[e]:null}return u[s.ECHO_NAME]=t.NAME,u[s.ECHO_VERSION]=t.VERSION,{defaultConfig:c,fixedConfig:u,generate:function(e){var t,i=(i=(e=e||{})[s.REPORTING_PROFILE]?d(e[s.REPORTING_PROFILE]):i)||d("PUBLIC_SERVICE"),n=(n=e[s.ECHO_CACHE_MODE]?h(e[s.ECHO_CACHE_MODE]):n)||h("NEVER"),n=a.extend(c,!0,i,e||{},u);return("string"==typeof(e=(i=n)[s.ECHO_CACHE_MODE])&&(e=e.toUpperCase(),o.EchoCacheMode.hasOwnProperty(e))?a.assert("boolean"==typeof i[s.ECHO_ENABLED],'Config: "enabled" must be boolean, got '+i[s.ECHO_ENABLED])&&a.assert("boolean"==typeof i[s.ECHO_AUTO_START],'Config: "auto_start" must be boolean, got '+i[s.ECHO_AUTO_START])&&a.assert(null===i[s.ECHO_DEVICE_ID]||"string"==typeof i[s.ECHO_DEVICE_ID]&&i[s.ECHO_DEVICE_ID].length,"ECHO.DEVICE_ID must be an non-empty string"):(r.error("Config Error: KEYS.ECHO_CACHE_MODE Invalid cache mode specified"),0))&&function(e){if(!1===e[s.COMSCORE_ENABLED])return 1;if(!l(e[s.REPORTING_PROFILE])){if(!l(e[s.COMSCORE_HOST]))return r.error("Config Error: Must have config value for COMSCORE_HOST or REPORTING_PROFILE"),0;if("scorecardresearch.com"!==e[s.COMSCORE_HOST]&&"sa.bbc.co.uk"!==e[s.COMSCORE_HOST])return r.error("Config Error: KEYS.COMSCORE_HOST Should be one of scorecardresearch.com or sa.bbc.co.uk"),0}return"string"==typeof(t=e[s.REPORTING_PROFILE])&&(t=t.toUpperCase(),o.ReportingProfiles.hasOwnProperty(t))?a.assert("boolean"==typeof e[s.COMSCORE_ENABLED],'ComScore config: "ENABLED" must be boolean'):(r.error("Config Error: KEYS.REPORTING_PROFILE Invalid reporting profile specified"),0);var t}(n)&&(!1===(t=n)[s.BARB_ENABLED]||(l(t[s.BARB_SITE_CODE])?t[s.BARB_SITE_CODE].match(/[a-zA-Z]+/)?"boolean"==typeof t[s.BARB_DEBUG]||(r.error("Config Error: KEYS.BARB_DEBUG must be a boolean"),0):(r.error("Config Error: KEYS.BARB_SITE_CODE must match [a-zA-Z]"),0):(r.error("Config Error: KEYS.BARB_SITE_CODE must have a value"),0)))&&(t=n[s.SSC_HOSTNAME],"boolean"!=typeof n[s.USE_SSC]?(r.error("Config Error: KEYS.USE_SSC must be boolean"),0):null===t||".com"===t||".co.uk"===t||(r.error("Config Error: SSC_HOSTNAME must be one of .com, .co.uk or null"),0))?n:null}}}.call(t,i,t,e))||(e.exports=t)},function(e,t,a){void 0===(t=function(e){"use strict";var h=a(7),p=a(3),_=a(8),f=a(1),r=a(36),E=a(2),g="invalid-data",t=a(37),m=a(9),T="sa.bbc.co.uk/bbc",C="scorecardresearch.com",I=[E.ApplicationType.WEB,E.ApplicationType.MOBILE_WEB,E.ApplicationType.RESPONSIVE],i=[h.NO_COOKIES];function n(){return-1}function v(e,t,i,n){var r,o,a,s,c,u,l,d;i[p.COMSCORE_SITE];this._deviceId=null,this._broker=null,this.media=null,this._clips=[],this._isEnabled=!0,this._hasStartedAppTag=!1,this._hasCreatedAsset=!1,this._storedAssetLabels={},a=i[p.COMSCORE_HOST],c=i[p.COMSCORE_SITE],this.useSsc=!0===i[p.USE_SSC]&&"sa.bbc.co.uk"!==a,this._deviceId=i[p.ECHO_DEVICE_ID]||void 0,!0!==this.useSsc||this._deviceId||(s=v._createSscHelper({forceBBCHost:i[p.SSC_HOSTNAME]}),this._deviceId=s.getCookieId()),f.containsValue(E.ApplicationType,t)||(t=g),u=a,l=n.getProtocol(),d=c,l=u===C?l+"//"+("https:"===l?"s":"")+"b."+C+"/p?":l+"//"+T+"/"+d+"/s",!0!==this.useSsc||this._deviceId||(l=s.getLocation().protocol+"//"+s.getSSCHostname()),!0===i[p.TEST_SERVICE_ENABLED]&&(o=l,l=i[p.TEST_SERVICE_URL]+"/comscore",this._isUsingComscoreOTTLibrary&&(r=i[p.TEST_SERVICE_URL]+"/offline")),this._isApp=!f.containsValue(I,t),d=n.getHttpGet(),s=a===C,this._isUsingComscoreOTTLibrary=!(!v.AppTag||!v.AppTag.ns_),this._isUsingComscoreOTTLibrary?(this.appTag=v.AppTag.ns_.comScore,this.appTag.setPlatformAPI(v.AppTag.ns_.PlatformAPIs.html5),d&&(this.appTag.getPlatformAPI().httpGet=d),this.appTag.setPublisherSecret(i[p.COMSCORE_PUBLISHER_SECRET]),this.appTag.setAppContext()):this.appTag=new v.AppTag(d||_._defaultHttpGet,this._isApp,s),s&&(this.appTag.setCustomerC2(i[p.COMSCORE_CUSTOMER_ID]),this.addLabel(h.COMSCORE_C1,"2"),this.addLabel(h.COMSCORE_SITE,c)),this.appTag.setPixelURL(l),this._deviceId?this.addLabel(h.DEVICE_ID,this._deviceId):this.useSsc||"sa.bbc.co.uk"!==a||(this._deviceId=m.getCookieValueByName("s1")),!0===i[p.TEST_SERVICE_ENABLED]&&(this.addLabel(h.COMSCORE_ENDPOINT,o),this._isUsingComscoreOTTLibrary&&this.appTag.setOfflineURL(r)),this.addLabel(h.BBC_APPLICATION_NAME,e),this.addLabel(h.BBC_APPLICATION_TYPE,t),this.setCacheMode(i[p.ECHO_CACHE_MODE]),this.addLabel(h.BBC_MEASUREMENT_LIB_NAME,i[p.ECHO_NAME]),this.addLabel(h.BBC_MEASUREMENT_LIB_VERSION,i[p.ECHO_VERSION]),this._isApp?(this._isUsingComscoreOTTLibrary?this.appTag.setAppName(e):this.addLabel(h.APP_NAME,e),this.addLabel(h.APP_PLATFORM_NAME,n.getPlatformName()),this.addLabel(h.APP_PLATFORM_RUNTIME,n.getPlatformRuntimeEnvironment()),this.addLabel(h.APP_OS_VERSION,n.getPlatformOSVersion()),this.addLabel(h.APP_DEVICE_NAME,n.getDeviceName()),this.addLabel(h.APP_SCREEN_RESOLUTION,n.getScreenResolution()),this.addLabel(h.APP_LANGUAGE,n.getLanguage())):this.addLabel(h.WEB_SCREEN_RES,n.getScreenResolution()),this.addLabel(h.ENV_CHAR_SET,n.getCharSet()),this.addLabel(h.ENV_TITLE,n.getTitle()),this.addLabel(h.ENV_REFERRER,n.getReferrer()),-1===n.getURL().indexOf("file:",0)&&this.addLabel(h.ENV_URL,n.getURL()),i[p.ECHO_TRACE]&&this.setTraceId(i[p.ECHO_TRACE]),(n=_.getOrbCookiesPolicy())&&(n="ad"+(n.ads?"1":"0")+"ps"+(n.personalisation?"1":"0")+"pf"+(n.performance?"1":"0"),this.addLabel(h.COOKIE_POLICY,n)),this.addLabel(E.ManagedLabels.BBC_SITE,g),this._mediaIsLive=null,i&&!1===i[p.ECHO_ENABLED]?this._isEnabled=!1:this._isEnabled=!0}v.prototype.start=function(){this._isEnabled&&!this._hasStartedAppTag&&(this.appTag.start(),this._hasStartedAppTag=!0)},v.prototype.enable=function(){this._isEnabled||(this._isEnabled=!0)},v.prototype.disable=function(){this._isEnabled&&(this.clearMedia(),this._isEnabled=!1)},v.prototype.getDeviceId=function(){return this._deviceId},v.prototype._buildStreamSenseClip=function(e){},v.prototype.setTraceId=function(e){this.addLabel(p.ECHO_TRACE,e)},v._createSscHelper=function(e){return new t(e||{})},v.AppTag=a(38);var o="<"+i.join("><")+">";return v.prototype._isExcludedLabel=function(e){return!0===this.useSsc&&!!o.match(new RegExp("<"+e+">"))},v.prototype.addLabels=function(e){this.addProperties(e)},v.prototype.addProperties=function(e){if("object"==typeof e)for(var t in e)e.hasOwnProperty(t)&&this.addProperty(t,e[t])},v.prototype.addCampaignProperties=n,v.prototype.addLabel=function(e,t){this.addProperty(e,t)},v.prototype.addProperty=function(e,t){!0!==this._isExcludedLabel(e)&&this.appTag.setLabel(e,t)},v.prototype.addManagedLabel=function(e,t){var i,n=r.isValidManagedLabel(e,t)?t:g;for(i in E.ManagedLabels)E.ManagedLabels[i]===e&&this.addLabel(e,n)},v.prototype.removeLabels=function(e){this.removeProperties(e)},v.prototype.removeProperties=function(e){for(var t=0,i=e.length;t<i;t++)this.removeProperty(e[t])},v.prototype.removeLabel=function(e){this.removeProperty(e)},v.prototype.removeProperty=function(e){this.appTag.setLabel(e,null)},v.prototype.setLoggedInToBBCId=function(e){this.addLabel(h.BBC_ID_LOGGED_IN,"1"),e&&0<e.length?this.addManagedLabel(E.ManagedLabels.BBC_HASHED_ID,e):this.removeLabel(E.ManagedLabels.BBC_HASHED_ID)},v.prototype.setLoggedOutOfBBCId=function(){this.removeLabels([h.BBC_ID_LOGGED_IN,E.ManagedLabels.BBC_HASHED_ID])},v.prototype.setAppVersion=function(e){"function"==typeof this.appTag.setAppVersion?this.appTag.setAppVersion(e):e&&this._isApp?this.addLabel(h.APP_VERSION,e.toString()):e&&this.addLabel(h.BBC_APPLICATION_VERSION,e.toString())},v.prototype.setCounterName=function(e){this._isEnabled&&this.addLabel(h.BBC_COUNTER_NAME,e)},v.prototype.setDestination=function(e){this.addLabel(h.DESTINATION,e)},v.prototype.setProducer=function(e){this.addLabel(h.PRODUCER,e)},v.prototype.setContentLanguage=function(e){this.addLabel(h.BBC_LANGUAGE,e)},v.prototype.setCacheMode=function(e){if(this._isUsingComscoreOTTLibrary&&e!==this._cacheMode){switch(e){case E.EchoCacheMode.ALL:this.appTag.allowLiveTransmission(this.appTag.TransmissionMode.NEVER),this.appTag.allowOfflineTransmission(this.appTag.TransmissionMode.NEVER);break;case E.EchoCacheMode.OFFLINE:this.appTag.allowLiveTransmission(this.appTag.TransmissionMode.DEFAULT),this.appTag.allowOfflineTransmission(this.appTag.TransmissionMode.DEFAULT)}this._cacheMode=e}},v.prototype.flushCache=function(){this._isUsingComscoreOTTLibrary&&this.appTag.flushCache()},v.prototype.clearCache=n,v.prototype.viewEvent=function(e,t){this._eventsEnabled()&&(this.addLabel(h.BBC_COUNTER_NAME,e),(t=f.extend(t,!0,h.ECHO_EVENT_NAME,"view")).name=e,this.appTag.view(t))},v.prototype.errorEvent=n,v.prototype.userActionEvent=function(e,t,i){this._eventsEnabled()&&(t=f.extend(i,!0,h.USER_ACTION_TYPE,e,h.USER_ACTION_NAME,t,h.ECHO_EVENT_NAME,"userAct"),this.appTag.hidden(t))},v.prototype.setPlayerName=function(e){},v.prototype.setPlayerVersion=function(e){},v.prototype.setPlayerIsPopped=function(e){},v.prototype.setPlayerWindowState=function(e){},v.prototype.setPlayerVolume=function(e){},v.prototype.setPlayerIsSubtitled=function(e){},v.prototype.setBroker=function(e){return this._broker=e,this},v.prototype.setMedia=function(e){},v.prototype.liveMediaUpdate=function(e,t,i){},v.prototype.liveEnrichmentFailed=n,v.prototype.setMediaLength=function(e){},v.prototype.avPlayEvent=function(e,t){},v.prototype.avPauseEvent=function(e,t){},v.prototype.avBufferEvent=function(e,t){},v.prototype.avEndEvent=function(e,t){},v.prototype.avRewindEvent=function(e,t,i){},v.prototype.avFastForwardEvent=function(e,t,i){},v.prototype.avSeekEvent=function(e,t){},v.prototype.avUserActionEvent=function(e,t,i,n){},v.prototype.clearMedia=function(){},v.prototype.setDeviceId=n,v.prototype.requiresLabelCleansing=function(){return!0},v.prototype._eventsEnabled=function(){return this._isEnabled&&this._hasStartedAppTag},v}.call(t,a,t,e))||(e.exports=t)},function(e,t,r){void 0===(t=function(e){"use strict";var i=r(2),n=r(1);return{isValidManagedLabel:function(e,t){switch(e){case i.ManagedLabels.IPLAYER_STATE:if("purchased"!==t&&"free"!==t)return!1;break;case i.ManagedLabels.STORE_ED_TYPE:if("archive"!==t&&"standard"!==t)return!1;break;case i.ManagedLabels.IPLAYER_AVAIL:if("avail"!==t&&"unavail"!==t&&"soon"!==t)return!1;break;case i.ManagedLabels.STORE_REFERRAL:if("iplayer"!==t&&"store"!==t)return!1;break;case i.ManagedLabels.BBC_HASHED_ID:if("string"!=typeof t||0===n.trim(t).length)return!1}return!0}}}.call(t,r,t,e))||(e.exports=t)},function(e,t,i){var n;void 0===(n="function"==typeof(n=function(){var r,o;function e(e){this.alwaysUseHttps=!0===(e=e||{}).alwaysUseHttps||!1,this.forceBBCHost=!1,this._sscCookieId=void 0,this._s1CookieId=void 0,this._uidCookieId=void 0,".co.uk"===e.forceBBCHost?this.forceBBCHost=".co.uk":".com"===e.forceBBCHost&&(this.forceBBCHost=".com")}return r="ssc.api.bbc.co.uk",o="ssc.api.bbc.com",e.prototype.getCookie=function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},e.prototype.getLocation=function(){return window.location},e.prototype.getCookieId=function(){var e,t=this.getSSCHostname(),i=this.getLocation(),n=t===r&&-1!==i.hostname.search(/bbc.co.uk$/),i=t===o&&-1!==i.hostname.search(/bbc.com$/);return(n||i)&&null==(e=this.getSSCCookieId())&&(n?e=this.getS1CookieId():i&&(e=this.getUidCookieId())),e},e.prototype.getS1CookieId=function(){return void 0===this._s1CookieValue&&(this._s1CookieValue=this.getCookie("s1")),this._s1CookieValue},e.prototype.getUidCookieId=function(){return void 0===this._uidCookieValue&&(this._uidCookieValue=this.getCookie("ckns_uid"),null===this._uidCookieValue&&(this._uidCookieValue=this.getCookie("ckpf_uid"))),this._uidCookieValue},e.prototype.getSSCCookieId=function(){return void 0===this._sscCookieValue&&(this._sscCookieValue=this.getCookie("ckns_sscid"),null===this._sscCookieValue&&(this._sscCookieValue=this.getCookie("ckpf_sscid"))),this._sscCookieValue},e.prototype.isValidId=function(e){var t=!1;return t="string"==typeof e&&-1!==e.search(/^[^(?!<>\s)]+$/)?!0:t},e.prototype.getAnalyticsLocation=function(e,t){var i,n,r;return this.getSSCHostname(),r=this.getLocation(),i={sscId:void 0},"string"!=typeof e&&(e=""),void 0!==t&&!1!==this.isValidId(t)||(t=this.getCookieId()),this.alwaysUseHttps||"https:"===r.protocol?i.protocol="https:":i.protocol="http:",n=-1!==e.search(/ns_alias=/),r=this.isValidId(t),i.hostname=n||r?this.getScorecardresearchHostname():this.getSSCHostname(),r&&(e=""===e?"?ns_alias="+t:(r=e.search(/\?/)+1,[e.slice(0,r),"ns_alias="+t+"&",e.slice(r)].join("")),i.sscId=t),i.search=e,-1!==i.hostname.search(/scorecardresearch.com$/)?i.pathname="/p":i.pathname="/",i.href=i.protocol+"//"+i.hostname+i.pathname+i.search,i},e.prototype.getSSCHostname=function(){var e=this.getLocation();return".com"===this.forceBBCHost||".co.uk"!==this.forceBBCHost&&-1===e.hostname.search(/bbc\.co\.uk$/)?o:r},e.prototype.getScorecardresearchHostname=function(){return"https:"===this.getLocation().protocol?"sb.scorecardresearch.com":"b.scorecardresearch.com"},e})?n.call(t,i,t,e):n)||(e.exports=n)},function(e,t,i){var i=[i(7)];void 0===(i=function(r){"use strict";function n(e,t,i){this._persistantLabels={},this._urlParams="",this._cut="",this._httpGet=e,this._eventCount=0,this._isApp=t,this._isScorecardDomain=!0===i,this._hasStarted=!1}return n.IS_ECHO_APP_TAG=!0,n.URL_LIMIT=2048,n.prototype.setPixelURL=function(e){this._url=this._makeBaseUrl(e)},n.prototype.setCustomerC2=function(e){this.setLabel(r.COMSCORE_CUSTOMER,e)},n.prototype.start=function(){this._hasStarted||(this._hasStarted=!0)},n.prototype.setLabel=function(e,t){null===t?this.removeLabel(e):this._persistantLabels[e]=t},n.prototype.removeLabels=function(e){for(var t in e)void 0!==this._persistantLabels[e[t]]&&delete this._persistantLabels[e[t]]},n.prototype.removeLabel=function(e){void 0!==this._persistantLabels[e]&&delete this._persistantLabels[e]},n.prototype.view=function(e){this.send("view",e)},n.prototype.hidden=function(e){this.send("hidden",e)},n.prototype.send=function(e,t,i){var n,r=this._persistantLabels,o={};if(this._hasStarted){for(n in this._eventCount++,r)o[n]=r[n];for(n in t)o[n]=t[n];o.ns_type=e,this._isApp&&(o.ns_ap_ev=e,o.ns_ap_ec=this._eventCount),o[this._isApp?"ns_ts":"ns__t"]=+new Date,e=this._createUrl(o),this._httpGet(e,i)}},n.prototype._createUrl=function(e){var t,i=window.encodeURIComponent||escape,n=this._url;for(t in this._urlParams="",this._cut="",e.hasOwnProperty("name")&&this._addUrlParam("name",e.name),e)"name"!==t&&"ns_referrer"!==t&&this._addUrlParam(t,e[t]);return e.hasOwnProperty("ns_referrer")&&this._addUrlParam(this._isScorecardDomain?r.ENV_REFERRER:"ns_referrer",e.ns_referrer),n+=this._urlParams,this._cut.length?n+="ns_cut="+i(this._cut.replace(/&$/,"")):n=n.replace(/&$/,""),n},n.prototype._addUrlParam=function(e,t){var i=window.encodeURIComponent||escape,t=i(e)+"="+i(t)+"&";this._url.length+this._urlParams.length+t.length<n.URL_LIMIT-8?this._urlParams+=t:this._cut+=t},n.prototype._makeBaseUrl=function(e){for(var t=-1,i=e.charAt(e.length-1),n=0,r=e.length;n<r;n++)"?"===e.charAt(n)&&(t=n);return-1===t?e+="?":"?"!==i&&"&"!==i&&(e+="&"),e},n}.apply(t,i))||(e.exports=i)},function(e,t,c){void 0===(t=function(e){"use strict";var n=c(40),r=c(3),t=c(0),i=c(2),o=c(41);function a(){return-1}function s(e,t,i,n){this._sensors=null,this._broker=null,this._media=null,this._meta={},this._stream=null,this._env=n,this._siteCode=i[r.BARB_SITE_CODE],this._debug=i[r.BARB_DEBUG],this._traceId=null,this._isPlaying=!1,this._isEssEnabled=!1,this._isEnabled=!0,this._hasStarted=!1,i[r.ECHO_TRACE]&&this.setTraceId(i[r.ECHO_TRACE]),i[r.USE_ESS]&&(this._isEssEnabled=!0),i&&!1===i[r.ECHO_ENABLED]?this._isEnabled=!1:this._isEnabled=!0}return s.prototype.start=function(){this._hasStarted||(this._hasStarted=!0)},s.prototype.enable=function(){this._isEnabled||(this._isEnabled=!0)},s.prototype.disable=function(){this._isEnabled&&(this._isEnabled=!1,this.clearMedia())},s.prototype.setTraceId=function(e){this._traceId=e},s.SpringStreams=c(42),s.prototype.addLabels=a,s.prototype.addLabel=a,s.prototype.addProperties=a,s.prototype.addCampaignProperties=a,s.prototype.addProperty=a,s.prototype.addManagedLabel=a,s.prototype.removeLabels=a,s.prototype.removeLabel=a,s.prototype.removeProperties=a,s.prototype.removeProperty=a,s.prototype.setLoggedInToBBCId=a,s.prototype.setLoggedOutOfBBCId=a,s.prototype.setAppVersion=a,s.prototype.setCounterName=a,s.prototype.setContentLanguage=a,s.prototype.setCacheMode=a,s.prototype.clearCache=a,s.prototype.flushCache=a,s.prototype.setESSEnabled=a,s.prototype.viewEvent=a,s.prototype.errorEvent=a,s.prototype.userActionEvent=a,s.prototype.setPlayerName=function(e){this._meta[n.PLAYER_DESC]=e},s.prototype.setPlayerVersion=function(e){this._meta[n.PLAYER_VERSION]=e},s.prototype.setPlayerIsPopped=a,s.prototype.setPlayerWindowState=a,s.prototype.setPlayerVolume=a,s.prototype.setPlayerIsSubtitled=a,s.prototype.setDestination=a,s.prototype.setProducer=a,s.prototype.setBroker=function(e){return this._broker=e,this},s.prototype.setMedia=function(e){this._eventsEnabled()&&(this.clearMedia(),this._media=e.getClone())},s.prototype.setMediaLength=function(e){this._media.setLength(e)},s.prototype.liveMediaUpdate=function(e){this._media=e.getClone(),this._isPlaying&&this._startTracking()},s.prototype.liveEnrichmentFailed=function(){this._media.getServiceId()||this._media.setServiceId("no-service-id-found"),this._isPlaying&&this._startTracking()},s.prototype.avPlayEvent=function(e,t){this._eventsEnabled()&&this.isValidMedia()&&this._broker&&(this._initSensors(),this._isPlaying=!0,this._media.isLive()&&!this._media.getServiceId()?this._isEssEnabled&&(this._media.getVersionId()||this._media.getVpId())||(this._media.setServiceId("invalid-data"),this._startTracking()):this._startTracking())},s.prototype._initSensors=function(){var e;null===this._sensors&&(this._sensors=new s.SpringStreams(this._siteCode),null!==this._env.getSetLocalStorageItem()&&null!==this._env.getGetLocalStorageItem()&&null!==this._env.getHttpGet()&&(t.info("Using custom PageContext for BARB"),e=new o("com.kma.springstreams",this._env),this._sensors.setPageContext(e)),this._debug&&(this._sensors.debug=function(e){t.info("Spring DEBUG: "+e)}))},s.prototype._startTracking=function(){var e,t;null===this._stream&&(t=(e=this._getAttributes())[n.PID]||" ",this._stream=this._sensors.track(t,e,this._getAdaptor()))},s.prototype._getMostPrecedentIdObject=function(){var e=this._media.getVersionIdObject(),t=this._media.getEpisodeIdObject(),i=this._media.getClipIdObject(),n=this._media.getVpIdObject(),r=this._media.getServiceIdObject();return e.isValueValid()?e:t.isValueValid()?t:i.isValueValid()?i:n.isValueValid()?n:r.isValueValid()?r:null},s.prototype._getAttributes=function(){var e,t=this._media,i={};return this._traceId&&(i[r.ECHO_TRACE]=this._traceId),t.isLive()||null!==(e=this._getMostPrecedentIdObject())&&(i[n.PID]=e.getValue()),t.isOnDemand()?i[n.STREAM]="od":t.isDownload()?i[n.STREAM]="dwn":t.isLive()&&t.getServiceIdObject().isValueValid()&&(i[n.STREAM]="live/"+t.getServiceId()),i},s.prototype._getAdaptor=function(){var i=this,t=this._media.isLive()?function(){return i._broker.getTimestamp()}:function(){return i._broker.getPosition()};return{getMeta:function(e){return i._meta},getDuration:function(e){var t=0;return t=!i._media.isLive()?Math.floor(i._media.getLength()/1e3):t},getPosition:function(e){return Math.floor(t()/1e3)}}},s.prototype._eventsEnabled=function(){return this._isEnabled&&this._hasStarted},s.prototype.avPauseEvent=function(){},s.prototype.avBufferEvent=function(){},s.prototype.avEndEvent=function(){this._eventsEnabled()&&(this._isPlaying=!1,this.isValidMedia()&&this.clearMedia())},s.prototype.avRewindEvent=function(){},s.prototype.avFastForwardEvent=function(){},s.prototype.avSeekEvent=function(){},s.prototype.avUserActionEvent=a,s.prototype.clearMedia=function(){this.isValidMedia()&&(this._stream&&this._stream.stop(),this._stream=null,this._media=null)},s.prototype.isValidMedia=function(){return null!==this._media&&this._media.avType===i.AvType.VIDEO},s.prototype.isValidLiveMedia=function(){return this.isValidMedia()&&this._media.isLive()},s.prototype.setDeviceId=a,s.prototype.requiresLabelCleansing=function(){return!0},s}.call(t,c,t,e))||(e.exports=t)},function(e,t,i){e.exports={STREAM:"stream",PID:"cq",WIDTH:"sx",HEIGHT:"sy",PLAYER_DESC:"pl",PLAYER_VERSION:"plv"}},function(e,t,i){void 0===(t=function(){"use strict";function e(e,t){this.namespace=e,this.env=t}return e.prototype.preloadImage=function(e){return this.env.getHttpGet()(e)},e.prototype.getLocalStorageItem=function(e){return this.env.getGetLocalStorageItem()(e)},e.prototype.setLocalStorageItem=function(e,t){return this.env.getSetLocalStorageItem()(e,t)},e.prototype.getWindowLocationURL=function(){return this.env.getURL()},e}.call(t,i,t,e))||(e.exports=t)},function(e,t,i){void 0===(t=function(){function e(e){this.namespace="com.kantarmedia.sensors.javascript",this.version="2.4.0";var r="2cnt.net",i="default",n=new Array;this.namespace="com.kma.springstreams",this.syncrate=20,this.pausesync=6,this.maxstates=50;var o=!0;this.nextuid="";var a,c={"+":"%2B",",":"%2C",";":"%3B","=":"%3D","~":"%7E","*":"%2A","'":"%27","!":"%21","(":"%28",")":"%29"},A=this;function t(e){for(var t=0;t<n.length;++t)try{n[t].update(e)}catch(e){O(e)}}function s(e){for(var t=0;t<n.length;++t)try{n[t].sync()}catch(e){O(e)}}function O(e){u("",e)}function u(e,t){(o=void 0!==A.pageContext.tracking?A.pageContext.tracking:o)&&(void 0===t.stream||""==t.stream?(console.warn("Stream is mandatory for measurement"),A.debug("Stream is mandatory for measurement")):(t=(void 0!==A.pageContext.getWindowLocationURL()&&"https"===A.pageContext.getWindowLocationURL().slice(0,5)?"https://ssl-":"http://")+(t&&void 0!==t.site?t.site:i)+"."+r+"/j0="+function e(t){var i,n,r,o,a,s=/[+&,;=~!*'()]/g;switch(typeof t){case"string":return s.test(t)?encodeURIComponent(t).replace(s,function(e){return c[e]||e}):encodeURIComponent(t);case"number":return isFinite(t)?t.toString():"null";case"boolean":case"null":return t.toString();case"object":if(!t)return"null";if(i=[],"number"==typeof t.length&&!t.propertyIsEnumerable("length")){for(o=t.length,n=0;n<o;n+=1)i.push(e(t[n])||"null");return","+i.join("+")+";"}for(r in t)"string"==typeof r&&"site"!==r&&(a=e(t[r]))&&i.push(e(r)+"="+a);return","+i.join("+")+";"}return""}([[e,t]])+"?lt="+(new Date).getTime().toString(36)+function(){if(!A.nlso)try{var e,t="i00";if(void 0!==A.pageContext.getUniqueId&&(t=r),e=A.pageContext.getLocalStorageItem(t))return"&c="+e;var i="0000"+Math.ceil((new Date).getTime()/1e3).toString(16)+(32768|65535*Math.random()).toString(16)+"0000";A.pageContext.setLocalStorageItem(t,i)}catch(e){console.log("error"+e)}return""}(),A.pageContext.preloadImage(t),A.debug(t)))}function l(e,t,i,n){var r,o="",o=e.getNextUID();e.nextuid=null,""==o&&(r=Math.round(1e10*Math.random()).toString(36),o=(new Date).getTime().toString(36)+r);var a,s,c,u,l,d,h,p,_=Math.round((new Date).getTime()/1e3),f=[0,0,_.toString(36)],E=0,g=0,m=!0,T=!1,C=0;function I(e){e=f=[e,e,Math.round((new Date).getTime()/1e3).toString(36)];c.length<a.maxstates&&c.push(e),m=!0,E=0}function v(){null!=h&&p<h.length&&(d=h[p++],a.debug("switch syncrate to "+d))}function S(){void 0!==A.pageContext.getSerialNumber?A.pageContext.getSerialNumber(y):y()}function y(){if(m){try{s.width&&(u.sx=s.width),s.videoWidth&&(u.sx=s.videoWidth),s.height&&(u.sy=s.height),s.videoHeight&&(u.sy=s.videoHeight)}catch(e){}var e;void 0!==A.pageContext.getUniqueId&&(u.psid=A.pageContext.getUniqueId()),u.uid=o,u.pst=c;try{u.dur&&0!==u.dur||(u.dur=l.getDuration(s))}catch(e){}try{e=l.getMeta(s),void 0!==A.pageContext.getDeviceID&&void 0!==A.pageContext.getDeviceID()&&(e[A.pageContext.getDeviceID().id_name]=A.pageContext.getDeviceID().id_value)}catch(e){}u.vt=Math.round((new Date).getTime()/1e3)-_,e.v="js "+A.version,"undefined"!=typeof PageContext&&void 0!==PageContext.prototype.addElectronParameters&&(PageContext.prototype.addElectronParameters(u),e.v="E "+A.version),l.isCasting&&1==l.isCasting()&&(e.v="C "+A.version),a.send(e,u),g=f[1]}m=!1}a=e,s=t,l=n||a.HTML5Adapter,u=function(e){var t,i=new Object;for(t in e)i[t]=e[t];return i}(i),(c=new Array).push(f),p=0,d=e.syncrate,h=e.getSyncRates(),v(),this.update=function(e){if(!T){var t,i=f[1],n=i;try{n=Math.round(l.getPosition(s))}catch(e){}try{if(i===n)return void(0<=E&&++E===a.pausesync&&(m=!0));E>=a.pausesync?I(n):i<n-1||n<i?(t=n,setTimeout(function(){t==Math.round(l.getPosition(s))||t+1==Math.round(l.getPosition(s))?5<=++C&&(C=0,(1<t-f[1]||1<f[1]-t)&&I(t)):C=0},1e3)):(f[1]=n,f[1]-f[0]>=d&&d<=n-g&&(m=!0,v()),E=0)}catch(e){O=!0,a.error(e)}}},this.stop=function(){T||(T=m=!0,S())},this.sync=S}!function(e){var t,i,n;for(i in e,e)i===r&&(t=e[i]);t&&(n=t.syncrates)&&(a=n)}({"2cnt.net":{syncrates:[3,7,10,10,10,10,10,60]}}),e&&(i=e),setInterval(t,200),setInterval(s,2e3),this.getSyncRates=function(){return a},this.track=function(e,t,i){if(void 0===A.pageContext&&(A.pageContext=A.defaultPageContext),void 0!==A.pageContext.generateId&&A.pageContext.generateId(),e){i=new l(this,e,t,i);return n.push(i),i}},this.trackWithUID=function(e,t,i,n){return n!=this.nextuid?void 0:this.track(e,t,i)},this.getNextUID=function(){var e;return""!=this.nextuid&&null!=this.nextuid||(this.nextuid=(e=Math.round(1e10*Math.random()).toString(36),(new Date).getTime().toString(36)+e)),this.nextuid},this.unload=function(){this.nextuid="";for(var e=0;e<n.length;++e)try{n[e].stop()}catch(e){O(e)}},this.doUpdate=t,this.doSync=s,this.error=O,this.debug=function(e){},this.send=u,this.defaultPageContext={getLocalStorageItem:function(e){return localStorage.getItem(e)},setLocalStorageItem:function(e,t){localStorage.setItem(e,t)},preloadImage:function(e){(new Image).src=e},getWindowLocationURL:function(){return document.location.href}},this.HTML5Adapter={getMeta:function(e){return{pl:"HTML 5 Video",plv:"HTML 5",sx:screen.width,sy:screen.height}},getPosition:function(e){return e.currentTime},getDuration:function(e){return Math.round(e.duration)}},this.DefaultAdapter={getMeta:function(e){return{pl:"DEF",plv:version,sx:screen.width,sy:screen.height}},getPosition:function(e){return(new Date).getTime()/1e3},getDuration:function(e){return 0}},this.WMStreamAdapter={getMeta:function(e){return{pl:"MSWM",plv:e.versionInfo,sx:screen.width,sy:screen.height}},getPosition:function(e){return e.CurrentPosition||e.currentPosition||(e.controls&&e.controls.currentPosition?e.controls.currentPosition:e.Controls&&e.Controls.currentPosition?e.Controls.currentPosition:0)},getDuration:function(e){return e.currentMedia?e.currentMedia.Duration||e.currentMedia.duration||void 0:e.CurrentMedia&&(e.CurrentMedia.duration||e.CurrentMedia.Duration)||void 0}},this.RVStreamAdapter={getMeta:function(e){return{pl:"RV",plv:e.GetVersionInfo(),sx:screen.width,sy:screen.height}},getPosition:function(e){return e.GetPosition()/1e3},getDuration:function(e){return e.GetLength()/1e3}}}return e.prototype.setPageContext=function(e){this.pageContext=e},e}.call(t,i,t,e))||(e.exports=t)},function(e,t,D){void 0===(t=function(e){"use strict";var t=D(44),o=D(45),i=D(20),l=D(6),a=D(3),r=D(48),d=D(49),n=D(51),s=D(52),c=D(53),u=D(10),h=D(5),p=D(15),_=D(1),f=D(12),E=D(0),g=D(4),m=D(2),T=D(8),C=D(9),I="move",v="ati-host.net",S="logw363.ati-host.net",y="logws1363.ati-host.net",A="api.bbc.co.uk",O="a1.api.bbc.co.uk",b="a1.api.bbc.co.uk",P="content_type",R="page",N="user_id";function L(){return-1}function B(e,t,i,n){this._tag=null,this._broker=null,this._media=null,this._mediaLength=null,this._commonMediaParams=null,this._env=n,this._pageValues={},this._customParams={},this._appName=e,this._appType=t,this._config=i,this._bbc_hid=null,this._lastHitUrl=null,this._lastPlayHitUrl=null,this._lastPage=null,this._counterName=null,this._orbitVars=null,this._trace=null;var r=this;setInterval(function(){r._remoteConfigManager=new p(i,r._env)},36e5),this._remoteConfigManager=this._config[a.REMOTE_CONFIG_MANAGER]||new p(i,this._env),this._deviceId=i[a.ECHO_DEVICE_ID]||void 0,!0!==i[a.ATI_DISABLE_COOKIE]||this._deviceId||(this._deviceId=o.v4()),this._deviceId||(this._deviceId=C.getCookieValueByName("idrxvr")),this._deviceId||(t=C.getCookieValueByName("atuserid"))&&(this._deviceId=JSON.parse(decodeURIComponent(t)).val),i[a.ECHO_TRACE]&&(this._trace=i[a.ECHO_TRACE]),this._isEnabled=i&&i[a.ECHO_ENABLED],i&&i[a.KEEPALIVE_DURATION]?this._keepAliveDuration=Number(i[a.KEEPALIVE_DURATION]):this._keepAliveDuration=3e5}return B.SmartTag=t,B.prototype._getHttpGetMethod=function(){return this._env.getHttpGet()||T._defaultHttpGet},B.prototype._setHTTPGetMethod=function(o){function e(e,r){var t=(i=function(t,i,n){return function(e){a._tag.emit(t,{lvl:n,details:{hit:i,event:e}}),r&&"function"==typeof r&&r(),o&&"function"==typeof o&&o()}})("Tracker:Hit:Sent:Ok",e=a._addLengthToMediaHit(e),"INFO"),i=i("Tracker:Hit:Sent:Error",e,"ERROR");n(e,t,i)}var n=this._getHttpGetMethod(),a=this;"never"===this._tag.getConfig("Offline").storageMode?this._tag.builder.sendUrl=e:this._tag.sendUrl=e},B.prototype._getDestination=function(e,t){var i;return(i=!(i=e?u.get(e[a.DESTINATION]):i)&&t?u.get(t.destination):i)||(E.warn("Destination not found, using default site"),i=u.DEFAULT),i},B.prototype._getProducer=function(e,t,i){var n,r=this._remoteConfigManager.getProducers();return!(n=!(n=!(n=this._pageValues[l.LEVEL_2_SITE]?this._pageValues[l.LEVEL_2_SITE]:n)&&e?r&&r[e[a.PRODUCER]]?r[e[a.PRODUCER]]:h.getId(e[a.PRODUCER]):n)&&t?r&&r[t.producer]?r[t.producer]:h.getId(t.producer):n)&&i&&(E.warn("Producer not found, using default producer"),n=i.defaultProducer),n},B.prototype.setDestination=function(e){e||(e=u.DEFAULT,E.warn("Destination not found, using default site instead")),e&&(this.setProducer(e.defaultProducer),this._setDomain(e.isTest),this._tag.setConfig(l.LEVEL_1_SITE,e.id))},B.prototype.setProducer=function(e){this.addLabel(l.LEVEL_2_SITE,e)},B.prototype._getCookieDomain=function(e){e=e&&e.location&&e.location.hostname&&e.location.hostname.match(/.bbc.com$/)?"bbc.com":e&&e.location&&e.location.hostname.match(/.britbox.com$/)?"britbox.com":(e&&e.location&&!e.location.hostname.match(/.bbc.co.uk$/)&&E.info("Cookie hostname is: "+e.location.hostname+" failing back to bbc.co.uk"),"bbc.co.uk");return!0===this._config[a.TEST_SERVICE_ENABLED]&&this.addProperty(l.TEST_COOKIE_DOMAIN,e),e},B.prototype._setDomain=function(e){e?(this._tag.setConfig("domain",v),this._tag.setConfig("collectDomain",S),this._tag.setConfig("collectDomainSSL",y)):(this._tag.setConfig("domain",A),this._tag.setConfig("collectDomain",O),this._tag.setConfig("collectDomainSSL",b)),this._config&&(this._config[a.ATI_COLLECT_DOMAIN]&&this._tag.setConfig("collectDomain",this._config[a.ATI_COLLECT_DOMAIN]),this._config[a.ATI_COLLECT_DOMAIN_SSL]&&this._tag.setConfig("collectDomainSSL",this._config[a.ATI_COLLECT_DOMAIN_SSL]))},B.prototype._setSection=function(e,t,i){t&&(e&&e[l.SECTION]?(t[l.CHAPTER_1]=g.cleanCustomVariable(e[l.SECTION]),t.customObject&&delete t.customObject[l.SECTION]):i&&i.section&&(t[l.CHAPTER_1]=g.cleanCustomVariable(i.section)),E.info("Setting page view chapters: "+t[l.CHAPTER_1]))},B.prototype._createAtiOptions=function(e,t){var i;if(e)switch(i={collectDomain:t.isTest?S:O,collectDomainSSL:t.isTest?y:b,disableCookie:!0===e[a.ATI_DISABLE_COOKIE],cookieDomain:!0===e[a.ATI_USE_DEFAULT_COOKIE_DOMAIN]?null:this._getCookieDomain(window),domain:t.isTest?v:A,pixelPath:e[a.ATI_PIXEL_PATH]||"/hit.xiti",secure:!1!==e[a.ATI_FORCE_HTTPS],forceHttp:!0===e[a.ATI_FORCE_HTTP],site:t.id},!0===e[a.ATI_FORCE_HTTPS]&&E.info("Forcing https for ATI is now deprecated and has no effect, https is the default protocol now"),e[a.ATI_LOG]&&(i.log=e[a.ATI_LOG]),e[a.ATI_SSL_LOG]&&(i.logSSL=e[a.ATI_SSL_LOG]),e[a.ATI_COLLECT_DOMAIN]&&(i.collectDomain=e[a.ATI_COLLECT_DOMAIN]),e[a.ATI_COLLECT_DOMAIN_SSL]&&(i.collectDomainSSL=e[a.ATI_COLLECT_DOMAIN_SSL]),e[a.ECHO_DEVICE_ID]&&(i.ClientSideUserId={clientSideMode:"required",userIdCookieDuration:397,userIdExpirationMode:"fixed"}),e[a.ECHO_CACHE_MODE]){case m.EchoCacheMode.ALL:i.Offline={storageMode:a.ATI_CACHE_MODE_ALWAYS};break;case m.EchoCacheMode.OFFLINE:i.Offline={storageMode:a.ATI_CACHE_MODE_REQUIRED};break;default:i.Offline={storageMode:a.ATI_CACHE_MODE_NEVER}}return i},B.prototype._createTag=function(e){return new B.SmartTag.Tracker.Tag(e)},B.prototype._initTag=function(e){if(!this._tag){var t,i=this._config,n=this._getDestination(i,e),n=this._createAtiOptions(i,n);for(t in this._tag=this._createTag(n),this._tag.onTrigger("Tracker:Hit:Sent:Ok",this._onHitSent.bind(this)),this._debug&&(this._tag.debug=function(e){E.info("ATI DEBUG: "+e)}),this._deviceId&&this._setSmartTagDeviceId(this._tag,this._deviceId),this._bbc_hid&&(this._tag.setParam(l.HASHED_ID,this._bbc_hid,{hitType:["all"],permanent:!0}),this._tag.setProp(N,this._bbc_hid,!0)),i&&i[a.APP_CATEGORY]&&this.addLabel(l.APP_CATEGORY,i[a.APP_CATEGORY]),this._setHTTPGetMethod(),this._counterName&&this.setCounterName(this._counterName),this._trace&&this.setTraceId(this._trace),this._customParams)this._tag.setParam(t,g.cleanCustomVariable(this._customParams[t]),{hitType:["all"],permanent:!0});i={};i[l.APP_NAME]=this._appName,i[l.APP_TYPE]=this._appType,i[l.LIBRARY_VERSION]=f.getLibraryName()+"-"+f.getLibraryVersion(),i=_.combineObjects(i,this._customParams,!1),i=_.combineObjects(i,e,!1),this.setGlobalProps(i),E.info("Initialised ATI SmartTag with options:"+JSON.stringify(n))}},B.prototype._setSmartTagDeviceId=function(e,t){e.clientSideUserId.set(t)},B.prototype.start=function(e){this._orbitVars=e,this._isEnabled&&!this._hasStarted&&(this._hasStarted=!0,this._initTag(e))},B.prototype.enable=function(){this._isEnabled||(this._isEnabled=!0)},B.prototype.disable=function(){this._isEnabled&&(this._isEnabled=!1,this.clearMedia())},B.prototype._onHitSent=function(e,t){t&&t.details&&t.details.hit&&(E.info("Did send hit: ",t.details.hit),this._setLastHitUrl(t.details.hit))},B.prototype._addLengthToMediaHit=function(e){var t;return e&&"string"==typeof e&&e.match(/a\=(play|pause|stop|info|refresh|move)/)&&this._mediaLength&&(t="m1="+Math.ceil(this._mediaLength/1e3),e=e.replace(/m1\=\d+/g,t)),e},B.prototype._setLastHitUrl=function(e){e&&"string"==typeof e&&e.match(/a\=play/)?this._lastPlayHitUrl=e:this._lastHitUrl=e},B.prototype.setTraceId=function(e){e&&this._tag&&this._tag.setParam(a.ECHO_TRACE,e,{hitType:["all"],permanent:!0})},B.prototype.addLabels=function(e){this.addProperties(e)},B.prototype.addLabel=function(e,t){this.addProperty(e,t)},B.prototype.addProperties=function(e){if("object"==typeof e)for(var t in e.bbc_identity&&(this.setBBCUser({bbc_hid:e.bbc_hid,signed_in:"1"===e.bbc_identity}),delete e.bbc_hid,delete e.bbc_identity),e)e.hasOwnProperty(t)&&this.addProperty(t,e[t])},B.prototype.addProperty=function(e,t){var i;e===l.BBC_COUNTER_NAME||e===l.LEVEL_2_SITE?this._pageValues[e]=t:this._customParams[e]=t,this._tag&&((i={})[e]=t,this.setGlobalProps(i))},B.prototype.addCampaignProperties=function(e){this._tag?e&&"object"==typeof e&&this._tag.setProps(e,!0):E.error("Cannot set campaign properties: please enable ATI and start Echo before setting campaign properties.")},B.prototype.setLoggedInToBBCId=function(e){this.setBBCUser({bbc_hid:e,signed_in:!0}),E.info("Setting BBC user with hashed ID: "+e)},B.prototype.setLoggedOutOfBBCId=function(){this._tag&&(this._tag.delParam(l.HASHED_ID),this._tag.delProp(N)),this._bbc_hid=null,E.info("Removing User ID")},B.prototype.setAppVersion=function(e){e&&this._tag&&this._tag.setParam(l.APP_VERSION,"["+e+"]",{hitType:["all"],permanent:!0})},B.prototype.setBBCUser=function(e){e.bbc_hid?this._bbc_hid=e.bbc_hid:e.signed_in&&(this._bbc_hid="unidentified-user"),this._tag&&!this._customParams.bbc_id_wait&&(this._tag.setParam(l.HASHED_ID,this._bbc_hid,{hitType:["all"],permanent:!0}),this._tag.setProp(N,this._bbc_hid,!0)),E.info("Setting BBC user with hashed ID: "+this._bbc_hid)},B.prototype.addManagedLabel=L,B.prototype.removeLabels=function(e){this.removeProperties(e)},B.prototype.removeLabel=function(e){this.removeProperty(e)},B.prototype.removeProperties=function(e){for(var t=0,i=e.length;t<i;t++)this.removeProperty(e[t])},B.prototype.removeProperty=function(e){e===l.BBC_COUNTER_NAME||e===l.LEVEL_2_SITE?delete this._pageValues[e]:(this._tag&&this._tag.delParam(e),delete this._customParams[e])},B.prototype.setCounterName=function(e){var t=this._getDestination(this._config,this._orbitVars),t=this._getProducer(this._config,this._orbitVars,t);this.setProducer(t);e={name:this._counterName=e,level2:this._pageValues[l.LEVEL_2_SITE]};this._tag&&(this._tag.setProp(R,this._counterName,!0),this._tag.page.set(e),this._lastPage=e)},B.prototype.setContentLanguage=L,B.prototype.setCacheMode=L,B.prototype.clearCache=function(){this._tag.offline.remove(),E.info("Clearing cache: this will not send cached events")},B.prototype.flushCache=function(){this._tag.offline.send(),E.info("Flushing cache: this will send cached events")},B.prototype.setESSEnabled=L,B.prototype.viewEvent=function(c,u){if(this._eventsEnabled())return this._tag.page.reset(),this.addLabel(l.BBC_COUNTER_NAME,c),this._counterName=c,this._tag.setProp(R,this._counterName,!0),i.get().then(function(e){var t=this._getDestination(this._config,e),i=this._getProducer(this._config,e,t);this.setProducer(i);var n,r,o=_.clone(this._customParams),t=d.create(this._appName,this._appType,o,u,e,document),i=_.extend(u,!0,l.ECHO_EVENT_NAME,"view"),a=_.combineObjects(o,i,!1),s={};for(n in a)"trace"!==n?_.startsWith(n,"ess_")?s[n]=a[n]:this._tag&&this._tag.setParam(n,g.cleanCustomVariable(a[n]),{hitType:["all"],permanent:!1}):(r=a[n],this.setTraceId(r));s.echo_event="view";o=_.clone(this._pageValues);o.customObject=s,t&&this._tag.customVars.set(t),this._setSection(i,o,e),this._tag.page.set(o),this._tag.dispatch(),this._lastPage=o,E.info("Sending page view event with countername: "+c)}.bind(this))},B.prototype.errorEvent=L,B.prototype.setGlobalProps=function(e){var t,i={};for(t in i[l.APP_NAME]="app_name",i[l.APP_TYPE]="app_type",i[l.CONTENT_TYPE]=P,i.contentType=P,i.counter_name=R,i[l.LIBRARY_VERSION]="library_version",e){var n=i[t];n&&this._tag.setProp(n,e[t],!0)}},B.prototype.userActionEvent=function(e,t,i){if(this._eventsEnabled()){var i=_.extend(i,!0,l.ECHO_EVENT_NAME,"userAct"),n=_.combineObjects(this._customParams,i,!1),i=_.clone(this._pageValues);if(i){i.actionName=t,i.actionType=e,i.user=this._bbc_hid,i[l.BBC_COUNTER_NAME]=this._counterName,i.customObject=n;var r,o,e=i.customObject[l.IS_BACKGROUND];for(o in!1===e||"false"===e?r=!1:Boolean(i.customObject[l.IS_BACKGROUND])?r=!0:E.info("Unknown value for is_background: "+i.customObject[l.IS_BACKGROUND]),n)this._tag&&this._tag.setParam(o,g.cleanCustomVariable(n[o]),{hitType:["all"],permanent:!0});r?(c.sendImpressionEvent(this._tag,i),E.info("Sent Background action event: "+t)):(c.sendClickEvent(this._tag,i),E.info("Sent user action event: "+t))}}},B.prototype.setPlayerName=function(e){this._mediaPlayerName=e},B.prototype.setPlayerVersion=function(e){this._mediaPlayerVersion=e},B.prototype.setPlayerIsPopped=L,B.prototype.setPlayerWindowState=L,B.prototype.setPlayerVolume=L,B.prototype.setPlayerIsSubtitled=L,B.prototype.setBroker=function(e){return this._broker=e,this},B.prototype.setMedia=function(e){this._eventsEnabled()&&(this._mediaPlayerName&&!e.getMediaPlayerName()&&e.setMediaPlayerName(this._mediaPlayerName),this._mediaPlayerVersion&&!e.getMediaPlayerVersion()&&e.setMediaPlayerVersion(this._mediaPlayerVersion),this._appName?e.appName=this._appName:e.appName="",this._appType?e.appType=this._appType:e.appType="",this.clearMedia(),this._media=e,this.addMedia(this._media))},B.prototype.setMediaLength=function(e){this._mediaLength=e,this._media.setLength(e)},B.prototype.setMediaBitrate=L,B.prototype.setMediaCodec=L,B.prototype.setMediaCDN=L,B.prototype.liveMediaUpdate=function(e,t,i){_.assert("number"==typeof t,"newPosition must be a number"),_.assert("number"==typeof i,"oldPosition must be a number"),e.setProducerById(this._media.getProducer()),this._sendMediaEvent("stop"),this._media=e,this.addMedia(this._media),this._sendMediaEvent("play")},B.prototype.liveEnrichmentFailed=L,B.prototype._getIdObjectValue=function(e){return null!==e&&e.isValueValid()?e.getValue():""},B.prototype._getMostPrecedentIdObject=function(){var e=this._media.getVersionIdObject(),t=this._media.getEpisodeIdObject(),i=this._media.getClipIdObject(),n=this._media.getVpIdObject(),r=this._media.getServiceIdObject();return e.isValueValid()?e:t.isValueValid()?t:i.isValueValid()?i:n.isValueValid()?n:r.isValueValid()?r:null},B.prototype._eventsEnabled=function(){return this._isEnabled&&this._hasStarted},B.prototype.addMedia=function(e){if(this._tag&&this._tag.richMedia){this._commonMediaParams={playerId:e.getPlayerId(),mediaLabel:this._getIdObjectValue(this._getMostPrecedentIdObject()),mediaTheme1:n.constructThemeOne(e,this._config[a.USE_ESS]),mediaTheme2:n.constructThemeTwo(e),mediaTheme3:n.constructThemeThree(e)};var t,i={mediaType:e.getAvType(),playerId:this._commonMediaParams.playerId,duration:e&&e.getLength()?Math.ceil(e.getLength()/1e3):0,mediaLabel:this._commonMediaParams.mediaLabel,mediaTheme1:this._commonMediaParams.mediaTheme1,mediaTheme2:this._commonMediaParams.mediaTheme2,mediaTheme3:this._commonMediaParams.mediaTheme3,isEmbedded:e.isEmbedded(),broadcastMode:"live"===e.getMediaConsumptionMode()?"live":"clip",refreshDuration:{0:10,1:60}};for(t in e.getProducerId()?i.mediaLevel2=e.getProducerId():i.mediaLevel2=0,this._customParams)this._tag&&this._tag.setParam(t,g.cleanCustomVariable(this._customParams[t]),{hitType:["all"],permanent:!0});this._tag.richMedia.add(i)}},B.prototype._sendMediaEvent=function(e,t){this._commonMediaParams&&s.sendEvent(this._tag,this._commonMediaParams,e,t)},B.prototype.avPlayEvent=function(e,t){this._eventsEnabled()&&!this._media.getPlaying()&&(this._media.getBuffering()?this._sendMediaEvent("info",{isBuffering:!1}):(this._sendMediaEvent("play"),this._addKeepAliveEventSchedule()))},B.prototype._addKeepAliveEventSchedule=function(){this._eventsEnabled()&&(this._keepAliveIntervalId||(this._keepAliveIntervalId=setInterval(this._sendKeepAliveEvent.bind(this),this._keepAliveDuration)))},B.prototype._removeKeepAliveEventSchedule=function(){this._keepAliveIntervalId&&(clearInterval(this._keepAliveIntervalId),this._keepAliveIntervalId=void 0)},B.prototype._sendKeepAliveEvent=function(){var e;this._eventsEnabled()&&(e={name:"keepalive",level2:this._media&&this._media.getProducerId()?this._media.getProducerId():0},this._tag.page.send(e),E.info("Sending keepalive"),this._lastPage&&this._tag.page.set(this._lastPage))},B.prototype.avPauseEvent=function(){this._eventsEnabled()&&this._sendMediaEvent("pause")},B.prototype.avBufferEvent=function(){this._eventsEnabled()&&this._sendMediaEvent("info",{isBuffering:!0})},B.prototype.avEndEvent=function(){this._eventsEnabled()&&(this._isMediaLoaded=!1,this._removeKeepAliveEventSchedule(),this._sendMediaEvent("stop"),this.isValidMedia()&&this.clearMedia())},B.prototype.avRewindEvent=function(){this._eventsEnabled()&&this._sendMediaEvent(I)},B.prototype.avFastForwardEvent=function(){this._eventsEnabled()&&this._sendMediaEvent(I)},B.prototype.avSeekEvent=function(){this._eventsEnabled()&&this._sendMediaEvent(I)},B.prototype.avUserActionEvent=function(e,t,i,n){this._eventsEnabled()&&"echo_hb"===e&&"echo_hb_5"===t&&(t=this._addLengthToMediaHit(this._lastPlayHitUrl),r.sendRefreshEvent(this._tag,this._getHttpGetMethod(),t),E.info("Performed 5 second heartbeat"))},B.prototype.clearMedia=function(){this.isValidMedia()&&(this._isMediaLoaded&&this.avEndEvent(),this._stream=null,this._media=null,this._commonMediaParams=null,this._tag.richMedia.removeAll())},B.prototype.isValidMedia=function(){return null!==this._media&&this._media.avType===m.AvType.VIDEO},B.prototype.isValidLiveMedia=function(){return this.isValidMedia()&&this._media.isLive()},B.prototype.getDeviceId=function(){return this._deviceId},B.prototype.setDeviceId=function(e){this._deviceId=e,this._tag&&(E.info("Updating ATI SmartTag device id:"+e),this._setSmartTagDeviceId(this._tag,e))},B.prototype.requiresLabelCleansing=function(){return!0},B}.call(t,D,t,e))||(e.exports=t)},function(e,t,i){void 0===(t=function(){return function(){var e,a={site:596068,log:"",logSSL:"",domain:"ati-host.net",collectDomain:"logw363.ati-host.net",collectDomainSSL:"logws1363.ati-host.net",userIdOrigin:"server",pixelPath:"/hit.xiti",disableCookie:!1,disableStorage:!1,cookieSecure:!1,cookieDomain:"",preview:!1,plgs:["Campaigns","Clicks","ClientSideUserId","ContextVariables","Offline","OnSiteAds","Page","RichMedia"],lazyLoadingPath:"",documentLevel:"document",redirect:!1,activateCallbacks:!0,medium:"",ignoreEmptyChapterValue:!0,base64Storage:!1,sendHitWhenOptOut:!0,forceHttp:!1,requestMethod:"GET",maxHitSize:2e3};(e=window).Echo1202ATInternet=e.Echo1202ATInternet||{},e.Echo1202ATInternet.Tracker=e.Echo1202ATInternet.Tracker||{},e.Echo1202ATInternet.Tracker.Plugins=e.Echo1202ATInternet.Tracker.Plugins||{},Echo1202ATInternet.Utils=new function(){function i(e){return null===e?"":(e+"").replace(t,"")}var m=this,n=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g,t=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g");function e(e,t){var i;t=t||{bubbles:!1,cancelable:!1,detail:void 0};try{(i=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail)}catch(e){}return i}m.isLocalStorageAvailable=function(){try{var e=localStorage;return e.setItem("__storage_test__","__storage_test__"),e.removeItem("__storage_test__"),!0}catch(e){return!1}},m.isBeaconMethodAvailable=function(){return window.navigator&&"function"==typeof window.navigator.sendBeacon},m.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,i,n,r,o,a,s="",c=0;for(e=m.Base64._utf8_encode(e);c<e.length;)r=(t=e.charCodeAt(c++))>>2,t=(3&t)<<4|(i=e.charCodeAt(c++))>>4,o=(15&i)<<2|(n=e.charCodeAt(c++))>>6,a=63&n,isNaN(i)?o=a=64:isNaN(n)&&(a=64),s=s+this._keyStr.charAt(r)+this._keyStr.charAt(t)+this._keyStr.charAt(o)+this._keyStr.charAt(a);return s},decode:function(e){var t,i,n,r,o,a="",s=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");s<e.length;)t=this._keyStr.indexOf(e.charAt(s++))<<2|(i=this._keyStr.indexOf(e.charAt(s++)))>>4,i=(15&i)<<4|(r=this._keyStr.indexOf(e.charAt(s++)))>>2,n=(3&r)<<6|(o=this._keyStr.indexOf(e.charAt(s++))),a+=String.fromCharCode(t),64!=r&&(a+=String.fromCharCode(i)),64!=o&&(a+=String.fromCharCode(n));return m.Base64._utf8_decode(a)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):(127<n&&n<2048?t+=String.fromCharCode(n>>6|192):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128)),t+=String.fromCharCode(63&n|128))}return t},_utf8_decode:function(e){for(var t,i,n,r="",o=0;o<e.length;)(t=e.charCodeAt(o))<128?(r+=String.fromCharCode(t),o++):191<t&&t<224?(i=e.charCodeAt(o+1),r+=String.fromCharCode((31&t)<<6|63&i),o+=2):(i=e.charCodeAt(o+1),n=e.charCodeAt(o+2),r+=String.fromCharCode((15&t)<<12|(63&i)<<6|63&n),o+=3);return r}},m.loadScript=function(e,t){var i;t=t||function(){},(i=document.createElement("script")).type="text/javascript",i.src=e.url,i.async=!1,i.defer=!1,i.onload=i.onreadystatechange=function(e){("load"===(e=e||window.event).type||/loaded|complete/.test(i.readyState)&&(!document.documentMode||document.documentMode<9))&&(i.onload=i.onreadystatechange=i.onerror=null,t(null,e))},i.onerror=function(e){i.onload=i.onreadystatechange=i.onerror=null,t({msg:"script not loaded",event:e})};e=document.head||document.getElementsByTagName("head")[0];e.insertBefore(i,e.lastChild)},m.cloneSimpleObject=function(e,t){if("object"!=typeof e||null===e||e instanceof Date)return e;var i,n=new e.constructor;for(i in e)e.hasOwnProperty(i)&&(void 0===i||t&&void 0===e[i]||(n[i]=m.cloneSimpleObject(e[i])));return n},m.isEmptyObject=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},m.isObject=function(e){return null!==e&&"object"==typeof e&&!(e instanceof Array)},m.ATVALUE="_ATVALUE",m.ATPREFIX="_ATPREFIX",m.object2Flatten=function(e,t,i,n,r){var o,a,s,c="",u="",l="",d=0;for(o in e)if(e.hasOwnProperty(o))if(c=(a=m.splitProtocolAndKey(o,r)).prefix||n||"",u=(t?t+"_":"")+a.key,m.isObject(e[o]))m.object2Flatten(e[o],u,i,c,r);else{for(s=u.split("_"),l="",d=0;d<s.length;d++)c=(a=m.splitProtocolAndKey(s[d],r)).prefix||c,l+=a.key+(d<s.length-1?"_":"");i[u=l||u]=i[u]||{},i[u][m.ATVALUE]=e[o],i[u][m.ATPREFIX]=c}},m.flatten2Object=function(e,t,i){var n,r,o;for(t=t.split("_"),n=0;n<t.length-1;n++)e[r=t[n]]||(e[r]={}),e=e[r];e.hasOwnProperty(m.ATVALUE)&&(r=e[m.ATVALUE],o=e[m.ATPREFIX],delete e[m.ATVALUE],delete e[m.ATPREFIX],e.$={},e.$[m.ATVALUE]=r,e.$[m.ATPREFIX]=o),i=m.cloneSimpleObject(i),e[t[n]]?e[t[n]].$=i:e[t[n]]=i},m.getFormattedObject=function(e){var t,i={};for(t in e)e.hasOwnProperty(t)&&(e[t].hasOwnProperty(m.ATVALUE)?i[e[t][m.ATPREFIX]?e[t][m.ATPREFIX]+":"+t:t]=e[t][m.ATVALUE]:i[t]=m.getFormattedObject(e[t]));return i},m.completeFstLevelObj=function(e,t,i){if(e){if(t)for(var n in t)!t.hasOwnProperty(n)||e[n]&&!i||(e[n]=t[n])}else e=t;return e},m.getObjectKeys=function(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push(t);return i},m.objectToLowercase=function(e){var t,i={};for(t in e)e.hasOwnProperty(t)&&(m.isObject(e[t])?i[t.toLowerCase()]=m.objectToLowercase(e[t]):i[t.toLowerCase()]=e[t]);return i},m.splitProtocolAndKey=function(e,t){var i,e=e.length<2||":"!==e[1]?(i="",e):e.length<4||":"!==e[3]?(i=e.substring(0,1),e.substring(2,e.length)):(i=e.substring(0,3),e.substring(4,e.length));return t&&(i=i.toLowerCase(),e=e.toLowerCase()),{prefix:i,key:e}},m.jsonSerialize=function(e){try{return"undefined"!=typeof JSON&&JSON.stringify?JSON.stringify(e):function e(t){var i=typeof t;if("object"!==i||null===t)return"string"===i&&(t='"'+t+'"'),String(t);var n,r,o=[],a=t.constructor===Array;for(n in t)t.hasOwnProperty(n)&&"function"!=(i=typeof(r=t[n]))&&"undefined"!==i&&("string"===i?r='"'+r.replace(/[^\\]"/g,'\\"')+'"':"object"===i&&null!==r&&(r=e(r)),o.push((a?"":'"'+n+'":')+String(r)));return(a?"[":"{")+String(o)+(a?"]":"}")}(e)}catch(e){return null}},m.jsonParse=function(e){try{return"undefined"!=typeof JSON&&JSON.parse?JSON.parse(e+""):(o=null,(t=i((t=e)+""))&&!i(t.replace(n,function(e,t,i,n){return 0===(o=r&&t?0:o)?e:(r=i||t,o+=!n-!i,"")}))?Function("return "+t)():null)}catch(e){return null}var t,r,o},m.trim=function(t){try{return String.prototype.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}catch(e){return t}},m.arrayIndexOf=function(e,t){if(Array.prototype.indexOf){var i=-1;return i=void 0!==e.indexOf(t)?e.indexOf(t):i}return function(e){if(null==this)throw new TypeError;var t=Object(this),i=t.length>>>0;if(0==i)return-1;var n=0;if(1<arguments.length&&((n=Number(arguments[1]))!=n?n=0:0!=n&&1/0!=n&&-1/0!=n&&(n=(0<n||-1)*Math.floor(Math.abs(n)))),i<=n)return-1;for(n=0<=n?n:Math.max(i-Math.abs(n),0);n<i;n++)if(n in t&&t[n]===e)return n;return-1}.apply(e,[t])},m.uuid=function(){var n=window.crypto||window.msCrypto,r=null!==n&&"object"==typeof n;return{v4:function(){try{if(r)return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^n.getRandomValues(new Uint32Array(1))[0]&15>>e/4).toString(16)})}catch(e){}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},num:function(e){function t(e){return(e-=100*Math.floor(e/100))<10?"0"+e:String(e)}var i=new Date;return t(i.getHours())+""+t(i.getMinutes())+t(i.getSeconds())+function(e){var t=Math.random();try{r&&(t=n.getRandomValues(new Uint32Array(1))[0]/Math.pow(2,32))}catch(e){}return Math.floor((9*t+1)*Math.pow(10,e-1))}(e-6)}}},m.isPreview=function(){return window.navigator&&"preview"===window.navigator.loadPurpose},m.isPrerender=function(t){var i,n,e=!1,r=["webkit","ms"];if("prerender"===document.visibilityState)i="visibilitychange";else for(var o=0;o<r.length;o++)"prerender"===document[r[o]+"VisibilityState"]&&(i=r[o]+"visibilitychange");return void 0!==i&&(n=function(e){t(e),m.removeEvtListener(document,i,n)},m.addEvtListener(document,i,n),e=!0),e},m.addEvtListener=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)},m.removeEvtListener=function(e,t,i){e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent&&e.detachEvent("on"+t,i)},m.hashcode=function(e){var t=0;if(0===e.length)return t;for(var i=0;i<e.length;i++)t=0|(t<<5)-t+e.charCodeAt(i);return t},m.setLocation=function(e){var t=e.location;e=window[e.target]||window,t&&(e.location.href=t)},m.dispatchCallbackEvent=function(e){var t;if("function"==typeof window.Event)t=new Event("ATCallbackEvent");else try{(t=document.createEvent("Event")).initEvent&&t.initEvent("ATCallbackEvent",!0,!0)}catch(e){}t&&"function"==typeof document.dispatchEvent&&(t.name=e,document.dispatchEvent(t))},m.addCallbackEvent=function(e){m.addEvtListener(document,"ATCallbackEvent",e)},m.removeCallbackEvent=function(e){m.removeEvent("ATCallbackEvent",e)},"function"==typeof window.CustomEvent?window.ATCustomEvent=window.CustomEvent:("function"==typeof window.Event&&(e.prototype=window.Event.prototype),window.ATCustomEvent=e),m.addEvent=function(e,t,i,n){m[e]=new ATCustomEvent(e,{detail:{name:t,id:i}}),m.addEvtListener(document,e,n)},m.removeEvent=function(e,t){m.removeEvtListener(document,e,t)},m.dispatchEvent=function(e,t){m[e]=m[e]||new ATCustomEvent(e,{detail:{name:t,id:-1}});try{document.dispatchEvent(m[e])}catch(e){}},m.privacy=new function(){function _(e,t){for(var i,n=[],r={},o=0;o<e.length;o++){for(var a in m.object2Flatten(e[o],null,r={},null,!0),r)r.hasOwnProperty(a)&&-1===m.arrayIndexOf(t,a)&&delete r[a];if(!m.isEmptyObject(r)){for(var s in i={},r)r.hasOwnProperty(s)&&m.flatten2Object(i,s,r[s]);r=m.getFormattedObject(i),n.push(r)}}return n}function f(e){for(var t=[],i={},n=0;n<e.length;n++)if("string"==typeof e[n])t.push(e[n]);else for(var r in e[n])e[n].hasOwnProperty(r)&&(t.push(r),i[r]=(i[r]||[]).concat(e[n][r]));return{keys:t,values:i}}var E=this,g={storageParams:null,bufferParams:null};E.CONSENTNO="Consent-NO",E.ALL="*",E.testStorageParam=function(e,t){if(g.storageParams instanceof Array){for(var i,n=g.storageParams.length-1;0<=n;n--)if("string"==typeof(i=g.storageParams[n])){if(i===e||i===E.ALL)return{toSetInStorage:!0}}else{e:{var r=e,o=t,a=void 0,s=void 0;for(s in i)if(i.hasOwnProperty(s)&&r===s){if(!o){r=!0;break e}a=[],i[s]instanceof Array?a=i[s]:a.push(i[s]);for(var c=0;c<a.length;c++)if(a[c]===o){r=!0;break e}}r=!1}if(r)return{toSetInStorage:!0}}return{toSetInStorage:!1}}return{toSetInStorage:!0}},E.processStorageParams=function(e,t,i){if(i){i=i();var n=f(g.storageParams);if(n.keys[0]!==E.ALL)for(var r in i)if(i.hasOwnProperty(r))if(-1===m.arrayIndexOf(n.keys,r))e&&e(r);else if(m.isObject(i[r])){var o=r,a=i[r].val,s=n.values[r],c=e,r=t;if(void 0!==s){var u=[];for(s in s instanceof Array?u=s:u.push(s),s=void 0,a)a.hasOwnProperty(s)&&-1===m.arrayIndexOf(u,s)&&c&&c([o,s]);c&&r&&m.isEmptyObject(r(o))&&c(o)}}}},E.testBufferParam=function(e,t){var i,n;if(g.bufferParams instanceof Array){for(var r,o=g.bufferParams.length-1;0<=o;o--)if("string"==typeof(r=g.bufferParams[o])){if(r===e||r===E.ALL)return{toSetInBuffer:!0,value:t}}else{e:{if(i=e,n=t,m.isObject(r)){var a=void 0,s=[],c=!1,u=a=void 0;for(u in r)if(r.hasOwnProperty(u)&&i===u&&("string"==typeof(a=n)&&(a=m.jsonParse(a)||a),"object"==typeof a)){a instanceof Array?(s=a,c=!0):s.push(a),n=0===(a=_(s,r[u])).length?void(i=!1):(a=c?a:a[0],i=!0,m.jsonSerialize(a));break e}}i=!1,n=void 0}if(i)return{toSetInBuffer:!0,value:n}}return{toSetInBuffer:!1}}return{toSetInBuffer:!0,value:t}},E.processBufferParams=function(e,t,i){if(t){t=t();var n,r,o,a,s,c,u,l,d,h=f(g.bufferParams);if(h.keys[0]!==E.ALL)for(var p in t)t.hasOwnProperty(p)&&(-1===m.arrayIndexOf(h.keys,p)?e&&e(p):(r=t[n=p],a=e,s=i,void 0!==(o=h.values[p])&&(c=[],u=r._value,d=!(l=[]),p=void 0,o instanceof Array?c=o:c.push(o),"object"==typeof(u="string"==typeof u?m.jsonParse(u)||u:u)&&(u instanceof Array?(l=u,d=!0):l.push(u),0===(p=_(l,c)).length?a&&a(n):(p=d?p:p[0],s&&s(n,m.jsonSerialize(p),r._options))))))}},E.setParameters=function(e){g=e},E.getParameters=function(){return g},E.resetParameters=function(){g={storageParams:null,bufferParams:null}}},m.optedOut=null,m.addOptOutEvent=function(e,t){m.addEvent("ATOptOutEvent","clientsideuserid",e,t)},m.removeOptOutEvent=function(e){m.removeEvent("ATOptOutEvent",e)},m.dispatchOptOutEvent=function(e){m.optedOut=e,m.dispatchEvent("ATOptOutEvent","clientsideuserid")},m.userOptedOut=function(){m.dispatchOptOutEvent(!0)},m.userOptedIn=function(){m.dispatchOptOutEvent(!1)},m.isOptedOut=function(){if(null===m.optedOut){var e,t=null;if(null!==(t=null===(t=m.isLocalStorageAvailable()?localStorage.getItem("atuserid"):t)&&null!==(e=/(?:^| )atuserid=([^;]+)/.exec(document.cookie))?e[1]:t))try{t=decodeURIComponent(t)}catch(t){}t=!(!t||null===(t=m.jsonParse(t)||m.jsonParse(m.Base64.decode(t))))&&"OPT-OUT"===t.val,m.optedOut=t}return!!m.optedOut},m.consentReceived=function(e){m.consent=!!e},m.consent=!0,m.isTabOpeningAction=function(e){var t=!1;return t=e&&(e.ctrlKey||e.shiftKey||e.metaKey||e.button&&1===e.button)?!0:t},m.CLICKS_REDIRECTION="redirection",m.CLICKS_FORM="form",m.CLICKS_MAILTO="mailto"};function s(E){function g(e,t,i,n,r,o,a){return{param:e="&"+e+"=",paramSize:e.length,str:t,strSize:t.length,truncate:i,multihit:n,separator:r||"",encode:o,last:a}}function m(e,t){var i,n="",r=0,o=0,a=0,s=(r=-1,null),c=null;for(i in e)e.hasOwnProperty(i)&&(s=e[i])&&(r=t-o,s.last&&null!==c?c[i]=s:s.strSize+s.paramSize<=r?(n+=s.param+s.str,o+=s.paramSize+s.strSize):((c=c||{})[i]=s).truncate&&(a=r-s.paramSize,s.separator&&(r=s.str.substring(0,r),0<(r=s.encode?r.lastIndexOf(encodeURIComponent(s.separator)):r.lastIndexOf(s.separator))&&(a=r)),n+=s.param+s.str.substring(0,a),o+=s.paramSize+s.str.substring(0,a).length,c[i].str=s.str.substring(a,s.strSize),c[i].strSize=c[i].str.length));return[n,c]}var o,s=this,c=0,T=0,C=["dz"];function i(t,i,a){var e,n,r,o;e=function(e,o){e?a&&a(e):(T=c-(o.length+27),function(e,t,i){function n(e){if(e==={})return[];var t,i,n,r,o,a,s,c,u,l,d=[],h=!(t={}),p=void 0,_="";for(l in e)if(e.hasOwnProperty(l))if(s=a=o=r=!1,i=e[l]._value,"boolean"==typeof(n=e[l]._options||{}).encode&&(r=n.encode),"function"==typeof i&&(i=i()),i=i instanceof Array?i.join(n.separator||","):"object"==typeof i?Echo1202ATInternet.Utils.jsonSerialize(i):void 0===i?"undefined":i.toString(),r&&(i=encodeURIComponent(i)),-1<Echo1202ATInternet.Utils.arrayIndexOf(C,l)?o=!0:"boolean"==typeof n.truncate&&(o=n.truncate),"boolean"==typeof n.multihit&&(a=n.multihit),"boolean"==typeof n.last&&(s=n.last),i=g(l,i,o,a,n.separator,r,s),a)T-=i.paramSize+i.strSize,_+=i.param+i.str;else if(s)i.paramSize+i.strSize>T&&(i.str=i.str.substring(0,T-i.paramSize),i.strSize=i.str.length),c=l,u=i;else if(t[l]=i,t[l].paramSize+t[l].strSize>T&&!t[l].truncate){E.emit("Tracker:Hit:Build:Error",{lvl:"ERROR",msg:'Too long parameter: "'+t[l].param+'"',details:{value:t[l].str}}),h=!0,p=l;break}if(c&&(t[c]=u),e=(t=[t,h,p,_])[0],h=t[1],f=t[3],h&&((e=e[t=t[2]]).str=e.str.substring(0,T-e.paramSize),e.strSize=e.str.length,(h={}).mherr=g("mherr","1",!1,!1,"",!1,!1),h[t]=e,e=h),null===(e=m(e,T))[1])d=e[0];else for(d.push(e[0]);null!==e[1];)e=m(e[1],T),d.push(e[0]);return d}var r,o,f="",a="";if(E.buffer.presentInFilters(t,"hitType")||(t=E.buffer.addInFilters(t,"hitType",["page"])),t=E.buffer.addInFilters(t,"hitType",["all"]),Echo1202ATInternet.Utils.isObject(e)){for(r in t=E.buffer.addInFilters(t,"permanent",!0),t=E.buffer.get(t,!0),e)e.hasOwnProperty(r)&&(a={},e[r]&&"object"==typeof e[r]&&e[r].hasOwnProperty("_value")?(o=e[r]._value,e[r].hasOwnProperty("_options")&&(a=e[r]._options)):o=e[r],(o=Echo1202ATInternet.Utils.privacy.testBufferParam(r,o)).toSetInBuffer&&(t[r]={_value:o.value,_options:a}));a=n(t)}else for(r in a=n(t=E.buffer.get(t,!0)),t)t.hasOwnProperty(r)&&(t[r]._options&&t[r]._options.permanent||E.buffer.del(r));i(a,f)}(t,i,function(e,t){var i=[],n=Echo1202ATInternet.Utils.uuid().num(13);if(e instanceof Array)for(var r=1;r<=e.length;r++)i.push(o+t+"&mh="+r+"-"+e.length+"-"+n+e[r-1]);else i.push(o+t+e);a&&a(null,i)}))},o="",(r=E.getConfig("baseURL"))?o=r:(r=s.getCollectDomain(),"/"!==(n=E.getConfig("pixelPath")||"/").charAt(0)&&(n="/"+n),r&&(o=(E.getConfig("forceHttp")?"http://":"https://")+r+n)),r=E.getConfig("site"),o&&r?e(null,o+"?s="+r):e({message:"Config error"})}function a(t,i,n,r,o,a,s){return function(e){E.emit(t,{lvl:o,details:{hit:i,method:n,event:e,isMultiHit:a,elementType:s}}),r&&r()}}s.getCollectDomain=function(){var e,t=(e=E.getConfig("logSSL")||E.getConfig("log"),E.getConfig("domain"));return e&&t?e+"."+t:E.getConfig("collectDomainSSL")||E.getConfig("collectDomain")},s.send=function(e,t,n,r,o){i(e,t,function(e,t){if(e)E.emit("Tracker:Hit:Build:Error",{lvl:"ERROR",msg:e.message,details:{}}),n&&n();else for(var i=0;i<t.length;i++)s.sendUrl(t[i],n,r,o)})},c=Math.max(E.getConfig("maxHitSize")||0,2e3),T=Math.max(E.getConfig("maxHitSize")||0,2e3),o=E.getConfig("requestMethod"),s.sendUrl=function(e,t,i,n){var r=-1<e.indexOf("&mh=");i=i||o,Echo1202ATInternet.Utils.isOptedOut()&&!E.getConfig("sendHitWhenOptOut")?a("Tracker:Hit:Sent:NoTrack",e,i,t,"INFO",r,n)():"POST"===i&&Echo1202ATInternet.Utils.isBeaconMethodAvailable()?(n="Tracker:Hit:Sent:Error",i="ERROR",window.navigator.sendBeacon(e,null)&&(n="Tracker:Hit:Sent:Ok",i="INFO"),a(n,e,"POST",t,i,r,"")()):((i=new Image).onload=a("Tracker:Hit:Sent:Ok",e,"GET",t,"INFO",r,n),i.onerror=a("Tracker:Hit:Sent:Error",e,"GET",t,"ERROR",r,n),i.src=e)}}function u(){function a(e,t,i){for(var n=[],r=0;r<e.length;r++)e[r].callback(t,i),e[r].singleUse||n.push(e[r]);return n}var n={};this.on=function(e,t,i){return i=i||!1,function e(t,i,n,r){var o=t.shift();return"*"===o?(i["*"]=i["*"]||[],i["*"].push({callback:n,singleUse:r}),i["*"].length-1):0===t.length?e([o,"*"],i,n,r):(i["*"]=i["*"]||[],i[o]=i[o]||{},e(t,i[o],n,r))}(e.split(":"),n,t,i)},this.emit=function(e,t){n["*"]&&(n["*"]=a(n["*"],e,t)),function e(t,i,n,r){var o=i.shift();"*"!==o&&(0===i.length?e(t,[o,"*"],n,r):n[o]&&(n[o]["*"]=a(n[o]["*"],t,r),e(t,i,n[o],r)))}(e,e.split(":"),n,t)}}function l(o){function a(e){return!h(e)&&!_(e)&&h(e+"_ll")}function s(e){i[e]=!0,n++,Echo1202ATInternet.Utils.loadScript({url:o.getConfig("lazyLoadingPath")+e+".js"})}function c(e,t,i,n){var r=null;t=t.split("."),h(e)&&u[e][t[0]]&&(r=(1<t.length&&u[e][t[0]][t[1]]?u[e][t[0]][t[1]]:u[e][t[0]]).apply(u[e],i)),n&&n(r)}function r(t,e,i,n){var r;l[r=t]?l[r]++:l[r]=1,d++,o.onTrigger("Tracker:Plugin:Load:"+t+":Ok",function(){c(t,e,i,function(e){l[t]--,0==--d&&o.emit("Tracker:Plugin:Lazyload:Exec:Complete",{lvl:"INFO",msg:"All exec waiting for lazyloading are done"}),n&&n(e)})},!0)}var u={},i={},n=0,l={},d=0,h=function(e){var t=!1;return t=u[e]?!0:t},p=this.unload=function(e){return h(e)?(u[e]=void 0,o.emit("Tracker:Plugin:Unload:"+e+":Ok",{lvl:"INFO"})):o.emit("Tracker:Plugin:Unload:"+e+":Error",{lvl:"ERROR",msg:"not a known plugin"}),o},t=this.load=function(e,t){return"function"==typeof t?void 0===o.getConfig.plgAllowed||0===o.getConfig.plgAllowed.length||-1<o.getConfig.plgAllowed.indexOf(e)?(u[e]=new t(o),i[e]&&h(e)&&(i[e]=!1,n--,h(e+"_ll")&&p(e+"_ll"),0===n&&o.emit("Tracker:Plugin:Lazyload:File:Complete",{lvl:"INFO",msg:"LazyLoading triggers are finished"})),o.emit("Tracker:Plugin:Load:"+e+":Ok",{lvl:"INFO"})):o.emit("Tracker:Plugin:Load:"+e+":Error",{lvl:"ERROR",msg:"Plugin not allowed",details:{}}):o.emit("Tracker:Plugin:Load:"+e+":Error",{lvl:"ERROR",msg:"not a function",details:{obj:t}}),o},_=this.isLazyloading=function(e){return e?!0===i[e]:0!==n};this.isExecWaitingLazyloading=function(){return 0!==d},o.exec=this.exec=function(e,t,i,n){a(e)?(r(e,t,i,n),s(e)):(_(e)?r:c)(e,t,i,n)},this.waitForDependencies=function(e,n){var r=function(e){for(var t={mcount:0,plugins:{}},i=0;i<e.length;i++)u.hasOwnProperty(e[i])||(t.mcount++,t.plugins[e[i]]=!0);return t}(e);if(0===r.mcount)o.emit("Tracker:Plugin:Dependencies:Loaded",{lvl:"INFO",details:{dependencies:e}}),n();else for(var t in r.plugins)r.plugins.hasOwnProperty(t)&&(o.emit("Tracker:Plugin:Dependencies:Error",{lvl:"WARNING",msg:"Missing plugin "+t}),o.onTrigger("Tracker:Plugin:Load:"+t,function(e,t){var i=e.split(":"),e=i[3];"Ok"===i[4]&&(r.plugins[e]=!1,r.mcount--,0===r.mcount&&n())},!0),a(t=t)&&s(t))},this.init=function(){for(var e in Echo1202ATInternet.Tracker.pluginProtos)Echo1202ATInternet.Tracker.pluginProtos.hasOwnProperty(e)&&t(e,Echo1202ATInternet.Tracker.pluginProtos[e])}}function d(n){function r(e){var t,i;e.name&&(t=!0,void 0!==(i=n.getConfig("callbacks"))&&(i.include instanceof Array&&-1===Echo1202ATInternet.Utils.arrayIndexOf(i.include,e.name)&&(t=!1),i.exclude instanceof Array&&-1!==Echo1202ATInternet.Utils.arrayIndexOf(i.exclude,e.name)&&(t=!1)),Echo1202ATInternet.Callbacks&&Echo1202ATInternet.Callbacks.hasOwnProperty(e.name)&&((i={})[e.name]={function:Echo1202ATInternet.Callbacks[e.name]},t&&o.load(e.name,i[e.name].function),Echo1202ATInternet.Tracker.callbackProtos[e.name]||(Echo1202ATInternet.Tracker.callbackProtos[e.name]=i[e.name])))}var o=this,a={};o.load=function(e,t){return"function"==typeof t?(new t(n),n.emit("Tracker:Callback:Load:"+e+":Ok",{lvl:"INFO",details:{obj:t}})):n.emit("Tracker:Callback:Load:"+e+":Error",{lvl:"ERROR",msg:"not a function",details:{obj:t}}),n},o.init=function(){if(n.getConfig("activateCallbacks")){var e,t=n.getConfig("callbacks");if(void 0!==t&&t.include instanceof Array)for(var i=0;i<t.include.length;i++)Echo1202ATInternet.Callbacks&&Echo1202ATInternet.Callbacks.hasOwnProperty(t.include[i])&&(a[t.include[i]]={function:Echo1202ATInternet.Callbacks[t.include[i]]},Echo1202ATInternet.Tracker.callbackProtos[t.include[i]]||(Echo1202ATInternet.Tracker.callbackProtos[t.include[i]]=a[t.include[i]]));else for(i in Echo1202ATInternet.Callbacks)Echo1202ATInternet.Callbacks.hasOwnProperty(i)&&(a[i]={function:Echo1202ATInternet.Callbacks[i]},Echo1202ATInternet.Tracker.callbackProtos[i]||(Echo1202ATInternet.Tracker.callbackProtos[i]=a[i]));if(void 0!==t&&t.exclude instanceof Array)for(i=0;i<t.exclude.length;i++)delete a[t.exclude[i]];for(e in a)a.hasOwnProperty(e)&&a[e]&&o.load(e,a[e].function);Echo1202ATInternet.Utils.addCallbackEvent(r)}},o.removeCallbackEvent=function(){Echo1202ATInternet.Utils.removeCallbackEvent(r)}}function h(e){var a=this,c={};function o(e,t,i){return(e=Echo1202ATInternet.Utils.cloneSimpleObject(e[t]))&&!i?e._value:e}a.set=function(e,t,i){(t=Echo1202ATInternet.Utils.privacy.testBufferParam(e,t)).toSetInBuffer&&((i=i||{}).hitType=i.hitType||["page"],c[e]={_value:t.value,_options:i})},a.get=function(e,t){var i={};if("string"==typeof e)i=o(c,e,t);else for(var n=function e(t,i){if(!(t&&i instanceof Array&&t instanceof Array))return[];if(0===t.length)return i;var n=t[0],r=[],t=Echo1202ATInternet.Utils.cloneSimpleObject(t);t.shift();for(var o=0;o<i.length;o++)if("object"!=typeof n[1])c[i[o]]&&c[i[o]]._options[n[0]]===n[1]&&r.push(i[o]);else for(var a=n[1].length,s=0;s<a;s++)if(c[i[o]]&&c[i[o]]._options[n[0]]instanceof Array&&0<=Echo1202ATInternet.Utils.arrayIndexOf(c[i[o]]._options[n[0]],n[1][s])){r.push(i[o]);break}return e(t,r)}(e,Echo1202ATInternet.Utils.getObjectKeys(c)),r=0;r<n.length;r++)i[n[r]]=o(c,n[r],t);return i},a.presentInFilters=function(e,t){return!(!e||0===e.length)&&(e[0][0]===t||a.presentInFilters(e.slice(1),t))},a.addInFilters=function(e,t,i,n){if(!e||0===e.length)return n?[]:[[t,i]];var r=e[0][0],o=e[0][1];return r===t&&(o instanceof Array&&-1===Echo1202ATInternet.Utils.arrayIndexOf(o,i[0])&&o.push(i[0]),n=!0),[[r,o]].concat(a.addInFilters(e.slice(1),t,i,n))},a.del=function(e){c[e]=void 0},a.clear=function(){c={}}}function p(i){var n=this,r={};n.setProp=function(e,t,i){void 0!==e&&(r[e]={value:t,persistent:!!i})},n.setProps=function(e,t){if(Echo1202ATInternet.Utils.isObject(e))for(var i in e)e.hasOwnProperty(i)&&n.setProp(i,e[i],t)},n.delProp=function(e,t){void 0!==r[e]&&delete r[e],t||i.delParam(e.toLowerCase())},n.delProps=function(e){for(var t in r)r.hasOwnProperty(t)&&n.delProp(t,e)},n.getProp=function(e){return(r=r||{})[e]},n.getProps=function(){return r}}Echo1202ATInternet.Tracker.Tag=function(e,t,i){t=t||{};var c=this;c.version="5.26.0";var n=Echo1202ATInternet.Utils.cloneSimpleObject(t);c.triggers=new u,c.emit=c.triggers.emit,c.onTrigger=c.triggers.on;var r,o=Echo1202ATInternet.Utils.cloneSimpleObject(a)||{};for(r in e)e.hasOwnProperty(r)&&(o[r]=e[r]);c.getConfig=function(e){return o[e]},c.setConfig=function(e,t,i){void 0!==o[e]&&i||(c.emit("Tracker:Config:Set:"+e,{lvl:"INFO",details:{bef:o[e],aft:t}}),o[e]=t)},c.configPlugin=function(e,t,i){for(var n in o[e]=o[e]||{},t)t.hasOwnProperty(n)&&void 0===o[e][n]&&(o[e][n]=t[n]);return i&&(i(o[e]),c.onTrigger("Tracker:Config:Set:"+e,function(e,t){i(t.details.aft)})),o[e]},c.getAllContext=function(){return n},c.getContext=function(e){return n[e]},c.setContext=function(e,t){c.emit("Tracker:Context:Set:"+e,{lvl:"INFO",details:{bef:n[e],aft:t}}),n[e]=t},c.delContext=function(e,t){if(c.emit("Tracker:Context:Deleted:"+e+":"+t,{lvl:"INFO",details:{key1:e,key2:t}}),e)n.hasOwnProperty(e)&&(t?n[e]&&n[e].hasOwnProperty(t)&&(n[e][t]=void 0):n[e]=void 0);else if(t)for(var i in n)n.hasOwnProperty(i)&&n[i]&&n[i].hasOwnProperty(t)&&(n[i][t]=void 0)},c.plugins=new l(c),c.buffer=new h,c.setParam=c.buffer.set,c.getParams=function(e){return c.buffer.get(e,!1)},c.getParam=c.buffer.get,c.delParam=c.buffer.del,c.builder=new s(c),c.sendUrl=c.builder.sendUrl,c.callbacks=new d(c),c.properties=new p(c),c.setProp=c.properties.setProp,c.setProps=c.properties.setProps,c.delProp=c.properties.delProp,c.delProps=c.properties.delProps,c.getProp=c.properties.getProp,c.getProps=c.properties.getProps,c.sendHit=function(e,t,i,n,r){var o,a,s=c.getProps();for(a in s)s.hasOwnProperty(a)&&(o=s[a].value,s[a].persistent?c.setParam(a.toLowerCase(),o,{permanent:!0,hitType:["all"],encode:!0}):(Echo1202ATInternet.Utils.isObject(e)?e[a.toLowerCase()]={_value:o,_options:{hitType:["all"],encode:!0}}:c.setParam(a.toLowerCase(),o,{hitType:["all"],encode:!0}),c.delProp(a,!0)));c.builder.send(e,t,i,n,r)},Echo1202ATInternet.Utils.privacy.resetParameters(),c.setParam("ts",function(){return(new Date).getTime()},{permanent:!0,hitType:["all"]}),(c.getConfig("disableCookie")||c.getConfig("disableStorage"))&&c.setParam("idclient",Echo1202ATInternet.Utils.privacy.CONSENTNO,{permanent:!0,hitType:["all"]}),c.getConfig("medium")&&c.setParam("medium",c.getConfig("medium"),{permanent:!0,hitType:["all"]}),c.plugins.init(),c.callbacks.init(),c.emit("Tracker:Ready",{lvl:"INFO",msg:"Tracker initialized",details:{tracker:c,args:{config:e,context:t,callback:i}}}),i&&i(c),Echo1202ATInternet.Tracker.instances.push(c)},Echo1202ATInternet.Tracker.instances=[],Echo1202ATInternet.Tracker.pluginProtos={},Echo1202ATInternet.Tracker.addPlugin=function(e,t){if(t=t||Echo1202ATInternet.Tracker.Plugins[e],!Echo1202ATInternet.Tracker.pluginProtos[e]){Echo1202ATInternet.Tracker.pluginProtos[e]=t;for(var i=0;i<Echo1202ATInternet.Tracker.instances.length;i++)Echo1202ATInternet.Tracker.instances[i].plugins.load(e,t)}},Echo1202ATInternet.Tracker.delPlugin=function(e){if(Echo1202ATInternet.Tracker.pluginProtos[e]){Echo1202ATInternet.Tracker.pluginProtos[e]=void 0;for(var t=0;t<Echo1202ATInternet.Tracker.instances.length;t++)Echo1202ATInternet.Tracker.instances[t].plugins.unload(e)}},Echo1202ATInternet.Tracker.callbackProtos={}}.call(window),function(){var e={lifetime:30,lastPersistence:!0,domainAttribution:!0,enableUTMTracking:!0,UTMParameters:["utm_source","utm_medium","utm_campaign","utm_term","utm_content"],querystringPrefix:"at_"};Echo1202ATInternet.Tracker.Plugins.Campaigns=function(o){o.setConfig("visitLifetime",30,!0),o.setConfig("redirectionLifetime",30,!0);var a,s,d={};o.configPlugin("Campaigns",e,function(e){d=e});function c(){function c(e){var t="";return t=e?isNaN(e)&&-1===e.search(/^\[(.*?)\]$/g)&&-1===e.search(/^\d+\[(.*?)\]$/g)?"["+e+"]":e:t}function u(e){var t=e;return t=-1!==e.search(/[-]/g)&&-1===e.search(/^\[(.*?)\]$/g)?"["+e+"]":t}function l(e){for(;"-"===e.charAt(e.length-1);)e=e.substring(0,e.length-1);return e}this.SponsoredLinks=function(){var a={google:"goo",yahoo:"ysm",miva:"miv",orange:"wan",msn:"msn",mirago:"mir",sklik:"skl",adfox:"adf",etarget:"etg",yandex:"yan",ebay:"eba",searchalliance:"sal",bing:"bin",naver:"nav",baidu:"bdu",qwant:"qwt",waze:"waz",amazon:"amz"},s={search:"s",content:"c"};this.atMedium="sl",this.atTerm=this.atNetwork=this.atVariant=this.atCreation=this.atPlatform=this.atCampaign="",this.format=function(){var e=c(this.atCampaign),t=a[this.atPlatform]||u(this.atPlatform),i=c(this.atCreation),n=c(this.atVariant),r=s[this.atNetwork]||u(this.atNetwork),o=c(this.atTerm);return l("sec-"+e+"-"+t+"-"+i+"-"+n+"-"+r+"-"+o)},this.setProperties=function(e){this.atCampaign=o.utils.getQueryStringValue(d.querystringPrefix+"campaign",e)||"",this.atPlatform=o.utils.getQueryStringValue(d.querystringPrefix+"platform",e)||"",this.atCreation=o.utils.getQueryStringValue(d.querystringPrefix+"creation",e)||"",this.atVariant=o.utils.getQueryStringValue(d.querystringPrefix+"variant",e)||"",this.atNetwork=o.utils.getQueryStringValue(d.querystringPrefix+"network",e)||"",this.atTerm=o.utils.getQueryStringValue(d.querystringPrefix+"term",e)||"",o.setContext("campaigns_events",{$:this.atMedium,campaign:this.atCampaign,platform:this.atPlatform,creation:this.atCreation,variant:this.atVariant,network:this.atNetwork,term:this.atTerm})}},this.Email=function(){var s={acquisition:"erec",retention:"epr",promotion:"es"};this.atMedium="email",this.atSendTime=this.atRecipientList=this.atRecipientId=this.atLink=this.atSendDate=this.atCreation=this.atCampaign=this.atEmailtype="",this.format=function(){var e=s[this.atEmailtype]||s.promotion,t=c(this.atCampaign),i=c(this.atCreation),n=u(this.atSendDate),r=c(this.atLink),o=u(this.atRecipientId)+(this.atRecipientList?"@"+u(this.atRecipientList):""),a=u(this.atSendTime);return l(e+"-"+t+"-"+i+"-"+n+"-"+r+"-"+o+"-"+a)},this.setProperties=function(e){this.atEmailtype=o.utils.getQueryStringValue(d.querystringPrefix+"emailtype",e)||"",this.atCampaign=o.utils.getQueryStringValue(d.querystringPrefix+"campaign",e)||"",this.atCreation=o.utils.getQueryStringValue(d.querystringPrefix+"creation",e)||"",this.atSendDate=o.utils.getQueryStringValue(d.querystringPrefix+"send_date",e)||"",this.atLink=o.utils.getQueryStringValue(d.querystringPrefix+"link",e)||"",this.atRecipientId=o.utils.getQueryStringValue(d.querystringPrefix+"recipient_id",e)||"",this.atRecipientList=o.utils.getQueryStringValue(d.querystringPrefix+"recipient_list",e)||"",this.atSendTime=o.utils.getQueryStringValue(d.querystringPrefix+"send_time",e)||"",o.setContext("campaigns_events",{$:this.atMedium,emailtype:this.atEmailtype,campaign:this.atCampaign,creation:this.atCreation,send_date:this.atSendDate,link:this.atLink,recipient_id:this.atRecipientId,recipient_list:this.atRecipientList,send_time:this.atSendTime})}},this.Affiliate=function(){this.atMedium="affiliate",this.atVariant=this.atCreation=this.atFormat=this.atIdentifier=this.atType=this.atCampaign="",this.format=function(){var e=c(this.atCampaign),t=c(this.atType),i=c(this.atIdentifier),n=c(this.atFormat),r=c(this.atCreation),o=c(this.atVariant);return l("al-"+e+"-"+t+"-"+i+"-"+n+"-"+r+"-"+o)},this.setProperties=function(e){this.atCampaign=o.utils.getQueryStringValue(d.querystringPrefix+"campaign",e)||"",this.atType=o.utils.getQueryStringValue(d.querystringPrefix+"type",e)||"",this.atIdentifier=o.utils.getQueryStringValue(d.querystringPrefix+"identifier",e)||"",this.atFormat=o.utils.getQueryStringValue(d.querystringPrefix+"format",e)||"",this.atCreation=o.utils.getQueryStringValue(d.querystringPrefix+"creation",e)||"",this.atVariant=o.utils.getQueryStringValue(d.querystringPrefix+"variant",e)||"",o.setContext("campaigns_events",{$:this.atMedium,campaign:this.atCampaign,type:this.atType,identifier:this.atIdentifier,format:this.atFormat,creation:this.atCreation,variant:this.atVariant})}},this.Display=function(){this.atMedium="display",this.atDetailPlacement=this.atGeneralPlacement=this.atChannel=this.atFormat=this.atVariant=this.atCreation=this.atCampaign="",this.format=function(){var e=c(this.atCampaign),t=c(this.atCreation),i=c(this.atVariant),n=c(this.atFormat),r=c(this.atChannel),o=c(this.atGeneralPlacement),a=c(this.atDetailPlacement);return l("ad-"+e+"-"+t+"-"+i+"-"+n+"-"+r+"-"+o+"-"+a)},this.setProperties=function(e){this.atCampaign=o.utils.getQueryStringValue(d.querystringPrefix+"campaign",e)||"",this.atCreation=o.utils.getQueryStringValue(d.querystringPrefix+"creation",e)||"",this.atVariant=o.utils.getQueryStringValue(d.querystringPrefix+"variant",e)||"",this.atFormat=o.utils.getQueryStringValue(d.querystringPrefix+"format",e)||"",this.atChannel=o.utils.getQueryStringValue(d.querystringPrefix+"channel",e)||"",this.atGeneralPlacement=o.utils.getQueryStringValue(d.querystringPrefix+"general_placement",e)||"",this.atDetailPlacement=o.utils.getQueryStringValue(d.querystringPrefix+"detail_placement",e)||"",o.setContext("campaigns_events",{$:this.atMedium,campaign:this.atCampaign,creation:this.atCreation,variant:this.atVariant,format:this.atFormat,channel:this.atChannel,general_placement:this.atGeneralPlacement,detail_placement:this.atDetailPlacement})}},this.Custom=function(){this.atCustom4=this.atCustom3=this.atCustom2=this.atCustom1=this.atCampaign=this.atMedium="",this.format=function(){var e="",e="cs"+(e=/\d+$/.test(this.atMedium)?/\d+$/.exec(this.atMedium)[0]:e),t=c(this.atCampaign),i=c(this.atCustom1),n=c(this.atCustom2),r=c(this.atCustom3),o=c(this.atCustom4);return l(e+"-"+t+"-"+i+"-"+n+"-"+r+"-"+o)},this.setProperties=function(e){this.atMedium=o.utils.getQueryStringValue(d.querystringPrefix+"medium",e)||"",this.atCampaign=o.utils.getQueryStringValue(d.querystringPrefix+"campaign",e)||"",this.atCustom1=o.utils.getQueryStringValue(d.querystringPrefix+"custom1",e)||"",this.atCustom2=o.utils.getQueryStringValue(d.querystringPrefix+"custom2",e)||"",this.atCustom3=o.utils.getQueryStringValue(d.querystringPrefix+"custom3",e)||"",this.atCustom4=o.utils.getQueryStringValue(d.querystringPrefix+"custom4",e)||"",o.setContext("campaigns_events",{$:this.atMedium,campaign:this.atCampaign,custom1:this.atCustom1,custom2:this.atCustom2,custom3:this.atCustom3,custom4:this.atCustom4})}},this.medium={sl:this.SponsoredLinks,email:this.Email,affiliate:this.Affiliate,display:this.Display}}function u(e,t){var i=o.getContext("campaigns")||{};i[e]=t,o.setContext("campaigns",i)}function l(e,t){var i=o.storage[s](e);return null!==i?"object"==typeof i&&!(i instanceof Array):(o.storage[a](e,{},t),!0)}var h,p,_,f,E,g,m,T,C,I,v,S,y;o.plugins.waitForDependencies(["Storage","Utils"],function(){var n,e,t;a="set"+(d.domainAttribution?"":"Private"),s="get"+(d.domainAttribution?"":"Private"),h=o.storage[s](["atredir","gopc"]),p=o.storage[s](["atredir","gopc_err"]),_=o.storage[s](["atredir","camp"]),o.storage.del(["atredir","gopc"]),o.storage.del(["atredir","gopc_err"]),o.storage.del(["atredir","camp"]),f=o.storage[s](["atsession","histo_camp"]),E=o.storage[s](["atreman","camp"]),g=o.storage[s](["atreman","date"]),n=o.utils.getLocation(),m=(i=o.utils.getQueryStringValue(d.querystringPrefix+"medium",n))?((i=new("function"==typeof(t=new c).medium[i]?t.medium[i]:t.Custom)).setProperties(n),i.format()):o.utils.getQueryStringValue("xtor",n),T=o.utils.getQueryStringValue("xtdt",n),C=o.utils.getQueryStringValue("xts",n),d.enableUTMTracking&&function(){for(var e,t=d.UTMParameters,i=0;i<t.length;i++)(e=o.utils.getQueryStringValue(t[i],n))&&u(t[i],e)}(),I=o.getContext("forcedCampaign"),v=!!o.getConfig("redirect"),y=!1,(S=!!(m&&T&&C))&&(r=(new Date).getTime()/6e4,y=!v&&C!==o.getConfig("site")||r-T<0||r-T>=o.getConfig("visitLifetime"));var i,r=I||_||m;v&&r&&l("atredir",{path:"/",end:o.getConfig("redirectionLifetime")})&&(o.storage[a](["atredir","camp"],r),i=r=!1,I||(i=_?(r=h,p):(r=S,y)),o.storage[a](["atredir","gopc"],r),o.storage[a](["atredir","gopc_err"],i)),!v&&E&&(u("xtor",E),r=(new Date).getTime()/36e5,r=Math.floor(r-g),u("roinbh",0<=r?r:0)),v||(r=null,r=_?h?I||r:I||_:S?I:I||m||r,(r=f&&f instanceof Array&&-1<f.indexOf(r)?null:r)&&u("xto",r)),v||I||(_?p&&(e=_):y&&(e=m),e&&u("pgt",e)),v||!(e=_?I||_:I||m||null)||!I&&!_&&S&&y||!I&&_&&h&&p||((!f||f instanceof Array&&f.indexOf(e)<0)&&l("atsession",{path:"/",session:60*o.getConfig("visitLifetime")})&&o.storage[a](["atsession","histo_camp"],f&&f.push(e)?f:[e]),E&&!d.lastPersistence||!l("atreman",{path:"/",session:86400*d.lifetime})||(o.storage[a](["atreman","camp"],e),o.storage[a](["atreman","date"],(new Date).getTime()/36e5))),o.emit("Campaigns:process:done",{lvl:"INFO"})})},Echo1202ATInternet.Tracker.addPlugin("Campaigns")}.call(window),function(){var e={};Echo1202ATInternet.Tracker.Plugins.Storage=function(s){var n=this,t=!1,r=null;s.configPlugin("Storage",e,function(e){"localStorage"===e.storageMode&&(t=Echo1202ATInternet.Utils.isLocalStorageAvailable())});function c(e){return s.getConfig("base64Storage")?Echo1202ATInternet.Utils.Base64.encode(e):encodeURIComponent(e)}function a(e){return s.getConfig("base64Storage")?Echo1202ATInternet.Utils.Base64.decode(e):decodeURIComponent(e)}function i(e,t,i){return!i&&u[e]?i=u[e]:(i=h(e))&&(i.options=i.options||{},i.options.session&&"number"==typeof i.options.session&&(i.options.end=i.options.session,p(i,!1)),u[e]=i),i?t?(e=null,e=i&&"object"==typeof i.val&&!(i.val instanceof Array)&&void 0!==i.val[t]?i.val[t]:e):i.val:null}function o(e,t){t?_(e,t,void 0,!0,null):(u[e]=void 0,e=d(e,"",{end:new Date("Thu, 01 Jan 1970 00:00:00 UTC"),path:"/"}),l(e,!0))}var u={},r=new(t?function(){function r(e){var t,i=+new Date,n=!1;return e.options&&(void 0!==e.options.expires?t=e.options.expires:"function"==typeof(e=e.options.end||{}).getTime?t=e.getTime():"number"==typeof e&&(t=i+1e3*e)),{itemToDelete:n="number"==typeof t&&t<=i?!0:n,timestamp:t}}function o(e){var t=!1;try{localStorage.removeItem(e),t=!0}catch(e){}return t}this.getData=function(e){var t,i,n=null;return(t=localStorage.getItem(e))&&(t=a(t),(i=Echo1202ATInternet.Utils.jsonParse(t))&&"object"==typeof i?r(i).itemToDelete&&o(e)||(delete i.options.expires,n=Echo1202ATInternet.Utils.jsonSerialize(i)):n=t),n},this.setData=function(e){var t=!1;if(e.name&&"string"==typeof e.name){var i=r(e);"number"==typeof i.timestamp&&(e.options.expires=i.timestamp);var n=Echo1202ATInternet.Utils.jsonSerialize(e);if(i.itemToDelete)t=o(e.name);else try{localStorage.setItem(e.name,c(n)),t=!0}catch(e){}}return t}}:function(){this.getData=function(e){var t=null;return t=(e=RegExp("(?:^| )"+e+"=([^;]+)").exec(document.cookie)||null)?a(e[1]):t},this.setData=function(e){var t,i,n,r,o,a=!1;return e.name&&"string"==typeof e.name&&(i=(t=e.options||{}).end||{},n=t.domain||s.getConfig("cookieDomain"),r=t.secure||s.getConfig("cookieSecure"),o=Echo1202ATInternet.Utils.jsonSerialize(e),o=(o=(o=e.name+"="+c(o))+(t.path&&"string"==typeof t.path?";path="+t.path:""))+(n&&"string"==typeof n?";domain="+n:"")+(r&&"boolean"==typeof r?";secure":""),"function"==typeof i.toUTCString?o+=";expires="+i.toUTCString():"number"==typeof i&&(o+=";max-age="+i.toString()),document.cookie=o,this.getData(e.name)&&(a=!0)),a}}),l=function(e,t){var i=!1;return i=e&&"object"==typeof e&&(t||Echo1202ATInternet.Utils.consent&&!s.getConfig("disableCookie")&&!s.getConfig("disableStorage"))?r.setData(e):i},d=function(e,t,i){return e={name:e,val:t},i&&i.session&&"number"==typeof i.session&&(i.end=i.session),e.options=i||{},e},h=function(e){var t=null,i=null;return t=(e=i=!s.getConfig("disableCookie")&&!s.getConfig("disableStorage")&&e&&"string"==typeof e?r.getData(e):i)?Echo1202ATInternet.Utils.jsonParse(e):t},p=function(e,t){var i=Echo1202ATInternet.Utils.cloneSimpleObject(e);return l(i,t)?Echo1202ATInternet.Utils.jsonParse(Echo1202ATInternet.Utils.jsonSerialize(e)):null},_=function(e,t,i,n,r){return t?(r=h(e))&&(!r||"object"!=typeof r.val||r.val instanceof Array?r=null:void 0===i?delete r.val[t]:r.val[t]=i,r=r&&p(r,n)):(r=d(e,i,r=r||{}),r=p(r,n)),r?(u[e]=r).val:null};s.storage={},s.storage.getAll=function(){return u},s.storage.get=n.get=function(e,t){return t=!!t,e instanceof Array?i(e[0],e[1],t):i(e,"",t)},s.storage.getPrivate=n.getPrivate=function(e,t){return e instanceof Array?e[0]+=s.getConfig("site"):e+=s.getConfig("site"),n.get(e,t)},s.storage.set=n.set=function(e,t,i,n){var r;return e instanceof Array?(r=e[0],e=e[1],i=null):(r=e,e=null),Echo1202ATInternet.Utils.privacy.testStorageParam(r,e).toSetInStorage||n?_(r,e,t,n,i):null},s.storage.setPrivate=n.setPrivate=function(e,t,i){return e instanceof Array?e[0]+=s.getConfig("site"):e+=s.getConfig("site"),n.set(e,t,i)},s.storage.del=n.del=function(e){e instanceof Array?o(e[0],e[1]):o(e,"")},s.storage.delPrivate=n.delPrivate=function(e){e instanceof Array?e[0]+=s.getConfig("site"):e+=s.getConfig("site"),n.del(e)},s.storage.cacheInvalidation=n.cacheInvalidation=function(){u={}}},Echo1202ATInternet.Tracker.addPlugin("Storage")}.call(window),function(){Echo1202ATInternet.Tracker.Plugins.Utils=function(u){var e=this,o={};u.utils={},u.utils.getQueryStringValue=e.getQueryStringValue=function(e,t){var i=Echo1202ATInternet.Utils.hashcode(t).toString();if(!o[i]){o[i]={};for(var n=RegExp("[&#?]{1}([^&=#?]*)=([^&#]*)?","g"),r=n.exec(t);null!==r;)o[i][r[1]]=r[2],r=n.exec(t)}return o[i].hasOwnProperty(e)?o[i][e]:null},u.utils.manageChapters=e.manageChapters=function(e,t,i){var n="";if(e)for(var r,o=u.getConfig("ignoreEmptyChapterValue"),a=1;a<parseInt(i,10)+1;a++)r=e[t+a]||"",n=o?n+(r?r+"::":""):n+(e.hasOwnProperty(t+a)?r+"::":"");return n},u.utils.getDocumentLevel=e.getDocumentLevel=function(){var e=u.getConfig("documentLevel");return e?e.indexOf(".")<0?window[e]||document:(e=e.split("."),window[e[0]][e[1]]||document):document},u.utils.getLocation=e.getLocation=function(){return e.getDocumentLevel().location.href},u.utils.getHostName=e.getHostName=function(){return e.getDocumentLevel().location.hostname},u.dispatchIndex={},u.dispatchStack=[],u.dispatchEventFor={};var r=0;u.dispatchSubscribe=function(e){return!u.dispatchIndex[e]&&(u.dispatchStack.push(e),u.dispatchIndex[e]=!0)},u.dispatchSubscribed=function(e){return!0===u.dispatchIndex[e]},u.addSpecificDispatchEventFor=function(e){return!u.dispatchEventFor[e]&&(u.dispatchEventFor[e]=!0,r++,!0)},u.processSpecificDispatchEventFor=function(e){u.dispatchEventFor[e]&&(u.dispatchEventFor[e]=!1,0==--r&&(u.dispatchEventFor={},u.emit("Tracker:Plugin:SpecificEvent:Exec:Complete",{lvl:"INFO"})))},u.dispatch=function(i,n){function e(){for(var e,t=null;0<u.dispatchStack.length;)e=u.dispatchStack.pop(),0===u.dispatchStack.length&&(t=i),u[e].onDispatch(t,n);u.dispatchIndex={},u.delContext(void 0,"customObject")}function t(){u.plugins.isExecWaitingLazyloading()?u.onTrigger("Tracker:Plugin:Lazyload:Exec:Complete",function(){e()},!0):e()}0===r?t():u.onTrigger("Tracker:Plugin:SpecificEvent:Exec:Complete",function(){t()},!0)},u.dispatchRedirect=function(e){var t=!0,i="",n=null;return e&&(n=null,e.hasOwnProperty("event")&&(n=e.event||window.event),!Echo1202ATInternet.Utils.isTabOpeningAction(n)&&e.elem&&u.plugins.exec("TechClicks","manageClick",[e.elem,n],function(e){t=e.preservePropagation,i=e.elementType}),n=e.callback),u.dispatch(n,i),t},u.manageSend=function(t){Echo1202ATInternet.Utils.isPreview()&&!u.getConfig("preview")||Echo1202ATInternet.Utils.isPrerender(function(e){t(e)})||t()},u.processTagObject=function(e,t,i){if((e=u.getParam(e,!0))&&e._options.permanent){for(var n=!1,r=e._options.hitType||[],o=0;o<r.length;o++)if(-1!==Echo1202ATInternet.Utils.arrayIndexOf(t.concat("all"),r[o])){n=!0;break}n&&(i=Echo1202ATInternet.Utils.completeFstLevelObj(e._value||{},i,!0))}return i},u.processContextObjectAndSendHit=function(e,t,i,n){var r={hitType:t.hitType,encode:t.encode,separator:t.separator,truncate:t.truncate},o=u.getParam(e,!0);if(o){for(var a=!1,s=o._options.hitType||[],c=0;c<s.length;c++)if(-1!==Echo1202ATInternet.Utils.arrayIndexOf(t.hitType.concat("all"),s[c])){a=!0;break}a?((a=Echo1202ATInternet.Utils.cloneSimpleObject(o))._value=Echo1202ATInternet.Utils.completeFstLevelObj(a._value||{},i,!0),u.setParam(e,a._value,r),u.manageSend(function(){u.sendHit(null,[["hitType",t.hitType]],n,t.requestMethod,t.elementType)}),o._options.permanent&&u.setParam(e,o._value,o._options)):(u.setParam(e,i,r),u.manageSend(function(){u.sendHit(null,[["hitType",t.hitType]],n,t.requestMethod,t.elementType)}),u.setParam(e,o._value,o._options))}else u.setParam(e,i,r),u.manageSend(function(){u.sendHit(null,[["hitType",t.hitType]],n,t.requestMethod,t.elementType)})}},Echo1202ATInternet.Tracker.addPlugin("Utils")}.call(window),function(){var e={clicksAutoManagementEnabled:!0,clicksAutoManagementTimeout:500};Echo1202ATInternet.Tracker.Plugins.TechClicks=function(t){var a,s,c=this,n=["Tracker:Hit:Sent:Ok","Tracker:Hit:Sent:Error","Tracker:Hit:Sent:NoTrack"],i=!1;t.configPlugin("TechClicks",e,function(e){a=e.clicksAutoManagementEnabled,s=e.clicksAutoManagementTimeout});function u(e){e.mailto?c.timeout=setTimeout(function(){window.location.href=e.mailto},e.timeout):e.form?c.timeout=setTimeout(function(){e.form.submit()},e.timeout):e.url&&(c.timeout=setTimeout(function(){d({url:e.url,target:e.target})},e.timeout))}function l(i){for(var e=0;e<n.length;e++)t.onTrigger(n[e],function(e,t){i&&i(t)})}var d=function(e){if(!i)switch(i=!0,e.target){case"_top":window.top.location.href=e.url;break;case"_parent":window.parent.location.href=e.url;break;default:window.location.href=e.url}};c.isFormSubmit=function(e){for(;e;){if("FORM"===e.nodeName)return!0;e=e.parentNode}return!1},t.techClicks={},t.techClicks.manageClick=c.manageClick=function(e,t){var i,n,r=!0,o="";if(a&&e){e:{for(o=e;o;){if("function"==typeof o.getAttribute&&("_blank"===o.getAttribute("target")||"no"===o.getAttribute("data-atclickmanagement"))){i=!0;break e}o=o.parentNode}o=e,i=window.location.href;for(;o;){if((n=o.href)&&0<=n.indexOf("#")&&i.substring(0,0<=i.indexOf("#")?i.indexOf("#"):i.length)===n.substring(0,n.indexOf("#"))){i=!0;break e}o=o.parentNode}i=!1}if(o=function(e){for(var t=e;t;){if(t.href){if(0<=t.href.indexOf("mailto:"))return Echo1202ATInternet.Utils.CLICKS_MAILTO;if(0===t.href.indexOf("http"))return Echo1202ATInternet.Utils.CLICKS_REDIRECTION}else if("FORM"===t.nodeName){var i=e;if(e=!1,i&&("form"===(t=(t=i.tagName||"").toLowerCase())?e=!0:(i=(i=i.getAttribute("type")||"").toLowerCase(),"button"===t?"reset"!==i&&"button"!==i&&(e=!0):"input"===t&&"submit"===i&&(e=!0))),e)return Echo1202ATInternet.Utils.CLICKS_FORM;break}t=t.parentNode}return""}(e),!i&&o){switch(o){case Echo1202ATInternet.Utils.CLICKS_MAILTO:!function(){for(var t=e;t&&!(t.href&&0<=t.href.indexOf("mailto:"));)t=t.parentNode;t&&(l(function(e){e.details.isMultiHit||e.details.elementType!==Echo1202ATInternet.Utils.CLICKS_MAILTO||(c.timeout&&clearTimeout(c.timeout),window.location.href=t.href)}),u({mailto:t.href,timeout:s}))}(),r=!1;break;case Echo1202ATInternet.Utils.CLICKS_FORM:!function(){for(var t=e;t&&"FORM"!==t.nodeName;)t=t.parentNode;t&&(l(function(e){e.details.isMultiHit||e.details.elementType!==Echo1202ATInternet.Utils.CLICKS_FORM||(c.timeout&&clearTimeout(c.timeout),t.submit())}),u({form:t,timeout:s}))}(),r=!1;break;case Echo1202ATInternet.Utils.CLICKS_REDIRECTION:(function(e){for(var t,i="_self";e;){if(e.href&&0===e.href.indexOf("http")){t=e.href.split('"').join('\\"'),i=e.target||i;break}e=e.parentNode}t&&(l(function(e){e.details.isMultiHit||e.details.elementType!==Echo1202ATInternet.Utils.CLICKS_REDIRECTION||(c.timeout&&clearTimeout(c.timeout),d({url:t,target:i}))}),u({url:t,target:i,timeout:s}))})(e),r=!1}t&&(i=t.defaultPrevented,(i="function"==typeof t.isDefaultPrevented?t.isDefaultPrevented():i)||t.preventDefault&&t.preventDefault())}}return{preservePropagation:r,elementType:o}},t.techClicks.deactivateAutoManagement=function(){a=!1}},Echo1202ATInternet.Tracker.addPlugin("TechClicks")}.call(window),function(){var e={requestMethod:"POST"};Echo1202ATInternet.Tracker.Plugins.Clicks=function(o){var a={};o.configPlugin("Clicks",e,function(e){a=e});function s(e){var t="";switch(e){case"exit":t="S";break;case"download":t="T";break;case"action":t="A";break;case"navigation":t="N"}return t}function c(e){return o.utils.manageChapters(e,"chapter",3)+(e.name||"")}function r(e,t){var i={p:c(e),s2:e.level2||"",click:s(e.type)||""},n=["click"],r=o.getContext("page")||{};i.pclick=c(r),i.s2click=r.level2||"",(r=e.customObject)&&(r=o.processTagObject("stc",n,r),i.stc={_value:Echo1202ATInternet.Utils.jsonSerialize(r),_options:{hitType:n,encode:!0,separator:",",truncate:!0}}),o.sendHit(i,[["hitType",n]],e.callback,a.requestMethod,t)}o.click={},o.clickListener={},o.click.send=function(e){var t=!0,i="",n=null;return(e=e||{}).hasOwnProperty("event")&&(n=e.event||window.event),!e.elem||"POST"===a.requestMethod&&Echo1202ATInternet.Utils.isBeaconMethodAvailable()||Echo1202ATInternet.Utils.isTabOpeningAction(n)||(t=(i=o.techClicks.manageClick(e.elem,n)).preservePropagation,i=i.elementType),r(e,i),t},o.clickListener.send=function(t){var i,n;(t=t||{}).elem&&(i="click",n="",o.plugins.exec("TechClicks","isFormSubmit",[t.elem],function(e){i=e?"submit":"click"}),Echo1202ATInternet.Utils.addEvtListener(t.elem,i,function(e){"POST"===a.requestMethod&&Echo1202ATInternet.Utils.isBeaconMethodAvailable()||Echo1202ATInternet.Utils.isTabOpeningAction(e)||(n=o.techClicks.manageClick(t.elem,e).elementType),r(t,n)}))},o.click.set=function(e){e=e||{},o.dispatchSubscribe("click"),o.setContext("click",{name:c(e),level2:e.level2||"",customObject:e.customObject}),o.setParam("click",s(e.type)||"",{hitType:["click"]})},o.click.onDispatch=function(e,t){var i=["click"],n=o.getContext("click")||{},r=o.getContext("page")||{};o.setParam("pclick",c(r),{hitType:i}),o.setParam("s2click",r.level2||"",{hitType:i}),o.setParam("p",n.name,{hitType:i}),o.setParam("s2",n.level2,{hitType:i}),(n=n.customObject)?o.processContextObjectAndSendHit("stc",{hitType:i,encode:!0,separator:",",truncate:!0,requestMethod:a.requestMethod,elementType:t},n,e):o.manageSend(function(){o.sendHit(null,[["hitType",i]],e,a.requestMethod,t)}),o.delContext("click")}},Echo1202ATInternet.Tracker.addPlugin("Clicks")}.call(window),function(){var d={clientSideMode:"always",userIdCookieDuration:397,userIdExpirationMode:"relative",optOut:"OPT-OUT",userIdStorageName:"atuserid",userIdHitName:"idclient",itpCompliant:!1,baseDomain:""};Echo1202ATInternet.Tracker.Plugins.ClientSideUserId=function(n){var t,r={},i=!1,o=null;n.configPlugin("ClientSideUserId",d,function(e){r=e});function e(){var e;("relative"===r.userIdExpirationMode||"fixed"===r.userIdExpirationMode&&null===o.storageUserId||o.isFromTrackerContext)&&((e=new Date).setTime(e.getTime()+864e5*r.userIdCookieDuration),n.storage.set(r.userIdStorageName,o.finalUserId,{end:e,path:"/"},o.forceStorage),Echo1202ATInternet.Utils.consent&&!o.isFromTrackerContext&&o.finalUserId!==n.storage.get(r.userIdStorageName,!0)&&n.setParam(r.userIdHitName,o.finalUserId+"-NO",{multihit:!0,permanent:!0,hitType:["all"]}))}function a(){u();var e,t=!1;if(null===Echo1202ATInternet.Utils.optedOut?n.storage.get(r.userIdStorageName,!0)===r.optOut?t=Echo1202ATInternet.Utils.optedOut=!0:Echo1202ATInternet.Utils.optedOut=!1:!1===Echo1202ATInternet.Utils.optedOut&&(n.getParam(r.userIdHitName)===r.optOut&&n.delParam(r.userIdHitName),n.storage.get(r.userIdStorageName,!0)===r.optOut&&n.storage.del(r.userIdStorageName)),o.optout.isOptedout=Echo1202ATInternet.Utils.optedOut,o.optout.fromStorage=t,o.contextUserId=n.getContext("userIdentifier"),o.storageUserId=n.storage.get("atuserid",!0),t=!1,"required"===r.clientSideMode?(e="",window.navigator&&(e=window.navigator.userAgent),(/Safari/.test(e)&&!/Chrome/.test(e)||/iPhone|iPod|iPad/.test(e))&&(t=!0)):"always"===r.clientSideMode&&(t=!0),i=t,t=!1,!n.getConfig("forceHttp")&&r.itpCompliant&&void 0===o.contextUserId&&!o.optout.isOptedout)switch(r.clientSideMode){case"never":t=c();break;case"always":case"required":i&&null!==o.storageUserId||(t=c())}t||!i&&!o.optout.isOptedout&&void 0===o.contextUserId?n.setConfig("userIdOrigin","server"):(n.setConfig("userIdOrigin","client"),o.isFromTrackerContext=!1,o.forceStorage=!1,o.optout.isOptedout?(o.finalUserId=r.optOut,o.isFromTrackerContext=!o.optout.fromStorage,o.forceStorage=!0):n.getConfig("disableCookie")||n.getConfig("disableStorage")?(o.finalUserId=n.getParam(r.userIdHitName),o.isFromTrackerContext=!0):void 0!==o.contextUserId?(o.finalUserId=o.contextUserId,o.isFromTrackerContext=!0):o.finalUserId=null!==o.storageUserId?o.storageUserId:Echo1202ATInternet.Utils.uuid().v4(),l())}function s(e){(e=e&&e.detail)&&"clientsideuserid"===e.name&&e.id===t&&a()}var c=function(){var e=r.baseDomain;e||(t=n.getConfig("cookieDomain"))&&"."===(e=t).charAt(0)&&(e=e.substring(1,e.length));var t=n.builder.getCollectDomain(),i=n.utils.getHostName();return!!(e&&t&&i&&-1!==t.indexOf(e)&&-1!==i.indexOf(e))},u=function(){o={contextUserId:void 0,storageUserId:null,finalUserId:null,isFromTrackerContext:!1,forceStorage:!1,optout:{isOptedout:!1,fromStorage:!1}}},l=function(){n.setParam(r.userIdHitName,o.finalUserId,{multihit:!0,permanent:!0,hitType:["all"]}),e()};n.plugins.waitForDependencies(["Storage","Utils"],function(){var e=Echo1202ATInternet.Utils.uuid();t=parseInt(e.num(8)),Echo1202ATInternet.Utils.removeOptOutEvent(s),Echo1202ATInternet.Utils.addOptOutEvent(t,s),a()}),n.clientSideUserId={},n.clientSideUserId.set=function(e){o.optout.isOptedout||(o.finalUserId=e,o.isFromTrackerContext=!0,o.forceStorage=!1,l())},n.clientSideUserId.store=function(){o.finalUserId=n.getParam(r.userIdHitName)||o.finalUserId,null!==o.finalUserId&&o.finalUserId!==Echo1202ATInternet.Utils.privacy.CONSENTNO&&o.finalUserId!==o.storageUserId&&(o.isFromTrackerContext=!0,o.forceStorage=!0,e())},n.clientSideUserId.get=function(){return o.finalUserId=n.getParam(r.userIdHitName)||o.finalUserId,o.finalUserId},n.clientSideUserId.clear=function(){u(),n.delParam(r.userIdHitName),n.storage.del(r.userIdStorageName)}},Echo1202ATInternet.Tracker.addPlugin("ClientSideUserId")}.call(window),function(){var e={domainAttribution:!0};Echo1202ATInternet.Tracker.Plugins.ContextVariables=function(r){var o,a,s,c,u="",l={};r.configPlugin("ContextVariables",e,function(e){l=e}),r.setConfig("redirectionLifetime",30,!0);function d(e,t){var i=null;return r.plugins.exec("Storage",e,t,function(e){i=e}),i}r.plugins.waitForDependencies(["Storage","Utils"],function(){s="set"+(l.domainAttribution?"":"Private"),c="get"+(l.domainAttribution?"":"Private");var e,t=r.utils.getLocation();if(void 0===(u=r.utils.getQueryStringValue("xtref",t))&&(u=""),o=r.getContext("forcedReferer"),r.getConfig("redirect")){var i,n,t=r.utils.getDocumentLevel();(i=t=o||(null!==u?u:t?t.referrer:"acc_dir"))&&(i={path:"/",end:r.getConfig("redirectionLifetime")},i=null!==(n=d(c,["atredir"]))?"object"==typeof n&&!(n instanceof Array):(d(s,["atredir",{},i]),!0)),i&&d(s,[["atredir","ref"],t])}else{a=d(c,[["atredir","ref"]]),d("del",[["atredir","ref"]]),r.setParam("vtag",r.version,{permanent:!0,hitType:["all"]}),r.setParam("ptag","js",{permanent:!0,hitType:["all"]}),t="";try{t+=window.screen.width+"x"+window.screen.height+"x"+window.screen.pixelDepth+"x"+window.screen.colorDepth}catch(e){}r.setParam("r",t,{permanent:!0,hitType:["all"]}),t="",window.innerWidth?t+=window.innerWidth+"x"+window.innerHeight:document.body&&document.body.offsetWidth&&(t+=document.body.offsetWidth+"x"+document.body.offsetHeight),r.setParam("re",t,{permanent:!0,hitType:["all"]}),r.setParam("hl",function(){var e=new Date;return e.getHours()+"x"+e.getMinutes()+"x"+e.getSeconds()},{permanent:!0,hitType:["all"]}),window.navigator&&r.setParam("lng",window.navigator.language||window.navigator.userLanguage,{permanent:!0,hitType:["all"]}),t=Echo1202ATInternet.Utils.uuid().num(13),r.setParam("idp",t,{permanent:!0,hitType:["page","clickzone"]}),window.navigator&&r.setParam("jv",window.navigator.javaEnabled()?"1":"0",{hitType:["page"]}),t=r.utils.getDocumentLevel(),r.setParam("ref",(e=t,e=(e=o||("acc_dir"===u?"":null!==u?u:"acc_dir"===a?"":a||(e?e.referrer:"")))?e.replace(/[<>]/g,"").substring(0,1600).replace(/&/g,"$"):e),{permanent:!0,last:!0,hitType:["page","ecommerce","avinsights","events"]})}r.emit("ContextVariables:Ready",{lvl:"INFO"})})},Echo1202ATInternet.Tracker.addPlugin("ContextVariables")}.call(window),function(){var e={storageCapacity:1,timeout:500};Echo1202ATInternet.Tracker.Plugins.Offline=function(a){function s(i,n,r,o){var e,t;window.navigator&&window.navigator.onLine?0<(e=l()).length?(t=e.shift(),_({hits:e}),u||(a.onTrigger("Tracker:Hit:Sent:Ok",function(e,t){i&&t.details.hit===i||s(i,n,r,o)},!1),a.onTrigger("Tracker:Hit:Sent:Error",function(e,t){i&&t.details.hit===i||s(i,n,r,o)},!1),u=!0),a.sendUrl(t,null,"GET",o)):i&&(a.utils.getQueryStringValue("a",i)?setTimeout(function(){a.sendUrl(i,null,null,null)},c.timeout):a.sendUrl(i,n,r,o)):i&&(h(d(i)),n&&n())}var c={},u=!1;a.configPlugin("Offline",e,function(e){c=e});function l(){return p().hits}function d(e){var t;return e&&(e=e.split(/&ref=\.*/i),t="&cn=offline&olt="+String(Math.floor((new Date).getTime()/1e3)),e=e[0]+t+(e[1]?"&ref="+e[1]:"")),e}function h(e){var t=p(),i=e.length,n=!0;if(4*((t.length||11)+i)>1048576*c.storageCapacity){n=!1;var r=t.hits.shift();if(void 0!==r)for(var n=!0,o=r.length;o<i;){if(void 0===(r=t.hits.shift())){n=!1;break}o+=r.length}}n&&(t.hits.push(e),_({hits:t.hits}))}function i(r){a.builder.sendUrl=function(e,t,i,n){r||window.navigator&&!window.navigator.onLine?(h(d(e)),t&&t()):s(e,t,i,n)}}var p=function(){var e,t=localStorage.getItem("ATOffline"),i={hits:[],length:0};return t&&(e=Echo1202ATInternet.Utils.jsonParse(t)||{hits:[]},i.hits=e.hits,i.length=t.length),i},_=function(e){try{localStorage.setItem("ATOffline",Echo1202ATInternet.Utils.jsonSerialize(e))}catch(e){}};a.offline={},a.offline.getLength=function(){return 4*p().length},a.offline.remove=function(){_({hits:[]})},a.offline.get=l,a.offline.send=function(){s(null,null,"GET")},a.plugins.waitForDependencies(["Utils"],function(){var e,t=Echo1202ATInternet.Utils.isLocalStorageAvailable();window.navigator&&(e=window.navigator.onLine),t&&void 0!==e&&("required"===c.storageMode?i(!1):"always"===c.storageMode&&i(!0)),a.emit("Offline:Ready",{lvl:"INFO",details:{isLocalStorageAvailable:t,storageMode:c.storageMode,isOnline:e}})})},window.Echo1202ATInternet.Tracker.addPlugin("Offline")}.call(window),function(){Echo1202ATInternet.Tracker.Plugins.OnSiteAds=function(a){function s(e){return a.utils.manageChapters(e,"chapter",3)+(e.name||"")}function c(e,t){if(t=o(e,t)){e=o(e,"prefix");if(t.campaignId){var e=e||"PUB",i=o(t,"campaignId"),n=o(t,"creation");return e+"-"+i+"-"+n+"-"+o(t,"variant")+"-"+o(t,"format")+"-"+o(t,"generalPlacement")+"-"+o(t,"detailedPlacement")+"-"+o(t,"advertiserId")+"-"+o(t,"url")}if(t.adId)return(e=e||"INT")+"-"+(i=o(t,"adId"))+"-"+(n=o(t,"format"))+"||"+o(t,"productId")}return""}function t(e,t){var i=a.buffer.get("ati",!0)||{};i._value="string"==typeof i._value?[i._value]:i._value||[],i._options=i._options||{truncate:!0,hitType:[t,"page"]},i._value.push(e),a.buffer.set("ati",i._value,i._options)}function i(e,t){(e=e||{}).click?a.setParam("atc",c(e,"click"),{truncate:!0,hitType:[t,"page"]}):e.impression&&a.setParam("ati",c(e,"impression"),{truncate:!0,hitType:[t,"page"]}),e.customObject&&(a.setContext("onsiteads",{customObject:e.customObject}),(t=a.getContext("page")||{}).customObject=Echo1202ATInternet.Utils.completeFstLevelObj(t.customObject,e.customObject,!1),a.setContext("page",t)),a.dispatchSubscribe("onSiteAds")}var n,r=this,o=function(e,t){return e&&e[t]?e[t]:""};a.selfPromotion={},a.publisher={},a.publisher.set=function(e){i(e,"publisher")},a.selfPromotion.set=function(e){i(e,"selfPromotion")},a.publisher.add=function(e){t(c(e,"impression"),"publisher"),a.dispatchSubscribe("onSiteAds")},a.selfPromotion.add=function(e){t(c(e,"impression"),"selfPromotion"),a.dispatchSubscribe("onSiteAds")},r.advertEvent=function(e){var t,i,n=!0,r="",o=null;return(e=e||{}).hasOwnProperty("event")&&(o=e.event||window.event),!Echo1202ATInternet.Utils.isTabOpeningAction(o)&&e.elem&&(n=(r=a.techClicks.manageClick(e.elem,o)).preservePropagation,r=r.elementType),e.click?(e=e||{},o=["onSiteAdsClick"],t=a.getContext("page")||{},(i={}).atc={_value:c(e,"click"),_options:{truncate:!0}},i.type="AT",i.patc=s(t),i.s2atc=t.level2||"",(t=e.customObject)&&(t=a.processTagObject("stc",o,t),i.stc={_value:Echo1202ATInternet.Utils.jsonSerialize(t),_options:{hitType:o,encode:!0,separator:",",truncate:!0}}),a.sendHit(i,[["hitType",o]],e.callback,null,r)):e.impression&&function(e,t){var i=["onSiteAdsImpression"],n={};n.ati={_value:c(e=e||{},"impression"),_options:{hitType:i,truncate:!0}},n.type="AT",Echo1202ATInternet.Utils.isPreview()&&a.getConfig("preview")&&(n.pvw=1);var r=e.customObject;r&&(r=a.processTagObject("stc",i,r),n.stc={_value:Echo1202ATInternet.Utils.jsonSerialize(r),_options:{hitType:i,encode:!0,separator:",",truncate:!0}}),a.manageSend(function(){a.sendHit(n,[["hitType",i]],e.callback,null,t)})}(e,r),n},a.publisher.send=function(e){return r.advertEvent(e)},a.selfPromotion.send=function(e){return r.advertEvent(e)},a.onSiteAds={},a.onSiteAds.onDispatch=function(e,t){var i,n;a.dispatchSubscribed("page")||(a.setParam("type","AT",{hitType:["publisher","selfPromotion"]}),i=a.getContext("page")||{},a.getParam("atc")&&(a.setParam("patc",s(i),{hitType:["publisher","selfPromotion"]}),a.setParam("s2atc",i.level2||"",{hitType:["publisher","selfPromotion"]})),Echo1202ATInternet.Utils.isPreview()&&a.getConfig("preview")&&a.setParam("pvw",1),n=["publisher","selfPromotion"],(i=(a.getContext("onsiteads")||{}).customObject)?a.processContextObjectAndSendHit("stc",{hitType:n,encode:!0,separator:",",truncate:!0,elementType:t},i,e):a.manageSend(function(){a.sendHit(null,[["hitType",n]],e,null,t)}))},a.plugins.waitForDependencies(["Utils","TechClicks"],function(){n=document.location.href;var e=a.utils.getQueryStringValue("xtatc",n);e&&a.setParam("atc",e,{hitType:["publisher","selfPromotion","page"]}),a.emit("OnSiteAds:Ready",{lvl:"INFO",details:{href:n}})})},Echo1202ATInternet.Tracker.addPlugin("OnSiteAds")}.call(window),function(){Echo1202ATInternet.Tracker.Plugins.Page=function(a){function s(e){return a.utils.manageChapters(e,"chapter",3)+(e.name||"")}function c(e,t,i){return t?e=t:e||void 0===i||(e=i),e}function u(e,t,i){t.hasOwnProperty(i)&&(e[i]=c(e[i],t[i],void 0))}function l(e,t,i){if(t)for(var n=0;n<f.length;n++)if(t.hasOwnProperty(f[n])&&t[f[n]])for(var r in t[f[n]])t[f[n]].hasOwnProperty(r)&&(i?e[E[n]+r]=t[f[n]][r]:a.setParam(E[n]+r,t[f[n]][r]))}function d(e,t,i){if(t){var n=a.utils.manageChapters(t,"chapter",3);for(n&&(t.chapterLabel=n.replace(/::$/gi,"")),n=0;n<o.length;n++)t.hasOwnProperty(r[n])&&(i?e[o[n]]=t[r[n]]:a.setParam(o[n],t[r[n]]))}}function h(e,t,i){if(t&&t.keywords instanceof Array){var n=t.keywords.length;if(0<n){for(var r="",o=0;o<n;o++)r+="["+t.keywords[o]+"]"+(o<n-1?"|":"");i?e.tag=r:a.setParam("tag",r)}}}function p(e,t,i){var n,r;t&&(r=(n=function(e){return e||"0"})(t.category1)+"-",r+=n(t.category2)+"-",r+=n(t.category3),i?e.ptype=r:a.setParam("ptype",r))}function _(e,t,i){if(t)for(var n in t)t.hasOwnProperty(n)&&void 0!==t[n]&&(i?e[n]=t[n]:a.setParam(n,t[n]))}var r=["pageId","chapterLabel","update"],o=["pid","pchap","pidt"],f=["page","site"],E=["f","x"];a.customVars={},a.customVars.set=function(e){var t=a.getContext("page")||{},i=t.customVars;if(i){if(e)for(var n in e)e.hasOwnProperty(n)&&(i[n]=Echo1202ATInternet.Utils.completeFstLevelObj(i[n],e[n],!0))}else i=e;t.customVars=i,a.setContext("page",t)},a.dynamicLabel={},a.dynamicLabel.set=function(e){var t=a.getContext("page")||{};t.dynamicLabel=Echo1202ATInternet.Utils.completeFstLevelObj(t.dynamicLabel,e,!0),a.setContext("page",t)},a.tags={},a.tags.set=function(e){var t=a.getContext("page")||{};t.tags=Echo1202ATInternet.Utils.completeFstLevelObj(t.tags,e,!0),a.setContext("page",t)},a.customTreeStructure={},a.customTreeStructure.set=function(e){var t=a.getContext("page")||{};t.customTreeStructure=Echo1202ATInternet.Utils.completeFstLevelObj(t.customTreeStructure,e,!0),a.setContext("page",t)},a.page={},a.page.reset=function(){a.delContext("page")},a.page.set=function(e){e=e||{},a.dispatchSubscribe("page");var t=a.getContext("page")||{};t.name=c(t.name,e.name,""),t.level2=c(t.level2,e.level2,""),u(t,e,"chapter1"),u(t,e,"chapter2"),u(t,e,"chapter3"),t.customObject=Echo1202ATInternet.Utils.completeFstLevelObj(t.customObject,e.customObject,!0),a.setContext("page",t)},a.page.send=function(e){var t,i,n=!0,r="",o={p:s(e=e||{}),s2:e.level2||""};return(i=e.customObject)&&(i=a.processTagObject("stc",t=["page"],i),o.stc={_value:Echo1202ATInternet.Utils.jsonSerialize(i),_options:{hitType:t,encode:!0,separator:",",truncate:!0}}),(i=a.getContext("page")||{}).vrn&&(o.vrn=i.vrn,a.delContext("page","vrn")),void 0!==(t=a.getContext("InternalSearch")||{}).keyword&&(o.mc=Echo1202ATInternet.Utils.cloneSimpleObject(t.keyword),void 0!==t.resultPageNumber&&(o.np=Echo1202ATInternet.Utils.cloneSimpleObject(t.resultPageNumber)),a.delContext("InternalSearch")),Echo1202ATInternet.Utils.isPreview()&&a.getConfig("preview")&&(o.pvw=1),l(o,e.customVars,!0),d(o,e.dynamicLabel,!0),h(o,e.tags,!0),p(o,e.customTreeStructure,!0),t=a.getContext("campaigns")||{},_(o,t,!0),a.delContext("campaigns"),t=null,e&&e.hasOwnProperty("event")&&(t=e.event||window.event),!Echo1202ATInternet.Utils.isTabOpeningAction(t)&&e.elem&&(n=(t=a.techClicks.manageClick(e.elem,t)).preservePropagation,r=t.elementType),a.manageSend(function(){a.sendHit(o,null,e.callback,null,r)}),i.name=c(i.name,e.name,""),i.level2=c(i.level2,e.level2,""),u(i,e,"chapter1"),u(i,e,"chapter2"),u(i,e,"chapter3"),a.setContext("page",i),n},a.page.onDispatch=function(e,t){var i=a.getContext("page")||{},n=a.getContext("InternalSearch")||{};a.setParam("p",s(i)),a.setParam("s2",i.level2||""),i.vrn&&(a.setParam("vrn",i.vrn),a.delContext("page","vrn")),void 0!==n.keyword&&(a.setParam("mc",Echo1202ATInternet.Utils.cloneSimpleObject(n.keyword)),void 0!==n.resultPageNumber&&a.setParam("np",Echo1202ATInternet.Utils.cloneSimpleObject(n.resultPageNumber)),a.delContext("InternalSearch")),Echo1202ATInternet.Utils.isPreview()&&a.getConfig("preview")&&a.setParam("pvw",1),l(null,i.customVars,!1),d(null,i.dynamicLabel,!1),h(null,i.tags,!1),p(null,i.customTreeStructure,!1),n=a.getContext("campaigns")||{},_(null,n,!1),a.delContext("campaigns");var r=["page"];(i=i.customObject)?a.processContextObjectAndSendHit("stc",{hitType:r,encode:!0,separator:",",truncate:!0,elementType:t},i,e):a.manageSend(function(){a.sendHit(null,[["hitType",r]],e,null,t)})}},Echo1202ATInternet.Tracker.addPlugin("Page")}.call(window),function(){window.Echo1202ATInternet.Tracker.Plugins.RichMedia=function(s){function c(e,t){return(e=parseInt(e,10))?Math.max(e,t):0}function u(e,t,i){return s.utils.manageChapters(e,t,3)+(e[i]||"")}function l(e,t,i,n){var r=e[t];return r="boolean"==typeof e[t]?e[t]?n:i:r}function d(e){var t=0;return t=/^(\-|\+)?([0-9]+)$/.test(e)?Number(e):t}function h(e,t,i,n,r){void 0!==(t=_.getMediaValue(t,i,n))&&(e[n]=r?encodeURIComponent(t):t)}function p(e,t,i){void 0!==i&&(e[t]=i)}var _=new function(){this.media=function(){this.type=void 0,this.plyr=0,this.clnk=this.s2=void 0,this.p="",this.m9=this.m6=this.m5=this.m1=this.rfsh=this.buf=this.a=void 0},this.mediaAll={},this.setMediaValue=function(e,t,i,n){void 0!==n&&(this.mediaAll[e]=this.mediaAll[e]||{},this.mediaAll[e][t]=this.mediaAll[e][t]||new this.media,this.mediaAll[e][t][i]=n)},this.getMediaValue=function(e,t,i){if(this.mediaAll[e]&&this.mediaAll[e][t])return this.mediaAll[e][t][i]},this.removePlayer=function(e){this.mediaAll[e]={}},this.removeAll=function(){this.mediaAll={}}},f=new function(){this.timeout={},this.setTimeout=function(e,t,i){this.timeout[e]=this.timeout[e]||{},this.timeout[e][t]&&window.clearTimeout(this.timeout[e][t]),this.timeout[e][t]=window.setTimeout(function(){s.richMedia.send({action:"refresh",playerId:e,mediaLabel:t})},1e3*i)},this.setTimeoutObject=function(e,t,i){if(this.timeout[e]=this.timeout[e]||{},void 0===this.timeout[e][t]){var n,r=[];for(n in i)i.hasOwnProperty(n)&&r.push({delay:c(n,0),refresh:c(i[n],5)});r.sort(function(e,t){return e.delay<t.delay?-1:e.delay>t.delay?1:0}),this.timeout[e][t]={refreshTab:r,backupRefreshTab:Echo1202ATInternet.Utils.cloneSimpleObject(r),delayConfiguration:{}}}var o,a;0<(i=this.timeout[e][t]).refreshTab.length&&(r=i.refreshTab[0].delay,n=i.refreshTab[0].refresh,"number"==typeof r&&"number"==typeof n&&0<n)&&(i.delayConfiguration[r]=i.delayConfiguration[r]||{},void(a=0)===(o=(o=void 0)!==i.refreshTab[1]?i.refreshTab[1].delay:o)?a=1:"number"==typeof i.delayConfiguration[r].number?a="refresh"===_.getMediaValue(e,t,"a")?Math.max(i.delayConfiguration[r].number-1,0):i.delayConfiguration[r].number:"number"==typeof o&&(a=Math.floor(60*(o-r)/n)-1),i.delayConfiguration[r].number=a,i.delayConfiguration[r].timeout&&window.clearTimeout(i.delayConfiguration[r].timeout),0<a?i.delayConfiguration[r].timeout=window.setTimeout(function(){s.richMedia.send({action:"refresh",playerId:e,mediaLabel:t})},1e3*n):(i.delayConfiguration[r].number=void 0,i.delayConfiguration[r].timeout=void 0,i.refreshTab.splice(0,1),window.setTimeout(function(){s.richMedia.send({action:"refresh",playerId:e,mediaLabel:t})},1e3*n)),this.timeout[e][t]=i)},this.clearTimeout=function(e,t,i){this.timeout[e]=this.timeout[e]||{};var n,r,o=this.timeout[e][t];if("object"==typeof o){if("object"==typeof o.delayConfiguration){for(r in o.delayConfiguration)o.delayConfiguration.hasOwnProperty(r)&&void 0!==(n=o.delayConfiguration[r].number)&&0<n&&(o.delayConfiguration[r].timeout&&window.clearTimeout(o.delayConfiguration[r].timeout),o.delayConfiguration[r].timeout=void 0);i&&(o.refreshTab=Echo1202ATInternet.Utils.cloneSimpleObject(o.backupRefreshTab)),this.timeout[e][t]=o}}else o&&window.clearTimeout(o)},this.removePlayer=function(e){for(var t in this.timeout[e]){var i;this.timeout[e].hasOwnProperty(t)&&(this.clearTimeout(e,t,!1),i=_.getMediaValue(e,t,"a"),void 0!==this.timeout[e][t]&&"stop"!==i&&s.richMedia.send({action:"stop",playerId:e,mediaLabel:t}))}this.timeout[e]={}},this.removeAll=function(){for(var e in this.timeout)this.timeout.hasOwnProperty(e)&&this.removePlayer(e);this.timeout={}}};s.richMedia={},s.richMedia.add=function(e){var t=d((e=e||{}).playerId),i=u(e,"mediaTheme","mediaLabel"),n=l(e,"isEmbedded","int","ext");_.setMediaValue(t,i,"plyr",t),_.setMediaValue(t,i,"type",e.mediaType),_.setMediaValue(t,i,"s2",e.mediaLevel2),_.setMediaValue(t,i,"p",i),_.setMediaValue(t,i,"clnk",e.linkedContent||e.previousMedia),_.setMediaValue(t,i,"a",e.action),_.setMediaValue(t,i,"rfsh",e.refreshDuration),_.setMediaValue(t,i,"m1",e.duration),_.setMediaValue(t,i,"m5",n),_.setMediaValue(t,i,"m6",e.broadcastMode),_.setMediaValue(t,i,"m9",e.webdomain)},s.richMedia.send=function(e){var t=d((e=e||{}).playerId),i=u(e,"mediaTheme","mediaLabel"),n=e.action;_.setMediaValue(t,i,"a",n);var r,o,a={plyr:t,p:i};h(a,t,i,"a",!1),h(a,t,i,"type",!1),h(a,t,i,"s2",!1),h(a,t,i,"m1",!1),h(a,t,i,"m5",!1),h(a,t,i,"m6",!1),"play"!==n&&"info"!==n||(e=l(e,"isBuffering","0","1"),o=s.getContext("page")||{},r=u(o,"chapter","name")||void 0,o=o.level2||void 0,p(a,"buf",e),p(a,"prich",r),p(a,"s2rich",o),h(a,t,i,"clnk",!1),h(a,t,i,"m9",!0)),s.sendHit(a,[["hitType",["richmedia"]]],null,null,null),"pause"===n?f.clearTimeout(t,i,!1):"stop"===n&&f.clearTimeout(t,i,!0),"play"!==n&&"refresh"!==n||("object"==typeof(n=_.getMediaValue(t,i,"rfsh"))&&null!==n?f.setTimeoutObject(t,i,n):0!==(n=c(n,5))&&f.setTimeout(t,i,n))},s.richMedia.remove=function(e){f.removePlayer(e),_.removePlayer(e)},s.richMedia.removeAll=function(){f.removeAll(),_.removeAll()}},window.Echo1202ATInternet.Tracker.addPlugin("RichMedia")}.call(window),"function"==typeof window.Echo1202ATInternet.onTrackerLoad&&window.Echo1202ATInternet.onTrackerLoad(),Echo1202ATInternet}.call(t,i,t,e))||(e.exports=t)},function(e,t,i){var n=i(46),r=i(47),i=r;i.v1=n,i.v4=r,e.exports=i},function(e,t,i){var l,d,h=i(22),p=i(23),_=0,f=0;e.exports=function(e,t,i){var n=t&&i||0,r=t||[],o=(e=e||{}).node||l,a=void 0!==e.clockseq?e.clockseq:d;null!=o&&null!=a||(c=h(),null==o&&(o=l=[1|c[0],c[1],c[2],c[3],c[4],c[5]]),null==a&&(a=d=16383&(c[6]<<8|c[7])));var s=void 0!==e.msecs?e.msecs:(new Date).getTime(),i=void 0!==e.nsecs?e.nsecs:f+1,c=s-_+(i-f)/1e4;if(c<0&&void 0===e.clockseq&&(a=a+1&16383),1e4<=(i=(c<0||_<s)&&void 0===e.nsecs?0:i))throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_=s,d=a;i=(1e4*(268435455&(s+=122192928e5))+(f=i))%4294967296;r[n++]=i>>>24&255,r[n++]=i>>>16&255,r[n++]=i>>>8&255,r[n++]=255&i;s=s/4294967296*1e4&268435455;r[n++]=s>>>8&255,r[n++]=255&s,r[n++]=s>>>24&15|16,r[n++]=s>>>16&255,r[n++]=a>>>8|128,r[n++]=255&a;for(var u=0;u<6;++u)r[n+u]=o[u];return t||p(r)}},function(e,t,i){var a=i(22),s=i(23);e.exports=function(e,t,i){var n=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||a)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t)for(var o=0;o<16;++o)t[n+o]=r[o];return t||s(r)}},function(e,t,i){void 0===(t=function(){"use strict";function e(){}return e.sendRefreshEvent=function(e,t,i){var n;i&&t(n=(n=(n=(n=i).replace(/a\=play/g,"a=refresh")).replace(/ts\=[0-9\.]+/g,"ts="+(new Date).getTime())).replace(/(prich\=|s2rich\=).*?(&|$)/g,""),function(){e.emit("Tracker:Hit:Sent:Ok",n)}.bind(e))},e}.call(t,i,t,e))||(e.exports=t)},function(e,t,i){void 0===(t=function(e){"use strict";var s=i(6),n=i(4),c=i(12);return{APP_NAME:void 0,APP_CATEGORY:void 0,bbc_content_id:1,bbc_app_type:2,bbc_app_name:3,language:4,bbc_url:5,bbc_referrer_url:6,bbc_content_type:7,bbc_library_version:8,page_title:9,custom_var_1:11,custom_var_2:12,custom_var_3:13,custom_var_4:14,custom_var_5:15,custom_var_6:16,custom_var_7:17,custom_var_8:18,custom_var_9:19,custom_var_10:20,create:function(e,t,i,n,r,o){var a;return this.APP_NAME=e,i&&i[s.APP_CATEGORY]?this.APP_CATEGORY=i[s.APP_CATEGORY]:this.APP_CATEGORY="",a=this._setCustomVariable(a,s.APP_TYPE,t),a=this._setCustomVariable(a,s.APP_NAME,e),a=this._setCustomVariable(a,s.LIBRARY_VERSION,c.getLibraryName()+"-"+c.getLibraryVersion()),o&&(a=this._setDocumentCustomVariables(a,o)),r&&(a=this._setOrbitCustomVariables(a,r)),this._applyLabels(a,i),this._applyLabels(a,n),a},_initialise:function(){return{site:{}}},_applyLabels:function(t,i){var n;i&&(n=this._getAppName(i),i[s.APP_CATEGORY]&&(t=this._setCustomVariable(t,s.APP_NAME,n),delete i[s.APP_CATEGORY]),Object.keys(i).forEach(function(e){this._isCustomVariable(e)&&(e===s.APP_NAME&&(i[e]=n),t=this._setCustomVariable(t,e,i[e]),delete i[e])},this))},_getAppName:function(e){var t="";return e[s.APP_CATEGORY]?t=e[s.APP_CATEGORY]+"-":this.APP_CATEGORY&&(t=this.APP_CATEGORY+"-"),e[s.APP_NAME]?t+=e[s.APP_NAME]:t+=this.APP_NAME,t},_isCustomVariable:function(e){return void 0!==this[e]&&this.hasOwnProperty(e)&&"function"!=typeof this[e]},_setCustomVariable:function(e,t,i){return i&&(e=e||this._initialise(),i=n.removeSensitiveInfo(i),i=n.cleanCustomVariable(i),t=this[t],e.site[t]="["+encodeURIComponent(i)+"]"),e},_setDocumentCustomVariables:function(e,t){return t&&(e=this._setCustomVariable(e,s.URL,t.URL),e=this._setCustomVariable(e,s.REFERRER_URL,t.referrer),e=this._setCustomVariable(e,s.PAGE_TITLE,t.title)),e},_setOrbitCustomVariables:function(e,t){return t&&(e=this._setCustomVariable(e,s.CONTENT_ID,t.contentId),e=this._setCustomVariable(e,s.CONTENT_TYPE,t.contentType),e=this._setCustomVariable(e,s.LANGUAGE,t.language),e=this._setProductCustomVariables(e,t.additionalProperties)),e},_setProductCustomVariables:function(e,t){return t&&(t.app_category&&(e=this._setCustomVariable(e,s.APP_NAME,this._getAppName(t))),t.content_language&&(e=this._setCustomVariable(e,s.LANGUAGE,t.content_language)),e=this._setCustomVariable(e,s.CUSTOM_VAR_1,t.custom_var_1),e=this._setCustomVariable(e,s.CUSTOM_VAR_2,t.custom_var_2),e=this._setCustomVariable(e,s.CUSTOM_VAR_3,t.custom_var_3),e=this._setCustomVariable(e,s.CUSTOM_VAR_4,t.custom_var_4),e=this._setCustomVariable(e,s.CUSTOM_VAR_5,t.custom_var_5),e=this._setCustomVariable(e,s.CUSTOM_VAR_6,t.custom_var_6),e=this._setCustomVariable(e,s.CUSTOM_VAR_7,t.custom_var_7),e=this._setCustomVariable(e,s.CUSTOM_VAR_8,t.custom_var_8),e=this._setCustomVariable(e,s.CUSTOM_VAR_9,t.custom_var_9),e=this._setCustomVariable(e,s.CUSTOM_VAR_10,t.custom_var_10)),e}}}.call(t,i,t,e))||(e.exports=t)},function(e){e.exports=JSON.parse('{"name":"@bbc/echo-client-js","description":"Client library for sending events","version":"12.17.0","main":"dist/echo-12.17.0.js","scripts":{"test":"grunt build","build":"grunt build","build:dev":"webpack --mode=development --config ./config/webpack.dev.config.js","build:dist":"webpack --mode=production --config ./config/webpack.prod.config.js"},"pre-commit":["test"],"files":["dist"],"echo-client-js":{"barb-spring-version":"2.4.0","ati-smarttag-version":"5.26.0"},"devDependencies":{"ajv":"^6.6.2","es6-promise":"^4.2.5","eslint":"^5.12.0","eslint-plugin-tv":"github:bbc/eslint-plugin-tv#semver:^1.0.0","grunt":"^1.3.0","grunt-cli":"^1.4.2","grunt-contrib-jshint":"^2.0.0","grunt-contrib-watch":"^1.1.0","grunt-eslint":"^22.0.0","grunt-jscs":"^3.0.1","grunt-karma":"^3.0.1","grunt-shell":"^2.1.0","gulp":"^4.0.0","hoek":"^6.1.2","istanbul-instrumenter-loader":"^3.0.1","jasmine":"^3.3.1","jasmine-core":"^3.3.0","jquery":"^3.4.1","karma":"^3.1.4","karma-chrome-launcher":"*","karma-coverage-istanbul-reporter":"^2.0.4","karma-firefox-launcher":"^1.1.0","karma-jasmine":"^2.0.1","karma-jasmine-html-reporter":"^1.4.0","karma-phantomjs-launcher":"^1.0.4","karma-requirejs":"^1.1.0","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.7","karma-story-reporter":"^0.3.1","karma-webpack":"^3.0.0","load-grunt-tasks":"^4.0.0","lodash":"^4.17.15","phantomjs-prebuilt":"^2.1.16","pre-commit":"^1.2.2","requirejs":"^2.3.6","sinon":"^7.2.2","ssc-js":"git+ssh://git@github.com/bbc/ssc-js.git#1.2.0","time-grunt":"^2.0.0","uglifyjs-webpack-plugin":"^2.1.1","uuid":"3.4.0","webpack":"^4.43.0","webpack-cli":"^3.2.1","webpack-merge":"^4.2.1"}}')},function(e,t,f){void 0===(t=function(){"use strict";var n=f(0),i=f(12),r="name",o="ptnrID",a="pList",s="retType",c="appN",u="appT",l="mpN",d="mpV",h="mlN",p="mlV",_="devR";return{buildTheme:function(e,t,i){return e+"="+encodeURIComponent(t||"")+(i?"":"~")},constructThemeOne:function(e,t){var i="";return e&&(e.isLive()&&t?i+=this.buildTheme(r,""):i+=this.buildTheme(r,e.getName()),i+=this.buildTheme(o,e.getWsPartnerId()),e.isLive()?i+=this.buildTheme(a,e.getServiceId(),!0):i+=this.buildTheme(a,e.getPlaylist(),!0)),n.info("Setting media theme 1: "+i),i},constructThemeTwo:function(e){var t="";return e&&(t=this.buildTheme(s,e.getRetrievalType()),t+=this.buildTheme(c,e.getAppName()),t+=this.buildTheme(u,e.getAppType())),n.info("Setting media theme 2: "+t),t},constructThemeThree:function(e){var t="";return e&&(t=this.buildTheme(l,e.getMediaPlayerName()),t+=this.buildTheme(d,e.getMediaPlayerVersion()),t+=this.buildTheme(h,i.getLibraryName()),t+=this.buildTheme(p,i.getLibraryVersion()),t+=this.buildTheme(_,e.getCastingDeviceReferrer(),!0)),n.info("Setting media theme 3: "+t),t}}}.call(t,f,t,e))||(e.exports=t)},function(e,t,i){void 0===(t=function(){"use strict";var a=i(0);function e(){}return e.sendEvent=function(e,t,i,n){if(t){var r,o={action:i,playerId:t.playerId,mediaLabel:t.mediaLabel,mediaTheme1:t.mediaTheme1,mediaTheme2:t.mediaTheme2,mediaTheme3:t.mediaTheme3};for(r in n)n.hasOwnProperty(r)&&(o[r]=n[r]);e.richMedia.send(o),a.info("Sending "+i+" media event")}},e}.call(t,i,t,e))||(e.exports=t)},function(e,t,i){void 0===(t=function(){"use strict";var a=i(6),t=i(4);function s(){}return s.sendClickEvent=function(e,t){this._sendEvent(e,t,"click")},s.sendImpressionEvent=function(e,t){this._sendEvent(e,t,"impression")},s._sendEvent=function(e,t,i){(t=t||{customObject:{}}).customObject||(t.customObject={});var n={creation:this._formatEventValue(s._buildCreation(t)),campaignId:this._formatEventValue(t.customObject[a.CONTAINER]||"Page"),variant:this._formatEventValue(t.customObject[a.PERSONALISATION]||""),format:this._formatEventValue(t.customObject[a.METADATA]||""),generalPlacement:this._formatEventValue(t[a.BBC_COUNTER_NAME]||"unknown"),detailedPlacement:this._formatEventValue(t.user||""),advertiserId:this._formatEventValue(t.customObject[a.SOURCE]||""),url:this._formatEventValue(t.customObject[a.RESULT]||"unknown")},r={};if("click"===i?r.click=n:r.impression=n,e)for(var o in e.publisher.send(r),t.customObject)e.delParam(o)},s._buildCreation=function(e){var t=e&&e.actionName||"unknown";return e&&e.actionType&&(t+="~"+e.actionType),t},s._formatEventValue=function(e){return"["+t.cleanCustomVariable(e)+"]"},s}.call(t,i,t,e))||(e.exports=t)}],n={},r.m=i,r.c=n,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=24);function r(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}var i,n});
