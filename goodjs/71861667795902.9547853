!function(e){var n,t;n=this,t=function(e){"use strict";function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(n,e){var t,r=Object.keys(n);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(n),e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),r.push.apply(r,t)),r}function se(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?n(o,!0).forEach(function(e){var n,t=r,e=o[n=e];n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):n(o).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function t(e){function n(e,n){Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.message=e,this.code=n}return(n.prototype=new Error).name=e,n.prototype.constructor=n}var ce=t("LaunchDarklyUnexpectedResponseError"),le=t("LaunchDarklyInvalidEnvironmentIdError"),fe=t("LaunchDarklyInvalidUserError"),de=t("LaunchDarklyInvalidEventKeyError"),d=t("LaunchDarklyInvalidArgumentError"),ve=t("LaunchDarklyFlagFetchError");function ge(e){return!(400<=e&&e<500)||400===e||408===e||429===e}for(var r=Object.freeze({__proto__:null,LDUnexpectedResponseError:ce,LDInvalidEnvironmentIdError:le,LDInvalidUserError:fe,LDInvalidEventKeyError:de,LDInvalidArgumentError:d,LDFlagFetchError:ve,isHttpErrorRecoverable:ge}),o=function(e){for(var n,t=e.length,r=t%3,o=[],i=0,a=t-r;i<a;i+=16383)o.push(function(e,n,t){for(var r,o=[],i=n;i<t;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(u[(r=r)>>18&63]+u[r>>12&63]+u[r>>6&63]+u[63&r]);return o.join("")}(e,i,a<i+16383?a:i+16383));return 1==r?(n=e[t-1],o.push(u[n>>2]+u[n<<4&63]+"==")):2==r&&(n=(e[t-2]<<8)+e[t-1],o.push(u[n>>10]+u[n>>4&63]+u[n<<2&63]+"=")),o.join("")},u=[],i=[],a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)u[s]=a[s],i[a.charCodeAt(s)]=s;i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63;var l=Array.isArray,f=Object.keys,v=Object.prototype.hasOwnProperty,g=["key","secondary","ip","country","email","firstName","lastName","avatar","name"];function p(e){e=unescape(encodeURIComponent(e));return o(function(e){for(var n=[],t=0;t<e.length;t++)n.push(e.charCodeAt(t));return n}(e))}function pe(e){return p(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function me(e){return JSON.parse(JSON.stringify(e))}function he(e,n){return function e(n,t){if(n===t)return!0;if(n&&t&&"object"==typeof n&&"object"==typeof t){var r,o,i,a=l(n),u=l(t);if(a&&u){if((o=n.length)!=t.length)return!1;for(r=o;0!=r--;)if(!e(n[r],t[r]))return!1;return!0}if(a!=u)return!1;a=n instanceof Date,u=t instanceof Date;if(a!=u)return!1;if(a&&u)return n.getTime()==t.getTime();a=n instanceof RegExp,u=t instanceof RegExp;if(a!=u)return!1;if(a&&u)return n.toString()==t.toString();var s=f(n);if((o=s.length)!==f(t).length)return!1;for(r=o;0!=r--;)if(!v.call(t,s[r]))return!1;for(r=o;0!=r--;)if(!e(n[i=s[r]],t[i]))return!1;return!0}return n!=n&&t!=t}(e,n)}function ye(e){setTimeout(e,0)}function we(e,n){e=e.then(function(e){return n&&setTimeout(function(){n(null,e)},0),e},function(e){return n?void setTimeout(function(){n(e,null)},0):Promise.reject(e)});return n?void 0:e}function m(e){var n,t={};for(n in e)Se(e,n)&&(t[n]={value:e[n],version:0});return t}function be(e){var n,t={};for(n in e)Se(e,n)&&(t[n]=e[n].value);return t}function h(e,n){for(var t,r=n.slice(0),o=[],i=e;0<r.length;){for(t=[];0<i;){var a=r.shift();if(!a)break;(i-=pe(JSON.stringify(a)).length)<0&&0<t.length?r.unshift(a):t.push(a)}i=e,o.push(t)}return o}function y(e){var n=e.version||"3.3.0";return e.userAgent+"/"+n}function ke(e,n){if(n&&!n.sendLDHeaders)return{};e={"X-LaunchDarkly-User-Agent":y(e)};return n&&n.wrapperName&&(e["X-LaunchDarkly-Wrapper"]=n.wrapperVersion?n.wrapperName+"/"+n.wrapperVersion:n.wrapperName),e}function Ee(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.reduce(function(e,n){return se({},e,{},n)},{})}function Se(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function De(e){if(!e)return e;var n,t;for(t in g){var r=g[t],o=e[r];void 0!==o&&"string"!=typeof o&&((n=n||se({},e))[r]=String(o))}return n||e}Object.freeze({__proto__:null,btoa:p,base64URLEncode:pe,clone:me,deepEquals:he,onNextTick:ye,wrapPromiseCallback:we,transformValuesToVersionedValues:m,transformVersionedValuesToValues:be,chunkUserEventsForUrl:h,getLDUserAgentString:y,getLDHeaders:ke,extend:Ee,objectHasOwnProperty:Se,sanitizeUser:De});for(var w,b,k,E,S=(w=ee={exports:{}},(E="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto))?(b=new Uint8Array(16),w.exports=function(){return E(b),b}):(k=new Array(16),w.exports=function(){for(var e,n=0;n<16;n++)0==(3&n)&&(e=4294967296*Math.random()),k[n]=e>>>((3&n)<<3)&255;return k}),ee.exports),D=[],O=0;O<256;++O)D[O]=(O+256).toString(16).substr(1);function Oe(e,n,t){var r=n&&t||0,o=n||[],i=(e=e||{}).node||P,a=void 0!==e.clockseq?e.clockseq:U;null!=i&&null!=a||(s=S(),null==i&&(i=P=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==a&&(a=U=16383&(s[6]<<8|s[7])));var u=void 0!==e.msecs?e.msecs:(new Date).getTime(),t=void 0!==e.nsecs?e.nsecs:R+1,s=u-j+(t-R)/1e4;if(s<0&&void 0===e.clockseq&&(a=a+1&16383),1e4<=(t=(s<0||j<u)&&void 0===e.nsecs?0:t))throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");j=u,U=a,t=(1e4*(268435455&(u+=122192928e5))+(R=t))%4294967296,o[r++]=t>>>24&255,o[r++]=t>>>16&255,o[r++]=t>>>8&255,o[r++]=255&t,u=u/4294967296*1e4&268435455,o[r++]=u>>>8&255,o[r++]=255&u,o[r++]=u>>>24&15|16,o[r++]=u>>>16&255,o[r++]=a>>>8|128,o[r++]=255&a;for(var c=0;c<6;++c)o[r+c]=i[c];return n||(n=0,[D[o[n++]],D[o[n++]],D[o[n++]],D[o[n++]],"-",D[o[n++]],D[o[n++]],"-",D[o[n++]],D[o[n++]],"-",D[o[n++]],D[o[n++]],"-",D[o[n++]],D[o[n++]],D[o[n++]],D[o[n++]],D[o[+n]],D[o[15]]].join(""))}var P,U,j=0,R=0;function Pe(u,e,n){var r="/a/"+e+".gif",s=Ee({"Content-Type":"application/json"},ke(u,n)),c=u.httpFallbackPing,l={sendChunk:function(e,n,o,t){var i=JSON.stringify(e),a=o?null:Oe();return t?function t(r){var e=o?s:Ee({},s,{"X-LaunchDarkly-Event-Schema":"3","X-LaunchDarkly-Payload-ID":a});return u.httpRequest("POST",n,e,i).promise.then(function(e){if(e)return 400<=e.status&&ge(e.status)&&r?t(!1):(e={status:(n=e).status},!(n=n.header("date"))||(n=Date.parse(n))&&(e.serverTime=n),e);var n}).catch(function(){return r?t(!1):Promise.reject()})}(!0).catch(function(){}):(c&&c(n+r+"?d="+pe(i)),Promise.resolve())},sendEvents:function(e,n,t){if(!u.httpRequest)return Promise.resolve();for(var r=u.httpAllowsPost(),o=r?[e]:h(2e3-n.length,e),i=[],a=0;a<o.length;a++)i.push(l.sendChunk(o[a],n,t,r));return Promise.all(i)}};return l}function I(e){return e&&e.message?e.message:"string"==typeof e||e instanceof String?e:JSON.stringify(e)}function Ue(e){return'Expected application/json content type but got "'+e+'"'}function je(e){return"network error"+(e?" ("+e+")":"")}function Re(){return"Environment not found. Double check that you specified a valid environment/client-side ID."+q}function Ie(){return"No user specified."+q}function Te(){return"Invalid user specified."+q}function T(e,n){return n?'"'+e+'" is deprecated, please use "'+n+'"':'"'+e+'" is deprecated'}function Ne(){return"Cannot make HTTP requests in this environment."+q}function N(e){return"Opening stream connection to "+e}function L(e,n){return"Error on stream connection: "+I(e)+", will continue retrying every "+n+" milliseconds."}function F(e){return'Ignoring unknown config option "'+e+'"'}function x(e,n,t){return'Config option "'+e+'" should be of type '+n+", got "+t+", using default value"}function C(e,n){return'Config option "'+e+'" should be a boolean, got '+n+", converting to boolean"}function A(e,n,t){return'Config option "'+e+'" was set to '+n+", changing to minimum value of "+t}function Le(e){return"polling for feature flags at "+e}var q=" Please see https://docs.launchdarkly.com/docs/js-sdk-reference#section-initializing-the-client for instructions on SDK initialization.",Fe=function(e){return'Custom event "'+e+'" does not exist'},xe=function(){return"No environment/client-side ID was specified."+q},Ce=function(e){return"Error fetching flag settings: "+I(e)},Ae=function(){return"LaunchDarkly client was initialized with bootstrap data that did not include flag metadata. Events may not be sent correctly."+q},qe=function(e,n,t){return"Received error "+e+(401===e?" (invalid SDK key)":"")+" for "+n+" - "+(ge(e)?t:"giving up permanently")},_e=function(e){return'received streaming update for flag "'+e+'"'},Je=function(e){return'received streaming update for flag "'+e+'" but ignored due to version check'},Ve=function(e){return'received streaming deletion for flag "'+e+'"'},ze=function(e){return'received streaming deletion for flag "'+e+'" but ignored due to version check'},Me=function(e){return'enqueueing "'+e+'" event'},Ke=function(e){return"sending "+e+" events"},_=Object.freeze({__proto__:null,clientInitialized:function(){return"LaunchDarkly client initialized"},clientNotReady:function(){return"LaunchDarkly client is not ready"},eventCapacityExceeded:function(){return"Exceeded event queue capacity. Increase capacity to avoid dropping events."},eventWithoutUser:function(){return"Be sure to call `identify` in the LaunchDarkly client: https://docs.launchdarkly.com/docs/js-sdk-reference#section-analytics-events"},invalidContentType:Ue,invalidKey:function(){return"Event key must be a string"},localStorageUnavailable:function(){return"localStorage is unavailable"},localStorageUnavailableForUserId:function(){return"localStorage is unavailable, so anonymous user ID cannot be cached"},networkError:je,unknownCustomEventKey:Fe,environmentNotFound:Re,environmentNotSpecified:xe,errorFetchingFlags:Ce,userNotSpecified:Ie,invalidUser:Te,bootstrapOldFormat:Ae,bootstrapInvalid:function(){return"LaunchDarkly bootstrap data is not available because the back end could not read the flags."},deprecated:T,httpErrorMessage:qe,httpUnavailable:Ne,identifyDisabled:function(){return"identify() has no effect here; it must be called on the main client instance"},streamClosing:function(){return"Closing stream connection"},streamConnecting:N,streamError:L,unknownOption:F,wrongOptionType:x,wrongOptionTypeBoolean:C,optionBelowMinimum:A,debugPolling:Le,debugStreamPing:function(){return"received ping message from stream"},debugStreamPut:function(){return"received streaming update for all flags"},debugStreamPatch:_e,debugStreamPatchIgnored:Je,debugStreamDelete:Ve,debugStreamDeleteIgnored:ze,debugEnqueueingEvent:Me,debugPostingEvents:Ke,debugPostingDiagnosticEvent:function(e){return"sending diagnostic event ("+e.kind+")"}}),$e=function(r){var n=!1,t=!1,o=null,e=null,i=new Promise(function(n){r.on("ready",function e(){r.off("ready",e),n()})}).catch(function(){});return{getInitializationPromise:function(){return e||(n?Promise.resolve():t?Promise.reject(o):e=new Promise(function(n,t){r.on("initialized",function e(){r.off("initialized",e),n()}),r.on("failed",function e(n){r.off("failed",e),t(n)})}))},getReadyPromise:function(){return i},signalSuccess:function(){n||t||(n=!0,r.emit("initialized"),r.emit("ready"))},signalFailure:function(e){n||t||(t=!0,o=e,r.emit("failed",e),r.emit("ready")),r.maybeReportError(e)}}};function He(n,t,r,o,i){var a={};function u(){var e="",n=o.getUser();return n&&(e=r||p(JSON.stringify(n))),"ld:"+t+":"+e}return a.loadFlags=function(){return n.get(u()).then(function(e){if(null==e)return null;try{var n,t=JSON.parse(e);return t&&(void 0===(n=t.$schema)||n<1?t=m(t):delete t.$schema),t}catch(e){return a.clearFlags().then(function(){return Promise.reject(e)})}}).catch(function(e){return i.warn("localStorage is unavailable"),Promise.reject(e)})},a.saveFlags=function(e){e=Ee({},e,{$schema:1});return n.set(u(),JSON.stringify(e)).catch(function(e){return i.warn("localStorage is unavailable"),Promise.reject(e)})},a.clearFlags=function(){return n.clear(u()).catch(function(e){return i.warn("localStorage is unavailable"),Promise.reject(e)})},a}function Be(o,e,i,n){var a,u=e.streamUrl,s=e.logger,t={},c=u+"/eval/"+i,l=e.useReport,f=e.evaluationReasons,r=e.streamReconnectDelay,d=ke(o,e),v=!1,g=null,p=null,m=null,h=null,y=null;function w(e){v||(s.warn(L(e,r)),v=!0),S(!1),E(),b(r)}function b(e){p||(e?p=setTimeout(k,e):k())}function k(){var e;p=null;var n="",t={headers:d,readTimeoutMillis:3e5};if(o.eventSourceFactory){for(var r in null!=h&&(n="h="+h),l?o.eventSourceAllowsReport?(e=c,t.method="REPORT",t.headers["Content-Type"]="application/json",t.body=JSON.stringify(m)):(e=u+"/ping/"+i,n=""):e=c+"/"+pe(JSON.stringify(m)),e=e+((n=f?n+(n?"&":"")+"withReasons=true":n)?"?":"")+n,E(),s.info(N(e)),a=(new Date).getTime(),g=o.eventSourceFactory(e,t),y)Se(y,r)&&g.addEventListener(r,y[r]);g.onerror=w}}function E(){g&&(s.info("Closing stream connection"),g.close(),g=null)}function S(e){a&&n&&n.recordStreamInit(a,!e,(new Date).getTime()-a),a=null}return t.connect=function(e,n,t){for(var r in m=e,h=n,y={},t||{})!function(n){y[n]=function(e){S(!(v=!1)),t[n]&&t[n](e)}}(r);b()},t.disconnect=function(){clearTimeout(p),p=null,E()},t.isConnected=function(){return!!(g&&o.eventSourceIsActive&&o.eventSourceIsActive(g))},t}var J={baseUrl:{default:"https://app.launchdarkly.com"},streamUrl:{default:"https://clientstream.launchdarkly.com"},eventsUrl:{default:"https://events.launchdarkly.com"},sendEvents:{default:!0},streaming:{type:"boolean"},sendLDHeaders:{default:!0},inlineUsersInEvents:{default:!1},allowFrequentDuplicateEvents:{default:!1},sendEventsOnlyForVariation:{default:!1},useReport:{default:!1},evaluationReasons:{default:!1},eventCapacity:{default:100,minimum:1},flushInterval:{default:2e3,minimum:2e3},samplingInterval:{default:0,minimum:0},streamReconnectDelay:{default:1e3,minimum:0},allAttributesPrivate:{default:!1},privateAttributeNames:{default:[]},bootstrap:{type:"string|object"},diagnosticRecordingInterval:{default:9e5,minimum:2e3},diagnosticOptOut:{default:!1},wrapperName:{type:"string"},wrapperVersion:{type:"string"},stateProvider:{type:"object"},autoAliasingOptOut:{default:!1}};function Ge(e,n,t,r){var a=Ee({logger:{default:r}},J,t),o={all_attributes_private:"allAttributesPrivate",private_attribute_names:"privateAttributeNames",samplingInterval:null};function u(e){ye(function(){n&&n.maybeReportError(new d(e))})}var s,c,i,e=Ee({},e||{}),l=e;return Object.keys(o).forEach(function(e){var n;void 0!==l[e]&&(n=o[e],r&&r.warn(T(e,n)),n&&(void 0===l[n]&&(l[n]=l[e]),delete l[e]))}),i=Ee({},e),Object.keys(a).forEach(function(e){void 0!==i[e]&&null!==i[e]||(i[e]=a[e]&&a[e].default)}),s=e=i,c=Ee({},s),Object.keys(s).forEach(function(e){var n,t,r,o,i=s[e];null!=i&&(void 0===(n=a[e])?u(F(e)):"any"!==(t=n.type||f(n.default))&&(r=t.split("|"),o=f(i),r.indexOf(o)<0?"boolean"===t?(c[e]=!!i,u(C(e,o))):(u(x(e,t,o)),c[e]=n.default):"number"===o&&void 0!==n.minimum&&i<n.minimum&&(u(A(e,i,n.minimum)),c[e]=n.minimum)))}),c;function f(e){if(null===e)return"any";if(void 0!==e){if(Array.isArray(e))return"array";e=ue(e);return"boolean"===e||"string"===e||"number"===e||"function"===e?e:"object"}}}var V=Object.freeze({__proto__:null,baseOptionDefs:J,validate:Ge}).baseOptionDefs,Xe=function(e){var n={diagnosticId:Oe()};return e&&(n.sdkKeySuffix=6<e.length?e.substring(e.length-6):e),n},We=function(e){var n,t,r,o;function i(e){n=e,r=t=0,o=[]}return i(e),{getProps:function(){return{dataSinceDate:n,droppedEvents:t,eventsInLastBatch:r,streamInits:o}},setProps:function(e){n=e.dataSinceDate,t=e.droppedEvents||0,r=e.eventsInLastBatch||0,o=e.streamInits||[]},incrementDroppedEvents:function(){t++},setEventsInLastBatch:function(e){r=e},recordStreamInit:function(e,n,t){o.push({timestamp:e,failed:n,durationMillis:t})},reset:i}},Qe=function(r,e,n,t,o,i){var a,u,s=!!r.diagnosticUseCombinedEvent,c="ld:"+t+":$diagnostics",l=o.eventsUrl+"/events/diagnostic/"+t,f=o.diagnosticRecordingInterval,d=e,v=!!o.streaming,e={};function g(){return{sdk:(e=se({},r.diagnosticSdkData),o.wrapperName&&(e.wrapperName=o.wrapperName),o.wrapperVersion&&(e.wrapperVersion=o.wrapperVersion),e),configuration:{customBaseURI:o.baseUrl!==V.baseUrl.default,customStreamURI:o.streamUrl!==V.streamUrl.default,customEventsURI:o.eventsUrl!==V.eventsUrl.default,eventsCapacity:o.eventCapacity,eventsFlushIntervalMillis:o.flushInterval,reconnectTimeMillis:o.streamReconnectDelay,streamingDisabled:!v,allAttributesPrivate:!!o.allAttributesPrivate,inlineUsersInEvents:!!o.inlineUsersInEvents,diagnosticRecordingIntervalMillis:o.diagnosticRecordingInterval,usingSecureMode:!!o.hash,bootstrapMode:!!o.bootstrap,fetchGoalsDisabled:!o.fetchGoals,allowFrequentDuplicateEvents:!!o.allowFrequentDuplicateEvents,sendEventsOnlyForVariation:!!o.sendEventsOnlyForVariation,autoAliasingOptOut:!!o.autoAliasingOptOut},platform:r.diagnosticPlatformData};var e}function p(e){o.logger&&o.logger.debug(_.debugPostingDiagnosticEvent(e)),n.sendEvents(e,l,!0).then(function(){}).catch(function(){})}function m(){var e,n;p((e=(new Date).getTime(),n=se({kind:s?"diagnostic-combined":"diagnostic",id:i,creationDate:e},d.getProps()),s&&(n=se({},n,{},g())),d.reset(e),n)),u=setTimeout(m,f),a=(new Date).getTime(),!s||r.localStorage&&(n=se({},d.getProps()),r.localStorage.set(c,JSON.stringify(n),function(){}))}return e.start=function(){var t;s?(t=function(e){var n;e?(n=(a||0)+f)<=(e=(new Date).getTime())?m():u=setTimeout(m,n-e):0===Math.floor(4*Math.random())?m():u=setTimeout(m,f)},r.localStorage?r.localStorage.get(c).then(function(e){if(e)try{var n=JSON.parse(e);d.setProps(n),a=n.dataSinceDate}catch(e){}t(!0)}).catch(function(){t(!1)}):t(!1)):(p(se({kind:"diagnostic-init",id:i,creationDate:d.getProps().dataSinceDate},g())),u=setTimeout(m,f))},e.stop=function(){u&&clearTimeout(u)},e.setStreaming=function(e){v=e},e};function Ye(e,n){var r=["debug","info","warn","error"],o=null!=n?""===n?"":n+" ":"LD: ",i=0;e&&(i="none"===e?100:r.indexOf(e));e={};function t(e,n,t){i<=e&&console&&((n=console[n])&&(e=e<r.length?r[e]:"?",n.call(console,o+"["+e+"] "+t)))}return e.debug=function(e){return t(0,"log",e)},e.info=function(e){return t(1,"info",e)},e.warn=function(e){return t(2,"warn",e)},e.error=function(e){return t(3,"error",e)},e}function z(e,n,t,i,r){var a,o,u,s,c,l,f,d,v,g,p,m,h,y,w,b,k,E,S,D=t&&t.logger?t.logger:r&&r.logger&&r.logger.default||Ye("warn"),O=(k=D,S={},(E={}).on=function(e,n,t){S[e]=S[e]||[],S[e]=S[e].concat({handler:n,context:t})},E.off=function(e,n,t){if(S[e])for(var r=0;r<S[e].length;r++)S[e][r].handler===n&&S[e][r].context===t&&(S[e]=S[e].slice(0,r).concat(S[e].slice(r+1)))},E.emit=function(e){if(S[e])for(var n=S[e].slice(0),t=0;t<n.length;t++)n[t].handler.apply(n[t].context,Array.prototype.slice.call(arguments,1))},E.getEvents=function(){return Object.keys(S)},E.getEventListenerCount=function(e){return S[e]?S[e].length:0},E.maybeReportError=function(e){e&&(S.error?this.emit("error",e):(k||console).error(e.message))},E),P=$e(O),U=Ge(t,O,r,D),j=U.sendEvents,R=e,I=U.hash,T=Pe(i,R,U),E=U.sendEvents&&!U.diagnosticOptOut,t=E?Xe(R):null,r=E?We((new Date).getTime()):null,N=E?Qe(i,r,T,R,U,t):null,L=Be(i,U,R,r),F=U.eventProcessor||function(e,n,t,r,o,i){var a,u,s,c,l,f,d,v,g=3<arguments.length&&void 0!==r?r:null,p=4<arguments.length&&void 0!==o?o:null,m={},h=(5<arguments.length&&void 0!==i?i:null)||Pe(e,t,n),y=n.eventsUrl+"/events/bulk/"+t,w=(d=f=0,v={},(e={}).summarizeEvent=function(e){var n,t;"feature"===e.kind&&(n=e.key+":"+(null!==e.variation&&void 0!==e.variation?e.variation:"")+":"+(null!==e.version&&void 0!==e.version?e.version:""),(t=v[n])?t.count=t.count+1:v[n]={count:1,key:e.key,variation:e.variation,version:e.version,value:e.value,default:e.default},(0===f||e.creationDate<f)&&(f=e.creationDate),e.creationDate>d&&(d=e.creationDate))},e.getSummary=function(){var e,n={},t=!0;for(e in v){var r=v[e],o=n[r.key];o||(o={default:r.default,counters:[]},n[r.key]=o);var i={value:r.value,count:r.count};void 0!==r.variation&&null!==r.variation&&(i.variation=r.variation),r.version?i.version=r.version:i.unknown=!0,o.counters.push(i),t=!1}return t?null:{startDate:f,endDate:d,features:n}},e.clearSummary=function(){d=f=0,v={}},e),b=(t={},u=(e=n).allAttributesPrivate,s=e.privateAttributeNames||[],c={key:!0,custom:!0,anonymous:!0},l={key:!0,secondary:!0,ip:!0,country:!0,email:!0,firstName:!0,lastName:!0,avatar:!0,name:!0,anonymous:!0,custom:!0},t.filterUser=function(e){if(!e)return null;function n(r,o){return Object.keys(r).reduce(function(e,n){var t=e;return o(n)&&(c[e=n]||!u&&-1===i.indexOf(e)&&-1===s.indexOf(e)?t[0][n]=r[n]:t[1][n]=!0),t},[{},{}])}var i=e.privateAttributeNames||[],t=n(e,function(e){return l[e]}),r=t[0],t=t[1];e.custom&&(e=n(e.custom,function(){return 1}),r.custom=e[0],t=Ee({},t,e[1]));t=Object.keys(t);return t.length&&(t.sort(),r.privateAttrs=t),r},t),k=n.inlineUsersInEvents,E=n.samplingInterval,S=n.eventCapacity,D=n.flushInterval,O=n.logger,P=[],U=0,j=!1,R=!1;function I(){return 0===E||0===Math.floor(Math.random()*E)}function T(e){P.length<S?(P.push(e),R=!1):(R||(R=!0,O.warn("Exceeded event queue capacity. Increase capacity to avoid dropping events.")),g&&g.incrementDroppedEvents())}return m.enqueue=function(e){var n,t,r;j||(n=r=!1,w.summarizeEvent(e),"feature"===e.kind?I()&&(r=!!e.trackEvents,n=!!e.debugEventsUntilDate&&e.debugEventsUntilDate>U&&e.debugEventsUntilDate>(new Date).getTime()):r=I(),r&&T((r=Ee({},t=e),"alias"===t.kind||(k||"identify"===t.kind?r.user=b.filterUser(t.user):(r.userKey=t.user.key,delete r.user),"feature"===t.kind&&(delete r.trackEvents,delete r.debugEventsUntilDate)),r)),n&&(delete(e=Ee({},e,{kind:"debug"})).trackEvents,delete e.debugEventsUntilDate,delete e.variation,T(e)))},m.flush=function(){if(j)return Promise.resolve();var e=P,n=w.getSummary();return w.clearSummary(),n&&(n.kind="summary",e.push(n)),g&&g.setEventsInLastBatch(e.length),0===e.length?Promise.resolve():(P=[],O.debug(Ke(e.length)),h.sendEvents(e,y).then(function(e){e&&(e.serverTime&&(U=e.serverTime),ge(e.status)||(j=!0),400<=e.status&&ye(function(){p.maybeReportError(new ce(qe(e.status,"event posting","some events were dropped")))}))}))},m.start=function(){a=setTimeout(function e(){m.flush(),a=setTimeout(e,D)},D)},m.stop=function(){clearTimeout(a)},m}(i,U,R,r,O,T),x=(v=i,p=R,m=(g=U).baseUrl,h=g.useReport,y=g.evaluationReasons,w=g.logger,b={},(T={}).fetchJSON=function(e){return $(m+e,null)},T.fetchFlagSettings=function(e,n){var t,r,o="";return h?(t=[m,"/sdk/evalx/",p,"/user"].join(""),r=JSON.stringify(e)):(e=pe(JSON.stringify(e)),t=[m,"/sdk/evalx/",p,"/users/",e].join("")),n&&(o="h="+n),w.debug(Le(t=t+((o=y?o+(o?"&":"")+"withReasons=true":o)?"?":"")+o)),$(t,r)},T),C={},A={},q=U.streaming,_=!1,J=!1,V=!0,z=U.stateProvider,M=(c=function(e,n){z||e&&H({kind:"identify",key:e.key,user:e,creationDate:(new Date).getTime()}),!U.autoAliasingOptOut&&n&&n.anonymous&&e&&!e.anonymous&&Q(e,n)},{setUser:function(e){var n=l&&me(l);(l=De(e))&&c&&c(me(l),n)},getUser:function(){return l?me(l):null}}),K=(f=i.localStorage,d=D,{validateUser:function(e){if(!e)return Promise.reject(new fe(Ie()));var n=me(e);return null!==n.key&&void 0!==n.key?(n.key=n.key.toString(),Promise.resolve(n)):n.anonymous?(f?f.get("ld:$anonUserId").catch(function(){return null}):Promise.resolve(null)).then(function(e){if(e)return n.key=e,n;e=Oe();return n.key=e,(f?f.set("ld:$anonUserId",e).catch(function(){d.warn("localStorage is unavailable, so anonymous user ID cannot be cached")}):Promise.resolve()).then(function(){return n})}):Promise.reject(new fe(Te()))}});function $(e,n){if(!v.httpRequest)return new Promise(function(e,n){n(new ve(Ne()))});var t=n?"REPORT":"GET",r=ke(v,g);n&&(r["Content-Type"]="application/json");var o,i,a,u,s,c,l=b[e];l||(o=function(){delete b[e]},(c={addPromise:function(n,e){i=n,a&&a(),a=e,n.then(function(e){i===n&&(u(e),o())},function(e){i===n&&(s(e),o())})}}).resultPromise=new Promise(function(e,n){u=e,s=n}),l=c,b[e]=l);var f=v.httpRequest(t,e,r,n),n=f.promise.then(function(e){if(200!==e.status)return Promise.reject(404===(n=e).status?new le(Re()):new ve(Ce(n.statusText||String(n.status))));if(e.header("content-type")&&"application/json"===e.header("content-type").substring(0,"application/json".length))return JSON.parse(e.body);var n,e=Ue(e.header("content-type")||"");return Promise.reject(new ve(e))},function(e){return Promise.reject(new ve(je(e)))});return l.addPromise(n,function(){f.cancel&&f.cancel()}),l.resultPromise}function H(e){if(R&&!(z&&z.enqueueEvent&&z.enqueueEvent(e))){if("alias"!==e.kind){if(!e.user)return void(V&&(D.warn("Be sure to call `identify` in the LaunchDarkly client: https://docs.launchdarkly.com/docs/js-sdk-reference#section-analytics-events"),V=!1));V=!1}!j||J||i.isDoNotTrack()||(D.debug(Me(e.kind)),F.enqueue(e))}}function B(e,n,t,r){var o=M.getUser(),i=new Date,a=n?n.value:null;if(!U.allowFrequentDuplicateEvents){var u=JSON.stringify(a)+(o&&o.key?o.key:"")+e,s=C[u];if(s&&i-s<3e5)return;C[u]=i}i={kind:"feature",key:e,user:o,value:a,variation:n?n.variationIndex:null,default:t,creationDate:i.getTime()};o&&o.anonymous&&(i.contextKind=W(o));e=A[e];e&&(i.version=e.flagVersion||e.version,i.trackEvents=e.trackEvents,i.debugEventsUntilDate=e.debugEventsUntilDate),(r||e&&e.trackReason)&&n&&(i.reason=n.reason),H(i)}function G(e,n,t,r){var o,i;return A&&Se(A,e)&&A[e]&&!A[e].deleted?(i=X(o=A[e]),null!==o.value&&void 0!==o.value||(i.value=n)):i={value:n,variationIndex:null,reason:{kind:"ERROR",errorKind:"FLAG_NOT_FOUND"}},t&&B(e,i,n,r),i}function X(e){return{value:e.value,variationIndex:void 0===e.variation?null:e.variation,reason:e.reason||null}}function W(e){return e.anonymous?"anonymousUser":"user"}function Q(e,n){z||e&&n&&H({kind:"alias",key:e.key,contextKind:W(e),previousKey:n.key,previousContextKind:W(n),creationDate:(new Date).getTime()})}function Y(){o=!0,M.getUser()&&L.connect(M.getUser(),I,{ping:function(){D.debug("received ping message from stream");var n=M.getUser();x.fetchFlagSettings(n,I).then(function(e){he(n,M.getUser())&&ee(e||{})}).catch(function(e){O.maybeReportError(new ve(Ce(e)))})},put:function(e){e=JSON.parse(e.data);D.debug("received streaming update for all flags"),ee(e)},patch:function(e){var n,t=JSON.parse(e.data),r=A[t.key];!r||!r.version||!t.version||r.version<t.version?(D.debug(_e(t.key)),n={},delete(e=Ee({},t)).key,e=X(A[t.key]=e),n[t.key]=r?{previous:r.value,current:e}:{current:e},ne(n)):D.debug(Je(t.key))},delete:function(e){var n=JSON.parse(e.data);!A[n.key]||A[n.key].version<n.version?(D.debug(Ve(n.key)),e={},A[n.key]&&!A[n.key].deleted&&(e[n.key]={previous:A[n.key].value}),A[n.key]={version:n.version,deleted:!0},ne(e)):D.debug(ze(n.key))}})}function Z(){o&&(L.disconnect(),o=!1)}function ee(e){var n,t,r={};if(!e)return Promise.resolve();for(n in A)Se(A,n)&&A[n]&&(e[n]&&!he(e[n].value,A[n].value)?r[n]={previous:A[n].value,current:X(e[n])}:e[n]&&!e[n].deleted||(r[n]={previous:A[n].value}));for(t in e)Se(e,t)&&e[t]&&(!A[t]||A[t].deleted)&&(r[t]={current:X(e[t])});return A=se({},e),ne(r).catch(function(){})}function ne(o){var i,e=Object.keys(o);return 0<e.length&&(i={},e.forEach(function(e){var n=o[e].current,t=n?n.value:void 0,r=o[e].previous;O.emit("change:"+e,t,r),i[e]=n?{current:t,previous:r}:{previous:r}}),O.emit("change",i),O.emit("internal-change",A),U.sendEventsOnlyForVariation||z||e.forEach(function(e){B(e,o[e].current)})),a&&s?s.saveFlags(A).catch(function(){return null}):Promise.resolve()}function te(){var e=q||u&&void 0===q;e&&!o?Y():!e&&o&&Z(),N&&N.setStreaming(e)}function re(e){return"change"===e||"change:"===e.substr(0,"change".length+1)}function oe(e){R=e.environment,M.setUser(e.user),A=se({},e.flags),ye(ie)}function ie(){D.info("LaunchDarkly client initialized"),_=!0,te(),P.signalSuccess()}function ae(e){P.signalFailure(e)}return i.localStorage&&(s=new He(i.localStorage,R,I,M,D)),"string"==typeof U.bootstrap&&"LOCALSTORAGE"===U.bootstrap.toUpperCase()&&(s?a=!0:D.warn("localStorage is unavailable")),"object"===ue(U.bootstrap)&&(A=function(t){var e=Object.keys(t),r=t.$flagsState;!r&&e.length&&D.warn(Ae()),!1===t.$valid&&D.warn("LaunchDarkly bootstrap data is not available because the back end could not read the flags.");var o={};return e.forEach(function(e){var n;"$flagsState"!==e&&"$valid"!==e&&(n={value:t[e]},r&&r[e]?n=Ee(n,r[e]):n.version=0,o[e]=n)}),o}(U.bootstrap)),z?((T=z.getInitialState())?oe(T):z.on("init",oe),z.on("update",function(e){e.user&&M.setUser(e.user),e.flags&&ee(e.flags)})):(e?K.validateUser(n).then(function(e){return M.setUser(e),"object"===ue(U.bootstrap)?ie():a?s.loadFlags().catch(function(){return null}).then(function(e){return null==e?(A={},x.fetchFlagSettings(M.getUser(),I).then(function(e){return ee(e||{})}).then(ie).catch(function(e){ae(new ve(Ce(e)))})):(A=e,ye(ie),x.fetchFlagSettings(M.getUser(),I).then(ee).catch(function(e){return O.maybeReportError(e)}))}):x.fetchFlagSettings(M.getUser(),I).then(function(e){A=e||{},ie()}).catch(function(e){A={},ae(e)})}):Promise.reject(new le(xe()))).catch(ae),{client:{waitForInitialization:function(){return P.getInitializationPromise()},waitUntilReady:function(){return P.getReadyPromise()},identify:function(e,r,n){return J?we(Promise.resolve({}),n):z?(D.warn("identify() has no effect here; it must be called on the main client instance"),we(Promise.resolve(be(A)),n)):we((a&&s?s.clearFlags():Promise.resolve()).then(function(){return K.validateUser(e)}).then(function(t){return x.fetchFlagSettings(t,r).then(function(e){var n=be(e);return M.setUser(t),I=r,e?ee(e).then(function(){return n}):n})}).then(function(e){return o&&Y(),e}).catch(function(e){return O.maybeReportError(e),Promise.reject(e)}),n)},getUser:function(){return M.getUser()},variation:function(e,n){return G(e,n,!0,!1).value},variationDetail:function(e,n){return G(e,n,!0,!0)},track:function(e,n,t){var r,o;"string"==typeof e?(i.customEventFilter&&!i.customEventFilter(e)&&D.warn(Fe(e)),o={kind:"custom",key:e,user:r=M.getUser(),url:i.getCurrentUrl(),creationDate:(new Date).getTime()},r&&r.anonymous&&(o.contextKind=W(r)),null!=n&&(o.data=n),null!=t&&(o.metricValue=t),H(o)):O.maybeReportError(new de(Fe(e)))},alias:Q,on:function(e,n,t){re(e)?(u=!0,_&&te(),O.on(e,n,t)):O.on.apply(O,arguments)},off:function(e){var n;O.off.apply(O,arguments),re(e)&&(n=!1,O.getEvents().forEach(function(e){re(e)&&0<O.getEventListenerCount(e)&&(n=!0)}),n||(u=!1,o&&void 0===q&&Z()))},setStreaming:function(e){e=null===e?void 0:e;e!==q&&(q=e,te())},flush:function(e){return we(j?F.flush():Promise.resolve(),e)},allFlags:function(){var e,n={};if(!A)return n;for(e in A)Se(A,e)&&(n[e]=G(e,null,!U.sendEventsOnlyForVariation).value);return n},close:function(e){return we(J?Promise.resolve():Promise.resolve().then(function(){if(Z(),N&&N.stop(),j)return F.stop(),F.flush()}).then(n).catch(n),e);function n(){J=!0,A={}}}},options:U,emitter:O,ident:M,logger:D,requestor:x,start:function(){j&&(N&&N.start(),F.start())},enqueueEvent:H,getFlagsInternal:function(){return A},getEnvironmentId:function(){return R},internalChangeEventName:"internal-change"}}function M(n,e){var t,r=Object.keys(n);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(n),e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),r.push.apply(r,t)),r}function K(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?M(Object(o),!0).forEach(function(e){var n,t=r,e=o[n=e];n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):M(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}var $={promise:Promise.resolve({status:200,header:function(){return null},body:null})};function H(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(B,"\\$&")}var B=/[|\\{}()[\]^$+*?.]/g;function G(e,r){for(var n={},t=null,o=[],i=0;i<e.length;i++)for(var a=e[i],u=a.urls||[],s=0;s<u.length;s++)if(function(e,n,t,r){var o,i,a=("substring"!==e.kind&&"regex"!==e.kind||!r.includes("/")?n.replace(r,""):n).replace(t,"");switch(e.kind){case"exact":i=n,o=new RegExp("^"+H(e.url)+"/?$");break;case"canonical":i=a,o=new RegExp("^"+H(e.url)+"/?$");break;case"substring":i=a,o=new RegExp(".*"+H(e.substring)+".*$");break;case"regex":i=a,o=new RegExp(e.pattern);break;default:return}return o.test(i)}(u[s],window.location.href,window.location.search,window.location.hash)){"pageview"===a.kind?r("pageview",a):(o.push(a),r("click_pageview",a));break}return 0<o.length&&(t=function(e){for(var n=function(e,n){for(var t=[],r=0;r<n.length;r++)for(var o=e.target,i=n[r],a=i.selector,u=document.querySelectorAll(a);o&&0<u.length;){for(var s=0;s<u.length;s++)o===u[s]&&t.push(i);o=o.parentNode}return t}(e,o),t=0;t<n.length;t++)r("click",n[t])},document.addEventListener("click",t)),n.dispose=function(){document.removeEventListener("click",t)},n}var X=300;function W(o,i){var a,u,e={};function s(){u&&u.dispose(),a&&a.length&&(u=G(a,c))}function c(e,n){var t=o.ident.getUser(),r={kind:e,key:n.key,data:null,url:window.location.href,user:t,creationDate:(new Date).getTime()};return t&&t.anonymous&&(r.contextKind="anonymousUser"),"click"===e&&(r.selector=n.selector),o.enqueueEvent(r)}return e.goalKeyExists=function(e){if(!a)return!0;for(var n=0;n<a.length;n++)if("custom"===a[n].kind&&a[n].key===e)return!0;return!1},o.requestor.fetchJSON("/sdk/goals/"+o.getEnvironmentId()).then(function(e){function n(){(r=window.location.href)!==o&&(o=r,t())}var t,r,o;e&&0<e.length&&(u=G(a=e,c),t=s,o=window.location.href,function e(n,t){n(),setTimeout(function(){e(n,t)},t)}(n,X),window.history&&window.history.pushState?window.addEventListener("popstate",n):window.addEventListener("hashchange",n)),i()}).catch(function(e){o.emitter.maybeReportError(new r.LDUnexpectedResponseError((e&&e.message,e.message))),i()}),e}var Q="goalsReady",Y={fetchGoals:{default:!0},hash:{type:"string"},eventProcessor:{type:"object"},eventUrlTransformer:{type:"function"},disableSyncEventPost:{default:!1}};function Z(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=function(e){var n,i,a={synchronousFlush:!1};window.XMLHttpRequest&&(i=e&&e.disableSyncEventPost,a.httpRequest=function(e,n,t,r){var o=a.synchronousFlush&!i;return a.synchronousFlush=!1,function(e,n,t,r,o){if(o&&!function(){var e=window.navigator&&window.navigator.userAgent;if(e){e=e.match(/Chrom(e|ium)\/([0-9]+)\./);if(e)return parseInt(e[2],10)<73}return 1}())return $;var i,a,u=new window.XMLHttpRequest;for(i in u.open(e,n,!o),t||{})Object.prototype.hasOwnProperty.call(t,i)&&u.setRequestHeader(i,t[i]);return o?(u.send(r),$):{promise:new Promise(function(e,n){u.addEventListener("load",function(){a||e({status:u.status,header:function(e){return u.getResponseHeader(e)},body:u.responseText})}),u.addEventListener("error",function(){a||n(new Error)}),u.send(r)}),cancel:function(){a=!0,u.abort()}}}(e,n,t,r,o)}),a.httpAllowsPost=function(){return n=void 0===n?!!window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest:n},a.httpFallbackPing=function(e){(new window.Image).src=e};var t=e&&e.eventUrlTransformer;a.getCurrentUrl=function(){return t?t(window.location.href):window.location.href},a.isDoNotTrack=function(){var e;return 1===(e=window.navigator&&void 0!==window.navigator.doNotTrack?window.navigator.doNotTrack:window.navigator&&void 0!==window.navigator.msDoNotTrack?window.navigator.msDoNotTrack:window.doNotTrack)||!0===e||"1"===e||"yes"===e};try{window.localStorage&&(a.localStorage={get:function(n){return new Promise(function(e){e(window.localStorage.getItem(n))})},set:function(n,t){return new Promise(function(e){window.localStorage.setItem(n,t),e()})},clear:function(n){return new Promise(function(e){window.localStorage.removeItem(n),e()})}})}catch(e){a.localStorage=null}var r=e&&e.useReport&&"function"==typeof window.EventSourcePolyfill&&window.EventSourcePolyfill.supportedOptions&&window.EventSourcePolyfill.supportedOptions.method?(a.eventSourceAllowsReport=!0,window.EventSourcePolyfill):(a.eventSourceAllowsReport=!1,window.EventSource);return window.EventSource&&(a.eventSourceFactory=function(e,n){n=K(K({},{heartbeatTimeout:3e5,silentTimeout:3e5,skipDefaultHeaders:!0}),n);return new r(e,n)},a.eventSourceIsActive=function(e){return e.readyState===window.EventSource.OPEN||e.readyState===window.EventSource.CONNECTING}),a.userAgent="JSClient",a.version="2.19.0",a.diagnosticSdkData={name:"js-client-sdk",version:"2.19.0"},a.diagnosticPlatformData={name:"JS"},a.diagnosticUseCombinedEvent=!0,a}(t),n=z(e,n,t,r,Y),o=n.client,t=n.options,i=n.emitter,a=new Promise(function(e){var n=i.on(Q,function(){i.off(Q,n),e()})});function u(){r.synchronousFlush=!0,o.flush().catch(function(){}),r.synchronousFlush=!1}return o.waitUntilGoalsReady=function(){return a},t.fetchGoals?(t=W(n,function(){return i.emit(Q)}),r.customEventFilter=t.goalKeyExists):i.emit(Q),"complete"!==document.readyState?window.addEventListener("load",n.start):n.start(),window.addEventListener("beforeunload",u),window.addEventListener("unload",u),o}var ee={initialize:function(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return console&&console.warn&&console.warn(_.deprecated("default export","named LDClient export")),Z(e,n,t)},version:"2.19.0"};e.createConsoleLogger=Ye,e.default=ee,e.initialize=Z,e.version="2.19.0",Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof e&&e.amd?e(["exports"],t):t((n=n||self).LDClient={})}(globalRequire.define);
