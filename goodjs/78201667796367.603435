Dell=window.Dell||{},Dell.ContactDrawer=Dell.ContactDrawer||{},Dell.ContactDrawer.contactDomain=Dell.ContactDrawer.contactDomain||{},function(N,P){!function(){"use strict";var t,a,n=!0,o=!0,i=!1,e="localStorage"in N&&null!=N.localStorage,r="sessionStorage"in N&&null!=N.sessionStorage,d="__amplify__contactDrawerIsHardClosed",s="chat__session__started",c="True"===h("data-EnableMoxieChat")&&!(-1!==navigator.appVersion.indexOf("MSIE 10")),l=!1,u=36e5,m=!1,g=N.matchMedia("(max-width: 767px)").matches,p={openTime:5e3,closedTime:7e3,transitionTime:500,popOutOnPageLoad:!1},w=["GoMoxie:widgetOpened","GoMoxie:widgetMinimized","GoMoxie:widgetClosed","GoMoxie:transactionComplete","GoMoxie:widget:chat:prechatQuestionnaireComplete","GoMoxie:widget:chat:chatSessionStarted","GoMoxie:widget:chat:agentJoinedSession","GoMoxie:widget:chat:agentLeftSession","GoMoxie:widget:chat:chatSessionEnded","GoMoxie:widget:chat:surveyLoaded"];function h(e,t){return(t=t||P.getElementsByClassName("dds__drawer-content")[0]).hasAttribute(e)?t.getAttribute(e):""}function v(){n=!0,t.classList.add("dds__drawer-open"),a.hidden=!1}function S(){n=!1,t.classList.remove("dds__drawer-open"),setTimeout(function(){a.hidden=!0},p.transitionTime)}function f(){var e,t,a;l||(N.MoxieData||(N.MoxieData={},N.MoxieData.country=h("data-country"),N.MoxieData.language=h("data-language"),N.MoxieData.segment=h("data-segment")),e=P.createElement("script"),t=h("data-MoxieTenant"),a=h("data-MoxieHost"),e.src=h("data-MoxieConciergeUrl"),e.type="text/javascript",e.setAttribute("data-concierge-host",a),e.setAttribute("data-client",t),e.setAttribute("concierge","1"),e.setAttribute("defer","true"),P.getElementsByTagName("body")[0].appendChild(e),l=!0)}function x(){return g?P.querySelector('ul#concierge-widgets-ul li[data-widget="chat"]')&&P.querySelector("button#concierge-tab")?P.querySelector("button#concierge-tab"):void 0:P.querySelector(".con-icon")}function _(e){g?e.dispatchEvent(new Event("touchstart")):e.click()}function T(e){a=(t=e).querySelector(".dds__drawer-content"),t.querySelector(".dds__drawer-tab").addEventListener("click",function(e){e.preventDefault(),i=i||!0,k(),n?S():(v(),null!==dellmetrics_trackdata&&(N.matchMedia("(max-width: 992px)").matches?dellmetrics_trackdata("chatdrawerbottom"):dellmetrics_trackdata("chatdrawerrightrail")))}),t.querySelector(".dds__drawer-close-button").addEventListener("click",function(){i=i||!0,k(),S(),null!==dellmetrics_trackdata&&dellmetrics_trackdata("chatdrawerclose")}),e=a.getAttribute("data-contact-drawer"),(e=JSON.parse(e))&&(e.OpenTimeInSeconds&&(p.openTime=1e3*e.OpenTimeInSeconds),e.CloseTimeInSeconds&&(p.closedTime=1e3*e.CloseTimeInSeconds),e.TransitionTimeInMilliseconds&&(p.transitionTime=e.TransitionTimeInMilliseconds),e.OpenTimeInSeconds&&e.CloseTimeInSeconds||(i=!0),e.PopOutOnPageLoad&&(p.popOutOnPageLoad=e.PopOutOnPageLoad)),c&&((y(s)||E(s))&&f(),(e=t.querySelector(".cd__drawer-displayonconciergeready"))&&e.addEventListener("click",function(e){e.stopImmediatePropagation(),e.preventDefault(),P.querySelector(".cd__drawer-shadow-box").parentNode.classList.add("cd__drawer-moxie-loading"),m=!0;e=x();e?(P.querySelector(".cd__drawer-shadow-box").parentNode.classList.remove("cd__drawer-moxie-loading"),_(e)):(P.querySelector(".cd__drawer-shadow-box").parentNode.classList.add("cd__drawer-moxie-loading"),f())}))}function y(e){return r&&null!==N.sessionStorage.getItem(e)}function M(){var e;!y(e=s)&&r&&N.sessionStorage.setItem(e,"1")}function L(){b(s,"1")}function D(){var e=new Date;e.setDate(e.getDate()-100),b(s,"0",e.toUTCString()),r&&N.sessionStorage.removeItem(s)}function E(o){return"1"===function(){for(var e=o+"=",t=P.cookie.split(";"),a=0;a<t.length;a++){var n=t[a].trim();if(0==n.indexOf(e))return n.substring(e.length,n.length)}return""}()}function b(e,t,a){P.cookie=e+"="+t+";expires="+a+";path=/; domain=.dell.com;"}function C(e){"function"==typeof N.dellmetrics_trackvalue&&("GoMoxie:widget:chat:chatSessionStarted"===e.type&&e.detail.sessionId?N.dellmetrics_trackvalue(e.type+"|"+e.detail.sessionId):N.dellmetrics_trackvalue(e.type))}function I(){for(var e=0;e<w.length;e++)N.removeEventListener(w[e],C)}function G(){var t;N.addEventListener("GoMoxie:widget:chat:chatSessionStarted",M),N.addEventListener("GoMoxie:widget:chat:chatSessionStarted",L),N.addEventListener("GoMoxie:widget:chat:chatSessionEnded",D),function(){I();for(var e=0;e<w.length;e++)N.addEventListener(w[e],C,!1)}(),m&&(t=setInterval(function(){var e=x();e&&(P.querySelector(".cd__drawer-shadow-box").parentNode.classList.remove("cd__drawer-moxie-loading"),_(e),clearInterval(t))},50))}function O(){i||(n?(S(),p.closedTime&&setTimeout(O,p.closedTime)):(v(),p.openTime&&setTimeout(O,p.openTime)))}function k(){try{e&&!q()&&N.localStorage.setItem(d,JSON.stringify({data:!0,expires:Date.now()+u}))}catch(e){console.error(e)}}function q(){return e&&null!==N.localStorage.getItem(d)}this.Init=function(e){T(P.getElementById(e)),p.transitionTime>p.openTime||p.transitionTime>p.closedTime?console.warn("contact drawer transition time is too large"):t&&(t.style.transition="all "+p.transitionTime+"ms ease"),!q()&&(g?"true"===h("data-stay-open-in-mobile").toLowerCase():o)?p.popOutOnPageLoad?(v(),p.openTime&&setTimeout(O,p.openTime)):O():n=!1,"true"==h("data-EnabledPersonalization").toLowerCase()&&function(){var a=new XMLHttpRequest;a.withCredentials=!0,a.dataType="json";var n=h("data-personalizedLabelWithoutCategoryName"),e=h("data-personalizationUrl");a.onreadystatechange=function(){var e,t;a.readyState!==XMLHttpRequest.DONE||200!==a.status||(e=JSON.parse(a.responseText))&&(t="",e.WarmState&&(void 0===(t=n)||null==n||n.length<=0||(t=n.replace("{0}",e.DisplayName),P.getElementById("chat-drawer-personalize-message-subtitle").innerHTML=t)))},a.open("GET",e,!0),a.send()}()},N.addEventListener("Dell.ContactDrawer.CloseContactDrawer",function(e){console.log("CD closed"),S()}),c&&(N.addEventListener("GoMoxie:conciergeReady",G),N.addEventListener("unload",function(){N.removeEventListener("GoMoxie:conciergeReady",G),I(),(y(s)||E(s))&&(N.removeEventListener("GoMoxie:widget:chat:chatSessionStarted",M),N.removeEventListener("GoMoxie:widget:chat:chatSessionStarted",L),N.removeEventListener("GoMoxie:widget:chat:chatSessionEnded",D))}))}.call(Dell.ContactDrawer.contactDomain)}(window,document);
