define("lofty/ui/widget/1.0/widget",["lofty/lang/class","lofty/lang/base","jquery"],function(t,n,r){"use strict";function o(t,n,i){"document"===i?r(document).off(n):"window"===i?r(window).off(n):t.get("el").off(n,i)}function h(t,s){return t.replace(/{([^}]+)}/g,function(t,n){for(var i,e=n.split("."),o=s;i=e.shift();)o=o===s.options?s.get(i):o[i];return c(o)?o:""})}var t=t(n,{options:{tpl:"<div></div>",extendTplData:null,container:{value:"body",getter:function(t){return t=c(t)?r(t):t}},el:{getter:function(t){return t=c(t)?r(t):t}}},events:null,init:function(t){this.mixOptions(["tpl","events"]),n.prototype.init.call(this,t||{}),this.buildElement(),this.bindEvent(),this._create()},destroy:function(){this.unbindEvent(),n.prototype.destroy.call(this)},_create:function(t){},render:function(t){t&&this.set("container",t);var n,i=this.get("el"),e=this.get("container");return!e||(n=i[0],t=document.documentElement,r.contains?r.contains(t,n):16&t.compareDocumentPosition(n))||i.appendTo(e),this},bindEvent:function(t){for(var o in t=t||this.get("events")){var n,i=t[o];for(n in i){var o=h(o,this),s=h(n,this)+".events-"+this.wId;!function(n,i){function t(t){l(n)?n.call(i,t):i[n](t)}var e=i.get("el");""===o?e.on(s,t):"document"===o?r(document).on(s,t):"window"===o?r(window).on(s,t):e.on(s,o,t)}(i[n],this)}}return this},unbindEvent:function(t){if(t)for(var n in t){var i,e=t[n],n=h(n,this);for(i in e)o(this,h(i,this)+".events-"+this.wId,n)}else o(this,".events-"+this.wId);return this},buildElement:function(){var t,n="dynamic",i=this.get("tpl");if(this.wId="fui_widget_"+e++,c(i)?"."!==i.charAt(0)&&"#"!==i.charAt(0)&&"body"!==i||(t=r(i)):t=i,t&&0<t.length&&("SCRIPT"==t[0].nodeName.toUpperCase()?(i=t.html(),this.set("tpl",i)):n="static"),this.set("renderType",n),"static"===n?this.set("el",t):(t=r(this.get("el")),this.handleTpl(),t&&0!==t.length?this.get("container").append(r(this.get("tpl"))):(t=this.wId,1<(i=r(this.get("tpl"))).length?i=r('<div id="'+t+'"></div>').append(i):(t=i.attr("id")||this.wId,i.attr("id",t)),this.set("el",i))),!this.get("el"))throw new Error("element is empty!")},mixOptions:function(t){for(var n in t){n=t[n];this[n]&&this.options&&(this.options[n]=this[n])}},handleTpl:function(){}}),i={}.toString,l=function(t){return"[object Function]"===i.call(t)},c=function(t){return"string"==typeof t},e=0;return t});
