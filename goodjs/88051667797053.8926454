var phonographEvents;void 0===phonographEvents&&(phonographEvents=[]),function(){var e={needleUrl:"//phonograph2.voxmedia.com/needle",cookieDomain:"voxmedia.com",uidCookieName:"_vm_uid",suidCookieName:"_vm_suid",thirdPartyPageHost:"//phonograph2.voxmedia.com",thirdPartyPagePath:"/third.html",uuid:null,suid:null,poller:null,captureGAId:!0,gaid:null,vpSize:function(){var e=document,t=document.documentElement,n=document.body;return n&&n.clientWidth&&n.clientHeight&&"CSS1Compat"!==e.compatMode?[n.clientWidth,n.clientHeight].join("x"):t.clientWidth&&t.clientHeight?[t.clientWidth,t.clientHeight].join("x"):""},flash:function(){try{try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{e.AllowScriptAccess="always"}catch(e){return"6,0,0"}}catch(e){}return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){}}return"0,0,0"},java:function(){var e=window.navigator;return e&&"function"==typeof e.javaEnabled&&e.javaEnabled()?"1":"0"},generateUUID:function(){var n=window.crypto||window.msCrypto,e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",t=new RegExp(/[xy]/g);return void 0!==n&&void 0!==n.getRandomValues?e.replace(t,function(e){var t=n.getRandomValues(new Uint8Array(1))[0]%16|0;return("x"==e?t:3&t|8).toString(16)}):e.replace(t,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},getCookie:function(e){e=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie);return e?e[1]:null},storage:function(e,t){try{return void 0!==t?(localStorage.setItem(e,t),!0):localStorage.getItem(e)}catch(e){return null}},getUUIDCookie:function(){return this.getCookie(this.uidCookieName)||this.storage(this.uidCookieName)},setCookie:function(e,t,n){var i=new Date;i.setFullYear(i.getFullYear()+2);i=t+"="+e+"; expires="+i.toGMTString()+"; path=/";return void 0!==n&&(i+="; domain="+n),document.cookie=i,this.getCookie(t)},loadUUIDFromCookie:function(e){var t=this.getUUIDCookie();return null!=t?t:this.setCookie(this.generateUUID(),this.uidCookieName,e)},loadUUID:function(){this.uuid=this.getUUIDCookie()||this.setCookie(this.generateUUID(),this.uidCookieName,this.cookieDomain)||this.loadUUIDFromIframe()},loadUUIDFromIframe:function(){if(window.postMessage){var e=document.getElementsByTagName("body")[0],t=null,n=this;return this.addEvent("message",function(e){var t=e.origin.split("/").slice(-1)[0];-1!=n.thirdPartyPageHost.indexOf(t)&&"uuid"in e.data&&(n.uuid=e.data.uuid,n.setCookie(n.uuid,n.uidCookieName))}),(t=document.createElement("iframe")).style.display="none",t.setAttribute("src",this.thirdPartyPageHost+this.thirdPartyPagePath),e.appendChild(t),this.uuid}return null},addEvent:function(e,t){window.addEventListener?window.addEventListener(e,t,!1):window.attachEvent("on"+e,t)},flatten:function(e){var t,n={};for(t in e)if(null!==e[t])if("object"==typeof e[t]){var i,o=this.flatten(e[t]);for(i in o)o.hasOwnProperty(i)&&(n[t+"."+i]=o[i])}else n[t]=e[t];return n},createIFrame:function(t){var n;try{n=document.createElement('<iframe name="'+t+'">')}catch(e){(n=document.createElement("iframe")).setAttribute("name",t)}return n.style.display="none",n},getBody:function(e){return e.body||e.getElementsByTagName("body")[0]},createPostRequest:function(e,t,n){var i,o=this.getBody(document),a="phonograph-"+(new Date).getTime(),r=this.createIFrame(a),d=document.createElement("form");for(i in d.style.display="none",d.setAttribute("method","POST"),d.setAttribute("action",t),d.setAttribute("target",a),e){var s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("name",i),s.setAttribute("value",e[i]),d.appendChild(s)}return n&&(r.onload=n),o.appendChild(d),o.appendChild(r),d.submit(),a},getRequestURL:function(e){var t=this.needleUrl+"?";for(name in e)t+=encodeURIComponent(name)+"="+encodeURIComponent(e[name])+"&";return t},sendGetRequest:function(e,t){var n=document.createElement("img");n.style.height=1,n.style.width=1,t&&(n.onload=t),n.src=e},buildQuery:function(e){var t={};return t.d=1<e.length?JSON.stringify(e[1]):"",t.e=e[0],t.uid=this.uuid,t.suid=this.suid,t.de=document.characterSet||document.charset,t.sr=window.screen.width+"x"+window.screen.height,t.vp=this.vpSize(),t.ul=(window.navigator.language||window.navigator.browserLanguage||"").toLowerCase(),t.sd=(window.screen&&window.screen.colorDepth||"")+"-bit",t.fl=this.flash(),t.je=this.java(),t.dl=document.location,t.dr=document.referrer,t.wh=window.location.hostname,t.z=Math.round(2147483647*Math.random()),t},getGAClientId:function(){return"undefined"!=typeof ga&&void 0!==ga.getAll&&null===this.gaid&&(this.gaid=ga.getAll()[0].get("clientId")),this.gaid},insertGAClientId:function(e){this.captureGAId&&(1==e.length&&(e[1]={}),e[1]._ga_cid=this.getGAClientId())},send:function(e){var t=e[1]&&e[1].callback;"function"==typeof t?delete e[1].callback:t=null,this.insertGAClientId(e);var n=this.buildQuery(e),e=this.getRequestURL(n);return 2048<=e.length?this.createPostRequest(n,this.needleUrl,t):(this.sendGetRequest(e,t),e)},stop:function(){this.poller&&(clearInterval(this.poller),this.poller=null)},start:function(){var e=this;this.stop(),this.loadUUID(),this.suid=this.getCookie(this.suidCookieName)||this.setCookie(this.generateUUID(),this.suidCookieName),setTimeout(function(){e.uuid||(e.uuid="unknown"),e.gaid||(e.gaid="unknown")},3e3),this.poller=setInterval(function(){for(;phonographEvents.length&&null!==e.uuid&&(!e.captureGAId||e.getGAClientId());)e.send(phonographEvents.shift())},300)}};window._phonograph=e,-1===window.location.toString().indexOf(e.thirdPartyPageHost+e.thirdPartyPagePath)&&e.start()}();
