!function(n){var o={};function i(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=n,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(e,d,h){"use strict";!function(e){h.d(d,"a",function(){return t}),h.d(d,"f",function(){return n}),h.d(d,"e",function(){return o}),h.d(d,"d",function(){return i}),h.d(d,"h",function(){return a}),h.d(d,"i",function(){return s}),h.d(d,"b",function(){return c}),h.d(d,"c",function(){return u}),h.d(d,"g",function(){return l});var t=window||e,n=window?window.navigator:{},o=window?window.location:{},i=window?window.document:{},r=Array.prototype,e=Object.prototype,a=r.slice,s=e.toString,c=(e.hasOwnProperty,r.forEach,r.indexOf,Array.isArray,"https:"===i.location.protocol?"https://":"http://"),u={log:function(){l.showLog&&window.console&&window.console.log.apply(window.console,arguments)},error:function(){l.showLog&&window.console&&window.console.error.apply(window.console,arguments)}},l={imp:!0,hashtag:!1,touch:!1,bot:!0,showLog:!0,dataCollect:!1,pathCaseSensitive:!0,exposure:!1,visualTrack:!1,scheme:c,elementThreshold:50,host:"ma.logsss.com",visualConfigHost:"dap.logsss.com",failReTryTime:3,impCtrlDua:6e4,visual_track_config:[]}}.call(d,h(1))},function(e,t){var n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=n(0),s=/^(\.br\.|\.co\.|\.com\.|\.org\.|\.edu\.|\.net\.)/,c={getItem:function(e){for(var t=e+"=",n=y.d.cookie.split(";"),o=0;o<n.length;o++){for(var i=n[o];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return null},setItem:function(e,t,n,o,i,r){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var a="";if(n){switch(y.i.call(n)){case"[object Number]":var s=(new Date).getTime(),a=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; expires="+new Date(s+1e3*n).toUTCString();break;case"[object String]":a="; expires="+n;break;case"[object Date]":a="; expires="+n.toUTCString()}i=i?"; domain="+i:"",o=o?"; path="+o:"",r=r?"; secure"+o:"",y.d.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+a+i+o+r}},removeItem:function(e,t,n){var o=!1;return this.hasItem(e)&&(o=!0,y.d.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(t?"; path="+t:"")),o},hasItem:function(e){var t=!1;return t=e?new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(y.d.cookie||""):t},keys:function(){var e=y.d.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);return e.forEach(function(e,t,n){n[t]=decodeURIComponent(e)}),e}},o={getItem:c.getItem,hasItem:c.hasItem,keys:c.keys,setItem:function(e,t,n,o,i,r){if("string"==typeof i)c.setItem(e,t,n,o,i,r);else for(var a=0;a<i.length;a++)if(!s.test(i[a])){c.setItem(e,t,n,o,i[a],r);break}},removeItem:function(e,t,n){if("string"==typeof n)c.removeItem(e,t,n);else for(var o=0;o<n.length;o++)if(!s.test(n[o])){c.removeItem(e,t,n[o]);break}}};function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var r=(function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}(a,null,[{key:"get",value:function(e){try{return y.a.localStorage?this._readFromLocalStorage(e):this._readFromCookie(e)}catch(e){return y.c.log(e),null}}},{key:"set",value:function(e,t,n){n=n||864e5;try{y.a.localStorage?this._setInLocalStorage(e,t,n):this._setInCookie(e,t,n)}catch(e){y.c.log(e)}}},{key:"removeItem",value:function(e){try{return y.a.localStorage?this.removeInLocalStorage(e):this.removeInCookie(e)}catch(e){return y.c.log(e),null}}},{key:"_readFromLocalStorage",value:function(e){e=y.a.localStorage.getItem(e);if(e){e=JSON.parse(e);if(e.expiredAt&&e.expiredAt>=+Date.now())return e.value}return null}},{key:"_readFromCookie",value:function(e){return o.getItem(e)}},{key:"_setInLocalStorage",value:function(e,t,n){t=JSON.stringify({expiredAt:Date.now()+n,value:t});y.a.localStorage.setItem(e,t)}},{key:"_setInCookie",value:function(e,t,n){o.setItem(e,t,n/1e3,"/",y.a.location.hostname)}},{key:"removeInCookie",value:function(e){o.removeItem(e,"/",y.a.location.hostname)}},{key:"removeInLocalStorage",value:function(e){y.a.localStorage.removeItem(e)}}]),a);function a(){!function(e){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this)}function u(){var n=(new Date).getTime();return"xxxxxxxx-xxxx-axxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"===e?t:3&t|8).toString(16)})}y.a.GlobalegrowLocalStore=r;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function d(t,e,n,o){y.d.addEventListener?t.addEventListener(e,n,3<arguments.length&&void 0!==o&&o):y.d.attachEvent?t.attachEvent(e="on"+e,function(){var e=y.a.event;e.currentTarget=t,e.target=e.srcElement,n.call(t,e)}):t["on"+e]=n}function h(){var e,t,e=(t=y.e.pathname,1<(e=t.length)&&"/"===t.charAt(e-1)?t.slice(0,e-1):t);return y.a.gds.hashtag&&(-1!==(t=y.e.hash).indexOf("?")?e+=t.split("?")[0]:e+=t),y.a.gds&&y.a.gds.pathCaseSensitive?e:e.toLowerCase()}function f(){var e=y.f.userAgent;if(!y.a.ActiveXObject)return!1;var t=e.indexOf("MSIE");if(0<t){var n=e.indexOf(".",t),n=e.substring(t+5,n);return parseInt(n,10)}if(0<e.indexOf("Trident/")){var o=e.indexOf("rv:");return parseInt(e.substring(o+3,e.indexOf(".",o)),10)}o=e.indexOf("Edge/");return 0<o?parseInt(e.substring(o+5,e.indexOf(".",o)),10):void 0}function g(e,t,n,o,i){var r,a=3<arguments.length&&void 0!==o?o:"GET",o=4<arguments.length&&void 0!==i?i:{};y.a.XMLHttpRequest?((r=new y.a.XMLHttpRequest).open(a,e,!0),"POST"===a&&r.setRequestHeader("Content-Type","application/json"),r.onreadystatechange=function(){4===r.readyState&&(200<=r.status&&r.status<300||304===r.status?"function"==typeof t&&t(r):"function"==typeof n&&n(r))},i=p(o),r.send(i)):y.a.XDomainRequest&&(r=new y.a.XDomainRequest,"http:"===y.e.protocol&&(e=e.replace("https://","http://")),r.open(a,e),"POST"===a&&r.setRequestHeader&&r.setRequestHeader("Content-Type","application/json"),r.onload=function(){"function"==typeof t&&t(r)},r.onerror=function(){"function"==typeof n&&n(r)},r.onprogress=function(){return{}},r.ontimeout=function(){return{}},o=p(o),r.send(o))}function p(e){var t=0<arguments.length&&void 0!==e?e:{},e="";try{e=JSON.stringify(t)}catch(t){}return e}function v(e,t){for(var n in t)e[n]=t[n];return e}function m(e){return e&&"string"==typeof e&&e.constructor===String}function b(e,o){return null!=Array.prototype.indexOf?e.indexOf(o):(e.forEach(function(e,t,n){if(e===o)return t}),-1)}function w(e){var t="",n=e.childNodes;if(!n)return t;for(var o=0;o<n.length;o++){var i=n[o],r="";3===i.nodeType&&(null!=i.textContent?r=i.textContent.trim():null!=i.data&&(r=i.data.trim()),0<r.length&&(t+=r+" "))}return 0<(t=t.replace(/[\n \t]+/g," ").trim()).length&&t.length<50?t:void 0}function k(e,t){return e.hasAttribute?e.hasAttribute(t):!!e[t]}function S(e){var t=e||y.d.referrer,e=y.a.gds;return e&&e.pathCaseSensitive?t:t.toLowerCase()}function _(){var e=y.a.location.search;return 1<e.length&&"?"===e.charAt(0)?e=e.slice(1):y.a.gds.hashtag&&y.a.location.hash.indexOf("?")&&(e=y.a.location.hash.split("?")[1]),y.a.gds&&y.a.gds.pathCaseSensitive?e:e.toLowerCase()}function x(){var e="pc",t=window.location.host||window.gds.accountId;return e=/^([a-z]{1,}-m\.|m-[a-z]{1,}\.|m\.|loginm\.|userm\.|orderm\.|cartm\.)/i.test(t)?"m":e}function I(e){var t=0<arguments.length&&void 0!==e?e:"ubcd",e="-1";try{e=y.d.querySelector("meta[name='GLOBEL:"+t+"']").getAttribute("content")}catch(t){}return e}function O(){return o.getItem("od")}function T(){var t="";try{t=y.d.querySelector("meta[name='GLOBEL:ubci']").getAttribute("content")}catch(e){t=""}return""===t?o.getItem("AKAM_CLIENTID")||"":o.getItem(t)}function C(){return o.hasItem("WEBF-user_id")?o.getItem("WEBF-user_id"):o.hasItem("guid")?o.getItem("guid"):""}function E(){var e=y.a.location.hostname.split(".");return 3<=e.length?["."+e.slice(-2).join("."),"."+e.slice(-3).join(".")]:[y.a.location.hostname]}function P(e){var t=o.getItem("gb_pf")||"";if(""!==t)try{t=JSON.parse(t)}catch(e){t={}}else t={};return t[e]||""}function j(e,t){var n=o.getItem("gb_pf")||"";if(""!==n)try{n=JSON.parse(n)}catch(e){n={}}else n={};n[e]=t,o.setItem("gb_pf",JSON.stringify(n),"Session","/",E())}function A(){var e=E(),t=y.d.referrer,n=y.e.href||"",t=t.slice(0,255),n=n.slice(0,255),o=P("lp"),i=P("rp");if(t){for(var r=(r=t.split("/"))[2]||"",a=!1,s=0;s<e.length;s++)if(-1!==r.indexOf(e[s])){a=!0;break}if(!a)return j("lp",n),j("rp",t),{rp:t,lp:n}}return o&&i&&""!==t?{lp:o,rp:i}:(j("rp",t="originalurl"),j("lp",n),{rp:t,lp:n})}function N(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var L=(function(e,t,n){return t&&N(e.prototype,t),n&&N(e,n),e}(D,[{key:"set",value:function(){throw new Error("这是一个接口方法")}},{key:"pageChange",value:function(){this.reset()}},{key:"reset",value:function(){}},{key:"buildMessage",value:function(){}}]),D);function D(e,t,n,o){!function(e){if(!(e instanceof D))throw new TypeError("Cannot call a class as a function")}(this),this.launcher=e,this.observer=t,this.sender=n,this.gruser=o,this.send=this.sender.send}var M=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}(R,L),R);function R(e,t,n,o){return function(e){if(!(e instanceof R))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(R.__proto__||Object.getPrototypeOf(R)).call(this,e,t,n,o))}var V=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}(q,L),q);function q(e,t,n,o){return function(e){if(!(e instanceof q))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(q.__proto__||Object.getPrototypeOf(q)).call(this,e,t,n,o))}var B=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}(H,L),H);function H(e,t,n,o){return function(e){if(!(e instanceof H))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(H.__proto__||Object.getPrototypeOf(H)).call(this,e,t,n,o))}var U=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}(G,L),G);function G(e,t,n,o){return function(e){if(!(e instanceof G))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(G.__proto__||Object.getPrototypeOf(G)).call(this,e,t,n,o))}var X=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}(z,L),z),J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function F(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function z(e,t,n,o){return function(e){if(!(e instanceof z))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(z.__proto__||Object.getPrototypeOf(z)).call(this,e,t,n,o))}(function(e,t,n){t&&F(e.prototype,t),n&&F(e,n)})(Q,[{key:"_setup",value:function(){this.app={},this.people={},this.page={},this.evar={},this.system={}}},{key:"pushToStack",value:function(){this.commond_stack.push.apply(this.commond_stack,arguments)}},{key:"setTrackerScheme",value:function(e){var t;e&&m(e)&&("http"!==(t=e.toLocaleLowerCase())&&"https"!==t||(this.options.scheme=e+"://"))}},{key:"setZone",value:function(e){e&&"string"==typeof e&&0<e.trim().length&&(this.options.zone=e)}},{key:"setTrackerHost",value:function(e){e&&(this.options.host=e)}},{key:"setAccountId",value:function(e){this.options.accountId=e}},{key:"setImp",value:function(e){this.options.imp=e}},{key:"setSampling",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:4,t=(t=arguments[1])||this.defaultSamplingFunc;this.options.sampling=!0,this.options.sampling_ratio=e,this.options.sampling_func=t}},{key:"setImpCtrlDua",value:function(e){this.options.impCtrlDua="number"==typeof e?e:void 0}},{key:"pathCaseSensitive",value:function(e){this.options.pathCaseSensitive=!!e}},{key:"trackBot",value:function(e){this.options.bot=e}},{key:"enableHT",value:function(e){this.options.hashtag=e}},{key:"enableTouch",value:function(e){this.options.touch=e}},{key:"enableExposure",value:function(e){window.gds.exposure=e,this.options.exposure=e}},{key:"enableVisualTrack",value:function(e){window.gds.visualTrack=e,this.options.visualTrack=e}},{key:"dataCollect",value:function(e){this.options.dataCollect=e}},{key:"defaultSamplingFunc",value:function(){throw new Error("这是一个接口方法")}},{key:"setUserId",value:function(e){e&&e.length<=1e3&&this.people&&this.people.setId(""+e)}},{key:"clearUserId",value:function(){this.people&&this.people.clearUserId()}},{key:"setPageGroup",value:function(e){this.page.setName(e)}},{key:"track",value:function(){this.system.track.apply(this.system,arguments)}},{key:"setAppId",value:function(e){e&&(this.options.appId=e)}},{key:"getVisitUserId",value:function(){return this.user.vid()}},{key:"addRealTimeMessageCallBack",value:function(e,t){this.sender.addRealTimeMessageCallBack(e,t)}},{key:"config",value:function(e){var t,n={imp:"setImp",hashtag:"enableHT",touch:"enableTouch",bot:"trackBot",dataCollect:"dataCollect",pathCaseSensitive:"pathCaseSensitive",scheme:"setTrackerScheme",host:"setTrackerHost",sampling:"setSampling",zone:"setZone",origin:"setOrigin",impCtrlDua:"setImpCtrlDua",exposure:"enableExposure",visualTrack:"enableVisualTrack"};for(t in e){var o=e[t];t in n&&(t=n[t]),"object"===(void 0===o?"undefined":J(o))?this.apply.apply(this,[t].concat(y.h.call(o))):this.apply(t,o)}var i,r=[];for(i in this.options)y.a.gds[i]=this.options[i],r.push(y.a.gds[i]);return r}},{key:"init",value:function(e,t,n){var o=["app","people","page","evar","system"];if(e&&m(e)&&0!==e.trim().length){this.setAccountId(e),m(t)&&null!==t.trim()?this.setAppId(t):(e=t)&&"object"==(void 0===e?"undefined":l(e))&&e.constructor===Object&&(n=t),y.a.gds={origin:this.circleHost,version:this.version},this.config(n);for(var i=0;i<o.length;i++){var r=o[i];this[r]=this.initDimensions(r)}this.afterInitialize(),this.ready=!0}}},{key:"afterInitialize",value:function(){throw new Error("这是一个接口方法")}},{key:"apply",value:function(){var e=arguments[0],t=2<=arguments.length?y.h.call(arguments,1):[];if(m(e))try{if(-1===e.indexOf(".")){if(this[e])return this[e].apply(this,t);throw new Error("没有找到 "+e+" 方法")}var n=e.split(".");if(this[n[0]]&&n[0][n[1]])return this[n[0]][n[1]].apply(this.arg[0],t);throw new Error("没有找到 "+e+" 方法")}catch(e){console.log("err:",e)}}},{key:"setOrigin",value:function(e){e&&(this.options.origin=e)}},{key:"set",value:function(e,t){this.options[e]=t}},{key:"setGioIdByTouch",value:function(){return!1}},{key:"getVisualTarckConfig",value:function(){var e={domain:this.options.scheme+y.a.location.host,page:h()};this.options.visualTrack&&this.options.scheme&&this.options.visualConfigHost&&g(this.options.scheme+this.options.visualConfigHost+"/datav/pick/search",this.getVisualTarckConfigSuccessCallback(),this.getVisualTarckConfigFailCallback(),"POST",e)}},{key:"getVisualTarckConfigSuccessCallback",value:function(){var n=this;return function(e){var t;if(200===e.status&&e.response)try{0===(t=JSON.parse(e.response)).code&&(n.tryCount=0,y.a.gds.visual_track_config.data=t.data,y.a.gds.visual_track_config.domain=t.domain,y.a.gds.visual_track_config.page=t.page)}catch(e){}}}},{key:"getVisualTarckConfigFailCallback",value:function(){var t=this;return function(e){if(t.tryCount>=t.options.failReTryTime)return!1;console.log(e),t.tryCount++,t.getVisualTarckConfig()}}},{key:"send",value:function(){if(!this.started)try{this.ready&&this.verify()&&this.connect()}catch(e){console.log(e)}finally{this.started=!0;for(var e=this.commond_stack,t=0;t<e.length;t++){var n=e[t];this.apply.apply(this,n)}}}},{key:"verify",value:function(){return!!y.a._gds_hybrid||-1===b(["","localhost","127.0.0.1"],y.a.location.hostname)}},{key:"initSystemConfig",value:function(e){for(var t=[],n=0;n<e.length;n++){var o=e[n];t.push(this.apply.apply(this,o))}return t}},{key:"identityWindow",value:function(){var e,t,n;t=u(),(n=y.a.name||y.a.self.name)&&y.a.nameStorage&&(3===(e=n.split(/[:?]/)).length&&"nameStorage"===e[0]&&(n=e[1])),y.a.grSource={name:n=n&&"grcw"===n?"grcw-inner-iframe":n,id:t}}},{key:"beforeConnect",value:function(){throw new Error("这是一个接口方法")}},{key:"connect",value:function(){if(y.a.navigator.userAgent.toLowerCase().match(/(bot|crawler|spider|scrapy|jiankongbao|slurp|transcoder|networkbench|oneapm)/i)){if(!this.options.bot)return!1;y.a.gds.imp=!1,this.options.isBot=!0}this.beforeConnect(),this.getVisualTarckConfig(),this.sender.connect({isBot:!!this.options.isBot})}},{key:"callback",value:function(){var e=this;return function(){return e.observer.observe()}}},{key:"initDimensions",value:function(e){switch(e){case"people":return new M(this,this.observer,this.sender,this.user);case"app":return new V(this,this.observer,this.sender,this.user);case"page":return new B(this,this.observer,this.sender,this.user);case"evar":return new U(this,this.observer,this.sender,this.user);case"system":return new X(this,this.observer,this.sender,this.user)}}}]),t=Q;function Q(){!function(e){if(!(e instanceof Q))throw new TypeError("Cannot call a class as a function")}(this),this.defaultOptions=y.g,this.options=v({},this.defaultOptions),this.started=!1,this.ready=!1,this.tryCount=0,this._setup(),this.identityWindow(),this.commond_stack=[],this.version="2.0.0",this.circleHost=("https:"===y.d.location.protocol?"https://":"http://")+"glsdk.logsss.com",this.endpoint="/events"}r=function(e,t,n){return t&&W(e.prototype,t),n&&W(e,n),e};function W(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var $=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}(Y,function t(){!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.userId=null,this.sessionId="",this.lastSessionId="",this.cookie=o,this.guid=u,this.cookieDomain(),this.isHybrid=!1}),r(Y,[{key:"cookieDomain",value:function(){var e;return this.grcookieDomain||(3<=(e=y.a.location.hostname.split(".")).length?this.grcookieDomain=["."+e.slice(-2).join("."),"."+e.slice(-3).join(".")]:this.grcookieDomain=[y.a.location.hostname]),this.grcookieDomain}},{key:"vid",value:function(){return this.userId||(this.userId=this.cookie.getItem("globalegrow_user_id"),this.userId||(this.userId=this.guid()),this.cookie.setItem("globalegrow_user_id",this.userId,this.duration10year,"/",this.cookieDomain()),this.userId)}},{key:"hasSid",value:function(){var e=Date.now();if(this.sessionId&&this.lastUpdated&&e-this.lastUpdated<1e3*this.duration30min)return!0;var t=this.currentSessionId(),e=t[0],t=t[1];return e&&(!this.lastSessionId||t===this.lastSessionId)}},{key:"sid",value:function(){var e=this.currentSessionId();this.sessionId=e[0];var t=e[1],e=Date.now();return this.sessionId&&this.lastUpdated&&e-this.lastUpdated<this.duration1min||(this.sessionId||(this.sessionId=this.guid(),t=!1),this.updateSessionId(this.sessionId,t)),this.sessionId}},{key:"getCs1",value:function(){return this.cookie.getItem(window.gds.accountId+"_gr_cs1")}},{key:"last_sent_sid_with_cs1",value:function(){return this.cookie.getItem(window.gds.accountId+"_gr_last_sent_sid_with_cs1")}},{key:"last_sent_cs1",value:function(){return this.cookie.getItem(window.gds.accountId+"_gr_last_sent_cs1")}},{key:"currentSessionId",value:function(e){e=e||y.a.gds.accountId;var t=this.cookie.getItem(e+"_globalegrow_session_id")||"",n="true"===this.cookie.getItem(e+"_globalegrow_session_id_"+t);return t&&0<=t.indexOf("_")&&(t=(e=t.split("_"))[0],n="true"===e[1],this.updateSessionId(t,n)),t&&"null"===t&&(t="",n=!1),[t,n]}},{key:"updateSessionId",value:function(e,t,n){e?(n=n||y.a.gds.accountId,this.lastUpdated=Date.now(),this.lastSessionId=e,this.updateSessionIdSendStatus(e,t,n),this.cookie.setItem(n+"_globalegrow_session_id",e,this.duration30min,"/",this.cookieDomain())):(console.log("sid 不能为空"),this.sessionId=this.guid(),this.updateSessionId(this.sessionId,t,n))}},{key:"updateSessionIdSendStatus",value:function(e,t,n){null==n&&(n=y.a.gds.accountId);for(var o=this.cookie.keys(),i=0;i<o.length;i++){var r=o[i];if(r.match(/.*_globalegrow_session_id_/)&&r.slice(r.lastIndexOf("_")+1)!==t){this.cookie.removeItem(r,"/",this.cookieDomain());break}}return this.cookie.setItem(n+"_globalegrow_session_id_"+e,t,this.duration30min,"/",this.cookieDomain())}},{key:"isSendNewVisit",value:function(){var e=!1;return e=null==this.cookie.getItem("globalegrow_user_id")?!0:e}},{key:"getSidSendSuccess",value:function(e){return e=e||y.a.gds.accountId,!0===this.currentSessionId(e)[1]}},{key:"setGioId",value:function(e){e&&this.cookie.setItem("globalegrow_user_id",e,this.duration10year,"/",this.cookieDomain())}},{key:"resetUserId",value:function(){this.userId&&this.cookie.setItem("globalegrow_user_id",this.userId,this.duration10year,"/",this.cookieDomain())}}]),Y),L=function(e,t,n){return t&&K(e.prototype,t),n&&K(e,n),e};function K(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Y(){!function(e){if(!(e instanceof Y))throw new TypeError("Cannot call a class as a function")}(this);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Y.__proto__||Object.getPrototypeOf(Y)).call(this));return e.duration10year=31536e4,e.duration30min=1800,e.duration15min=900,e.duration1min=60,e.grcookieDomain="",e}f();var Z=/(^| )(clear|clearfix|active|hover|enabled|hidden|display|focus|disabled|ng-|chook-)[^\. ]*/g,ee=(L(oe,[{key:"path",value:function(){var t="",t="/"+this.name;return this.id&&/^[\w|-]+$/.test(this.id)&&(t+="#"+this.id),this.klass&&this.klass.forEach(function(e){t+="."+e}),t}},{key:"hasObj",value:function(){return null!=this.grObj}},{key:"hasIdx",value:function(){return null!=this.grIdx}},{key:"isContainer",value:function(){return k(this.node,"data-chook-container")}}]),oe),te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function ne(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function oe(e){var t;(function(e){if(!(e instanceof oe))throw new TypeError("Cannot call a class as a function")})(this),this.node=e,this.name=e.tagName.toLowerCase(),k(e,"id")&&null===e.getAttribute("id").match(/^[0-9]/)&&(this.id=e.getAttribute("id")),this.isIgnore=k(e,"chook-ignore")||k(e,"data-chook-ignore"),k(e,"href")&&(t=e.getAttribute("href"))&&t.indexOf("javascript")&&(this.href=t.slice(0,320)),k(e,"data-chook-info")&&(this.grObj=e.getAttribute("data-chook-info")),k(e,"data-chook-idx")&&(this.grIdx=parseInt(e.getAttribute("data-chook-idx")));e=e,e=(f()||NaN)<8?e.className:e.getAttribute("class");0<(e=e?e.replace(Z,"").trim():"").length&&(this.klass=e.split(/\s+/).sort())}var ie=["TR","LI","DL"],re=["A","BUTTON"],ae=["I","SPAN","EM","svg"],r=(function(e,t,n){return t&&ne(e.prototype,t),n&&ne(e,n),e}(ce,[{key:"path",value:function(e){var t,n,o,i,r,a,s=1<arguments.length&&void 0!==arguments[1]&&arguments[1],c="",u={},l=[],d=!1,h=0,f=[],p=!1,g=!1;if(e===y.d)return{isIgnore:!0};for(t=new ee(e);"html"!==t.name&&"body"!==t.name&&e&&e.tagName;)u={x:t.path()||"",h:t.href||"",v:this.containerElemContent(t.node)||"",attr:[]},f.push(u.x),t.isIgnore&&(d=!0),!p&&t.hasObj()&&(p=!0,n=t.grObj),g||(t.hasIdx()?(g=!0,o=t.grIdx):-1===(r=t.path()).indexOf("/li")&&-1===r.indexOf("/dl")&&-1===r.indexOf("/tr")||(g=!0,o=this.index(t.node))),s&&""!==c&&(-1!==b(re,t.node.tagName)||t.isContainer())&&(p?u.obj=n:k(t.node.parentNode,"data-chook-info")&&(u.obj=t.node.parentNode.getAttribute("data-chook-info")),u.x=h,l.push(u)),c=t.path()+c,h++,e=t.node.parentNode,t=new ee(e),1===h&&(i=t.node);f.reverse();for(var v=0;v<l.length;v++)(a=l[v]).x=f.slice(0,h-a.x).join(""),a.idx=0,g&&(a.idx=o),p&&(a.obj=n);var m={xpath:c,containerMessage:l,isIgnore:d};return p&&(m.obj=n),g&&(m.idx=o),i&&(m.pnode=i),m}},{key:"index",value:function(e){for(var t=e;t&&"BODY"!==t&&-1===b(ie,t.tagName);)t=t.parentNode;if(t)for(var n=1,o=t.parentNode.childNodes,i=0;i<o.length;i++){var r=o[i];if(r.tagName===t.tagName){if(k(r,"data-chook-idx")&&(n=parseInt(r.getAttribute("data-chook-idx"))),r===t)return n;n++}}}},{key:"isLeaf",value:function(e){if(e.hasChildNodes()&&"svg"!==e.tagName)for(var t=e.childNodes,n=0;n<t.length;n++)if(1===t[n].nodeType)return!1;return!0}},{key:"isParentOfLeaf",value:function(e){if(!e.childNodes)return!1;if("svg"===e.tagName)return!1;for(var t=e.childNodes,n=0;n<t.length;n++)if(!this.isLeaf(t[n]))return!1;return!0}},{key:"depthInside",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;if(e.hasChildNodes()){if(t<n)return!1;for(var o=e.childNodes,i=0;i<o.length;i++){var r=o[i];if(1===r.nodeType&&!this.depthInside(r,t,n+1))return!1}}return n<=t}},{key:"onlyContainsChildren",value:function(e,t){if(0===!e.children.length)return!1;for(var n=e.children,o=0;o<n.length;o++)if(-1===b(t,n[o].tagName))return!1;return!0}},{key:"containerElemContent",value:function(e){var t;if(k(e,"data-chook-title")&&0<e.getAttribute("data-chook-title").length)return e.getAttribute("data-chook-title");if(k(e,"title")&&0<e.title.length)return e.getAttribute("title");if("BUTTON"===e.tagName)return 0<e.name.length?e.name:this.onlyContainsChildren(e,ae)&&null!=e.textContent&&0<(t=e.textContent.replace(/[\n \t]+/g," ").trim()).length&&t.length<50?t:void 0;if("A"===e.tagName){if(this.onlyContainsChildren(e,ae)&&null!=e.textContent){if(0<(t=e.textContent.replace(/[\n \t]+/g," ").trim()).length)return t<=50?t:t.slice(0,50)}else if(k(e,"href")&&0<e.getAttribute("href").length)return e.getAttribute("href")}else if("LABEL"===e.tagName&&null!=e.textContent&&0<(t=e.textContent.replace(/[\n \t]+/g," ").trim()).length&&t.length<50)return t}},{key:"isDOM",value:function(e){return"HTMLElement"in y.a?e&&e instanceof HTMLElement:!(!e||"object"!=(void 0===e?"undefined":te(e))||1!==e.nodeType||!e.nodeName)}}]),ce),L=function(e,t,n){return t&&se(e.prototype,t),n&&se(e,n),e};function se(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function ce(){!function(e){if(!(e instanceof ce))throw new TypeError("Cannot call a class as a function")}(this)}var ue=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}(he,r),L(he,[{key:"user",value:function(){return new $}}]),new he),le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function de(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function he(){return function(e){if(!(e instanceof he))throw new TypeError("Cannot call a class as a function")}(this),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(he.__proto__||Object.getPrototypeOf(he)).call(this))}var fe=(function(e,t,n){return t&&de(e.prototype,t),n&&de(e,n),e}(ve,[{key:"setUrlMap",value:function(e){this.urlMap=this.getUrlMap(e)}},{key:"getUrlMap",value:function(e){var t;return{pv:t=e.zone&&"api.growingio.com"===e.host?e.scheme+"api-"+e.zone+".growingio.com":e.scheme+e.host,action:t,cstm:t,pvar:t,ppl:t,evar:t,gif:y.b+"s.logsss.com/_ubc.gif"}}},{key:"connect",value:function(e){this.isBot=e.isBot,"function"==typeof this.callback&&this.callback(this.user,this.send)}},{key:"send",value:function(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"action";if(!window.gds.dataCollect&&!window.grBlind)try{if(t="pv"===n&&2===e.length?e[0].s:"",y.a.XMLHttpRequest&&!this.isBot&&"gif"!==n&&(this.xhrData=e.concat(this.xhrData).slice(0,50),e=this.xhrData.splice(0,10)),this.sendRemote(JSON.stringify(e),n,t),0<=this.typeListReceivedValid.length&&this.setRealTimeMessageCallBack){for(var o=[],i=0;i<e.length;i++){var r,a=e[i],s=a.t;0<=[].indexOf.call(this.typeListReceivedValid,s)&&(r=this.setRealTimeMessageCallBack(a)),o.push(r)}return o}}catch(e){y.c.log(e)}}},{key:"sendRemote",value:function(e,t){var n=this,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",i=this.urlMap[t];if(y.a.grWaitTime=Date.now()+1e3,""!==o&&(this.sendVisitTimeout+=1e3),y.a.XMLHttpRequest&&!this.isBot&&"gif"!==t){var r=new y.a.XMLHttpRequest;if("withCredentials"in r)return r.open("POST",i+"?stm="+Date.now(),!0),r.onreadystatechange=function(){if(4===r.readyState)if(""!==o&&(n.sendVisitTimeout-=1e3),n.removeAjax(r),y.a.grWaitTime=Date.now()+10,200===r.status)o&&""!==o&&n.user.updateSessionIdSendStatus(o,!0);else try{n.xhrData=JSON.parse(e).concat(n.xhrData)}catch(e){y.c.log(e)}},r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),"undefined"==typeof ArrayBuffer||null===ArrayBuffer||this.isbuffer?r.send(e):r.send(e.buffer),void this.XMLHttpRequestArray.push(r)}if(void 0!==y.a.XDomainRequest&&!this.isBot&&"gif"!==t){var a=new y.a.XDomainRequest,i="http:"===document.location.protocol?i.replace("https://","http://"):i;return a.open("POST",i+"?stm="+Date.now()),a.onload=function(){n.removeXDR(a,o),n.xhrData.splice(0,10),""!==o&&n.user.updateSessionIdSendStatus(!0,o)},a.onerror=function(){n.removeXDR(a,o)},a.onprogress=function(){},a.ontimeout=function(){},a.send(e),void this.XDomainRequestArray.push(a)}i="http:"===document.location.protocol?i.replace("https://","http://"):i;var s="";if("gif"===t)try{var c,u=JSON.parse(e);for(c in u)"object"===le(u[c])&&(u[c]=JSON.stringify(u[c])),s+="&"+encodeURIComponent(c)+"="+encodeURIComponent(u[c]);s=i+(s=s.replace("&","?"))+"&stm="+ +Date.now()}catch(e){y.c.log(e)}else s=i+"?data="+e+"&stm="+ +Date.now();s.length<=2036&&this.imgSend(s,o)}},{key:"removeAjax",value:function(e){e=this.XMLHttpRequestArray.indexOf(e);-1!==e&&this.XMLHttpRequestArray.splice(e,1)}},{key:"removeXDR",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",e=this.XDomainRequestArray.indexOf(e);-1!==e&&this.XDomainRequestArray.splice(e,1),y.a.grWaitTime=Date.now()+10,""!==t&&(this.sendVisitTimeout-=300)}},{key:"imgSend",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",o=document.createElement("img");o.width=1,o.height=1,o.onload=function(){e.imgSendClear(o,n),""!==n&&e.user.updateSessionIdSendStatus(!0,n)},o.onerror=o.onabort=function(){e.imgSendClear(o,n)},o.src=t,this.XDomainRequestArray.push(o)}},{key:"imgSendClear",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";e.onload=null,e.onerror=null,e.onabort=null,this.removeXDR(e,t)}}]),ve),pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function ge(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function ve(e,t){!function(e){if(!(e instanceof ve))throw new TypeError("Cannot call a class as a function")}(this),this.sendVisitTimeout=0,this.user=e,this.callback=t,this.isBot=!1,this.IEVersion=f(),this.typeListReceivedValid=[],this.XDomainRequestArray=[],this.XMLHttpRequestArray=[],this.xhrData=[],this.isbuffer=!0}var me=(function(e,t,n){return t&&ge(e.prototype,t),n&&ge(e,n),e}(we,[{key:"replaceProps",value:function(e){e&&(this.properties=e)}},{key:"reduceProps",value:function(e){if(e){var t,n=[];for(t in e)this.properties[t]=e[t],n.push(e[t]);return n}}},{key:"sendPV",value:function(e,t){var n,o=this;if(t=t||function(){return{}},this.sender.sendVisitTimeout&&0<this.sender.sendVisitTimeout)setTimeout(function(){return o.sendPV(e,t)},this.sender.sendVisitTimeout);else{if(this.messages=[],this.options=this.defaultOptions,e)for(var i in e)this.options[i]=e[i];if(this.options.addPreProps||this.options.gioId)for(var r in this.preProperties)(n=this.properties)[r]||(n[r]=this.preProperties[r]);this.options.useNewTime&&(this.pageLoaded=Date.now()),this.pageLoaded&&(this.pageLoaded=Date.now()),(this.options.gioId||this.options.sendVisit&&this.gruser.isSendNewVisit())&&this.messages.push(this._buildVisitMessage()),this.options.gioId||this.messages.push(this._buildPageMessage());var a=window.name,s=void 0;if(""!==a)try{var c=JSON.parse(a),s=c.bigdata;delete c.bigdata;var u=JSON.stringify(c);window.name="{}"===u?"":u}catch(e){if(-1!==a.indexOf("#########globalegrow-bigdata##########")){u=a.split("#########globalegrow-bigdata##########"),a=u.splice(1,1);if(window.name=u.join("#########globalegrow-bigdata##########"),0<a.length)try{a=a[0],s=JSON.parse(a)}catch(e){}}}s&&"object"===(void 0===s?"undefined":pe(s))&&this.messages.push(s);s=GlobalegrowLocalStore._readFromLocalStorage("globalegrow_bigdata");s&&(this.messages.push(JSON.parse(s)),GlobalegrowLocalStore.removeInLocalStorage("globalegrow_bigdata")),this.sender.send(this.messages,"pv"),this.sender.send(this._buildPageMessage(),"gif"),this.preProperties=this.properties,this.properties={},this.options.gioId&&(this.options.gioId=!1),t(this)}}},{key:"setPageGroup",value:function(e,t){var n=this;if(!e)return!1;this.reduceProps({pg:e}),this.pageLoaded&&Date.now()-this.pageLoaded<4e3&&this.launcher.started&&setTimeout(function(){n.sendPV({sendVisit:!1,addPreProps:!0,useNewTime:!1},t)})}},{key:"setDeferSendWithPage",value:function(e,t,n){if(t)return!1;e&&(this.reduceProps(e),t(this)&&this.sendPV({addPreProps:!0,useNewTime:!1},n))}},{key:"_buildPageMessage",value:function(){var e,t=A(),n={et:"page",ak:window.gds.accountId,av:window.gds.version,dt:x()||"pc",vid:this.gruser.vid(),sid:this.gruser.sid(),oi:T(),uid:C(),cid:O()||this.gruser.vid(),sh:window.screen.height,sw:window.screen.width,ti:document.title.slice(0,255),tm:this.pageLoaded,lp:t.lp||"",rp:t.rp||"",wt:(e=(new Date).getTime(),t=P("wt")||e,t=(new Date).getTime()-t,j("wt",e),t||0),ptm:0,pt:window.location.protocol.substring(0,window.location.protocol.length-1),d:window.location.host||window.gds.accountId,p:h(),l:null!=navigator.language?navigator.language.toLowerCase():void 0,rf:S(),dc:I(),cc:I("dc")},t=_();if(n.q=0<t.length?t:"",n.e=[{x:"",v:"",h:"",idx:0,attr:[]}],n.appId=window.gds.appId,this.properties)for(var o in this.properties)n[o]=this.properties[o];return n}},{key:"_buildVisitMessage",value:function(){var e=A(),t={et:"visit",ak:window.gds.accountId,av:window.gds.version,sh:window.screen.height,sw:window.screen.width,dt:x()||"pc",vid:this.gruser.vid(),sid:this.gruser.sid(),oi:T(),uid:C(),cid:O()||this.gruser.vid(),lp:e.lp||"",rp:e.rp||"",wt:0,tm:Date.now(),ptm:0,d:window.location.host||window.gds.accountId,p:h(),rf:S(),l:null!=navigator.language?navigator.language.toLowerCase():void 0,pt:window.location.protocol.substring(0,window.location.protocol.length-1),isfirst:"Y",dc:I(),cc:I("dc")},e=_();return t.q=0<e.length?e:"",t.e=[{x:"",v:"",h:"",idx:0,attr:[]}],t.appId=window.gds.appId,t}},{key:"sendPVOnSidChanged",value:function(){var e=this.gruser.currentSessionId()[0];this.gruser.lastSessionId!==e&&(e||(e=this.gruser.guid(),this.gruser.resetUserId()),this.gruser.updateSessionId(e,!1),this.sendPV({sendVisit:!0,useNewTime:!0}))}}]),we),ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function be(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function we(e,t,n){!function(e){if(!(e instanceof we))throw new TypeError("Cannot call a class as a function")}(this),this.sender=e,this.gruser=t,this.launcher=n,this.properties={},this.messages=[],this.defaultOptions={sendVisit:!0,addPreProps:!1,useNewTime:!0,gioId:!1}}var ke="/static/glsdk_plugins.js",Se=["view-model","heatmap-model","load-heatmap","vtrack-model","vtrack-view-model","vtrack-close-model","vtrack-pick-model"],_e=(function(e,t,n){return t&&be(e.prototype,t),n&&be(e,n),e}(Ie,[{key:"bindEvents",value:function(){var n=this;d(window,"message",function(e){var t=e.data,e=t.model||t.heatmapModel;if(t.ai===window.gds.accountId&&n.isSdkEvent(e))switch(e){case"view-model":n.drawHeatmap("stop",t);break;case"heatmap-model":n.drawHeatmap("start",t);break;case"vtrack-model":n.initVtrack("start",t);break;case"vtrack-view-model":n.initVtrack("stop");break;case"vtrack-close-model":n.removeSelectedEle();break;case"vtrack-pick-model":n.initPickRule()}}),d(window,"beforeunload",function(e){var t;n.canPostRegisterMessage()&&(t={circleMode:"page-unload",url:y.a.location.toString(),ak:y.a.gds.accountId,sna:y.a.grSource.name,sid:y.a.grSource.id,dc:I(),cc:I("dc"),tna:"",fsna:"sdk",tArr:[y.a.grSource.id]},y.a.parent.postMessage(t,"*"))})}},{key:"isSdkEvent",value:function(e){return-1!==b(Se,e)}},{key:"loadHeatmap",value:function(){this.heatmapLoaded=!1;for(var e,t=document.getElementsByTagName("script"),n=0;n<t.length;n++){var o=t[n].getAttribute("src");if(null!=o&&-1!==o.indexOf(ke)){this.heatmapLoaded=!0;break}}this.heatmapLoaded||((e=document.createElement("script")).type="text/javascript",e.charset="UTF-8",e.src=this.allowOrigin+ke,document.head.appendChild(e))}},{key:"loadGlsdkPlugins",value:function(){this.glsdkPluginsLoaded=!1;for(var e,t=document.getElementsByTagName("script"),n=0;n<t.length;n++){var o=t[n].getAttribute("src");if(null!=o&&-1!==o.indexOf(ke)){this.glsdkPluginsLoaded=!0;break}}this.glsdkPluginsLoaded||((e=document.createElement("script")).type="text/javascript",e.charset="UTF-8",e.src=this.allowOrigin+ke,document.head.appendChild(e))}},{key:"drawHeatmap",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(this.glsdkPluginsLoaded||this.loadGlsdkPlugins(),this.glsdkPluginsLoaded&&"object"===ye(y.a.glsdkmap)&&null!==y.a.glsdkmap)try{y.a.glsdkmap.destroyHeatmap(),"start"===e&&(t.data.forEach(function(e){y.a.glsdkmap.parseNode(e)}),y.a.glsdkmap.loadHeatmap())}catch(e){console.log(e)}}},{key:"sendPageLoad",value:function(e){var t;this.canPostRegisterMessage()&&(t={circleMode:"page-load",url:y.a.location.toString(),ak:y.a.gds.accountId,sna:y.a.grSource.name,sid:y.a.grSource.id,dc:I(),cc:I("dc"),tna:"",fsna:"sdk",tArr:[y.a.grSource.id]},y.a.parent.postMessage(t,"*"))}},{key:"canPostRegisterMessage",value:function(){return y.a.parent&&"function"==typeof y.a.parent.postMessage&&y.a.self!==y.a.top&&y.a.self!==y.a.parent}},{key:"initVtrack",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(this.glsdkPluginsLoaded||this.loadGlsdkPlugins(),this.glsdkPluginsLoaded&&"object"===ye(y.a.glsdkvtrack)&&null!==y.a.glsdkvtrack&&(y.a.glsdkvtrack.destroyVtrak(),"start"===e))try{var n=t.data;y.a.glsdkvtrack.initVtrack(n)}catch(e){console.log(e)}}},{key:"removeSelectedEle",value:function(){y.a.glsdkvtrack.removeCoveredEle()}},{key:"initPickRule",value:function(){y.a.glsdkvtrack.initPickRuleMode()}}]),Ie),xe=("https:"===document.location.protocol?"https://":"http://")+"dap.logsss.com/heatmap/subcribe";function Ie(){!function(e){if(!(e instanceof Ie))throw new TypeError("Cannot call a class as a function")}(this),this.allowOrigin=window.gds.origin,this.bindEvents(),this.glsdkPluginsLoaded=!1,this.loadGlsdkPlugins()}function Oe(){}function Te(){}function Ce(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var Ee=[".js_lazyimg",".js_gbexp_lazy",".js_lazy",".js_lazySliderImg",".js_gdexp_lazy",".js-lazyload",".js-buyerShowImgLazyLoad",".js_load_ingimg"],Pe=(function(e,t,n){return t&&Ce(e.prototype,t),n&&Ce(e,n),e}(Ne,[{key:"add",value:function(e){this.options.push(e)}},{key:"cleanAll",value:function(){this.options=[]}},{key:"start",value:function(){var n=this;this.timer=setTimeout(function(){var e,t=[];0<n.options.length&&(n.options.forEach(function(e){t=t.concat(e.e)}),e=n.options.length,n.options[e-1].e=t,n.sender.send([n.options[e-1]]),n.cleanAll()),n.start()},500)}},{key:"executeImmediately",value:function(){this.sender.send(this.options),this.stop()}},{key:"stop",value:function(){this.timer=null,this.options=[]}}]),Ne),je=n(3);function Ae(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ne(e){!function(e){if(!(e instanceof Ne))throw new TypeError("Cannot call a class as a function")}(this),this.options=[],this.timer=null,this.sender=e}var Le=["zaful","rosegal","dresslily","gearbest","rosewholesale"],De=["TEXTAREA","HTML","BODY"],Me=["button","submit"],Re=["A","BUTTON","INPUT","IMG"],Ve=["I","SPAN","EM","svg"],qe=["radio","checkbox"],Be=["A","BUTTON"],He=null,Ue=[],Ge=3,Xe=null,Je={},Fe=0,ze=!1,Qe={tspan:1,text:1,g:1,rect:1,path:1,defs:1,clipPath:1,desc:1,title:1},L=(function(e,t,n){return t&&Ae(e.prototype,t),n&&Ae(e,n),e}($e,[{key:"sendPageCallback",value:function(){var t=this;return function(e){t.pageLoaded=e.pageLoaded,t.prevPageAttrs=v({},e.preProperties),t.lastActionTime=Date.now()}}},{key:"setPageGroup",value:function(t){var n=this;return this.pageService.setPageGroup(t,function(e){n.sendPageCallback()(e),n.messagingObserver&&n.messagingObserver.sendPageCallback({pg:t})})}},{key:"setDeferSendWithPage",value:function(e,t){t&&this.pageService.setDeferSendWithPage(e,t,this.sendPageCallback())}},{key:"setPSForActionMessage",value:function(e){this.prevPageAttrs.pg&&(e.pg=this.prevPageAttrs.pg)}},{key:"registerDomObserver",value:function(){var e,i=this;y.a.gds.imp&&(He&&He.disconnect(),e={initialize:function(t){var n=[],e={u:i.gruser.vid(),s:i.gruser.sid(),t:"imp",tm:Date.now(),ptm:i.pageLoaded,d:y.a.location.host||y.a.gds.accountId,p:i.currentPath};0<i.currentQuery.length&&(e.q=i.currentQuery);var o=i.gruser.getCs1();o&&(e.cs1=o),i.setPSForActionMessage(e),t.forEach(function(e){"use"!==e.tagName&&(n=n.concat(i.getLeafNodes(e,t.length)))}),e.e=n,i.sender.send([e])},applyChanged:function(t){var e,n,o=[];0<t.length&&!document.body.className.match(/\bgds-entrytext\b/)&&(i.gruser.hasSid()||i.pageService.sendPV({sendVisit:!1,addPreProps:!0,useNewTime:!1},i.sendPageCallback()),n={u:i.gruser.vid(),s:i.gruser.sid(),t:He.snapshoting?"snap":"imp",tm:Date.now(),ptm:i.pageLoaded,d:y.a.location.host||y.a.gds.accountId,p:i.currentPath},(e=i.gruser.getCs1())&&(n.cs1=e),0<i.currentQuery.length&&(n.q=i.currentQuery),i.setPSForActionMessage(n),t.forEach(function(e){"use"!==e.tagName&&(o=o.concat(i.getLeafNodes(e,t.length)))}),0<(n.e=o).length&&i.sendPolicy(n))}},this.TreeMirror&&(this.client=He=new this.TreeMirror.client(document.body,e)))}},{key:"sendPolicy",value:function(e){var t=this;Ue.push(e),Ge<0?this.sendQueue():(this.queueTimeout&&clearTimeout(this.queueTimeout),this.queueTimeout=setTimeout(function(){t.sendQueue()},3e3),this.checkingBlance())}},{key:"deregisterDomObserver",value:function(){He&&He.disconnect()}},{key:"idle",value:function(){if(this.lastSentTime=this.lastSentTime||Date.now(),this.lastSentTime)return 300<(Date.now()-this.lastSentTime)/Ue.length}},{key:"checkingBlance",value:function(){return this.idle()?Ge--:void 0}},{key:"sendQueue",value:function(){0<Ue.length&&Date.now()-this.lastActionTime<12e4&&this.sender.send(Ue),this.queueTimeout=null,this.lastSentTime=Date.now(),Ue=[],Ge=3}},{key:"getLeafNodes",value:function(o,e){var i,r=this,a=[],s=!0;if(o.leaf&&1===o.nodeType)null==((t=o.attributes)?t.href:void 0)&&null==o.text&&null==o.obj||(i=this.nodeMessage(o,!0),1<e&&(i.idx=o.idx),a.push(i));else{if(0===o.childNodes.length&&-1!==b(Re,o.tagName))return!1;e=o.childNodes;Array.prototype.forEach.call(e,function(e,t,n){e.leaf||(s=!1),"use"!==e.tagName&&(a=a.concat(r.getLeafNodes(e,n.childNodes.length)))});var t=(t=o.attributes)?t.any:void 0;(-1!==b(Be,o.tagName)||s&&(t||o.text))&&(o.text||(t=o.dom,o.text=t?this.info.containerElemContent(t):w(o)),i=this.nodeMessage(o,!0),a.push(i)),"SPAN"===o.tagName&&(e=o.childNodes,Array.prototype.forEach.call(e,function(e,t,n){"svg"===e.tagName&&(e=e.childNodes,Array.prototype.forEach.call(e,function(e){1===e.nodeType&&"use"===e.tagName&&k(e,"xlink:href")&&(i=r.nodeMessage(o,!0),a.push(i))}))}))}return a}},{key:"nodeMessage",value:function(e){var t={x:e.path,v:e.text};"A"===e.tagName&&e.text&&0===e.text.length&&(t.v=void 0),e.text&&50<e.text.length&&(t.v="A"===e.tagName?e.text.slice(0,50):void 0),e.attributes&&e.attributes.href&&0!==e.attributes.href.indexOf("javascript")&&(t.h=e.attributes.href.slice(0,320),delete e.attributes.href),e.idx&&(t.idx=e.idx),e.obj&&(t.obj=e.obj),this.appendMessageAttrs(He,t,e)}},{key:"appendEventAttrs",value:function(){throw new Error("这是一个接口方法")}},{key:"appendMessageAttrs",value:function(){throw new Error("这是一个接口方法")}},{key:"registerEventListener",value:function(){function r(e,t,n){e.addEventListener?e.addEventListener(t,n,!0):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}function a(e){1<e.which||Xe===Date.now()||(Xe=Date.now(),Je={time:Xe,target:e.target||e.srcElement,x:n("x",e),y:n("y",e)},Fe=setTimeout(function(){e={target:Je.target,type:"click"},t(e)},600))}function s(e){var t=Math.abs(n("x",e)-Je.x),e=Math.abs(n("y",e)-Je.y);(10<t||e)&&clearTimeout(Fe)}function c(e){Date.now()-Je.time<1e3&&clearTimeout(Fe)}function n(e,t){return(ze?t.touches[0]:t)["page"+e.toUpperCase()]}function t(e){var t,n;if(!document.body.className.match(/\bgds-entrytext\b/)){for(p.lastActionTime=Date.now(),t=e.target||e.srcElement;t&&Qe[t.tagName]&&t.parentNode;)t=t.parentNode;if((n=p.info.path(t,!0)).isIgnore)return!1;y.a.gds.impCtrlDua&&(y.a.grImpCtrl=Date.now());var o=t.tagName;if("click"===e.type){if(-1!==b(De,o))return;if("INPUT"===o&&-1!==b(Me,t.type))return;if(-1===b(Re,o)&&!p.info.depthInside(t,4))return}p.gruser.hasSid()?"click"===e.type&&p.pageService.sendPVOnSidChanged():p.pageService.sendPV({sendVisit:!0,addPreProps:!0,useNewTime:!0},p.sendPageCallback());var i=A(),r={};r.et=f[e.type],r.vid=p.gruser.vid(),r.sid=p.gruser.sid(),r.oi=T(),r.uid=C(),r.cid=O()||p.gruser.vid(),r.tm=Date.now(),r.dt=x()||"pc",r.ak=window.gds.accountId,r.av=window.gds.version,r.sh=window.screen.height,r.ti=document.title.slice(0,255),r.sw=window.screen.width,r.lp=i.lp||"",r.rp=i.rp||"",r.wt=0,r.ptm=p.pageLoaded,r.d=y.a.location.host||y.a.gds.accountId,r.p=p.currentPath,r.l=null!=y.f.language?y.f.language.toLowerCase():void 0,r.q=0<p.currentQuery.length?p.currentQuery:"",r.pt=window.location.protocol.substring(0,window.location.protocol.length-1),r.rf=S(),r.dc=I(),r.cc=I("dc"),p.setPSForActionMessage(r);var a="snapshot"===e.type,o="load"===e.type;a&&(e.type="click");i=p.compute(e.type,t);if(p.appendElemAttrs(i,a,t,n),i.x=n.xpath,n.obj&&(i.obj=n.obj),i.idx=0,n.idx?i.idx=n.idx:-1===i.x.indexOf("dl")&&-1===i.x.indexOf("tr")&&-1===i.x.indexOf("li")||(i.idx=p.info.index(t)),0===n.containerMessage.length||o?r.e=[i]:-1!==b(Be,n.pnode.tagName)&&p.info.onlyContainsChildren(n.pnode,Ve)?r.e=n.containerMessage:r.e=[i].concat(n.containerMessage),r.e&&0<r.e.length)for(var s=r.e,c=0;c<s.length;c++)s[c].idx||(s[c].idx=0);if(o){var u,l=e.target.attributes,d=[];for(u in l){var h=l[u].name;/^data-logsss-/.test(h)&&d.push(e.target.getAttribute(h))}r.e[0].attr=d,Object(je.a)(r,e),p.imgExposure.add(r)}else Object(je.a)(r,e),a?p.snapshotCallback(e,r):(p.currentData=r,p.timer=setTimeout(function(){p.currentData=null,p.sender.send([r])},5));o=r,"click"===e.type&&"www.gearbest.com"===o.d&&"/"===o.p&&e.target.src&&"https://uidesign.gbtcdn.com/GB/image/promotion/20181206_6427/680x312a.jpg?imbypass=true"===e.target.src&&((a={name:"Double-Twelve"}).domain=o.d,a.page=o.vid,g(xe,Oe,Te,"POST",a))}}var e,f={click:"click",change:"change",submit:"submit",snapshot:"snapshot",load:"exposure"},p=this;for(e in f)"load"!==e&&r(document,e,t);r(document,"scroll",function(e){y.a.gds.impCtrlDua&&(y.a.grImpCtrl=Date.now())}),y.a.gds.touch&&function(){var e,t,n=y.f.userAgent,o=/chrome/i.exec(n),n=/android/i.exec(n),n=(ze="ontouchstart"in y.a&&o&&!n)?(e=["touchstart"],t=["touchmove"],["touchend","touchcancel"]):(e=["mousedown"],t=["mousemove"],["mouseup","mouseleave"]);e.forEach(function(e){r(document,e,a)}),t.forEach(function(e){r(document,e,s)});var i=[];n.forEach(function(e){i.push(r(document,e,c))})}(),y.a.gds.exposure&&(function(n,e){var o=1<arguments.length&&void 0!==e&&e,i=document.querySelectorAll(Ee.join(","));if(0<i.length)for(var t=0;t<i.length;t++)!function(e){var t=i[e];document.addEventListener?t.addEventListener("load",n,o):document.attachEvent&&t.attachEvent("onload",function(){var e=window.event;e.currentTarget=t,e.target=e.srcElement,n.call(t,e)})}(t)}(t),this.imgExposure.start())}},{key:"snapshotCallback",value:function(){throw new Error("这是一个接口方法")}},{key:"exposureCallback",value:function(e,t){throw new Error("这是一个接口方法")}},{key:"appendElemAttrs",value:function(){throw new Error("这是一个接口方法")}},{key:"checkJumpByATage",value:function(e){var r,a,s=!0;return(e.e||0<e.e.length)&&(e=e.e,r=/^a(\.|#|$)/,a=e[0].x.split("/"),e.forEach(function(e){var t=a[a.length-1];if(r.test(t)&&e.h&&(-1!==e.h.indexOf("http://")||-1!==e.h.indexOf("https://"))){for(var n=(n=e.h.match(/^http(s)?:\/\/.*?(\.(com|net|cn|org))/))?n[0]:"",o=!1,i=0;i<Le.length;i++)if(new RegExp(Le[i]).test(n)){o=!0;break}s=o}})),s}},{key:"compute",value:function(e,t){var n,o,i,r,a,s=this,c={h:"",v:"",attr:[]},u=t.tagName;if("IMG"===u?t.src&&0<t.src.length&&-1===t.src.indexOf("data:image")&&(c.h=t.src):!k(t,"href")||(n=t.getAttribute("href"))&&0!==n.indexOf("javascript")&&(c.h=n.slice(0,320)),k(t,"data-chook-title")&&0<t.getAttribute("data-chook-title").length?c.v=t.getAttribute("data-chook-title"):k(t,"title")&&0<t.getAttribute("title").length&&(c.v=t.getAttribute("title")),"click"===e)if(this.info.isLeaf(t))switch(u){case"IMG":if(t.alt&&!c.v){c.v=t.alt;break}if(c.h){var l=c.h.split("?")[0].split("/");0<l.length&&(c.v=l[l.length-1]);break}case"INPUT":-1!==b(Me,t.type)&&(c.v=t.value);break;case"svg":var d=t.childNodes;Array.prototype.forEach.call(d,function(e){1===e.nodeType&&"use"===e.tagName&&k(e,"xlink:href")&&(c.v=e.getAttribute("xlink:href"))});break;default:d="";t.textContent?d=t.textContent.replace(/[\n \t]+/g," ").trim():t.innerText&&(d=t.innerText.replace(/[\n \t]+/g," ").trim()),0<d.length&&(d.length<50?c.v=d:"A"===u&&(c.v=d.slice(0,50)))}else-1!==b(Be,u)?(r=this.info.containerElemContent(t),!this.info.isParentOfLeaf(t)||this.info.onlyContainsChildren(t,Ve)||(a=w(t))===r?c.v=r:(c.v=a||r,c.obj=r||"")):this.info.isParentOfLeaf(t)&&(c.v=w(t));else"change"===e?"TEXTAREA"!==u&&("INPUT"===u?-1!==b(qe,t.type)?(c.v=t.value,"LABEL"===(r=t.parentNode).tagName?o=r:("BODY"!==r.tagName&&("LABEL"===(r=r.parentNode).tagName?o=r:t.id&&(i=r.getElementsByTagName("label"),Array.prototype.forEach.call(i,function(e){o=e}))),null==o||(i=this.info.containerElemContent(o))&&0<i.length&&(c.v=i+" ("+t.checked+")"))):"password"!==t.type&&(c.v=t.value):"SELECT"===u&&(c.v=t.value,1===t.selectedOptions.length&&t.selectedOptions[0]&&(c.v=t.selectedOptions[0].label))):"submit"===e&&(e=t.getElementsByTagName("input"),Array.prototype.forEach.call(e,function(e){("search"===e.type||"text"===e.type&&("q"===e.id||-1!==e.id.indexOf("search")||-1!==e.className.indexOf("search")&&"q"===e.name||-1!==e.name.indexOf("search")))&&(c.x=s.info.path(e),c.v=e.value.trim())}));return c}},{key:"bindEvent",value:function(){var e,o=this;return this.canPostRegisterMessage()&&(e={circleMode:"page-load",url:y.a.location.toString(),ak:y.a.gds.accountId,sna:y.a.grSource.name,sid:y.a.grSource.id,dc:I(),cc:I("dc"),tna:"",fsna:"sdk",tArr:[y.a.grSource.id]},y.a.parent.postMessage(e,"*")),d(y.a,"message",function(e){try{var t=e.data,n=t.model||t.circleMode;if(y.a.self===y.a.top||t.ai!==y.a.gds.accountId)return!1;switch(n){case"gbdata-register-SDK-heatmap":case"gbdata-register-SDK-vtrack":o.registerGlsdkHandler()}}catch(e){console.log(e)}})}},{key:"registerGlsdkHandler",value:function(){if(!this.messagingObserver)try{this.messagingObserver=new _e}catch(e){console.log(e)}}},{key:"canPostRegisterMessage",value:function(){return y.a.parent&&"function"==typeof y.a.parent.postMessage&&y.a.self!==y.a.top&&y.a.self!==y.a.parent}},{key:"observe",value:function(){var o=this;if(this.currentPath=h(),this.currentQuery=_(),this.pageService.sendPV({},this.sendPageCallback()),this.bindEvent(),document.addEventListener)"interactive"===document.readyState||"complete"===document.readyState?this.domLoadedHandler():d(document,"DOMContentLoaded",function(){o.domLoadedHandler()});else if(document.attachEvent){d(document,"onreadystatechange",function(){o.domLoadedHandler()});var e=!1;try{e=null===y.a.frameElement}catch(o){console.log(o)}document.documentElement.doScroll&&e&&!function t(){try{document.documentElement.doScroll("left")}catch(e){setTimeout(t,1)}return o.domLoadedHandler()}()}d(y.a,"load",function(){o.queueTimeout&&o.sendQueue()}),d(y.a,"beforeunload",function(e){if(clearTimeout(o.timer),o.currentData){var t=void 0;if(console.log(o.checkJumpByATage(o.currentData)),o.checkJumpByATage(o.currentData)){var n=window.name||"{}";try{(t=JSON.parse(n)).bigdata=o.currentData,window.name=JSON.stringify(t)}catch(e){window.name+="#########globalegrow-bigdata##########"+JSON.stringify(o.currentData)}}else GlobalegrowLocalStore._setInLocalStorage("globalegrow_bigdata",JSON.stringify(o.currentData),2592e6)}o.queueTimeout&&o.sendQueue()}),d(y.a,"unload",function(){})}},{key:"domLoadedHandler",value:function(){var e=this;this.domLoadedHandler.done||(this.domLoadedHandler.done=!0,this.registerEventListener(),null!=this.TreeMirror&&y.a.gds.imp&&(this.initServerImpSetting(),y.a.gds.impCtrlDua&&(y.a.grImpCtrl=Date.now()),setTimeout(function(){e.registerDomObserver()},1500)))}}]),$e),n=function(e,t,n){return t&&We(e.prototype,t),n&&We(e,n),e};function We(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function $e(e,t,n,o){!function(e){if(!(e instanceof $e))throw new TypeError("Cannot call a class as a function")}(this),this.sender=e,this.gruser=t,this.launcher=n,this.TreeMirror=o,this.content={},this.messagingObserver=null,this.pageService=new me(this.sender,this.gruser,this.launcher),this.imgExposure=new Pe(this.sender),this.timer=null,this.currentData=null}var Ke=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}(Ze,L),n(Ze,[{key:"snapshotCallback",value:function(){}},{key:"appendMessageAttrs",value:function(e,t){return t}},{key:"initServerImpSetting",value:function(){}},{key:"appendElemAttrs",value:function(e){return e}}]),Ze),n=function(e,t,n){return t&&Ye(e.prototype,t),n&&Ye(e,n),e};function Ye(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ze(e,t,n,o){!function(e){if(!(e instanceof Ze))throw new TypeError("Cannot call a class as a function")}(this);o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Ze.__proto__||Object.getPrototypeOf(Ze)).call(this,e,t,n,o));return o.info=ue,o}var et=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}(tt,t),n(tt,[{key:"afterInitialize",value:function(){}},{key:"defaultSamplingFunc",value:function(){var e=this.user.vid(),t=y.a.gds.sampling_ratio;return 0==parseInt(e.slice(-2),16)%t}},{key:"beforeConnect",value:function(){this.sender.setUrlMap(this.options)}}]),tt);function tt(){!function(e){if(!(e instanceof tt))throw new TypeError("Cannot call a class as a function")}(this);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(tt.__proto__||Object.getPrototypeOf(tt)).call(this));return e.user=ue.user(),e.sender=new fe(e.user,e.callback()),e.observer=new Ke(e.sender,e.user,e,null),e}!function(){var e=arguments,t=y.a.globalegrowbigdatasdk2018;if(y.a._gr_support_circle_pop_out=!0,!y.a._disable_js_gds&&("boolean"!=typeof y.a.webViewRequestSend||y.a.webViewRequestSend||!y.a._gds_ios||y.a._gds_bridge)){if(y.a.globalegrowSdkInstalled)return y.c.log("globalegrowSdkInstalled:","重复加载global SDK");var n=new et;y.a.globalegrowSdkInstalled=!0;var o=y.a[t];(o&&o.q?o.q:[]).forEach(function(e){n.apply.apply(n,e)});var i=function(){var e=1<=arguments.length?y.h.call(arguments,0):[];return n.apply.apply(n,e),e};i.push=function(){return 1<e.length?n.apply.apply(n,e):n.apply.apply(n,e[0])},i.track=function(){var e=i.system;return e.track.apply(e,arguments)},i.platform="web",y.a.globalegrowArray=y.a.globalegrowArray||[],y.a.globalegrowArray.push(i),y.a[t]=function(){for(var e=y.a.globalegrowArray,t=[],n=0;n<e.length;n++){var o,i=arguments[0];("init"!==i&&"send"!==i||"web"===e[n].platform)&&(o=e[n].apply(null,arguments)),t.push(o)}return y.c.log("array:",t),t},y.a._gds={push:function(){for(var e=[],t=y.a.globalegrowArray,n=0;n<t.length;n++){var o=t[n].push.apply(t[n],arguments);e.push(o)}return e},track:function(){for(var e=[],t=y.a.globalegrowArray,n=0;n<t.length;n++){var o=t[n].track.apply(t[n],arguments);e.push(o)}return e}}}}()},function(module,__webpack_exports__,__webpack_require__){"use strict";function visualInfo(e,t){if(window.gds&&window.gds.visual_track_config&&window.gds.visual_track_config.domain===("https"===e.pt?"https://":"http://")+e.d&&window.gds.visual_track_config.page===e.p&&window.gds.visual_track_config.data&&0<window.gds.visual_track_config.data.length)for(var n=window.gds.elementThreshold||50,o=window.gds.visual_track_config.data||[],i=t.target,r=0;r<o.length;r++){var a=o[r];if(a.xpath&&""!==a.xpath&&e.et===a.eventName)for(var s=document.querySelectorAll(a.xpath),c=0;c<s.length;c++)if(c<=n&&i===s[c]){setOptions(a.ruleProList,e.e[0]);break}}}function setOptions(e,t){for(var n={},o=0;o<e.length;o++){var i=e[o];switch(i.ruleType){case 1:n[i.shortName]=getElementAttr(i.pickRule);break;case 2:n[i.shortName]=getGlobalVar(i.pickRule);break;default:n[i.shortName]=""}}t.attr=n}function getGlobalVar(rule){var value=null;try{value=eval(rule)}catch(e){value=""}return value}function getElementAttr(e){var t="";if("string"!=typeof e)return t;if(""!==e)try{var n=document.querySelector(e),t=null===n?"":"string"==typeof n.textContent?n.textContent:n.innerText;n&&""==t&&(t=n.value||"")}catch(e){}return t}__webpack_exports__.a=visualInfo}]);
