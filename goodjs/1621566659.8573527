define((function(){"use strict";var t,e=".jpg";function i(t){this.element=t,this.promo=this.element.getAttribute("data-promo"),this.useWebP="true"===this.element.getAttribute("data-use-webp"),this.useRetina="true"===this.element.getAttribute("data-use-retina"),this.staticPath=this.element.getAttribute("data-static"),this.basePath=this.staticPath+"res/i/anonym/"+this.promo+"/image",this.rootHtmlNode=document.documentElement,this.extension=e,this.pixelRatio=window.devicePixelRatio||1,this.promoButton=this.element.querySelector(".prl_adv_a"),this.linkPixel=this.element.getAttribute("data-link-pixel"),this.hasLinkPixel=this.promoButton&&this.linkPixel&&0!==this.linkPixel.length&&"null"!==this.linkPixel}return i.prototype={init:function(){return"default"!==this.promo&&(this.useWebP&&(this.rootHtmlNode.classList.contains("chrome")||this.rootHtmlNode.classList.contains("mac-chrome"))&&(this.extension=".webp"),this.useRetina&&this.pixelRatio>1&&(this.basePath+="@2x")),this.hasLinkPixel&&(this._linkPixelHandler=this.linkPixelHandler.bind(this),this.promoButton.addEventListener("click",this._linkPixelHandler)),this},destroy:function(){this.hasLinkPixel&&this.promoButton.removeEventListener("click",this._linkPixelHandler)},setImage:function(){return this.element.style.backgroundImage="url("+this.getSrc()+")",this},getSrc:function(){return this.basePath+this.extension},loadImage:function(){var t=new Image;t.onload=function(){this.setImage(),this.element.classList.add("__show")}.bind(this),t.onerror=function(){".webp"===this.extension&&(this.extension=e,t.src=this.getSrc())}.bind(this),t.src=this.getSrc()},linkPixelHandler:function(){(new Image).src=this.linkPixel}},{activate:function(e){return(t=new i(e).init()).loadImage()},deactivate:function(){t.destroy()}}}));