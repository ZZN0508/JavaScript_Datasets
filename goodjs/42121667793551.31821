YUI.add("circle-fill-graph",function(y){var S=Math.PI;y.CircleFillGraph=function(e){function o(){u=Date.now(),E=u,w=C=d=A=_=G=T=0,s=y.AnimationManager.subscribe(n)}function n(){var e,o,n,a;m.clearRect(0,0,l.width,l.height),a=Date.now(),T=(a-E)/1e3,G=(a-u)/1e3,_<i.length&&(e=i[_],o=0<_?i[_-1]:{durationProportion:0,fillProportion:0},n=t*(e.durationProportion-o.durationProportion),C=w+T/n,n=e.easeFunction?R[e.easeFunction](C):C,d=o.fillProportion+(e.fillProportion-o.fillProportion)*n,1<=C&&(d=e.fillProportion,w=C=0,_===A&&_++)),m.beginPath(),m.lineWidth=c,m.strokeStyle=r,m.arc(N.x,N.y,h,0,2*S),m.stroke(),function(){for(var e=p*d,u=p,o=0;o<e;o++)!function(e){for(var o=e/u,n=0,a=0;a<g.length;a++)if(g[a].fillProportion>o){n=a-1;break}var t=g[n],r=n+1<g.length?g[n+1]:t,i=t.value,l=r.value,s=(o-t.fillProportion)/(r.fillProportion-t.fillProportion),r=Math.ceil(parseInt(i.substring(0,2),16)*(1-s)+parseInt(l.substring(0,2),16)*s),t=Math.ceil(parseInt(i.substring(2,4),16)*(1-s)+parseInt(l.substring(2,4),16)*s),s=Math.ceil(parseInt(i.substring(4,6),16)*(1-s)+parseInt(l.substring(4,6),16)*s);m.beginPath(),m.lineWidth=c,m.strokeStyle="rgb("+r+", "+t+", "+s+")",m.arc(N.x,N.y,h,2*S*e/p+I,2*S*(e+1)/p+I+.01),m.stroke()}(o)}(),w=C,A=_,E=a,t<G&&setTimeout(function(){s.detach()},100)}var a,c,h,N,p,I,t,r,g,i,l,m,s,u,E,T,G,_,A,d,C,w,f,P,O,R=y.EasingFunctions;return P=(f=(f=e)||{}).containerElement,a=f.dim||{width:P.clientWidth,height:P.clientHeight},c=f.lineWidth||5,h=f.radius||a.width/2-c/2,N=f.pos||{x:a.width/2,y:a.height/2},p=f.segments||60,O=f.fillProportion||.8,I=f.rotOffset||-Math.PI/2,t=f.duration||1,r=f.backgroundStrokeColor||"#eeeeee",g=f.gradient||[{fillProportion:0,value:"5BF4FC"},{fillProportion:.3,value:"5BF4FC"},{fillProportion:.7,value:"FF32C4"},{fillProportion:1,value:"FF32C4"}],i=f.stops||[{durationProportion:1,fillProportion:O}],O=Math.max(0,Math.min(O,1)),i.forEach(function(e){e.fillProportion=Math.max(0,Math.min(e.fillProportion,1))}),e=f.containerElement,P=document.createElement("canvas"),O=P.getContext("2d"),f=window.devicePixelRatio||1,e.appendChild(P),P.style.width=a.width+"px",P.style.height=a.height+"px",P.width=a.width*f,P.height=a.height*f,O.scale(f,f),m=(l=P).getContext("2d"),{start:o}}},"@VERSION@",{requires:["animation-manager","easing-functions"]}),YUI.add("greetings-helper",function(n){var a=n.mix({langBundles:["account-menu"]},n.Localizable),t=[{hello:'Hola, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_SPANISH"},{hello:'Guten Tag, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_GERMAN"},{hello:'Servus, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_GERMAN"},{hello:'Gâ€™day, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_AUSTRALIAN"},{hello:'Hoi, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_DUTCH"},{hello:'Yo, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ENGLISH"},{hello:'Hi, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ENGLISH"},{hello:'Oi, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ENGLISH"},{hello:'Hala, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ARABIC"},{hello:'Ahoy, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ENGLISH"},{hello:'Hello, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ENGLISH"},{hello:'Bonjour, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_FRENCH"},{hello:'Salut, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_FRENCH"},{hello:'Salaam, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ARABIC"},{hello:'Ciao, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ITALIAN"},{hello:'Hola, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_SPANISH"},{hello:'Hej, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_SWEDISH"},{hello:'Aloha, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_HAWAIIAN"},{hello:'Kumusta, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_TAGALOG"},{hello:'Shalom, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_HEBREW"},{hello:'â€˜Allo, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ENGLISH"},{hello:'Namaste, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_HINDI"},{hello:'Ni hao, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_MANDARIN"},{hello:'OlÃ¡, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_PORTUGUESE"},{hello:'PÃ«rshÃ«ndetje, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ALBANIAN"},{hello:'Tere, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ESTONIAN"},{hello:'Yasou, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_GREEK"},{hello:'Szia, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_HUNGARIAN"},{hello:'Mbote, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_LINGALA"},{hello:'Jambo, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_SWAHILI"},{hello:'Moyo, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_TSHILUBA"},{hello:'Merhaba, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_TURKISH"},{hello:'Mingalaba, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_BURMESE"},{hello:'GÃ³Ã°an daginn, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ICELANDIC"},{hello:'Sawubona, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ZULU"},{hello:'Bangawoyo, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_KOREAN"},{hello:'FÃ¡ilte, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_IRISH"},{hello:'Labdien, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_LATVIAN"},{hello:'Kaixo, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_BASQUE"},{hello:'Nomoshkar, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_BENGALI"},{hello:'Zdrasti, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_BULGARIAN"},{hello:'Bok, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_CROATIAN"},{hello:'DobrÃ½ den, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_CZECH"},{hello:'Hej, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_DANISH"},{hello:'HyvÃ¤Ã¤ pÃ¤ivÃ¤Ã¤, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_FINNISH"},{hello:'Mike, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_HOPI"},{hello:'Szia, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_HUNGARIAN"},{hello:'Halo, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_INDONESIAN"},{hello:'Namaskara, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_KANNADA"},{hello:'ChonÃ®, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_KURDISH"},{hello:'Labas, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_LITHUANIAN"},{hello:'Selamat datang, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_MALAYSIAN"},{hello:'Hei, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_NORWEGIAN"},{hello:'Witaj, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_POLISH"},{hello:'BunÄƒ Ziua, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ROMANIAN"},{hello:'Privet, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_RUSSIAN"},{hello:'Zdravo, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_SERBIAN"},{hello:'Ahoj, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_SLOVAKIAN"},{hello:'Pryvit, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_UKRAINIAN"},{hello:'Xin chÃ o, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_VIETNAMESE"},{hello:'Sawubona, <a class="greeting-name" href="{{url}}">{{username}}</a>!',captionKey:"account-menu.GREETING_CAPTION_ZULU"}];n.Greetings={getRandomGreeting:function(e){var o=t[parseInt(Math.random()*t.length)];return{hello:e?o.hello.replace("{{username}}",n.StringHelper.escapeHtml(e.username)).replace("{{url}}",e.url):o.hello,caption:a.intlMessage({intlName:o.captionKey})}}}},"@VERSION@",{requires:["localizable","string-helper"]}),YUI.add("user-account-card-view",function(t,e){var a=require("hermes-core/flog")(e);new t.SubscriptionsHelper,t.namespace("Views")[this.name]=t.Base.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){this.params=e},loadState:function(){var o=this,e=[],n=this.appContext.getViewer().nsid;return e.push(this.appContext.getModel("person-models",n).then(function(e){if((o.userModel=e).getValue("isPro"))return o.appContext.getModel("effective-subscriptions-models",e.id).then(function(e){o.effectiveSubscriptions=e}).catch(function(e){a.error(e),o.effectiveSubscriptions=!1})})),e.push(this.appContext.getModel("person-profile-models",n).then(function(e){o.profileModel=e})),t.Promise.all(e)},buildContainer:function(){var e,o=this.profileModel.getValue("photoCount"),n=t.config.flickr.account.photo_limit,a=this.profileModel.getValue("unreadMessages");this.userModel.getValue("isPro")&&this.effectiveSubscriptions&&(e=0<this.effectiveSubscriptions.getValue("closed").length&&0===this.effectiveSubscriptions.getValue("pending").length);a={user:{isPro:this.userModel.getValue("isPro"),proBadge:this.userModel.getValue("proBadge"),csrf:this.appContext.auth.csrf||""},itemCount:o,itemLimit:n,limitReached:t.UserLimitsHelper.hasReachedUploadLimit(this.profileModel,this.appContext),isUnder500:o<=500,isClosedPro:e,unreadCount:a,hasUnreadMessages:0<a,attrs:{user:{username:this.userModel.getValue("username")}},greeting:t.Greetings.getRandomGreeting({username:this.userModel.getValue("username"),url:this.userModel.getValue("url")}),showOverLimitWarning:this.appContext.getCookie(t.config.flickr.upload_blocking.dismiss_over_upload_limit_message_cookie_name)&&t.UserLimitsHelper.isOverARRLimit(this.profileModel,this.appContext)},a=Object.assign(a,this.params);this.setContainerWithTemplate("user-account-card",a)},activate:function(){var e=this.get("container");this.graphContainer=e.one(".storage-section .graph"),this.learnMoreButton=e.one(".storage-section .over-limit-learn-button"),this.graphContainer&&this.drawStorageGraph(),this.learnMoreButton&&this.registerEventHandler(this.learnMoreButton.on("click",this.handleLearnMoreClick.bind(this)))},drawStorageGraph:function(){var e=t.config.flickr.account.photo_limit,e=.1<(e=this.profileModel.getValue("photoCount")/e||0)?[{durationProportion:.2,fillProportion:.001},{durationProportion:1,fillProportion:e,easeFunction:"easeInOutQuad"}]:[{durationProportion:.2,fillProportion:.001},{durationProportion:.65,fillProportion:.7,easeFunction:"easeOutQuad"},{durationProportion:1,fillProportion:e,easeFunction:"easeInOutQuad"}];new t.CircleFillGraph({containerElement:this.graphContainer.getDOMNode(),lineWidth:2,backgroundStrokeColor:"#e1e1e1",gradient:[{fillProportion:0,value:"5BF4FC"},{fillProportion:.3,value:"33b7ff"},{fillProportion:.7,value:"FF0084"},{fillProportion:1,value:"FF0084"}],duration:1.4,stops:e,segments:120}).start()},handleLearnMoreClick:function(e){t.fire("accountCard:overLimitLearnMoreClick"),t.fire("accountCard:close")}})},"@VERSION@",{requires:["hermes-template-user-account-card","circle-fill-graph","intl-number","handlebars-helpers","greetings-helper","subscriptions-helper","user-limits-helper"],langBundles:["common","account-menu","notifications","stats"]}),YUI.add("hermes-lang-account-menu",function(e,o){e.Intl.add("hermes/account-menu","en-US",{SPACE_USED:["Using ","${percentage}","% of ","${total}"],SPACE_USED_STYLEGUIDE:["${percentage}","% used of ","${total}"],SPACE_USED_UNLIMITED:["Using ","${used}"," of your unlimited storage"],PHOTO_COUNT_MANY:[{type:"number",valueName:"num"}," photos"],PHOTO_COUNT_ONE:["One photo"],PHOTO_COUNT_NONE:["No photos"],PHOTO_COUNT_1K:[{type:"number",valueName:"num"},"k photos"],ADDMORESPACE:["Add more space"],GOADFREE:["Go Ad Free"],GOPRO:["Go Pro"],GETPRO:["Get Pro"],RESUBSCRIBE_TO_PRO:["Re-subscribe to Pro"],GREETING_CAPTION_SPANISH:["Now you know how to greet people in Spanish"],GREETING_CAPTION_GERMAN:["Now you know how to greet people in German"],GREETING_CAPTION_AUSTRALIAN:["Now you know how to greet people in Australian"],GREETING_CAPTION_DUTCH:["Now you know how to greet people in Dutch"],GREETING_CAPTION_ENGLISH:["Now you know how to greet people in English"],GREETING_CAPTION_ARABIC:["Now you know how to greet people in Arabic"],GREETING_CAPTION_FRENCH:["Now you know how to greet people in French"],GREETING_CAPTION_ITALIAN:["Now you know how to greet people in Italian"],GREETING_CAPTION_SWEDISH:["Now you know how to greet people in Swedish"],GREETING_CAPTION_HAWAIIAN:["Now you know how to greet people in Hawaiian"],GREETING_CAPTION_TAGALOG:["Now you know how to greet people in Tagalog"],GREETING_CAPTION_HEBREW:["Now you know how to greet people in Hebrew"],GREETING_CAPTION_HINDI:["Now you know how to greet people in Hindi"],GREETING_CAPTION_MANDARIN:["Now you know how to greet people in Mandarin"],GREETING_CAPTION_PORTUGUESE:["Now you know how to greet people in Portuguese"],GREETING_CAPTION_ALBANIAN:["Now you know how to greet people in Albanian"],GREETING_CAPTION_ESTONIAN:["Now you know how to greet people in Estonian"],GREETING_CAPTION_GREEK:["Now you know how to greet people in Greek"],GREETING_CAPTION_HUNGARIAN:["Now you know how to greet people in Hungarian"],GREETING_CAPTION_LINGALA:["Now you know how to greet people in Lingala"],GREETING_CAPTION_SWAHILI:["Now you know how to greet people in Swahili"],GREETING_CAPTION_TSHILUBA:["Now you know how to greet people in Tshiluba"],GREETING_CAPTION_TURKISH:["Now you know how to greet people in Turkish"],GREETING_CAPTION_BURMESE:["Now you know how to greet people in Burmese"],GREETING_CAPTION_ICELANDIC:["Now you know how to greet people in Icelandic"],GREETING_CAPTION_ZULU:["Now you know how to greet people in Zulu"],GREETING_CAPTION_KOREAN:["Now you know how to greet people in Korean"],GREETING_CAPTION_IRISH:["Now you know how to greet people in Irish"],GREETING_CAPTION_LATVIAN:["Now you know how to greet people in Latvian"],GREETING_CAPTION_BASQUE:["Now you know how to greet people in Basque"],GREETING_CAPTION_BENGALI:["Now you know how to greet people in Bengali"],GREETING_CAPTION_BULGARIAN:["Now you know how to greet people in Bulgarian"],GREETING_CAPTION_CROATIAN:["Now you know how to greet people in Croatian"],GREETING_CAPTION_CZECH:["Now you know how to greet people in Czech"],GREETING_CAPTION_DANISH:["Now you know how to greet people in Danish"],GREETING_CAPTION_FINNISH:["Now you know how to greet people in Finnish"],GREETING_CAPTION_HOPI:["Now you know how to greet people in Hopi"],GREETING_CAPTION_INDONESIAN:["Now you know how to greet people in Indonesian"],GREETING_CAPTION_KANNADA:["Now you know how to greet people in Kannada"],GREETING_CAPTION_KURDISH:["Now you know how to greet people in Kurdish"],GREETING_CAPTION_LITHUANIAN:["Now you know how to greet people in Lithuanian"],GREETING_CAPTION_MALAYSIAN:["Now you know how to greet people in Malaysian"],GREETING_CAPTION_NORWEGIAN:["Now you know how to greet people in Norwegian"],GREETING_CAPTION_POLISH:["Now you know how to greet people in Polish"],GREETING_CAPTION_ROMANIAN:["Now you know how to greet people in Romanian"],GREETING_CAPTION_RUSSIAN:["Now you know how to greet people in Russian"],GREETING_CAPTION_SERBIAN:["Now you know how to greet people in Serbian"],GREETING_CAPTION_SLOVAKIAN:["Now you know how to greet people in Slovakian"],GREETING_CAPTION_UKRAINIAN:["Now you know how to greet people in Ukrainian"],GREETING_CAPTION_VIETNAMESE:["Now you know how to greet people in Vietnamese"],ITEM_COUNT_OF_LIMIT:["${count}"," of ","${limit}"," items"],GET_UNLIMITED_UPLOADS:["Get unlimited uploads"],UPLOAD_YOUR_PHOTOS:["Upload your photos"],ITEM_LIMIT_REACHED:["${limit}"," item limit reached!"],ITEM_LIMIT_EXCEEDED:["${limit}"," item limit exceeded!"]})},"@VERSION@",{requires:["intl"]}),YUI.add("account-menu-view",function(a,e){"use strict";require("hermes-core/flog")(e),a.namespace("Views")[this.name]=a.Base.create("account-menu-view",a.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this},loadState:function(){var n=this,e=[],o=this.appContext.getViewer();return o.signedIn?(n.set("user",{signedIn:!0,csrf:this.appContext.auth.csrf||""}),e.push(this.appContext.getModel("person-models",o.nsid).then(function(e){var o=e.toJSON();Object.keys(o.buddyicon||{}).forEach(function(e){o.buddyicon[e]||(o.buddyicon[e]=o.buddyicon.default)}),n.set("user",a.merge(n.get("user"),o))})),e.push(n.appContext.getModel("person-profile-models",o.nsid).then(function(e){var o=e.toJSON();o.unreadMessages=parseInt(o.unreadMessages,10),o.storageUsed=parseInt(o.storageUsed,10),o.storageTotal=parseInt(o.storageTotal,10),n.set("profileModel",e),n.set("user",a.merge(n.get("user"),o))})),a.Promise.all(e).then(function(){n.set("showOverLimitWarning",n.appContext.getCookie(a.config.flickr.upload_blocking.dismiss_over_upload_limit_message_cookie_name)&&a.UserLimitsHelper.isOverARRLimit(n.get("profileModel"),n.appContext))})):(n.set("user",{signedIn:!1}),a.Promise.resolve())},buildContainer:function(){return this.setContainerWithTemplate("account-menu",this.toJSON()),this},toJSON:function(){var e=a.merge(this.get("user")),o=this.appContext.lang;return 1<parseInt(e.photoCount,10)?e.pluralPhotos=!0:e.pluralPhotos=!1,parseInt(e.photoCount,10)<1&&(e.photoCount=!1),1e3<e.photoCount&&(e.photoCount=Math.round(e.photoCount/1e3),e.oneK=!0),e.isPro?e.storageTotalFormatted=e.storageTotal<0?"":a.Handlebars.helpers.friendlyDataSize(e.storageTotal):e.hasUnlimitedStorage?e.storageTotalFormatted="":e.has1TB?e.storageTotalFormatted="1TB":e.has2TB?e.storageTotalFormatted="2TB":e.storageTotalFormatted=e.storageTotal<0?"":a.Handlebars.helpers.friendlyDataSize(e.storageTotal),"vi-vn"===o.toLowerCase()&&(o="vn-VN"),e.storageUsedPercentage=Math.floor(1e3*e.storageUsed/e.storageTotal)/10||"0.0",e.storageUsedFormatted=a.Handlebars.helpers.friendlyDataSize(e.storageUsed),e.barWidth=Math.floor(e.storageUsedPercentage/100*293),e.unreadMessages=9999<e.unreadMessages?"9999+":e.unreadMessages,{user:e,helpLocaleKey:o.replace("-","_")||"en_US",flippers:this.appContext.flipper.toJSON(),showOverLimitWarning:this.get("showOverLimitWarning")}},activate:function(){a.on("notifications:openAccountMenuClicked",function(e){this.openUserAccountCard(!0)}.bind(this)),setTimeout(function(){this.get("container").on(["click","keydown"],function(e){"click"!==e.type&&13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this.openUserAccountCard())},this)}.bind(this),350)},openUserAccountCard:function(e){var o=this,n=this.get("container"),e=new a.Views["user-account-card-view"]({appContext:this.appContext,showHighlight:e});this.accountMenu=new a.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,preferTop:!0,width:300,height:"auto",autoSizeToContent:!0,anchorOffsetVertical:-6,anchorElement:n.one(".c-account-menu"),keyboardAnchorElement:n.one("a[aria-haspopup=true]"),subview:e,contentPadding:0,preventPageScrollOnScroll:!0,useDefaultKeyboardNavigation:!1,classList:"user-account-card-droparound",positionFixed:!0}),this.accountMenu.show(),a.on("accountCard:close",function(){o.accountMenu.close()})},closeMenu:function(e){e&&e.preventDefault(),this.accountMenuDialog&&this.accountMenuDialog.close()},destructor:function(){this.accountMenuDialog&&(this.accountMenuDialog.destroy(),this.accountMenuDialog=null)}})},"@VERSION@",{requires:["flickr-view","hermes-template-account-menu","hermes-template-account-menu-dialog-styleguide","hermes-template-account-menu-card","fluid-droparound-view","user-account-card-view"],optional:["person-models","person-profile-models"],langBundles:["account-menu","common","autosuggest"]});
