define(["require","exports","tslib","modules/clean/amp_web_logger","modules/clean/analytics","modules/core/browser","modules/core/browser_detection","modules/core/exception","modules/clean/auth/login/types"],(function(e,o,n,i,s,r,t,a,g){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.AppleUXAnalyticsLogger=o.GoogleUXAnalyticsLogger=o.EmailAuthUXAnalyticsLogger=o.AuthUXAnalyticsLogger=o.AuthAMPLogger=o.AuthType=void 0,r=n.__importStar(r),t=n.__importStar(t);var u;(function(e){e.CREDENTIALS="email",e.GOOGLE="google_auth",e.APPLE="apple_auth"})(u=o.AuthType||(o.AuthType={}));var l=new Set(["form_error","user_exists","access_denied","tfa_required","sso_required","emails_do_not_match_redirect"]),_=new Set(["enable_twofactor_required","emails_do_not_match","emails_do_not_match_redirect","not_verified","email_not_verified","google_login_not_allowed","access_denied","disabled_account","tos_required","sso_required","no_email_in_response","requires_password_on_first_link","apple_login_not_allowed","apple_login_not_allowed_for_teams","user_cancelled_authorize"]);function c(e){return{url:r.get_href(),status:e.status?e.status:void 0}}function p(e){return{url:r.get_href(),remember_me:e.remember_me?e.remember_me.toString():void 0,pair_user:e.pair_user?e.pair_user.toString():void 0,err_msg:e.err_msg?e.err_msg:void 0}}function d(e,o){return e&&o.has(e)?e:"unknown"}function f(){for(var e="other",o=0,n=[[t.chrome,"chrome"],[t.edge,"edge"],[t.mozilla,"firefox"],[t.msie,"msie"],[t.safari,"safari"]];o<n.length;o++){var i=n[o],s=i[0],r=i[1];if(s){e=r;break}}return e}function m(e,o,s){void 0===s&&(s=1);try{i.AMPWebLogger.logEventCount("web_auth",e,n.__assign(n.__assign({},o),{browser:f()}),s)}catch(i){a.reportException({err:i,severity:a.SEVERITY.NONCRITICAL,tags:["web_auth_amp_logging","acquisition_eng"],exc_extra:n.__assign({metricName:e},o)})}}function R(e,o){s.UXAnalyticsLogger.log(e,o)}o.AuthAMPLogger={logSignupIntent:function(){m("signup/intent",{},1)},logSignupAttempt:function(e){m("signup/attempt",{authType:e},1)},logSignupResponse:function(e,o,n){"funcaptcha_response"!==n?o?m("signup/success",{authType:e},1):(m("signup/success",{authType:e},0),m("signup/failure",{authType:e,error:d(n,l)},1)):m("signup/failure",{authType:e,error:n},1)},logLoginIntent:function(e){m("login/intent",{loginType:e||"normal"},1)},logLoginAttempt:function(e,o){m("login/attempt",{authType:e,loginType:o||"normal"},1)},logCredentialsLoginResponse:function(e,o){var n=u.CREDENTIALS,i=e||"normal";if("funcaptcha_response"!==o)if(o===g.LoginResponseStatus.OK||o===g.LoginResponseStatus.TWOFACTOR)m("login/success",{authType:n,loginType:i},1);else{var s=void 0;switch(o){case g.LoginResponseStatus.TOS_SIGNATURE_REQUIRED:s="tos_required";break;case g.LoginResponseStatus.SSO:s="sso_required";break;case g.LoginResponseStatus.TWOFACTOR_REQUIRED:s="enable_twofactor_required";break;case g.LoginResponseStatus.RATELIMIT:s="rate_limited";break;case g.LoginResponseStatus.EXPIRED:s="login_expired";break;case g.LoginResponseStatus.PASSWORD_EXPIRED:s="password_expired";break;case g.LoginResponseStatus.PASSWORD_DECRYPTION_ERROR:s="password_descryption_error";break;case g.LoginResponseStatus.ERROR:s="generic_error";break;case"form_error":s=o;break;default:s="unknown"}m("login/success",{authType:n,loginType:i},0),m("login/failure",{authType:n,loginType:i,error:s},1)}else m("login/failure",{authType:n,loginType:i,error:o},1)},logThirdPartyLoginResponse:function(e,o,n,i){var s=o||"normal";n||"tfa_required"===i?m("login/success",{authType:e,loginType:s},1):(m("login/success",{authType:e,loginType:s},0),m("login/failure",{authType:e,loginType:s,error:d(i,_)},1))},log2faResponse:function(e,o){var n=e||"normal";if(o===g.LoginResponseStatus.OK)m("2fa/success",{loginType:n},1);else{var i=void 0;switch(o){case g.LoginResponseStatus.REQUIRES_ROLE:i="requires_role";break;case g.LoginResponseStatus.EXPIRED:i="twofactor_expired";break;case g.LoginResponseStatus.INVALID_CREDENTIALS:i="invalid_credentials";break;case g.LoginResponseStatus.ERROR:i="generic_error";break;case"u2f_error":case"code_error":i=o;break;default:i="unknown"}m("2fa/success",{loginType:n},0),m("2fa/failure",{loginType:n,error:i},1)}}},o.AuthUXAnalyticsLogger={logSignupModalShown:function(e){R("signup_modal_shown",{url:r.get_href(),kind:e})},logLoginModalShown:function(e){R("login_modal_shown",{url:r.get_href(),kind:e})},logSignupModalDismissed:function(e){R("signup_modal_dismissed",{url:r.get_href(),kind:e})},logLoginModalDismissed:function(e){R("login_modal_dismissed",{url:r.get_href(),kind:e})}},o.EmailAuthUXAnalyticsLogger={logLoginStart:function(){R("email_login_start",{url:r.get_href()})},logSplitSignupContinue:function(){R("email_split_signup_continue",{url:r.get_href()})},logLoginResponse:function(e){switch(e.status){case g.LoginResponseStatus.OK:R("email_login_succeeded",c(e));break;case g.LoginResponseStatus.TWOFACTOR:R("email_login_requires_two_factor",c(e));break;case g.LoginResponseStatus.TWOFACTOR_REQUIRED:case g.LoginResponseStatus.TOS_SIGNATURE_REQUIRED:case g.LoginResponseStatus.EXPIRED:case g.LoginResponseStatus.SSO:R("email_login_redirect",c(e));break;default:R("email_login_failed",c(e))}},logLoginError:function(){R("email_login_failed",{url:r.get_href()})},logSignupStart:function(){R("email_signup_start",{url:r.get_href()})},logSignupResponse:function(){R("email_signup_succeeded",{url:r.get_href()})},logSignupError:function(){R("email_signup_failed",{url:r.get_href()})}},o.GoogleUXAnalyticsLogger={logLoginStart:function(){R("google_login_start",{url:r.get_href()})},logLoginResponse:function(e){e.success?R("google_login_succeeded",p(e)):"tfa_required"===e.err_msg?R("google_login_requires_two_factor",p(e)):R("google_login_failed",p(e))},logSignupStart:function(){R("google_signup_start",{url:r.get_href()})},logSignupResponse:function(e){e.success?R("google_signup_succeeded",p(e)):R("google_signup_failed",p(e))}},o.AppleUXAnalyticsLogger={logLoginStart:function(){R("sia_login_start",{url:r.get_href()})},logLoginResponse:function(e){e.success?R("sia_login_succeeded",p(e)):"tfa_required"===e.err_msg?R("sia_login_requires_two_factor",p(e)):"requires_password_on_first_link"===e.err_msg?R("sia_login_requires_password",p(e)):R("sia_login_failed",p(e))}}}));
//# sourceMappingURL=stats.min.js-vflvSKSTK.map