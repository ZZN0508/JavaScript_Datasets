var Validation=function(){var e={email:{check:function(i){return!i||t(i,"[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])")},msg:"Enter a valid e-mail address."},url:{check:function(i){return!i||t(i,"^https?://(.+.)+.{2,4}(/.*)?$")},msg:"Enter a valid URL."},required:{check:function(i){return!!i},msg:""}},t=function(i,t){return new RegExp(t,"").test(i)};return{addRule:function(i,t){e[i]=t},getRule:function(i){return e[i]}}},Form=function(i){var t=[];i.find("[validation]").each(function(){var i=$(this);void 0!==i.attr("validation")&&t.push(new Field(i))}),this.fields=t};Form.prototype={validate:function(){for(field in this.fields)this.fields[field].validate()},isValid:function(){for(field in this.fields)if(!this.fields[field].valid)return!1;return!0}};var Field=function(i){this.field=i,this.valid=!1,this.attach("change")};Field.prototype={attach:function(i){var t=this;"change"==i&&t.field.bind("change",function(){return t.validate()}),"keyup"==i&&t.field.bind("keyup",function(i){return t.validate()})},validate:function(){var i,t=this,e=t.field,a=$(document.createElement("ul")).addClass("errorlist"),n=e.attr("validation").split(" "),r=e.parent(),d=[];for(i in e.next(".errorlist").remove(),n){var l=$.Validation.getRule(n[i]);l.check(e.val())||(r.addClass("error"),d.push(l.msg))}if(d.length){for(error in t.field.unbind("keyup"),t.attach("keyup"),e.after(a.empty()),d)a.append("<li>"+d[error]+"</li>");t.valid=!1}else a.remove(),r.removeClass("error"),t.valid=!0}},$.extend($.fn,{validation:function(){var t=new Form($(this));$.data($(this)[0],"validator",t),$(this).bind("submit",function(i){t.validate(),t.isValid()||i.preventDefault()})},validate:function(){var i=$.data($(this)[0],"validator");return i.validate(),i.isValid()}}),$.Validation=new Validation;
