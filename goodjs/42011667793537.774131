YUI.add("group-card-view",function(i){i.namespace("Views")[this.name]=i.Base.create("group-card-view",i.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.groupId=e.groupId,this.groupPathAlias=e.groupPathAlias,this.set("isActiveViewAgnostic",e.isActiveViewAgnostic||!1),""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},subviewConfig:{"join-group-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,shortLabels:!0,theme:"light"}},loadState:function(){var t=this,e=this.groupId;return new i.FlickrPromise({groupPool:this.appContext.getModel("group-pool-models",e),group:this.appContext.getModel("group-models",e),groupInfo:this.appContext.getModel("group-info-models",e)}).then(function(e){return t.groupModel=e.group,t.groupInfo=e.groupInfo,e.groupPool.getValue("photoPageList").getPage({page:1,perPage:5}).then(function(e){t.groupPhotos=e})},function(e){t.loadingError=!0})},buildContainer:function(){var e,t,n=!1;return this.loadingError?this.setContainerHTML('<span class="error-group">'+this.intlMessage({intlName:"groups.ERROR_LOADING"})+"</span>"):(e=this.groupModel.toJSON(),(n="disabled"!==(t=this.groupInfo.getValue("throttle")).mode&&0<t.remaining||"none"===t.mode)&&(n=e.isMember),this.setContainerWithTemplate("group-card",{group:e,groupPool:this.groupPhotos.map(function(e){return e.toJSON()}),canAddPhotos:n,groupURLS:i.URLHelper.generateGroupUrls(this.groupModel),createdYear:e.dateCreated.year(),updatedAgo:this.intlMessage(i.Handlebars.helpers._friendlySinceDate(e.latestGroupActivity,!0,!0))})),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",function(e){e.preventDefault()},".join")),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-group-card","url-helper","handlebars-helpers"],langBundles:["groups","relative-dates"]}),YUI.add("group-menu-view",function(r){"use strict";r.namespace("Views")[this.name]=r.Base.create("group-menu-view",r.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.containerSelector=e.containerSelector,this.excludeSelectors=[".large",".no-menu"].concat(e.excludeSelectors||[]),this.groupSelector=".avatar.group",this.dialogCache=[],this.currentDialog,this},loadState:function(){return r.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(""),this},activate:function(){this.registerEventHandler(r.one(this.containerSelector).delegate("click",this.onClickTarget.bind(this),this.groupSelector,this))},onClickTarget:function(e){this.shouldProcessTarget(e.target)&&(e.preventDefault(),e.halt(),e=e.target,this.createParamsAndManageState(e))},shouldProcessTarget:function(t){return null!==t.ancestor()&&!this.excludeSelectors.some(function(e){return t.ancestor().one(e)||t.ancestor(e)})},createParamsAndManageState:function(e){var t=this.getParams(e);this.createDialog(t,e)},getParams:function(e){var t={appContext:this.appContext,isActiveViewAgnostic:!0};return t.groupId=e.getData("group-nsid"),t.signature=t.groupId,t},createDialog:function(t,e){var n,i=this;this.fire("open"),r.fire("groupMenuOpen",{anchorNode:e}),this.dialogCache.some(function(e){return e.key===t.signature&&(n=e.dialog,!0)}),n?n.set("anchorElement",e):((n=new r.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,width:350,height:165,observePageResize:!0,anchorElement:e,subview:new r.Views["group-card-view"](t)})).on("clickOverlay",function(e){i.nextElClicked=[e.clientX,e.clientY]}),n.on("closeDroparound",function(){setTimeout(function(){var t,e;i.nextElClicked&&((e=document.elementFromPoint(i.nextElClicked[0],i.nextElClicked[1]))&&(t=r.one(e),e=i.groupSelector.split(",").some(function(e){return t.hasClass(e.replace(".",""))}),t&&e&&i.shouldProcessTarget(t)&&i.createParamsAndManageState(t)),i.nextElClicked=null)},10)}),10<this.dialogCache.length&&this.dialogCache.shift(),this.dialogCache.push({key:t.signature,dialog:n})),n.on("closeDroparound",function(){r.fire("groupMenuClose",{anchorNode:e})}),(this.currentDialog=n).show()},closeDialog:function(){this.currentDialog&&this.currentDialog.close()},destructor:function(){var t=this;this.currentDialog=null,r.Object.each(this.dialogCache,function(e){t.dialogCache[e]&&(t.dialogCache[e].destroy(),t.dialogCache[e]=null)}),this.dialogCache=null}})},"@VERSION@",{requires:["flickr-promise","flickr-view","fluid-droparound-view","group-card-view"],langBundles:["common"]}),YUI.add("hermes-template-partner-account-banner",function(n,e){var i=n.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,r){return'<div class="banner-container">\n\t<p>Dear Flickr Member: due to partnership changes with AT&T, you need to update your primary email address. <a class="learn-more">Learn more</a></p>\n</div>\n'},useData:!0}),r={};n.Array.each([],function(e){var t=n.Template.get("hermes/"+e);t&&(r[e]=t)}),n.Template.register("hermes/partner-account-banner",function(e,t){return(t=t||{}).partials=t.partials?n.merge(r,t.partials):r,i(e,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]}),YUI.add("hermes-template-partner-account-modal",function(n,e){var i=n.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,r){return'<div>\n\tWith the launch of the new att.net homepage on June 30, 2017, you will need to change the primary email address you use to sign into your Flickr/Yahoo account. Your data and photos on Flickr will not be deleted or modified in any way. You will need to complete this process before June 30, 2017 in order to continue accessing your Flickr account.\n\t<br/><br/>\n\t<a href="/partner-account">Click here to learn more about these changes.</a>\n\t<br/><br/>\n\t<a href="/account/transfer">\n\t\t<button class="update-email">Update your email address</button>\n\t</a>\n</div>\n'},useData:!0}),r={};n.Array.each([],function(e){var t=n.Template.get("hermes/"+e);t&&(r[e]=t)}),n.Template.register("hermes/partner-account-modal",function(e,t){return(t=t||{}).partials=t.partials?n.merge(r,t.partials):r,i(e,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]}),YUI.add("partner-account-banner-view",function(t,n){t.FlickrView.create(this.name,t.FlickrView,[],{buildContainer:function(){return this.setContainerWithTemplate("partner-account-banner"),this},activate:function(){var e=this.get("container").one(".learn-more");return e&&this.registerEventHandler(e.on("click",this.openModal.bind(this))),t.AnchorRepositioner.addOffset(n,this.get("container")),this},openModal:function(){new t.Views.FluidModal({title:"The way you sign in to Flickr is changing",htmlMessage:this.templates("partner-account-modal")({}),appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showCancelX:!0,showCancelButton:!1,showActionButton:!1,hideModalOverlay:!1,showFooter:!1}).show()},destructor:function(){t.AnchorRepositioner.removeOffset(n)}})},"@VERSION@",{requires:["flickr-view","hermes-template-partner-account-banner","hermes-template-partner-account-modal"]}),YUI.add("hermes-template-featured-toast",function(n,e){var i=n.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,r){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="featured-toast">\n\t'+e.escapeExpression((a(n,"renderTrustedMarkup")||t&&a(t,"renderTrustedMarkup")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?a(t,"htmlContent"):t,{name:"renderTrustedMarkup",hash:{},data:r,loc:{start:{line:2,column:1},end:{line:2,column:36}}}))+"\n</div>\n"},useData:!0}),r={};n.Array.each([],function(e){var t=n.Template.get("hermes/"+e);t&&(r[e]=t)}),n.Template.register("hermes/featured-toast",function(e,t){return(t=t||{}).partials=t.partials?n.merge(r,t.partials):r,i(e,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]}),YUI.add("featured-toast-view",function(n){n.FlickrView.create(this.name,n.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){this.params=e,this.config=e.featuredToastConfig||{},this.config.id=this.config.id||"",this.config.htmlContent=this.config.htmlContent||"",this.config.showOnActivate=void 0!==this.config.showOnActivate&&this.config.showOnActivate,this.config.classList=this.config.classList||[]},loadState:function(){return n.Promise.resolve()},buildContainer:function(){this.setContainerWithTemplate("featured-toast",{htmlContent:this.config.htmlContent,classList:this.config.classList})},activate:function(){var e=this,t=this.get("container");return this.contentContainer=t.one(".featured-toast"),this.initialClasses=Array.prototype.slice.call(this.contentContainer.getDOMNode().classList),this.updateClasses(),this.setupEvents(),this.config.showOnActivate&&setTimeout(function(){e.show()},0),setTimeout(function(){e.applyBannerOffset()},100),this.registerEventHandler(n.on("resize",n.betterThrottle(this.applyBannerOffset.bind(this),500,this,!0))),this.fire("activated"),this},show:function(){this.get("container").addClass("activated")},dismiss:function(){var e=this.get("container");e.setStyle("bottom",null),e.removeClass("activated")},handlePrimaryActionClick:function(e){e.preventDefault(),e.stopPropagation(),this.fire("primaryActionClicked",{clickEvent:e})},handleSecondaryActionClick:function(e){e.preventDefault(),e.stopPropagation(),this.fire("secondaryActionClicked",{clickEvent:e})},applyBannerOffset:function(){var e=n.one(".footer-banner-view .footer-container");e&&(e=e.get("clientHeight"),this.get("container").setStyle("bottom",e))},setup:function(e){this.config.htmlContent=e.htmlContent||"",this.config.classList=e.classList||[],this.contentContainer.set("innerHTML",this.config.htmlContent),this.updateClasses(),this.setupEvents()},updateClasses:function(){var t=this;this.contentContainer.set("className",""),this.initialClasses.forEach(function(e){t.contentContainer.addClass(e)}),this.config.classList.forEach(function(e){t.contentContainer.addClass(e)})},setupEvents:function(){var e=this.get("container"),t=e.one(".primary-action"),e=e.one(".secondary-action");t&&t.on("click",this.handlePrimaryActionClick.bind(this)),e&&e.on("click",this.handleSecondaryActionClick.bind(this))}})},"@VERSION@",{requires:["flickr-view","hermes-template-featured-toast"]}),YUI.add("user-limits-helper",function(e){var n=e.config.flickr.account.photo_limit,i=e.config.flickr.account.near_photo_limit;e.UserLimitsHelper={isNearUploadLimit:function(e,t){return t.getViewer().signedIn&&!t.getViewer().isPro&&e.getValue("photoCount")>=i&&e.getValue("photoCount")<n},isAtUploadLimit:function(e,t){return t.getViewer().signedIn&&!t.getViewer().isPro&&e.getValue("photoCount")===n},isOverUploadLimit:function(e,t){return t.getViewer().signedIn&&!t.getViewer().isPro&&e.getValue("photoCount")>n},isOverARRLimit:function(e,t){return t.getViewer().signedIn&&!t.getViewer().isPro&&this.getARRCount(e)>n},hasReachedNearUploadLimit:function(e,t){return this.isNearUploadLimit(e,t)||this.isAtUploadLimit(e,t)||this.isOverUploadLimit(e,t)},hasReachedUploadLimit:function(e,t){return this.isAtUploadLimit(e,t)||this.isOverUploadLimit(e,t)},remainingAvailableUploads:function(e,t){return t.getValue("uploadLimit")-e.getValue("photoCount")},getARRCount:function(e){var t=e.getValue("arrPhotoCount");return 0<=t?t:e.getValue("photoCount")}}},"@VERSION@",{requires:[]});
