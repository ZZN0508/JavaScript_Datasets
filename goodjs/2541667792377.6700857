YUI.add("event-custom-base",function(y,t){y.Env.evt={handles:{},plugins:{}};var h={objs:null,before:function(t,e,i,n){var s,r=t;return n&&(s=[t,n].concat(y.Array(arguments,4,!0)),r=y.rbind.apply(y,s)),this._inject(0,r,e,i)},after:function(t,e,i,n){var s,r=t;return n&&(s=[t,n].concat(y.Array(arguments,4,!0)),r=y.rbind.apply(y,s)),this._inject(1,r,e,i)},_inject:function(t,e,i,n){var s,r=y.stamp(i);return i._yuiaop||(i._yuiaop={}),(s=i._yuiaop)[n]||(s[n]=new y.Do.Method(i,n),i[n]=function(){return s[n].exec.apply(s[n],arguments)}),r=r+y.stamp(e)+n,s[n].register(r,e,t),new y.EventHandle(s[n],r)},detach:function(t){t.detach&&t.detach()}};(y.Do=h).Method=function(t,e){this.obj=t,this.methodName=e,this.method=t[e],this.before={},this.after={}},h.Method.prototype.register=function(t,e,i){i?this.after[t]=e:this.before[t]=e},h.Method.prototype._delete=function(t){delete this.before[t],delete this.after[t]},h.Method.prototype.exec=function(){var t,e,i,n=y.Array(arguments,0,!0),s=this.before,r=this.after,o=!1;for(t in s)if(s.hasOwnProperty(t)&&(e=s[t].apply(this.obj,n)))switch(e.constructor){case h.Halt:return e.retVal;case h.AlterArgs:n=e.newArgs;break;case h.Prevent:o=!0}for(t in o||(e=this.method.apply(this.obj,n)),h.originalRetVal=e,h.currentRetVal=e,r)if(r.hasOwnProperty(t)){if((i=r[t].apply(this.obj,n))&&i.constructor===h.Halt)return i.retVal;i&&i.constructor===h.AlterReturn&&(e=i.newRetVal,h.currentRetVal=e)}return e},h.AlterArgs=function(t,e){this.msg=t,this.newArgs=e},h.AlterReturn=function(t,e){this.msg=t,this.newRetVal=e},h.Halt=function(t,e){this.msg=t,this.retVal=e},h.Prevent=function(t){this.msg=t},h.Error=h.Halt;function a(t,e,i){for(var n in e)!o[n]||!i&&n in t||(t[n]=e[n]);return t}var s=y.Array,r="after",o=s.hash(["broadcast","monitored","bubbles","context","contextFn","currentTarget","defaultFn","defaultTargetOnly","details","emitFacade","fireOnce","async","host","preventable","preventedFn","queuable","silent","stoppedFn","target","type"]),_=Array.prototype.slice;y.CustomEvent=function(t,e){this._kds=y.CustomEvent.keepDeprecatedSubs,this.id=y.guid(),this.type=t,this.silent=this.logSystem="yui:log"===t,this._kds&&(this.subscribers={},this.afters={}),e&&a(this,e,!0)},y.CustomEvent.keepDeprecatedSubs=!1,y.CustomEvent.mixConfigs=a,y.CustomEvent.prototype={constructor:y.CustomEvent,signature:9,context:y,preventable:!0,bubbles:!0,hasSubs:function(t){var e=0,i=0,n=this._subscribers,s=this._afters,r=this.sibling;return n&&(e=n.length),s&&(i=s.length),r&&(n=r._subscribers,s=r._afters,n&&(e+=n.length),s&&(i+=s.length)),t?"after"===t?i:e:e+i},monitor:function(t){this.monitored=!0;var e=this.id+"|"+this.type+"_"+t,i=_.call(arguments,0);return i[0]=e,this.host.on.apply(this.host,i)},getSubs:function(){var t,e,i=this.sibling,n=this._subscribers,s=this._afters;return i&&(t=i._subscribers,e=i._afters),[n=t?n?n.concat(t):t.concat():n?n.concat():[],s=e?s?s.concat(e):e.concat():s?s.concat():[]]},applyConfig:function(t,e){a(this,t,e)},_on:function(t,e,i,n){e=new y.Subscriber(t,e,i,n);return this.fireOnce&&this.fired&&(i=this.firedWith,this.emitFacade&&this._addFacadeToArgs&&this._addFacadeToArgs(i),this.async?setTimeout(y.bind(this._notify,this,e,i),0):this._notify(e,i)),n===r?(this._afters||(this._afters=[]),this._afters.push(e)):(this._subscribers||(this._subscribers=[]),this._subscribers.push(e)),this._kds&&(n===r?this.afters[e.id]=e:this.subscribers[e.id]=e),new y.EventHandle(this,e)},subscribe:function(t,e){var i=2<arguments.length?_.call(arguments,2):null;return this._on(t,e,i,!0)},on:function(t,e){var i=2<arguments.length?_.call(arguments,2):null;return this.monitored&&this.host&&this.host._monitor("attach",this,{args:arguments}),this._on(t,e,i,!0)},after:function(t,e){var i=2<arguments.length?_.call(arguments,2):null;return this._on(t,e,i,r)},detach:function(t,e){if(t&&t.detach)return t.detach();var i,n,s=0,r=this._subscribers,o=this._afters;if(r)for(i=r.length;0<=i;i--)!(n=r[i])||t&&t!==n.fn||(this._delete(n,r,i),s++);if(o)for(i=o.length;0<=i;i--)!(n=o[i])||t&&t!==n.fn||(this._delete(n,o,i),s++);return s},unsubscribe:function(){return this.detach.apply(this,arguments)},_notify:function(t,e,i){return!(!1===t.notify(e,this)||1<this.stopped)},log:function(t,e){},fire:function(){var t=[];return t.push.apply(t,arguments),this._fire(t)},_fire:function(t){return!(!this.fireOnce||!this.fired)||(this.fired=!0,this.fireOnce&&(this.firedWith=t),this.emitFacade?this.fireComplex(t):this.fireSimple(t))},fireSimple:function(t){var e;return this.stopped=0,this.prevented=0,this.hasSubs()&&(e=this.getSubs(),this._procSubs(e[0],t),this._procSubs(e[1],t)),this.broadcast&&this._broadcast(t),!this.stopped},fireComplex:function(t){return t[0]=t[0]||{},this.fireSimple(t)},_procSubs:function(t,e,i){for(var n,s=0,r=t.length;s<r;s++)if((n=t[s])&&n.fn&&(!1===this._notify(n,e,i)&&(this.stopped=2),2===this.stopped))return!1;return!0},_broadcast:function(t){!this.stopped&&this.broadcast&&((t=t.concat()).unshift(this.type),this.host!==y&&y.fire.apply(y,t),2===this.broadcast&&y.Global.fire.apply(y.Global,t))},unsubscribeAll:function(){return this.detachAll.apply(this,arguments)},detachAll:function(){return this.detach()},_delete:function(t,e,i){var n=t._when;(e=e||(n===r?this._afters:this._subscribers))&&(i=s.indexOf(e,t,0),t&&e[i]===t&&e.splice(i,1)),this._kds&&(n===r?delete this.afters[t.id]:delete this.subscribers[t.id]),this.monitored&&this.host&&this.host._monitor("detach",this,{ce:this,sub:t}),t&&(t.deleted=!0)}},y.Subscriber=function(t,e,i,n){this.fn=t,this.context=e,this.id=y.guid(),this.args=i,this._when=n},y.Subscriber.prototype={constructor:y.Subscriber,_notify:function(t,e,i){if(this.deleted&&!this.postponed){if(!this.postponed)return delete this.postponed,null;delete this.fn,delete this.context}var n,s=this.args;switch(i.signature){case 0:n=this.fn.call(t,i.type,e,t);break;case 1:n=this.fn.call(t,e[0]||null,t);break;default:n=s||e?(e=e||[],s=s?e.concat(s):e,this.fn.apply(t,s)):this.fn.call(t)}return this.once&&i._delete(this),n},notify:function(t,e){var i=!0,n=(n=this.context)||(e.contextFn?e.contextFn():e.context);if(y.config&&y.config.throwFail)i=this._notify(n,t,e);else try{i=this._notify(n,t,e)}catch(t){y.error(this+" failed: "+t.message,t)}return i},contains:function(t,e){return e?this.fn===t&&this.context===e:this.fn===t},valueOf:function(){return this.id}},y.EventHandle=function(t,e){this.evt=t,this.sub=e},y.EventHandle.prototype={batch:function(e,i){e.call(i||this,this),y.Lang.isArray(this.evt)&&y.Array.each(this.evt,function(t){t.batch.call(i||t,e)})},detach:function(){var t,e=this.evt,i=0;if(e)if(y.Lang.isArray(e))for(t=0;t<e.length;t++)i+=e[t].detach();else e._delete(this.sub),i=1;return i},monitor:function(t){return this.evt.monitor.apply(this.evt,arguments)}};function c(t,e){return!e||!t||-1<t.indexOf(n)?t:e+n+t}function e(t){var e=this._yuievt,i=(e=e||(this._yuievt={events:{},targets:null,config:{host:this,context:this},chain:y.config.chain})).config;t&&(a(i,t,!0),void 0!==t.chain&&(e.chain=t.chain),t.prefix&&(i.prefix=t.prefix))}var m=y.Lang,n=":",E="~AFTER~",i=/(.*?)(:)(.*?)/,u=y.cached(function(t){return t.replace(i,"*$2$3")}),x=y.cached(function(t,e){var i,n,s=t;return m.isString(s)?(-1<(t=s.indexOf(E))&&(n=!0,s=s.substr(E.length)),-1<(t=s.indexOf("|"))&&(i=s.substr(0,t),"*"===(s=s.substr(t+1))&&(s=null)),[i,e?c(s,e):s,n,s]):s});e.prototype={constructor:e,once:function(){var t=this.on.apply(this,arguments);return t.batch(function(t){t.sub&&(t.sub.once=!0)}),t},onceAfter:function(){var t=this.after.apply(this,arguments);return t.batch(function(t){t.sub&&(t.sub.once=!0)}),t},parseType:function(t,e){return x(t,e||this._yuievt.config.prefix)},on:function(t,e,i){var n,s,r,o,h,a,c,u,f,l,p,d=this._yuievt,b=x(t,d.config.prefix),v=y.Env.evt.handles,g=y.Node;return this._monitor("attach",b[1],{args:arguments,category:b[0],after:b[2]}),m.isObject(t)?m.isFunction(t)?y.Do.before.apply(y.Do,arguments):(n=e,s=i,r=_.call(arguments,0),o=[],m.isArray(t)&&(p=!0),c=t._after,delete t._after,y.each(t,function(t,e){m.isObject(t)&&(n=t.fn||(m.isFunction(t)?t:n),s=t.context||s);var i=c?E:"";r[0]=i+(p?t:e),r[1]=n,r[2]=s,o.push(this.on.apply(this,r))},this),d.chain?this:new y.EventHandle(o)):(h=b[0],c=b[2],f=b[3],g&&y.instanceOf(this,g)&&f in g.DOM_EVENTS?((r=_.call(arguments,0)).splice(2,0,g.getDOMNode(this)),y.on.apply(y,r)):(t=b[1],y.instanceOf(this,YUI)&&(u=y.Env.evt.plugins[t],(r=_.call(arguments,0))[0]=f,g&&(b=r[2],y.instanceOf(b,y.NodeList)?b=y.NodeList.getDOMNodes(b):y.instanceOf(b,g)&&(b=g.getDOMNode(b)),(l=f in g.DOM_EVENTS)&&(r[2]=b)),u?a=u.on.apply(y,r):t&&!l||(a=y.Event._attach(r))),a||(a=(d.events[t]||this.publish(t))._on(e,i,3<arguments.length?_.call(arguments,3):null,!c||"after"),-1!==t.indexOf("*:")&&(this._hasSiblings=!0)),h&&(v[h]=v[h]||{},v[h][t]=v[h][t]||[],v[h][t].push(a)),d.chain?this:a))},subscribe:function(){return this.on.apply(this,arguments)},detach:function(t,e,i){var n,s=this._yuievt.events,r=y.Node,o=r&&y.instanceOf(this,r);if(!t&&this!==y){for(n in s)s.hasOwnProperty(n)&&s[n].detach(e,i);return o&&y.Event.purgeElement(r.getDOMNode(this)),this}function h(t,e,i){var n,s,r=t[e];if(r)for(s=r.length-1;0<=s;--s)(n=r[s].evt).host!==i&&n.el!==i||r[s].detach()}var a,c,u,f=x(t,this._yuievt.config.prefix),l=m.isArray(f)?f[0]:null,p=f?f[3]:null,d=y.Env.evt.handles;if(l){if(c=d[l],t=f[1],a=o?y.Node.getDOMNode(this):this,c){if(t)h(c,t,a);else for(n in c)c.hasOwnProperty(n)&&h(c,n,a);return this}}else{if(m.isObject(t)&&t.detach)return t.detach(),this;if(o&&(!p||p in r.DOM_EVENTS))return(u=_.call(arguments,0))[2]=r.getDOMNode(this),y.detach.apply(y,u),this}if(p=y.Env.evt.plugins[p],y.instanceOf(this,YUI)){if(u=_.call(arguments,0),p&&p.detach)return p.detach.apply(y,u),this;if(!t||!p&&r&&t in r.DOM_EVENTS)return u[0]=t,y.Event.detach.apply(y.Event,u),this}return(f=s[f[1]])&&f.detach(e,i),this},unsubscribe:function(){return this.detach.apply(this,arguments)},detachAll:function(t){return this.detach(t)},unsubscribeAll:function(){return this.detachAll.apply(this,arguments)},publish:function(t,i){var n,s=this._yuievt.config,r=s.prefix;return"string"==typeof t?(r&&(t=c(t,r)),n=this._publish(t,s,i)):(n={},y.each(t,function(t,e){r&&(e=c(e,r)),n[e]=this._publish(e,s,t||i)},this)),n},_getFullType:function(t){var e=this._yuievt.config.prefix;return e?e+n+t:t},_publish:function(t,e,i){var n=this._yuievt,s=n.config,r=s.host,o=s.context,h=n.events,n=h[t];return(s.monitored&&!n||n&&n.monitored)&&this._monitor("publish",t,{args:arguments}),n||(n=h[t]=new y.CustomEvent(t,e),e||(n.host=r,n.context=o)),i&&a(n,i,!0),n},_monitor:function(t,e,i){var n,s;e&&("string"==typeof e?n=this.getEvent(s=e,!0):s=(n=e).type,(this._yuievt.config.monitored&&(!n||n.monitored)||n&&n.monitored)&&(s=s+"_"+t,i.monitored=t,this.fire.call(this,s,i)))},fire:function(t){var e,i,n="string"==typeof t,s=arguments.length,r=t,o=this._yuievt,h=o.config,a=h.prefix,s=n&&s<=3?2===s?[arguments[1]]:3===s?[arguments[1],arguments[2]]:[]:_.call(arguments,n?1:0);if(n||(r=t&&t.type),a&&(r=c(r,a)),a=o.events[r],this._hasSiblings&&((i=this.getSibling(r,a))&&!a&&(a=this.publish(r))),(h.monitored&&(!a||a.monitored)||a&&a.monitored)&&this._monitor("fire",a||r,{args:s}),a)i&&(a.sibling=i),e=a._fire(s);else{if(o.hasTargets)return this.bubble({type:r},s,this);e=!0}return o.chain?this:e},getSibling:function(t,e){var i;return-1<t.indexOf(n)&&(t=u(t),(i=this.getEvent(t,!0))&&(i.applyConfig(e),i.bubbles=!1,i.broadcast=0)),i},getEvent:function(t,e){return e||(t=(e=this._yuievt.config.prefix)?c(t,e):t),this._yuievt.events[t]||null},after:function(t,e){var i=_.call(arguments,0);switch(m.type(t)){case"function":return y.Do.after.apply(y.Do,arguments);case"array":case"object":i[0]._after=!0;break;default:i[0]=E+t}return this.on.apply(this,i)},before:function(){return this.on.apply(this,arguments)}},y.EventTarget=e,y.mix(y,e.prototype),e.call(y,{bubbles:!1}),YUI.Env.globalEvents=YUI.Env.globalEvents||new e,y.Global=YUI.Env.globalEvents},"3.12.0",{requires:["oop"]});
