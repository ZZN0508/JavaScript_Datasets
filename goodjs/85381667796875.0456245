var Woo;void 0===Woo&&(Woo={},(Woo=new function(){if(arguments.callee._singletonInstance)return arguments.callee._singletonInstance;arguments.callee._singletonInstance=this;var s,r,n,t,e,a={logging:"https://{host}/plugins/log",plugin:{classes:["woobox-offer"],options:{},frames:{offer:{src:"https://{host}/{pidRaw}{subSegment}{params}",width:"1px",height:"determine","min-width":"100%","max-width":"determine",defaultCSS:{width:"1px","min-width":"100%",border:"none",WebkitBorderRadius:"3px",MozBorderRadius:"3px",OBorderRadius:"3px",borderRadius:"3px",WebkitTransition:"height 0.2s ease-out",MozTransition:"height 0.2s ease-out",OTransition:"height 0.2s ease-out",transition:"height 0.2s ease-out"},eventHandlers:{}}},classIDMap:{"woobox-offer":"data-offer"},classParamsMap:{"woobox-offer":"data-params"},classParamsValid:["source","from","sms","view","for","chk"],classOptionMap:{"woobox-offer":[]},classFrameMap:{"woobox-offer":["offer"]},classCSSMap:{"woobox-offer":{width:"100%"},"woobox-offer-wrap":{width:"100%",maxWidth:"810px"},overlay:{background:"#000",opacity:80}},defaultCSS:{border:"none"},defaultCSSLink:"https://{host}/css/plugins/{class}.css"},errors:{}},p=Boolean(window.postMessage),l=Boolean(window.addEventListener),f=(function(){for(var t=3,e=document.createElement("div"),o=e.all||[];e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><br><![endif]--\x3e",o[0];);}(),{}),d={},c=document.getElementById("woobox-sdk").getAttribute("src");function h(t,e){var o,i=t;for(o in s&&(i=i.replace("{host}",s)),e)i=i.replace("{"+o+"}",e[o]);return i}function u(t){if(p){if(t.origin!="https://"+s)return!1;var e={};try{return(e=JSON.parse(t.data)).pid&&void 0!==f[e.pid]?f[e.pid].receiveMessage(t,e):!1}catch(t){return!1}}return!1}function m(t,e,o,i){if(p){e={t:n,k:r,pid:e};return function t(e,o){for(var i in o)"object"!=typeof o[i]?e[i]=o[i]:(void 0===e[i]&&(e[i]=o[i]),t(e[i],o[i]))}(e,o),i=i||"https://"+s,t.postMessage(JSON.stringify(e),i),!0}return!1}function o(t){if(void 0!==t.frames&&t.frames.offer,void 0===t.consts)return!1;if(void 0!==t.consts.defaultCSS)for(var e in t.consts.defaultCSS)t.el.style[e]=t.consts.defaultCSS[e];if(t.type&&void 0!==t.consts.classCSSMap[t.type])for(var e in t.consts.classCSSMap[t.type])t.el.style[e]=t.consts.classCSSMap[t.type][e];var o="frame"===t.constructor.name?t.parent:t,o=o.hasOwnProperty("opts")&&o.opts.hasOwnProperty("style")&&"popup"===o.opts.style;for(e in"frame"===t.constructor.name&&o&&m(t.el.contentWindow,t.parent.pid,{addBodyClass:"popup"}),void 0!==t.css&&void 0===t.css.height?(t.css.height="600",t.css.overflow="scroll",o||t.el.setAttribute("scrolling","yes")):o||t.el.setAttribute("scrolling","no"),{width:!0,height:!0,"max-width":!0})void 0!==t.consts[e]&&void 0!==t.css[e]&&(0<t.consts[e].indexOf("%")?t.el.style[e]=t.css[e]:t.el.style[e]=t.css[e]+"px");return"undefined"!=typeof WooControl&&window.setTimeout(function(){WooControl.setHeight()},10),!0}function g(){!function(){for(var t=document.querySelectorAll("script[data-offer]"),e=0;e<t.length;e++){var o,i=t[e];i.attributes;i.getAttribute("data-offer")&&((o=document.createElement("div")).setAttribute("class","woobox-offer"),o.setAttribute("data-offer",i.getAttribute("data-offer")),i.getAttribute("data-style")&&o.setAttribute("data-style",i.getAttribute("data-style")),i.getAttribute("data-trigger")&&o.setAttribute("data-trigger",i.getAttribute("data-trigger")),i.getAttribute("data-expire")&&o.setAttribute("data-expire",i.getAttribute("data-expire")),i.parentNode.insertBefore(o,i.nextSibling))}}();for(var t=["div"],e=0;e<t.length;e++){for(var o=document.getElementsByTagName(t[e]),i=!1,s=0;s<o.length;s++)for(var r=0;r<a.plugin.classes.length;r++)if(o[s].className==a.plugin.classes[r]){if(0<o[s].getElementsByTagName("iframe").length)continue;var n=new y(o[s],a.plugin.classes[r]);(f[n.pid]=n).init(),i=!0}if(i)break}i||console.error("Matching Woobox offer tag not found")}function v(t){var e=document.getElementsByClassName(t+"_offer")[0].getBoundingClientRect(),o=document.body,i=document.documentElement,t=window.pageYOffset||i.scrollTop||o.scrollTop,o=i.clientTop||o.clientTop||0,e=e.top+t-o,o=window.innerHeight+t;((e=Math.round(e))<t||o<e)&&w(e,!1)}function w(t,e){t={top:t,left:0};e&&(t.behavior="smooth"),window.scroll(t)}function x(t,e){var o,i=function(t){var e,o=0,i={},s=t.split("&");if(s.length){for(var r=0;r<s.length;r++)1<(e=s[r].split("=")).length&&(o++,i[e[0]]=e[1]);if(o)return i}return!1}(window.location.hash.substring(1)),s={};for(o in i)-1<t.indexOf(o)&&(s[o]=i[o]);for(o in e)-1<t.indexOf(o)&&(s[o]=e[o]);return s}function b(t,e){this.inited=!1,this.parent=t,this.fid=e,this.el=document.createElement("iframe"),this.consts=a.plugin.frames[this.fid],this.el.setAttribute("id",this.parent.pid+"_"+this.fid),this.el.setAttribute("title","Woobox Campaign"),"popup"!==t.opts.style&&this.el.setAttribute("scrolling","no"),this.el.className=this.parent.pid+"_"+this.fid,this.css={},this.over=!1,this.clicked=!1,this.previousTopOffset=null,this.previousHeight=null}function y(t,e){this.inited=!1,this.layout_width=null,this.consts=a.plugin,this.type=e,this.el=t,this.el.style.visibility="hidden",this.pid=this.pidRaw=this.el.getAttribute(this.consts.classIDMap[this.type]),void 0===d[this.pid]?d[this.pid]=0:d[this.pid]++,this.pid=this.pid+"_"+d[this.pid],this.firstLoad=!0,this.el.id=this.pid;t=this.el.getAttribute(this.consts.classParamsMap[this.type])||"{}";if(this.params=JSON.parse(t.replace(/'/g,'"')),this.opts={},this.frames={},this.loading=!1,this.ignoreHeightMessagesFromIframe=!1,this.cssLink=null,this.consts.classFrameMap[this.type].length)for(var o=0;o<this.consts.classFrameMap.length;o++)this.frames[this.consts.classFrameMap[o]]=new b(this,this.consts.classFrameMap[o])}document.getElementById("woobox-sdk-styles")||(t=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style"),t.appendChild(e),e.id="woobox-sdk-styles",e.type="text/css",e.appendChild(document.createTextNode(".woobox-modal-global-overflow-hidden, .woobox-modal-global-overflow-hidden * { overflow: hidden; } .woobox-offer, .woobox-offer-wrap, .woobox-offer-wrap > iframe { } "))),this.selfDestruct=function(){this.frames.forEach(function(t){t.destroy()})},this.box=function(t,e,o){if("undefined"!=typeof WooControl&&WooControl.preventEmbeds)return!1;s=o||((o=document.createElement("a")).setAttribute("href",c),o.hostname.replace("cdn.","")),n=t,r=e,l?window.addEventListener("message",u,!1):window.attachEvent("onmessage",u),"complete"===document.readyState||"loaded"===document.readyState||"interactive"===document.readyState?g():l?document.addEventListener("DOMContentLoaded",g,!1):document.attachEvent("onreadystatechange",g)},b.prototype.destroy=function(){this.el.remove()},b.prototype.init=function(){if(void 0!==this.parent.pid){var t,e=this,o="",i=x(this.parent.consts.classParamsValid,this.parent.el.getAttribute("data-params"));for(t in i.embed=1,i.plugin=encodeURIComponent(JSON.stringify({pid:this.parent.pid,fid:this.fid})),this.parent.params)i[t]=this.parent.params[t];"offer"===this.fid&&(i.view?(o+="/"+i.view,delete i.view):i.url&&(o+="/"+i.url,delete i.url),i.from?(o+="/"+i.from,delete i.from):i.for&&(o+="/"+i.for,delete i.for)),o=h(this.consts.src,{pidRaw:this.parent.pidRaw,subSegment:o,params:function(t){var e,o=[];for(e in t)t.hasOwnProperty(e)&&o.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return o.length?"?"+o.join("&"):""}(i)}),this.el.setAttribute("src",o);var s,o=document.createElement("div");for(s in o.className="woobox-offer-wrap",o.appendChild(this.el),this.parent.el_wrap=o,this.parent.el.appendChild(o),{width:!0,height:!0,"max-width":!0})"determine"!=this.consts[s]&&(this.css[s]=this.consts[s]);this.setCSS(),e.el;o=function(t){this.consts&&void 0!==this.consts.eventHandlers.mouseover&&e.consts.eventHandlers.mousemove(t,e)};l?this.el.addEventListener("mousemove",o,!1):this.el.attachEvent("onmousemove",o);o=function(t){e.over=!0,void 0!==e.consts.eventHandlers.mouseover&&e.consts.eventHandlers.mouseover(t,e)};l?this.el.addEventListener("mouseover",o,!1):this.el.attachEvent("onmouseover",o);o=function(t){e.over=!1,void 0!==e.consts.eventHandlers.mouseout&&e.consts.eventHandlers.mouseout(t,e)};l?this.el.addEventListener("mouseout",o,!1):this.el.attachEvent("onmouseout",o),this.inited=!0}},b.prototype.setCSS=function(){return o(this)},b.prototype.reload=function(){this.loaded=!1,this.el.setAttribute("src",this.el.src)},y.prototype.sendData=function(t,e,o){return m(t.source,this.pid,{receive:e,data:o},t.origin)},y.prototype.sendRequest=function(t,e,o){return m(t.source,this.pid,{request:e,data:o},t.origin)},y.prototype.returnTarget=function(t,e){var o={receive:"target",data:null};return e.frame&&(o.request="dims",o.frame=e.frame),m(t.source,this.pid,o,t.origin)},y.prototype.receiveMessage=function(t,e){if(e.t&&e.k&&e.t==n&&e.k,void 0!==e.receive)switch(e.receive){case"dims":if(this.ignoreHeightMessagesFromIframe||void 0===e.frame||void 0===this.frames[e.frame])return!1;for(var o in e.data.dims)switch(o){case"width":this.layout_width||this.setLayoutWidth(e.data.dims[o]);break;case"height":a.plugin.classCSSMap["woobox-offer-wrap"].height=e.data.dims[o];default:this.frames[e.frame].css[o]=e.data.dims[o]}return this.frames[e.frame].setCSS();case"checkTop":if(this.firstLoad)return this.firstLoad=!1,e.data.modal&&this.setModalStyles(e.data.modal),!1;v(e.pid);break;case"scrollToIframeTop":this.previousTopOffset=window.pageYOffset,v(e.pid);break;case"scrollToPreviousPosition":null!==this.previousTopOffset&&w(this.previousTopOffset,!1),this.previousTopOffset=null;break;case"expandIframeToFullDocument":this.ignoreHeightMessagesFromIframe=!0,this.previousHeight=document.querySelector("#"+this.pid+" iframe").offsetHeight,function(t,e){var o=document.body,i=document.documentElement,o=Math.max(o.scrollHeight,o.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight);if(i=document.getElementById(t)){i.style["min-height"]=e+"px";t=i.getElementsByClassName("woobox-offer-wrap")[0];t&&(t.style["min-height"]=e+"px");var s={position:"absolute",top:"0px",bottom:"0px",left:"0px",right:"0px","min-height":o+"px","z-index":"9999999999"},r=i.getElementsByTagName("iframe")[0];if(r)for(var n in s)r.style[n]=s[n]}}(this.pid,this.previousHeight);break;case"collapseFullDocumentIframe":!function(t,e){var o=document.getElementById(t);if(o){var i=o.getElementsByTagName("iframe")[0];i.style["min-height"]=e+"px",o.style["min-height"]=e+"px";var s,r=o.getElementsByClassName("woobox-offer-wrap")[0];r.style["min-height"]=e+"px";for(s of["position","top","bottom","left","right","z-index"])i.style[s]=null;setTimeout(function(){o.style["min-height"]=null,r.style["min-height"]=null,i.style["min-height"]=null},200)}}(this.pid,this.previousHeight),this.previousHeight=null,this.ignoreHeightMessagesFromIframe=!1}if(void 0!==e.request)switch(e.request){case"documentInfo":return this.sendData(t,"documentInfo",S.getDocumentInfo(this.el));case"target":return this.returnTarget(t,e)}},y.prototype.setModalStyles=function(t){a.plugin.classCSSMap.overlay={background:t.bgColor||"#000",opacity:t.opacity||80}},y.prototype.init=function(){var o=this;this.setOpts();var t=window.setInterval(function(){o.layout_width&&(o.applyOpts(),window.clearInterval(t))},100);this.setCSS();var i=window.setInterval(function(){var t,e=0;for(t in o.frames)o.frames[t].inited||e++;e||(o.inited=!0,o.setCSSLink(),window.clearInterval(i))},100);this.setFrames()},y.prototype.setLayoutWidth=function(t){return this.layout_width=t,a.plugin.classCSSMap["woobox-offer-wrap"]["max-width"]=this.layout_width+"px",o(this)},y.prototype.setCSS=function(){return o(this)},y.prototype.closeBox=function(t,e){var o=null;if(t.hasOwnProperty("el"))o=t.el;else{t.preventDefault();var i=t.target,s=0;do{if(S.hasClass(i,"woobox-offer")){o=i;break}}while(i=i.parentElement,++s<50)}return o&&(void 0!==e&&parseInt(e)||(e=0),setTimeout(function(){document.documentElement.className=document.documentElement.className.replace("popup_active",""),o.className=o.className.replace("active","")},e)),!1},y.prototype.queueRevealBox=function(t,e){var o=this;t.hasOwnProperty("el")?t.el:t.path[1];return void 0!==e&&parseInt(e)||(e=0),setTimeout(function(){o.revealBox()},e),!0},y.prototype.revealBox=function(){if("popup"===this.opts.style&&0!==this.opts.expire){if(this.readExpireCookie())return!1;this.setExpireCookie(this.opts.expire)}document.documentElement.classList.add("popup_active"),this.el.classList.add("active"),this.removeExitTriggers()},y.prototype.removeExitTriggers=function(){for(var t=document.getElementsByClassName("exit_trigger"),e=0;e<t.length;e++)t[e].parentNode.removeChild(t[e])},y.prototype.setExpireCookie=function(t){void 0!==t&&-1!==t||(t=365);var e=new Date;e.setTime(e.getTime()+24*t*60*60*1e3);e="; expires="+e.toGMTString();document.cookie="hide_offer_"+this.pid+"=1"+e+";path=/"},y.prototype.readExpireCookie=function(){for(var t=String("hide_offer_"+this.pid),e=document.cookie.split("; "),o=0;o<e.length;o++)if(0===e[o].indexOf(t))return!0;return!1},y.prototype.eraseExpireCookie=function(){this.setExpireCookie(-1)},y.prototype.setCSSLink=function(){return!1},y.prototype.setOpts=function(){this.opts.css=h(this.consts.defaultCSSLink,{class:this.type});var t=this.el.dataset;for(attr in t){var e=t[attr];switch(attr){case"offer":break;case"trigger":0!==e.indexOf("exit")||this.opts.hasOwnProperty("prompt")||(this.opts.prompt="Check out this special offer!");default:var o=e.split(":");this.opts[attr]="expire"===attr?parseInt(o[0]):o[0],1<o.length&&(this.opts[attr+"Option"]=o[1])}}return this.opts.hasOwnProperty("expire")||(this.opts.expire=0),this.setInlineOpts(),!0},y.prototype.applyOpts=function(){var t=this;if("popup"===this.opts.style){this.el.className="woobox-offer popup";var e='.popup_active,.popup_active>body{height:100%;overflow:hidden}.woobox-offer.popup{-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity:0;opacity:0;position:fixed;z-index:11111111!important;top:100%;right:0;bottom:0;left:0;transition:opacity .5s ease-out;overflow:hidden;visibility:visible;text-align:center;margin:auto;max-width:none!important;pointer-events:none}.woobox-offer.popup>.woobox-offer-wrap{position:absolute;z-index:2;right:0;left:0;width:88%;width:88vw;overflow:visible;margin:6% auto;margin:6vh auto}.woobox-offer.popup>.woobox-offer-wrap:before{display:block;content:"";position:fixed;z-index:-1;top:0;right:0;bottom:0;left:0}.woobox-offer.popup>.woobox-offer-wrap>iframe{position:relative;z-index:3;margin:0 auto;width:1px;min-width:100%}.woobox-offer.popup>.woobox-offer-wrap>.closer>.indicator{cursor:pointer;display:block;position:absolute;z-index:13;top:31px;right:-13px;width:20px;height:20px;color:#fff;color:rgba(255,255,255,.75);font-family:Verdana,sans-serif;font-size:14px;line-height:1.4;text-align:center;font-weight:400;border-width:2px;border-style:solid;border-color:#fff;border-color:rgba(255,255,255,.5);border-radius:20px}.woobox-offer.popup>.woobox-offer-wrap>.closer>.indicator:hover{border-color:rgba(255,255,255,.6);color:#fff}.woobox-offer.popup.active{-webkit-overflow-scrolling:touch;top:0;-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";filter:alpha(opacity=100);-moz-opacity:1;-khtml-opacity:1;opacity:1;overflow:auto;pointer-events:auto}.woobox-offer.popup.active>.woobox-offer-wrap>.closer{display:block}.woobox-offer.popup .overlay{position:fixed;z-index:1;top:0;right:0;bottom:0;left:0;background:#000;background:rgba(0,0,0,.8)}.woobox-offer.popup .exit_trigger{pointer-events:auto;position:fixed;z-index:10001;background-color:transparent}.woobox-offer.popup .exit_trigger.top{top:0;right:0;left:0;height:12px;width:100%}.woobox-offer.popup .exit_trigger.bottom{bottom:0;right:0;left:0;height:12px;width:100%}.woobox-offer.popup .exit_trigger.right{top:0;right:0;bottom:0;width:12px;height:100%}.woobox-offer.popup .exit_trigger.left{top:0;bottom:0;left:0;width:12px;height:100%}.woobox-offer.popup .overlay,.woobox-offer.popup>.woobox-offer-wrap,.woobox-offer.popup>.woobox-offer-wrap>.closer{display:none}.woobox-offer.popup.active .overlay,.woobox-offer.popup.active>.woobox-offer-wrap,.woobox-offer.popup.active>.woobox-offer-wrap>.closer{display:block}.woobox-offer-wrap{max-width: '+this.layout_width+"px;}.popup_active .woobox-offer-wrap{max-width: "+(this.layout_width+40)+"px;}@media screen and (max-width: "+(this.layout_width+40)+"px) {.popup_active{position:fixed!important;left:0;right:0}.woobox-offer.popup>.woobox-offer-wrap{margin:0;max-width:100%;width:100%}.woobox-offer.popup>.woobox-offer-wrap>.closer>.indicator{top:24px;right:24px;background-color:rgba(0,0,0,.2)}.woobox-offer.popup>.woobox-offer-wrap>.closer>.indicator:hover{background-color:rgba(0,0,0,.8)}}";if("exit"===this.opts.trigger){var o=["top","right","bottom","left"];for(i in o){var s=document.createElement("div");s.className="exit_trigger "+o[i],l?s.addEventListener("mouseover",function(){t.queueRevealBox(t)},!1):s.attachEvent("onmouseover",function(){t.queueRevealBox(t)}),this.el.appendChild(s)}}var r=document.createElement("div");r.innerHTML='<span class="indicator">X</span>',r.className="closer",l?r.addEventListener("click",this.closeBox,!1):r.attachEvent("onclick",this.closeBox),this.el_wrap.appendChild(r);r=document.createElement("div");r.className="overlay",l?r.addEventListener("click",this.closeBox,!1):r.attachEvent("onclick",this.closeBox),r.style.background=this.consts.classCSSMap.overlay.background,r.style.opacity=parseInt(this.consts.classCSSMap.overlay.opacity)/100,this.el.appendChild(r);r=document.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)),(document.head||document.getElementsByTagName("head")[0]).appendChild(r);r="timer"===this.opts.trigger?1e3*parseInt(this.opts.triggerOption):0;"exit"!==this.opts.trigger&&this.queueRevealBox(this,r)}this.el.style.visibility="visible"},y.prototype.setFrames=function(){for(var t=0;t<this.consts.classFrameMap[this.type].length;t++)for(var e in this.consts.frames)this.consts.classFrameMap[this.type][t]==e&&(this.frames[e]=new b(this,e),this.frames[e].init())},y.prototype.setInlineOpts=function(){for(var t=this.el.attributes,e=0;e<t.length;e++)for(var o=0;o<this.consts.classOptionMap[this.type].length;o++)if(this.consts.classOptionMap[this.type][o]==t[e].name){var i=this.consts.options[this.consts.classOptionMap[this.type][o]];this.opts[i]=t[e].value;break}},y.prototype.setLoading=function(){this.loading=!0},y.prototype.clearLoading=function(){this.loading=!1};var S={getOffsetTop:function(t){for(var e=0,o=t;isNaN(o.offsetTop)||(e+=o.offsetTop),o=o.offsetParent;);return e},getDocumentInfo:function(t){return{clientHeight:document.documentElement.clientHeight,clientWidth:document.documentElement.clientWidth,offsetTop:S.getOffsetTop(t),scrollLeft:document.body.scrollLeft,scrollTop:document.body.scrollTop}},hasClass:function(t,e){t=" "+t.className+" ",document.getElementById("logger");return-1<t.indexOf(" "+e+" ")}}}).box());
