var mapsNamespace=window.$MicrosoftMaps8,internalNamespace=mapsNamespace.Internal,Network=internalNamespace._Network,ConfigurableMap=function(){function c(){}return c.createFromConfig=function(o,a,e,n,t,r){Network.downloadJson(a,"configurableMap",function(a,e){c._downloadConfigCallback(o,t,r,a,e)},function(a,e,o){c._downloadErrorCallback(r,a,e,o)},null,e,null,!0,n)},c._createMapObject=function(a,e){return e.mapOptions.credentials=e.mapOptions.credentials||mapsNamespace.Credentials,"string"==typeof e.mapOptions.center&&(e.mapOptions.center=mapsNamespace.Location.parseLatLong(e.mapOptions.center)),new mapsNamespace.Map(a,e.mapOptions)},c._downloadConfigCallback=function(a,e,o,n){try{var t=this._createMapObject(a,n);c._loadAdditionalModules(n.modules,e,o,t)}catch(a){o&&o(a)}},c._loadAdditionalModules=function(a,e,o,n){var t,r,l;if(a&&0<a.length){for(t=[],r=0,l=a.length;r<l;r++)t.push(a[r].moduleName);var s={credentials:n.getOptions().credentials,callback:function(){c._allModulesLoadedCallback(a,e,o,n)},errorCallback:function(a){o&&o(a)}};mapsNamespace.Module.loadModule(t,s)}else e&&e(n)},c._downloadErrorCallback=function(a,e,o,n){a&&a(n||o)},c._allModulesLoadedCallback=function(a,e,o,n){function t(){0===s&&(0<l.length?o&&o(l):e&&e(n),s=-1)}for(var r,l="",s=0,i=0,s=length=a.length;i<length;i++)if(r=a[i].moduleName,c._supportedModuleActions[r]&&a[i].moduleOptions)try{c._supportedModuleActions[r](r,a[i].moduleOptions,function(){s--,t()},function(a){l+=r+":"+a+";",s--,t()},n)}catch(a){l+=r+":"+a+";",s--}else s--;t()},c._GeoXMLPostLoadingAction=function(a,e,o,n,t){for(var r,l=e instanceof Array?e:[e],s=!0,i=0;i<l.length;i++)(r=l[i]).addLayerFromUrl?(r=new mapsNamespace.GeoXmlLayer(r.addLayerFromUrl,!0,r.geoXmlOption),t.layers.insert(r)):(s=!1,n("Data URL is required"));s&&o()},c._GeoJsonPostLoadingAction=function(o,a,n,e,t){for(var r,l,s=a instanceof Array?a:[a],i=!0,c=0;c<s.length;c++)(r=s[c]).addLayerFromUrl?(l=r.geoJsonOption,mapsNamespace.GeoJson.readFromUrl(r.addLayerFromUrl,function(a){var e=l&&l.layerName&&l.layerName.trim()?l.layerName.trim():o+"_"+c,e=new mapsNamespace.Layer(e);e.add(a),t.layers.insert(e),n()},l?l.jsonpQueryParam:null,l?l.style:null)):(i=!1,e("Data URL is required"));i&&n()},c._supportedModuleActions={"Microsoft.Maps.GeoXml":c._GeoXMLPostLoadingAction,"Microsoft.Maps.GeoJson":c._GeoJsonPostLoadingAction},c}();mapsNamespace.ConfigurableMap=ConfigurableMap;
