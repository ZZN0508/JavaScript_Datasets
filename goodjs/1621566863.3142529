(window.coreWebpackJsonp=window.coreWebpackJsonp||[]).push([[38],{184:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return f}));var n=r(0),i=r.n(n),a=r(345),o=r(338),l=(e,t)=>{let{ptrt:r,userOrigin:n}=t;const i=r||window.location.href,a=new URL(e);return a.searchParams.set("ptrt",i),n&&a.searchParams.set("userOrigin",n),a.toString()},s=r(37),c=r(251);function u(e,t,r,n,i,a,o){try{var l=e[a](o),s=l.value}catch(c){return void r(c)}l.done?t(s):Promise.resolve(s).then(n,i)}var g=e=>{const[{registerUrl:t,signInUrl:r,idAvailability:i,webCoreUsiModalFeature:a},o]=Object(n.useState)({registerUrl:null,signInUrl:null,idAvailability:!1,webCoreUsiModalFeature:!1}),{host:l}=Object(c.b)(),g=((e,t)=>{const r=t&&!t.endsWith(".com")?".co.uk":".com";return"https://idcta".concat("live"===e?"":".test",".api.bbc").concat(r,"/idcta/config")})(e,l);return Object(n.useEffect)((()=>{(function(){var e,t=(e=function*(){const e=yield Object(s.a)(g),t=yield e.json(),r="GREEN"===t["id-availability"];o({registerUrl:r?t.register_url:t.unavailable_url,signInUrl:r?t.signin_url:t.unavailable_url,idAvailability:"GREEN"===t["id-availability"],webCoreUsiModalFeature:t.features.webCoreUsiModal})},function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){u(a,n,i,o,l,"next",e)}function l(e){u(a,n,i,o,l,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}})()()}),[g]),{registerUrl:t,signInUrl:r,idAvailability:i,webCoreUsiModalFeature:a}};const b="account-prompt",v="".concat(b,"-content-page-views"),d="".concat(b,"-last-shown-date");var m=(e,t)=>{const{host:r}=Object(c.b)();Object(n.useEffect)((()=>{const n=Object(o.a)(),i=r&&r.endsWith(".com");if(n||i||(()=>{const e=localStorage.getItem(d);return!!e&&Date.now()-new Date(Number(e)).getTime()<864e5})())return;(e=>{const t=localStorage.getItem(v);switch(e){case"index":localStorage.setItem(v,0);break;case"content":null!==t&&localStorage.setItem(v,Number(t)+1)}return Number(localStorage.getItem(v))})(e)<3||(t({show:!0,hideIfServiceUnavailable:!0}),localStorage.setItem(d,Date.now()),localStorage.removeItem(v))}),[])};const p=e=>{let{env:t,hideIfServiceUnavailable:r,ptrt:n,userOrigin:o,setSignInPrompt:s}=e;const{idAvailability:c,signInUrl:u,registerUrl:b,webCoreUsiModalFeature:v}=g(t);if(!(u&&b)||r&&(!c||!v))return null;const d=l(u,{ptrt:n,userOrigin:o}),m=l(b,{ptrt:n,userOrigin:o});return i.a.createElement(a.a,{signInUrl:d,registerUrl:m,onDismiss:()=>s({show:!1})})};var f=e=>{let{env:t,pageType:r,signInPrompt:{show:n,hideIfServiceUnavailable:a,ptrt:l,userOrigin:s},setSignInPrompt:c}=e;return m(r,c),Object(o.a)()||!n?null:i.a.createElement(p,{env:t,hideIfServiceUnavailable:a,ptrt:l,userOrigin:s,setSignInPrompt:c})}}}]);