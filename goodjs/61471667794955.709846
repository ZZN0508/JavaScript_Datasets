!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.AutoTrack=t():e.AutoTrack=t()}(window,function(){return n=[function(e,t){var u,s,l,a={trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},includes:function(e,t){return e.indexOf?-1!==e.indexOf(t):-1!==e.join("").indexOf(t)},isUndefined:function(e){return void 0===e},extend:(u=n("Object"),s=n("Array"),l=n("Boolean"),function e(){var t,n,r,o=0,i=!1;for(l(arguments[0])&&(o=1,i=arguments[0]),r=arguments.length-1;o<r;r--)if(t=arguments[r-1],u(n=arguments[r])||s(n))for(var a in n){var c=n[a];i&&(u(c)||s(c))?(c=e(i,u(c)?{}:[],c),t[a]=c):t[a]=n[a]}else t=n;return t}),getObjectValue:function(e,t,n){var r=e,o=t.split("."),i=o.shift();n=a.isUndefined(n)?null:n;try{for(;r&&i;)r=r[i],i=o.shift()}catch(e){console.log("arr: ",o),console.log(e)}return r=r||n},setCookie:function(e,t,n,r,o){var i=new Date;i.setDate(i.getDate()+n);var a="",a=e+"="+t;n&&(a+=";Expires="+i.toDateString()),r&&(a+=";Domain="+r),o&&(a+=";path="+o),document.cookie=a},getCookie:function(e){var e=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(e=document.cookie.match(e))?unescape(e[2]):null},getUrlParamas:function(e){e=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),e=window.location.search.substr(1).match(e);return null!=e?unescape(e[2]):null}};function n(e){var t=Object.prototype.toString;return function(){return t.call(arguments[0])==="[object "+e+"]"}}var o="mp-include",i="no-track";function d(e){switch(typeof e.className){case"string":return e.className;case"object":return e.className.baseVal||e.getAttribute("class")||"";default:return""}}function c(e,t){var n=document.documentElement?document.documentElement.parentNode:document;if((t=t||n).querySelector)return t.querySelectorAll(e);if("#"===e.charAt(0))return[t.getElementById(e.slice(1))];if("."!==e.charAt(0))return t.getElementsByTagName(e);if(t.getElementsByClassName)return t.getElementsByClassName(e.slice(1));for(var r=[],o=e.slice(1),i=t.getElementsByTagName("*"),a=0,c=i.length;a<c;a++)for(var u=d(i[a]),s=0,l=u.length;s<l;s++)if(u[s]===o){r.push(i[a]);break}return r}function f(e,t,n){var r;e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):(r=e["on"+t],e["on"+t]=r?function(e){n(e),r(e)}:n)}function g(e,t){return e&&e.tagName&&e.tagName.toLowerCase()===t.toLowerCase()}function p(n,e){if(!e||0===e.length)return 1;var r=!1;return e.forEach(function(t){var e=(/^#/.test(t)?function(e){return e.id===t}:/^\./.test(t)?function(e){return a.includes(d(e).split(" "),t.replace(/^\./,""))}:function(e){return g(e,t)})(n,t);e&&(r=e)}),r}function r(e,t){if(e&&!g(e,"html")&&!g(e,"body")&&function(e,t){if(!e)throw Error("el no exist");return t?{text:3,element:1}[t]===e.nodeType:e.nodeType}(e,"element"))switch(e.tagName.toLowerCase()){case"form":return"submit"===t.type;case"input":return a.includes(["button","submit"],e.getAttribute("type"))?"click"===t.type:"change"===t.type;case"select":case"textarea":return"change"===t.type;default:return"click"===t.type}}function m(e){var t="";return g(e,"input")?t=e.value:(e.textContent||e.innerText)&&(t=a.trim(e.textContent||e.innerText).split(/(\s+)/).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)),a.trim(t)}function v(e){for(var t={},n=["action","href"],r=0;r<e.attributes.length;r++){var o=e.attributes[r];(function(e){if(null!==e&&!a.isUndefined(e)){if("string"==typeof e){e=a.trim(e);if(/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/.test((e||"").replace(/[\- ]/g,"")))return;if(/(^\d{3}-?\d{2}-?\d{4}$)/.test(e))return}return 1}})(o.value)&&a.includes(n,o.name)&&(t[o.name]=o.value)}return t}function y(e,t){var n=function(e,t){var n=void 0===e.target?e.srcElement:e.target;if("click"!==e.type)return n;if(e=n,t)for(;!g(n,"body")&&!g(n,"html")&&!p(n,t);)n=n.parentNode;return n=g(n,"body")?e:n}(e,t.config.clickAreas);if(function(e,t){var n;if(p(e,t)){for(var r=e;r.parentNode&&!g(r,"body");r=r.parentNode){if(n=d(r).split(" "),a.includes(n,o))return 1;if(a.includes(n,i))return}t=e.type||"";if("string"==typeof t)switch(t.toLowerCase()){case"hidden":case"password":return}e=e.name||e.id||"";if("string"==typeof e)if(/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(e.replace(/[^a-zA-Z0-9]/g,"")))return;return 1}}(n,t.config.onlyTrackTags)&&r(n,e)){e=t.setData(n,e);return t.track(t.config.eventName,e,t.config.carryBaseData),1}}function w(){try{var e,t,n={},r=document.documentElement?document.documentElement.parentNode:document;for(t in r&&(n.title=r.title||"",n.referrer=r.referrer||""),navigator&&(n.lang=navigator.language||"",n.userLanguage=navigator.userLanguage||"",n.browserLanguage=navigator.browserLanguage||""),window&&window.location&&(n.url=window.location.href||"",n.sh=window.screen.height||0,n.sw=window.screen.width||0,n.cd=window.screen.colorDepth||0),window.performance&&(e=window.performance.timing,n.load=e.loadEventEnd?e.loadEventEnd-e.navigationStart:0,n.domready=e.domContentLoadedEventEnd?e.domContentLoadedEventEnd-e.navigationStart:0,n.blank=e.domLoading-e.navigationStart),n)n[t]||delete n[t];return n}catch(e){return console.log(e),{}}}function h(e,t){var n,r="";for(n in t)""!==r&&(r+="&"),r+=n+"="+encodeURIComponent(t[n]);new Image(1,1).src=e+"/1.gif?"+r}function b(e){var t={source:"web"};(e=e||{}).additionData&&(e.additionData=Object.assign(t,e.additionData)),this.config=Object.assign({},{src:"https://wt.39.net",clickAreas:["a"],onlyTrackTags:["a"],listenerEvents:["click"],eventName:"web_event",cancel_view:!1,cancel_close:!1,carryBaseData:!0,additionData:t},e);!function(e){var t=a.getUrlParamas("__utrace"),n=a.getCookie("__utrace");t&&(a.setCookie("__utrace",t,2e4,"39.net","/"),n&&n!==t&&this.track("new_replace_old_utrace",{old_utrace:n,__utrace:t})),e.call(this)}.call(this,this.init)}Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,r;if(null==this)throw new TypeError("this is null or not defined");var o,i=Object(this),a=i.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(1<arguments.length&&(n=t),r=0;r<a;)r in i&&(o=i[r],e.call(n,o,r,i)),r++}),"function"!=typeof Object.assign&&(Object.assign=function(e){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),b.prototype.init=function(){var e,t,n=this,r=document.documentElement?document.documentElement.parentNode:document,o=(new Date).getTime();if(!r)return console.log("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(function(){n.init()},500);n.config.cancel_view||(t=w(),n.track("web_view",t)),n.config.cancel_close||f(window,"beforeunload",function(){E.lt=(new Date).getTime(),E.et=a.getObjectValue(window,"performance.timing.domLoading",0)||(0<o-E.dt?E.dt:o),E.st=E.lt-E.et,E.at=E.st-E.pt;var e=Object.assign({},E,w());n.track("web_close",e)}),e=n.config.listenerEvents,((t="array")?(t=t.replace(/\w/,function(e){return e.toUpperCase()}),Object.prototype.toString.call(e).slice(8,-1)===t):Object.prototype.toString.call(e).slice(8,-1).toLowerCase())&&n.config.listenerEvents.forEach(function(e){f(r,e,function(e){y(e,n)})})},b.prototype.track=function(e,t,n){n=n||void 0===n?Object.assign({},w(),this.config.additionData):this.config.additionData,e=Object.assign({},{type:e},t,n);t=e,(n=localStorage.getItem("pid")||"")&&(t.pid=n),h(this.config.src,e=t)},b.prototype.listener=function(e,n,r,o){for(var t=c(e),i=this,a=0;a<t.length;a++)!function(t){f(t,n,function(){var e=r(t),e=i.config.carryBaseData&&(o||void 0===o)?Object.assign({},v(t),w(),i.config.additionData,e):Object.assign({},i.config.additionData,e);h(i.config.src,e)})}(t[a])},b.prototype.getEl=c,b.prototype.setData=function(e,t){return this.config.carryBaseData?Object.assign({t:(new Date).getTime(),event:t.type,text:m(e)},v(e),w()):{t:(new Date).getTime(),event:t.type,text:m(e)}},b.prototype.setUser=function(e){e&&localStorage.setItem("pid",e)};var E={et:0,lt:0,at:0,st:0,pt:0,dt:0};!function e(){var t=document.documentElement?document.documentElement.parentNode:document;if(!t)return console.log("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(function(){e()},500);f(window,"load",function(){E.dt||(E.dt=(new Date).getTime())}),document.addEventListener?f(t,"DOMContentLoaded",function(){E.dt=(new Date).getTime()}):f(t,"readystatechange",function(){E.dt=(new Date).getTime()});var n=0;f(t,"visibilitychange",function(){t.hidden?n=new Date:n&&(E.pt+=new Date-n)})}(),e.exports=b}],r={},o.m=n,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0);function o(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}var n,r});
