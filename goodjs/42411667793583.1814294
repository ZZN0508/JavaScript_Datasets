!function(i){var n={};function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=i,o.c=n,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=23)}([function(e,t,i){var n=i(14),o=i(10);e.exports=function(e,t){t=o(e,t,"get");return n(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(15),o=i(10);e.exports=function(e,t,i){t=o(e,t,"set");return n(e,t,i),i},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e},e.exports.default=e.exports,e.exports.__esModule=!0},function(t,e){function i(e){return t.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t.exports.default=t.exports,t.exports.__esModule=!0,i(e)}t.exports=i,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){function i(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=i=function(e){return typeof e}:t.exports=i=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.default=t.exports,t.exports.__esModule=!0,i(e)}t.exports=i,t.exports.default=t.exports,t.exports.__esModule=!0},function(e,t,i){var n=i(16);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(6).default,o=i(9);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?o(e):t},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance");return t.get(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(17),o=i(18),s=i(19),r=i(21);e.exports=function(e,t){return n(e)||o(e,t)||s(e,t)||r()},e.exports.default=e.exports,e.exports.__esModule=!0},function(n,e,t){var o=t(22);function s(e,t,i){return"undefined"!=typeof Reflect&&Reflect.get?n.exports=s=Reflect.get:n.exports=s=function(e,t,i){e=o(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(i):t.value}},n.exports.default=n.exports,n.exports.__esModule=!0,s(e,t,i||e)}n.exports=s,n.exports.default=n.exports,n.exports.__esModule=!0},function(e,t){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o)for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])}return i},writable:!0,configurable:!0})},function(e,t){e.exports=function(e,t){return t.get?t.get.call(e):t.value},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t,i){if(t.set)t.set.call(e,i);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=i}},e.exports.default=e.exports,e.exports.__esModule=!0},function(i,e){function n(e,t){return i.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i.exports.default=i.exports,i.exports.__esModule=!0,n(e,t)}i.exports=n,i.exports.default=i.exports,i.exports.__esModule=!0},function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){var i=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=i){var n,o,s=[],r=!0,a=!1;try{for(i=i.call(e);!(r=(n=i.next()).done)&&(s.push(n.value),!t||s.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return s}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(20);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(i="Object"===i&&e.constructor?e.constructor.name:i)||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(5);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){"use strict";i.r(t),i(13);function o(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};a()(this,o),this.type=e,this.meta=t,this.target=null}var n=i(3),a=i.n(n),s=i(4),r=i.n(s),c=i(1),u=i.n(c),l=i(0),d=i.n(l),h=i(2),f=i.n(h),p=i(7),v=i.n(p),m=i(8),g=i.n(m),E=i(5),_=i.n(E);var y=function(e){v()(o,e);var i,n,t=(i=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=_()(i);return t=n?(e=_()(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),g()(this,t)});function o(){return a()(this,o),t.apply(this,arguments)}return o}(o);u()(y,"SCROLL","page.scroll"),u()(y,"RESIZE","page.resize"),u()(y,"VISIBILITY","page.visibility"),u()(y,"FOCUS","window.focus"),u()(y,"FOCUS_IN","window.focus_in"),u()(y,"BLUR","window.blur"),u()(y,"DOM_LOADED","dom.loaded"),u()(y,"LOADED","page.loaded"),u()(y,"BEFORE_UNLOAD","page.stopped"),u()(y,"MOUSE_OVER","page.mouse_over"),u()(y,"MOUSE_OUT","page.mouse_out");var O=function(e){if("loading"!==document.readyState)return e();document.addEventListener("DOMContentLoaded",e,!1)},w=function(e){if("complete"===document.readyState)return e();window.addEventListener("load",e,!1)};function b(e,n,t){function o(){e.apply(i,s),r=null}var s,i=2<arguments.length&&void 0!==t?t:this,r=null;return function(){if(!r){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];s=t,r=setTimeout(o,n)}}}var T=i(6),P=i.n(T);function D(e,t){if(Array.isArray(t)){if(0<=t.indexOf(e))return 1}else for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&t[i]===e)return 1}var R="function",C="object",A="string",S="undefined";function k(e){return P()(e)!==S}function I(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length?arguments[2]:void 0,n=3<arguments.length?arguments[3]:void 0,o=Number.NaN;return"number"===P()(e)?o=e:P()(e)===A&&(o=Number(e),isNaN(o)&&(o=parseFloat(e))),isNaN(o)||k(i)&&o<i||k(n)&&n<o?t:o}var N={isSet:k,isFunction:function(e){return P()(e)===R},isString:function(e){return P()(e)===A},isObject:function(e){return P()(e)===C},num:I,int:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=I(e,t,2<arguments.length?arguments[2]:void 0,3<arguments.length?arguments[3]:void 0);return"number"!==P()(e)||isNaN(e)?t:Math.round(e)}};function M(){try{for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];console.log.apply(console,[].slice.call(t))}catch(e){}}var x="remove",L={on:function(e,t,i){this.eventTypes||(this.eventTypes={}),this.eventTypes[e]||(this.eventTypes[e]=[]),D(t,this.eventTypes[e])||(i?this.eventTypes[e].push({ref:i,handler:t}):this.eventTypes[e].push(t))},off:function(e,t,i){this.eventTypes&&Array.isArray(this.eventTypes[e])&&this._validateOrRemove.call(this,e,t,i,x)},hasEventListener:function(e,t,i){return!(!this.eventTypes||!Array.isArray(this.eventTypes[e]))&&this._validateOrRemove.call(this,e,t,i,"exists")},trigger:function(e){if(this.eventTypes&&P()(e)===C&&P()(e.type)===A&&this.eventTypes[e.type]){e.target=e.target||this;for(var t=this.eventTypes[e.type].slice(0),i=0;i<t.length;i++){var n=t[i];if(P()(n)===C)try{n.handler.call(n.ref,e)}catch(t){M("Error calling callback",n,e,t)}else try{n(e)}catch(t){M("Error calling callback",e,t)}}}},_validateOrRemove:function(e,t,i,n){for(var o=0;o<this.eventTypes[e].length;o++){var s=this.eventTypes[e][o],r=i?C:R;if(r===P()(s))switch(r){case R:if(s===t)return n===x&&this.eventTypes[e].splice(o,1),!0;break;case C:if(s.handler===t&&s.ref===i)return n===x&&this.eventTypes[e].splice(o,1),!0}}return!1}},F=new WeakMap,j=new WeakMap,U=new WeakMap,G=new WeakMap,W=new WeakMap,t=(r()(z,[{key:"dispatchViewportEvent",value:function(e){this.trigger(new y(e))}},{key:"dispatchVisibilityChange",value:function(){f()(this,U,!window.document.hidden),this.trigger(new y(y.VISIBILITY,{hidden:!d()(this,U)}))}},{key:"dispatchFocusChange",value:function(e,t){d()(this,G)!==e&&(f()(this,G,e),e=e?y.FOCUS:y.BLUR,this.trigger(new y(e,{nativeEvent:t})))}},{key:"domLoaded",get:function(){return d()(this,F)}},{key:"pageLoaded",get:function(){return d()(this,j)}},{key:"isVisible",get:function(){return d()(this,U)}},{key:"hasFocus",get:function(){return d()(this,G)}},{key:"_reset",value:function(){f()(this,F,!1),f()(this,j,!1)}}]),z);function z(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{throttleTime:200};a()(this,z),F.set(this,{writable:!0,value:!1}),j.set(this,{writable:!0,value:!1}),U.set(this,{writable:!0,value:!1}),G.set(this,{writable:!0,value:void 0}),W.set(this,{writable:!0,value:void 0}),u()(this,"on",function(e,t,i){Object.getPrototypeOf(this).on.call(this,e,t,i);var n=!1;if(n=e===y.DOM_LOADED&&d()(this,F)||e===y.LOADED&&d()(this,j)||e===y.VISIBILITY?!0:n)if(n=e===y.VISIBILITY?new y(y.VISIBILITY,{hidden:!!window.document.hidden}):e===y.DOM_LOADED?new y(y.DOM_LOADED):new y(y.LOADED,{timestamp:d()(this,W)}),i)try{t.call(i,n)}catch(e){M("Error calling callback",t,event)}else t(n)}),O(function(){f()(t,F,!0),t.trigger(new y(y.DOM_LOADED))}),w(function(){f()(t,j,!0),f()(t,W,(new Date).getTime()),t.trigger(new y(y.LOADED,{timestamp:d()(t,W)}))});e=e.throttleTime;window.addEventListener("scroll",b(function(){return t.dispatchViewportEvent(y.SCROLL)},e),!0),window.addEventListener("resize",b(function(){return t.dispatchViewportEvent(y.RESIZE)},e)),document.addEventListener("visibilitychange",function(){return t.dispatchVisibilityChange()}),f()(this,U,!window.document.hidden),window.addEventListener("focus",function(e){return t.dispatchFocusChange(!0,e)}),window.addEventListener("blur",function(e){return t.dispatchFocusChange(!1,e)},!0),f()(this,G,document.hasFocus()),window.addEventListener("beforeunload",function(){return t.trigger(new y(y.BEFORE_UNLOAD))}),window.document.addEventListener("mouseover",function(e){return t.trigger(new y(y.MOUSE_OVER,{nativeEvent:e}))}),window.document.addEventListener("mouseout",function(e){return t.trigger(new y(y.MOUSE_OUT,{nativeEvent:e}))}),window.addEventListener("focusin",function(e){return t.trigger(new y(y.FOCUS_IN,{nativeEvent:e}))})}Object.assign(t.prototype,L);var n=t,s=i(11),H=i.n(s),V=function e(t){var i=t.topic,t=t.meta,t=void 0===t?{}:t;a()(this,e),this.topic=i,this.meta=t};function B(e,t,i,n){var o=document.createElement("div");t=(t-=2)<66?66:t,o.style.cssText="top:0;right:0;font-size:12px;user-select:none;border-color:#e2e2e2;font-family:Helevetica Neue,Arial,sans-serif;color:#000;height:24px;display:block;"+"min-width:".concat(66,"px;max-width:").concat(t,"px;white-space:nowrap;z-index:214748366;")+"position:absolute;border-style:solid;width:auto;cursor:pointer;border-width:1px;"+i;n='<span style="position:absolute;right:0;font-size:20px;width:19px;'+'top:2px;line-height:20px;border-left:1px solid black;margin-left:5px;">'.concat(n,"</span>");return o.innerHTML='<span style="'.concat("position:relative;padding:5px 26px 5px 10px;text-align:center;display:block;width:auto;height:auto;overflow:hidden;text-overflow: ellipsis;",'" title="').concat(e,'">').concat(e).concat(n,"</span>"),o}u()(V,"topic",{WRITE_COMPLETE:"".concat("jac.sandbox",".writeComplete"),PAGE_LOAD:"".concat("jac.sandbox",".pageLoad"),SIZE:"".concat("jac.sandbox",".size"),UNLOAD:"".concat("jac.sandbox",".unload"),CLOSE_AD:"".concat("jac.sandbox",".closeAd")});var J=(r()(Z,null,[{key:"createCloseAdButton",value:function(e,t){return B(e,t,"border-color:#e2e2e2;border-bottom-left-radius:6px;background-color:#e2e2e2;","&times;")}},{key:"createOpenAdButton",value:function(e,t){t=B(e,t,"background:#fff;border-color:#000;border-radius:4px;","&plus;");return t.className="jac-show-ad",t}}]),Z);function Z(){a()(this,Z)}function X(e,t,i){var n=(3<arguments.length&&void 0!==arguments[3]?arguments[3]:window).document,o=e.client.closeButton.enabledForSizes,s="".concat(t.width,"x").concat(t.height),r=!0;Array.isArray(o)&&-1===o.indexOf(s)&&(r=!1),(o=n.getElementById("jac_close"))&&o.parentNode.removeChild(o),e.client.closeButton.enabled&&r&&(s={document:n,closeLabel:e.client.closeButton.labels.close,maxWidth:t.width,closeHandler:function(){i.send(new V({topic:V.topic.CLOSE_AD,meta:{closeConfig:e.client.closeButton,adSize:{width:t.width}}}))}},o=s.document,r=s.closeLabel,n=s.maxWidth,s=s.closeHandler,(n=J.createCloseAdButton(r,n)).setAttribute("id","jac_close"),n.addEventListener("click",s,!1),o.body.appendChild(n))}var Y=function(e){v()(s,e);var i,n,o=(i=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=_()(i);return t=n?(e=_()(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),g()(this,t)});function s(e){var t=e.cmd,i=void 0===t?null:t,t=e.status,t=void 0===t?null:t,e=e.meta,e=void 0===e?{}:e;return a()(this,s),(e=o.call(this,{topic:s.topic.SAFE_FRAME,meta:e})).cmd=i,e.status=t,e}return s}(V);u()(Y,"topic",{SAFE_FRAME:"jac.sandbox.sf"}),u()(Y,"cmd",{EXPAND_OVER:"exp-ovr",EXPAND_PUSH:"exp-push",RESIZE_TO:"resize-to",COLLAPSE:"collapse",READ_COOKIE:"read-cookie",WRITE_COOKIE:"write-cookie",MSG:"msg",HIDE:"hide",SHOW:"show"}),u()(Y,"status",{COLLAPSED:"collapsed",COLLAPSING:"collapsing",EXPANDED:"expanded",EXPANDING:"expanding",RESIZE_TO:"resize-to",GEOMETRY_UPDATE:"geom-update",FOCUS_CHANGE:"focus-change",READ_COOKIE:"read-cookie",WRITE_COOKIE:"write-cookie",FAILED:"failed",CMP:"cmp",MSG:"msg",META_UPDATE:"meta-update",HIDE:"hide",SHOW:"show",REGISTER:"register"});var q=function(e){v()(s,e);var i,n,o=(i=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=_()(i);return t=n?(e=_()(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),g()(this,t)});function s(e){var t;return a()(this,s),(t=o.call(this,e.topic)).message=e,t}return s}(o),K=new WeakMap,$=new WeakMap,c=(r()(Q,[{key:"send",value:function(e){this.targetWindow.postMessage(Object.assign({token:d()(this,K)},e),"*")}},{key:"listen",value:function(){var t=this;d()(this,$)||(f()(this,$,function(e){return t._handlePostMessage(e)}),window.addEventListener("message",d()(this,$)))}},{key:"cleanup",value:function(){window.removeEventListener("message",d()(this,$)),f()(this,$,null)}},{key:"_handlePostMessage",value:function(e){this._shouldReadPostMessage(e)&&(e=new(e.data.topic===Y.topic.SAFE_FRAME?Y:V)(e.data),e=new q(e),this.trigger(e))}},{key:"_shouldReadPostMessage",value:function(e){return e.source===this.targetWindow&&e.data&&e.data.token===d()(this,K)&&e.data.topic}}]),Q);function Q(e,t){a()(this,Q),K.set(this,{writable:!0,value:void 0}),$.set(this,{writable:!0,value:void 0}),f()(this,K,t),this.targetWindow=e}Object.assign(c.prototype,L);var ee=c,te=function(t,i){Object.keys(i).forEach(function(e){void 0!==i[e]&&(t.style[e]=i[e])})},ie=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:window).getComputedStyle(e);return t?e.getPropertyValue(t):e},ne="auto";function oe(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:window,t=document.documentElement,i=e.innerWidth||t.clientWidth||0,n=e.innerHeight||t.clientHeight||0,t=e.screenLeft||e.screenX||0,e=e.screenTop||e.screenY||0;return{top:e,left:t,bottom:e+n,right:t+i,width:i,height:n}}function se(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window,i=e.getBoundingClientRect()||{},n=i.left,o=i.right,s=i.top,i=i.bottom;return e===t.document.body&&i<t.innerHeight&&(i=t.innerHeight),{left:n,right:o=e===t.document.body&&o<t.innerWidth?t.innerWidth:o,top:s,bottom:i,width:o-n,height:i-s,zIndex:ie(e,"z-index",t)}}function re(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:window).document;return function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document;return"CSS1Compat"===e.compatMode&&e.documentElement}(e)?e.documentElement:e.body}function ae(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).features||{};return{"exp-ovr":!(!e.expandOver||!e.expandOver.enabled),"exp-push":!(!e.expandPush||!e.expandPush.enabled),"read-cookie":!(!e.cookies||!e.cookies.read),"write-cookie":!(!e.cookies||!e.cookies.write),"resize-to":!(!e.resize||!e.resize.enabled)}}function ce(e){return e&&e.match(ve)}var ue={getWindowGeometry:oe,getElementGeometry:se,getVisibilityMetrics:function(e){var t,i,n,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window,s=oe(o),r=s.width,s=s.height,e=se(e,o),o=e.width*e.height;return e.width=e.width||1,e.height=e.height||1,t=e.right<=0||e.left>r?0:(t=Math.max(-e.left,0),i=Math.max(e.right-r,0),e.width-t-i),n=e.bottom<=0||e.top>s?0:(i=Math.max(-e.top,0),n=Math.max(e.bottom-s,0),e.height-i-n),{containerPixels:o,xPercentage:t/e.width,yPercentage:n/e.height,totalPercentage:t*n/(o||1)}},isClippingElement:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"X",t=(i=(i=2<arguments.length?arguments[2]:void 0)||ie(e))["overflow"+t],i=i.overflow;return"hidden"===t||"scroll"===t||t===ne||"hidden"===i||"scroll"===i||i===ne},isScrollableElement:function(e,t){var i=(t=t||ie(e)).overflowX,n=t.overflowY,t=t.overflow,i="scroll"===i||"scroll"===t||(i===ne||t===ne)&&e.scrollWidth>e.clientWidth,e="scroll"===n||"scroll"===t||(n===ne||t===ne)&&e.scrollHeight>e.clientHeight;return i||e},getPageScrollInfo:function(){var e=re(0<arguments.length&&void 0!==arguments[0]?arguments[0]:window);return{x:Math.max(e.scrollLeft,0),y:Math.max(e.scrollTop,0),w:Math.max(e.scrollWidth,0),h:Math.max(e.scrollHeight,0)}},getDocumentElement:re},le=(r()(Oe,null,[{key:"isMobileMomentAd",value:function(e){return!!e&&!!e.meta&&"MobileMoments"===e.meta.GoldenFormat}},{key:"computeDisplaySize",value:function(e){var t={width:300,height:533},i=ue.getWindowGeometry();return e.config.client.mobileMoments.enabled&&i.width<=550&&i.width<i.height&&(t.width=i.width,t.height=Math.floor(i.width*(16/9))),t}}]),Oe),he=new WeakMap,de=new WeakMap,fe=new WeakMap,pe=(r()(ye,[{key:"init",value:function(e){var t=e.w,e=e.h;0<=d()(this,de).indexOf("".concat(t,"x").concat(e))&&!d()(this,fe)&&d()(this,he).send(new V({topic:V.topic.SIZE,meta:{width:t,height:e}}))}},{key:"unload",value:function(){d()(this,he).send(new V({topic:V.topic.UNLOAD}))}}]),ye),ve=/^(\d+)x(\d+)$/,me={NOT_SUPPORTED:"Feature not supported by the host.",NOT_REGISTERED:"No prior $sf.ext.register() API call.",EXPANDED:"Already expanded.",NOT_EXPANDED:"Not expanded.",COMMAND_PENDING:"Command already in-progress.",INVALID_COOKIE_ARGS:"Invalid cookie arguments.",INVALID_ARGS:"Invalid arguments.",INVALID_SIZE:"Setting size to less than 1px is hiding, call $sf.ext.hide instead.",INVALID_HIDDEN_SIZE:"Setting size must be greater than 15 if SafeFrame has been hidden.",MISSING_RESIZE_FLEXIBLE_RATIO:"Flexible safeframes can only be resized by ratio.",NOT_ALLOWED_FLEXIBLE_EXPAND:"Flexible safeframe expansion is not supported."},ge={COLLAPSED:"collapsed",COLLAPSING:"collapsing",EXPANDED:"expanded",EXPANDING:"expanding",RESIZING:"resizing",HIDDEN:"hidden"},Ee=(r()(_e,[{key:"_sendMessage",value:function(e){var t=e.cmd,e=e.meta;this.messenger.send(new Y({cmd:t,meta:e})),this.pendingCommand=t}},{key:"_onSafeFrameMessage",value:function(e){var t=e.message,e=t.status,t=t.meta;if(D(e,Y.status)){if(this.pendingCommand===t.cmd&&(this.pendingCommand=null,e===Y.status.FAILED))switch(t.cmd){case Y.cmd.EXPAND_OVER:case Y.cmd.EXPAND_PUSH:case Y.cmd.RESIZE_TO:this._status=ge.COLLAPSED;break;case Y.cmd.COLLAPSE:this._status=ge.EXPANDED}this._callStatusUpdate(e,t)}}},{key:"register",value:function(e,t,i){if(this.hasRegistered)throw new Error("$sf.ext.register() can be called only once and has been called already.");this.hasRegistered=!0,N.isFunction(i)&&(this.statusUpdateCallback=i),0<=this.sizesConfig.indexOf("".concat(e,"x").concat(t))&&!this.flexibleConfig.enabled&&(e=N.int(e,0,0),t=N.int(t,0,0),this.messenger.send(new V({topic:V.topic.SIZE,meta:{width:e,height:t}})),this.width=e,this.height=t),this.registrationKey={},this._callStatusUpdate(Y.status.REGISTER,{key:this.registrationKey})}},{key:"_width",value:function(){return N.isSet(this.width)||(this.width=ue.getWindowGeometry().width),this.width}},{key:"_height",value:function(){return N.isSet(this.height)||(this.height=ue.getWindowGeometry().height),this.height}},{key:"_callStatusUpdate",value:function(e,t){var i=t.cmd,n=t.reason,o=t.info,t=t.key;e===Y.status.FAILED?console.warn("SafeFrame: command failed",{cmd:i,reason:n,info:o}):e===Y.status.META_UPDATE?this.metaData=o:e===Y.status.GEOMETRY_UPDATE?this.geomData=o:e===Y.status.FOCUS_CHANGE?this.hasFocus=o:e===Y.status.RESIZE_TO?(this.width=o.w,this.height=o.h,this._status=ge.COLLAPSED):D(e,ge)&&(e===Y.status.COLLAPSED&&this._align(),this._status=e),this.statusUpdateCallback&&(o={cmd:i,reason:n,info:o},t&&(o.key=t),this.statusUpdateCallback.call(this,e,o))}},{key:"_sendFailureStatus",value:function(e,t){this._callStatusUpdate(Y.status.FAILED,{cmd:e,reason:t})}},{key:"supports",value:function(e){return N.isSet(e)?!!this.supportsMap[e]:this.supportsMap}},{key:"expand",value:function(e){var t,i=e.t,n=e.l,o=e.r,s=e.b,e=e.push?Y.cmd.EXPAND_PUSH:Y.cmd.EXPAND_OVER;this.supports(e)?this.hasRegistered?this.pendingCommand?t=me.COMMAND_PENDING:this.status()===ge.EXPANDED?t=me.EXPANDED:this.flexibleConfig.enabled&&(t=me.NOT_ALLOWED_FLEXIBLE_EXPAND):t=me.NOT_REGISTERED:t=me.NOT_SUPPORTED,t?this._sendFailureStatus(e,t):(s={top:N.int(i,0,0),left:N.int(n,0,0),right:N.int(o,0,0),bottom:N.int(s,0,0)},this._align(s),this._sendMessage({cmd:e,meta:s}),this._status=ge.EXPANDING)}},{key:"collapse",value:function(){var e,t=Y.cmd.COLLAPSE;this.hasRegistered?this.pendingCommand?e=me.COMMAND_PENDING:this.status()!==ge.EXPANDED&&(e=me.NOT_EXPANDED):e=me.NOT_REGISTERED,e?this._sendFailureStatus(t,e):(this._sendMessage({cmd:t}),this._status=ge.COLLAPSING)}},{key:"_align",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.top,i=e.left,n=e.right,o=e.bottom;this.alignmentElement||(this.alignmentElement=this.windowContext.document.getElementById("fc_align"));e={};t&&!o?(e.top=null,e.bottom="0"):(e.top="0",e.bottom=null),i&&!n?(e.left=null,e.right="0"):(e.left="0",e.right=null),te(this.alignmentElement,e),this._adjustWindowContentSize()}},{key:"_adjustWindowContentSize",value:function(){var e=this.windowContext.document.documentElement.style;e.width=e.height="100%"}},{key:"cookie",value:function(e,t){var i,n=t?Y.cmd.WRITE_COOKIE:Y.cmd.READ_COOKIE;this.supports(n)?this.hasRegistered?!e||t&&!t.value?i=me.INVALID_COOKIE_ARGS:this.pendingCommand&&(i=me.COMMAND_PENDING):i=me.NOT_REGISTERED:i=me.NOT_SUPPORTED,i?this._sendFailureStatus(n,i):this._sendMessage({cmd:n,meta:{cookieName:e,cookieData:t}})}},{key:"meta",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"shared",i=Object.prototype.hasOwnProperty,n=this.metaData;if(i.call(n,t)){t=n[t];if(i.call(t,e))return t[e]}return""}},{key:"status",value:function(){return this._status}},{key:"geom",value:function(){return this.geomData}},{key:"inViewPercentage",value:function(){if(this.geomData){var e=this.geomData.self.iv;return Math.round(100*e)}}},{key:"winHasFocus",value:function(){return this.hasFocus}},{key:"resizeTo",value:function(e){var t,i,n,o=Y.cmd.RESIZE_TO;if(this.supports(Y.cmd.RESIZE_TO)?N.isObject(e)?this.hasRegistered?this._status===ge.EXPANDED?n=me.EXPANDED:this.pendingCommand?n=me.COMMAND_PENDING:this.flexibleConfig.enabled&&!ce(e.ratio)&&(n=me.MISSING_RESIZE_FLEXIBLE_RATIO):n=me.NOT_REGISTERED:n=me.INVALID_ARGS:n=me.NOT_SUPPORTED,!n)if(t=N.int(e.w,this._width()),i=N.int(e.h,this._height()),t<=1||i<=1)n=me.INVALID_SIZE;else if(this._status===ge.HIDDEN&&(t<=15||i<=15))n=me.INVALID_HIDDEN_SIZE;else if(t===this.width&&i===this.height&&!this.flexibleConfig.enabled)return;n?this._sendFailureStatus(o,n):(this._adjustWindowContentSize(),this._sendMessage({cmd:Y.cmd.RESIZE_TO,meta:this.flexibleConfig.enabled?{ratio:e.ratio}:{width:t,height:i}}),this._status=ge.RESIZING)}},{key:"hide",value:function(e){this._status=ge.HIDDEN}},{key:"show",value:function(e){}},{key:"ui",value:function(){var e={flex:0};return this.flexibleConfig.enabled&&(this.flexibleConfig.width.enabled&&this.flexibleConfig.height.enabled?e.flex="both":this.flexibleConfig.width.enabled?e.flex="w":this.flexibleConfig.height.enabled&&(e.flex="h")),e}}]),_e);function _e(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:window;a()(this,_e),u()(this,"messenger",void 0),u()(this,"windowContext",void 0),u()(this,"sizesConfig",void 0),u()(this,"hasRegistered",!1),u()(this,"pendingCommand",null),u()(this,"alignmentElement",void 0),u()(this,"statusUpdateCallback",void 0),u()(this,"supportsMap",void 0),u()(this,"geomData",void 0),u()(this,"hasFocus",void 0),u()(this,"metaData",void 0),u()(this,"registrationKey",void 0),u()(this,"width",void 0),u()(this,"height",void 0),u()(this,"flexibleConfig",{}),u()(this,"_status",ge.COLLAPSED),this.messenger=e,this.windowContext=n,this.sizesConfig=t.service.sizes||[];n=t.client.safeFrame;this.supportsMap=ae(n),e.on(Y.topic.SAFE_FRAME,this._onSafeFrameMessage,this),(i=i||{}).geom&&(this.geomData=i.geom),i.focus&&(this.hasFocus=i.focus),this.metaData=i.meta||{},this.flexibleConfig=t.client.flexible}function ye(e,t){a()(this,ye),he.set(this,{writable:!0,value:void 0}),de.set(this,{writable:!0,value:void 0}),fe.set(this,{writable:!0,value:void 0}),f()(this,he,e),f()(this,de,t.service.sizes||[]);t=t.client.flexible;f()(this,fe,t.enabled&&(t.width.enabled||t.height.enabled))}function Oe(){a()(this,Oe)}u()(Ee,"FailureReason",me);var we,be=new WeakMap,Te=(r()(Se,[{key:"register",value:function(e,t,i){d()(this,be).register(e,t,i)}},{key:"supports",value:function(e){return d()(this,be).supports(e)}},{key:"expand",value:function(e){d()(this,be).expand(e)}},{key:"collapse",value:function(){d()(this,be).collapse()}},{key:"cookie",value:function(e,t){d()(this,be).cookie(e,t)}},{key:"meta",value:function(e,t){return d()(this,be).meta(e,t)}},{key:"status",value:function(){return d()(this,be).status()}},{key:"geom",value:function(){return d()(this,be).geom()}},{key:"inViewPercentage",value:function(){return d()(this,be).inViewPercentage()}},{key:"winHasFocus",value:function(){return d()(this,be).winHasFocus()}},{key:"resizeTo",value:function(e){return d()(this,be).resizeTo(e)}},{key:"hide",value:function(e){return d()(this,be).hide(e)}},{key:"show",value:function(e){return d()(this,be).show(e)}},{key:"msg",value:function(e,t){d()(this,be).msg(e,t)}},{key:"ui",value:function(){return d()(this,be).ui()}}]),Se),Pe=(r()(Ae,[{key:"_sendMessage",value:function(e){var t=e.cmd,e=e.meta;this.messenger.send(new Y({cmd:t,meta:e}))}},{key:"msg",value:function(e){return!(this.lastMessageSentTime&&!(this.lastMessageSentTime<(new Date).getTime()-200)||(this._sendMessage({cmd:Y.cmd.MSG,meta:e}),this.lastMessageSentTime=(new Date).getTime(),0))}}]),Ae),De={"1AS":"1AS",VZMSSP:"VZMSSP",PG:"PG"},Re="SF",Ce=2;function Ae(e){a()(this,Ae),u()(this,"messenger",void 0),u()(this,"lastMessageSentTime",void 0),this.messenger=e}function Se(e,t,i,n){a()(this,Se),be.set(this,{writable:!0,value:void 0}),f()(this,be,new Ee(e,t,i,n))}function ke(e){var t=e.positionConfig,i=e.detectSize,n=void 0!==i&&i,o=e.initialWidth,i=e.initialHeight,e=e.allowedSizes,s=t.client.sandbox.anchorTarget;if(we.send(new V({topic:V.topic.PAGE_LOAD})),n&&!t.client.flexible.enabled&&function e(t,i,n,o){var s,r,a,c=document.body.scrollWidth,u=document.body.scrollHeight;t<c||i<u?(u=(c=(s=c*u,r=1e5,a={},n.forEach(function(e){var t=Math.abs(s-e.width*e.height);t<r&&(r=t,a=e)}),a)).width,c=c.height,we.send(new V({topic:V.topic.SIZE,meta:{width:u,height:c}})),X(o,{width:u,height:c},we,window)):0<Ie&&(Ie-=100,setTimeout(function(){e(t,i,n,o)},100))}(o,i,e,t),X(t,{width:o,height:i},we,window),s)for(var r=document.getElementsByTagName("a"),a=0;a<r.length;a++)r[a].setAttribute("target",s)}var Ie=4e3,Ne={getParameter:function(e,t){t=t.replace(/[[\]]/g,"\\$&");e=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return e?e[2]?decodeURIComponent(e[2].replace(/\+/g," ")):"":null},getParameters:function(n,e){var o=this;return e.reduce(function(e,t){var i=o.getParameter(n,t);return i&&(e[t]=i),e},{})},removeParameters:function(e){return e&&"string"==typeof e?e.split(/[?#]/)[0]:""}},Me={clone:function(e){var t=this;return e.map(function(e){return Array.isArray(e)?t.clone(e):"object"===P()(e)?xe.copy(e,{}):e})},diff:function(e,t){return e.filter(function(e){return-1===t.indexOf(e)})}},xe={clone:function(e){return this.copy(e,{})},copy:function(i,n,o){var s=this;return Object.keys(i).forEach(function(e){var t=i[e];t instanceof HTMLElement?o&&N.isSet(n[e])||(n[e]=t):N.isObject(t)&&null!==t&&!Array.isArray(t)?(n[e]=n[e]||{},s.copy(i[e],n[e],o)):o&&N.isSet(n[e])||(n[e]=Array.isArray(t)?Me.clone(t):t)}),n},removeEmptyItems:function(i){var n=this;return Object.keys(i).forEach(function(e){var t=i[e];t&&N.isObject(t)?(n.removeEmptyItems(t),0===Object.keys(t).length&&delete i[e]):(t&&Array.isArray(t)&&0===t.length||N.isString(t)&&!t)&&delete i[e]}),i}},Le={service:{params:{}},client:{closeButton:{enabled:!1,showButtonEnabled:!0,preserveState:!1,animation:{enabled:!0,duration:333},labels:{close:"Close ad",show:"Show ad"}},fetch:{auto:!0,requireViewable:!1,minInterval:2e3,timeout:3e4},flexible:{enabled:!1,width:{enabled:!0,min:0,max:9999},height:{enabled:!0,min:0,max:9999},ratio:""},render:{timeout:1e4,auto:!0,requireViewable:!1},layout:{zIndex:10},rotation:{enabled:!1,cancellable:!0,period:2e4,limit:3,resizable:!1,requireViewable:!0,onNoAd:!1},nonFriendlyIframe:{enabled:!1},safeFrame:{enabled:!1,features:{expandOver:{enabled:!0},expandPush:{enabled:!1},resize:{enabled:!1},cookies:{read:!1,write:!1}}},sandbox:{anchorTarget:"_blank",features:{fullscreen:{enabled:!0},autoplay:{enabled:!0},geolocation:{enabled:!1},camera:{enabled:!1},microphone:{enabled:!1}},allow:["forms","scripts","same-origin","popups","popups-to-escape-sandbox"]},placeholder:{enabled:!1,text:"Advertisement",fontSize:"12px",textColor:"#6e7780",backgroundColor:"#f5f8fa"},mobileMoments:{enabled:!1},viewability:{percent:50,pixels:0,duration:1e3},content:{},meta:{shared:{}}}},Fe={client:{closeButton:{animation:{duration:{minimum:0,rule:!0}}},fetch:{minInterval:{minimum:500,rule:!0}},flexible:{width:{min:{minimum:0,maximum:9999,rule:!0},max:{minimum:0,maximum:9999,rule:!0}},height:{min:{minimum:0,maximum:9999,rule:!0},max:{minimum:0,maximum:9999,rule:!0}}},rotation:{period:{minimum:100,rule:!0}}}};function je(e){var t=xe.clone(Le);return xe.copy(e,t),t.client.safeFrame.enabled||delete t.client.safeFrame.features,t}var Ue=(r()(Ge,[{key:"update",value:function(e){if(!N.isObject(e.client))throw new Error("Invalid ".concat("client"," argument. Object is expected"));if(!N.isSet(e.client.targetElement))throw new Error("No target HTML element configured for position.");(e=xe.clone(e)).client&&e.client.features&&(console.warn('JAC: Support for the "features" property of the client config has been deprecated and will be removed in the future versions. Please move all the "features" one level up in the config.'),Object.assign(e.client,e.client.features),delete e.client.features);this.input=xe.clone(e),function o(s,r){Object.keys(r).forEach(function(e){var t,i,n=P()(s[e]);r[e].rule?"undefined"!==n&&(t=s[e],i=r[e],"number"==typeof t&&"number"==typeof i.minimum&&t<i.minimum||"number"==typeof t&&"number"==typeof i.maximum&&t>i.maximum)&&delete s[e]:"object"===n&&o(s[e],r[e])})}(e,Fe);e=je(e);Object.assign(this,e)}},{key:"updateRotationConfig",value:function(i){var n=this,o=!1;return i&&Object.keys(i).forEach(function(e){var t=i[e];t!==n.client.rotation[e]&&(n.client.rotation[e]=t,o=!0)}),o}},{key:"resetRotationConfig",value:function(){var e=je(xe.clone(this.input)).client.rotation;this.updateRotationConfig(e)}},{key:"updateMeta",value:function(e,t,i){var n=!1,o=N.isString(e)&&N.isSet(t);return N.isObject(e)?(this.client.meta=e,n=!0):N.isString(i)&&this.client.meta[i]&&o?(this.client.meta[i][e]=t,n=!0):o&&(this.client.meta.shared[e]=t,n=!0),n}},{key:"getTargetElement",value:function(){var e=this.client.targetElement;return N.isString(e)?document.getElementById(e):e}}],[{key:"getFromConfig",value:function(e,t){var i=e.service&&e.service.positions||{},e=e.client&&e.client.positions||{},i=i[t],t=e[t];return i||t?{service:i||{},client:t||{}}:null}},{key:"updateInConfig",value:function(e,t,i){var n=i.service,i=i.client;n&&(e.service=e.service||{},e.service.positions=e.service.positions||{},e.service.positions[t]=n),i&&(e.client=e.client||{},e.client.positions=e.client.positions||{},e.client.positions[t]=i)}},{key:"removeFromConfig",value:function(e,t){e.service.positions&&delete e.service.positions[t],e.client.positions&&delete e.client.positions[t]}}]),Ge);function Ge(e){a()(this,Ge),u()(this,"service",void 0),u()(this,"client",void 0),u()(this,"input",void 0),this.update(e)}u()(Ue,"MINIMUM_ROTATION_INTERVAL",100),Object.assign(Ue.prototype,L);r()(We,[{key:"createRotationConfig",value:function(e,t){var i=xe.clone(e.client.rotation);if(i.enabled){this._shouldRotateFromComments(t)||(i.enabled=!1);t=this._getEnvironmentRotationInfo(e,t);return t.RefreshTime&&(i.period=1e3*t.RefreshTime),t.RefreshMax&&(i.limit=t.RefreshMax),t.RefreshKeepSize&&(i.resizable="N"===t.RefreshKeepSize),i}}},{key:"getRotationAliasBasedOnSize",value:function(e,t){return t=t||e.content.size,this._isCommentPresent(e,"RefreshSmall")&&!this._isLargeAd(t)?e.meta.RefreshSmall:this._isCommentPresent(e,"RefreshLarge")&&this._isLargeAd(t)?e.meta.RefreshLarge:void 0}},{key:"_shouldRotateFromComments",value:function(e){var t=e.meta,i=t.AdTypePriority?parseInt(t.AdTypePriority):-1;return!("N"===t.RefreshExclusive&&"N"===t.MP&&493<=i||"N"===t.RefreshReserved&&"N"===t.MP&&200<=i&&i<493)&&(this._isCommentPresent(e,"RefreshMN")||this._isCommentPresent(e,"RefreshSmall")&&!this._isLargeAd(e.content.size)||this._isCommentPresent(e,"RefreshLarge")&&this._isLargeAd(e.content.size))}},{key:"_getEnvironmentRotationInfo",value:function(e,t){var i={RefreshTime:t.meta.RefreshTime,RefreshMax:t.meta.RefreshMax,RefreshKeepSize:t.meta.RefreshKeepSize};i.RefreshTime=i.RefreshTime?parseInt(i.RefreshTime):void 0,i.RefreshMax=i.RefreshMax?parseInt(i.RefreshMax):void 0;t={},e=e.input.client&&e.input.client.rotation;return e&&(e.period&&e.period>Ue.MINIMUM_ROTATION_INTERVAL&&(t.RefreshTime=e.period/1e3),e.limit&&(t.RefreshMax=e.limit),N.isSet(e.resizable)&&(t.RefreshKeepSize=e.resizable?"N":"Y")),Object.assign(i,t,We.PAGE_ROTATION_INFO)}},{key:"_isCommentPresent",value:function(e,t){return Object.prototype.hasOwnProperty.call(e.meta,t)}},{key:"_isLargeAd",value:function(e){return 970<=e.width||600<=e.height}}],[{key:"_getPageRotationParams",value:function(e){var t=Ne.getParameters(e.location.href,["RefreshTime","RefreshMax","RefreshKeepSize"]);return["RefreshTime","RefreshMax"].forEach(function(e){t[e]&&(t[e]=parseInt(t[e]))}),t}}]),l=We;function We(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:window;a()(this,We),We.PAGE_ROTATION_INFO=We._getPageRotationParams(e)}u()(l,"PAGE_ROTATION_INFO",void 0);h=function(e){v()(o,e);var i,n,t=(i=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=_()(i);return t=n?(e=_()(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),g()(this,t)});function o(){return a()(this,o),t.apply(this,arguments)}return o}(o);u()(h,"FETCH_START","FETCH_START"),u()(h,"FETCH_COMPLETE","FETCH_COMPLETE"),u()(h,"FETCH_TIMEOUT","FETCH_TIMEOUT"),u()(h,"FETCH_ERROR","FETCH_ERROR"),u()(h,"RENDER_START","RENDER_START"),u()(h,"RENDER_COMPLETE","RENDER_COMPLETE"),u()(h,"POSITION_CREATED","POSITION_CREATED"),u()(h,"POSITION_ROTATE","POSITION_ROTATE"),u()(h,"POSITION_RENDER_START","POSITION_RENDER_START"),u()(h,"POSITION_RENDER_COMPLETE","POSITION_RENDER_COMPLETE"),u()(h,"POSITION_RENDER_FAILED","POSITION_RENDER_FAILED"),u()(h,"POSITION_COLLAPSED","POSITION_COLLAPSED"),u()(h,"POSITION_VIEW_START","POSITION_VIEW_START"),u()(h,"POSITION_VIEW_END","POSITION_VIEW_END"),u()(h,"POSITION_CONFIG_CHANGED","POSITION_CONFIG_CHANGED"),u()(h,"AD_LOAD_COMPLETE","AD_LOAD_COMPLETE"),u()(h,"AD_SIZE_CHANGED","AD_SIZE_CHANGED"),u()(h,"AD_MESSAGE","AD_MESSAGE"),u()(h,"AD_CLOSED","AD_CLOSED"),u()(h,"AD_OPENED","AD_OPENED");var ze=h,He={service:{host:"https://jill.fc.yahoo.com/",debug:!1,adServer:{"1AS":{params:{}},VZMSSP:{params:{}},PG:{siteAttributes:{}}},positions:{},site:{name:"",queryParams:"",pageSessionId:"xxxxxxxxx".replace(/[x]/g,function(){return Math.floor(16*Math.random()).toString(16)})},user:{regs:{gdpr:{apiStatus:Ce,applies:null,euconsent:""},ccpa:{apiStatus:Ce,usPrivacy:""}},cookies:{},eids:[]}},client:{focusProtection:!0,positions:{},idProviders:{verizonMedia:{pixelId:"58322",email:null}},trackers:{opus:!0,smartPixel:!1,msftSync:!1}}};var Ve=new WeakMap,Be=new WeakMap,Je=(r()(Ze,[{key:"addPosition",value:function(e,t){this._addOrUpdatePosition(e,t),Ze.applyOverrides(this,d()(this,Ve).location.href)}},{key:"updatePosition",value:function(e,t){this._addOrUpdatePosition(e,t),Ze.applyOverrides(this,d()(this,Ve).location.href)}},{key:"_addOrUpdatePosition",value:function(e,t){t=xe.clone(t);"DEFAULT"===e?f()(this,Be,t):(xe.copy(d()(this,Be),t,!0),this.positions[e]?this.positions[e].update(t):this.positions[e]=new Ue(t),Ue.updateInConfig(this,e,this.positions[e])),Ue.updateInConfig(this.input,e,t)}},{key:"removePosition",value:function(e){Ue.removeFromConfig(this.input,e),Ue.removeFromConfig(this,e),"DEFAULT"===e?f()(this,Be,{}):delete this.positions[e]}},{key:"setRegulatoryData",value:function(e){this.service.user.regs.gdpr.apiStatus=e.data.GDPR.apiStatus,this.service.user.regs.gdpr.applies=e.data.GDPR.applies,this.service.user.regs.gdpr.euconsent=e.data.GDPR.euconsent,this.service.user.regs.ccpa.apiStatus=e.data.CCPA.apiStatus,this.service.user.regs.ccpa.usPrivacy=e.data.CCPA.usPrivacy}},{key:"setUserIdentity",value:function(e){N.isSet(e.ids.VZM_CONNECTID)&&this.service.user.eids.push({source:"verizonmedia.com",uids:[{id:e.ids.VZM_CONNECTID}]})}},{key:"updateMeta",value:function(e,t,i,n){e=this.positions[e];return!!e&&e.updateMeta(t,i,n)}},{key:"clone",value:function(){return xe.clone({service:this.service,client:this.client})}},{key:"getFetchTimeout",value:function(e){var i=this;return(e=e||Object.keys(this.positions)).reduce(function(e,t){t=i.positions[t].client.fetch.timeout;return!e||t<e?t:e},null)}},{key:"getServiceConfigForFetch",value:function(e){var t,n=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=i.fetchSize,s=i.allowedSizes,r=xe.clone(this.service);delete r.user.email,delete r.host,r.debug?r.debug=!0:delete r.debug,r.site.url||(t=d()(this,Ve).location.href,r.site.url=Ne.removeParameters(t)),(t=r).user.regs.ccpa.usPrivacy||delete t.user.regs.ccpa,xe.removeEmptyItems(r),this.service.adServer.PG&&!r.adServer&&(r.adServer={PG:{}});var a={};return e.forEach(function(e){var t=r.positions,i=t&&t[e];i&&(n.positions[e].client.rotation.resizable||!o?a[e]=i:(t="".concat(o.width,"x").concat(o.height),0<=(s||i.sizes).indexOf(t)&&(i.sizes=[t],a[e]=i)))}),r.positions=a,r}},{key:"isServiceConfigValid",value:function(){if(!this.service)return console.warn("No service config has been set."),!1;if(!this.service.adServer)return console.warn("No service.adServer config has been set."),!1;if(!this.service.positions)return console.warn("No service.positions config has been set."),!1;var t=this.service.adServer,e=Object.keys(De).filter(function(e){return t[e]});if(0===e.length)return console.warn("No valid adServer config has been set."),!1;if(1<e.length)return console.warn("Only one adServer can be configured."),!1;if(-1!==e.indexOf(De["1AS"])){if(!t["1AS"].region)return console.warn("1AS adServer config requires region to be set."),!1}else if(!(-1===e.indexOf(De.PG)||this.service.site&&this.service.site.spaceId))return console.warn("PG adServer config requires the site spaceId to be set."),!1;return!this.service.host||/^https?:\/\/.*\//i.test(this.service.host)}}],[{key:"applyOverrides",value:function(t,e){var i=Ne.getParameters(e,["jac.cp","jac.noad","jac.kvs","jac.ip","atwCrPr","atwMN","atwKV"]),n=Object.keys(i).map(function(e){return"".concat(e,"=").concat(i[e])}),o=t.service.site.queryParams,o=o?[o]:[];t.service.site.queryParams=o.concat(n).join("&"),"1"===Ne.getParameter(e,"jac.debug")&&(t.service.debug=!0);var s=Ne.getParameter(e,"jac.sf");Object.keys(t.positions).forEach(function(e){e=t.positions[e];"1"===s&&(e.client.safeFrame.enabled=!0)});var r=Ne.getParameter(e,"jac.rotate");r&&Object.keys(t.positions).forEach(function(e){e=t.positions[e].client;e.rotation&&("0"===r?e.rotation.enabled=!1:e.rotation.period=1e3*r)})}}]),Ze);function Ze(e){var i=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window;a()(this,Ze),Ve.set(this,{writable:!0,value:void 0}),Be.set(this,{writable:!0,value:{}}),u()(this,"service",void 0),u()(this,"client",void 0),u()(this,"input",void 0),u()(this,"positions",{}),f()(this,Ve,t),this.input=xe.clone(e);var n=xe.clone(e);n.client=n.client||{},n.service=n.service||{},o=t,e=He.service,(o=o.document.referrer)&&(e.site.referrer=o);var o,s,r,n=(o=n,n=xe.clone(He),xe.copy(o,n),s=n,(r=o).service&&r.service.adServer&&Object.keys(De).forEach(function(e){r.service.adServer[e]||delete s.service.adServer[e]}),n);this.service=n.service,this.client=n.client;n=Ue.getFromConfig(this.input,"DEFAULT");n&&(delete this.service.positions.DEFAULT,delete this.client.positions.DEFAULT,this._addOrUpdatePosition("DEFAULT",n)),Object.keys(this.client.positions).forEach(function(e){var t=Ue.getFromConfig(i.input,e);i._addOrUpdatePosition(e,t)}),Ze.applyOverrides(this,t.location.href)}var Xe=function(e){v()(s,e);var i,n,o=(i=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=_()(i);return t=n?(e=_()(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),g()(this,t)});function s(e,t){return a()(this,s),(e=o.call(this,e)).meta=t,e}return s}(o);u()(Xe,"FETCH_START","".concat("Jill",".FETCH_START")),u()(Xe,"FETCH_COMPLETE","".concat("Jill",".FETCH_COMPLETE")),u()(Xe,"FETCH_TIMEOUT","".concat("Jill",".FETCH_TIMEOUT")),u()(Xe,"FETCH_ERROR","".concat("Jill",".FETCH_ERROR")),u()(Xe,"RESPONSE_PROCESSED","".concat("Jill",".RESPONSE_PROCESSED"));var Ye={},p=i(9),qe=i.n(p),m=i(12),Ke=i.n(m),E=(r()($e,[{key:"start",value:function(){this.startTime||(this.startTime=(new Date).getTime())}},{key:"end",value:function(){this.endTime||(this.endTime=(new Date).getTime(),this.completedPositionNames=this.completedPositionNames.concat(this.positionNames),this.positionNames=[])}},{key:"isPending",value:function(e){return!(this.endTime||e&&!(-1<this.positionNames.indexOf(e)))}},{key:"completePosition",value:function(e){this._movePositionName(e,this.completedPositionNames)}},{key:"abortPosition",value:function(e){this._movePositionName(e,this.abortedPositionNames)}},{key:"_movePositionName",value:function(e,t){var i=this.positionNames.indexOf(e);-1<i&&t.indexOf(e)<0&&(t.push(e),this.positionNames.splice(i,1))}}]),$e);function $e(e){a()(this,$e),u()(this,"positionNames",void 0),u()(this,"completedPositionNames",[]),u()(this,"abortedPositionNames",[]),u()(this,"startTime",void 0),u()(this,"endTime",void 0),Object.assign(this,e)}var Qe=function(e){v()(s,e);var i,n,o=(i=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=_()(i);return t=n?(e=_()(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),g()(this,t)});function s(){var e;a()(this,s);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return e=o.call.apply(o,[this].concat(i)),u()(qe()(e),"url",void 0),u()(qe()(e),"status",void 0),e}return r()(s,[{key:"isPending",value:function(e){return 3!==this.status&&Ke()(_()(s.prototype),"isPending",this).call(this,e)}}]),s}(E);u()(Qe,"ACTION_NAME","fetch");var et={},tt=new WeakMap,it=new WeakMap,T=(r()(nt,[{key:"process",value:function(){if(void 0!==window.JAC_QUEUE&&0<window.JAC_QUEUE.length){var e=window.JAC_QUEUE.shift();if(function(e,t){if(e&&e.client){var i=e.client,e=i.version,i=i.allowed;return e&&e!==t?(console.error("Client version in response from Jill does not match JAC.version."),0):e||i&&i.length&&-1!==i.indexOf(t)||(console.error("This version of JAC library is not allowed to process response from Jill. Please load JAC using client endpoint provided by Jill."),0)}}(e,d()(this,tt))){var t,i=e.client.requestId,n=et[i];return 0===i&&(t=e.positions,(n=new Qe({positionNames:Object.keys(t),status:1})).start(),this.trigger(new Xe(Xe.FETCH_START,{prefetched:!0,request:{positions:t}}))),3!==n.status&&(f()(this,it,!1),i=et[i]?et[i].url:void 0,this.trigger(new Xe(Xe.RESPONSE_PROCESSED,{response:e,fetchAction:n,url:i}))),e}}return null}},{key:"fetchAds",value:function(e,t){var i=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=n.fetchSize,n=n.allowedSizes,s=e.positionNames,o=t.getServiceConfigForFetch(s,{fetchSize:o,allowedSizes:n}),r=o.requestId=nt.REQUEST_ID++;o.metrics=d()(this,it);var a="".concat(t.service.host).concat("v2/ads/js","?jacVersion=").concat(d()(this,tt))+"&config=".concat(encodeURIComponent(JSON.stringify(o)));e.url=a,et[r]=e;var n=t.getFetchTimeout(s),c=!1;function u(e){c||(c=!0,clearTimeout(l),setTimeout(function(){var e,t;(t=Ye[e=a])&&(t.parentNode.removeChild(t),delete Ye[e])},0),e())}var l=setTimeout(function(){return u(function(){et[r].status=3,i.trigger(new Xe(Xe.FETCH_TIMEOUT,{url:a,positionNames:s}))})},n);this.trigger(new Xe(Xe.FETCH_START,{request:o,url:a})),e=a,t=function(){return u(function(){i.trigger(new Xe(Xe.FETCH_COMPLETE,{url:a}))})},n=function(e){return u(function(){i.trigger(new Xe(Xe.FETCH_ERROR,{positionNames:s,scriptErrorEvent:e}))})},(o=document.createElement("script")).className="jac-fetch",o.src=e,o.onload=t,o.onerror=n,(document.body||document.head).appendChild(o),Ye[e]=o}}]),nt);function nt(e){a()(this,nt),tt.set(this,{writable:!0,value:void 0}),it.set(this,{writable:!0,value:!0}),u()(this,"_fetchActions",et),f()(this,tt,e)}u()(T,"REQUEST_ID",1),Object.assign(T.prototype,L);t=T;var ot=function(e){v()(o,e);var i,n,t=(i=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=_()(i);return t=n?(e=_()(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),g()(this,t)});function o(){return a()(this,o),t.apply(this,arguments)}return o}(o);u()(ot,"CONFIG_UPDATE","".concat("Position",".CONFIG_UPDATE")),u()(ot,"ROTATION_UPDATE","".concat("Position",".ROTATION_UPDATE"));var st=new WeakMap,rt=new WeakMap,at=(r()(ct,[{key:"update",value:function(e){this.config=e,this.updateContainerType(),this.trigger(new ot(ot.CONFIG_UPDATE,this.config))}},{key:"containerType",get:function(){return d()(this,st)}},{key:"updateContainerType",value:function(){var e=this.config.client,t=e.safeFrame,e=e.nonFriendlyIframe;"true"===(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).friendlyIframe&&t.enabled?f()(this,st,"FIF"):t&&t.enabled?f()(this,st,Re):e&&e.enabled?f()(this,st,"NFIF"):f()(this,st,"FIF")}},{key:"resetRotation",value:function(){this.rotated=!1,this.config.resetRotationConfig();var e=this.config.service;e.alias=e.params.origmn||e.alias,delete e.params.origmn,this.trigger(new ot(ot.CONFIG_UPDATE,this.config))}},{key:"updateRotationConfig",value:function(e){this.config.updateRotationConfig(e)&&(this.trigger(new ot(ot.ROTATION_UPDATE,this.config)),this.trigger(new ot(ot.CONFIG_UPDATE,this.config)))}},{key:"alias",get:function(){return this.config.service.alias},set:function(e){var t,i;!e||(t=this.config.service).alias!==e&&((i=t.params.origmn||t.alias)&&(t.params.origmn=i),t.alias=e,this.trigger(new ot(ot.CONFIG_UPDATE,this.config)))}},{key:"rotated",get:function(){return d()(this,rt)},set:function(e){f()(this,rt,e)}},{key:"applyAdData",value:function(e){this.adData=e}}]),ct);function ct(e,t){if(a()(this,ct),st.set(this,{writable:!0,value:void 0}),rt.set(this,{writable:!0,value:!1}),u()(this,"name",void 0),u()(this,"config",void 0),u()(this,"adData",void 0),u()(this,"fetch",void 0),u()(this,"render",void 0),!N.isString(e))throw new Error("Invalid ".concat("name"," argument. String is expected"));this.name=e,this.update(t)}Object.assign(at.prototype,L);var ut=function(e){v()(o,e);var i,n,t=(i=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=_()(i);return t=n?(e=_()(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),g()(this,t)});function o(){return a()(this,o),t.apply(this,arguments)}return o}(o);u()(ut,"RENDER_START","".concat("PositionComponent",".RENDER_START")),u()(ut,"RENDER_COMPLETE","".concat("PositionComponent",".RENDER_COMPLETE")),u()(ut,"RENDER_FAILED","".concat("PositionComponent",".RENDER_FAILED")),u()(ut,"AD_OPENED","".concat("PositionComponent",".AD_OPENED")),u()(ut,"AD_CLOSED","".concat("PositionComponent",".AD_CLOSED")),u()(ut,"AD_LOAD","".concat("PositionComponent",".AD_LOAD")),u()(ut,"AD_LOAD_TIMEOUT","".concat("PositionComponent",".AD_LOAD_TIMEOUT")),u()(ut,"NO_AD","".concat("PositionComponent",".NO_AD")),u()(ut,"RESIZE","".concat("PositionComponent",".RESIZE")),u()(ut,"SHOW","".concat("PositionComponent",".SHOW")),u()(ut,"HIDE","".concat("PositionComponent",".HIDE")),u()(ut,"DESTROY","".concat("PositionComponent",".DESTROY")),u()(ut,"VIEW_START","".concat("PositionComponent",".VIEW_START")),u()(ut,"VIEW_END","".concat("PositionComponent",".VIEW_END")),u()(ut,"MOUSE_OUT","".concat("PositionComponent",".MOUSE_OUT")),u()(ut,"AD_SIZE_CHANGED","".concat("PositionComponent",".AD_SIZE_CHANGED")),u()(ut,"GEOMETRY_CHANGED","".concat("PositionComponent",".GEOMETRY_CHANGED")),u()(ut,"AD_META_CHANGED","".concat("PositionComponent",".AD_META_CHANGED")),u()(ut,"AD_MESSAGE","".concat("PositionComponent",".AD_MESSAGE")),u()(ut,"SAFE_FRAME_GEOMETRY_CHANGED","".concat("PositionComponent",".SAFE_FRAME_GEOMETRY_CHANGED"));var lt=function(e){v()(o,e);var i,n,t=(i=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=_()(i);return t=n?(e=_()(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),g()(this,t)});function o(){return a()(this,o),t.apply(this,arguments)}return o}(o);u()(lt,"RENDER_COMPLETE","".concat("Render",".RENDER_COMPLETE")),u()(lt,"AD_LOAD","".concat("Render",".AD_LOAD")),u()(lt,"AD_LOAD_TIMEOUT","".concat("Render",".AD_LOAD_TIMEOUT")),u()(lt,"AD_CLOSED","".concat("Render",".AD_CLOSED")),u()(lt,"AD_OPENED","".concat("Render",".AD_OPENED"));var ht=(r()(dt,null,[{key:"computeFlexibleSize",value:function(e,t,i){var n=e.flexible,o=n.width,s=n.height,r={};if(!o.enabled&&!s.enabled)return r;var a,c,u={width:"100%",height:"100%"};return ce(e.flexible.ratio)&&(a=e.flexible.ratio,c={width:0,height:0},(a=a.match(ve))&&(c.width=parseInt(a[1]),c.height=parseInt(a[2])),n=c,a=e.flexible,c=i,e={},a.height.enabled?(i=ie(t),t=n.height/n.width,i=a.width.enabled?parseInt(i.width):c.width,e.height=i*t+"px"):(n=n.width/n.height,e.width=c.height*n+"px"),xe.copy(e,u)),o.enabled&&(r.width=u.width,r.minWidth=o.min+"px",r.maxWidth=o.max+"px"),s.enabled&&(r.height=u.height,r.minHeight=s.min+"px",r.maxHeight=s.max+"px"),r}}]),dt);function dt(){a()(this,dt)}var ft=new WeakMap,pt=new WeakMap,vt=new WeakMap,mt=new WeakMap,gt=new WeakMap,Et=(r()(_t,[{key:"messenger",get:function(){return d()(this,ft)}},{key:"component",get:function(){return d()(this,pt)}},{key:"cleanup",value:function(){this._toggleEventListeners(!1),d()(this,ft).cleanup()}},{key:"_onSizeChange",value:function(e){var t=e.message.meta,e=t.width,t=t.height;e&&t&&0<=d()(this,mt).indexOf("".concat(e,"x").concat(t))&&d()(this,pt).setSize({width:e,height:t})}},{key:"_onCloseAd",value:function(e){d()(this,pt).closeAd(e.message.meta)}},{key:"_onUnload",value:function(){this.cleanup(),d()(this,pt).unloadAd()}},{key:"_onSafeFrameMessage",value:function(e){var e=e.message,t=e.cmd,i=e.meta;if(!1!==d()(this,vt)[t])switch(t){case Y.cmd.EXPAND_OVER:case Y.cmd.EXPAND_PUSH:this._expand(i,t===Y.cmd.EXPAND_PUSH),this._sendStatusUpdate(Y.status.EXPANDED,{cmd:t});break;case Y.cmd.COLLAPSE:this._collapse(),this._sendStatusUpdate(Y.status.COLLAPSED,{cmd:t});break;case Y.cmd.READ_COOKIE:this._readCookie(i.cookieName);break;case Y.cmd.WRITE_COOKIE:this._writeCookie(i.cookieName,i.cookieData);break;case Y.cmd.MSG:this._receivedAdMessage(i);break;case Y.cmd.RESIZE_TO:this._resizeTo(i)}else this._sendFailure({cmd:t,reason:"Feature not supported by the host."})}},{key:"_expand",value:function(e){var t=e.top,i=e.left,n=e.right,o=e.bottom,s=1<arguments.length&&void 0!==arguments[1]&&arguments[1],t=N.int(t,0,0),i=N.int(i,0,0),n=N.int(n,0,0),o=N.int(o,0,0),e=d()(this,pt).size,o={width:e.width+n+i,height:e.height+o+t};s||(o.dx=-i,o.dy=-t),d()(this,pt).updateGeometry(o,s)}},{key:"_collapse",value:function(){d()(this,pt).resetGeometry()}},{key:"_resizeTo",value:function(e){var t,i=e.width,n=e.height,e=e.ratio,n=d()(this,pt).position.config.client.flexible.enabled?(t={ratio:e},{r:e}):(t={width:i=N.int(i,0,0),height:n=N.int(n,0,0)},{w:i,h:n});d()(this,pt).setSize(t),this._sendStatusUpdate(Y.status.RESIZE_TO,{cmd:Y.cmd.RESIZE_TO,info:n})}},{key:"_readCookie",value:function(e){var t,o,e=(t=window.document,o=e,t.cookie.split(";").reduce(function(e,t){var i=t.indexOf("="),n=t.substring(0,i).trim();return e=o===n?t.substring(i+1):e},"")||null),t=Y.cmd.READ_COOKIE;this._sendStatusUpdate(Y.status.READ_COOKIE,{cmd:t,info:e})}},{key:"_writeCookie",value:function(e,t){var i,n;t.value&&1e3<t.value.length&&(t.value=t.value.substring(0,1e3)),t.expires=t.expires||null,t.expires&&"[object Date]"!==Object.prototype.toString.call(t.expires)&&(t.expires=null),i=window.document,(n=t)&&"string"==typeof n.value&&(o=e+"="+n.value,n.expires&&(o+="; expires="+n.expires.toUTCString()),i.cookie=o);var o=Y.cmd.WRITE_COOKIE;this._sendStatusUpdate(Y.status.WRITE_COOKIE,{cmd:o,info:t.value})}},{key:"_receivedAdMessage",value:function(e){d()(this,pt).adMessageReceived(e)}},{key:"_sendStatusUpdate",value:function(e,t){var i=t.cmd,n=t.reason,t=t.info;this.messenger.send(new Y({status:e,meta:{cmd:i,reason:n,info:t}}))}},{key:"_sendFailure",value:function(e){var t=e.cmd,i=e.reason,e=e.info;this._sendStatusUpdate(Y.status.FAILED,{cmd:t,reason:i,info:e})}},{key:"positionMetaChanged",value:function(e){d()(this,gt)&&d()(this,gt).enabled?this._sendStatusUpdate(Y.status.META_UPDATE,{info:e.meta.adMeta}):console.warn("Messages can be sent only to SafeFrame positions.")}},{key:"_sendSafeFrameGeometryUpdate",value:function(e){d()(this,ft).send(new Y({status:Y.status.GEOMETRY_UPDATE,meta:{info:e.meta}}))}},{key:"_sendSafeFrameFocusUpdate",value:function(e){d()(this,ft).send(new Y({status:Y.status.FOCUS_CHANGE,meta:{info:e.type===y.FOCUS}}))}},{key:"_toggleEventListeners",value:function(e){var t=e?"on":"off",i=d()(this,ft),n=d()(this,pt),e=n.pageObserver;i[t](V.topic.SIZE,this._onSizeChange,this),i[t](V.topic.UNLOAD,this._onUnload,this),i[t](V.topic.CLOSE_AD,this._onCloseAd,this),i[t](Y.topic.SAFE_FRAME,this._onSafeFrameMessage,this),n[t](ut.DESTROY,this.cleanup,this),n[t](ut.SAFE_FRAME_GEOMETRY_CHANGED,this._sendSafeFrameGeometryUpdate,this),n[t](ut.AD_META_CHANGED,this.positionMetaChanged,this),e[t](y.FOCUS,this._sendSafeFrameFocusUpdate,this),e[t](y.BLUR,this._sendSafeFrameFocusUpdate,this)}}]),_t);function _t(e,t){a()(this,_t),ft.set(this,{writable:!0,value:void 0}),pt.set(this,{writable:!0,value:void 0}),vt.set(this,{writable:!0,value:{}}),mt.set(this,{writable:!0,value:[]}),gt.set(this,{writable:!0,value:void 0}),f()(this,ft,e),f()(this,pt,t),f()(this,gt,t.position.config.client.safeFrame),f()(this,vt,ae(d()(this,gt))),f()(this,mt,t.position.adData.config.service.sizes||[]),this._toggleEventListeners(!0)}function yt(t,e){var i,n=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)),n}function Ot(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?yt(Object(i),!0).forEach(function(e){u()(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):yt(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function wt(){return Math.floor(1e7*Math.random()).toString()}function bt(e,t){for(var i=1<arguments.length&&void 0!==t?t:null,n=e.children,o=n.length-1;0<=o;o--)n[o]!==i&&e.removeChild(n[o])}var Tt=new WeakMap,Pt=new WeakMap,Dt=new WeakMap,Rt=new WeakMap,Ct=new WeakMap,At=new WeakMap,s=(r()(St,[{key:"render",value:function(e){var t,i,n,o,s,r,a,c,u,l,h=e.clientBaseUrl;h?(t=d()(this,Tt).position,r=d()(this,Tt).element,c={adData:e,token:wt()},(i=t.containerType)===Re&&(e=c,l=d()(this,Tt),e.safeFrame={geom:l.safeFrameGeometry.buildGeometry(),focus:l.pageObserver.hasFocus,meta:l.position.config.client.meta}),(l=t.config.client.placeholder).enabled&&(n='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">'+'<rect width="100%" height="100%" fill="'.concat((n=l).backgroundColor,'"/>')+'<text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" '+'fill="'.concat(n.textColor,'" ')+'font-family="Arial, Helvetica, sans-serif" '+'font-size="'.concat(n.fontSize,'">')+n.text+"</text></svg>",te(r,{backgroundImage:"url(data:image/svg+xml;base64,".concat(btoa(n),")")})),n=f()(this,Pt,function(e,t){var n,o,i={id:"jacSandbox_"+wt(),name:JSON.stringify(e),title:"Advertisement",itemtype:"https://schema.org/WPAdBlock",itemscope:"",tabindex:"-1",allowtransparency:"true",scrolling:"no"},s=t.sandbox;s&&(i.sandbox=s.allow.map(function(e){return"allow-".concat(e)}).join(" "),i.allow=(n=s.features,o=[],Object.keys(n).forEach(function(e){var t,i=n[e];i.enabled&&((t=[]).push(e),i.allow&&i.allow.forEach(function(e){0===(e=e.trim()).indexOf("https:")?t.push(e):0===e.indexOf("http:")?t.push(e.replace("http:","https:")):t.push("https://"+e)}),o.push(t.join(" ")))}),o.join(";")),s.features.fullscreen.enabled&&(i.allowfullscreen=!0));var r=document.createElement("iframe");return Object.keys(i).forEach(function(e){r.setAttribute(e,i[e])}),s=e.adData.content.size,e=s.width,s=s.height,te(r,{position:"absolute",top:"0",left:"0",width:"".concat(e,"px"),height:"".concat(s,"px"),border:"0",overflow:"hidden",zIndex:t.layout.zIndex}),r}(c,t.config.client)),d()(this,Dt)&&d()(this,Dt).cleanup(),bt(r,n),t.config.client.flexible.enabled&&(s=ht.computeFlexibleSize(t.config.client,r.parentNode,c.adData.content.size),te(n,s),te(r,s)),i===Re?n.src="".concat(h,"/safeframe.html"):"NFIF"===i&&(n.src="".concat(h,"/sandbox.html")),r.appendChild(n),f()(this,Dt,(o=n,s=c,r=d()(this,Tt),a=this,c=r.position.config.client.render.timeout||5e3,u=!1,(s=new ee(o.contentWindow,s.token)).listen(),s.on(V.topic.WRITE_COMPLETE,function(){o.removeAttribute("name"),a.trigger(new lt(lt.RENDER_COMPLETE))}),s.on(V.topic.PAGE_LOAD,function(){u||(u=!0,a.trigger(new lt(lt.AD_LOAD)))}),setTimeout(function(){u||(u=!0,o.removeAttribute("name"),a.trigger(new lt(lt.AD_LOAD_TIMEOUT)))},c),new Et(s,r))),"FIF"===i&&function(e,t){e=e.contentWindow.document;e.open(),e.write('<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>html,body{margin:0;padding:0;width:100%;height:100%}</style></head><body><script src="'+t+'"><\/script><script>var inFIF=true,inDapIF=true;<\/script></body></html>'),e.close()}(n,"".concat(h,"/jac.js"))):console.error("Rendering aborted: URL of JAC library not defined.")}},{key:"clear",value:function(){bt(d()(this,Tt).element)}},{key:"reset",value:function(){d()(this,Tt).element.parentNode.removeChild(d()(this,Tt).element),d()(this,At)&&d()(this,Ct)&&d()(this,Ct).removeEventListener("click",d()(this,At))}},{key:"refreshFlexibleSize",value:function(e,t){var i=d()(this,Tt).position,n=d()(this,Tt).element,t=t||i.config.client.flexible.ratio;ce(t)&&(e=ht.computeFlexibleSize({flexible:Ot(Ot({},i.config.client.flexible),{},{ratio:t})},n.parentNode,e),te(d()(this,Pt),e),te(n,e))}},{key:"resize",value:function(e){var t=e.width,i=e.height,n=e.top,o=void 0===n?0:n,n=e.left,n=void 0===n?0:n;e.resizeContainer&&te(d()(this,Tt).element,{position:"relative",width:"".concat(t,"px"),height:"".concat(i,"px")}),d()(this,Pt)&&te(d()(this,Pt),{width:"".concat(t,"px"),height:"".concat(i,"px"),top:"".concat(o,"px"),left:"".concat(n,"px")})}},{key:"sandbox",get:function(){return d()(this,Dt)}},{key:"adClosed",get:function(){return d()(this,Rt)}},{key:"showButton",get:function(){return d()(this,Ct)}},{key:"closeAd",value:function(e){var t,i=this,n=e.closeConfig,o=e.adSize;d()(this,Rt)||(f()(this,Rt,!0),t=0,n.showButtonEnabled&&(t=26),this._toggleCloseShowAd(n,t,function(){i.showClosedAd(n,t,o)}))}},{key:"showClosedAd",value:function(e,t,i){var n=this;te(d()(this,Pt),{display:"none"}),te(d()(this,Tt).element,{height:"".concat(t,"px")}),this.trigger(new lt(lt.AD_CLOSED)),e.showButtonEnabled&&(i=J.createOpenAdButton(e.labels.show,i.width),f()(this,Ct,i),d()(this,At)||f()(this,At,function(){n.showAd(e)}),i.addEventListener("click",d()(this,At),!1),d()(this,Tt).element.appendChild(i))}},{key:"showAd",value:function(e){var t=this;d()(this,Ct).removeEventListener("click",d()(this,At)),d()(this,Ct).parentNode.removeChild(d()(this,Ct)),f()(this,Ct,null),f()(this,At,null),te(d()(this,Pt),{display:"block"});var i=d()(this,Tt).size.height;this._toggleCloseShowAd(e,i,function(){f()(t,Rt,!1),te(d()(t,Tt).element,{overflow:null,transition:null}),t.trigger(new lt(lt.AD_OPENED))})}},{key:"_toggleCloseShowAd",value:function(e,t,i){e.animation&&!0===e.animation.enabled?(te(d()(this,Tt).element,{overflow:"hidden",height:"".concat(t,"px"),transition:"height ".concat(e.animation.duration,"ms linear")}),setTimeout(function(){i()},e.animation.duration)):(te(d()(this,Tt).element,{height:"".concat(t,"px")}),i())}}],[{key:"create",value:function(e){return new St(e)}}]),St);function St(e){a()(this,St),Tt.set(this,{writable:!0,value:void 0}),Pt.set(this,{writable:!0,value:void 0}),Dt.set(this,{writable:!0,value:void 0}),Rt.set(this,{writable:!0,value:void 0}),Ct.set(this,{writable:!0,value:void 0}),At.set(this,{writable:!0,value:void 0}),f()(this,Tt,e)}Object.assign(s.prototype,L);var kt=s,It=(r()(Nt,[{key:"normalize",value:function(){this.offsetTop=Math.max(this.offsetTop,0),this.offsetLeft=Math.max(this.offsetLeft,0),this.offsetRight=Math.max(this.offsetRight,0),this.offsetBottom=Math.max(this.offsetBottom,0),this.width=Math.max(this.offsetRight-this.offsetLeft,0),this.height=Math.max(this.offsetBottom-this.offsetTop,0)}},{key:"toSafeFrameClip",value:function(){return{t:this.offsetTop,l:this.offsetLeft,r:this.offsetRight,b:this.offsetBottom,w:this.width,h:this.height}}},{key:"getOffsetDifference",value:function(e){var t={top:0,right:0,bottom:0,left:0};return this.offsetTop>e.offsetTop&&this.offsetTop<e.offsetBottom&&(t.top=this.offsetTop-e.offsetTop),this.offsetLeft>e.offsetLeft&&this.offsetLeft<e.offsetRight&&(t.left=this.offsetLeft-e.offsetLeft),this.offsetRight<e.offsetRight&&this.offsetRight>e.offsetLeft&&(t.right=e.offsetRight-this.offsetRight),this.offsetBottom<e.offsetBottom&&this.offsetBottom>e.offsetTop&&(t.bottom=e.offsetBottom-this.offsetBottom),t}},{key:"addHorizontalClipping",value:function(e,t){e>this.offsetLeft&&(this.offsetLeft=e),t<this.offsetRight&&(this.offsetRight=t)}},{key:"addVerticalClipping",value:function(e,t){e>this.offsetTop&&(this.offsetTop=e),t<this.offsetBottom&&(this.offsetBottom=t)}}]),Nt);function Nt(e){var t=e.t,i=void 0===t?0:t,n=e.l,t=void 0===n?0:n,n=e.r,n=void 0===n?0:n,e=e.b,e=void 0===e?0:e;a()(this,Nt),u()(this,"offsetTop",void 0),u()(this,"offsetLeft",void 0),u()(this,"offsetBottom",void 0),u()(this,"offsetRight",void 0),u()(this,"width",void 0),u()(this,"height",void 0),this.offsetTop=i,this.offsetLeft=t,this.offsetRight=n,this.offsetBottom=e,this.width=Math.max(this.offsetRight-this.offsetLeft,0),this.height=Math.max(this.offsetBottom-this.offsetTop,0)}function Mt(e,t){var t=1<arguments.length&&void 0!==t?t:window,e=ue.getElementGeometry(e,t),t=ue.getPageScrollInfo(),i={t:e.top,l:e.left,r:e.right,b:e.bottom,w:e.width,h:e.height,z:e.zIndex};return(t.y||t.x)&&(i.l+=t.x,i.t+=t.y),i.b=i.t+e.height,i.r=i.l+e.width,Object.keys(i).forEach(function(e){"number"==typeof i[e]&&(i[e]=Math.round(i[e]))}),i}function xt(){var e=ue.getPageScrollInfo(),t=ue.getWindowGeometry();return{t:e.y,l:e.x,r:e.x+t.width,b:e.y+t.height,w:t.width,h:t.height}}function Lt(e,t,i){for(var n,o=ue.getPageScrollInfo(),s=ie(e);s;){var r,a,c,u,l,h,d,f,p,v,m,g=e===i;if("block"!==s.display&&"absolute"!==s.position&&"none"===s.float||(r=(f=Mt(e)).t,a=f.l,c=f.r,u=f.b,l=e.offsetWidth,h=e.offsetHeight,d=e.clientWidth,f=e.clientHeight,!p&&d<l&&(p=(v=l-d)<=20?v:0),!m&&f<h&&(m=(v=h-f)<=20?v:0),g?(e.scrollWidth>d&&(a=0,c=(window.innerWidth||l)+o.x,window.innerWidth&&window.innerWidth>d&&(c-=window.innerWidth-d),t.addHorizontalClipping(a,c)),e.scrollHeight>f&&(r=0,u=(window.innerHeight||h)+o.y,window.innerHeight&&window.innerHeight>f&&(u-=window.innerHeight-f),t.addVerticalClipping(r,u))):(p&&c-a===l&&(c-=p),m&&u-r===h&&(u-=m),ue.isClippingElement(e,"X",s)&&t.addHorizontalClipping(a,c),ue.isClippingElement(e,"Y",s)&&t.addVerticalClipping(r,u),!n&&ue.isScrollableElement(e,s)&&(n=e))),g)break;if(!(e=e.parentNode))break;s=ie(e)}return{scrollParent:n,xScrollBarHeight:m,yScrollBarWidth:p}}var Ft=new WeakMap,jt=new WeakMap,Ut=new WeakMap,Gt=new WeakMap,c=(r()(Wt,[{key:"buildGeometry",value:function(){return{win:this.buildWindowGeometry(),self:this.buildSelfGeometry(),exp:this.buildExpandableGeometry(),par:this.buildParentGeometry()}}},{key:"winHasFocus",value:function(){return d()(this,Ft).hasFocus}},{key:"dispatchGeometryChange",value:function(){this.trigger(new o(Wt.GEOMETRY_UPDATE,this.buildGeometry()))}},{key:"destroy",value:function(){d()(this,Ft).off(y.SCROLL,d()(this,Gt)),d()(this,Ft).off(y.RESIZE,d()(this,Gt))}},{key:"buildWindowGeometry",value:function(){var e=ue.getWindowGeometry();return{t:e.top,l:e.left,r:e.right,b:e.bottom,w:e.width,h:e.height}}},{key:"buildSelfGeometry",value:function(){var e=Mt(d()(this,jt),d()(this,Ut)),t=ue.getVisibilityMetrics(d()(this,jt),d()(this,Ut));return e.xiv=parseFloat(t.xPercentage.toFixed(2)),e.yiv=parseFloat(t.yPercentage.toFixed(2)),e.iv=parseFloat(t.totalPercentage.toFixed(2)),e}},{key:"buildExpandableGeometry",value:function(){var e=Mt(d()(this,jt)),t=ue.getDocumentElement(),i=xt(),n=new It(i),i=Lt(d()(this,jt),n,t);n.normalize();n=new It(e).getOffsetDifference(n),n={t:n.top,l:n.left,r:n.right,b:n.bottom};return i.scrollParent?(n.xs=!!i.xScrollBarHeight,n.ys=!!i.yScrollBarWidth):(n.xs=t.scrollWidth>t.clientWidth,n.ys=t.scrollHeight>t.clientHeight),n}},{key:"buildParentGeometry",value:function(){var e=ue.getDocumentElement(),t=xt(),i=new It(t),n=Lt(d()(this,jt),i,e);if(n.scrollParent){var o=Mt(n.scrollParent),o=new It(o);return Lt(n.scrollParent,o,e),o.addHorizontalClipping(t.l,t.r),o.addVerticalClipping(t.t,t.b),o.normalize(),o.toSafeFrameClip()}return i.normalize(),i.toSafeFrameClip()}},{key:"element",set:function(e){f()(this,jt,e)}}]),Wt);function Wt(e,t){var i=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:window;a()(this,Wt),Ft.set(this,{writable:!0,value:void 0}),jt.set(this,{writable:!0,value:void 0}),Ut.set(this,{writable:!0,value:void 0}),Gt.set(this,{writable:!0,value:void 0}),f()(this,Ft,e),f()(this,jt,t),f()(this,Ut,n),f()(this,Gt,b(function(){return i.dispatchGeometryChange()},1e3)),d()(this,Ft).on(y.SCROLL,d()(this,Gt)),d()(this,Ft).on(y.RESIZE,d()(this,Gt))}u()(c,"GEOMETRY_UPDATE","GEOMETRY_UPDATE"),Object.assign(c.prototype,L);var zt=c,Ht=new WeakMap,Vt=new WeakMap,Bt=new WeakMap,Jt=new WeakMap,Zt=new WeakMap,Xt=new WeakMap,Yt=new WeakMap,qt=new WeakMap,Kt=new WeakMap,$t=new WeakMap,Qt=new WeakMap,ei=new WeakMap,ti=new WeakMap,ii=new WeakMap,ni=new WeakMap,oi=new WeakMap,h=(r()(si,[{key:"_createContainerNode",value:function(){var e=this.position.config.getTargetElement(),t=document.createElement("div");t.id="jacPosition_".concat(this.position.name),t.className="jac-container",e.appendChild(t),this.element=t}},{key:"_addSafeFrameGeometry",value:function(){var t=this;this.safeFrameGeometry=new zt(d()(this,Ht),this.element,d()(this,ii)),f()(this,oi,function(e){t.position.containerType===Re&&t._triggerEvent(ut.SAFE_FRAME_GEOMETRY_CHANGED,e.meta)}),this.safeFrameGeometry.on(zt.GEOMETRY_UPDATE,d()(this,oi),this)}},{key:"_removeSafeFrameGeometry",value:function(){this.safeFrameGeometry.destroy(),this.safeFrameGeometry.off(zt.GEOMETRY_UPDATE,d()(this,oi),this),this.safeFrameGeometry=null}},{key:"render",value:function(){var e=this;this._refreshTargetContainerIfChanged(),f()(this,Kt,!0);var t=f()(this,Vt,this.position.adData);this.position.updateContainerType(t.meta),!d()(this,Bt)&&d()(this,Ht)&&(f()(this,Bt,function(){return e._pageStateChanged()}),f()(this,Jt,function(){return e._pageResizeListener()}),d()(this,Ht).on(y.SCROLL,d()(this,Bt)),d()(this,Ht).on(y.RESIZE,d()(this,Jt)),d()(this,Ht).on(y.VISIBILITY,d()(this,Bt))),this._pageStateChanged(),this.position.config.client.render.requireViewable||this._processAndInjectAd()}},{key:"_processAndInjectAd",value:function(){var e=d()(this,Vt);f()(this,Kt,!1),this._triggerEvent(ut.RENDER_START),2===e.status||1===e.status?(2===e.status&&(e.content.size={width:1,height:1,unit:"px"},this._triggerEvent(ut.NO_AD)),le.isMobileMomentAd(e)&&(e.content.size=le.computeDisplaySize(this.position)),this.setSize(e.content.size),this.show(),this.renderer.render(e),this.position.config.client.flexible.enabled&&this.setSize({ratio:this.position.config.client.flexible.ratio}),f()(this,ni,!1)):this._triggerEvent(ut.RENDER_FAILED)}},{key:"_refreshTargetContainerIfChanged",value:function(){var e;this.position.config.getTargetElement()!==this.element.parentNode&&(e=this.element,this._cleanElementListeners(),this.renderer.reset(),this._createContainerNode(),this._addElementListeners(),this.safeFrameGeometry&&(this.safeFrameGeometry.element=this.element),te(this.element,{display:e.style.display,position:e.style.position,width:e.style.width,height:e.style.height}))}},{key:"show",value:function(){te(this.element,{display:"block"}),this._triggerEvent(ut.SHOW)}},{key:"hide",value:function(){te(this.element,{display:"none"}),this._triggerEvent(ut.HIDE)}},{key:"destroy",value:function(){d()(this,Ht).off(y.SCROLL,d()(this,Bt)),d()(this,Ht).off(y.RESIZE,d()(this,Jt)),d()(this,Ht).off(y.VISIBILITY,d()(this,Bt)),this.renderer.off(lt.RENDER_COMPLETE,this._onRenderComplete,this),this.renderer.off(lt.AD_LOAD,this._onAdLoad,this),this.renderer.off(lt.AD_LOAD_TIMEOUT,this._onAdLoadTimeOut,this),this.renderer.off(lt.AD_OPENED,this._onAdOpened,this),this.renderer.off(lt.AD_CLOSED,this._onAdClosed,this),this._cleanElementListeners(),this.renderer.reset(),f()(this,ni,!0),this.safeFrameGeometry&&this._removeSafeFrameGeometry(),this._triggerEvent(ut.DESTROY)}},{key:"_addElementListeners",value:function(){this.element.addEventListener("mouseover",d()(this,Zt)),this.element.addEventListener("mouseout",d()(this,Xt))}},{key:"_cleanElementListeners",value:function(){this.element.removeEventListener("mouseover",d()(this,Zt)),this.element.removeEventListener("mouseout",d()(this,Xt))}},{key:"abortRender",value:function(){this.hide(),this.renderer.clear(),f()(this,ni,!0),f()(this,Qt,null)}},{key:"unloadAd",value:function(){this.setSize({width:1,height:1,unit:"px"}),this.abortRender(),this._triggerEvent(ut.NO_AD)}},{key:"updateGeometry",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];f()(this,Yt,!0),this.renderer.resize({width:e.width,height:e.height,top:e.dy||0,left:e.dx||0,resizeContainer:t});t=this.getGeometry();this._triggerEvent(ut.RESIZE,t)}},{key:"resetGeometry",value:function(){var e;f()(this,Yt,!1),d()(this,Qt)&&(this.renderer.resize({width:d()(this,Qt).width,height:d()(this,Qt).height,top:0,left:0,resizeContainer:!0}),e=this.getGeometry(),this._triggerEvent(ut.RESIZE,e))}},{key:"getGeometry",value:function(){return ue.getElementGeometry(this.element)}},{key:"_isAreaInView",value:function(){var e=this.position.config.client.viewability,t=e.percent/100,i=ue.getVisibilityMetrics(this.element,d()(this,ii)),n=i.totalPercentage>=t,t=0;return 0<e.pixels&&(t=i.totalPercentage*i.containerPixels),n||0<e.pixels&&t>=e.pixels}},{key:"isInView",get:function(){return d()(this,$t)}},{key:"isExpanded",get:function(){return d()(this,Yt)}},{key:"hasMouseOver",get:function(){return d()(this,qt)}},{key:"size",get:function(){return d()(this,Qt)||{}}},{key:"lastAdSize",get:function(){return d()(this,ei)}},{key:"setSize",value:function(e){var t,i;le.isMobileMomentAd(d()(this,Vt))||(t=e.width&&e.height,!this.position.config.client.flexible.enabled||!e.ratio&&e.width&&e.height||(this.renderer.refreshFlexibleSize(d()(this,Vt).content.size,e.ratio),e={width:(i=this.getGeometry()).width,height:i.height}),d()(this,Qt)&&d()(this,Qt).width===e.width&&d()(this,Qt).height===e.height||(f()(this,Qt,e),1<e.width&&1<e.height&&d()(this,Vt).config.service.sizes&&0<=d()(this,Vt).config.service.sizes.indexOf("".concat(e.width,"x").concat(e.height))&&f()(this,ei,e),t&&this.renderer.resize({width:e.width,height:e.height,resizeContainer:!0}),this._triggerEvent(ut.AD_SIZE_CHANGED,d()(this,Qt))))}},{key:"_pageStateChanged",value:function(){var e=this;this._isAreaInView()&&d()(this,Ht).isVisible?d()(this,ti)||(d()(this,ni)?this._viewTimeCounterElapsed():f()(this,ti,d()(this,ii).setTimeout(function(){return e._viewTimeCounterElapsed()},1e3))):(d()(this,ti)&&f()(this,ti,d()(this,ii).clearTimeout(d()(this,ti))),this._changeViewabilityState(!1)),this._triggerEvent(ut.GEOMETRY_CHANGED)}},{key:"_pageResizeListener",value:function(){var e=this.position.config.client.flexible;e.enabled&&this.setSize({ratio:e.ratio}),this._pageStateChanged()}},{key:"_viewTimeCounterElapsed",value:function(){f()(this,ti,d()(this,ii).clearTimeout(d()(this,ti)));var e=this.position.config,t=this._isAreaInView();this._changeViewabilityState(t),e.client.render.requireViewable&&d()(this,Kt)&&t&&this._processAndInjectAd()}},{key:"_changeViewabilityState",value:function(e){e!==d()(this,$t)&&(f()(this,$t,e),this._fireVisibilityEvent(e))}},{key:"_fireVisibilityEvent",value:function(e){e=e?ut.VIEW_START:ut.VIEW_END;this._triggerEvent(e)}},{key:"_onRenderComplete",value:function(){this._triggerEvent(ut.RENDER_COMPLETE,d()(this,Qt))}},{key:"_onAdClosed",value:function(){this._triggerEvent(ut.AD_CLOSED)}},{key:"_onAdOpened",value:function(){this._triggerEvent(ut.AD_OPENED)}},{key:"_onAdLoad",value:function(){this._triggerEvent(ut.AD_LOAD)}},{key:"_onAdLoadTimeOut",value:function(){this._triggerEvent(ut.AD_LOAD_TIMEOUT)}},{key:"_onMouseOver",value:function(){f()(this,qt,!0)}},{key:"_onMouseOut",value:function(){f()(this,qt,!1),this._triggerEvent(ut.MOUSE_OUT)}},{key:"_triggerEvent",value:function(e,t){this.trigger(new ut(e,Object.assign({positionName:this.position.name},t)))}},{key:"closeAd",value:function(e){this.renderer.closeAd(e)}},{key:"updateMeta",value:function(){var e=this.position.config.client.meta;this._triggerEvent(ut.AD_META_CHANGED,{adMeta:e})}},{key:"adMessageReceived",value:function(e){this._triggerEvent(ut.AD_MESSAGE,{message:e})}},{key:"pageObserver",get:function(){return d()(this,Ht)}}]),si);function si(e,t){var i=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:window;a()(this,si),Ht.set(this,{writable:!0,value:void 0}),Vt.set(this,{writable:!0,value:void 0}),Bt.set(this,{writable:!0,value:void 0}),Jt.set(this,{writable:!0,value:void 0}),Zt.set(this,{writable:!0,value:void 0}),Xt.set(this,{writable:!0,value:void 0}),Yt.set(this,{writable:!0,value:!1}),qt.set(this,{writable:!0,value:!1}),Kt.set(this,{writable:!0,value:!1}),$t.set(this,{writable:!0,value:!1}),Qt.set(this,{writable:!0,value:void 0}),ei.set(this,{writable:!0,value:void 0}),ti.set(this,{writable:!0,value:void 0}),ii.set(this,{writable:!0,value:void 0}),ni.set(this,{writable:!0,value:!0}),oi.set(this,{writable:!0,value:void 0}),u()(this,"position",void 0),u()(this,"element",void 0),u()(this,"renderer",void 0),u()(this,"safeFrameGeometry",void 0),this.position=e,this._createContainerNode(),f()(this,Ht,t),f()(this,ii,n),this.renderer=kt.create(this),this.renderer.on(lt.RENDER_COMPLETE,this._onRenderComplete,this),this.renderer.on(lt.AD_LOAD,this._onAdLoad,this),this.renderer.on(lt.AD_LOAD_TIMEOUT,this._onAdLoadTimeOut,this),this.renderer.on(lt.AD_OPENED,this._onAdOpened,this),this.renderer.on(lt.AD_CLOSED,this._onAdClosed,this),f()(this,Zt,function(){return i._onMouseOver()}),f()(this,Xt,function(){return i._onMouseOut()}),this._addElementListeners(),e.containerType===Re&&this._addSafeFrameGeometry()}Object.assign(h.prototype,L);var ri=h;function ai(e){return e&&"IFRAME"===e.tagName&&e.id&&0===e.id.indexOf("jacSandbox_")}var ci=new WeakMap,ui=new WeakMap,p=(r()(li,[{key:"init",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:window;!d()(this,ui)&&t._config.client.focusProtection&&(f()(this,ui,e),f()(this,ci,i),this.focusedElement=i.document.activeElement,e.on(y.BLUR,this._onPageBlur,this),e.on(y.FOCUS_IN,this._onPageFocusIn,this),e.on(y.MOUSE_OVER,this._onMouseOver,this),e.on(y.MOUSE_OUT,this._onMouseOut,this))}},{key:"pageObserver",get:function(){return d()(this,ui)}},{key:"_onPageBlur",value:function(i){var n=this;setTimeout(function(){var e=d()(n,ci).document,t=ai(e.activeElement);t||i.target===d()(n,ci)||n.focusedElement===e.activeElement||(n.focusedElement=null),t&&!n.iframeMouseOver&&(n.focusedElement&&n.focusedElement!==d()(n,ci)&&n.focusedElement!==e.body?n.focusedElement.focus():(n._createFocusPlaceHolder(),li.FOCUS_PLACE_HOLDER.focus(),d()(n,ci).focus()))},0)}},{key:"_createFocusPlaceHolder",value:function(){var e,t;li.FOCUS_PLACE_HOLDER||(e=d()(this,ci).document,(t=li.FOCUS_PLACE_HOLDER=e.createElement("span")).tabIndex=-1,e.body.insertBefore(t,e.body.firstChild))}},{key:"_onPageFocusIn",value:function(e){"IFRAME"!==e.meta.nativeEvent.target.tagName&&(this.focusedElement=e.meta.nativeEvent.target)}},{key:"_onMouseOver",value:function(e){ai(e.meta.nativeEvent.target)&&(this.iframeMouseOver=!0)}},{key:"_onMouseOut",value:function(e){ai(e.meta.nativeEvent.target)&&(this.iframeMouseOver=!1)}}]),li);function li(){a()(this,li),u()(this,"focusedElement",void 0),u()(this,"iframeMouseOver",!1),ci.set(this,{writable:!0,value:void 0}),ui.set(this,{writable:!0,value:void 0})}u()(p,"FOCUS_PLACE_HOLDER",void 0);var hi=function(e){v()(o,e);var i,n,t=(i=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=_()(i);return t=n?(e=_()(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),g()(this,t)});function o(){return a()(this,o),t.apply(this,arguments)}return o}(o);u()(hi,"ROTATION","Scheduler.ROTATION");var di=new WeakMap,fi=new WeakMap,pi=new WeakMap,vi=new WeakMap,i=(r()(mi,[{key:"schedule",value:function(e){var t=e.config.client.rotation;d()(this,pi)[e.name]?console.warn("Position ".concat(e.name," is already a scheduler managed resource.")):t.enabled?t.limit<1?console.warn("Position ".concat(e.name," should have a positive integer rotation limit.")):(d()(this,pi)[e.name]={name:e.name,rotationCount:0,rotationConfig:xe.clone(t)},e.on(ot.ROTATION_UPDATE,this._update,this)):console.warn("Position ".concat(e.name," has rotation disabled."))}},{key:"_update",value:function(e){var t=e.target,i=t.config.client.rotation;d()(this,pi)[t.name]?(e=d()(this,pi)[t.name].rotationConfig.enabled,d()(this,pi)[t.name].rotationConfig=xe.clone(i),d()(this,vi)[t.name]&&(e&&!i.enabled?(this._clearRotationTimer(t.name),this._removePositionObservers(d()(this,vi)[t.name])):!e&&i.enabled&&this._addPositionObservers(d()(this,vi)[t.name]))):console.warn("Position ".concat(t.name," is not a scheduler managed resource."))}},{key:"remove",value:function(e){d()(this,pi)[e.name]?d()(this,pi)[e.name].rotationConfig.cancellable?(this._clearRegistryEntry(e.name),e.off(ot.ROTATION_UPDATE,this._update,this)):console.warn("Position ".concat(e.name," is not cancellable.")):console.warn("Position ".concat(e.name," is not a scheduler managed position."))}},{key:"restart",value:function(e,t){this._clearRegistryEntry(e.name),e.off(ot.ROTATION_UPDATE,this._update,this),this.schedule(e),t&&(this.unsubscribe(t),this.subscribe(t)),e.resetRotation()}},{key:"subscribe",value:function(e){var t=e.position.name;e.position.config.client.rotation.enabled&&(d()(this,vi)[t]?console.warn("PositionComponent for position ".concat(t," is already subscribed.")):(d()(this,vi)[t]=e,this._addPositionObservers(e)))}},{key:"unsubscribe",value:function(e){var t=e.position.name;d()(this,vi)[t]?(this._removePositionObservers(e),delete d()(this,vi)[t]):console.warn("PositionComponent for position ".concat(t," is not a subscribed entry."))}},{key:"positionPeriodElapsed",value:function(e){var t=d()(this,pi)[e],i=d()(this,vi)[e];i&&i.hasMouseOver?t.waitingForMouseToLeave=!0:(t.waitingToBeInView=!0,this._isPageActive()&&(!t.rotationConfig.requireViewable||i&&i.isInView)&&this._startRotation(e))}},{key:"_renderStartedForPosition",value:function(e){var t=e.meta.positionName,e=d()(this,pi)[t];e.rotationCount<e.rotationConfig.limit&&this._scheduleTimeout(t,e.rotationConfig.period)}},{key:"_mouseLeftForPosition",value:function(e){var t=this,i=e.meta.positionName,e=d()(this,pi)[i];e.waitingForMouseToLeave&&(d()(this,pi)[i].timeout=setTimeout(function(){t.positionPeriodElapsed(i)},d()(this,di)),e.waitingForMouseToLeave=!1)}},{key:"_viewStartedForPosition",value:function(e){e=e.meta.positionName;d()(this,pi)[e].waitingToBeInView&&this.positionPeriodElapsed(e)}},{key:"_scheduleTimeout",value:function(e,t){var i=this;d()(this,pi)[e].timeout=setTimeout(function(){i.positionPeriodElapsed(e)},t)}},{key:"_clearRegistryEntry",value:function(e){this._clearRotationTimer(e),delete d()(this,pi)[e]}},{key:"_clearRotationTimer",value:function(e){d()(this,pi)[e]&&d()(this,pi)[e].timeout&&clearTimeout(d()(this,pi)[e].timeout)}},{key:"_onNoAdForPosition",value:function(e){var t=e.meta.positionName,t=d()(this,vi)[t];t&&(t.position.config.client.rotation.onNoAd||this._clearRotationTimer(e.meta.positionName))}},{key:"_addPositionObservers",value:function(e){e.on(ut.RENDER_START,this._renderStartedForPosition,this),e.on(ut.MOUSE_OUT,this._mouseLeftForPosition,this),e.on(ut.VIEW_START,this._viewStartedForPosition,this),e.on(ut.NO_AD,this._onNoAdForPosition,this)}},{key:"_removePositionObservers",value:function(e){e.off(ut.RENDER_START,this._renderStartedForPosition,this),e.off(ut.MOUSE_OUT,this._mouseLeftForPosition,this),e.off(ut.VIEW_START,this._viewStartedForPosition,this),e.off(ut.NO_AD,this._onNoAdForPosition,this)}},{key:"_startRotation",value:function(e){var t={positionName:e},i=d()(this,pi)[e];i.waitingToBeInView=!1,i.waitingForMouseToLeave=!1,i.rotationCount++,d()(this,vi)[e]&&(t.size=d()(this,vi)[e].lastAdSize),this.trigger(new hi(hi.ROTATION,t))}},{key:"_pageVisibleChanged",value:function(){this._checkPositionsStatusOnPageChange()}},{key:"_checkPositionsStatusOnPageChange",value:function(){var t=this;this._isPageActive()&&Object.keys(d()(this,pi)).filter(function(e){return d()(t,pi)[e].waitingToBeInView}).forEach(function(e){return t.positionPeriodElapsed(e)})}},{key:"_isPageActive",value:function(){return d()(this,fi).isVisible&&d()(this,fi).hasFocus}},{key:"registry",get:function(){return d()(this,pi)}},{key:"positionComponents",get:function(){return d()(this,vi)}},{key:"isManagedPosition",value:function(e){return!!d()(this,pi)[e]}}]),mi);function mi(e,t){var i=this;a()(this,mi),di.set(this,{writable:!0,value:5e3}),fi.set(this,{writable:!0,value:void 0}),pi.set(this,{writable:!0,value:{}}),vi.set(this,{writable:!0,value:{}}),t===t.top&&(f()(this,fi,e),d()(this,fi).on(y.VISIBILITY,function(e){return i._pageVisibleChanged(e)},this),d()(this,fi).on(y.FOCUS,function(e){return i._pageVisibleChanged(e)},this))}Object.assign(i.prototype,L);function gi(){a()(this,gi),u()(this,"apiStatus",Ce),u()(this,"usPrivacy","")}function Ei(){a()(this,Ei),u()(this,"apiStatus",Ce),u()(this,"applies",null),u()(this,"euconsent","")}m=i;var _i=function(e){v()(o,e);var i,n,t=(i=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=_()(i);return t=n?(e=_()(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),g()(this,t)});function o(){return a()(this,o),t.apply(this,arguments)}return o}(o);u()(_i,"API_NOT_FOUND","".concat("UserRegulation",".API_NOT_FOUND")),u()(_i,"READ_TIMEOUT","".concat("UserRegulation",".READ_TIMEOUT")),u()(_i,"RESOLVED","".concat("UserRegulation",".RESOLVED")),u()(_i,"UPDATED","".concat("UserRegulation",".UPDATED"));var yi,Oi=new WeakMap,wi=new WeakMap,bi=new WeakMap,Ti=new WeakMap,Pi=new WeakMap,T=(r()(Di,[{key:"data",get:function(){return d()(this,wi)}},{key:"resolved",get:function(){return null===d()(this,Oi)}},{key:"resolve",value:function(e,t){if(t)return f()(this,Oi,null),this._setDataFromConfig(t),void f()(this,bi,!0);if(!d()(this,bi)){if(f()(this,bi,!0),f()(this,Pi,e),"function"!=typeof d()(this,Pi).__uspapi&&"function"!=typeof d()(this,Pi).__tcfapi)return d()(this,wi).GDPR.apiStatus=d()(this,wi).CCPA.apiStatus=3,f()(this,Oi,null),void this.trigger(new _i(_i.API_NOT_FOUND));this._readRegulatoryData()}}},{key:"_dispatchRegulationsResolvedEvent",value:function(){this.trigger(new _i(_i.RESOLVED))}},{key:"_dispatchRegulationsUpdatedEvent",value:function(){this.trigger(new _i(_i.UPDATED))}},{key:"_regulationResolved",value:function(e){d()(this,Ti)[e]&&delete d()(this,Ti)[e],0===Object.keys(d()(this,Ti)).length&&(null===d()(this,Oi)?this._dispatchRegulationsUpdatedEvent():(clearTimeout(d()(this,Oi)),f()(this,Oi,null),this._dispatchRegulationsResolvedEvent()))}},{key:"_setDataFromConfig",value:function(e){e.gdpr&&(e.gdpr.euconsent?(d()(this,wi).GDPR.applies=1,d()(this,wi).GDPR.euconsent=""+e.gdpr.euconsent):d()(this,wi).GDPR.applies=-1<["","0","false",!1,0,void 0,null].indexOf(e.gdpr.applies)?0:1,d()(this,wi).GDPR.apiStatus=4),e.ccpa&&e.ccpa.usPrivacy&&(d()(this,wi).CCPA.usPrivacy=""+e.ccpa.usPrivacy,d()(this,wi).CCPA.apiStatus=4),this._dispatchRegulationsResolvedEvent()}},{key:"_readCCPAData",value:function(){var i=this;d()(this,Pi).__uspapi("getUSPData",1,function(e,t){d()(i,wi).CCPA.apiStatus=t?5:0,t&&(d()(i,wi).CCPA.usPrivacy=e.uspString||"",i._regulationResolved("CCPA"))})}},{key:"_readTCFv2Data",value:function(){var i=this;d()(this,Pi).__tcfapi("addEventListener",2,function(e,t){"tcloaded"!==e.eventStatus&&"useractioncomplete"!==e.eventStatus||(d()(i,wi).GDPR.apiStatus=t?5:0,t&&(d()(i,wi).GDPR.applies=!1===e.gdprApplies?0:1,d()(i,wi).GDPR.euconsent=e.tcString||"",i._regulationResolved("GDPR")))})}},{key:"_readRegulatoryData",value:function(){var t=this;f()(this,Oi,setTimeout(function(){var e=Object.keys(d()(t,Ti));0<e.length?(e.forEach(function(e){0!==d()(t,wi)[e].apiStatus&&(d()(t,wi)[e].apiStatus=1)}),t.trigger(new _i(_i.READ_TIMEOUT,{}))):t._dispatchRegulationsResolvedEvent(),f()(t,Oi,null)},500)),"function"==typeof d()(this,Pi).__uspapi?d()(this,Ti).CCPA="_readCCPAData":d()(this,wi).CCPA.apiStatus=3,"function"==typeof d()(this,Pi).__tcfapi?d()(this,Ti).GDPR="_readTCFv2Data":d()(this,wi).GDPR.apiStatus=3,Object.keys(d()(this,Ti)).forEach(function(e){e=d()(t,Ti)[e];t[e]()})}}],[{key:"getInstance",value:function(){return yi=yi||new Di}},{key:"reset",value:function(){yi=null}}]),Di);function Di(){a()(this,Di),Oi.set(this,{writable:!0,value:0}),wi.set(this,{writable:!0,value:void 0}),bi.set(this,{writable:!0,value:!1}),Ti.set(this,{writable:!0,value:{}}),Pi.set(this,{writable:!0,value:void 0}),f()(this,wi,{CCPA:new gi,GDPR:new Ei})}Object.assign(T.prototype,L);s=T;function Ri(t,e){var i,n=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)),n}function Ci(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ri(Object(i),!0).forEach(function(e){u()(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ri(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function Ai(){var e={};try{e=JSON.parse(localStorage.getItem("vm-connectid"))||{}}catch(e){}return e}function Si(e){return Ci({},Ai()[e]||{})}function ki(e,t){!function(e){try{localStorage.setItem("vm-connectid",JSON.stringify(e))}catch(e){}}(Ci(Ci({},Ai()),{},u()({},e,t)))}function Ii(t,e){var i,n=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)),n}function Ni(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ii(Object(i),!0).forEach(function(e){u()(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ii(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var Mi={};Mi.syncHashedEmail=function(e){var t,i=e.pixelId,n=e.hashedEmail,o=e.gdpr,s=e.gdprConsent,r=e.vm1p;i&&n&&((t=Si(n)).connectid&&((e=t.connectid.lastUpdated)&&(new Date-new Date(e))/36e5<360)||function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=2<arguments.length?arguments[2]:void 0,n=new XMLHttpRequest,o=Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&");n.onreadystatechange=function(e){if(n.readyState===XMLHttpRequest.DONE)if(0===n.status||200<=n.status&&n.status<400)try{i(JSON.parse(n.responseText))}catch(e){i()}else i()};try{n.withCredentials=!0,n.open("GET","".concat(e,"?").concat(o),!0),n.send(t)}catch(e){}}("https://ups.analytics.yahoo.com/ups/".concat(i,"/fed"),Ni(Ni(Ni({he:n},void 0!==o?{gdpr:o}:{}),void 0!==s?{gdpr_consent:s}:{}),void 0!==r?{"1p":r}:{}),function(e){e&&ki(n,Ni(Ni({},t),{},{connectid:{value:e.vmuid||e.connectid,lastUpdated:(new Date).toISOString()}}))}))},Mi.syncIds=function(e){e.hashedEmail&&Mi.syncHashedEmail(e)};var xi=Mi;function Li(t,e){var i,n=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)),n}function Fi(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Li(Object(i),!0).forEach(function(e){u()(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Li(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var c=function(e,t){var i,n=e.pixelId,o=e.email,s=e.gdpr,r=e.gdprConsent,a=e.vm1p;n&&o?(e=function(e){xi.syncIds(Fi(Fi(Fi(Fi({pixelId:n},e?{hashedEmail:e}:{}),void 0!==s?{gdpr:s}:{}),void 0!==r?{gdprConsent:r}:{}),void 0!==a?{vm1p:a}:{}));e=Si(e),e=e.connectid?e.connectid.value:void 0;t(e?{connectid:e}:{})},(o=o).indexOf("@")<0?e(o):(i=e,"string"==typeof(o=o)&&o&&window.crypto&&crypto.subtle&&crypto.subtle.digest?(o=new TextEncoder("utf-8").encode(o.trim().toLowerCase()),crypto.subtle.digest("SHA-256",o).then(function(e){e=Array.from(new Uint8Array(e));i(e.map(function(e){return("00"+e.toString(16)).slice(-2)}).join(""))})):i(""))):t({})},ji=c;"undefined"!=typeof exports&&(exports.getIds=c);var Ui=function(e){v()(o,e);var i,n,t=(i=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=_()(i);return t=n?(e=_()(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),g()(this,t)});function o(){return a()(this,o),t.apply(this,arguments)}return o}(o);u()(Ui,"TIMEOUT","TIMEOUT"),u()(Ui,"RESOLVED","RESOLVED"),u()(Ui,"UPDATED","UPDATED");var Gi=new WeakMap,Wi=new WeakMap,zi=new WeakMap,h=(r()(Hi,[{key:"resolve",value:function(e){var i=this,t=e.client.idProviders.verizonMedia;t&&t.email?d()(this,Gi)||(f()(this,Gi,!0),t={vm1p:1,pixelId:t.pixelId,email:t.email},null!==(e=e.service.user.regs.gdpr).applies&&(t.gdpr=!!e.applies,t.gdprConsent=e.euconsent),f()(this,Wi,setTimeout(function(){f()(i,Wi,null),i.trigger(new Ui(Ui.TIMEOUT))},500)),ji(t,function(e){clearTimeout(d()(i,Wi)),f()(i,Wi,null);var t=d()(i,zi).VZM_CONNECTID,e=e.connectid;t&&t!==e?(d()(i,zi).VZM_CONNECTID=e,i.trigger(new Ui(Ui.UPDATED))):(d()(i,zi).VZM_CONNECTID=e,i.trigger(new Ui(Ui.RESOLVED)))})):f()(this,Wi,null)}},{key:"resolved",get:function(){return null===d()(this,Wi)}},{key:"ids",get:function(){return d()(this,zi)}}]),Hi);function Hi(){a()(this,Hi),Gi.set(this,{writable:!0,value:!1}),Wi.set(this,{writable:!0,value:void 0}),zi.set(this,{writable:!0,value:{}})}Object.assign(h.prototype,L);function Vi(){a()(this,Vi)}i=h,T="".concat("jac.inspect",".position");u()(Vi,"PAGE_LOAD","".concat("jac.inspect",".page.pageLoad")),u()(Vi,"PING","".concat("jac.inspect",".handshake.ping")),u()(Vi,"PONG","".concat("jac.inspect",".handshake.pong")),u()(Vi,"POSITION_ADD","".concat(T,".add")),u()(Vi,"FETCH_BEGIN","".concat(T,".fetchBegin")),u()(Vi,"FETCH_COMPLETE","".concat(T,".fetchComplete")),u()(Vi,"FETCH_TIMEOUT","".concat(T,".fetchTimeout")),u()(Vi,"POSITION_ROTATE","".concat(T,".rotate")),u()(Vi,"POSITION_REMOVE","".concat(T,".remove")),u()(Vi,"POSITION_IN_VIEW","".concat(T,".inView")),u()(Vi,"POSITION_OUT_VIEW","".concat(T,".outView")),u()(Vi,"POSITION_RENDER_START","".concat(T,".renderStart")),u()(Vi,"POSITION_RENDER_COMPLETE","".concat(T,".renderComplete")),u()(Vi,"POSITION_COLLAPSED","".concat(T,".collapsed")),u()(Vi,"AD_LOAD_COMPLETE","".concat(T,".ad.loadComplete")),u()(Vi,"AD_SIZE_CHANGED","".concat(T,".ad.sizeChanged")),u()(Vi,"POSITION_CONFIG_CHANGED","".concat(T,".configChanged")),u()(Vi,"POSITION_AD_MARKUP_REQUESTED","".concat(T,".ad.markupRequested")),u()(Vi,"POSITION_AD_MARKUP","".concat(T,".ad.markup"));var Bi=/\d\.\d\.\d(-rc\.\d{1,})?\/jac\.js$/,Ji=new WeakMap,Zi=new WeakMap,Xi=new WeakMap,Yi=new WeakMap,qi=(r()(Qi,[{key:"getClientResourceTiming",value:function(){if(d()(this,Xi)){var e=d()(this,Yi).performance.getEntriesByType("resource").filter(function(e){return e.name.match(Bi)});return 0<e.length?e[0]:void 0}}},{key:"getFetchResourceTiming",value:function(t){if(d()(this,Xi)&&t&&N.isString(t)&&!(t.length<20)){var e=d()(this,Yi).performance.getEntriesByType("resource").filter(function(e){return"script"===e.initiatorType&&e.name===t});return 0<e.length?e[e.length-1]:void 0}}},{key:"responseEnd",get:function(){return d()(this,Zi)}},{key:"timeOrigin",get:function(){return d()(this,Ji)}}]),Qi),Ki=(r()($i,null,[{key:"createPongEvent",value:function(i,e,t){var n=(t=t||new qi).getClientResourceTiming(),o=i._config.service.site,s={topic:Vi.PONG,meta:{timestamp:(new Date).getTime(),responseEnd:t.responseEnd,history:e,client:{version:i.version},adServer:{meta:{},params:{}},site:{spaceId:o.spaceId,name:o.name}}};return n&&(s.meta.client.loadTime=n.responseEnd,s.meta.client.loadComplete=n.responseEnd+t.timeOrigin,s.meta.client.url=n.name),Object.keys(i._config.service.adServer).filter(function(e,t){return 0===t}).forEach(function(e){var t=i._config.service.adServer[e];s.meta.adServer.name=e,s.meta.adServer.params=t.params,e===De["1AS"]&&(s.meta.adServer.meta.region=t.region)}),s}},{key:"createPositionAddEvent",value:function(e,t){var i,n,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:document,e=e._positions[t];return"string"==typeof e.config.client.targetElement&&(i=e.config.client.targetElement,n=(n=o.getElementById(i))?n.getBoundingClientRect().top:null),{topic:Vi.POSITION_ADD,meta:{timestamp:(new Date).getTime(),config:e.config,name:t,elementId:i,elementTop:n,sizes:e.config.service.sizes,containerType:e.containerType,params:e.config.service.params}}}},{key:"createFetchBeginEvent",value:function(e,t,i,n){return{topic:Vi.FETCH_BEGIN,meta:{timestamp:n,name:e,url:t,prefetched:!!i}}}},{key:"createFetchTimeoutEvent",value:function(e,t){return{topic:Vi.FETCH_TIMEOUT,meta:{timestamp:(new Date).getTime(),name:e,url:t}}}},{key:"createFetchCompleteEvent",value:function(e){var t=e.jac,i=e.positionName,n=e.url,o=e.jillTimings,s=e.positionResponse,r=e.requestTimings,a=t._positions[i],e={meta:s.meta},t=s.content.crId;return{topic:Vi.FETCH_COMPLETE,meta:{timestamp:(new Date).getTime(),name:i,url:n,upstreamResponseDuration:o.upstreamDuration,serviceResponseDuration:o.totalRequestDuration,totalServiceResponseDuration:r?r.duration:null,processingDuration:o.processingDuration,alias:a?a.config.service.alias:void 0,creativeId:t,adData:e,status:s.status}}}},{key:"createPositionRotateEvent",value:function(e){return{topic:Vi.POSITION_ROTATE,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionRemoveEvent",value:function(e){return{topic:Vi.POSITION_REMOVE,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionInViewEvent",value:function(e){return{topic:Vi.POSITION_IN_VIEW,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionOutOfViewEvent",value:function(e){return{topic:Vi.POSITION_OUT_VIEW,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionRenderStartEvent",value:function(e,t){e=e._positions[t];return{topic:Vi.POSITION_RENDER_START,meta:{timestamp:(new Date).getTime(),name:t,timeout:e.config.client.render.timeout}}}},{key:"createPositionRenderCompleteEvent",value:function(e,t,i,n){e=e._positions[t],e={topic:Vi.POSITION_RENDER_COMPLETE,meta:{timestamp:(new Date).getTime(),name:t,containerType:e.containerType}};return void 0!==P()(i)&&void 0!==P()(n)&&(e.meta.size=i+"x"+n),e}},{key:"createAdSizeChangedEvent",value:function(e,t,i){e={topic:Vi.AD_SIZE_CHANGED,meta:{timestamp:(new Date).getTime(),name:e}};return void 0!==P()(t)&&void 0!==P()(i)&&(e.meta.size=t+"x"+i),e}},{key:"createAdLoadCompleteEvent",value:function(e){return{topic:Vi.AD_LOAD_COMPLETE,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPageLoadEvent",value:function(e){return{topic:Vi.PAGE_LOAD,meta:{timestamp:e}}}},{key:"createPositionCollapsedEvent",value:function(e){return{topic:Vi.POSITION_COLLAPSED,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionConfigChangedEvent",value:function(e,t){return{topic:Vi.POSITION_CONFIG_CHANGED,meta:{timestamp:(new Date).getTime(),name:e,config:t}}}},{key:"createPositionAdMarkupEvent",value:function(e,t){return{topic:Vi.POSITION_AD_MARKUP,meta:{timestamp:(new Date).getTime(),name:e,markup:t}}}}]),$i);function $i(){a()(this,$i)}function Qi(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:window;if(a()(this,Qi),Ji.set(this,{writable:!0,value:void 0}),Zi.set(this,{writable:!0,value:void 0}),u()(this,"networkType",void 0),Xi.set(this,{writable:!0,value:!0}),Yi.set(this,{writable:!0,value:void 0}),!e.performance)return console.warn("No performance support available"),void f()(this,Xi,!1);f()(this,Yi,e);var t=e.navigator,t=t.connection||t.mozConnection||t.webkitConnection;this.networkType=t?t.effectiveType:"unknown";e=e.performance;f()(this,Ji,parseFloat(e.timing.navigationStart.toFixed(2))),f()(this,Zi,parseFloat(e.timing.responseEnd.toFixed(2)));e=e.getEntriesByType("navigation");e&&e[0]&&f()(this,Zi,parseFloat((e[0].responseEnd+d()(this,Ji)).toFixed(2)))}function en(t,e){var i,n=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)),n}var tn=new WeakMap,nn=new WeakMap,on=new WeakMap,sn=new WeakMap,c=(r()(rn,[{key:"history",get:function(){return d()(this,on)}},{key:"activate",value:function(e,t){var i=this;f()(this,nn,t);var n=Ne.getParameter(e.location.href,"jac.inspect");"1"===n?this._launchInspector():"2"===n&&this._launchInspector("?jac.newWindow=true"),this.on(Vi.PING,this._onPing,this),this.on(Vi.POSITION_AD_MARKUP_REQUESTED,this._onMarkupRequested,this),this._initInternalListeners(t),e.addEventListener("message",function(e){var t=e.data.topic;t!==Vi.PING&&t!==Vi.POSITION_AD_MARKUP_REQUESTED||i.trigger(new o(t,function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?en(Object(i),!0).forEach(function(e){u()(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):en(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}({source:e.source},e.data.meta)))})}},{key:"produceEvent",value:function(e){d()(this,tn)?d()(this,tn).postMessage(e,"*"):d()(this,on).push(e)}},{key:"_launchInspector",value:function(e){e=e||"";var t=document.createElement("script");t.src="https://jacky-prod-us-east-1.s3.amazonaws.com/jacky/bootstrap/jacky-bootstrap.min.js"+e,document.head.appendChild(t)}},{key:"_initInternalListeners",value:function(e){e.on(ze.POSITION_CREATED,this._onPositionCreated,this),e._jill.on(Xe.FETCH_START,this._onFetchStart,this),e._jill.on(Xe.RESPONSE_PROCESSED,this._onJillResponseProcessed,this),e._jill.on(Xe.FETCH_TIMEOUT,this._onJillFetchTimeout,this),e.on(ze.POSITION_ROTATE,this._onPositionRotate,this),e.on(ze.POSITION_VIEW_START,this._onPositionViewStart,this),e.on(ze.POSITION_VIEW_END,this._onPositionViewEnd,this),e.on(ze.POSITION_RENDER_START,this._onPositionRenderStart,this),e.on(ze.POSITION_RENDER_COMPLETE,this._onPositionRenderComplete,this),e.on(ze.POSITION_COLLAPSED,this._onPositionCollapsed,this),e.on(ze.AD_LOAD_COMPLETE,this._onAdLoadComplete,this),e.on(ze.AD_SIZE_CHANGED,this._onAdSizeChanged,this),e._pageObserver.on(y.LOADED,this._onPageLoad,this),e.on(ze.POSITION_CONFIG_CHANGED,this._onPositionConfigChanged,this)}},{key:"_onPing",value:function(e){var t=d()(this,nn)._config;t&&t.service?d()(this,tn)?console.warn("Already responded to the ping request."):(f()(this,tn,e.meta.source),this._sendPong()):console.warn("No config set yet. Can not reply to inspect ping requests.")}},{key:"_onMarkupRequested",value:function(e){e.meta&&e.meta.name?d()(this,tn)?d()(this,sn)[e.meta.name]&&this.produceEvent(Ki.createPositionAdMarkupEvent(e.meta.name,d()(this,sn)[e.meta.name])):console.warn("No ping initialization request got."):console.warn("No position name provided in the ad markup request.")}},{key:"_sendPong",value:function(){var e=Ki.createPongEvent(d()(this,nn),d()(this,on));this.produceEvent(e),f()(this,on,[])}},{key:"_onPositionCreated",value:function(e){this.produceEvent(Ki.createPositionAddEvent(d()(this,nn),e.meta.positionName))}},{key:"_onFetchStart",value:function(e){var t=this,i=e.meta.url,n=e.meta.prefetched,o=(new Date).getTime();Object.keys(e.meta.request.positions).forEach(function(e){t.produceEvent(Ki.createFetchBeginEvent(e,i,n,o))})}},{key:"_onJillFetchTimeout",value:function(e){var t=this,i=e.meta.url;e.meta.positionNames.forEach(function(e){t.produceEvent(Ki.createFetchTimeoutEvent(e,i))})}},{key:"_onJillResponseProcessed",value:function(e){var t=this,i=e.meta.url,n=e.meta.response,o=n.positions,e=n.adServer.requestDuration,s=n.service.timings;s.upstreamDuration=e;var r=d()(this,nn),a=(new qi).getFetchResourceTiming(i);Object.keys(o).forEach(function(e){d()(t,sn)[e]=o[e][0].content.markup,t.produceEvent(Ki.createFetchCompleteEvent({jac:r,positionName:e,url:i,jillTimings:s,positionResponse:o[e][0],requestTimings:a}))})}},{key:"_onPositionRotate",value:function(e){this.produceEvent(Ki.createPositionRotateEvent(e.meta.positionName))}},{key:"_onPositionViewStart",value:function(e){this.produceEvent(Ki.createPositionInViewEvent(e.meta.positionName))}},{key:"_onPositionViewEnd",value:function(e){this.produceEvent(Ki.createPositionOutOfViewEvent(e.meta.positionName))}},{key:"_onPositionRenderStart",value:function(e){this.produceEvent(Ki.createPositionRenderStartEvent(d()(this,nn),e.meta.positionName))}},{key:"_onPositionRenderComplete",value:function(e){this.produceEvent(Ki.createPositionRenderCompleteEvent(d()(this,nn),e.meta.positionName,e.meta.width,e.meta.height))}},{key:"_onAdLoadComplete",value:function(e){this.produceEvent(Ki.createAdLoadCompleteEvent(e.meta.positionName))}},{key:"_onAdSizeChanged",value:function(e){this.produceEvent(Ki.createAdSizeChangedEvent(e.meta.positionName,e.meta.width,e.meta.height))}},{key:"_onPageLoad",value:function(e){this.produceEvent(Ki.createPageLoadEvent(e.meta.timestamp))}},{key:"_onPositionCollapsed",value:function(e){this.produceEvent(Ki.createPositionCollapsedEvent(e.meta.positionName))}},{key:"_onPositionConfigChanged",value:function(e){this.produceEvent(Ki.createPositionConfigChangedEvent(e.meta.positionName,e.meta.config))}},{key:"adHistory",get:function(){return d()(this,sn)}}]),rn);function rn(){a()(this,rn),tn.set(this,{writable:!0,value:void 0}),nn.set(this,{writable:!0,value:void 0}),on.set(this,{writable:!0,value:[]}),sn.set(this,{writable:!0,value:{}})}Object.assign(c.prototype,L);h=c;var an=function(e){v()(s,e);var i,n,o=(i=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=_()(i);return t=n?(e=_()(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),g()(this,t)});function s(e,t){return a()(this,s),(e=o.call(this,e)).meta=t,e}return s}(o);u()(an,"COUNTER","".concat("Collector",".COUNTER")),u()(an,"DURATION","".concat("Collector",".DURATION"));var cn={JacLoadDelay:"JacLoadDelay",FetchDelay:"FetchDelay",FetchTimeoutCount:"FetchTimeoutCount",FetchNetworkDuration:"FetchNetworkDuration",PositionFetchDuration:"PositionFetchDuration",PositionRenderDelay:"PositionRenderDelay",PositionRenderDuration:"PositionRenderDuration",AdLoadDuration:"AdLoadDuration",PositionFetchErrorCount:"PositionFetchErrorCount",PositionAdClosedCount:"PositionAdClosedCount",PositionAdOpenedCount:"PositionAdOpenedCount"},un=[cn.FetchTimeoutCount];function ln(e,t){t=1<arguments.length&&void 0!==t?t:null;return t?"".concat(e,"_").concat(JSON.stringify(t)):e}function hn(e){return e.split("_")[0]}var dn=new WeakMap,fn=new WeakMap,pn=new WeakMap,vn=new WeakMap,mn=new WeakMap,gn=new WeakMap,En=new WeakMap,_n=new WeakMap,yn=new WeakMap,On=new WeakMap,wn=new WeakMap,bn=new WeakMap,Tn=(r()(Pn,[{key:"start",value:function(){var e=d()(this,dn);e._jill.on(Xe.FETCH_START,this._onFetchStart,this),e._jill.on(Xe.FETCH_COMPLETE,this._onJillFetchComplete,this),e.on(ze.FETCH_COMPLETE,this._onFetchComplete,this),e.on(ze.FETCH_TIMEOUT,this._onFetchTimeout,this),e.on(ze.POSITION_RENDER_START,this._onPositionRenderStart,this),e.on(ze.POSITION_RENDER_COMPLETE,this._onPositionRenderComplete,this),e.on(ze.AD_LOAD_COMPLETE,this._onAdLoadComplete,this),e.on(ze.FETCH_ERROR,this._onFetchError,this),e.on(ze.AD_CLOSED,this._onAdClosed,this),e.on(ze.AD_OPENED,this._onAdOpened,this);e={networkType:d()(this,_n)};this.markDurationStart(cn.JacLoadDelay,e,d()(this,yn)),f()(this,On,(new Date).getTime()),this.markDurationEnd(cn.JacLoadDelay,e,d()(this,On))}},{key:"stop",value:function(){var e=d()(this,dn);e._jill.off(Xe.FETCH_START,this._onFetchStart,this),e._jill.off(Xe.FETCH_COMPLETE,this._onJillFetchComplete,this),e.off(ze.FETCH_COMPLETE,this._onFetchComplete,this),e.off(ze.FETCH_TIMEOUT,this._onFetchTimeout,this),e.off(ze.POSITION_RENDER_START,this._onPositionRenderStart,this),e.off(ze.POSITION_RENDER_COMPLETE,this._onPositionRenderComplete,this),e.off(ze.AD_LOAD_COMPLETE,this._onAdLoadComplete,this),e.off(ze.FETCH_ERROR,this._onFetchError,this),e.off(ze.AD_CLOSED,this._onAdClosed,this),e.off(ze.AD_OPENED,this._onAdOpened,this)}},{key:"setActiveMetrics",value:function(e){var t=this;f()(this,wn,{}),e.forEach(function(e){return d()(t,wn)[e]=cn[e]});e=d()(this,dn);d()(this,wn)[cn.FetchDelay]||d()(this,wn)[cn.PositionFetchDuration]||e._jill.off(Xe.FETCH_START,this._onFetchStart,this),d()(this,wn)[cn.FetchNetworkDuration]||e._jill.off(Xe.FETCH_COMPLETE,this._onJillFetchComplete,this),d()(this,wn)[cn.PositionFetchDuration]||d()(this,wn)[cn.PositionRenderDelay]||e.off(ze.FETCH_COMPLETE,this._onFetchComplete,this),d()(this,wn)[cn.FetchTimeoutCount]||e.off(ze.FETCH_TIMEOUT,this._onFetchTimeout,this),d()(this,wn)[cn.PositionRenderDelay]||d()(this,wn)[cn.PositionRenderDuration]||e.off(ze.POSITION_RENDER_START,this._onPositionRenderStart,this),d()(this,wn)[cn.PositionRenderDuration]||d()(this,wn)[cn.AdLoadDuration]||e.off(ze.POSITION_RENDER_COMPLETE,this._onPositionRenderComplete,this),d()(this,wn)[cn.AdLoadDuration]||e.off(ze.AD_LOAD_COMPLETE,this._onAdLoadComplete,this),d()(this,wn)[cn.PositionFetchErrorCount]||e.off(ze.FETCH_ERROR,this._onFetchError,this),d()(this,wn)[cn.PositionAdClosedCount]||e.off(ze.AD_CLOSED,this._onAdClosed,this),d()(this,wn)[cn.PositionAdOpenedCount]||e.off(ze.AD_OPENED,this._onAdOpened,this),this._cleanNonActiveCollectedMetrics()}},{key:"_cleanNonActiveCollectedMetrics",value:function(){var i=this;Object.keys(d()(this,vn)).forEach(function(e){var t=hn(e);d()(i,wn)[t]||delete d()(i,vn)[e]}),Object.keys(d()(this,mn)).forEach(function(e){var t=hn(e);d()(i,wn)[t]||delete d()(i,mn)[e]})}},{key:"durations",get:function(){var i=d()(this,bn)?d()(this,gn):d()(this,vn);return Object.keys(i).reduce(function(e,t){return e.concat(i[t])},[])}},{key:"counters",get:function(){var t=d()(this,bn)?d()(this,En):d()(this,mn);return Object.keys(t).map(function(e){return t[e]})}},{key:"flush",value:function(){d()(this,bn)?(f()(this,gn,{}),f()(this,En,{})):(f()(this,vn,{}),f()(this,mn,{}))}},{key:"markDurationStart",value:function(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;d()(this,wn)[e]&&(n=n||(new Date).getTime(),t=ln(e,i),d()(this,pn)[t]&&console.warn("".concat(t," duration metric already started.")),d()(this,pn)[t]={name:e,startTime:n,dimensions:i})}},{key:"markDurationEnd",value:function(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;d()(this,wn)[e]&&(n=n||(new Date).getTime(),t=ln(e,i),d()(this,pn)[t]?((i=d()(this,pn)[t]).endTime=n,i.duration=parseFloat((i.endTime-i.startTime).toFixed(2)),e=-1!==un.indexOf(e),d()(this,bn)&&e?(d()(this,gn)[t]=d()(this,gn)[t]||[],d()(this,gn)[t].push(i)):(d()(this,vn)[t]=d()(this,vn)[t]||[],d()(this,vn)[t].push(i)),delete d()(this,pn)[t],d()(this,bn)&&!e||this._notifyMetricEvent(new an(an.DURATION,i))):console.error("".concat(t," duration metric not started.")))}},{key:"incrementCounter",value:function(e){var t,i,n,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;d()(this,wn)[e]&&(t=ln(e,o),i=-1!==un.indexOf(e),(o=(n=d()(this,bn)&&i?d()(this,En):d()(this,mn))[t]=n[t]||{name:e,count:0,dimensions:o}).count++,d()(this,bn)&&!i||this._notifyMetricEvent(new an(an.COUNTER,o)))}},{key:"disableBufferMode",value:function(){f()(this,bn,!1)}},{key:"_onFetchStart",value:function(e){var t=this,e=Object.keys(e.meta.request.positions),i=d()(this,_n);d()(this,vn)[cn.FetchDelay]||(this.markDurationStart(cn.FetchDelay,{networkType:i},d()(this,On)),this.markDurationEnd(cn.FetchDelay,{networkType:i})),e.forEach(function(e){t.markDurationStart(cn.PositionFetchDuration,{positionName:e,networkType:i})})}},{key:"_onJillFetchComplete",value:function(e){var t=e.meta.url,e=d()(this,fn).getFetchResourceTiming(t);e&&e.duration&&(t=d()(this,_n),this.markDurationStart(cn.FetchNetworkDuration,{networkType:t},e.startTime),this.markDurationEnd(cn.FetchNetworkDuration,{networkType:t},e.responseEnd))}},{key:"_onFetchComplete",value:function(e){var t=this,e=e.meta.positionNames,i=d()(this,_n);e.forEach(function(e){t.markDurationEnd(cn.PositionFetchDuration,{positionName:e,networkType:i}),t.markDurationStart(cn.PositionRenderDelay,{positionName:e,networkType:i})})}},{key:"_onFetchTimeout",value:function(){this.incrementCounter(cn.FetchTimeoutCount)}},{key:"_onPositionRenderStart",value:function(e){var t=e.meta.positionName,i=d()(this,_n),e=ln(cn.PositionRenderDelay,{positionName:t,networkType:i});d()(this,pn)[e]&&this.markDurationEnd(cn.PositionRenderDelay,{positionName:t,networkType:i}),this.markDurationStart(cn.PositionRenderDuration,{positionName:t,networkType:i})}},{key:"_onPositionRenderComplete",value:function(e){var t=e.meta.positionName,e=d()(this,_n);this.markDurationEnd(cn.PositionRenderDuration,{positionName:t,networkType:e}),this.markDurationStart(cn.AdLoadDuration,{positionName:t,networkType:e})}},{key:"_onAdLoadComplete",value:function(e){var t=e.meta.positionName,e=d()(this,_n);this.markDurationEnd(cn.AdLoadDuration,{positionName:t,networkType:e})}},{key:"_onFetchError",value:function(e){var t=this;e.meta.positionNames.forEach(function(e){t.incrementCounter(cn.PositionFetchErrorCount,{positionName:e})})}},{key:"_onAdClosed",value:function(e){e=e.meta.positionName;this.incrementCounter(cn.PositionAdClosedCount,{positionName:e})}},{key:"_onAdOpened",value:function(e){e=e.meta.positionName;this.incrementCounter(cn.PositionAdOpenedCount,{positionName:e})}},{key:"_notifyMetricEvent",value:function(e){var t=this;setTimeout(function(){t.trigger(e)},0)}}]),Pn);function Pn(e,t){a()(this,Pn),dn.set(this,{writable:!0,value:void 0}),fn.set(this,{writable:!0,value:void 0}),pn.set(this,{writable:!0,value:{}}),vn.set(this,{writable:!0,value:{}}),mn.set(this,{writable:!0,value:{}}),gn.set(this,{writable:!0,value:{}}),En.set(this,{writable:!0,value:{}}),_n.set(this,{writable:!0,value:void 0}),yn.set(this,{writable:!0,value:void 0}),On.set(this,{writable:!0,value:void 0}),wn.set(this,{writable:!0,value:void 0}),bn.set(this,{writable:!0,value:void 0}),f()(this,dn,e),f()(this,fn,t||new qi),f()(this,_n,d()(this,fn).networkType),f()(this,yn,d()(this,fn).responseEnd),f()(this,wn,cn),f()(this,bn,!0)}function Dn(t,e){var i,n=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)),n}function Rn(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Dn(Object(i),!0).forEach(function(e){u()(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Dn(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}Object.assign(Tn.prototype,L);var Cn="undefined"!=typeof $JAC_METRICS_QUEUE_DELAY$?$JAC_METRICS_QUEUE_DELAY$:5e3,An=new WeakMap,Sn=new WeakMap,kn=new WeakMap,In=new WeakMap,Nn=new WeakMap,Mn=new WeakMap,xn=new WeakMap,Ln=(r()(Fn,[{key:"activate",value:function(){var e=this;d()(this,Mn)||(d()(this,An).on(an.COUNTER,this._enqueueReport,this),d()(this,An).on(an.DURATION,this._enqueueReport,this),f()(this,Mn,function(){return e.report()}),d()(this,xn).addEventListener("unload",d()(this,Mn)))}},{key:"deactivate",value:function(){d()(this,Mn)&&(d()(this,An).off(an.COUNTER,this._enqueueReport,this),d()(this,An).off(an.DURATION,this._enqueueReport,this),d()(this,xn).removeEventListener("unload",d()(this,Mn)),f()(this,Mn,null))}},{key:"setGlobalTags",value:function(e){e=e.siteName;f()(this,In,Rn(Rn({},d()(this,In)),{},{siteName:e}))}},{key:"setMetricsHost",value:function(e){f()(this,Sn,"".concat(e).concat("v1/client/m"))}},{key:"report",value:function(){var e=d()(this,An).durations.map(function(e){return{type:"duration",value:e.duration,name:e.name,tags:e.dimensions||void 0}}),t=d()(this,An).counters.map(function(e){return{type:"count",value:e.count,name:e.name,tags:e.dimensions||void 0}}),t=e.concat(t);t.length<=0||(t=JSON.stringify({jacVersion:d()(this,kn),tags:d()(this,In)||void 0,metrics:t}),"function"==typeof d()(this,xn).navigator.sendBeacon?d()(this,xn).navigator.sendBeacon(d()(this,Sn),t):(new(d()(this,xn).Image)).src="".concat(d()(this,Sn),"?data=").concat(encodeURIComponent(t)),d()(this,An).flush())}},{key:"_enqueueReport",value:function(){var e=this;d()(this,Nn)||(f()(this,Nn,!0),setTimeout(function(){e.report(),f()(e,Nn,!1)},Cn))}},{key:"jacVersion",get:function(){return d()(this,kn)}},{key:"collector",get:function(){return d()(this,An)}},{key:"globalTags",get:function(){return d()(this,In)}},{key:"beaconUrl",get:function(){return d()(this,Sn)}}]),Fn);function Fn(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:window;a()(this,Fn),An.set(this,{writable:!0,value:void 0}),Sn.set(this,{writable:!0,value:void 0}),kn.set(this,{writable:!0,value:void 0}),In.set(this,{writable:!0,value:{}}),Nn.set(this,{writable:!0,value:!1}),Mn.set(this,{writable:!0,value:void 0}),xn.set(this,{writable:!0,value:void 0}),f()(this,An,e);var n=i.JAC_CONFIG||{},e=n.service&&n.service.host,n=n.service&&n.service.site&&n.service.site.name;this.setGlobalTags({siteName:n}),this.setMetricsHost(e||"https://jill.fc.yahoo.com/"),f()(this,kn,t.version),f()(this,xn,i)}Object.assign(Ln.prototype,L);var jn=new WeakMap,T=(r()(Un,[{key:"init",value:function(e){this.collector=new Tn(e),this.reporter=new Ln(this.collector,e),this.reporter.activate(),this.collector.start()}},{key:"processJillMetricFlag",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];N.isSet(d()(this,jn))||(f()(this,jn,!1!==e||0<t.length),this.collector&&this.collector.disableBufferMode(),!1===e&&0<t.length&&this.collector.setActiveMetrics(t),this.reporter&&d()(this,jn)&&this.reporter.activate(),this.collector&&!d()(this,jn)&&this.collector.stop())}},{key:"configUpdated",value:function(e){var t=e.service.site&&e.service.site.name;this.reporter.setGlobalTags({siteName:t}),e.service.host&&this.reporter.setMetricsHost(e.service.host)}}]),Un);function Un(){a()(this,Un),u()(this,"collector",void 0),u()(this,"reporter",void 0),jn.set(this,{writable:!0,value:void 0})}function Gn(t,e){var i,n=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)),n}function Wn(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Gn(Object(i),!0).forEach(function(e){u()(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Gn(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var zn=window.JAC_BASE_URL||"https://jac.yahoosandbox.com",Hn=P()("0.7.0")!==S?"0.7.0":"0.0.0";function Vn(e){return"".concat(0<arguments.length&&void 0!==e?e:zn,"/").concat(Hn)}function Bn(e,t){var i=(1<arguments.length&&void 0!==t?t:window).document,t=i.createElement("iframe");t.src=e,te(t,{display:"none",border:"none",width:0,height:0}),i.body.appendChild(t)}r()(Jn,[{key:"injectTrackers",value:function(e){var t=this;!e||e.opus?this._onUserRegulationsResolved(function(){return t._injectOpusTag()}):e&&e.smartPixel&&this._injectSmartPixelTag(),e&&e.msftSync&&((new Image).src="https://cms.analytics.yahoo.com/cms?partner_id=MSFT")}},{key:"_onUserRegulationsResolved",value:function(e){this.userRegulations.resolved?e():(this.userRegulations.on(_i.RESOLVED,e),this.userRegulations.on(_i.READ_TIMEOUT,e),this.userRegulations.on(_i.API_NOT_FOUND,e))}},{key:"_injectOpusTag",value:function(){var e=Ne.removeParameters(this.windowContext.document.referrer);Bn("https://opus.analytics.yahoo.com/tag/opus-frame.html"+"?referrer=".concat(encodeURIComponent(e)),this.windowContext)}},{key:"_injectSmartPixelTag",value:function(){var e=Ne.removeParameters(this.windowContext.document.referrer);Bn("".concat("https://tag.idsync.analytics.yahoo.com/sp-frame.html","?referrer=").concat(encodeURIComponent(e)),this.windowContext)}}]),c=Jn;function Jn(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window;a()(this,Jn),u()(this,"userRegulations",void 0),u()(this,"windowContext",void 0),this.userRegulations=e,this.windowContext=t}var Zn=function(e){v()(o,e);var i,n,t=(i=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=_()(i);return t=n?(e=_()(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),g()(this,t)});function o(){return a()(this,o),t.apply(this,arguments)}return o}(E);u()(Zn,"ACTION_NAME","render");var Xn=P()("0.7.0")!==S?"0.7.0":"0.0.0",Yn={},qn=new t(Xn),Kn=new n,p=new p,$n=new m(Kn,window),Qn=s.getInstance(),eo=new i,h=new h,to=new T,io=new l,no=new c(Qn);function oo(e,t,i){if(!Array.isArray(t)||0===t.length)return console.warn("Invalid array of position names used with JAC.".concat(e,"()")),{result:!1,validPositionNames:[]};var n=t.filter(function(e){return po._config.positions[e]&&(!i||i(e))});return 0===n.length?(console.warn("JAC.".concat(e,"() aborted because there are no valid positions.")),{result:!1,validPositionNames:n}):(n.length!==t.length&&(t=Me.diff(t,n),console.warn("JAC.".concat(e,"() failed for the following positions"),t)),{result:!0,validPositionNames:n})}function so(t){var e;e=function(){var e;e=t,eo.resolved?e():(eo.on(Ui.RESOLVED,e),eo.on(Ui.TIMEOUT,e))},Qn.resolved?e():(Qn.on(_i.RESOLVED,e),Qn.on(_i.READ_TIMEOUT,e),Qn.on(_i.API_NOT_FOUND,e))}function ro(e,t){po.trigger(new ze(e,Object.assign({},t)))}function ao(e){ro(ze.POSITION_CONFIG_CHANGED,{positionName:e.target.name,config:e.meta})}function co(e,t){var i=Object.assign({},t,e.meta),n=e.meta.positionName,t=po._positions[n].render;e.type===ut.RENDER_COMPLETE?(t.completePosition(n),ro(ze.POSITION_RENDER_COMPLETE,i)):e.type===ut.RENDER_FAILED&&(t.abortPosition(n),ro(ze.POSITION_RENDER_FAILED,i)),t.positionNames.length<=0&&(t.end(),ro(ze.RENDER_COMPLETE,{positionNames:t.completedPositionNames}))}function uo(e,t,i){so(function(){e.start(),ro(ze.FETCH_START,{positionNames:e.positionNames}),qn.fetchAds(e,t,i)})}function lo(o,e){e=e.filter(function(e){var t=po._positions[e];if(t){var i=t.config.client[o].auto,n=!!Yn[e],e=t[o]&&t[o].isPending(e);return i&&!e&&n==(o===Zn.ACTION_NAME)}return!1});0<e.length&&po[o](e)}function ho(e){lo(Qe.ACTION_NAME,e)}function fo(e){lo(Zn.ACTION_NAME,e)}var po={_jill:qn,_scheduler:$n,_pageObserver:Kn,_pageProtection:p,_userRegulations:Qn,_userIdentity:eo,_inspectHandler:h,_adRotationFactory:io,_trackersManager:no,_instrumentationController:to,_adData:Yn,_positions:{},_positionComponents:{},_config:null,_onReadyExecuted:!1,_globalConfigProcessed:!1,processQueue:function(){qn.process()},get version(){return Xn},setConfig:function(e){var i=this,t=e;this._config=new Je(e);e=t.service&&t.service.user?t.service.user.regs:void 0;Qn.resolve(window,e),Qn.resolved&&mo(),eo.resolved&&go();var n=this._config.client.positions;n&&(Object.keys(this._positions).filter(function(e){return!n[e]}).forEach(function(e){return i.destroyPosition(e)}),Object.keys(n).forEach(function(e){var t=i._config.positions[e];i._createPosition(e,t)})),to.configUpdated(this._config),po._pageProtection.init(Kn,this,window),function(e){if(e.client&&N.isFunction(e.client.onReady)&&!po._onReadyExecuted){po._globalConfigProcessed&&console.warn("JAC: Support for onReady hook with JAC.setConfig() has been deprecated and will be removed in the future versions. Please move the code from onReady hook to be executed before JAC.setConfig(). Also, setting the onReady hook inside global JAC_CONFIG variable before JAC is loaded still continues to be supported.");var t=e.client.onReady;try{t()}catch(e){console.error("Error while calling JAC_CONFIG.onReady():",e)}po._onReadyExecuted=!0}}(t);t=Object.keys(n);ho(t),this._pageObserver.domLoaded&&fo(t)},getConfig:function(){return this._config?this._config.clone():void 0},createPosition:function(e,t){N.isString(e)?this._config?(this._config.updatePosition(e,t),t=this._config.positions[e],this._createPosition(e,t),ho(t=[e]),this._pageObserver.domLoaded&&fo(t)):console.warn("JAC Config has not been set."):console.warn("Non-string positionName found that is ignored: ".concat(e,"."))},_createPosition:function(e,t){var i=this._positions[e];i?i.update(t):(this._positions[e]=i=new at(e,t),i.on(ot.CONFIG_UPDATE,ao),ro(ze.POSITION_CREATED,{positionName:e}),i.config.client.rotation.enabled&&$n.schedule(i));var n=t.client.content;return n&&n.markup&&(n=(t=(n=t).client.content)&&t.markup?(n.service.sizes=n.service.sizes||["".concat(t.size.width,"x").concat(t.size.height)],{status:1,content:{markup:t.markup,size:Wn(Wn({},t.size),{},{unit:"px"})},clientBaseUrl:Vn(),config:n,meta:{}}):null,i.applyAdData(n),Yn[e]=n),i},_createPositionComponent:function(e){var t=this,i=e.name,n=new ri(e,this._pageObserver),o={positionName:i},s=(e={},u()(e,ut.RENDER_START,function(){ro(ze.POSITION_RENDER_START,o)}),u()(e,ut.RENDER_COMPLETE,function(e){co(e,o)}),u()(e,ut.RENDER_FAILED,function(e){co(e,o)}),u()(e,ut.VIEW_START,function(){ro(ze.POSITION_VIEW_START,o)}),u()(e,ut.VIEW_END,function(){ro(ze.POSITION_VIEW_END,o)}),u()(e,ut.AD_LOAD,function(){ro(ze.AD_LOAD_COMPLETE,o)}),u()(e,ut.NO_AD,function(){ro(ze.POSITION_COLLAPSED,o)}),u()(e,ut.AD_SIZE_CHANGED,function(e){e=Object.assign({},o,e.meta);ro(ze.AD_SIZE_CHANGED,e)}),u()(e,ut.AD_MESSAGE,function(e){e=Object.assign({},o,e.meta);ro(ze.AD_MESSAGE,e)}),u()(e,ut.DESTROY,function(){$n.unsubscribe(n),r("off"),delete t._positionComponents[i]}),u()(e,ut.AD_CLOSED,function(){ro(ze.AD_CLOSED,o)}),u()(e,ut.AD_OPENED,function(){ro(ze.AD_OPENED,o)}),e),r=function(t){return Object.keys(s).forEach(function(e){return n[t](e,s[e])})};return r("on"),$n.subscribe(n),n},destroyPosition:function(e){var t=this._positionComponents[e];t&&t.destroy();t=this._positions[e];t&&(t.off(ot.CONFIG_UPDATE,ao),$n.isManagedPosition(e)&&$n.remove(t),this.abort([e]),this._config.removePosition(e),delete this._positions[e],delete Yn[e])},fetch:function(e){var t,i,o=this;this._config?this._config.isServiceConfigValid()?(e=(t=oo("fetch",e=!N.isSet(e)?Object.keys(this._positions):e,function(e){var t=o._positions[e],i=t.fetch,n=(new Date).getTime(),t=t.config.client.fetch.minInterval;return!i||!(i.isPending(e)||i.endTime+t>n)||(console.warn("JAC.fetch() can only be called "+"once per ".concat(t,"ms for ").concat(e," position.")),!1)})).result,t=t.validPositionNames,e&&(i=new Qe({positionNames:t}),t.forEach(function(e){var t=o._positions[e];t.fetch=i,$n.isManagedPosition(e)&&(e=o._positionComponents[e],$n.restart(t,e))}),uo(i,this._config))):console.warn("JAC Config has missing/invalid information."):console.warn("JAC Config has not been set.")},render:function(e){var t,i,n=this;this._config?(e=(t=oo("render",e=!N.isSet(e)?Object.keys(Yn):e,function(e){var t=n._positions[e];return t&&(e=e,t=t.config,Yn[e]?!!t.getTargetElement()||(console.warn("Target HTML element not found for position ".concat(e,".")),!1):(console.warn("No ad data for position ".concat(e,".")),!1))})).result,t=t.validPositionNames,e&&((i=new Zn({positionNames:t})).start(),t.forEach(function(e){n._positions[e].render=i}),ro(ze.RENDER_START,{positionNames:t}),t.forEach(function(e){var t=n._positions[e];n._positionComponents[e]||(n._positionComponents[e]=n._createPositionComponent(t)),n._positionComponents[e].render(),delete Yn[e]}))):console.warn("JAC Config has not been set.")},abort:function(e){var n=this,t=oo("abort",e=!N.isSet(e)?Object.keys(this._positions):e),e=t.result,t=t.validPositionNames;e&&t.forEach(function(e){var t=n._positions[e],i=t.fetch;i&&i.isPending(e)&&(i.abortPosition(e),t.fetch=null);i=t.render;i&&i.isPending(e)&&(i.abortPosition(e),t.render=null,(e=n._positionComponents[e])&&e.abortRender())})},isPositionPending:function(e){var t=this._positions[e];return!(!t||!(t.fetch&&t.fetch.isPending(e)||t.render&&t.render.isPending(e)))},getPending:function(){var t=this;return Object.keys(this._positions).filter(function(e){return t.isPositionPending(e)})},isPositionFetched:function(e){return!!Yn[e]},getFetched:function(){return Object.keys(Yn)},updateMeta:function(e,t,i,n){var o,s=this;!t||N.isString(t)&&!i?console.warn("Invalid meta was provided."):(e=(o=oo("updateMeta",e,function(e){return s._positionComponents[e]})).result,o=o.validPositionNames,e&&o.forEach(function(e){s._config.updateMeta(e,t,i,n)&&s._positionComponents[e].updateMeta()}))}};function vo(o){Object.keys(o).forEach(function(e){var t,i=o[e],n=po._positions[e];n.applyAdData(i),!n.rotated&&n.config.client.rotation.enabled&&Object.prototype.hasOwnProperty.call(po._config.service.adServer,De["1AS"])&&(t=io.createRotationConfig(n.config,i),n.updateRotationConfig(t)),Yn[e]=i})}function mo(){po._config.setRegulatoryData(Qn),eo.resolve(po._config)}function go(){po._config.setUserIdentity(eo)}Object.assign(po,L);L=po;Object.assign(L,{PageObserver:n,PageEvent:y}),window!==window.top&&"undefined"==typeof JAC_CONFIG?function(e){var t=function(e){var t=e.name;if(!t)throw Error("No data provided for the position sandbox.");e.name="";try{e.frameElement.removeAttribute("name")}catch(e){}try{var i=JSON.parse(t),n=i.token,o=i.adData,s=i.safeFrame}catch(e){throw Error("Invalid data provided for the position sandbox.")}if(!n)throw Error("Missing sandbox token.");if(!o||!o.content)throw Error("Missing sandbox ad data.");if(!o.content.markup)throw Error("Missing sandbox ad markup.");if(!o.content.size||!o.content.size.width||!o.content.size.height)throw Error("Missing sandbox ad size.");if(!o.config||!o.config.service||!o.config.client)throw Error("Missing sandbox position config.");t=o.config.service.sizes,i=t?t.map(function(e){var t=e.split("x"),e=H()(t,2),t=e[0],e=e[1];return{width:parseInt(t),height:parseInt(e)}}):[],t=2!==o.status&&!le.isMobileMomentAd(o)&&(!o.meta||!o.meta.aolSize)&&1<i.length;return{token:n,adMarkup:o.content.markup,size:o.content.size,detectSize:t,allowedSizes:i,positionConfig:o.config,safeFrameData:s}}(e),i=t.token,n=t.adMarkup,o=t.size,s=t.detectSize,r=t.allowedSizes,a=t.positionConfig,c=t.safeFrameData;we=new ee(e.top,i),t=a,e.JAC={version:P()("0.7.0")!==S?"0.7.0":"0.0.0",sandbox:new pe(we,t)};i=a.client.safeFrame;i&&i.enabled&&(t=e,i=a,c=c,we.listen(),t.$sf={ext:new Te(we,i,c)},t.Y={SandBox:{vendor:new Pe(we)}}),w(function(){return ke({positionConfig:a,detectSize:s,initialWidth:o.width,initialHeight:o.height,allowedSizes:r})}),e.document.write("<div>".concat(n,"</div>")),we.send(new V({topic:V.topic.WRITE_COMPLETE}))}(window):(window.JAC=L,L=window,qn.on(Xe.RESPONSE_PROCESSED,function(e){var t=e.meta.response;to.processJillMetricFlag(t.client.metrics,t.client.samplingRateExemptMetrics);var i=e.meta.fetchAction;i.end();var s,r,a,c,i=(e=i.completedPositionNames,s=t,r=po._config,a=s.positions,c=s.client.l10n||{},e.reduce(function(e,t){var i=r.positions[t],n=a[t]?a[t][0]:null;if(!i||!n)return console.warn("Position ".concat(t," is not valid to be processed from the response.")),e;n.config=xe.clone(i),n.config.client.closeButton.labels={close:c.closeAdLabel,show:c.showAdLabel};var o=i.input.client.closeButton||{};xe.copy(i.client.closeButton.labels,n.config.client.closeButton.labels,!0),xe.copy(o.labels||{},n.config.client.closeButton.labels);o=i.service.sizes;if(N.isString(o)){i=s.client.sizeMapping;if(!N.isObject(i)||!i[o])return void console.warn("Position ".concat(t," size mapping lookup failure."));n.config.service.sizes=i[o]}return n.clientBaseUrl=Vn(s.client.url),n.meta=n.meta||{},n.meta.isMobileMoment=le.isMobileMomentAd(n),e[t]=n,e},{})),e=Object.keys(i);vo(i),ro(ze.FETCH_COMPLETE,{positionNames:e,response:{positions:i,adServer:t.adServer,service:t.service}}),Kn.domLoaded&&fo(e)}),qn.on(Xe.FETCH_TIMEOUT,function(e){var t,n,i=(t=e.meta.positionNames,n=po._config,t.reduce(function(e,t){var i=n.positions[t];return i?e[t]={status:3,content:{},clientBaseUrl:Vn(),config:i,meta:{}}:console.warn("Timeout for a non-existing position ".concat(t," received.")),e},{})),t=Object.keys(i);vo(i),ro(ze.FETCH_TIMEOUT,e.meta),Kn.domLoaded&&fo(t)}),qn.on(Xe.FETCH_ERROR,function(e){ro(ze.FETCH_ERROR,e.meta)}),$n.on(hi.ROTATION,function(e){var t=e.meta,i=t.positionName,n=t.size,e=po._positions[i];e.rotated||(e.rotated=!0,e.alias=io.getRotationAliasBasedOnSize(e.adData,n));t=new Qe({positionNames:[i]});e.fetch=t,ro(ze.POSITION_ROTATE,{positionName:i}),uo(t,po._config,{fetchSize:n,allowedSizes:e.adData.config.service.sizes})}),Qn.on(_i.API_NOT_FOUND,mo),Qn.on(_i.RESOLVED,mo),Qn.on(_i.READ_TIMEOUT,mo),Qn.on(_i.UPDATED,mo),eo.on(Ui.RESOLVED,go),eo.on(Ui.TIMEOUT,go),eo.on(Ui.UPDATED,go),h.activate(L,po),to.init(po),L.JAC_CONFIG&&po.setConfig(L.JAC_CONFIG),po._globalConfigProcessed=!0,po.processQueue(),Kn.on(y.DOM_LOADED,function(){fo(Object.keys(po._adData))}),Kn.on(y.LOADED,function(){no.injectTrackers(po._config?po._config.client.trackers:null)}))}]);
