(window.webpackJsonp=window.webpackJsonp||[]).push([[123],{1715:function(e,t,n){"use strict";n.r(t);n(6);var r=n(0);var o=function(e,t,n){n("impression","show_widget"),window.google.accounts.id.initialize({client_id:e,callback:function(e){t(e.credential)},cancel_on_tap_outside:!1}),window.google.accounts.id.prompt()},c=(n(26),n(18));n(7),n(4),n(158);var l,d=function(e){var form=document.createElement("form");form.method="post",form.action="/ab/account-security/sso",Object.entries({id_token:e,state:"?ssoProvider=google"}).forEach((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1],input=document.createElement("input");input.name=n,input.value=r,form.appendChild(input)})),document.body.appendChild(form),form.submit()},f=(n(17),n(10),n(14),n(11),n(1));function h(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function v(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?h(Object(source),!0).forEach((function(t){Object(f.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):h(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var w={methods:{trackEvent:function(e){var t="page"===e.event?["olog"]:["olog","snowplow"];return this.$tracker.track(v(v({},e),{},{trackers:t}))},logEvent:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=v({},e),function(t){return{}.hasOwnProperty.call(e.data||{},t)}("id")&&(r.data.id=t.$store.state.context.user.uid),n.next=5,t.trackEvent(r);case 5:case"end":return n.stop()}}),n)})))()},logImpressionEvent:function(e,t){var n=this;return Object(r.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(l||!t){r.next=4;break}return r.next=3,n.logEvent(t);case 3:l=!0;case 4:return r.next=6,n.logEvent(e);case 6:case"end":return r.stop()}}),r)})))()},extendLogData:function(e,data){return v(v({},e),{},{data:v(v({},e.data||{}),data)})}}},m=n(2),O={mixins:[Object(m.a)(w,void 0,void 0,!1,null,null,null).exports],props:{clientId:{type:String,required:!0}},methods:{authorize:function(e){this.processGoogleOneTapUser(e)},logWidget:function(e,label){this.logEvent({event:e,sublocation:"one_tap_sign_up",label:label})},processGoogleOneTapUser:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.$iovation.bbPromise;case 2:return r=n.sent,n.next=5,t.signUpWithOneTap(e,r);case 5:case"end":return n.stop()}}),n)})))()},signUpWithOneTap:function(e,t){var n=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var o,c,l,f,h,v;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.authorizeWithOneTap(e);case 2:if(o=r.sent,c=o.login,l=o.redirectTo,!c){r.next=19;break}return r.next=8,n.logIn(t,c,e);case 8:if(f=r.sent){r.next=11;break}return r.abrupt("return");case 11:if(h=f.success,v=f.mode,h||"password"!==v){r.next=15;break}return d(e),r.abrupt("return");case 15:n.logWidget("click","existing_user_with_one_tap"),window.location.href="/signup/home/",r.next=20;break;case 19:l&&(n.logWidget("click","new_user_with_one_tap"),window.location.href=l);case 20:case"end":return r.stop()}}),r)})))()},authorizeWithOneTap:function(e){return this.$http({handleApiErrors:!1}).url("/signup/one-tap-redirect-url?credential=".concat(encodeURI(e))).get().json()},logIn:function(e,t,n){var r=this;return this.$http({handleApiErrors:!1}).url("/ab/account-security/login").get().json().then((function(o){var c=o.fields,l=o.redirectUrl;if(!c)return l&&(window.location.href=l),!1;var d={};return d[c.mode]="sso",d[c.iovation]=e,d[c.sso_user_data]={email:t,authResponse:{id_token:n},provider:"google"},r.$http({handleApiErrors:!1}).url("/ab/account-security/login").post(d).json()}))}},head:function(){var e=this;return{script:[{hid:"google-qsi-client",src:"https://accounts.google.com/gsi/client",defer:!0,callback:function(){o(e.clientId,e.authorize,e.logWidget)}}]}}},j=Object(m.a)(O,(function(){var e=this.$createElement;return(this._self._c||e)("div")}),[],!1,null,null,null);t.default=j.exports}}]);