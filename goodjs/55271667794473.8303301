Date.prototype.format=function(e){var t,i={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(t in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[t]:("00"+i[t]).substr((""+i[t]).length)));return e},Date.prototype.formatDateTime=function(){return this.format("yyyy-MM-dd hh:mm:ss")};var ep_setTimeout=window.setTimeout;window.setTimeout=function(e,t){if("function"!=typeof e)return ep_setTimeout(e,t);var i=Array.prototype.slice.call(arguments,2);return ep_setTimeout(function(){e.apply(null,i)},t)};var EPLib={host:"//staticunion.easypass.cn/",ajaxUrl:"//staticunion.easypass.cn/log/ajax/core.ashx",cssUrl:"//staticunion.easypass.cn/style/{0}.css",cookie:{cookieEnabled:!!navigator.cookieEnabled,cookieDomain:"",locationId:"EP_LocationID",sn:"EP_Sn"},_$:function(e){return document.getElementById(e)},enc:function(e){return("function"==typeof encodeURIComponent?encodeURIComponent:escape)(e)},pageY:function(e){return e.offsetParent?e.offsetTop+this.pageY(e.offsetParent):e.offsetTop},loadjs:function(url,callback,charset,id,reset,params){if(reset&&this._$(id)){var jsnode=this._$(id);try{jsnode.parentNode.removeChild(jsnode)}catch(err){}}var s=document.createElement("script");s.type="text/javascript",id&&(s.id=id),charset&&(s.charset=charset),s.readyState?s.onreadystatechange=function(){"loaded"!=s.readyState&&"complete"!=s.readyState||(s.onreadystatechange=null,callback&&"function"==typeof callback&&eval("callback("+params.varName+", params)"))}:s.onload=function(){callback&&"function"==typeof callback&&eval("callback("+params.varName+", params)")},s.src=url,document.getElementsByTagName("head")[0].appendChild(s)},setCookie:function(e,t,i){var o=new Date;return void 0!==i&&null!=i||(i=24),o.setTime(o.getTime()+60*i*60*1e3),document.cookie=e+"= "+escape(t)+";expires= "+o.toGMTString()+";path=/"+(this.cookie.cookieDomain?";domain="+this.cookie.cookieDomain:""),!!this.getCookie(e)},getCookie:function(e){for(var t=document.cookie.split("; "),i=0;i<t.length;i++){var o=t[i].split("=");if(o[0]==e)return unescape(o[1])}return""},newGuid:function(){for(var e="",t=1;t<=32;t++)e+=Math.floor(16*Math.random()).toString(16),8!=t&&12!=t&&16!=t&&20!=t||(e+="-");return e},sys:function(){var e,t={},i=navigator.userAgent.toLowerCase();return(e=i.match(/msie ([\d.]+)/))?t.ie=e[1]:(e=i.match(/firefox\/([\d.]+)/))?t.firefox=e[1]:(e=i.match(/chrome\/([\d.]+)/))?t.chrome=e[1]:(e=i.match(/opera.([\d.]+)/))?t.opera=e[1]:(e=i.match(/version\/([\d.]+).*safari/))&&(t.safari=e[1]),t},detectOS:function(){var e=navigator.userAgent,t="Win32"==navigator.platform||"Windows"==navigator.platform,i="Mac68K"==navigator.platform||"MacPPC"==navigator.platform||"Macintosh"==navigator.platform||"MacIntel"==navigator.platform;if(i)return"Mac";if("X11"==navigator.platform&&!t&&!i)return"Unix";if(-1<String(navigator.platform).indexOf("Linux"))return"Linux";if(t){if(-1<e.indexOf("Windows NT 5.0")||-1<e.indexOf("Windows 2000"))return"Win2000";if(-1<e.indexOf("Windows NT 5.1")||-1<e.indexOf("Windows XP"))return"WinXP";if(-1<e.indexOf("Windows NT 5.2")||-1<e.indexOf("Windows 2003"))return"Win2003";if(-1<e.indexOf("Windows NT 6.0")||-1<e.indexOf("Windows Vista"))return"WinVista";if(-1<e.indexOf("Windows NT 6.1")||-1<e.indexOf("Windows 7"))return"Win7"}return"None"},client:function(){var e=document.location,t=document.referrer,i="",o=window.screen.width,n=window.screen.height,r=this.sys();return r.ie?i="IE"+(r.ie?" "+r.ie:""):r.firefox?i="Firefox":r.chrome?i="Chrome":r.opera?i="Opera":r.safari&&(i="Safari"),{url:e,refer:t,browser:i,screenWidth:o,screenHeight:n,language:navigator.language||navigator.browserLanguage,os:this.detectOS()}},html:function(id,_html){var obj=this._$(id);if(!obj)return"";if(_html){var reg=/<script>.*?<\/script>/gi,exejs=_html.match(reg)+"";return exejs&&""!=exejs?(obj.innerHTML=_html.replace(exejs,""),exejs=exejs.replace(/<script>/g,"").replace(/<\/script>/g,""),""!=exejs&&eval(exejs)):obj.innerHTML=_html,""}return obj.innerHTML},css:function(e,t){},iff:function(e,t){return null==e||""==e||"null"==e||"undefined"==e?t:e},objAttr:function(e,t){for(var i=this._$(e),o={},n=(t=t||"blockid,partner,type,city_type,city_id,city_name,car_type,brandid,serialid,carid,isupdate,generateid,charset,version,rowcount,ver,loadcss").split(","),r=0;r<n.length;r++)o[a=n[r]]="";if(o.blockid="",o.loadcss="1",!e)return o;for(var a,r=0;r<n.length;r++)o[a=n[r]]=this.iff(i.getAttribute(a),"");return o.blockid=e.replace("ep_union_",""),o.loadcss=this.iff(i.getAttribute("loadcss"),"1"),o},setObjAttr:function(e,t,i){void 0!==t&&null!=t&&(e=this._$(e),i=this.iff(i,""),e.setAttribute(t,i))},getSn:function(){var e="0",t=Math.random(),i=this.getCookie(this.cookie.sn);return i&&""!=i?e=i:this.setCookie(this.cookie.sn,t,24)&&(e=t),e}};function EPMonitor(r,a){var n,s,c,u,d,t,l,p,i,h;r&&(n=!0,s=new Date,u=EPLib.sys(),d=0,t="EP-UNION-"+(a=a||newGuid()),l=function(){var e=document.body.clientHeight,t=document.documentElement.clientHeight,i=(document.body.scrollHeight,EPLib._$(r)),o=0,n=EPLib.pageY(i),o=(u.ie||u.firefox?document.documentElement:document.body).scrollTop,i=i.clientHeight;return{pageHeight:e,scrollTop:o,screenHeight:t,setTop:n,domHeight:i,y:t+o,minY:n+10,maxY:n+i+t-10,adViewingHeight:n+i+t}},p={BlockLoadLog:1,BlockShowLog:2,BlockClickLog:3},i=function(){var e=l(),t=e.minY,i=e.maxY,o=e.y;e.setTop,e.domHeight,e.screenHeight,e.scrollTop;return t<=o&&o<=i&&1==d&&(n&&(n=!1,c=new Date,h(p.BlockShowLog,0)),!0)},h=function(e,t){var i,o,n;e&&(n=EPLib.objAttr(r),i=EPLib.client(),(o=[]).push("action=Log"),o.push("ActionFlag="+e),o.push("__BlockClientID="+a),o.push("__BlockID="+n.blockid),o.push("__BlockTypeID="+n.type),o.push("__MediaID="+n.partner),o.push("__LoadTime="+s.formatDateTime()),o.push("__LocationID="+EPLib.getCookie(EPLib.cookie.locationId)),o.push("__Sn="+EPLib.getSn()),c&&o.push("__ShowTime="+c.formatDateTime()),1==e&&(o.push("__Browser="+EPLib.enc(i.browser)),o.push("__Os="+EPLib.enc(i.os)),o.push("__Language="+EPLib.enc(i.language)),o.push("__Screen="+i.screenWidth+"x"+i.screenHeight),o.push("__Referer="+EPLib.enc(i.refer)),o.push("__LocationURL="+EPLib.enc(i.url))),2==e&&(o.push("__Version="+n.ver),o.push("__DataRowCount="+n.rowcount)),o.push("city_type="+n.city_type),o.push("city_id="+n.city_id),o.push("tmp="+Math.round((new Date).getTime()/1e3)),e="ep_jsondata_"+r.replace("-","_"),n="ep-jsid-"+r,e={monitorId:r,varName:e},EPLib.loadjs(EPLib.ajaxUrl+"?"+o.join("&"),function(e,t){},"utf-8",n,1,e))},this.setHandler=function(e){window[t]=e,h(p.BlockLoadLog,0),i()},this.setShowStatus=function(e){1==(d=e)&&i()},this.attachEvent=function(){window[t];u.ie},this.scroll=function(){i()},this.drawing=function(){document.body.style.zoom=1.1,document.body.style.zoom=""})}var EPUnion={init:function(){for(var e=document.getElementsByTagName("ins"),t=0;t<e.length;t++){var i,o,n,r,a,s,c,u,d,l,p,h,f,m,g,_,b=e[t],y=b.getAttribute("id");y&&"ep_union_"==y.substring(0,9)&&(m=EPLib.objAttr(y),i=y.replace("ep_union_",""),o=m.version,n=m.partner,r=m.type,a=m.city_type,s=m.city_id,c=m.city_name,u=m.car_type,d=m.brandid,l=m.serialid,p=m.carid,m.isupdate,g=m.charset,h=m.loadcss,_="ep_jsondata_"+y.replace("-","_"),m=EPLib.newGuid(),b.setAttribute("generateId",m),f=new EPMonitor(y,m),b=[],m=EPLib.cssUrl.replace("{0}",i),b.push("varName="+_),b.push("monitorId="+y),b.push("blockId="+i),b.push("version="+EPLib.iff(o,"")),b.push("partner="+EPLib.iff(n,"")),b.push("type="+EPLib.iff(r,"")),b.push("city_type="+EPLib.iff(a,"")),b.push("city_id="+EPLib.iff(s,"")),b.push("city_name="+EPLib.enc(c||"")),b.push("car_type="+EPLib.iff(u,"")),b.push("brandid="+EPLib.iff(d,"")),b.push("serialid="+EPLib.iff(l,"")),b.push("carid="+EPLib.iff(p,"")),b.push("charset="+EPLib.iff(g,"utf-8")),b.push("tmp="+Math.round((new Date).getTime()/1e3)),g="ep-jsid-"+y,_={monitor:f,monitorId:y,blockId:i,csslink:m,varName:_,qs2:b},"1"!=h&&1!=h||EPLib.css(_.monitorId,_.csslink),EPLib.loadjs(EPLib.host+"block/?"+b.join("&"),function(e,t){1==e.status&&e.html&&(f=t.monitor,y=t.monitorId,e.version&&""!=e.version&&EPLib.setObjAttr(t.monitorId,"ver",e.version),e.rowcount&&""!=e.rowcount&&EPLib.setObjAttr(t.monitorId,"rowcount",e.rowcount),EPLib.html(t.monitorId,e.html),f.setHandler(f),f.attachEvent(),e.reload&&1==e.reload?window.setTimeout(EPUnion.reloadContent,1e3,t):f.setShowStatus(1))},"utf-8",g,1,_))}},log:function(e,t){var i,o,n,r,a,s,c,u,d,l;e&&(i=(l=EPLib.objAttr(e)).generateid,d=l.partner,o=e.replace("ep_union_",""),n=t.ClickRowRefID,r=t.ClickElement,a=t.BlockTypeID,i&&o&&n&&r&&(s=EPLib.getCookie(EPLib.cookie.locationId),c=EPLib.getSn(),(u=[]).push("action=Log"),u.push("actionFlag=3"),u.push("__monitorId="+e),u.push("__BlockClientID="+i),u.push("__BlockID="+o),u.push("__ClickRowRefID="+n),u.push("__ClickElement="+EPLib.enc(r)),u.push("__LocationID="+s),u.push("__Sn="+c),u.push("__BlockTypeID="+a),u.push("__MediaID="+d),u.push("city_type="+l.city_type),u.push("city_id="+l.city_id),d="ep_jsondata_"+e.replace("-","_"),l="ep-jsid-"+e,t={monitorId:e,varName:d},EPLib.loadjs(EPLib.ajaxUrl+"?"+u.join("&"),function(e,t){},"utf-8",l,1,t)))},reloadContent:function(e){var t="ep-jsid-"+e.monitorId,i=e.qs2;i.push("tmp2="+Math.round((new Date).getTime()/1e3)),EPLib.loadjs(EPLib.host+"block/?"+i.join("&"),function(e,t){e.version&&""!=e.version&&EPLib.setObjAttr(t.monitorId,"ver",e.version),e.rowcount&&""!=e.rowcount&&EPLib.setObjAttr(t.monitorId,"rowcount",e.rowcount),1==e.status&&e.html&&EPLib.html(t.monitorId,e.html),monitor=t.monitor,monitor.setShowStatus(1)},"utf-8",t,1,e)}};try{EPUnion.init()}catch(err){}
