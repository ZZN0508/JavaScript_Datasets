!function(D){function r(e){var t=e.data;e.isDefaultPrevented()||(e.preventDefault(),D(this).ajaxSubmit(t))}function n(e){var t=e.target,a=D(t);if(!a.is(":submit,input:image")){if(0===(t=a.closest(":submit")).length)return;t=t[0]}var r=this;"image"==(r.clk=t).type&&(void 0!==e.offsetX?(r.clk_x=e.offsetX,r.clk_y=e.offsetY):"function"==typeof D.fn.offset?(a=a.offset(),r.clk_x=e.pageX-a.left,r.clk_y=e.pageY-a.top):(r.clk_x=e.pageX-t.offsetLeft,r.clk_y=e.pageY-t.offsetTop)),setTimeout(function(){r.clk=r.clk_x=r.clk_y=null},100)}function A(){var e;D.fn.ajaxSubmit.debug&&(e="[jquery.form] "+Array.prototype.join.call(arguments,""),window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e))}var c=void 0!==D("<input type='file'/>").get(0).files,l=void 0!==window.FormData;D.fn.ajaxSubmit=function(s){function e(e){function t(){var e=k.attr("target"),t=k.attr("action");i.setAttribute("target",n),u||i.setAttribute("method","POST"),t!=c.url&&i.setAttribute("action",c.url),c.skipEncodingOverride||u&&!/post/i.test(u)||k.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),c.timeout&&(g=setTimeout(function(){h=!0,l(v)},c.timeout));var a=[];try{if(c.extraData)for(var r in c.extraData)c.extraData.hasOwnProperty(r)&&a.push(D('<input type="hidden" name="'+r+'">').attr("value",c.extraData[r]).appendTo(i)[0]);c.iframeTarget||(m.appendTo("body"),d.attachEvent?d.attachEvent("onload",l):d.addEventListener("load",l,!1)),setTimeout(function e(){try{var t=(d.contentWindow?d.contentWindow.document:d.contentDocument||d.document).readyState;A("state = "+t),t&&"uninitialized"==t.toLowerCase()&&setTimeout(e,50)}catch(e){A("Server abort: ",e," (",e.name,")"),l(x),g&&clearTimeout(g),g=void 0}},15),i.submit()}finally{i.setAttribute("action",t),e?i.setAttribute("target",e):k.removeAttr("target"),D(a).remove()}}function l(t){if(!p.aborted&&!w){try{y=d.contentWindow?d.contentWindow.document:d.contentDocument||d.document}catch(e){A("cannot access response document: ",e),t=x}if(t===v&&p)p.abort("timeout");else if(t==x&&p)p.abort("server abort");else if(y&&y.location.href!=c.iframeSrc||h){d.detachEvent?d.detachEvent("onload",l):d.removeEventListener("load",l,!1);var a,t="success";try{if(h)throw"timeout";var e="xml"==c.dataType||y.XMLDocument||D.isXMLDoc(y);if(A("isXml="+e),!e&&window.opera&&(null===y.body||!y.body.innerHTML)&&--T)return A("requeing onLoad callback, DOM not available"),void setTimeout(l,250);var r=y.body||y.documentElement;p.responseText=r?r.innerHTML:null,p.responseXML=y.XMLDocument||y,e&&(c.dataType="xml"),p.getResponseHeader=function(e){return{"content-type":c.dataType}[e]},r&&(p.status=Number(r.getAttribute("status"))||p.status,p.statusText=r.getAttribute("statusText")||p.statusText);var n,o,i,s=(c.dataType||"").toLowerCase(),u=/(json|script|text)/.test(s);u||c.textarea?(n=y.getElementsByTagName("textarea")[0])?(p.responseText=n.value,p.status=Number(n.getAttribute("status"))||p.status,p.statusText=n.getAttribute("statusText")||p.statusText):u&&(o=y.getElementsByTagName("pre")[0],i=y.getElementsByTagName("body")[0],o?p.responseText=o.textContent||o.innerText:i&&(p.responseText=i.textContent||i.innerText)):"xml"==s&&!p.responseXML&&p.responseText&&(p.responseXML=j(p.responseText));try{b=S(p,s,c)}catch(e){t="parsererror",p.error=a=e||t}}catch(e){A("error caught: ",e),t="error",p.error=a=e||t}p.aborted&&(A("upload aborted"),t=null),"success"===(t=p.status?200<=p.status&&p.status<300||304===p.status?"success":"error":t)?(c.success&&c.success.call(c.context,b,"success",p),f&&D.event.trigger("ajaxSuccess",[p,c])):t&&(void 0===a&&(a=p.statusText),c.error&&c.error.call(c.context,p,t,a),f&&D.event.trigger("ajaxError",[p,c,a])),f&&D.event.trigger("ajaxComplete",[p,c]),f&&!--D.active&&D.event.trigger("ajaxStop"),c.complete&&c.complete.call(c.context,p,t),w=!0,c.timeout&&clearTimeout(g),setTimeout(function(){c.iframeTarget||m.remove(),p.responseXML=null},100)}}}var a,c,f,n,m,d,p,h,g,v,x,b,y,T,w,j,o,S,i=k[0],r=!!D.fn.prop;if(e)if(r)for(a=0;a<e.length;a++)(r=D(i[e[a].name])).prop("disabled",!1);else for(a=0;a<e.length;a++)(r=D(i[e[a].name])).removeAttr("disabled");D(":input[name=submit],:input[id=submit]",i).length?alert('Error: Form elements must not have name or id of "submit".'):((c=D.extend(!0,{},D.ajaxSettings,s)).context=c.context||c,n="jqFormIO"+(new Date).getTime(),c.iframeTarget?(r=(m=D(c.iframeTarget)).attr("name"))?n=r:m.attr("name",n):(m=D('<iframe name="'+n+'" src="'+c.iframeSrc+'" />')).css({position:"absolute",top:"-1000px",left:"-1000px"}),d=m[0],p={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(e){var t="timeout"===e?"timeout":"aborted";A("aborting upload... "+t),this.aborted=1,m.attr("src",c.iframeSrc),p.error=t,c.error&&c.error.call(c.context,p,t,e),f&&D.event.trigger("ajaxError",[p,c,t]),c.complete&&c.complete.call(c.context,p,t)}},(f=c.global)&&0==D.active++&&D.event.trigger("ajaxStart"),f&&D.event.trigger("ajaxSend",[p,c]),c.beforeSend&&!1===c.beforeSend.call(c.context,p,c)?c.global&&D.active--:p.aborted||((e=i.clk)&&(r=e.name)&&!e.disabled&&(c.extraData=c.extraData||{},c.extraData[r]=e.value,"image"==e.type&&(c.extraData[r+".x"]=i.clk_x,c.extraData[r+".y"]=i.clk_y)),v=1,x=2,e=D("meta[name=csrf-token]").attr("content"),(r=D("meta[name=csrf-param]").attr("content"))&&e&&(c.extraData=c.extraData||{},c.extraData[r]=e),c.forceSync?t():setTimeout(t,10),T=50,j=D.parseXML||function(e,t){return window.ActiveXObject?((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:null},o=D.parseJSON||function(e){return window.eval("("+e+")")},S=function(e,t,a){var r=e.getResponseHeader("content-type")||"",n="xml"===t||!t&&0<=r.indexOf("xml"),e=n?e.responseXML:e.responseText;return n&&"parsererror"===e.documentElement.nodeName&&D.error&&D.error("parsererror"),"string"==typeof(e=a&&a.dataFilter?a.dataFilter(e,t):e)&&("json"===t||!t&&0<=r.indexOf("json")?e=o(e):("script"===t||!t&&0<=r.indexOf("javascript"))&&D.globalEval(e)),e}))}if(!this.length)return A("ajaxSubmit: skipping submit process - no element selected"),this;var u,t,k=this;if("function"==typeof s&&(s={success:s}),u=this.attr("method"),(t=(t="string"==typeof(t=this.attr("action"))?D.trim(t):"")||window.location.href||"")&&(t=(t.match(/^([^#]+)/)||[])[1]),s=D.extend(!0,{url:t,success:D.ajaxSettings.success,type:u||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},s),this.trigger("form-pre-serialize",[this,s,t={}]),t.veto)return A("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(s.beforeSerialize&&!1===s.beforeSerialize(this,s))return A("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var a=s.traditional;void 0===a&&(a=D.ajaxSettings.traditional);var r,n=this.formToArray(s.semantic);if(s.data&&(s.extraData=s.data,r=D.param(s.data,a)),s.beforeSubmit&&!1===s.beforeSubmit(n,this,s))return A("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[n,this,s,t]),t.veto)return A("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;t=D.param(n,a),r&&(t=t?t+"&"+r:r),"GET"==s.type.toUpperCase()?(s.url+=(0<=s.url.indexOf("?")?"&":"?")+t,s.data=null):s.data=t;var o,i=[];return s.resetForm&&i.push(function(){k.resetForm()}),s.clearForm&&i.push(function(){k.clearForm(s.includeHidden)}),!s.dataType&&s.target?(o=s.success||function(){},i.push(function(e){var t=s.replaceTarget?"replaceWith":"html";D(s.target)[t](e).each(o,arguments)})):s.success&&i.push(s.success),s.success=function(e,t,a){for(var r=s.context||s,n=0,o=i.length;n<o;n++)i[n].apply(r,[e,t,a||k,k])},r=0<D("input:file:enabled[value]",this).length,t="multipart/form-data"==k.attr("enctype")||"multipart/form-data"==k.attr("encoding"),A("fileAPI :"+(a=c&&l)),!1!==s.iframe&&(s.iframe||(r||t)&&!a)?s.closeKeepAlive?D.get(s.closeKeepAlive,function(){e(n)}):e(n):(r||t)&&a?function(e){for(var a=new FormData,t=0;t<e.length;t++)a.append(e[t].name,e[t].value);if(s.extraData)for(var r in s.extraData)s.extraData.hasOwnProperty(r)&&a.append(r,s.extraData[r]);s.data=null,e=D.extend(!0,{},D.ajaxSettings,s,{contentType:!1,processData:!1,cache:!1,type:"POST"}),s.uploadProgress&&(e.xhr=function(){var e=jQuery.ajaxSettings.xhr();return e.upload&&(e.upload.onprogress=function(e){var t=0;e.lengthComputable&&(t=parseInt(e.position/e.total*100,10)),s.uploadProgress(e,e.position,e.total,t)}),e}),e.data=null;var n=e.beforeSend;e.beforeSend=function(e,t){t.data=a,n&&n.call(t,e,s)},D.ajax(e)}(n):D.ajax(s),this.trigger("form-submit-notify",[this,s]),this},D.fn.ajaxForm=function(e){if((e=e||{}).delegation=e.delegation&&D.isFunction(D.fn.on),e.delegation||0!==this.length)return e.delegation?(D(document).off("submit.form-plugin",this.selector,r).off("click.form-plugin",this.selector,n).on("submit.form-plugin",this.selector,e,r).on("click.form-plugin",this.selector,e,n),this):this.ajaxFormUnbind().bind("submit.form-plugin",e,r).bind("click.form-plugin",e,n);var t=this.selector,a=this.context;return!D.isReady&&t?(A("DOM not ready, queuing ajaxForm"),D(function(){D(t,a).ajaxForm(e)})):A("terminating; zero elements found by selector"+(D.isReady?"":" (DOM not ready)")),this},D.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},D.fn.formToArray=function(e){var t=[];if(0===this.length)return t;var a,r,n,o,i,s,u=this[0],l=e?u.getElementsByTagName("*"):u.elements;if(!l)return t;for(a=0,s=l.length;a<s;a++)if(n=(i=l[a]).name)if(e&&u.clk&&"image"==i.type)i.disabled||u.clk!=i||(t.push({name:n,value:D(i).val(),type:i.type}),t.push({name:n+".x",value:u.clk_x},{name:n+".y",value:u.clk_y}));else if((o=D.fieldValue(i,!0))&&o.constructor==Array)for(r=0,i=o.length;r<i;r++)t.push({name:n,value:o[r]});else if(c&&"file"==i.type&&!i.disabled)for(o=i.files,r=0;r<o.length;r++)t.push({name:n,value:o[r],type:i.type});else null!=o&&t.push({name:n,value:o,type:i.type});return!e&&u.clk&&((n=(l=(e=D(u.clk))[0]).name)&&!l.disabled&&"image"==l.type)&&(t.push({name:n,value:e.val()}),t.push({name:n+".x",value:u.clk_x},{name:n+".y",value:u.clk_y})),t},D.fn.formSerialize=function(e){return D.param(this.formToArray(e))},D.fn.fieldSerialize=function(n){var o=[];return this.each(function(){var e=this.name;if(e){var t=D.fieldValue(this,n);if(t&&t.constructor==Array)for(var a=0,r=t.length;a<r;a++)o.push({name:e,value:t[a]});else null!=t&&o.push({name:this.name,value:t})}}),D.param(o)},D.fn.fieldValue=function(e){for(var t=[],a=0,r=this.length;a<r;a++){var n=D.fieldValue(this[a],e);null==n||n.constructor==Array&&!n.length||(n.constructor==Array?D.merge(t,n):t.push(n))}return t},D.fieldValue=function(e,t){var a=e.name,r=e.type,n=e.tagName.toLowerCase();if((t=void 0===t?!0:t)&&(!a||e.disabled||"reset"==r||"button"==r||("checkbox"==r||"radio"==r)&&!e.checked||("submit"==r||"image"==r)&&e.form&&e.form.clk!=e||"select"==n&&-1==e.selectedIndex))return null;if("select"!=n)return D(e).val();if((i=e.selectedIndex)<0)return null;for(var a=[],n=e.options,o=(r="select-one"==r)?i+1:n.length,i=r?i:0;i<o;i++){var s=n[i];if(s.selected){var u=(u=s.value)||(s.attributes&&s.attributes.value&&!s.attributes.value.specified?s.text:s.value);if(r)return u;a.push(u)}}return a},D.fn.clearForm=function(e){return this.each(function(){D("input,select,textarea",this).clearFields(e)})},D.fn.clearFields=D.fn.clearInputs=function(a){var r=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();r.test(e)||"textarea"==t||a&&/hidden/.test(e)?this.value="":"checkbox"==e||"radio"==e?this.checked=!1:"select"==t&&(this.selectedIndex=-1)})},D.fn.resetForm=function(){return this.each(function(){"function"!=typeof this.reset&&("object"!=typeof this.reset||this.reset.nodeType)||this.reset()})},D.fn.enable=function(e){return void 0===e&&(e=!0),this.each(function(){this.disabled=!e})},D.fn.selected=function(t){return void 0===t&&(t=!0),this.each(function(){var e=this.type;"checkbox"==e||"radio"==e?this.checked=t:"option"==this.tagName.toLowerCase()&&(e=D(this).parent("select"),t&&e[0]&&"select-one"==e[0].type&&e.find("option").selected(!1),this.selected=t)})},D.fn.ajaxSubmit.debug=!1}(jQuery);
