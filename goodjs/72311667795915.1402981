!function(){function g(e){return e&&"[object Array]"===Object.prototype.toString.call(e)}function _(e,t,n){void 0!==t&&("__location"===e?n.push(e+"="+encodeURIComponent(decodeURIComponent(t))):n.push(e+"="+encodeURIComponent(t)))}function r(e){var t=0,n=e.length;e:for(;t<n;t++){var r,o=[],i=e[t],a=w.tag;for(r in i)if(i.hasOwnProperty(r)){if("event"==r&&("gtm.js"==i[r]||"gtm.dom"==i[r]||"gtm.load"==i[r]))continue e;if("__location"!==r&&"__referrer"!==r&&"__title"!==r&&"__keywords"!==r&&"_usertz"!==r){var c=r,d=i[r],s=o;if(g(d))for(var u=0,l=d.length;u<l;u++){var m,f=d[u];for(m in f)f.hasOwnProperty(m)&&_(c+"__"+m,f[m],s)}else _(c,d,s)}}if(0<o.length){for(!1===y.rtgCheck?_("check",!1,o):_("check",!0,o),!0===y.rtgSyncFrame&&(_("response","syncframe",o),a=w.iframe),y.rtgSyncWith&&_("syncwith",y.rtgSyncWith,o),_("__r",c=k.getRandomId(),o),(!0===y.rtgNoSync||k.isTimingRnd(c)&&a===w.tag)&&_("nosync",!0,o),_("__location",i.__location||window.location.href,o),_("__referrer",i.__referrer||document.referrer,o),_("__title",i.__title||document.title,o),s=[],u=0,l=(d=document.getElementsByTagName("meta")).length;u<l;u++)(f=d[u].name)&&"keywords"===f.toLowerCase()&&s.push(d[u].content);if(_("__keywords",d=s.join(","),o),_("_usertz",-(new Date).getTimezoneOffset(),o),v.value&&!i[v.pixelName]&&_(v.pixelName,v.value,o),(i=8e3-(p+o.join("&")).length)<0)for(d=0;d<o.length;d++)if(0===o[d].indexOf("__keywords")){o[d]=o[d].slice(0,i),o[d]=o[d].slice(0,o[d].lastIndexOf("%20"));break}!function e(t,n,r){{var o;document.body?(o=p+t.join("&"),n=h(n,o,r),document.body.insertBefore(n,document.body.firstChild)):setTimeout(function(){e(t)},100)}}(o,a,c)}}e.length=0}function h(e,t,n){var r=document.createElement(e);return r.width=1,r.height=1,r.style.display="none",r.src=t,n&&k.isTimingRnd(n)&&(r.onload=function(){!function(t,e){{var n;window.performance&&window.performance.getEntriesByType&&((n=window.performance.getEntriesByType("resource").find(function(e){return e.name.includes(p)&&e.name.includes("__r="+t)}))&&n.domainLookupStart&&(e=e===w.tag?a.tag:a.iframe,n=encodeURIComponent(["d_"+(n.domainLookupEnd-n.domainLookupStart),"c_"+(n.connectEnd-n.connectStart),"s_"+(n.secureConnectionStart&&n.connectEnd-n.secureConnectionStart||0),"r_"+(n.responseEnd-n.requestStart),"t_"+(n.responseStart-n.requestStart)].join()),e=p+"event=addToSegment&name="+e+"&value="+n+"&nosync=true&__r="+k.getRandomId(),e=h(w.tag,e),document.body.insertBefore(e,document.body.firstChild)))}}(n,e)}),e===w.tag&&(r.alt=""),r}function i(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++)if(e[t].trim().startsWith(v.cookieName+"=")){v.value=e[t].split("=")[1];break}}var p="",y={},o=["rtgNoSync","rtgCheck","rtgSyncFrame","rtgCounter","rtgSyncWith"],w={tag:"img",iframe:"iframe"},a={tag:"_calltime_tag",iframe:"_calltime_syncframe"},v={urlNames:["clickId","advid","rcid"],cookieName:"rutargetVisitorId",pixelName:"vid",value:null},k={getRandomId:function(){return Math.floor(1e20*Math.random())},isTimingRnd:function(e){return e<2e17}};!function(){!function(){if(window._rtgParams)y=window._rtgParams;else for(var e=0;e<o.length;e++){var t=o[e];y[t]=window[t]}}(),p=!0===y.rtgCounter?"https://counter.sberbank.ru/t?":"https://tag.rutarget.ru/tag?",function(){for(var e,t=window.location.search.slice(1).split("&"),n=0;n<t.length;n++)for(var r=0;r<v.urlNames.length;r++)if(t[n].startsWith(v.urlNames[r]+"=")){var o=t[n].split("=")[1];if("clickId"===v.urlNames[r]&&(o=o.split(";").pop()),(e=e||o)!==o)return i()}e?(v.value=e,document.cookie=v.cookieName+"="+v.value+"; path=/"):i()}();var t=window._rutarget;g(t)&&r(t);var n=(t=[]).push;t.push=function(e){n.apply(t,arguments),r(t)},window._rutarget=t}()}();
