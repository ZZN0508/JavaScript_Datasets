window.CQ_Analytics||(window.CQ_Analytics={}),CQ_Analytics.Operator=function(){},CQ_Analytics.Operator.IS="is",CQ_Analytics.Operator.IS_NOT="isNot",CQ_Analytics.Operator.EQUALS="equals",CQ_Analytics.Operator.NOT_EQUAL="notequal",CQ_Analytics.Operator.GREATER="greater",CQ_Analytics.Operator.GREATER_OR_EQUAL="greaterorequal",CQ_Analytics.Operator.OLDER="older",CQ_Analytics.Operator.OLDER_OR_EQUAL="olderorequal",CQ_Analytics.Operator.LESS="less",CQ_Analytics.Operator.LESS_OR_EQUAL="lessorequal",CQ_Analytics.Operator.YOUNGER="younger",CQ_Analytics.Operator.YOUNGER_OR_EQUAL="youngerorequal",CQ_Analytics.Operator.CONTAINS="contains",CQ_Analytics.Operator.BEGINS_WITH="beginswith",CQ_Analytics.OperatorActions=function(){var mapping={},addOperator=function(t,e,i){mapping[t]=[e,i]};addOperator(CQ_Analytics.Operator.EQUALS,"equals","=="),addOperator(CQ_Analytics.Operator.NOT_EQUAL,"is not equal to","!="),addOperator(CQ_Analytics.Operator.GREATER,"is greater than",">"),addOperator(CQ_Analytics.Operator.GREATER_OR_EQUAL,"is equal to or greater than",">="),addOperator(CQ_Analytics.Operator.OLDER,"is older than",">"),addOperator(CQ_Analytics.Operator.OLDER_OR_EQUAL,"is equal to or older than",">="),addOperator(CQ_Analytics.Operator.LESS,"is less than","<"),addOperator(CQ_Analytics.Operator.LESS_OR_EQUAL,"is equal to or less than","<="),addOperator(CQ_Analytics.Operator.YOUNGER,"is younger than","<"),addOperator(CQ_Analytics.Operator.YOUNGER_OR_EQUAL,"is equal to or younger than","<="),addOperator(CQ_Analytics.Operator.CONTAINS,"contains",function(t,e){return!!t&&(!e||(e=""+e,-1!=(t=""+t).toLowerCase().indexOf(e.toLowerCase())))}),addOperator(CQ_Analytics.Operator.IS,"is",function(t,e){return!(!t||!e||(t=""+t,e=""+e,parseInt(t)!=parseInt(e)))}),addOperator(CQ_Analytics.Operator.IS_NOT,"isNot",function(t,e){return!t||!e||(t=""+t,e=""+e,parseInt(t)!=parseInt(e))}),addOperator(CQ_Analytics.Operator.BEGINS_WITH,"begins with",function(t,e){return!!t&&(!e||(e=""+e,0==(t=""+t).toLowerCase().indexOf(e.toLowerCase())))});var getByIndex=function(t,e){return mapping[t]&&mapping[t][e]?mapping[t][e]:""},escapeQuote=function(t){return t=t&&t.replace(new RegExp("\\'","ig"),t)};return{getText:function(t){return getByIndex(t,0)},setText:function(t,e){mapping[t]&&mapping[t][0]&&(mapping[t][0]=e)},getOperation:function(t){return getByIndex(t,1)},operate:function(object,property,operator,value,valueFormat){try{if(object&&object[property]){var toEval="",op=this.getOperation(operator),op=op||operator,objectValue=CQ.shared.XSS.getXSSTablePropertyValue(object,property),s1,s2,toEval;if("function"==typeof op)return op.call(this,objectValue,value,valueFormat);toEval=valueFormat?valueFormat+"('"+objectValue+"') "+op+" "+valueFormat+"('"+value+"')":(s1=escapeQuote(objectValue),s2=escapeQuote(value),"'"+s1+"' "+op+" '"+s2+"'");var b=eval(toEval);return b}}catch(e){}return!1}}}(),CQ_Analytics.Utils=new function(){return{registerDocumentEventHandler:function(t,e){var i=window.document[t];"function"!=typeof window.document[t]?window.document[t]=e:window.document[t]=function(t){i&&i(t),e(t)}},eventWrapper:function(i){return function(t){var e,t=document.all?(e=window.event.keyCode,window.event):(e=void 0!==t.which?t.which:0,t);t&&i(t,e)}},loadElement:function(t,e){$CQ("#"+e).load(t)},loadTeaserElement:function(r,i){var n=$CQ("#"+i).css("height"),t=$CQ("#"+i).height();0<t&&$CQ("#"+i).css("height",t);var e,a=function(t,e){CQ_Analytics.Utils.teasersCache||(CQ_Analytics.Utils.teasersCache={}),CQ_Analytics.Utils.teasersCache[t]=e},s=function(){var t,e;CQ_Analytics.Utils.teasersCache&&CQ_Analytics.Utils.teasersCache[r]?(t=CQ_Analytics.Utils.teasersCache[r])&&""!=t?(e=$CQ(t).css("display","none"),t=$CQ("#"+i)[0],$CQ("#"+i).empty().append(e),t&&t.parentElement&&$CQ(t.parentElement).trigger("target-dom-loaded"),e.fadeIn(function(){n&&"0px"!=n&&$CQ("#"+i).css("height",n)})):n&&"0px"!=n&&$CQ("#"+i).css("height",n):(CQ_Analytics.Utils.teasersLoading=CQ_Analytics.Utils.teasersLoading||{},CQ_Analytics.Utils.teasersLoading[r]?window.setTimeout(function(){CQ_Analytics.Utils.loadTeaserElement(r,i)},100):(CQ_Analytics.Utils.teasersLoading[r]=!0,function(){var t=r,e=location.href;if(typeof CQ_CONTENT_PATH!="undefined")e=CQ_CONTENT_PATH;var i=CQ.shared.HTTP.getParameter(e,"wcmmode");if(i)t+=(t.indexOf("?")>0?"&":"?")+"wcmmode="+i;CQ.shared.HTTP.get(t,function(t,e,i){if(e){var n=i.body;if(n){n=n.replace(new RegExp("\\n","ig"),"");n=n.replace(new RegExp("\\r","ig"),"");a(r,n);delete CQ_Analytics.Utils.teasersLoading[r];s()}}else a(r,"")})}()))},o=$CQ("#"+i).children().length;0<o?(e=0,$CQ("#"+i).children().fadeOut(function(){var t=$CQ(this);window.setTimeout(function(){t.remove(),o<=++e&&s()},50)})):s()},clearElement:function(t){t&&$CQ("#"+t).html("")},indexOf:function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]==e)return i;return-1},load:function(t,e,i){return CQ.shared.HTTP.get(t,e,i)},post:function(t,e,i,n){return CQ.shared.HTTP.post(t,e,i,n)},getPagePath:function(){return CQ.shared.HTTP.getPath()},getPath:function(t){return CQ.shared.HTTP.getPath(t)},addParameter:function(t,e,i){return CQ.shared.HTTP.addParameter(t,e,i)},removeParameters:function(t){return CQ.shared.HTTP.removeParameters(t)},removeAnchor:function(t){return CQ.shared.HTTP.removeAnchor(t)},getSchemeAndAuthority:function(t){return CQ.shared.HTTP.getSchemeAndAuthority(t)},internalize:function(t,e){return CQ.shared.HTTP.internalize(e)},externalize:function(t,e){return CQ.shared.HTTP.externalize(t,e)},encodePathOfURI:function(t){return CQ.shared.HTTP.encodePathOfURI(t)},encodePath:function(t){return CQ.shared.HTTP.encodePath(t)},getContextPath:function(){return CQ.shared.HTTP.getContextPath()},detectContextPath:function(){return CQ.shared.HTTP.detectContextPath()},urlEncode:function(t){if(!t)return"";if("string"==typeof t)return t;var e,i=[];for(e in t){var n=t[e],r=encodeURIComponent(e),a=typeof n;if("undefined"==a)i.push(r,"=&");else if("function"!=a&&"object"!=a)i.push(r,"=",encodeURIComponent(n),"&");else if("array"==typeof n)if(n.length)for(var s=0,o=n.length;s<o;s++)i.push(r,"=",encodeURIComponent(void 0===n[s]?"":n[s]),"&");else i.push(r,"=&")}return i.pop(),i.join("")},getUID:function(){var t=Math.floor(Math.random()*(Math.pow(2,42)-1));return this.getTimestamp().toString(16)+t.toString(16)},getTimestamp:function(){return(new Date).getTime()},insert:function(t,e,i){if(!t||isNaN(e)||!i)return t;for(var n="",r=0,a=e;a<t.length;)n+=t.substring(r,a)+i,r+=e,a+=e;return r<t.length&&(n+=t.substring(r)),n},addListener:function(){return window.addEventListener?function(t,e,i,n){t.addEventListener(e,i,n)}:window.attachEvent?function(t,e,i,n){t.attachEvent("on"+e,i)}:function(){}},removeListener:function(){return window.removeEventListener?function(t,e,i,n){t.removeEventListener(e,i,n)}:window.detachEvent?function(t,e,i){t.detachEvent("on"+e,i)}:function(){}}}},CQ_Analytics.ClickstreamcloudRenderingUtils=new function(){return{createLink:function(t,e,i,n){var r=document.createElement("a");if(r.href=n,r.onclick=e,r.innerHTML=t,i)for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a]);return r},createStaticLink:function(t,e,i){var n=document.createElement("a");return n.href=e,n.innerHTML=t,n.title=i,n.alt=i,n},createNameValue:function(t,e,i,n){var r=document.createElement("span");return r.className=i||"ccl-data",r.innerHTML=t+" = "+e,r.title=n,r.alt=n,r},createText:function(t,e,i){var n=document.createElement("span");return n.className=e||"ccl-data",t&&t.indexOf&&(-1!=t.indexOf("/home")&&-1!=t.indexOf("/image")||-1!=t.indexOf("/")&&-1!=t.indexOf(".png"))?n.innerHTML='<img src="'+t+'.prof.thumbnail.png" border="0">':t&&t.indexOf&&-1!=t.indexOf("www.gravatar.com")?n.innerHTML='<img src="'+t+'">':n.innerHTML=t,n.title=i,n.alt=i,n},createEditablePropertySpan:function(t,e){var i="var editSpan = this.parentNode; var readSpan = this.parentNode.previousSibling;var newValue = this.value;editSpan.style.display = 'none'; readSpan.innerHTML = '"+t+" = '+value; readSpan.style.display = 'block';",n=document.createElement("span");return n.innerHTML="<span class=\"ccl-data\" onclick=\"var editSpan = this.nextSibling; this.style.display = 'none'; editSpan.style.display = 'block';\">"+t+" = "+e+"</span>",n.innerHTML+='<span class="ccl-data" style="display: none;">'+t+' = <input class="ccl-input" type="text" value="'+e+'" onblur="'+i+'"></span>',n.className="ccl-data",n}}};var generateURLSignature=function(t,r,a){var e;t&&t.match(/^https?:\/\/maps\.googleapis\.com\//)?(e=t.replace(/^https?:\/\/[^/]*/,"").replace(/&amp;/g,"&"),$CQ.ajax({url:CQ.shared.HTTP.externalize("/etc/cloudsettings/default/contexthub/geolocation.signature.json"),method:"get",dataType:"json",cache:!1,data:{url:e}}).done(function(t,e,i){var n;i&&i.responseJSON?(n=this.baseURL.replace(/&amp;/g,"&"),n+="&client="+i.responseJSON.client,n+="&channel="+i.responseJSON.channel,n+="&signature="+i.responseJSON.signature,r(n)):"function"==typeof a&&a()}.bind({baseURL:t})).fail(a)):r(t)};function initializeTeaserLoader(y,u,p,h,f,A,_,Q,S){var t;h=!(!CQ.Ext||"true"!=h&&!0!==h),window.CQ_Analytics&&(t=function(){var g="/_jcr_content/par.html";h&&(g+="?wcmmode=disabled");var t=CQ_Analytics.PageDataMgr.getExperience();if(t)return CQ_Analytics.PageDataMgr.clearExperience(),void CQ_Analytics.Utils.loadElement(t+g,p);t=function(){var i=new Array;if(CQ_Analytics.SegmentMgr)for(var t,e=0,n=0;n<y.length;n++)(!y[n].segments||0==y[n].segments.length||!0===CQ_Analytics.SegmentMgr.resolveArray(y[n].segments)&&checkMatch(y[n].segments))&&((t=CQ_Analytics.SegmentMgr.getMaxBoost(y[n].segments))==e?i.push(y[n]):e<t&&((i=new Array).push(y[n]),e=t));var r,a,s,o,l,c,d=null,C=window.videoLength?1e3*window.videoLength:0;0<i.length?"cycling-banner"==u?(i.length,a=1e3*Q,s=1e3*S,(r=0)<_?a=1e3*_:(C=Math.floor(C/i.length),a<C&&(a=C)),window.timeVar=null,window.timeVar=setTimeout(function t(){var e;clearTimeout(window.timeVar),r<i.length?(e=(o=i[r]).path+g,e=CQ.shared.HTTP.addSelectors(e,CQ.shared.HTTP.getSelectors(window.location.href)),CQ_Analytics.Utils.loadTeaserElement(e,p),r++):r=0,window.timeVar=setTimeout(t,a)},s)):(o=i[0],!CQ_Analytics.StrategyMgr||null!=(l=CQ_Analytics.StrategyMgr.choose(u,i))&&(o=l),d&&d.path==o.path||(l=(d=o).path+g,l=CQ.shared.HTTP.addSelectors(l,CQ.shared.HTTP.getSelectors(window.location.href)),CQ_Analytics.Utils.loadTeaserElement(l,p),window.CQ_trackTeasersStats&&f&&(CQ_Analytics.loadedTeasersStack||(CQ_Analytics.loadedTeasersStack=[],$CQ(window).unload(function(){try{var t=CQ_Analytics.loadedTeasersStack;if(t){delete CQ_Analytics.loadedTeasersStack;for(var e=f,i=0;i<t.length;i++)e=CQ.shared.HTTP.addParameter(e,"path",t[i]);CQ.shared.HTTP.get(e,function(){})}}catch(t){}})),CQ_Analytics.loadedTeasersStack.push(o.path)),h&&A&&(c=CQ.WCM.getEditable(A))&&(c.teaserToolTip?(c.teaserToolTip.hide(),c.teaserToolTip.remove(),c.teaserToolTip=null):(c.on(CQ.wcm.EditRollover.EVENT_SHOW_HIGHTLIGHT,function(t){this.teaserInfoButton||(this.teaserInfoButton=CQ.Ext.DomHelper.append("CQ",{tag:"div",cls:"x-tool x-tool-help cq-teaser-tooltip-tool"},!0),this.teaserInfoButton.position("absolute"),this.teaserInfoButton.on("click",function(){c.teaserToolTip||(c.teaserToolTip=new CQ.Ext.Tip({html:function(t){var e="",i=new Array;if(CQ_Analytics.SegmentMgr)for(var n=0,r=0;r<y.length;r++){var a,s,o=CQ.shared.HTTP.externalize(y[r].path+".html");!y[r].segments||0==y[r].segments.length||!0===CQ_Analytics.SegmentMgr.resolveArray(y[r].segments)&&checkMatch(y[r].segments)?(a=CQ_Analytics.SegmentMgr.getMaxBoost(y[r].segments),s=[y[r].title,a,y[r].thumbnail,o],t==y[r].path?e+=CQ.I18n.getMessage('<b><a href="{3}" class="cq-teaser-segment-link"><img src="{2}" class="cq-teaser-decision-thumbnail cq-teaser-decision-match"></a>Experience: {0} - match ( boost = {1} )</b><br>',s):e+=CQ.I18n.getMessage('<a href="{3}" class="cq-teaser-segment-link"><img src="{2}" class="cq-teaser-decision-thumbnail cq-teaser-decision-match"></a>Experience: {0} - match ( boost = {1} )<br>',s),a==n?i.push(y[r]):n<a&&((i=new Array).push(y[r]),n=a)):(s=[y[r].title,y[r].thumbnail,o],e+=CQ.I18n.getMessage('<a href="{2}" class="cq-teaser-segment-link"><img src="{1}" class="cq-teaser-decision-thumbnail cq-teaser-decision-nomatch"></a>Experience: {0} - no match<br>',s))}return e+=CQ.I18n.getMessage("<br>Strategy <b>{0}</b> selected current teaser.<br>",u)}(d.path),title:CQ.I18n.getMessage("Selection decision"),width:450,autoHide:!1,closable:!0,height:300,floating:!0,autoHeight:!1,bodyStyle:"overflow-y: scroll;"}));var t=this.getXY();c.teaserToolTip.setPosition(t[0]-460,t[1]-100),c.teaserToolTip.show()})),this.teaserInfoButton.anchorTo(t.frameBottom.getEl(),"tr",[-26,-15]),this.teaserInfoButton.show()}),c.on(CQ.wcm.EditRollover.EVENT_HIDE_HIGHTLIGHT,function(t){this.teaserInfoButton&&this.teaserInfoButton.hide()}))))):(h&&(c=CQ.WCM.getEditable(A))&&c.teaserToolTip&&(c.teaserToolTip.hide(),c.teaserToolTip.remove(),c.teaserToolTip=null),CQ_Analytics.Utils.clearElement(p),d=null)};t.call(),CQ_Analytics.SegmentMgr&&CQ_Analytics.SegmentMgr.addListener("update",t)},CQ_Analytics.CCM.areStoresInitialized?t.call(this):CQ_Analytics.CCM.addListener("storesinitialize",t))}function checkMatch(t){var e=!0;return t&&0<t.length&&(CQ_Analytics.SegmentMgr.segments[t[0]]||(e=!1)),e}function initializeLandingPageLoader(d,C,g,y,u){var t;y=CQ.Ext&&("true"==y||!0===y),window.CQ_Analytics&&(t=function(){function t(){var t=new Array;if(window.CQ_Analytics&&window.CQ_Analytics.SegmentMgr)for(var e,i=0,n=0;n<d.length;n++)d[n].segments&&0!=d[n].segments.length&&!0!==CQ_Analytics.SegmentMgr.resolveArray(d[n].segments)||((e=CQ_Analytics.SegmentMgr.getMaxBoost(d[n].segments))==i?t.push(d[n]):i<e&&((t=new Array).push(d[n]),i=e));if(0<t.length){var r=t[0];if(window.CQ_Analytics&&window.CQ_Analytics.StrategyMgr&&(null!=(s=CQ_Analytics.StrategyMgr.choose(C,t))&&(r=s)),!c||c.path!=r.path){var a=c;c=r;var s=function(t,e){if(t&&-1!=t.indexOf('id="'+e+'"'))for(var e=t.indexOf('id="'+e+'"'),e=t.substring(0,e).lastIndexOf("<div"),i=(o=t.substring(e)).split(new RegExp("<div","ig")),n=0,r=0;r<i.length;r++){n++;for(var a=i[r].split(new RegExp("</div","ig")),s=1;s<a.length;s++)if(1==--n){var o,l=i[r].lastIndexOf("</div")+6,l=o.indexOf(i[r])+l;return o=(o=o.substring(0,l)).substring(o.indexOf(">")+1,o.lastIndexOf("</div"))}}return""}(s=CQ.shared.HTTP.get(r.path+".html").responseText,g),o=$CQ("#"+g)[0],l=document.createElement("div");l.innerHTML=s,a?($CQ("object",o).parent().fadeOut("slow"),$CQ("img",o).fadeOut("slow"),$CQ(o).slideUp("slow",function(){!function(t){if(y){var e,i=CQ.WCM.getEditables();for(e in i){var n=i[e];t&&-1==n.path.indexOf(t)||(n.hide(),n.remove())}}}(a.path),$CQ(o).children().remove();o.insertBefore(l,o.firstChild);$CQ(o).slideDown("slow",function(){y&&CQ.DOM.executeScripts(CQ.Ext.get(l))})})):(o.insertBefore(l,o.firstChild),$CQ(o).slideDown("slow",function(){y&&CQ.DOM.executeScripts(CQ.Ext.get(l))}));try{window.CQ_trackLandingPagesStats&&u&&(CQ_Analytics.loadedLandingPagesStack||(CQ_Analytics.loadedLandingPagesStack=[],$CQ(window).unload(function(){try{var t=CQ_Analytics.loadedLandingPagesStack;if(t){delete CQ_Analytics.loadedLandingPagesStack;for(var e=u,i=0;i<t.length;i++)e=CQ.shared.HTTP.addParameter(e,"path",t[i]);CQ.shared.HTTP.get(e,function(){})}}catch(t){}})),CQ_Analytics.loadedLandingPagesStack.push(r.path))}catch(t){}}}else CQ_Analytics.Utils.clearElement(g),c=null}var c=null;t.call(),window.CQ_Analytics&&window.CQ_Analytics.SegmentMgr&&CQ_Analytics.SegmentMgr.addListener("update",t)},window.CQ_Analytics&&window.CQ_Analytics.ClickstreamcloudMgr&&(CQ_Analytics.ClickstreamcloudMgr.areStoresLoaded?t.call(this):CQ_Analytics.ClickstreamcloudMgr.addListener("storesloaded",t)))}CQ_Analytics.ClientContextUtils=new function(){return{renderStoreProperty:function(r,e,a,s,o,l){CQ_Analytics&&CQ_Analytics.CCM&&CQ_Analytics.CCM.onReady(function(){CQ_Analytics.ClientContextUtils.onStoreRegistered(e,function(){var t,n=CQ_Analytics.StoreRegistry.getStore(e);!n||!(t=function(){var t,e=n.getProperty(a)||l,i=$CQ("#"+r);i.attr("contenteditable")&&"inherit"!=i.attr("contenteditable")||("string"!=typeof e||(0!=e.indexOf("/")||-1==e.toLowerCase().indexOf(".png")&&-1==e.toLowerCase().indexOf(".jpg")&&-1==e.toLowerCase().indexOf(".gif"))&&0!=e.toLowerCase().indexOf("http")?(e=CQ_Analytics.Variables.replaceVariables(e),e=CQ_Analytics.isUIAvailable?e&&""!=e?s+e+o:CQ.I18n.getMessage("No",null,"Ex: No address, No keywords")+" "+a:e&&""!=e?s+e+o:"No "+a,i.html()!=e&&!1!==n.fireEvent("beforepropertyrender",n,r)&&(i.html(e),n.fireEvent("propertyrender",n,r))):e&&""!=e?(t="",t=0==i.parents(".cq-cc-thumbnail").length||0==e.toLowerCase().indexOf("http")||0==e.indexOf("/libs/wcm/mobile")?e.replace(new RegExp("&amp;","g"),"&"):(t="/etc/clientcontext/shared/thumbnail/content.png",CQ.shared.HTTP.addParameter(t,"path",CQ_Analytics.Variables.replaceVariables(e))),t=CQ_Analytics.Variables.replaceVariables(t),-1===(i.find("div").css("background-image")||"").indexOf(t+")")&&!1!==n.fireEvent("beforepropertyrender",n,r)&&generateURLSignature(CQ.shared.HTTP.externalize(t),function(t){i.html(""),i.children().remove(),$CQ("<div>").addClass("cq-cc-thumbnail-img").css("background-image","url("+t+")").appendTo(i),n.fireEvent("propertyrender",n,r)})):(i.children().remove(),CQ_Analytics.isUIAvailable?i.html(CQ.I18n.getMessage("No",null,"Ex: No address, No keywords")+" "+a):i.html("No "+a)))})!==n.fireEvent("beforeinitialpropertyrender",n,r)&&(t(),n.addListener&&n.addListener("update",function(){t()}),n.fireEvent("initialpropertyrender",n,r))})})},renderStore:function(i,n){CQ_Analytics&&CQ_Analytics.CCM&&i&&n&&CQ_Analytics.CCM.onReady(function(){CQ_Analytics.ClientContextUtils.onStoreRegistered(n,function(){var t,e=CQ_Analytics.StoreRegistry.getStore(n);e&&(e.divId=i,!(t=function(){!1!==e.fireEvent("beforerender",e,e.divId)&&(e.renderer(e,e.divId),e.fireEvent("render",e,e.divId))})!==e.fireEvent("beforeinitialrender",e,i)&&(t(),e.addListener&&e.addListener("update",function(){t()}),e.fireEvent("initialrender",e,i)))})})},storesOptionsProvider:function(){var t,e=[];for(t in CQ_Analytics.StoreRegistry.getStores())e.push({value:t});return e},storePropertiesOptionsProvider:function(t,e){var i=[],n=CQ_Analytics.StoreRegistry.getStore(t);if(n)for(var r=n.getPropertyNames(),a=0;a<r.length;a++){var s,o=r[a];CQ.shared.XSS.KEY_REGEXP.test(o)||(s={value:o},e&&(s.text=o+" - "+n.getProperty(o)),i.push(s))}return i},onStoreRegistered:function(i,n){var t;n&&((t=CQ_Analytics.StoreRegistry.getStore(i))?n.call(t,t):CQ_Analytics.CCM.addListener("storeregister",function(t,e){e.getName()==i&&n.call(e,e)}))},onStoreInitialized:function(i,n,r){!0===r&&(r=CQ_Analytics.ClientContextUtils.DEFAULT_INIT_DELAY);function a(){var t=CQ_Analytics.StoreRegistry.getStore(i);t.DELAYED_INIT_TIMEOUT&&(window.clearTimeout(t.DELAYED_INIT_TIMEOUT),t.DELAYED_INIT_TIMEOUT=null),0<r?t.DELAYED_INIT_TIMEOUT=window.setTimeout(function(){t.DELAYED_INIT_TIMEOUT=null,n.call(t,"initialize",t)},r):n.call(t,"initialize",t)}var t=CQ_Analytics.StoreRegistry.getStore(i);t?t.isInitialized()?(a.call(t),t.addListener("initialize",function(t,e){a.call(e)})):t.addListener("initialize",function(t,e){a.call(e)}):CQ_Analytics.CCM.addListener("storeregister",function(t,e){e.getName()==i&&CQ_Analytics.ClientContextUtils.onStoreInitialized(i,n,r)})},init:function(t,e,i){CQ_Analytics.ClientContextMgr.PATH=t,CQ_Analytics.ClientContextMgr.loadConfig(i,!0),$CQ.ajax({url:CQ.shared.HTTP.externalize(t+"/content/jcr:content/stores.init.js"),cache:!1,async:!0,dataType:"script",data:{path:e}})},initUI:function(t,e,i){CQ_Analytics.ClientContextUI.create(t,e,i)}}},CQ_Analytics.ClientContextUtils.DEFAULT_INIT_DELAY=200,CQ_Analytics.Variables=new function(){return{containsVariable:function(t){return 0<CQ_Analytics.Variables.getVariables(t).length},getVariables:function(t){if(!t||"string"!=typeof t)return[];t=t.match(new RegExp("\\$\\{([\\w/]*)\\}","ig"));return t||[]},replaceVariables:function(t){if(!t)return t;for(var e="",i=t,n=CQ_Analytics.Variables.getVariables(t);0<n.length&&-1==e.indexOf(n.join());){for(var r=0;r<n.length;r++)var a=CQ_Analytics.Variables.getPropertyPath(n[r]),s=CQ_Analytics.ClientContext.get(a)||"",i=CQ_Analytics.Variables.replace(i,a,s);e+=n.join(),n=CQ_Analytics.Variables.getVariables(i)}return i},getPropertyPath:function(t){return!t||t.length<2?null:t.substring(2,t.length-1)},getPropertyName:function(t){t=CQ_Analytics.Variables.getPropertyPath(t);if(t){t=t.split("/");if(3==t.length)return t[2]}return null},getStoreName:function(t){t=CQ_Analytics.Variables.getPropertyPath(t);if(t){t=t.split("/");if(1<t.length)return t[1]}return null},replace:function(t,e,i){return t.replace(new RegExp("\\$\\{"+e+"\\}","ig"),i)}}},CQ_Analytics.SessionPersistence=CQ.shared.ClientSidePersistence,CQ_Analytics.Cookie=CQ.shared.ClientSidePersistence.CookieHelper,CQ_Analytics.Observable=function(){this.fireEvent=function(t){if(t&&this.listeners&&!this.suppressEvents){t=t.toLowerCase();for(var e=Array.prototype.slice.call(arguments,0),i=this.listeners.slice(0),n=0;n<i.length;n++){var r=i[n];if(t==r.event&&!1===r.fireFn.apply(r.scope||this||window,e))return!1}}return!0}},CQ_Analytics.Observable.prototype.addListener=function(t,e,i){this.listeners=this.listeners||new Array,t&&e&&this.listeners.push({event:t.toLowerCase(),fireFn:e,scope:i})},CQ_Analytics.Observable.prototype.removeListener=function(t,e){if(this.listeners=this.listeners||new Array,t&&e)for(var i=0;i<this.listeners.length;i++)this.listeners[i].event==t&&this.listeners[i].fireFn==e&&this.listeners.splice(i,1)},CQ_Analytics.Observable.prototype.setSuppressEvents=function(t){this.suppressEvents=t},CQ_Analytics.Observable.prototype.listeners=null,CQ_Analytics.Observable.prototype.suppressEvents=!1,CQ_Analytics.StoreRegistry||(CQ_Analytics.StoreRegistry=new function(){var e={};return{register:function(t){t.STORENAME&&(e[t.STORENAME]=t)},getStores:function(){return e},getStore:function(t){return e[t]}}}),CQ_Analytics.SessionStore=function(){},CQ_Analytics.SessionStore.prototype=new CQ_Analytics.Observable,CQ_Analytics.SessionStore.prototype.setProperty=function(t,e){null==this.data&&this.init(),this.data[t]=e,this.fireEvent("update",t)},CQ_Analytics.SessionStore.prototype.setProperties=function(t){null==this.data&&this.init();var e,i,n=[];for(e in t)t.hasOwnProperty(e)&&(n.push(e),i=t[e],this.data[e]=i);0<n.length&&this.fireEvent("update",n)},CQ_Analytics.SessionStore.prototype.initialized=!1,CQ_Analytics.SessionStore.prototype.init=function(){this.initialized=!0,this.fireEvent("initialize",this)},CQ_Analytics.SessionStore.prototype.getLabel=function(t){return t},CQ_Analytics.SessionStore.prototype.getLink=function(t){return t},CQ_Analytics.SessionStore.prototype.removeProperty=function(t){null==this.data&&this.init(),this.data[t]&&delete this.data[t],this.fireEvent("update",t)},CQ_Analytics.SessionStore.prototype.getPropertyNames=function(t){null==this.data&&this.init(),t=t||[];var e,i=new Array;for(e in this.data)-1==CQ_Analytics.Utils.indexOf(t,e)&&i.push(e);return i},CQ_Analytics.SessionStore.prototype.getSessionStore=function(){return this},CQ_Analytics.SessionStore.prototype.clear=function(){this.data=null},CQ_Analytics.SessionStore.prototype.getData=function(t){if(null==this.data&&this.init(),t){var e,i={};for(e in this.data)-1==CQ_Analytics.Utils.indexOf(t,e)&&(i[e]=this.data[e]);return i}return this.data},CQ_Analytics.SessionStore.prototype.reset=function(){null!=this.data&&(this.data=null,this.fireEvent("update"))},CQ_Analytics.SessionStore.prototype.getProperty=function(t,e){null==this.data&&this.init();t=this.data[t];return e?t:CQ.shared.XSS.getXSSValue(t)},CQ_Analytics.SessionStore.prototype.getName=function(){return this.STORENAME},CQ_Analytics.SessionStore.prototype.addInitProperty=function(t,e){this.initProperty||(this.initProperty={}),this.initProperty[t]=e},CQ_Analytics.SessionStore.prototype.getInitProperty=function(t){return this.initProperty?this.initProperty[t]:null},CQ_Analytics.SessionStore.prototype.loadInitProperties=function(t,e){if(t)for(var i in t)this.addInitProperty(i,t[i]),e&&this.data&&void 0===this.data[i]&&this.setProperty(i,t[i])},CQ_Analytics.SessionStore.prototype.isInitialized=function(){return this.initialized},CQ_Analytics.PersistedSessionStore=function(){},CQ_Analytics.PersistedSessionStore.prototype=new CQ_Analytics.SessionStore,CQ_Analytics.PersistedSessionStore.prototype.STOREKEY="key",CQ_Analytics.PersistedSessionStore.prototype.setNonPersisted=function(t){this.nonPersisted||(this.nonPersisted={}),this.nonPersisted[t]=!0},CQ_Analytics.PersistedSessionStore.EXCLUDED_PROPERTIES_REGEX="^generated*",CQ_Analytics.PersistedSessionStore.prototype.isPersisted=function(t){return this.nonPersisted||(this.nonPersisted={}),!0!==this.nonPersisted[t]&&!new RegExp(CQ_Analytics.PersistedSessionStore.EXCLUDED_PROPERTIES_REGEX,"ig").test(t)&&!$CQ.isFunction(this.data[t])&&"object"!=typeof this.data[t]},CQ_Analytics.PersistedSessionStore.prototype.getStoreKey=function(){return this.STOREKEY},CQ_Analytics.PersistedSessionStore.prototype.persist=function(){!1!==this.fireEvent("beforepersist")&&(new CQ_Analytics.SessionPersistence({container:"ClientContext"}).set(this.getStoreKey(),this.toString()),this.fireEvent("persist"))},CQ_Analytics.PersistedSessionStore.prototype.setProperty=function(t,e){null==this.data&&this.init(),this.data[t]=e,this.isPersisted(t)&&this.persist(),this.fireEvent("update",t)},CQ_Analytics.PersistedSessionStore.prototype.setProperties=function(t){null==this.data&&this.init();var e,i,n=[],r=!1;for(e in t)t.hasOwnProperty(e)&&(n.push(e),i=t[e],this.data[e]=i,this.isPersisted(e)&&(r=!0));r&&this.persist(),0<n.length&&this.fireEvent("update",n)},CQ_Analytics.PersistedSessionStore.prototype.toString=function(){var t=null;if(this.data)for(var e in this.data)this.isPersisted(e)&&this.data.hasOwnProperty(e)&&(t=null===t?"":t+",",t+=e+"="+function(t){if(!t||"string"!=typeof t)return t;return t=(t=(t=t.replace(new RegExp(",","g"),"&#44;")).replace(new RegExp("=","g"),"&#61;")).replace(new RegExp("\\|","g"),"&#124;")}(this.data[e]));return t},CQ_Analytics.PersistedSessionStore.prototype.parse=function(t){var e,i,n={},r=t.split(",");for(e in r)!r.hasOwnProperty(e)||2==(i=r[e].split("=")).length&&(n[i[0]]=function(t){if(!t||"string"!=typeof t)return t;return t=(t=(t=t.replace(new RegExp("&#44;","g"),",")).replace(new RegExp("&#61;","g"),"=")).replace(new RegExp("&#124;","g"),"|")}(i[1]));return n},CQ_Analytics.PersistedSessionStore.prototype.reset=function(t){null!=this.data&&(this.data={},this.persist(),this.data=null,t||this.fireEvent("update"))},CQ_Analytics.PersistedSessionStore.prototype.removeProperty=function(t){null==this.data&&this.init(),this.data[t]&&(delete this.data[t],this.isPersisted(t)&&this.persist()),this.fireEvent("update",t)},CQ_Analytics.PersistedSessionStore.prototype.clear=function(){new CQ_Analytics.SessionPersistence({container:"ClientContext"}).remove(this.getStoreKey()),this.data=null},CQ_Analytics.ClientContextMgr||(CQ_Analytics.ClientContextMgr=function(){this.clientcontext=null,this.clientcontextToServer=null,this.stores={},this.data=null,this.config=null,this.isConfigLoaded=!1,this.areStoresLoaded=!1},CQ_Analytics.ClientContextMgr.prototype=new CQ_Analytics.PersistedSessionStore,CQ_Analytics.ClientContextMgr.prototype.STOREKEY="CLIENTCONTEXT",CQ_Analytics.ClientContextMgr.prototype.STORENAME="clientcontext",CQ_Analytics.ClientContextMgr.prototype.INITIALIZATION_EVENT_TIMER=1e3,CQ_Analytics.ClientContextMgr.prototype.CONFIG_PATH=CQ_Analytics.Utils.externalize("/etc/clientcontext/legacy/config.json",!0),CQ_Analytics.ClientContextMgr.prototype.init=function(){this.initialized||(this.clientcontext={},this.clientcontextToServer={});var t=new CQ_Analytics.SessionPersistence({container:"ClientContext"}).get(this.getStoreKey());this.data=t?this.parse(t):{},this.initialized=!0,this.fireEvent("initialize",this)},CQ_Analytics.ClientContextMgr.prototype.getSessionId=function(){return this.data.sessionId||this.setSessionId(CQ_Analytics.Utils.getUID()),this.data.sessionId},CQ_Analytics.ClientContextMgr.prototype.setSessionId=function(t){t&&this.setProperty("sessionId",t)},CQ_Analytics.ClientContextMgr.prototype.getVisitorId=function(){return this.data.visitorId},CQ_Analytics.ClientContextMgr.prototype.setVisitorId=function(t){this.setProperty("visitorId",t)},CQ_Analytics.ClientContextMgr.prototype.getId=function(){var t=this.getVisitorId();return t||this.getSessionId()},CQ_Analytics.ClientContextMgr.prototype.isAnonymous=function(){return!this.getVisitorId()},CQ_Analytics.ClientContextMgr.prototype.isMode=function(t){return CQ_Analytics.ClientContextMgr.ServerStorage.isMode(t)},CQ_Analytics.ClientContextMgr.prototype.get=function(t){return null==this.clientcontext&&this.init(),t?this.clientcontextToServer:this.clientcontext},CQ_Analytics.ClientContextMgr.prototype.register=function(t){null==this.clientcontext&&this.init();var e=this;this.clientcontext[t.getName()]=t.getData(),this.stores[t.getName()]=t,CQ_Analytics.StoreRegistry.register(t);var i=this.getStoreConfig(t.getName());!1!==i.stats&&"false"!=i.stats&&(this.clientcontextToServer[t.getName()]=t.getData(i.excludedFromStats)),this.initTimer&&(window.clearTimeout(this.initTimer),this.initTimer=null);i=this.isConfigLoaded&&void 0!==this.config.initializationEventTimer?this.config.initializationEventTimer:this.INITIALIZATION_EVENT_TIMER;this.initTimer=window.setTimeout(function(){e.fireEvent("storesinitialize"),e.areStoresInitialized=!0},i),t.addListener("update",function(){e.update(t)}),CQ_Analytics.ClientContextMgr.ServerStorage.handleStoreRegistration(t),this.addListener("clear",function(){t.clear()}),this.fireEvent("storeregister",t),this.fireEvent("storeupdate",t)},CQ_Analytics.ClientContextMgr.prototype.update=function(t){null==this.clientcontext&&this.init(),this.clientcontext[t.getName()]=t.getData();var e=this.getStoreConfig(t.getName());!1!==e.stats&&"false"!=e.stats&&(this.clientcontextToServer[t.getName()]=t.getData(e.excludedFromStats)),this.fireEvent("storeupdate",t)},CQ_Analytics.ClientContextMgr.prototype.startPosting=function(){return CQ_Analytics.ClientContextMgr.ServerStorage.startPosting()},CQ_Analytics.ClientContextMgr.prototype.stopPosting=function(){return CQ_Analytics.ClientContextMgr.ServerStorage.stopPosting()},CQ_Analytics.ClientContextMgr.prototype.post=function(){return CQ_Analytics.ClientContextMgr.ServerStorage.post()},CQ_Analytics.ClientContextMgr.prototype.getCCMToJCR=function(){return CQ_Analytics.ClientContextMgr.ServerStorage.getCCMToJCR()},CQ_Analytics.ClientContextMgr.prototype.getName=function(){return this.STORENAME},CQ_Analytics.ClientContextMgr.prototype.clear=function(){this.clientcontext=null,this.clientcontextToServer=null,this.fireEvent("clear")},CQ_Analytics.ClientContextMgr.prototype.getRegisteredStore=function(t){return this.stores&&this.stores[t]?this.stores[t]:null},CQ_Analytics.ClientContextMgr.prototype.loadConfig=function(c,autoConfig){var setConfig=function(t,e){t.config=e=void 0===e?{}:e,t.isConfigLoaded=!0,t.fireEvent("configloaded"),t.fireEvent("storesloaded"),t.areStoresLoaded=!0},params,url;c?setConfig(this,c):autoConfig?setConfig(this,{}):(params={},params.path=CQ_Analytics.Utils.getPagePath(),params.cq_ck=(new Date).valueOf(),url=this.CONFIG_PATH,url+="?"+CQ_Analytics.Utils.urlEncode(params),CQ_Analytics.Utils.load(url,function(data,status,response){var config={};try{config=eval("config = "+response.responseText)}catch(error){}setConfig(this,config)},this))},CQ_Analytics.ClientContextMgr.prototype.getConfig=function(){return this.config},CQ_Analytics.ClientContextMgr.prototype.getStoreConfig=function(t){return this.config&&this.config.configs&&this.config.configs[t]&&this.config.configs[t].store?this.config.configs[t].store:{}},CQ_Analytics.ClientContextMgr.prototype.getEditConfig=function(t){return this.config&&this.config.configs&&this.config.configs[t]&&this.config.configs[t].edit?this.config.configs[t].edit:{}},CQ_Analytics.ClientContextMgr.prototype.getUIConfig=function(t){return this.config&&this.config.configs&&this.config.configs[t]&&this.config.configs[t].ui?this.config.configs[t].ui:{}},CQ_Analytics.ClientContextMgr.prototype.getInitialData=function(t){return this.config&&this.config.data&&this.config.data[t]?this.config.data[t]:{}},CQ_Analytics.ClientContextMgr.prototype.getStores=function(){return this.stores},CQ_Analytics.ClientContextMgr.prototype.onReady=function(t,e){t&&(this.areStoresLoaded?t.call(e):this.addListener("storesloaded",t,e))},CQ_Analytics.ClientContextMgr=new CQ_Analytics.ClientContextMgr,CQ_Analytics.CCM=CQ_Analytics.ClientContextMgr,CQ_Analytics.ClickstreamcloudMgr=CQ_Analytics.CCM,CQ_Analytics.ContextCloudMgr=CQ_Analytics.CCM,CQ_Analytics.ClientContextMgr.PATH=null,CQ_Analytics.ClientContextMgr.getClientContextURL=function(t){return CQ_Analytics.ClientContextMgr.PATH+t},window.setTimeout(function(){CQ_Analytics.CCM.init()},1),CQ_Analytics.Utils.addListener(window,"unload",function(){try{for(var t in CQ_Analytics.ClientContextMgr)delete CQ_Analytics.ClientContextMgr[t];CQ_Analytics.ClientContextMgr=null}catch(t){}CQ_Analytics.CCM=null})),window.CQ_Analytics&&window.CQ_Analytics.ClientContextMgr&&!window.CQ_Analytics.ClientContextMgr.ServerStorage&&(CQ_Analytics.ClientContextMgr.ServerStorage=function(){this.posting=!1,this.initialized=!1},CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_MODE_PAGELOAD=1,CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_MODE_TIMER=2,CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_MODE_DATAUPDATE=4,CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_TIMER=600,CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_PROCESS_TIMER=60,CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_MODE=6,CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_PATH="/var/statistics/",CQ_Analytics.ClientContextMgr.ServerStorage.prototype.init=function(){var i;this.isMode(CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_TIMER)&&function(){i.timer=window.setInterval(function(){try{var t=parseInt(i.data.lastPost),e=!1;(isNaN(t)||(new Date).getTime()>t+1e3*CQ_Analytics.ClientContextMgr.ServerStorage.POST_TIMER)&&(e=!0)}catch(t){}e&&i.post()},1e3*CQ_Analytics.ClientContextMgr.ServerStorage.POST_PROCESS_TIMER)}.call(i=this),this.initialized=!0},CQ_Analytics.ClientContextMgr.ServerStorage.prototype.isMode=function(t){return 0<(CQ_Analytics.CCM.POST_MODE&t)},CQ_Analytics.ClientContextMgr.ServerStorage.prototype.handleStoreRegistration=function(t){this.initialized||this.init(),this.isMode(CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_DATAUPDATE)&&t.addListener("persist",function(){CQ_Analytics.ClientContextMgr.ServerStorage.post(t)})},CQ_Analytics.ClientContextMgr.ServerStorage.prototype.startPosting=function(){this.posting=!0},CQ_Analytics.ClientContextMgr.ServerStorage.prototype.stopPosting=function(){this.posting=!1},CQ_Analytics.ClientContextMgr.ServerStorage.prototype.post=function(t,e){if(this.posting||e)try{var i=this.getCCMToJCR(t),n=CQ_Analytics.Utils.getTimestamp();i["./jcr:primaryType"]="nt:unstructured",i["./sessionId"]=CQ_Analytics.CCM.getSessionId();var r=this.POST_PATH+"clientcontext/";CQ_Analytics.CCM.isAnonymous()?r+="anonymous/"+CQ_Analytics.Utils.insert(CQ_Analytics.CCM.getId(),2,"/")+"/"+n:r+="users/"+CQ_Analytics.CCM.getId()+"/"+n,CQ_Analytics.Utils.post(r,null,i),this.lastPost=n}catch(t){}},CQ_Analytics.ClientContextMgr.ServerStorage.prototype.getCCMToJCR=function(t){var e,i=CQ_Analytics.CCM.get(!0),n={};for(e in i)if(!t||e==t){var r=i[e];encodeURIComponent(e);if("object"==typeof r)for(var a in r){var s=r[a];n["./"+e+"/./"+(a=a.replace(":","/"))]=s}else n["./"+e]=r}return n},CQ_Analytics.ClientContextMgr.ServerStorage=new CQ_Analytics.ClientContextMgr.ServerStorage,CQ_Analytics.ClickstreamcloudMgr.POST_MODE_PAGELOAD=CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_PAGELOAD,CQ_Analytics.ClickstreamcloudMgr.POST_MODE_TIMER=CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_TIMER,CQ_Analytics.ClickstreamcloudMgr.POST_MODE_DATAUPDATE=CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_DATAUPDATE,CQ_Analytics.ClickstreamcloudMgr.POST_TIMER=CQ_Analytics.ClientContextMgr.ServerStorage.POST_PROCESS_TIMER,CQ_Analytics.ClickstreamcloudMgr.POST_PROCESS_TIMER=CQ_Analytics.ClientContextMgr.ServerStorage.POST_PROCESS_TIMER,CQ_Analytics.ClickstreamcloudMgr.POST_MODE=CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE,CQ_Analytics.ClickstreamcloudMgr.POST_PATH=CQ_Analytics.ClientContextMgr.ServerStorage.POST_PATH),CQ_Analytics.Percentile={},CQ_Analytics.Percentile.matchesPercentiles=function(t){var e=ClientContext.get("/surferinfo/percentile");e?e=Number(e):(e=Math.round(100*Math.random()),ClientContext.set("/surferinfo/percentile",e));for(var i=0;i<t.length;i++){var n=t[i];if(Number(n.start)<=e&&e<Number(n.end))return!0}return!1},CQ_Analytics.SegmentMgr||(CQ_Analytics.SegmentMgr=function(){this.SEGMENTATION_ROOT="/etc/segmentation",this.SEGMENT_SELECTOR=".segment.js",this.SEGMENTATION_SCRIPT_LOADER="cq-segmentation-loader",this.segments={},this.boosts={};var t=this;this.fireUpdate=function(){t.fireEvent("update")},this.init()},CQ_Analytics.SegmentMgr.prototype=new CQ_Analytics.SessionStore,CQ_Analytics.SegmentMgr.prototype.STORENAME="segments",CQ_Analytics.SegmentMgr.prototype.register=function(t,e,i){this.segments[t]=e,this.rulesCache&&this.rulesCache[t]&&(this.rulesCache[t]=!1),this.boosts[t]=isNaN(i)?0:parseInt(i),this.fireUpdate()},CQ_Analytics.SegmentMgr.prototype.resolveArray=function(t,e,i){if(e=e||CQ_Analytics.ClientContextMgr.get(),!(t instanceof Array))return this.resolve(t,e);for(var n="AND"==(i="AND"==i?"AND":"OR"),r=0;r<t.length;r++){var a=t[r],a=this.resolve(a,e);if("AND"==i){if(!0!==a)return a}else if(!0===a)return!0}return n},CQ_Analytics.SegmentMgr.prototype.resolve=function(segmentPath,clientcontext){if(clientcontext=clientcontext||CQ_Analytics.ClientContextMgr.get(),!segmentPath)return!1;if(segmentPath instanceof Array)return this.resolveArray(segmentPath,clientcontext);if(0!=segmentPath.indexOf(this.SEGMENTATION_ROOT))return!1;if(segmentPath==this.SEGMENTATION_ROOT)return!0;if(!this.segments[segmentPath])return!0;var parent=segmentPath.substring(0,segmentPath.lastIndexOf("/"));if(0==parent.indexOf(this.SEGMENTATION_ROOT)){var pres=this.resolve(parent,clientcontext);if(!0!==pres)return pres}var rules="function(clientcontext, contextcloud, clickstreamcloud) { return true ";rules+=" && ( "+this.segments[segmentPath]+" ) ",rules+=";}";var res=!0;try{var f=null;this.rulesCache=this.rulesCache||{},this.rulesCache[segmentPath]?f=this.rulesCache[segmentPath]:(eval("f = "+rules),this.rulesCache[segmentPath]=f);var e=null==f||f(clientcontext,clientcontext,clientcontext),res=res&&!0===e}catch(error){return"Unresolved - Error while evaluating segment "+segmentPath+" : "+error.message}return res},CQ_Analytics.SegmentMgr.prototype.getResolved=function(t){t=t||CQ_Analytics.ClientContextMgr.get();var e,i=new Array;for(e in this.segments)!0===this.resolve(e,t)&&i.push(e);return i},CQ_Analytics.SegmentMgr.prototype.getMaxBoost=function(t,e){if(!(t instanceof Array))return this.getBoost(t);for(var i=0,n=0;n<t.length;n++){var r=t[n];!0!==this.resolve(r,e)||i<(r=this.boosts[r]||0)&&(i=r)}return i},CQ_Analytics.SegmentMgr.prototype.getBoost=function(t){return t instanceof Array||(t=[t]),this.boosts[t]||0},CQ_Analytics.SegmentMgr.prototype.reload=function(path){var url=path,url=url||this.SEGMENTATION_ROOT;if(url){-1==url.indexOf(this.SEGMENT_SELECTOR)&&(url+=this.SEGMENT_SELECTOR);try{url+=(-1===url.indexOf("?")?"?":"&")+"_="+(new Date).getTime(),CQ_Analytics.Utils.load(url,function(config,status,response){response&&response.responseText&&eval(response.responseText)},this);var response=CQ.HTTP.get(scripts[i].src)}catch(err){}}},CQ_Analytics.SegmentMgr.prototype.getSessionStore=function(){return this},CQ_Analytics.SegmentMgr.prototype.getProperty=function(t){return t},CQ_Analytics.SegmentMgr.prototype.getLink=function(t){return t+".html"},CQ_Analytics.SegmentMgr.prototype.getLabel=function(t){if(t){var e=t,i=e.lastIndexOf("/");-1!=i&&(e=e.substring(i+1,e.length));i=this.resolve(t);if(!0===i)return e;if(!0!==i)return'<span class="invalid" title="'+i+'" alt="'+i+'">'+e+"</span>"}return t},CQ_Analytics.SegmentMgr.prototype.getPropertyNames=function(){return this.getResolved()},CQ_Analytics.SegmentMgr=new CQ_Analytics.SegmentMgr,CQ_Analytics.SegmentMgr.loadSegments=function(t){CQ_Analytics.SegmentMgr.areSegmentsLoaded=!1,t&&0!==t.length?$CQ.ajax({url:CQ.shared.HTTP.externalize(t+this.SEGMENT_SELECTOR),dataType:"script",async:!0,cache:!0}).complete(function(){CQ_Analytics.SegmentMgr.areSegmentsLoaded=!0,CQ_Analytics.SegmentMgr.fireEvent("segmentsload")}):(CQ_Analytics.SegmentMgr.areSegmentsLoaded=!0,CQ_Analytics.SegmentMgr.fireEvent("segmentsload"))},CQ_Analytics.SegmentMgr.renderer=function(t,e){if(t&&t.STORENAME==CQ_Analytics.SegmentMgr.STORENAME){var i=t.getPropertyNames(),n=[];n.push("<div>");for(var r=0;r<i.length;r++){var a=i[r];n.push('<span title="'+t.getProperty(a)+'" ><a href="'+CQ.shared.HTTP.externalize(t.getLink(a))+'"  title="'+t.getProperty(a)+'" >'+t.getLabel(a)+"</a></span>")}n.push("</div>"),$CQ("#"+e).children().remove(),$CQ("#"+e).append(n.join(""))}},CQ_Analytics.ClientContextMgr.addListener("storeupdate",CQ_Analytics.SegmentMgr.fireUpdate),CQ_Analytics.Utils.addListener(window,"unload",function(){try{for(var t in CQ_Analytics.SegmentMgr)delete CQ_Analytics.SegmentMgr[t]}catch(t){}CQ_Analytics.SegmentMgr=null})),CQ_Analytics.StrategyMgr||(CQ_Analytics.StrategyMgr=function(){this.strategies={}},CQ_Analytics.StrategyMgr.prototype={},CQ_Analytics.StrategyMgr.prototype.isRegistered=function(t){return!!this.strategies[t]},CQ_Analytics.StrategyMgr.prototype.register=function(t,e){"function"==typeof e&&(this.strategies[t]=e)},CQ_Analytics.StrategyMgr.prototype.choose=function(t,e){return 1==e.length?e[0]:this.strategies[t]?this.strategies[t].call(this,e):null},CQ_Analytics.StrategyMgr=new CQ_Analytics.StrategyMgr),CQ_Analytics.StrategyMgr.register("clickstream-score",function(t){if(1==t.length)return t[0];var e=[];if(window.CQ_Analytics&&window.CQ_Analytics.TagCloudMgr)for(var i=(i=CQ_Analytics.TagCloudMgr.getTags())||{},n=-1,r=0;r<t.length;r++){var a=0,s=t[r].tags;if(s)for(var o=0;o<s.length;o++){var l=s[o].tagID;a+=parseInt(i[l])||0}a==n?e.push(t[r]):n<a&&((e=[]).push(t[r]),n=a)}else e=t;if(1==e.length)return e[0];var c=null,c=(c=(c=window.CQ_Analytics&&window.CQ_Analytics.PageDataMgr?CQ_Analytics.PageDataMgr.getProperty("random"):c)||window.CQ_StrategyRandom)||(window.CQ_StrategyRandom=Math.random());return 1<parseFloat(c)&&(c=1/c),1==parseFloat(c)&&(c=0),e[Math.floor(c*e.length)]}),CQ_Analytics.StrategyMgr.register("first",function(t){return t[0]}),CQ_Analytics.StrategyMgr.register("random",function(t){var e=null,e=(e=(e=window.CQ_Analytics&&window.CQ_Analytics.PageDataMgr?CQ_Analytics.PageDataMgr.getProperty("random"):e)||window.CQ_StrategyRandom)||(window.CQ_StrategyRandom=Math.random());return 1<parseFloat(e)&&(e=1/e),1==parseFloat(e)&&(e=0),t[Math.floor(e*t.length)]}),CQ_Analytics.PageDataMgr||(CQ_Analytics.PageDataMgr=function(){},CQ_Analytics.PageDataMgr.prototype=new CQ_Analytics.SessionStore,CQ_Analytics.PageDataMgr.prototype.STORENAME="pagedata",CQ_Analytics.PageDataMgr.prototype.FORCE_EXPERIENCE_COOKIE="cq-forceexperience",CQ_Analytics.PageDataMgr.prototype.init=function(){for(var t in this.data={},this.initProperty)this.data[t]=this.initProperty[t];this.initialized=!0,this.fireEvent("initialize",this),this.fireEvent("update")},CQ_Analytics.PageDataMgr.prototype.getLabel=function(t){return t},CQ_Analytics.PageDataMgr.prototype.getLink=function(t){return""},CQ_Analytics.PageDataMgr.prototype.setExperience=function(t){CQ.shared.HTTP.setCookie(CQ_Analytics.PageDataMgr.FORCE_EXPERIENCE_COOKIE,t,"/")},CQ_Analytics.PageDataMgr.prototype.getExperience=function(){return CQ.shared.HTTP.getCookie(CQ_Analytics.PageDataMgr.FORCE_EXPERIENCE_COOKIE,"/")},CQ_Analytics.PageDataMgr.prototype.clearExperience=function(){CQ.shared.HTTP.clearCookie(CQ_Analytics.PageDataMgr.FORCE_EXPERIENCE_COOKIE,"/")},CQ_Analytics.PageDataMgr=new CQ_Analytics.PageDataMgr,CQ_Analytics.CCM.addListener("configloaded",function(){this.loadInitProperties(CQ_Analytics.CCM.getInitialData(this.getName())),this.init(),CQ_Analytics.CCM.register(this)},CQ_Analytics.PageDataMgr)),CQ_Analytics.BrowserInfo=function(){var i=navigator.userAgent.toLowerCase(),n=function(t){return t.test(i)},t=function(){if(n(/opera/))return{browserFamily:"Opera",browserVersion:""};if(n(/trident/)){var t="";return{browserFamily:"IE",browserVersion:t=(e=i.match(/trident\/([0-9\.]*)/))&&1<e.length?{"7.0":"11","6.0":"10","5.0":"9","4.0":"8"}[e[1]]:t}}if(n(/edge/)){var e,t="";return{browserFamily:"Edge",browserVersion:t=(e=i.match(/edge\/([0-9]*)/))&&1<e.length?e[1]:t}}return n(/chrome/)?{browserFamily:"Chrome",browserVersion:""}:n(/safari/)?n(/applewebkit\/4/)?{browserFamily:"Safari",browserVersion:"2"}:n(/version\/3/)?{browserFamily:"Safari",browserVersion:"3"}:n(/version\/4/)?{browserFamily:"Safari",browserVersion:"4"}:n(/version\/5/)?{browserFamily:"Safari",browserVersion:"5"}:n(/version\/6/)?{browserFamily:"Safari",browserVersion:"6"}:{browserFamily:"Safari",browserVersion:"7 or higher"}:n(/webkit/)?{browserFamily:"WebKit",browserVersion:""}:n(/msie/)?n(/msie 6/)?{browserFamily:"IE",browserVersion:"6"}:n(/msie 7/)?{browserFamily:"IE",browserVersion:"7"}:n(/msie 8/)?{browserFamily:"IE",browserVersion:"8"}:n(/msie 9/)?{browserFamily:"IE",browserVersion:"9"}:n(/msie 10/)?{browserFamily:"IE",browserVersion:"10"}:{browserFamily:"IE",browserVersion:"11 or higher"}:n(/gecko/)?n(/rv:1\.8/)?{browserFamily:"Firefox",browserVersion:"2"}:n(/rv:1\.9/)?{browserFamily:"Firefox",browserVersion:"3"}:n(/rv:2.0/)?{browserFamily:"Firefox",browserVersion:"4"}:n(/rv:5./)?{browserFamily:"Firefox",browserVersion:"5"}:n(/rv:6./)?{browserFamily:"Firefox",browserVersion:"6"}:n(/rv:7./)?{browserFamily:"Firefox",browserVersion:"7"}:n(/rv:8./)?{browserFamily:"Firefox",browserVersion:"8"}:n(/rv:9./)?{browserFamily:"Firefox",browserVersion:"9"}:{browserFamily:"Firefox",browserVersion:"10 or higher"}:n(/adobeair/)?{browserFamily:"Adobe AIR",browserVersion:""}:{browserFamily:"Unresolved",browserVersion:"Unresolved"}}.call();this.browserFamily=t.browserFamily,this.browserVersion=t.browserVersion,this.OSName=function(){return n(/windows 98|win98/)?"Windows 98":n(/windows nt 5.0|windows 2000/)?"Windows 2000":n(/windows nt 5.1|windows xp/)?"Windows XP":n(/windows nt 5.2/)?"Windows Server 2003":n(/windows nt 6.0/)?"Windows Vista":n(/windows nt 6.1/)?"Windows 7":n(/windows nt 6.2/)?"Windows 8":n(/windows nt 6.3/)?"Windows 8.1":n(/windows nt 10.0/)?"Windows 10":n(/windows nt 4.0|winnt4.0|winnt/)?"Windows NT 4.0":n(/windows me/)?"Windows ME":n(/mac os x/)?n(/ipad/)||n(/iphone/)?"iOS":"Mac OS X":n(/macintosh|mac os/)?"Mac OS":n(/android/)?"Android":n(/linux/)?"Linux":"Unresolved"}.call(),this.deviceType=function(){return n(/ipad/)?"iPad":n(/iphone/)?"iPhone":n(/mobi/)?"Mobile":"Desktop"}.call(),this.ua=i;/^https/i.test(window.location.protocol);this.screenResolution=screen.width+"x"+screen.height},CQ_Analytics.BrowserInfo.prototype={getBrowserName:function(){return this.browserFamily+" "+this.browserVersion},getBrowserFamily:function(){return this.browserFamily},getBrowserVersion:function(){return this.browserVersion},getOSName:function(){return this.OSName},getScreenResolution:function(){return this.screenResolution},getDeviceType:function(){return this.deviceType},getUserAgent:function(){return this.ua},isMobile:function(t){return"desktop"!=(t=(t=t||this.getDeviceType())?t.toLowerCase():"desktop")},isIE:function(t){return"IE"==this.getBrowserFamily()&&(!t||this.getBrowserVersion()==t)},isIE6:function(){return this.isIE("6")},isIE7:function(){return this.isIE("7")},isIE8:function(){return this.isIE("8")},isIE9:function(){return this.isIE("9")}},CQ_Analytics.BrowserInfoInstance=new CQ_Analytics.BrowserInfo,MousePositionMgr=null,CQ_Analytics.EventDataMgr||(CQ_Analytics.EventDataMgr=function(){},CQ_Analytics.EventDataMgr.prototype=new CQ_Analytics.SessionStore,CQ_Analytics.EventDataMgr.prototype.STORENAME="eventdata",CQ_Analytics.EventDataMgr.prototype.init=function(){for(var t in this.data={},this.initProperty)this.data[t]=this.initProperty[t];this.initialized=!0,this.fireEvent("initialize",this),void 0!==this.initProperty&&this.fireEvent("update")},CQ_Analytics.EventDataMgr.prototype.getLabel=function(t){return t},CQ_Analytics.EventDataMgr.prototype.getLink=function(t){return""},CQ_Analytics.EventDataMgr=new CQ_Analytics.EventDataMgr,CQ_Analytics.EventDataMgr.init(),CQ_Analytics.CCM.register(CQ_Analytics.EventDataMgr)),window.CQ_Context||(window.CQ_Context=function(){},window.CQ_Context.prototype=new CQ_Analytics.Observable,window.CQ_Context.prototype.getProfile=function(){return{getUserId:function(){return this.getProperty("authorizableId")},getDisplayName:function(){var t=this.getProperty("formattedName");return t||((t=this.getProperty("displayName"))?t:this.getUserId())},getFirstname:function(){return this.getProperty("givenName")},getLastname:function(){return this.getProperty("familyName")},getEmail:function(){return this.getProperty("email")},getProperty:function(t){return window.CQ_Analytics&&window.CQ_Analytics.ProfileDataMgr?CQ_Analytics.ProfileDataMgr.getProperty(t):""},getProperties:function(){return window.CQ_Analytics&&window.CQ_Analytics.ProfileDataMgr?CQ_Analytics.ProfileDataMgr.getData():{}},getAvatar:function(){return this.getProperty("avatar")},onUpdate:function(t,e){t&&CQ_Analytics&&CQ_Analytics.ProfileDataMgr&&CQ_Analytics.ProfileDataMgr.addListener("update",t,e||this)}}},window.CQ_Context=new window.CQ_Context),CQ_Analytics.Engine=function(){function Q(){return window.CQ&&CQ.WCM&&CQ.WCM.isEditMode()}function S(t,i,n,r){t.done(function(e){e.teaserToolTip&&(e.teaserToolTip.hide(),e.teaserToolTip.remove()),e.teaserToolTip=new CQ.Ext.Tip({html:function(t,e,i){var n="";function r(t,e,i,n){return'<a href="'+e+'" class="cq-teaser-segment-link"><img src="'+i+'" class="cq-teaser-decision-thumbnail '+(n?"cq-teaser-decision-match":"cq-teaser-decision-nomatch")+'"></a>'+t+"<br>"}for(var a=0;a<t.length;a++){var s,o=t[a],l=CQ.shared.HTTP.externalize(o.teaser.path+".html");o.hasOwnProperty("boost")?(s=r(o.noSegment?CQ.I18n.getMessage("Experience: {0} - match (no segments, boost = {1})",[o.teaser.title,o.boost]):CQ.I18n.getMessage("Experience: {0} - match (boost = {1})",[o.teaser.title,o.boost]),l,o.teaser.thumbnail,!0),e===o.teaser.path?n+="<b>"+s+"</b>":n+=s):n+=r(o.unknownSegment?CQ.I18n.getMessage("Experience: {0} - no match (unknown segment)",[o.teaser.title]):CQ.I18n.getMessage("Experience: {0} - no match",[o.teaser.title]),l,o.teaser.thumbnail,!1)}return n+="<br>",n+=i?CQ.I18n.getMessage("Strategy <b>{0}</b> selected current teaser.",i):CQ.I18n.getMessage("No strategy configured, used the first match."),n+="<br>"}(i,n,r),title:CQ.I18n.getMessage("Selection decision"),width:450,autoHide:!1,closable:!0,height:300,floating:!0,autoHeight:!1,bodyStyle:"overflow-y: scroll;"}),e.on(CQ.wcm.EditRollover.EVENT_SHOW_HIGHTLIGHT,function(t){this.teaserInfoButton||(this.teaserInfoButton=CQ.Ext.DomHelper.append("CQ",{tag:"div",cls:"x-tool x-tool-help cq-teaser-tooltip-tool"},!0),this.teaserInfoButton.position("absolute"),this.teaserInfoButton.on("click",function(){var t=this.getXY();e.teaserToolTip.setPosition(t[0]-460,t[1]-100),e.teaserToolTip.show()})),this.teaserInfoButton.anchorTo(t.frameBottom.getEl(),"tr",[-26,-15]),this.teaserInfoButton.show()}),e.on(CQ.wcm.EditRollover.EVENT_HIDE_HIGHTLIGHT,function(t){this.teaserInfoButton&&this.teaserInfoButton.hide()})})}window.CQ_trackTeasersStats=!0;var r={};var m={};return{stopTeaserLoader:function(t){var e=t.path||t;!e||(t=r[e])&&(CQ_Analytics.SegmentMgr.removeListener("update",t),delete r[e])},resolveTeaser:function(t,e,i){i=function(t,e){for(var i=[],n=0,r=0;r<t.length;r++){var a,s=t[r],o=s.segments;e&&e.push(a={teaser:s});var l=!o||0===o.length;l&&a&&(a.noSegment=!0),!l&&CQ_Analytics.SegmentMgr.resolve(o)&&(l=!0,o&&0<o.length&&(CQ_Analytics.SegmentMgr.segments[o[0]]||(l=!1,a&&(a.unknownSegment=!0)))),l&&(o=CQ_Analytics.SegmentMgr.getMaxBoost(o),a&&(a.boost=o),o===n?i.push(s):n<o&&((i=[]).push(s),n=o))}return i}(t,i);return 0===i.length?null:CQ_Analytics.StrategyMgr.choose(e,i)||i[0]},loadTeaser:function(A){var _,n,e,t;Q()&&(n=CQ.WCM.getEditablePathFromDOM(document.getElementById(A.targetID)),i=n,e=$CQ.Deferred(),(t=CQ.WCM.getEditable(i))?e.resolve(t):CQ.WCM.onEditableReady(i,function(t){e.resolve(t)}),_=e.promise());var i=ClientContext.get("campaign");i&&i.isCampaignSelected();i=function(){var t=CQ_Analytics.PageDataMgr.getExperience();if(t){CQ_Analytics.PageDataMgr.clearExperience();var e="/_jcr_content/par.html";return Q()&&(e+="?wcmmode=disabled"),void CQ_Analytics.Utils.loadElement(t+e,A.targetID)}function i(){var t,n,e,i=null;if(Q()&&(i=[]),(e=ClientContext.get("campaign"))&&e.isCampaignSelected()){for(var r,a=e.data.path,s=e.data["recipe/path"],o=e.data.campaigns||[],l={},c=A.teasers,d=0;d<c.length;d++)"default"===c[d].name&&(r=c[d]);if(m[A.targetID]&&m[A.targetID][s])t=m[A.targetID][s];else{if("DEFAULT"===s)t=r;else{for(d=0;d<o.length;d++){var C=o[d];if(o[d].path===a)for(var g=C.experiences,y=0;y<g.length;y++)if(g[y].path===s&&g[y].hasOwnProperty("segments"))for(var u=g[y].segments,p=0;p<u.length;p++)l[u[p]]=l}for(d=0;d<c.length;d++){var h=c[d];if(h.hasOwnProperty("segments")&&h.segments.length===u.length&&function(t,e){if(t&&e&&t.length===e.length){t.sort(),e.sort();for(var i=0;i<t.length;i++)if(t[i]!==e[i])return;return 1}}(u,h.segments)){t=c[d];break}}}m[A.targetID]={experience:t=t||r}}}else t=CQ_Analytics.Engine.resolveTeaser(A.teasers,A.strategy,i);t?f&&f.path===t.path||(f=t,CQ_Analytics.SegmentMgr.fireEvent("teaser-loaded",{campaignPath:t.campaignPath||"",campaignName:t.campainName||"",experiencePath:t.path||"",segmentName:t.title||"",segments:t.segments||[],targetElement:A.targetID}),e=t.url,Q()&&(e+="?wcmmode=disabled"),CQ_Analytics.Utils.loadTeaserElement(e,A.targetID),window.CQ_trackTeasersStats&&A.trackingURL&&(e=t,n=A.trackingURL,CQ_Analytics.loadedTeasersStack||(CQ_Analytics.loadedTeasersStack=[],$CQ(window).unload(function(){try{var t=CQ_Analytics.loadedTeasersStack;if(t){delete CQ_Analytics.loadedTeasersStack;for(var e=n,i=0;i<t.length;i++)e=CQ.shared.HTTP.addParameter(e,"path",t[i]);CQ.shared.HTTP.get(e,function(){})}}catch(t){}})),CQ_Analytics.loadedTeasersStack.push(e.path)),_&&S(_,i,f.path,A.strategy)):(_&&_.done(function(t){t.teaserToolTip&&(t.teaserToolTip.hide(),t.teaserToolTip.remove(),t.teaserToolTip=null)}),CQ_Analytics.Utils.clearElement(A.targetID),f=null)}var f=null;i.call(),CQ_Analytics.SegmentMgr&&(n&&(t=n,e=i,CQ_Analytics.Engine.stopTeaserLoader(t),r[t]=e),CQ_Analytics.SegmentMgr.addListener("update",i)),CQ_Analytics.CampaignMgr&&CQ_Analytics.CampaignMgr&&CQ_Analytics.CampaignMgr.addListener("update",i)};CQ_Analytics.CCM.areStoresInitialized?i.call(this):CQ_Analytics.CCM.addListener("storesinitialize",i)}}}(),window.CQ_trackTeasersStats=!0,window.CQ_trackLandingPagesStats=!0,CQ_Analytics.PersistedJSONStore=function(){},CQ_Analytics.PersistedJSONStore.prototype=new CQ_Analytics.PersistedSessionStore,CQ_Analytics.PersistedJSONStore.prototype.STOREKEY="",CQ_Analytics.PersistedJSONStore.prototype.STORENAME="",CQ_Analytics.PersistedJSONStore.prototype.init=function(){var t=new CQ_Analytics.SessionPersistence({container:"ClientContext"}).get(this.getStoreKey());if(t&&""!=t)this.data=this.parse(t);else for(var e in this.data={},this.initProperty)this.data[e]=this.initProperty[e];this.persist(),this.initialized=!0,this.fireEvent("initialize",this),this.fireEvent("update")},CQ_Analytics.PersistedJSONStore.prototype.clear=function(){new CQ_Analytics.SessionPersistence({container:"ClientContext"}).remove(this.getStoreKey()),this.data=null,this.initProperty={}},CQ_Analytics.PersistedJSONStore.prototype.initJSON=function(t,e){e||(this.initProperty={});function r(t,e,i){for(var n in i)"object"==typeof i[n]?r(t,e?e+"/"+n:n,i[n]):t[e?e+"/"+n:n]=i[n]}r(this.initProperty,null,t)},CQ_Analytics.PersistedJSONStore.prototype.getJSON=function(){var t,e=this.getData(),i={};for(t in e)for(var n=t.split("/"),r=i,a=0;a<n.length;a++){var s=n[a];a==n.length-1?r[s]=e[t]:(r[s]=r[s]||{},r=r[s])}return i},CQ_Analytics.PersistedJSONStore.getInstance=function(t,e){var i=new CQ_Analytics.PersistedJSONStore;return i.STOREKEY=t.toUpperCase(),i.STORENAME=t,i.initJSON(e),i},CQ_Analytics.PersistedJSONStore.registerNewInstance=function(t,e){e=CQ_Analytics.PersistedJSONStore.getInstance(t,e);return e.init(),CQ_Analytics.CCM.register(e),e},CQ_Analytics.JSONStore=function(){},CQ_Analytics.JSONStore.prototype=new CQ_Analytics.SessionStore,CQ_Analytics.JSONStore.prototype.STOREKEY="",CQ_Analytics.JSONStore.prototype.STORENAME="",CQ_Analytics.JSONStore.prototype.init=function(){for(var t in this.data={},this.initProperty)this.data[t]=this.initProperty[t];this.initialized=!0,this.fireEvent("initialize",this),this.fireEvent("update")},CQ_Analytics.JSONStore.prototype.clear=function(){this.data=null,this.initProperty={}},CQ_Analytics.JSONStore.prototype.initJSON=function(t,e){e||(this.initProperty={});function r(t,e,i){for(var n in i)"object"==typeof i[n]?r(t,e?e+"/"+n:n,i[n]):t[e?e+"/"+n:n]=i[n]}r(this.initProperty,null,t)},CQ_Analytics.JSONStore.prototype.getJSON=function(){var t,e=this.getData(),i={};for(t in e)for(var n=t.split("/"),r=i,a=0;a<n.length;a++){var s=n[a];a==n.length-1?r[s]=e[t]:(r[s]=r[s]||{},r=r[s])}return i},CQ_Analytics.JSONStore.getInstance=function(t,e){var i=new CQ_Analytics.JSONStore;return i.STOREKEY=t.toUpperCase(),i.STORENAME=t,i.initJSON(e),i},CQ_Analytics.JSONStore.registerNewInstance=function(t,e){e=CQ_Analytics.JSONStore.getInstance(t,e);return e.init(),CQ_Analytics.CCM.register(e),e},CQ_Analytics.PersistedJSONPStore=function(){},CQ_Analytics.PersistedJSONPStore.prototype=new CQ_Analytics.PersistedJSONStore,CQ_Analytics.PersistedJSONPStore.prototype.setServiceURL=function(t){this.serviceURL=t},CQ_Analytics.PersistedJSONPStore.prototype.getServiceURL=function(){return this.serviceURL},CQ_Analytics.PersistedJSONPStore.prototype.load=function(t,i,n){var r=this.getName();CQ_Analytics.PersistedJSONPStore.JSONPCallbacks[this.getName()]||(CQ_Analytics.PersistedJSONPStore.JSONPCallbacks[r]=function(t){var e=CQ_Analytics.CCM.getRegisteredStore(r);e&&(e.initJSON(t),i&&e.initJSON(i,!0)),n&&n.call(e)}),t&&this.setServiceURL(t);t=(t=this.serviceURL).replace("${callback}","CQ_Analytics.PersistedJSONPStore.JSONPCallbacks."+r);$CQ.getScript(t)},CQ_Analytics.PersistedJSONPStore.JSONPCallbacks={},CQ_Analytics.PersistedJSONPStore.getInstance=function(e,i,t,n,r){if(e&&i)try{var a=new CQ_Analytics.PersistedJSONPStore;return a.STOREKEY=e.toUpperCase(),a.STORENAME=e,i&&a.setServiceURL(i),n||a.load(i,t,r),a}catch(t){console.log("Cannot create the JSONP store",e,i,t)}return null},CQ_Analytics.PersistedJSONPStore.registerNewInstance=function(t,e,i,n){if(!e)return null;var r;t||(t=(r=CQ.shared.HTTP.getSchemeAndAuthority(e))?-1!=r.indexOf(".")?(r=r.substring(0,r.lastIndexOf("."))).substring(r.lastIndexOf(".")+1):r.substring(r.lastIndexOf("/")+1):e);i=CQ_Analytics.PersistedJSONPStore.getInstance(t,e,i,!1,function(){this.init(),this.reset(),n&&n.call(this)});return null!=i?(CQ_Analytics.CCM.register(i),i):null},CQ_Analytics.JSONPStore=function(){},CQ_Analytics.JSONPStore.prototype=new CQ_Analytics.JSONStore,CQ_Analytics.JSONPStore.prototype.setServiceURL=function(t){this.serviceURL=t},CQ_Analytics.JSONPStore.prototype.getServiceURL=function(){return this.serviceURL},CQ_Analytics.JSONPStore.prototype.load=function(t,i,n){var r=this.getName();CQ_Analytics.JSONPStore.JSONPCallbacks[this.getName()]||(CQ_Analytics.JSONPStore.JSONPCallbacks[r]=function(t){var e=CQ_Analytics.CCM.getRegisteredStore(r);e&&(e.initJSON(t),i&&e.initJSON(i,!0)),n&&n.call(e)}),t&&this.setServiceURL(t);t=(t=this.serviceURL).replace("${callback}","CQ_Analytics.JSONPStore.JSONPCallbacks."+r);$CQ.getScript(t)},CQ_Analytics.JSONPStore.JSONPCallbacks={},CQ_Analytics.JSONPStore.getInstance=function(e,i,t,n,r){if(e)try{var a=new CQ_Analytics.JSONPStore;return a.STOREKEY=e.toUpperCase(),a.STORENAME=e,i&&(a.setServiceURL(i),n||a.load(i,t,r)),a}catch(t){console.log("Cannot create the JSONP store",e,i,t)}return null},CQ_Analytics.JSONPStore.registerNewInstance=function(t,e,i,n){var r;!t&&e&&(t=(r=CQ.shared.HTTP.getSchemeAndAuthority(e))?-1!=r.indexOf(".")?(r=r.substring(0,r.lastIndexOf("."))).substring(r.lastIndexOf(".")+1):(t=r.substring(r.lastIndexOf("/")+1)).replace(new RegExp(":","ig"),"_"):e);i=CQ_Analytics.JSONPStore.getInstance(t,e,i,!1,function(){this.init(),this.reset(),n&&n.call(this)});return null!=i?(CQ_Analytics.CCM.register(i),i):null},CQ_Analytics.ClientContext||(CQ_Analytics.ClientContext=new function(){return{get:function(t,e){if(t){var i=(t=0!=t.indexOf("/")?"/"+t:t).split("/")[1],t=t.substring(t.indexOf("/"+i)+i.length+2,t.length),i=CQ_Analytics.CCM.getRegisteredStore(i);if(i){if(t){t=i.getProperty(t);return t=t&&e?CQ_Analytics.Variables.replaceVariables(t):t}return i}}return null},set:function(t,e){var i;t&&(i=(t=0!=t.indexOf("/")?"/"+t:t).split("/")[1],t=t.substring(t.indexOf("/"+i)+i.length+2,t.length),(i=CQ_Analytics.CCM.getRegisteredStore(i))&&t&&i.setProperty(t,e))},clear:function(){var t=CQ_Analytics.CCM.getStores();if(t)for(var e in t)t[e].clear&&t[e].clear()},reset:function(){var t=CQ_Analytics.CCM.getStores();if(t)for(var e in t)t[e].reset&&t[e].reset()},persist:function(t){CQ_Analytics.ClientContextMgr.ServerStorage.post(t,!0)}}},window.ClientContext=CQ_Analytics.ClientContext,window.ContextCloud=CQ_Analytics.ClientContext),CQ_Analytics&&!CQ_Analytics.TwitterProfileDataMgr&&(CQ_Analytics.TwitterProfileDataMgr=function(){},CQ_Analytics.TwitterProfileDataMgr.prototype=new CQ_Analytics.PersistedSessionStore,CQ_Analytics.TwitterProfileDataMgr.prototype.STOREKEY="TWITTERPROFILEDATA",CQ_Analytics.TwitterProfileDataMgr.prototype.STORENAME="twitterprofile",CQ_Analytics.TwitterProfileDataMgr.prototype.clear=function(){this.persistence&&this.persistence.remove(this.getStoreKey()),this.data=null,this.initProperty={}},CQ_Analytics.TwitterProfileDataMgr.prototype.init=function(){this.persistence=new CQ_Analytics.SessionPersistence({container:"ClientContext"});var t=this.persistence.get(this.getStoreKey());if(t&&""!=t)this.data=this.parse(t);else for(var e in this.data={},this.initProperty)this.data[e]=this.initProperty[e];this.persist(),this.initialized=!0,this.fireEvent("initialize",this),this.fireEvent("update")},CQ_Analytics.TwitterProfileDataMgr.prototype.getLoaderURL=function(){return CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/twitterprofiledata/loader.json")},CQ_Analytics.TwitterProfileDataMgr.prototype.loadProfile=function(t){if(t){this.setProperty("authorizableId",t);var e=this.getLoaderURL(),e=CQ_Analytics.Utils.addParameter(e,"authorizableId",t);try{var i=CQ.shared.HTTP.eval(e);if(i){for(var n in this.data={},i)this.data[n]=i[n];return this.setProperty("authorizableId",t),this.persist(),this.fireEvent("update"),CQ_Analytics.ClickstreamcloudEditor&&CQ_Analytics.ClickstreamcloudEditor.reload(),!0}}catch(t){console&&console.log&&console.log("Error during profile loading",t)}}return!1},CQ_Analytics.TwitterProfileDataMgr=new CQ_Analytics.TwitterProfileDataMgr,CQ_Analytics.ClientContextUtils.onStoreRegistered("profile",function(){CQ_Analytics.ProfileDataMgr.addListener("update",function(){var t=CQ_Analytics.ProfileDataMgr.getProperty("authorizableId");t!=this.getProperty("authorizableId")&&(CQ_Analytics.TwitterProfileDataMgr.loadProfile(t),this.fireEvent("update"))},CQ_Analytics.TwitterProfileDataMgr)}),CQ_Analytics.CCM.register(CQ_Analytics.TwitterProfileDataMgr)),CQ_Analytics.FacebookProfileDataMgr||(CQ_Analytics.FacebookProfileDataMgr=function(){},CQ_Analytics.FacebookProfileDataMgr.prototype=new CQ_Analytics.PersistedSessionStore,CQ_Analytics.FacebookProfileDataMgr.prototype.STOREKEY="FBPROFILEDATA",CQ_Analytics.FacebookProfileDataMgr.prototype.STORENAME="facebookprofile",CQ_Analytics.FacebookProfileDataMgr.prototype.clear=function(){this.persistence&&this.persistence.remove(this.getStoreKey()),this.data=null,this.initProperty={}},CQ_Analytics.FacebookProfileDataMgr.prototype.init=function(){this.persistence=new CQ_Analytics.SessionPersistence({container:"ClientContext"});var t=this.persistence.get(this.getStoreKey());if(t&&""!=t)this.data=this.parse(t);else for(var e in this.data={},this.initProperty)this.data[e]=this.initProperty[e];this.persist(),this.initialized=!0,this.fireEvent("initialize",this),this.fireEvent("update")},CQ_Analytics.FacebookProfileDataMgr.prototype.getLoaderURL=function(){return CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/fbprofiledata/loader.json")},CQ_Analytics.FacebookProfileDataMgr.prototype.loadProfile=function(t){if(t){this.setProperty("authorizableId",t);var e=this.getLoaderURL(),e=CQ_Analytics.Utils.addParameter(e,"authorizableId",t);try{var i=CQ.shared.HTTP.eval(e);if(i){for(var n in this.data={},i)this.data[n]=i[n];return this.setProperty("authorizableId",t),this.persist(),this.fireEvent("update"),this.fireEvent("checkBirthday"),CQ_Analytics.ClickstreamcloudEditor&&CQ_Analytics.ClickstreamcloudEditor.reload(),!0}}catch(t){console&&console.log&&console.log("Error during profile loading",t)}}return!1},CQ_Analytics.FacebookProfileDataMgr=new CQ_Analytics.FacebookProfileDataMgr,CQ_Analytics.ClientContextUtils.onStoreRegistered("profile",function(){CQ_Analytics.ProfileDataMgr.addListener("update",function(){var t=CQ_Analytics.ProfileDataMgr.getProperty("authorizableId");t!=this.getProperty("authorizableId")&&(CQ_Analytics.FacebookProfileDataMgr.loadProfile(t),this.fireEvent("update"))},CQ_Analytics.FacebookProfileDataMgr)}),CQ_Analytics.CCM.register(CQ_Analytics.FacebookProfileDataMgr)),CQ_Analytics.FacebookInterestsMgr||(CQ_Analytics.FacebookInterestsMgr=function(){},CQ_Analytics.FacebookInterestsMgr.prototype=new CQ_Analytics.PersistedSessionStore,CQ_Analytics.FacebookInterestsMgr.prototype.STOREKEY="FBINTERESTSDATA",CQ_Analytics.FacebookInterestsMgr.prototype.STORENAME="fbinterests",CQ_Analytics.FacebookInterestsMgr.prototype.getLabel=function(t){return t},CQ_Analytics.FacebookInterestsMgr.prototype.getLink=function(t){return""},CQ_Analytics.FacebookInterestsMgr.prototype.clear=function(){this.persistence&&this.persistence.remove(this.getStoreKey()),this.data=null,this.initProperty={}},CQ_Analytics.FacebookInterestsMgr.prototype.init=function(){this.persistence=new CQ_Analytics.SessionPersistence({container:"ClientContext"});var t=this.persistence.get(this.getStoreKey());if(t&&""!=t)this.data=this.parse(t);else for(var e in this.data={},this.initProperty)this.data[e]=this.initProperty[e];this.persist(),this.initialized=!0,this.fireEvent("initialize",this),this.fireEvent("update")},CQ_Analytics.FacebookInterestsMgr.prototype.getLoaderURL=function(){return CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/fbinterestsdata/loader.json")},CQ_Analytics.FacebookInterestsMgr.prototype.loadProfile=function(t){if(t){this.setProperty("authorizableId",t);var e=this.getLoaderURL(),e=CQ_Analytics.Utils.addParameter(e,"authorizableId",t);CQ_Analytics.FacebookInterestsMgr.lastUid=t;try{var i=CQ.shared.HTTP.eval(e);if(i){for(var n in this.data={},i)this.data[n]=i[n];return this.setProperty("authorizableId",t),this.persist(),CQ_Analytics.ClickstreamcloudEditor&&CQ_Analytics.ClickstreamcloudEditor.reload(),!0}}catch(t){console&&console.log&&console.log("Error during profile loading",t)}}return!1},CQ_Analytics.FacebookInterestsMgr=new CQ_Analytics.FacebookInterestsMgr,CQ_Analytics.ClientContextUtils.onStoreRegistered("profile",function(){CQ_Analytics.ProfileDataMgr.addListener("update",function(){var t=CQ_Analytics.ProfileDataMgr.getProperty("authorizableId");t!=this.getProperty("authorizableId")&&(CQ_Analytics.FacebookInterestsMgr.loadProfile(t),this.fireEvent("update"))},CQ_Analytics.FacebookInterestsMgr)}),CQ_Analytics.CCM.register(CQ_Analytics.FacebookInterestsMgr)),CQ_Analytics&&!CQ_Analytics.SalesforceProfileDataMgr&&(CQ_Analytics.SalesforceProfileDataMgr=function(){},CQ_Analytics.SalesforceProfileDataMgr.prototype=new CQ_Analytics.SessionStore,CQ_Analytics.SalesforceProfileDataMgr.prototype.STOREKEY="SALESFORCEPROFILEDATA",CQ_Analytics.SalesforceProfileDataMgr.prototype.STORENAME="salesforceprofile",CQ_Analytics.SalesforceProfileDataMgr.prototype.lastUid="",CQ_Analytics.SalesforceProfileDataMgr.prototype.clear=function(){this.data=null,this.initProperty={}},CQ_Analytics.SalesforceProfileDataMgr.prototype.init=function(){if(!this.data)for(var t in this.data={},this.initProperty)this.data[t]=this.initProperty[t]},CQ_Analytics.SalesforceProfileDataMgr.prototype.getLoaderURL=function(){return CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/salesforceprofiledata/loader.json")},CQ_Analytics.SalesforceProfileDataMgr.prototype.handleUpdateProfileDataMgr=function(){var t=CQ_Analytics.ProfileDataMgr.getProperty("authorizableId");t!=CQ_Analytics.SalesforceProfileDataMgr.lastUid&&(CQ_Analytics.SalesforceProfileDataMgr.loadProfile(t),CQ_Analytics.SalesforceProfileDataMgr.fireEvent("update"))},CQ_Analytics.SalesforceProfileDataMgr.prototype.loadProfile=function(t){CQ_Analytics.SalesforceProfileDataMgr.lastUid=t;var e=this.getLoaderURL(),e=CQ_Analytics.Utils.addParameter(e,"authorizableId",t);try{var i=CQ.shared.HTTP.eval(e);if(i){for(var n in this.data={},i)this.data[n]=i[n];return this.fireEvent("update"),CQ_Analytics.ClickstreamcloudEditor&&CQ_Analytics.ClickstreamcloudEditor.reload(),!0}}catch(t){console&&console.log&&console.log("Error during profile loading",t)}return!1},CQ_Analytics.SalesforceProfileDataMgr=new CQ_Analytics.SalesforceProfileDataMgr,CQ_Analytics.CCM.register(CQ_Analytics.SalesforceProfileDataMgr)),CQ_Analytics&&!CQ_Analytics.CampaignSeedMgr&&(CQ_Analytics.CampaignSeedMgr=CQ_Analytics.JSONStore.registerNewInstance("campaignseed",{}),CQ_Analytics.CampaignSeedMgr.SERVICE_PATH="/_jcr_content.campaign.seeddata.json/{seed}",CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.ProfileDataMgr.addListener("update",function(){var t=CQ_Analytics.ProfileDataMgr.getProperty("authorizableId");t!=this.lastUid&&(this.lastUid=t,this.clear(),this.fireEvent("update"))},CQ_Analytics.CampaignSeedMgr)},CQ_Analytics.CampaignSeedMgr)),CQ_Analytics&&!CQ_Analytics.CampaignMetadataMgr&&(CQ_Analytics.CampaignMetadataMgr=CQ_Analytics.JSONStore.registerNewInstance("campaignmetadata",{}),CQ_Analytics.CampaignMetadataMgr.SERVICE_PATH="/_jcr_content.campaign.metadata.json",CQ_Analytics.CampaignMetadataMgr.setNLIntegrationURL=function(t){this.baseURL=CQ_Analytics.Utils.externalize(t),this.serviceURL=t+this.SERVICE_PATH,$CQ.post(this.serviceURL,{},function(t){if(CQ_Analytics.CampaignMetadataMgr.initJSON(t),CQ_Analytics.CampaignMetadataMgr.init(),CQ_Analytics.CampaignMetadataMgr._isDataAvailable=!0,CQ&&CQ.WCM){var e,i,n=CQ.WCM.getEditables();for(e in n)n.hasOwnProperty(e)&&(i=n[e].element,CQ.personalization.variables.Variables.injectSpans(i,CQ.personalization.variables.Variables.SCANNED_TAGS,"cq-variable-code"),CQ.personalization.variables.Variables.updateVariables(i,CQ_Analytics.CampaignSeedMgr.getData()))}CQ_Analytics.CampaignMetadataMgr._onDataAvailable&&((0,CQ_Analytics.CampaignMetadataMgr._onDataAvailable.fct)(CQ_Analytics.CampaignMetadataMgr._onDataAvailable.data),CQ_Analytics.CampaignMetadataMgr._onDataAvailable=null)})},CQ_Analytics.CampaignMetadataMgr._isDataAvailable=!1,CQ_Analytics.CampaignMetadataMgr._onDataAvailable=null,CQ_Analytics.CampaignMetadataMgr.whenDataAvailable=function(t,e){CQ_Analytics.CampaignMetadataMgr._isDataAvailable?t(e):CQ_Analytics.CampaignMetadataMgr._onDataAvailable={fct:t,data:e}},CQ_Analytics.CampaignMetadataMgr.rawJSON=void 0,CQ_Analytics.CampaignMetadataMgr.getRawJSON=function(){return this.rawJSON},CQ_Analytics.CampaignMetadataMgr.initJSON=function(t,e){e||(this.initProperty={}),function t(e,i,n){for(var r in n)if(n.hasOwnProperty(r)){var a,s=n[r];if(s.hasOwnProperty("type")&&s.type)for(var o in s)s.hasOwnProperty(o)&&(a=r+"/"+o,a=i?i+"/"+a:a,$CQ.isPlainObject(s[o])?function t(e,i,n){for(var r in n){var a;n.hasOwnProperty(r)&&(a=n[r],r=i+"/"+r,$CQ.isPlainObject(a)?t(e,r,a):e[r]=a)}}(e,a,s[o]):e[a]=s[o]);s.hasOwnProperty("content")&&t(e,i?i+"/"+r:r,s.content)}}(this.initProperty,null,t),this.rawJSON=t}),CQ_Analytics.ViewedProducts||(CQ_Analytics.ViewedProducts=function(){this.data=null,this.MAX_COUNT=20},CQ_Analytics.ViewedProducts.prototype=new CQ_Analytics.PersistedSessionStore,CQ_Analytics.ViewedProducts.prototype.STOREKEY="VIEWEDPRODUCTS",CQ_Analytics.ViewedProducts.prototype.STORENAME="viewedproducts",CQ_Analytics.ViewedProducts.prototype.record=function(t,e,i,n){this.data||this.init();for(var r=0;r<this.data.length;r++)if(this.data[r].path==t){this.data.splice(r,1);break}this.data.length==this.MAX_COUNT&&this.data.shift(),this.data.push({path:t,title:e,image:i,price:n}),this.persist(),this.fireEvent("update")},CQ_Analytics.ViewedProducts.prototype.mostRecent=function(){return this.data||this.init(),0<this.data.length?this.data[this.data.length-1]:null},CQ_Analytics.ViewedProducts.prototype.mostRecentNotInCart=function(){if(this.data||this.init(),!CQ_Analytics.CartMgr)return this.mostRecent();for(var t=this.data.length-1;0<=t;t--){var e=this.data[t];if(!CQ_Analytics.CartHelper.containsProduct(CQ_Analytics.CartMgr.getData(),e.path,1))return e}return null},CQ_Analytics.ViewedProducts.prototype.recent=function(t,e){var i=[];this.data||this.init(),CQ_Analytics.CartMgr||(e=!1);for(var n=this.data.length-1;0<=n&&0<t;n--){var r=this.data[n];e&&CQ_Analytics.CartHelper.containsProduct(CQ_Analytics.CartMgr.getData(),r.path,1)||(i.push(r),t--)}return i},CQ_Analytics.ViewedProducts.prototype.getData=function(t){return this.data||this.init(),this.data},CQ_Analytics.ViewedProducts.prototype.init=function(){var t=new CQ_Analytics.SessionPersistence({container:"ClientContext"}).get(this.getStoreKey()),e=(t=null===t?"":new String(t)).split(";");this.data=[];for(var i=0;i<e.length;i++){var n=e[i].split(",");4<=n.length?this.data.push({path:n[0],title:n[1],image:n[2],price:n[3]}):3<=n.length&&this.data.push({path:n[0],title:n[1],image:n[2],price:void 0})}this.initialized=!0,this.fireEvent("initialize",this),this.fireEvent("update")},CQ_Analytics.ViewedProducts.prototype.persist=function(){if(!1!==this.fireEvent("beforepersist")){for(var t=new CQ_Analytics.SessionPersistence({container:"ClientContext"}),e=[],i=0;i<this.data.length;i++){var n=this.data[i],r=n.path+","+n.title+","+n.image;n.price&&(r+=","+n.price),e.push(r)}t.set(this.getStoreKey(),e.join(";")),this.fireEvent("persist")}},CQ_Analytics.ViewedProducts.prototype.reset=function(){this.clear(),this.fireEvent("update")},CQ_Analytics.ViewedProducts.prototype.clear=function(){new CQ_Analytics.SessionPersistence({container:"ClientContext"}).remove(this.getStoreKey()),this.data=[]},CQ_Analytics.ViewedProducts=new CQ_Analytics.ViewedProducts,CQ_Analytics.CCM.register(CQ_Analytics.ViewedProducts)),CQ_Analytics.TagCloudMgr||(CQ_Analytics.TagCloudMgr=function(){this.data=null,this.addedTags={},this.frequencies=null,this.initialTags=null,this.initialAddedTags={},this.copyObject=function(t){var e,i={};for(e in t)i[e]=t[e];return i}},CQ_Analytics.TagCloudMgr.prototype=new CQ_Analytics.PersistedSessionStore,CQ_Analytics.TagCloudMgr.prototype.STOREKEY="TAGCLOUD",CQ_Analytics.TagCloudMgr.prototype.STORENAME="tagcloud",CQ_Analytics.TagCloudMgr.prototype.parseTagList=function(t){var e,i,n={},r=t.split(",");for(e in r)!r.hasOwnProperty(e)||2==(i=r[e].split("=")).length&&(n[i[0]]=parseInt(i[1]));return n},CQ_Analytics.TagCloudMgr.prototype.parseString=function(t){return this.data=this.parseTagList(t),this},CQ_Analytics.TagCloudMgr.prototype.add=function(t){this.addedTags[t]=!0,this.data[t]=(this.data[t]||0)+1},CQ_Analytics.TagCloudMgr.prototype.each=function(t){for(var e in this.data)this.data.hasOwnProperty(e)&&t(e,this.data[e])},CQ_Analytics.TagCloudMgr.prototype.calculateFrequencies=function(){var i={},n=[];return this.each(function(t,e){i[e]||n.push(e),i[e]=!0}),n.sort(function(t,e){return e<t?1:t<e?-1:0}),n},CQ_Analytics.TagCloudMgr.prototype.calculateNtile=function(t,e){null===this.frequencies&&(this.frequencies=this.calculateFrequencies());for(var i=0;;){if(i>=this.frequencies.length-1||this.frequencies[i]>=t)return Math.ceil((i+1)/this.frequencies.length*e);i++}},CQ_Analytics.TagCloudMgr.prototype.getTags=function(){return this.data},CQ_Analytics.TagCloudMgr.prototype.getData=function(t){return this.getTags()},CQ_Analytics.TagCloudMgr.prototype.getTag=function(t){return 0<this.data[t]?this.data[t]:0},CQ_Analytics.TagCloudMgr.prototype.init=function(t){var e=null===(e=new CQ_Analytics.SessionPersistence({container:"ClientContext"}).get(this.getStoreKey()))?"":new String(e);if(this.data=this.parseTagList(e),t)for(var i in t)t.hasOwnProperty(i)&&this.add(t[i]);this.initialTags=this.copyObject(this.data),this.initialAddedTags=this.copyObject(this.addedTags),this.persist(),this.initialized=!0,this.fireEvent("initialize",this),this.fireEvent("update")},CQ_Analytics.TagCloudMgr.prototype.setProperty=function(t,e){null==this.data&&this.init(),0<e?(this.addedTags[t]=!0,this.data[t]=0<e?e:0):(delete this.addedTags[t],delete this.data[t]),this.persist(),this.fireEvent("update")},CQ_Analytics.TagCloudMgr.prototype.reset=function(){this.clear(),this.fireEvent("update")},CQ_Analytics.TagCloudMgr.prototype.getProperty=function(t){return null==this.data&&this.init(),0<this.data[t]?this.data[t]:0},CQ_Analytics.TagCloudMgr.prototype.removeProperty=function(t){null==this.data&&this.init(),this.setProperty(t,0)},CQ_Analytics.TagCloudMgr.prototype.clear=function(){new CQ_Analytics.SessionPersistence({container:"ClientContext"}).remove(this.getStoreKey()),this.addedTags={},this.data={}},CQ_Analytics.TagCloudMgr.prototype.getLink=function(t){return""},CQ_Analytics.TagCloudMgr.prototype.getLabel=function(t){var e;return t=t?(e=(e=t.split(":"))[e.length-1].split("/"))[e.length-1]:t},CQ_Analytics.TagCloudMgr=new CQ_Analytics.TagCloudMgr,CQ_Analytics.CCM.register(CQ_Analytics.TagCloudMgr)),CQ_Analytics.SurferInfoMgr||(CQ_Analytics.SurferInfoMgr=function(){},CQ_Analytics.SurferInfoMgr.prototype=new CQ_Analytics.SessionStore,CQ_Analytics.SurferInfoMgr.prototype.STOREKEY="SURFERINFO",CQ_Analytics.SurferInfoMgr.prototype.STORENAME="surferinfo",CQ_Analytics.SurferInfoMgr.prototype.init=function(){for(var t in this.data={},this.initProperty)this.data[t]=this.initProperty[t];this.initialized=!0,this.fireEvent("initialize",this),this.fireEvent("update")},CQ_Analytics.SurferInfoMgr.prototype.clear=function(){this.data=null,this.initProperty={}},CQ_Analytics.SurferInfoMgr.prototype.getLabel=function(t){return t},CQ_Analytics.SurferInfoMgr.prototype.getLink=function(t){return""},CQ_Analytics.SurferInfoMgr=new CQ_Analytics.SurferInfoMgr,CQ_Analytics.CCM.addListener("configloaded",function(){var i=CQ_Analytics.BrowserInfoInstance;this.addInitProperty("browserFamily",i.getBrowserFamily()),this.addInitProperty("browserVersion",i.getBrowserVersion()),this.addInitProperty("browser","${/surferinfo/browserFamily} ${/surferinfo/browserVersion}"),this.addInitProperty("OS",i.getOSName()),this.addInitProperty("resolution",i.getScreenResolution()),this.addInitProperty("device",i.getDeviceType()),this.addInitProperty("isMobile",i.isMobile()),this.addInitProperty("userAgent",i.getUserAgent());var t=new Date;this.addInitProperty("day",t.getDate()),this.addInitProperty("month",t.getMonth()+1),this.addInitProperty("year",t.getFullYear()),this.addInitProperty("hours",t.getHours()),this.addInitProperty("minutes",t.getMinutes());t="${/surferinfo/browserFamily}";i.isMobile()&&(t="${/surferinfo/device}"),this.addInitProperty("image",t);t=CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/surferinfo/resources/${/surferinfo/image}.png");this.addInitProperty("thumbnail",t),window.CQ_Analytics&&window.CQ_Analytics.MousePositionMgr&&CQ_Analytics.MousePositionMgr.addListener("update",function(){this.setProperty("mouse X",CQ_Analytics.MousePositionMgr.getProperty("x")),this.setProperty("mouse Y",CQ_Analytics.MousePositionMgr.getProperty("y"))},this),this.addListener("update",function(){var t=this.getProperty("device"),e="${/surferinfo/browserFamily}";i.isMobile(t)&&(e="${/surferinfo/device}"),this.getProperty("image")!=e&&this.setProperty("image",e)},this),this.init(),CQ_Analytics.CCM.register(this)},CQ_Analytics.SurferInfoMgr)),CQ_Analytics.SocialGraphMgr||(CQ_Analytics.SocialGraphMgr=CQ_Analytics.JSONPStore.registerNewInstance("socialgraph"),CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.ProfileDataMgr.addListener("update",function(){CQ_Analytics.ProfileDataMgr.getProperty("authorizableId")!=this.lastUid&&this.fireEvent("update")},CQ_Analytics.SocialGraphMgr)},CQ_Analytics.SocialGraphMgr)),window.CQ_Analytics&&window.CQ_Analytics.SegmentMgr&&!window.CQ_Analytics.SegmentMgr.isResolvedRegistered&&(CQ_Analytics.SegmentMgr.isResolvedRegistered=!0,CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.StoreRegistry.register(CQ_Analytics.SegmentMgr),CQ_Analytics.CCM.fireEvent("storeregister",CQ_Analytics.SegmentMgr)},CQ_Analytics.SegmentMgr)),CQ_Analytics.RelatedProducts||(CQ_Analytics.RelatedProducts=function(){this.data=null},CQ_Analytics.RelatedProducts.prototype=new CQ_Analytics.SessionStore,CQ_Analytics.RelatedProducts.prototype.STOREKEY="RELATEDPRODUCTS",CQ_Analytics.RelatedProducts.prototype.STORENAME="relatedproducts",CQ_Analytics.RelatedProducts.prototype.products=function(t,e){var i=[];this.data||this.init();for(var n=0;n<this.data.length&&0<t;n++){var r=this.data[n];r.relationshipType===e&&(i.push(r),t--)}return i},CQ_Analytics.RelatedProducts.prototype.getData=function(t){return this.data||this.init(),this.data},CQ_Analytics.RelatedProducts.prototype.init=function(){this.data?(this.fireEvent("initialize",this),this.fireEvent("update")):this.data={}},CQ_Analytics.RelatedProducts=new CQ_Analytics.RelatedProducts,CQ_Analytics.CCM.register(CQ_Analytics.RelatedProducts)),CQ_Analytics.ProfileDataMgr||(CQ_Analytics.ProfileDataMgr=function(){this.addListener("beforepersist",function(){this.checkAuthorizableId()},this)},CQ_Analytics.ProfileDataMgr.prototype=new CQ_Analytics.PersistedSessionStore,CQ_Analytics.ProfileDataMgr.prototype.STOREKEY="PROFILEDATA",CQ_Analytics.ProfileDataMgr.prototype.STORENAME="profile",CQ_Analytics.ProfileDataMgr.prototype.LOADER_PATH=CQ_Analytics.Utils.externalize("/libs/cq/personalization/components/profileloader/content/load.js",!0),CQ_Analytics.ProfileDataMgr.prototype.PROFILE_LOADER=CQ_Analytics.Utils.externalize("/libs/cq/personalization/components/profileloader/content/load.json",!0),CQ_Analytics.ProfileDataMgr.prototype.init=function(){this.persistence=new CQ_Analytics.SessionPersistence({container:"ClientContext"});var t=this.persistence.get(this.getStoreKey());if(t&&""!=t)this.data=this.parse(t);else for(var e in this.data={},this.initProperty)this.data[e]=this.initProperty[e];this.persist(),this.initialized=!0,this.fireEvent("initialize",this),this.fireEvent("update")},CQ_Analytics.ProfileDataMgr.prototype.checkAuthorizableId=function(){this.data||this.init(),this.data.authorizableId?CQ_Analytics.CCM.setVisitorId(this.data.authorizableId):CQ_Analytics.CCM.setVisitorId("")},CQ_Analytics.ProfileDataMgr.prototype.getLabel=function(t){return t},CQ_Analytics.ProfileDataMgr.prototype.getLink=function(t){return""},CQ_Analytics.ProfileDataMgr.prototype.clear=function(){this.persistence&&this.persistence.remove(this.getStoreKey()),this.data=null,this.initProperty={}},CQ_Analytics.ProfileDataMgr.prototype.getLoaderURL=function(){return CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/profiledata/loader.json")},CQ_Analytics.ProfileDataMgr.prototype.loadProfile=function(t){var e=this.getLoaderURL(),e=CQ_Analytics.Utils.addParameter(e,"authorizableId",t);try{var i=CQ.shared.HTTP.eval(e);if(i){for(var n in this.data={},i)this.data[n]=i[n];return this.persist(),this.fireEvent("initialize",this),this.fireEvent("update"),CQ_Analytics.ClickstreamcloudEditor&&CQ_Analytics.ClickstreamcloudEditor.reload(),!0}}catch(t){console&&console.log&&console.log("Error during profile loading",t)}return!1},CQ_Analytics.ProfileDataMgr=new CQ_Analytics.ProfileDataMgr,CQ_Analytics.CCM.addListener("configloaded",function(){this.checkAuthorizableId(),this.addListener("update",function(t,e){if("birthday"==e||!e){var i=this.getProperty("birthday"),n=this.getProperty("age"),e="";if(i)try{function r(t){var e=new Date(t.getFullYear(),0,0);return-1*o(t,e)}var a,s,o=function(t,e){e=new Date(e.getTime());return e.setUTCHours(t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()),(e.getTime()-t.getTime())/864e5},l=new Date(Date.parse(i));e=isNaN(l.getTime())?"":(a=new Date,r(l)==r(a)&&l.getMonth()==a.getMonth()?CQ.shared.HTTP.externalize(CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/profiledata/resources/birthday_cake.png")):(s=a.getFullYear()-l.getFullYear(),r(l)>r(a)?s:Math.max(0,s-1)))}catch(t){e=""}n!=e&&this.setProperty("age",e)}}),CQ_Analytics.CCM.register(this)},CQ_Analytics.ProfileDataMgr)),CQ_Analytics.OrderHistoryMgr||(CQ_Analytics.OrderHistoryMgr=new CQ_Analytics.SessionStore,CQ_Analytics.OrderHistoryMgr.STOREKEY="ORDERHISTORY",CQ_Analytics.OrderHistoryMgr.STORENAME="orderhistory",CQ_Analytics.OrderHistoryMgr.init=function(){this.data?(this.fireEvent("initialize",this),this.fireEvent("update")):this.data={}},CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.CCM.register(this)},CQ_Analytics.OrderHistoryMgr)),CQ_Analytics.GeolocationUtils||(CQ_Analytics.GeolocationUtils=new function(){var o,n,a=[];return{init:function(t){var e;o=t;try{e=navigator.geolocation}catch(t){}function s(t){var r=CQ_Analytics.PersistedJSONStore.registerNewInstance(o,t);r.addListener("update",function(t,e){var i=CQ_Analytics.ClientContext.get(o+"/latitude"),n=CQ_Analytics.ClientContext.get(o+"/longitude");i&&n?r.getProperty("generatedThumbnail",!0)==CQ_Analytics.GeolocationUtils.THUMBNAILS.fallback&&r.setProperty("generatedThumbnail",r.getInitProperty("generatedThumbnail")):"generatedThumbnail"!=e?r.setProperty("generatedThumbnail",CQ_Analytics.GeolocationUtils.THUMBNAILS.fallback):r.getProperty(e,!0)!=CQ_Analytics.GeolocationUtils.THUMBNAILS.fallback&&r.setProperty(e,CQ_Analytics.GeolocationUtils.THUMBNAILS.fallback)}),function(){n=!0;for(var t=0;t<a.length;t++)a[t]&&a[t].call(this,CQ_Analytics.GeolocationUtils.getStore())}()}function i(t,e){var i,n,r,a=CQ_Analytics.StoreRegistry.getStore(o);a?(r=!0,t&&(i=parseInt(1e6*t.latitude)/1e6,n=parseInt(1e6*t.longitude)/1e6,r=!(isFinite(i)&&"number"==typeof i&&isFinite(n)&&"number"==typeof n)),r=(t=r?CQ_Analytics.GeolocationUtils.DEFAULTS:t).generatedThumbnail=a.getInitProperty("generatedThumbnail"),a.initJSON(t),e||(a.init(),a.setProperty("generatedThumbnail",r))):s(t)}s(),e?e.getCurrentPosition(function(t){var e={longitude:parseInt(1e6*t.coords.longitude)/1e6,latitude:parseInt(1e6*t.coords.latitude)/1e6};t.address&&(e.address=t.address),i(e,CQ_Analytics.CCM.areStoresInitialized)},function(t){var e;CQ_Analytics.CCM.areStoresInitialized||(e="Error",CQ_Analytics.isUIAvailable&&(e=CQ.I18n.getMessage("Connection timeout",null,"timeout while connecting geolocation service"),1==t.code?e=CQ.I18n.getMessage("Permission denied",null,"permission denied message from goelocation service"):2==t.code&&(e=CQ.I18n.getMessage("Position unavailable",null,"geolocation service couldn't find location"))),i({address:{country:e}},CQ_Analytics.CCM.areStoresInitialized))}):i()},onReady:function(t){n?t.call(this,CQ_Analytics.GeolocationUtils.getStore()):a.push(t)},getStore:function(){return CQ_Analytics.StoreRegistry.getStore(o)}}},CQ_Analytics.GeolocationUtils.DEFAULTS={latitude:37.331375,longitude:-121.893992},CQ_Analytics.GeolocationUtils.THUMBNAILS={fallback:document.location.protocol+"//maps.googleapis.com/maps/api/staticmap?center=37,-121&zoom=0&size=80x80&sensor=false&client=gme-adobesystemsincorporated&channel=clientcontext&signature=wqNolKQ144hypPUiTmIypxPc1s8="}),CQ_Analytics.CartMgr||(CQ_Analytics.CartMgr=new CQ_Analytics.SessionStore,CQ_Analytics.CartMgr.STOREKEY="CART",CQ_Analytics.CartMgr.STORENAME="cart",CQ_Analytics.CartMgr.init=function(){if(this.data){var t=new CQ_Analytics.SessionPersistence({container:"ClientContext"}).get(this.STOREKEY);if(t){var e=t.split(";");if(!e[0]||2==(t=e[0].split("=")).length&&(this.referenceTotalPrice=t[0],this.simulatedTotalPrice=t[1],this.updateSimulatedPrice()),e[1]){this.simulatedPromotions=[];for(var i=e[1].split(","),n=0;n<i.length;n++){var r=i[n].split("=");2==r.length&&this.simulatedPromotions.push({path:r[0],title:r[1]})}}}this.initialized=!0,this.fireEvent("initialize",this),this.fireEvent("update")}else this.data={}},CQ_Analytics.CartMgr.persist=function(){if(!1!==this.fireEvent("beforepersist")){var t=new CQ_Analytics.SessionPersistence({container:"ClientContext"}),e="";if(this.referenceTotalPrice&&this.simulatedTotalPrice&&(e=this.referenceTotalPrice+"="+this.simulatedTotalPrice),e+=";",this.simulatedPromotions)for(var i=0;i<this.simulatedPromotions.length;i++)0<i&&(e+=","),e+=this.simulatedPromotions[i].path+"="+this.simulatedPromotions[i].title;t.set(this.STOREKEY,e),this.fireEvent("persist")}},CQ_Analytics.CartMgr.updateSimulatedPrice=function(){this.simulatedTotalPrice&&this.referenceTotalPrice==this.data.totalPriceFloat?(this.data.totalPriceFloat=this.simulatedTotalPrice,this.data.totalPrice=this.data.totalPrice.replace(/[0-9]+\.[0-9]+/,parseFloat(this.simulatedTotalPrice).toFixed(2))):(this.simulatedTotalPrice=null,this.persist())},CQ_Analytics.CartMgr.registerSimulatedPrice=function(t){this.simulatedTotalPrice?(this.simulatedTotalPrice=t,this.data.totalPrice=this.data.totalPrice.replace(/[0-9]+\.[0-9]+/,parseFloat(this.simulatedTotalPrice).toFixed(2))):(this.referenceTotalPrice=this.data.totalPriceFloat,this.simulatedTotalPrice=t),this.persist()},CQ_Analytics.CartMgr.addSimulatedPromotion=function(t,e){this.simulatedPromotions=this.simulatedPromotions||[];for(var i=!1,n=0;n<this.simulatedPromotions.length;n++)if(this.simulatedPromotions[n].path==t){i=!0;break}i||(this.simulatedPromotions.push({path:t,title:e}),this.resolvePromotions()&&this.update())},CQ_Analytics.CartMgr.removeSimulatedPromotion=function(t){for(var e=-1,i=0;this.simulatedPromotions&&i<this.simulatedPromotions.length;i++)if(this.simulatedPromotions[i].path==t){e=i;break}0<=e&&(this.simulatedPromotions.splice(e,1),this.resolvePromotions()&&this.update())},CQ_Analytics.CartMgr.getSimulatedPromotions=function(){return this.simulatedPromotions},CQ_Analytics.CartMgr.getProperty=function(t,e){this.data||this.init();var i=this.data;try{for(var n=t.split("."),r=0;r<n.length-1;r++){var a=n[r],s=a.indexOf("["),o=-1;0<s&&(o=parseInt(a.substring(s+1,a.length-1)),a=a.substring(0,s)),i=i[a],0<=o&&(i=i[o])}var l=n[n.length-1];if(!e){var c=CQ.shared.XSS.getXSSPropertyName(l);if(i[c])return i[c]}return i[l]}catch(t){return}},CQ_Analytics.CartMgr.validate=function(t,e){return"totalPriceFloat"==t?0<=parseFloat(e):!(0<t.indexOf(".quantity"))||0<=parseInt(e)},CQ_Analytics.CartMgr.setProperty=function(t,e){if(this.data||this.init(),this.validate(t,e)){"totalPriceFloat"==t&&this.registerSimulatedPrice(e);for(var i=this.data,n=t.split("."),r=0;r<n.length-1;r++){var a=n[r],s=a.indexOf("["),o=-1;0<s&&(o=parseInt(a.substring(s+1,a.length-1)),a=a.substring(0,s)),i[a]||(i[a]={}),i=i[a],0<=o&&(i[o]||(i[o]={}),i=i[o])}var l=n[n.length-1];i[l]=e;l=CQ.shared.XSS.getXSSPropertyName(l);this.data[l]=CQ.shared.XSS.getXSSValue(e),this.fireEvent("change",t)}else this.fireEvent("change",t)},CQ_Analytics.CartMgr.addProductToCart=function(t,e,i,n,r){this.data.entries=this.data.entries||[],this.data.entries.push({title:CQ.shared.XSS.getXSSValue(i),quantity:1,path:CQ.shared.XSS.getXSSValue(t),pagePath:CQ.shared.XSS.getXSSValue(e),thumbnail:CQ.shared.XSS.getXSSValue(n),priceFormatted:CQ.shared.XSS.getXSSValue(r)}),this.fireEvent("change","entries")},CQ_Analytics.CartMgr.addVoucher=function(t){this.data.vouchers=this.data.vouchers||[];for(var e=!1,i=0;i<this.data.vouchers.length;i++)if(this.data.vouchers[i].code==t){e=!0;break}e||(this.data.vouchers.push({code:t}),this.fireEvent("change","vouchers"))},CQ_Analytics.CartMgr.removeVoucher=function(t){for(var e=-1,i=0;this.data.vouchers&&i<this.data.vouchers.length;i++)if(this.data.vouchers[i].path==t){e=i;break}0<=e&&(this.data.vouchers.splice(e,1),this.fireEvent("change","vouchers"))},CQ_Analytics.CartMgr.addListener("change",function(t,e){var i=this;e&&"totalPrice"!=e&&(this.resolvePromotions(),window.CQ_Analytics&&window.CQ_Analytics.CartMgr&&window.CQ_Analytics.CartMgr.refreshTimeout&&clearTimeout(CQ_Analytics.CartMgr.refreshTimeout),CQ_Analytics.CartMgr.refreshTimeout=setTimeout(function(){i.update()},50))}),CQ_Analytics.CartMgr.update=function(){var e=this;window.ContextHub&&ContextHub.getStore("cart")||this.updateUrl&&$CQ.ajax({url:this.updateUrl,type:"POST",data:{cart:JSON.stringify(e.data)},externalize:!1,encodePath:!1,hook:!0,success:function(t){e.data=t,e.updateSimulatedPrice(),CQ_Analytics.ClientContextUtils.renderStore(CQ_Analytics.CartMgr.divId,CQ_Analytics.CartMgr.STORENAME),e.fireEvent("updatecomplete"),e.fireEvent("update")}})},CQ_Analytics.CartMgr.clear=function(){this.data.entries&&(this.data.entries=[]),this.data.vouchers&&(this.data.vouchers=[]),this.data.totalPrice="0",this.referenceTotalPrice=null,this.simulatedTotalPrice=null,this.simulatedPromotions=null},CQ_Analytics.CartMgr.reset=function(){this.clear(),this.fireEvent("update"),this.persist(),this.update()},CQ_Analytics.CartMgr.resolvePromotions=function(){if(!this.promotionsMap)return!1;if(this.data.promotions||(this.data.promotions=[]),!CQ_Analytics.SegmentMgr.areSegmentsLoaded)return!1;for(var t,e=CQ_Analytics.SegmentMgr.getResolved(),i=[],n=0;n<this.promotionsMap.length;n++){for(var r=this.promotionsMap[n],a=r.segments.split(","),s=!1,o=0;o<a.length;o++)if(0<=$CQ.inArray(a[o],e)){s=!0;break}s&&i.push(r.path)}var l=this.simulatedPromotions||[];for(n=0;n<l.length;n++)$CQ.inArray(l[n].path,i)<0&&i.push(l[n].path);var c=!1;for(n=0;n<this.data.promotions.length;n++){for(t=this.data.promotions[n].path,s=!1,o=0;o<i.length;o++)if(i[o]==t){s=!0;break}s||(this.data.promotions.splice(n--,1),c=!0)}for(n=0;n<i.length;n++){for(t=i[n],s=!1,o=0;o<this.data.promotions.length;o++)if(this.data.promotions[o].path==t){s=!0;break}s||(this.data.promotions.push({path:t}),c=!0)}return c},CQ_Analytics.CartMgr.resolveServerPromotions=function(){if(!this.serverPromotionsMap)return!1;if(this.data.promotions||(this.data.promotions=[]),!CQ_Analytics.SegmentMgr.areSegmentsLoaded)return!1;for(var t,e=CQ_Analytics.SegmentMgr.getResolved(),i=[],n=0;n<this.serverPromotionsMap.length;n++){for(var r=this.serverPromotionsMap[n],a=r.segments.split(","),s=!1,o=0;o<a.length;o++)if(0<=$CQ.inArray(a[o],e)){s=!0;break}s&&i.push(r.path)}var l=!1;for(n=0;n<this.data.promotions.length;n++)if(this.data.promotions[n].resolve){for(t=this.data.promotions[n].path,s=!1,o=0;o<i.length;o++)if(i[o]==t){s=!0;break}s||(this.data.promotions.splice(n--,1),l=!0)}for(n=0;n<i.length;n++){for(t=i[n],s=!1,o=0;o<this.data.promotions.length;o++)if(this.data.promotions[o].path==t){s=!0;break}s||(this.data.promotions.push({path:t}),l=!0)}return l},CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.CCM.register(this),CQ_Analytics.SegmentMgr.addListener("update",function(){this.resolvePromotions()&&this.update()},CQ_Analytics.CartMgr),CQ_Analytics.SegmentMgr.addListener("update",function(){this.resolveServerPromotions()&&this.update()},CQ_Analytics.CartMgr)},CQ_Analytics.CartMgr)),CQ_Analytics.CartHelper||(CQ_Analytics.CartHelper={containsProduct:function(t,e,i){for(var n=e?e.substring(0,e.lastIndexOf("#")):null,r=0;t.entries&&r<t.entries.length;r++){var a=t.entries[r],s=a.page.substring(0,a.page.lastIndexOf("#"));if((!e||s==n)&&(!i||a.quantity>=i))return!0}return!1},containsPromotion:function(t,e,i,n){return!!e&&(!!i&&(!!n&&("contains"==n?r(t,e,i):"notcontains"==n&&!r(t,e,i))));function o(t){var e;return!t||-1<(e=t.lastIndexOf("#"))&&(t=t.substring(0,e)),t}function r(t,e,i){for(var n=o(e),r=t.promotions,a=0;r&&a<r.length;a++){var s=r[a];if(o(s.path)==n&&i==s.status)return!0}return!1}}}),CQ_Analytics.CampaignMgr||(CQ_Analytics.CampaignMgr=function(){},CQ_Analytics.CampaignMgr.prototype=new CQ_Analytics.PersistedSessionStore,CQ_Analytics.CampaignMgr.prototype.STOREKEY="CAMPAIGN",CQ_Analytics.CampaignMgr.prototype.STORENAME="campaign",CQ_Analytics.CampaignMgr.prototype.DEFAULT_EXPERIENCE="DEFAULT",CQ_Analytics.CampaignMgr.prototype.init=function(){this.persistence=new CQ_Analytics.SessionPersistence({container:"ClientContext"});var t=this.persistence.get(this.getStoreKey());if(this.data||(this.data={}),t&&""!==t){this.data=this.parse(t);t=this.getInitProperty("campaigns");t&&(this.data.campaigns=t)}else for(var e in this.initProperty)this.initProperty.hasOwnProperty(e)&&(this.data[e]=this.initProperty[e]);this.validate(),this.persist(),this.initialized=!0,this.fireEvent("initialize",this),this.fireEvent("update")},CQ_Analytics.CampaignMgr.prototype.validate=function(){this.data.campaigns&&(this.getCampaignBy("path",this.data.path)||this.getCampaignBy("id",this.data.id)||this.setCampaign(null),this.data["recipe/path"]!==CQ_Analytics.CampaignMgr.DEFAULT_EXPERIENCE&&(this.getExperienceBy("path",this.data["recipe/path"])||this.getExperienceBy("id",this.data["recipe/id"])||this.setExperience(null)))},CQ_Analytics.CampaignMgr.prototype.getCampaignBy=function(t,e){if(!this.data||!this.data.campaigns)return null;for(var i=this.data.campaigns,n=0;n<i.length;n++){var r=i[n];if(r[t]===e)return r}return null},CQ_Analytics.CampaignMgr.prototype.getExperienceBy=function(t,e){if(!this.data||!this.data.campaigns)return null;for(var i=this.data.campaigns,n=0;n<i.length;n++)for(var r=i[n],a=0;a<r.experiences.length;a++){var s=r.experiences[a];if(s[t]===e)return s}return null},CQ_Analytics.CampaignMgr.prototype.setCampaign=function(t){this.setProperties({name:t?t.title:"",path:t?t.path:"",id:t?t.id:"","recipe/name":t?CQ.I18n.getMessage("(default)"):"","recipe/path":t?this.DEFAULT_EXPERIENCE:"","recipe/id":t?this.DEFAULT_EXPERIENCE:""})},CQ_Analytics.CampaignMgr.prototype.setExperience=function(t){this.setProperties({"recipe/name":t?t.title:"","recipe/path":t?t.path:"","recipe/id":t?t.id:""})},CQ_Analytics.CampaignMgr.prototype.setProperty=function(t,e){"id"!==t&&"path"!==t?"recipe/id"!==t&&"recipe/path"!==t||e===CQ_Analytics.CampaignMgr.DEFAULT_EXPERIENCE?CQ_Analytics.PersistedSessionStore.prototype.setProperty.call(this,t,e):this.setExperience(this.getExperienceBy(t.substring("recipe/".length),e)):this.setCampaign(this.getCampaignBy(t,e))},CQ_Analytics.CampaignMgr.prototype.isCampaignSelected=function(){return""!==this.getProperty("path")},CQ_Analytics.CampaignMgr.prototype.clear=function(){this.data=null,this.initProperty={}},CQ_Analytics.CampaignMgr.prototype.getLabel=function(t){return t},CQ_Analytics.CampaignMgr.prototype.getLink=function(t){return""},CQ_Analytics.CampaignMgr=new CQ_Analytics.CampaignMgr,CQ_Analytics.CCM.register(CQ_Analytics.CampaignMgr)),CQ_Analytics.ActivityStreamMgr||(CQ_Analytics.ActivityStreamMgr=CQ_Analytics.JSONStore.registerNewInstance("activitystream",{}),CQ_Analytics.ActivityStreamMgr.internalRenderer=function(t,n){t+=".form.html";t+=CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/activitystream.html"),t+="?limit=3",CQ.shared.HTTP.get(t,function(t,e,i){$CQ("#"+n).children().remove(),e&&$CQ("#"+n).append(i.body)})},CQ_Analytics.ActivityStreamMgr.renderer=function(t,n){return t.isReady||(t.isReady=!0,CQ_Analytics.ClientContextUtils.onStoreRegistered("profile",function(t){t.addListener("update",function(t,e){var i=this.getProperty("path");i!=CQ_Analytics.ActivityStreamMgr.currentProfilePath&&(CQ_Analytics.ActivityStreamMgr.currentProfilePath=i,CQ_Analytics.ActivityStreamMgr.internalRenderer(i,n))},t);t=t.getProperty("path");CQ_Analytics.ActivityStreamMgr.currentProfilePath=t,CQ_Analytics.ActivityStreamMgr.internalRenderer(t,n)})),""}),function(S){function m(){}function v(t){E=[t]}function P(t,e,i){return t&&t.apply(e.context||e,i)}function M(t){return/\?/.test(t)?"&":"?"}var E,T="insertBefore",w="onclick",O="onerror",b="onreadystatechange",x="readyState",I="removeChild",D="<script>",R="success",N="timeout",L=window,U=S.Deferred,k=S("head")[0]||document.documentElement,F={},V=0,z={callback:"_jqjsp",url:location.href},H=L.opera,J=!!S("<div>").html("\x3c!--[if IE]><i><![endif]--\x3e").find("i").length;function t(e){var t,i,n,r,a=(e=S.extend({},z,e)).success,s=e.error,o=e.complete,l=e.dataFilter,c=e.callbackParameter,d=e.callback,C=e.cache,g=e.pageCache,y=e.charset,u=e.url,p=e.data,h=e.timeout,f=0,A=m;return U&&U(function(t){t.done(a).fail(s),a=t.resolve,s=t.reject}).promise(e),!(e.abort=function(){f++||A()})===P(e.beforeSend,e,[e])||f||(u=u||"",p=p?"string"==typeof p?p:S.param(p,e.traditional):"",u+=p?M(u)+p:"",c&&(u+=M(u)+encodeURIComponent(c)+"=?"),C||g||(u+=M(u)+"_"+(new Date).getTime()+"="),u=u.replace(/=\?(&|$)/,"="+d+"$1"),g&&(t=F[u])?t.s?_(t.s[0]):Q(t):(L[d]=v,(i=S(D)[0]).id="_jqjsp"+V++,y&&(i.charset=y),H&&H.version()<11.6?(n=S(D)[0]).text="document.getElementById('"+i.id+"')."+O+"()":i.async="async",J&&(i.htmlFor=i.id,i.event=w),i.onload=i[O]=i[b]=function(t){if(!i[x]||!/i/.test(i[x])){try{i[w]&&i[w]()}catch(t){}t=E,E=0,t?_(t[0]):Q("error")}},i.src=u,A=function(t){r&&clearTimeout(r),i[b]=i.onload=i[O]=null,k[I](i),n&&k[I](n)},k[T](i,y=k.firstChild),n&&k[T](n,y),r=0<h&&setTimeout(function(){Q(N)},h))),e;function _(t){f++||(A(),g&&(F[u]={s:[t]}),l&&(t=l.apply(e,[t])),P(a,e,[t,R,e]),P(o,e,[e,R]))}function Q(t){f++||(A(),g&&t!=N&&(F[u]=t),P(s,e,[e,t]),P(o,e,[e,t]))}}t.setup=function(t){S.extend(z,t)},S.jsonp=t}(jQuery),jQuery.murmurhash3=function(t,e){for(var i,n,r=3&t.length,a=t.length-r,s=e,o=3432918353,l=461845907,c=0;c<a;)n=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,s=27492+(65535&(i=5*(65535&(s=(s^=n=(65535&(n=(n=(65535&n)*o+(((n>>>16)*o&65535)<<16)&4294967295)<<15|n>>>17))*l+(((n>>>16)*l&65535)<<16)&4294967295)<<13|s>>>19))+((5*(s>>>16)&65535)<<16)&4294967295))+((58964+(i>>>16)&65535)<<16);switch(n=0,r){case 3:n^=(255&t.charCodeAt(c+2))<<16;case 2:n^=(255&t.charCodeAt(c+1))<<8;case 1:s^=n=(65535&(n=(n=(65535&(n^=255&t.charCodeAt(c)))*o+(((n>>>16)*o&65535)<<16)&4294967295)<<15|n>>>17))*l+(((n>>>16)*l&65535)<<16)&4294967295}return s^=t.length,s=2246822507*(65535&(s^=s>>>16))+((2246822507*(s>>>16)&65535)<<16)&4294967295,s=3266489909*(65535&(s^=s>>>13))+((3266489909*(s>>>16)&65535)<<16)&4294967295,(s^=s>>>16)>>>0},CQ_Analytics=window.CQ_Analytics||{},CQ_Analytics.AAM=CQ_Analytics.AAM||{},CQ_Analytics.AAM.AudienceMgr=CQ_Analytics.AAM.AudienceMgr||function(t){var e=t.partner||"geometrixx",l=t.destinationNames||{CQIntegrationDestination:{domain:".cqclientintegration.adobe.com",segkey:"segs",keysep:",",valsep:";"}},i=t.debug||!1,r=t.containerNSID||"0",a=!1;t.simulationPath&&(a=t.simulationPath+".segments.json");function s(t){console.log("ERROR: audiencemanager.js "+t)}var n=function(){};(n=i?function(t){console.log("DEBUG: audiencemanager.js "+t)}:n)("Initialise Audience Manager");var o={},c=CQ_Analytics.JSONStore.getInstance("audiencemgr",null,null,function(){this.init(),this.reset()}),d="http://";function C(){}function g(t){o={};var i=[];$.each(t,function(t,e){e&&(o[t]=!0,i.push(t))}),i.sort();var e=c.getProperty("segments"),t=i.join(",");e!==t&&(c.setProperty("segments",t),n("Set segments to "+t))}function y(t,n){var i;n=n||C,a?t.sid?$.getJSON(a,{t:t.sid},function(t){t.segments&&g(t.segments),n(),c.fireEvent("update")}).fail(function(t,e,i){s("Failed to resolve segments from AAM server  "+e+" error "+i),n(),c.fireEvent("update")}):(n(),c.fireEvent("update")):(i={},t=t||{},$.each(t,function(t,e){"sid"===t?i.d_sid=e:i["c_"+t]=e}),i.d_nsid=r,i.d_rtbd="json",$.jsonp({url:d,callback:"__aaminvoke",data:i,success:function(t,e,i){var o;t.stuff&&g((t=t.stuff,o={},$.each(t,function(t,e){var i,n,r,a,s;l[e.cn]&&(i=l[e.cn],e.dmn.slice(0,i.domain.length)===i.domain&&(n=(i.segkey||"segs")+"=",r=n.length,a=i.keysep||",",s=i.valsep||";",$.each(e.cv.split(a),function(t,e){e.slice(0,r)===n&&$.each(e.substring(r).split(s),function(t,e){o[e]=!0})})))}),o)),n(),c.fireEvent("update")},error:function(t,e){s("Failed to retieve json response "+e),n(),c.fireEvent("update")}}))}return"https:"==document.location.protocol&&(d="https://"),d+=encodeURIComponent(e)+".demdex.net/event?d_cb=?",y(!1,function(){CQ_Analytics.ClientContextMgr.register(c)}),c.getUserSegments=function(){return o},c.matches=function(t){return o[t]},c.invoke=y,c.STOREKEY="audiencemgr",c},CQ_Analytics.StrategyMgr.register("random-custom",function(t){var e=Math.random();1<parseFloat(e)&&(e=1/e),1==parseFloat(e)&&(e=0);for(var i=-1,n=0;n<t.length;n++)"default"==t[n].name&&(i=n);return-1<i&&t.splice(i,1),t[Math.floor(e*t.length)]}),CQ_Analytics.StrategyMgr.register("list-custom",function(t){return t}),CQ_Analytics.Utils.isOptimizedCC=!1,CQ_Analytics.Utils.loadTeaserElement=function(r,n){var e,a=function(t,e){CQ_Analytics.Utils.teasersCache||(CQ_Analytics.Utils.teasersCache={}),CQ_Analytics.Utils.teasersCache[t]=e},s=function(){var t=CQ.shared.HTTP.getSelectors(r);-1!=r.indexOf("globalheaderfooter")&&0!=t.length&&(r=r.substring(0,r.indexOf(t[0])).concat(t[0],".html"),void 0!==CQ.WCM&&CQ.WCM.isEditMode&&(r+="?wcmmode=disabled")),CQ_Analytics.Utils.teasersCache&&CQ_Analytics.Utils.teasersCache[r]?function(t){var e,i;t&&""!=t&&(e=r.replace(new RegExp("/","g"),"|").replace(".html",""),i=$CQ(t).css("display","none"),(t=document.getElementById(n)).setAttribute("data-campaign-url",e),$CQ("#"+n).html(i),t&&t.parentElement&&($CQ(t.parentElement).trigger("target-dom-loaded"),$CQ(window).trigger("resize")),this.resetHieghtTimer||(window.setTimeout(function(){$CQ(".content-container .target:first-child").css("min-height","0px")},50),this.resetHieghtTimer=!0),i.fadeIn())}(CQ_Analytics.Utils.teasersCache[r]):(CQ_Analytics.Utils.teasersLoading=CQ_Analytics.Utils.teasersLoading||{},CQ_Analytics.Utils.teasersLoading[r]?window.setTimeout(function(){CQ_Analytics.Utils.loadTeaserElement(r,n)},100):(CQ_Analytics.Utils.teasersLoading[r]=!0,function(){var t=r,e=location.href;if(typeof CQ_CONTENT_PATH!="undefined")e=CQ_CONTENT_PATH;var i=CQ.shared.HTTP.getParameter(e,"wcmmode");if(i)t+=(t.indexOf("?")>0?"&":"?")+"wcmmode="+i;CQ.shared.HTTP.get(t,function(t,e,i){if(e){var n=i.body;if(n){n=n.replace(new RegExp("\\n","ig"),"");n=n.replace(new RegExp("\\r","ig"),"");a(r,n);delete CQ_Analytics.Utils.teasersLoading[r];s()}}else a(r,"")})}()))},i=$CQ("#"+n).children().length;0<i&&-1==n.indexOf("globalheaderfooter")&&!CQ_Analytics.Utils.isOptimizedCC?(e=0,$CQ("#"+n).children().fadeOut(function(){var t=$CQ(this);window.setTimeout(function(){t.remove(),i<=++e&&s()},50)})):s()},CQ_Analytics.IMAppsStore||(CQ_Analytics.IMAppsStore=CQ_Analytics.JSONPStore.registerNewInstance("imAppsStore"),CQ_Analytics.IMAppsStore.initialized=!1,CQ_Analytics.IMAppsStore.init=function(){var t=document.location.protocol+"//sync.im-apps.net/imid/segment?token=CmOnEerIz4AxiIkb8Mzm7Q";$.ajax({url:t,type:"GET",dataType:"JSONP",success:function(t){if(t&&t.segment_eids){var e,i=[];for(e in t.segment_eids)"string"==typeof t.segment_eids[e]&&i.push(t.segment_eids[e]);t.segment_eids=i.join(", ")}CQ_Analytics.IMAppsStore.data=t,CQ_Analytics.IMAppsStore.initialized=!0,CQ_Analytics.IMAppsStore.fireEvent("initialize",CQ_Analytics.IMAppsStore),CQ_Analytics.IMAppsStore.fireEvent("update")},error:function(t,e,i){console.error("Ajax request towards Intimate Merger API failed: "+i)},timeout:3e3})},CQ_Analytics.IMAppsStore.getValue=function(t){return CQ_Analytics.IMAppsStore.data&&CQ_Analytics.IMAppsStore.data[t]?CQ_Analytics.IMAppsStore.data[t].value:""}),CQ_Analytics.kruxStore||(CQ_Analytics.kruxStore=CQ_Analytics.JSONStore.registerNewInstance("kruxStore"),CQ_Analytics.kruxStore.initialized=!1,CQ_Analytics.kruxStore.supportsLocalStorage=function(){return"undefined"!=typeof Storage},CQ_Analytics.kruxStore.finishInit=function(){CQ_Analytics.kruxStore.initialized=!0,CQ_Analytics.kruxStore.fireEvent("initialize",CQ_Analytics.kruxStore),CQ_Analytics.kruxStore.fireEvent("update")},CQ_Analytics.kruxStore.grabKruxDataFromLocalStorage=function(){var t=new Object,t=CQ_Analytics.kruxStore.getLocalStoreProperties();0!==Object.keys(t).length&&0!==localStorage.length||(t=CQ_Analytics.kruxStore.getDefaultKruxObject()),CQ_Analytics.kruxStore.data=t},CQ_Analytics.kruxStore.getLocalStoreProperties=function(){var i=new Object;return $.each(localStorage,function(t,e){t.toString().match("^kxsfdc_")&&(t=t.toString(),i[t]=e)}),i},CQ_Analytics.kruxStore.init=function(){CQ_Analytics.kruxStore.supportsLocalStorage()&&(CQ_Analytics.kruxStore.grabKruxDataFromLocalStorage(),CQ_Analytics.kruxStore.finishInit())},CQ_Analytics.kruxStore.getValue=function(t){return CQ_Analytics.kruxStore.data&&CQ_Analytics.kruxStore.data[t]?CQ_Analytics.kruxStore.data[t].value:""},CQ_Analytics.kruxStore.getDefaultKruxObject=function(){return{kxsfdc_apac_geo:"-",kxsfdc_apac_kuid:"-",kxsfdc_apac_segs:"-",kxsfdc_apac_tech:"-",kxsfdc_apac_user:"-",kxsfdc_us_geo:"-",kxsfdc_us_kuid:"-",kxsfdc_us_segs:"-",kxsfdc_us_tech:"-",kxsfdc_us_user:"-"}}),function(){var a,s,n;CQ_Analytics.DreamforceSegmentUtils||(CQ_Analytics.DreamforceSegmentUtils=CQ_Analytics.JSONStore.registerNewInstance("dreamforcesegment"),CQ_Analytics.DreamforceSegmentUtils.currentId="",CQ_Analytics.DreamforceSegmentUtils.initialized=!1,a=function(){for(var t in CQ_Analytics.DreamforceSegmentUtils.initProperty)CQ_Analytics.DreamforceSegmentUtils.initProperty.hasOwnProperty(t)&&(CQ_Analytics.DreamforceSegmentUtils.data[t]=CQ_Analytics.DreamforceSegmentUtils.initProperty[t]);CQ_Analytics.DreamforceSegmentUtils.initialized=!0,CQ_Analytics.DreamforceSegmentUtils.fireEvent("initialize",CQ_Analytics.DreamforceSegmentUtils),CQ_Analytics.DreamforceSegmentUtils.fireEvent("update")},s=function(t,e){var i=new CustomEvent("dfdataloaded",{detail:"DF Visitor Profile data is set"});$.ajax({type:"GET",url:t,success:function(t){CQ_Analytics.DreamforceSegmentUtils.data.visitorprofile=t.dfstatus,CQ_Analytics.DreamforceSegmentUtils.data.eventId=t.eventId,t.fname&&(CQ_Analytics.DreamforceSegmentUtils.data.fname=t.fname),t.role&&(CQ_Analytics.DreamforceSegmentUtils.data.role=t.role),a(),n(t),document.dispatchEvent(i)},async:e})},n=function(t){var e;void 0!==t.reg_id&&"undefined"!=typeof digitalData&&((e=digitalData.util).addPageData("tzregid",t.reg_id),e.addBehavior("eventregidsuccess"))},CQ_Analytics.DreamforceSegmentUtils.init=function(){var t=location.href,e=CQ.shared.HTTP.getParameter(t,"forceDreamforceProfile"),i=CQ.shared.HTTP.getParameter(t,"role"),n=CQ.shared.HTTP.getParameter(t,"fname"),r="/wbin/dreamforce/v1/status"+("?eventId="+$(".eventId").attr("val")),t=location.hostname;"sfdc.local"!==t&&"localhost"!==t||(r="http://"+t+":8080"+r);t=!1;document.getElementById("regStatusCallType")&&(t="true"==document.getElementById("regStatusCallType").getAttribute("content")),e?(CQ_Analytics.DreamforceSegmentUtils.data={visitorprofile:e,role:i,fname:n},a()):s(r,!!t)})}(),CQ_Analytics.VideoMetadataStore||(CQ_Analytics.VideoMetadataStore=CQ_Analytics.JSONStore.registerNewInstance("videoMetadataStore"),CQ_Analytics.VideoMetadataStore.currentId="",CQ_Analytics.VideoMetadataStore.init=function(){var t="",e=decodeURIComponent((new RegExp("[?|&]debugVideoId=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null;e?t=e:void 0!==window.vidyardPlayerID&&(t=window.vidyardPlayerID);var i="",e=window.eventprefix||"";if(""!=(i=""!=t?"https://a.sfdcstatic.com/"+e+"_video-detail-"+t+".json":"https://a.sfdcstatic.com/df15_sflive-segments-template.json"))try{var n,r=null;$.browser.msie&&window.XDomainRequest?((n=new XDomainRequest).onload=function(){r=$.parseJSON(n.responseText),CQ_Analytics.VideoMetadataStore.initData(r)},n.onprogress=function(){},n.open("get",i),n.send()):$.getJSON(i,function(t){r=t,CQ_Analytics.VideoMetadataStore.initData(r)}),r&&CQ_Analytics.VideoMetadataStore.initData(r)}catch(t){console.log("Error",t)}},CQ_Analytics.VideoMetadataStore.initData=function(t){for(var e in CQ_Analytics.VideoMetadataStore.data=t,CQ_Analytics.VideoMetadataStore.initProperty)CQ_Analytics.VideoMetadataStore.initProperty.hasOwnProperty(e)&&(CQ_Analytics.VideoMetadataStore.data[e]=CQ_Analytics.VideoMetadataStore.initProperty[e]);CQ_Analytics.VideoMetadataStore.initialized=!0,CQ_Analytics.VideoMetadataStore.fireEvent("initialize",CQ_Analytics.VideoMetadataStore),CQ_Analytics.VideoMetadataStore.fireEvent("update")},CQ_Analytics.VideoMetadataStore.initialized=!1,CQ_Analytics.VideoMetadataStore.getValue=function(t){return CQ_Analytics.VideoMetadataStore.data&&CQ_Analytics.VideoMetadataStore.data[t]?CQ_Analytics.VideoMetadataStore.data[t].value:""}),CQ_Analytics.SFDCSegmentUtils||(CQ_Analytics.SFDCSegmentUtils=CQ_Analytics.JSONStore.registerNewInstance("sfdcsegment"),CQ_Analytics.SFDCSegmentUtils.currentId="",CQ_Analytics.SFDCSegmentUtils.initialized=!1,CQ_Analytics.SFDCSegmentUtils.init=function(){var t,e="undefined"!=typeof vp&&vp.isCustomer()?"customer":"prospect",i=location.href,i=CQ.shared.HTTP.getParameter(i,"forceProfile");for(t in i&&0<=["customer","prospect"].indexOf(i)&&(e=i),CQ_Analytics.SFDCSegmentUtils.data={visitorprofile:e},CQ_Analytics.SFDCSegmentUtils.initProperty)CQ_Analytics.SFDCSegmentUtils.initProperty.hasOwnProperty(t)&&(CQ_Analytics.SFDCSegmentUtils.data[t]=CQ_Analytics.SFDCSegmentUtils.initProperty[t]);CQ_Analytics.SFDCSegmentUtils.initialized=!0,CQ_Analytics.SFDCSegmentUtils.fireEvent("initialize",CQ_Analytics.SFDCSegmentUtils),CQ_Analytics.SFDCSegmentUtils.fireEvent("update")}),function(){var i;CQ_Analytics.DemandbaseStore||(CQ_Analytics.DemandbaseStore=CQ_Analytics.JSONStore.registerNewInstance("demandbaseStore"),CQ_Analytics.DemandbaseStore.currentId="",CQ_Analytics.DemandbaseStore.initialized=!1,CQ_Analytics.DemandbaseStore.init=function(){var t,e;CQ_Analytics.DemandbaseStore.data="undefined"!=typeof vp&&vp.db,CQ_Analytics.DemandbaseStore.data?i():(t=document.location.protocol,e=CQ.shared.HTTP.getParameter(document.location.href,"ipOverride"),$.get(t+"//api.company-target.com/api/v2/ip.json?token=09dd7a8bed725339af3ce985f86800730b42b5cf"+(""!=e&&null!=e?"&query="+e:"")).done(function(t){CQ_Analytics.DemandbaseStore.data=t,i()}))},CQ_Analytics.DemandbaseStore.getValue=function(t){return CQ_Analytics.DemandbaseStore.data&&CQ_Analytics.DemandbaseStore.data[t]?CQ_Analytics.DemandbaseStore.data[t].value:""},i=function(){for(var t in CQ_Analytics.DemandbaseStore.initProperty)CQ_Analytics.DemandbaseStore.initProperty.hasOwnProperty(t)&&(CQ_Analytics.DemandbaseStore.data[t]=CQ_Analytics.DemandbaseStore.initProperty[t]);CQ_Analytics.DemandbaseStore.initialized=!0,CQ_Analytics.DemandbaseStore.fireEvent("initialize",CQ_Analytics.DemandbaseStore),CQ_Analytics.DemandbaseStore.fireEvent("update")})}();
