(this.$WP=this.$WP||[]).push(["mT-Pb2",(e,n)=>{"use strict";var i,o,t,a,s,l,r,u,c,d,g,f,m,p,y,S,I,C=["OPTIMUS_BRANDED","OPTIMUS_BRANDED_IMAGE_HIGHLIGHT"],O=["OPTIMUS_BRANDED_IMAGE_HIGHLIGHT"],v=({allowClose:e,flow:n,forceLogin:a,contextualMessagingVariant:s,contextualMessageKey:r,contextualMessageParamKey:u,contextualMessageParam:d,contextualMessageSubheaderKey:g,isSignInOnly:f,onClose:m,onFailure:p,funnelKey:y,pid:S})=>{var{login:I,close:v}=c(),b="MOBILE"===i(l).viewportCategory,M=o(()=>{var e={contextualMessage:r,contextualMessageParamKey:u,contextualMessageParam:d,contextualMessageSubheader:g};return Object.assign({},s?{}:e,{isSignInOnly:f,contextualMessagingVariant:s,funnelKey:y})},[r,d,u,g,s,f,y]),k=O.includes((n||"").toUpperCase()),x=!b&&C.includes((n||"").toUpperCase());return{login:t(i=>I({flowOrigin:"login",flow:n,isFullWidthMobile:!0,forceLogin:a,requireSecure:a,closeX:e,closeOnDocClick:e,roundedCorners:x,hideBoxShadow:k,extraQueryParams:M,pid:S||40777,onSuccess:i||void 0,onClose:m,onFailure:p}),[e,M,x,k,n,a,I,m,p,S]),close:v}},b=({members:e,nonMembers:n,messageVariant:o,onClose:l,flow:u="OPTIMUS_BRANDED",funnelKey:c,pid:m})=>{var{userId:p}=i(r),y=f(),I=g("phoenix_plus"),{login:C}=v(Object.assign({allowClose:!0,forceLogin:!1},o&&{flow:u,contextualMessagingVariant:o},{onClose:l,funnelKey:c,pid:m})),[O,b]=a(!1),[{data:M,fetching:k},x]=d({query:S,pause:!p});return s(()=>{p&&x({requestPolicy:"network-only"})},[x,p]),s(()=>{(p||I)&&O&&!k&&((null==M?void 0:M.OptimusBenefits_isSubscribedToOptimus)?y(e):y(n))},[M,k,e,y,n,O,p,I]),t(()=>{p||I?b(!0):C(()=>{b(!0)})},[C,b,p,I])},M=()=>{var e=m(),[{page:n}]=i(u);return t(({locationId:i,listingKey:o=null,funnelKey:t})=>{if(!i||!t)throw new Error("Unable to record user login. Missing offer data - "+JSON.stringify({locationId:i,funnelKey:t}));e({OptimusOffer:{optimusInitialOfferSignedIn:{servletName:n,locationId:i,funnelKey:t,listingKey:o}}})},[e,n])},k=({children:e,forceLogin:n,loginContextualMessageKey:o,shouldLogoutAfterPaymentFailures:l=!1,renderBeforeLogout:c})=>{var[d,g]=a(!n),[f,m]=a(!1),[y]=i(u),{failedCardPayment:S,hasBlockedCardInSession:I,hadBlockedCard:C,clearAllBlockedCards:O}=p(),b=C()?"plus_too_many_failed_payments":o,{login:M}=v({allowClose:!1,forceLogin:n,contextualMessageKey:b}),{userId:k}=i(r);s(()=>{k&&d||f||(m(!0),M(()=>g(!0)).finally(()=>m(!1)))},[M,d,f,k]);var x=t(()=>{window.location=`/RegistrationController?flow=${encodeURIComponent("SIGN_OUT")}&pid=${encodeURIComponent(String(v))}&returnTo=${encodeURIComponent(y.path)}&fullscreen=true`},[y.path]),_=l&&I();return s(()=>{_&&x()},[_,x]),_?c?c():null:k&&d?(O(),e({userId:k,failedCardPayment:S})):null},x=e=>!!(null==e?void 0:e.canAccessSecureContent),_=({children:e,contextualMessageKey:n,renderNotSecure:o,skip:t})=>{var{login:l,close:u}=v({allowClose:!1,forceLogin:!0,contextualMessageKey:n}),[{data:c,fetching:d},g]=(()=>{var{userId:e}=i(r),[n,o]=a(null),[t,l]=y({query:I,pause:!e},x);return s(()=>{e!==n&&(o(e),l())},[l,n,e]),s(()=>()=>o(null),[o]),[t,l]})(),[f,m]=a(!1);return s(()=>{c||d||f||t||l(()=>{g(),m(!0)})},[c,g,d,l,f,m,t]),s(()=>()=>u(),[u]),c||t?e():o?o():null};return[()=>{(S=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"IsSubscribed"},"variableDefinitions":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"OptimusBenefits_isSubscribedToOptimus"},"arguments":[],"directives":[]}]}}],"loc":{"start":0,"end":71}}')).__key=93070980626319,S.loc.source={body:"54a5c6bd378f"},(I=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"CanAccessSecureContent"},"variableDefinitions":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","alias":{"kind":"Name","value":"canAccessSecureContent"},"name":{"kind":"Name","value":"OptimusBenefits_canAccessSecureContent"},"arguments":[],"directives":[]}]}}],"loc":{"start":0,"end":106}}')).__key=0xb7349ab36c89,I.loc.source={body:"b7349ab36c89"},e({OptimusHardGate:k,OptimusSecureLoginGate:_,useOptimusLogin:v,useOptimusLoginNavigation:b,useOptimusLoginTracking:M})},[e=>(i=e.useContext,o=e.useMemo,t=e.useCallback,a=e.useState,s=e.useEffect),e=>(l=e.Device,r=e.Visitor,u=e.Route),e=>c=e.default,e=>d=e.useQuery,e=>g=e.featureIsEnabled,e=>f=e.useNavigate,e=>m=e.useInteractionLogger,e=>p=e.default,e=>y=e.default]]},["cDcdfi","2R4xv2","VANuRt","5X2em-","-i3PJS","1yEXVQ","fsml46","gYZdI4","kYmwth"]]);