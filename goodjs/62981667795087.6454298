define("lofty/lang/attribute",["lofty/lang/class"],function(t){"use strict";function u(t){return"[object String]"===g.call(t)}function l(t){if(t&&"[object Object]"===g.call(t)&&!t.nodeType&&(null==(r=t)||r!=r.window)){var r,e;try{if(t.constructor&&!i.call(t,"constructor")&&!i.call(t.constructor.prototype,"isPrototypeOf"))return}catch(t){return}if(n)for(e in t)return i.call(t,e);for(e in t);return void 0===e||i.call(t,e)}}function a(t){if(!t||"[object Object]"!==g.call(t))return!1;for(var r in t)if(t.hasOwnProperty(r))return!1;return!0}function f(t,r){var e,n,i;for(e in r)r.hasOwnProperty(e)&&(i=r[e],o(i)?i=i.slice():l(i)&&(i=f(n=!l(n=t[e])?{}:n,i)),t[e]=i);return t}function s(t,r){var e,n={};for(e in t){var i=t[e];n[e]=!r&&l(i)&&function(t,r){for(var e=0,n=r.length;e<n;e++)if(t.hasOwnProperty(r[e]))return!0;return!1}(i,c)?i:{value:i}}return n}function h(t){return null==t||(u(t)||o(t))&&0===t.length||a(t)}var n,t=t({initOptions:function(t){var r=this.options={};(function(t,r){for(var e=[],n=r.constructor.prototype;n;)n.hasOwnProperty("options")||(n.options={}),a(n.options)||e.unshift(n.options),n=n.constructor.superclass;for(var i=0,o=e.length;i<o;i++)f(t,s(e[i]))})(r,this),t&&f(r,s(t,!0)),function(t,r,e){var n,i={silent:!0};for(n in t.__initializingAttrs=!0,e)e.hasOwnProperty(n)&&r[n].setter&&t.set(n,r[n].value,i);delete t.__initializingAttrs}(this,r,t)},get:function(t){var r=this.options[t]||{},e=r.value;return r.getter?r.getter.call(this,e,t):e},set:function(t,r,e){var n={};u(t)?n[t]=r:(n=t,e=r);var i=(e=e||{}).silent,o=e.override,a=this.options,s=this.__changedAttrs||(this.__changedAttrs={});for(t in n)if(n.hasOwnProperty(t)){var c=a[t]||(a[t]={});if(r=n[t],c.readOnly)throw new Error("This attribute is readOnly: "+t);c.setter&&(r=c.setter.call(this,r,t));c=this.get(t);!o&&l(c)&&l(r)&&(r=f(f({},c),r)),a[t].value=r,this.__initializingAttrs||function t(r,e){if(r===e)return 1;if(h(r)&&h(e))return 1;var n=g.call(r);if(n==g.call(e)){switch(n){case"[object String]":return r==String(e);case"[object Number]":return r!=+r?e!=+e:0==r?1/r==1/e:r==+e;case"[object Date]":case"[object Boolean]":return+r==+e;case"[object RegExp]":return r.source==e.source&&r.global==e.global&&r.multiline==e.multiline&&r.ignoreCase==e.ignoreCase;case"[object Array]":var i=r.toString(),o=e.toString();return-1===i.indexOf("[object")&&-1===o.indexOf("[object")&&i===o}if("object"==typeof r&&"object"==typeof e&&l(r)&&l(e)&&t(p(r),p(e))){for(var a in r)if(r[a]!==e[a])return;return 1}}}(c,r)||(i?s[t]=[r,c]:this.trigger(t+"Changed",r,c,t))}return this},change:function(){var t,r=this.__changedAttrs;if(r){for(var e in r)r.hasOwnProperty(e)&&(t=r[e],this.trigger(e+"Changed",t[0],t[1],e));delete this.__changedAttrs}return this}}),g=Object.prototype.toString,i=Object.prototype.hasOwnProperty;!function(){function t(){this.x=1}var r,e=[];for(r in t.prototype={valueOf:1,y:1},new t)e.push(r);n="x"!==e[0]}();var o=Array.isArray||function(t){return"[object Array]"===g.call(t)},p=(p=Object.keys)||function(t){var r,e=[];for(r in t)t.hasOwnProperty(r)&&e.push(r);return e},c=["value","getter","setter","readOnly"];return t});
