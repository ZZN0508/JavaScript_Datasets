!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.Jackdaw=n():e.Jackdaw=n()}(this,function(){return r=[function(e,n,t){"use strict";function _(e){this.name="JackdawError",this.message=e}function q(e,n){function t(e,n){n=n||{};e=(e=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+))?@)([\w.-]+)(?::(\d+))?\/(.+)/.exec(e=e))?((e={protocol:e[1],user:e[2],pass:e[3]||"",host:e[4],port:e[5]||"",projectId:e[6]}).endpoint=e.protocol+"://"+e.host+(e.port?":"+e.port:"")+"/api/"+e.projectId+"/store/?sentry_version=7&sentry_key="+e.user+(e.pass?"&sentry_secret="+e.pass:""),e):"";return M=x(M,{project:e.projectId}),(M=x(M,n||{})).maxBreadcrumbs=Math.max(0,Math.min(M.maxBreadcrumbs,100)),F=e.endpoint,D=M.transport=n.transport||f,this}function i(e){return"[object DOMError]"===Object.prototype.toString.call(e)}function o(e,n){M.debug&&console.log(n)}function a(){return E&&v()-O<E}function c(e){return S&&(e.stacktrace||S.stacktrace?r(e.stacktrace,S.stacktrace):e.exception||S.exception?(n=e.exception,t=S.exception,!p(n,t)&&(n=n.values[0],t=t.values[0],n.type===t.type&&n.value===t.value&&!function(e,n){return d(e)&&d(n)}(n.stacktrace,t.stacktrace)&&r(n.stacktrace,t.stacktrace))):e.fingerprint||S.fingerprint?Boolean(e.fingerprint&&S.fingerprint)&&m(e.fingerprint)===m(S.fingerprint):(t=e.message,e=S.message,(t||e)&&!(t&&!e||!t&&e)&&t===e));var n,t}function u(e,n,t){if(a())return n&&n(new _("Should back off")),0;if(c(e))return o(0,"Jackdaw dropped repeat event: "),n&&n(new _("Dropped repeat event")),0;(e=x(M,e)).tag=e.tag||{},e.extra=e.extra||{},e.extra["session:duration"]=v()-b,k&&0<k.length&&(e.breadcrumbs={values:[].slice.call(k,0)}),w=e.event_id="xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=16*Math.random()|0;return("x"===e?n:3&n|8).toString(16)}),S=e,o(0,"Jackdaw about to send:");var r=j=e.exception&&e.exception.values[0];y.addBreadcrumb({category:"sentry",message:r?(r.type?r.type+": ":"")+r.value:e.message,event_id:w,level:e.level||"error"});try{t({url:F,data:e,onSuccess:function(){E=0,O=null,n&&n()},onError:function(e){o(0,"Jackdaw transport failed to send: "),e.request&&function(e){if(a())return o(0,"Should back off");var n,t=e.status;if(400===t||401===t||429===t){try{n=e.getResponseHeader("Retry-After"),n=1e3*parseInt(n,10)}catch(e){}E=n||2*E||1e3,O=v()}}(e.request),n&&n(e)}})}catch(e){n&&n(e)}}function l(e,n){function d(){try{return B.location.href}catch(e){}return""}function s(e,n){for(var t,r,o=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,a=[],i={},c=!1,u=s.caller;u&&!c;u=u.caller)if(u!==l){if(r={url:null,func:"?",line:null,column:null},u.name?r.func=u.name:(t=o.exec(u.toString()))&&(r.func=t[1]),void 0===r.func)try{r.func=t.input.substring(0,t.input.indexOf("{"))}catch(e){}i[""+u]?c=!0:i[""+u]=!0,a.push(r)}n&&a.splice(0,n);n={name:e.name,message:e.message,url:d(),stack:a};return function(e,n,t){if((t={url:n,line:t}).url&&t.line){if(e.incomplete=!1,t.func||(t.func="?"),0<e.stack.length&&e.stack[0].url===t.url){if(e.stack[0].line===t.line)return;if(!e.stack[0].line&&e.stack[0].func===t.func)return e.stack[0].line=t.line}return e.stack.unshift(t),e.partial=!0}e.incomplete=!0}(n,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),n}var t=null;n=null==n?0:+n;try{if(t=function(e){if(void 0!==e.stack&&e.stack){for(var n,t,r=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|[a-z]:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,o=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx(?:-web)|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,a=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,i=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,c=/\((\S*)(?::(\d+))(?::(\d+))\)/,u=e.stack.split("\n"),s=[],l=0,f=u.length;l<f;++l){if(t=r.exec(u[l])){var p=t[2]&&0===t[2].indexOf("native");t[2]&&0===t[2].indexOf("eval")&&(n=c.exec(t[2]))&&(t[2]=n[1],t[3]=n[2],t[4]=n[3]),p={url:p?null:t[2],func:t[1]||"?",args:p?[t[2]]:[],line:t[3]?+t[3]:null,column:t[4]?+t[4]:null}}else if(t=o.exec(u[l]))p={url:t[2],func:t[1]||"?",args:[],line:+t[3],column:t[4]?+t[4]:null};else{if(!(t=a.exec(u[l])))continue;t[3]&&-1<t[3].indexOf(" > eval")&&(n=i.exec(t[3]))?(t[3]=n[1],t[4]=n[2],t[5]=null):0!==l||t[5]||void 0===e.columnNumber||(s[0].column=e.columnNumber+1),p={url:t[3],func:t[1]||"?",args:t[2]?t[2].split(","):[],line:t[4]?+t[4]:null,column:t[5]?+t[5]:null}}!p.func&&p.line&&(p.func="?"),s.push(p)}return s.length?{name:e.name,message:e.message,url:d(),stack:s}:null}}(e))return t}catch(e){}try{if(t=s(e,n+1))return t}catch(e){}return{name:e.name,message:e.message,url:d()}}function s(o,e){var a=[];if(o.stack&&o.stack.length&&(g(o.stack,function(e,n){var t,r,r=(t=o.url,r={filename:n.url,lineno:n.line,colno:n.column,function:n.func||"?"},n.url||(r.filename=t),r);r&&a.push(r)}),e&&e.trimHeadFrames))for(var n=0;n<e.trimHeadFrames&&n<a.length;n++)a[n].in_app=!1;return a=a.slice(0,50)}function r(e,n){if(p(e,n))return!1;var t=e.frames,r=n.frames;if(void 0===t||void 0===r)return!1;if(t.length!==r.length)return!1;for(var o,a,i=0;i<t.length;i++)if(o=t[i],a=r[i],o.filename!==a.filename||o.lineno!==a.lineno||o.colno!==a.colno||o.function!==a.function)return!1;return!0}function f(n){var e=n.url,t=J.XMLHttpRequest&&new J.XMLHttpRequest;if(!t)return!1;var r="withCredentials"in t;if(!r&&void 0===J.XDomainRequest)return!1;r?t.onreadystatechange=function(){var e;4!==t.readyState||(200===t.status?n.onSuccess&&n.onSuccess():n.onError&&((e=new _("Transport error code: "+t.status)).request=t,n.onError(e)))}:(t=new J.XDomainRequest,e=e.replace(/^https?:/,""),n.onSuccess&&(t.onload=n.onSuccess),n.onError&&(t.onerror=function(){var e=new _("Transport error code: XDomainRequest");e.request=t,n.onError(e)})),t.open("POST",e,!0),t.send(m(n.data))}function p(e,n){return!!e^!!n}function d(e){return void 0===e}function m(e){return(JSON.stringify||function e(n){var t=void 0===n?"undefined":A(n);if("object"!==t||null===n)return"string"===t&&(n='"'+n+'"'),String(n);var r,o,a=[],i=n&&n.constructor===Array;for(r in n)o=n[r],t=void 0===o?"undefined":A(o),"string"===t?o='"'+o+'"':"object"===t&&null!==o&&(o=e(o)),a.push((i?"":'"'+r+'":')+String(o));return(i?"[":"{")+String(a)+(i?"]":"}")})(e)}function x(t,e){return e&&g(e,function(e,n){t[e]=n}),t}function g(e,n){var t,r;if("function"==typeof n)if(e.length){if(r=e.length)for(t=0;t<r;t++)n.call(null,t,e[t])}else for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.call(null,t,e[t])}function v(){return+new Date}if(this instanceof q==0)return new q(e,n);if(!e)throw new _("All I want is a public DSN string");var h=q._instanceMap=q._instanceMap||{};if(h[e])return n&&h[e].config(e,n),h[e];var y=h[e]=this,b=v(),k=[],w=null,S=null,j=null,E=0,O=null,F=null,M={logger:"javascript",platform:"javascript",request:{headers:{"User-Agent":H.userAgent},url:B.location.href,referrer:B.referrer},sdk:{name:"@kakao/jackdaw-js",version:"1.0.5"},level:"error",maxBreadcrumbs:100,debug:!1},D=f;this.config=t,this.addBreadcrumb=function(e){e=x({timestamp:v()/1e3},e);return k.push(e),k.length>M.maxBreadcrumbs&&k.splice(0,k.length-M.maxBreadcrumbs),this},this.captureMessage=function(e,n,t){var r=D;if(!e)throw new _("Need something to send message");return n&&"function"==typeof n.transport&&(r=n.transport,delete n.transport),u(x({message:e+""},n||{}),t,r),this},this.captureException=function(e,n,t){var r,o=D;if(!e)throw new _("Need something to send exception or error");if(n&&"function"==typeof n.transport&&(o=n.transport,delete n.transport),i(e=e.error?e.error:e)||(r=e,"[object DOMException]"===Object.prototype.toString.call(r))){var a=e.name||(i(e)?"DOMError":"DOMException"),a=e.message?a+": "+e.message:a;return this.captureMessage(a,x(n,{stacktrace:!0,trimHeadFrames:n.trimHeadFrames+1}))}j=e,(n=x({trimHeadFrames:0},n||{})).level=n.level||"error";a=l(e),e=s(a);return u(function(e,n,t,r,o,a){o&&o.length?(t=o[0].filename||t,o.reverse(),i={frames:o}):t&&(i={frames:[{filename:t,lineno:r,in_app:!0}]});var i=x({exception:{values:[{type:e,value:n,stacktrace:i}]}},a);return null==(a=i.exception.values[0]).type&&""===a.value&&(a.value="Unrecoverable error caught"),i}(a.name,a.message,a.url,a.lineno,e,n),t,o),this},this.lastException=function(){return j},this.lastData=function(){return S},this.lastEventId=function(){return w},t(e,n)}var A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},B=J.document,H=J.navigator;J.Jackdaw||(J.Jackdaw=q),(_.prototype=new Error).constructor=_,e.exports=q}],o={},t.m=r,t.c=o,t.p="",t(0);function t(e){if(o[e])return o[e].exports;var n=o[e]={exports:{},id:e,loaded:!1};return r[e].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r,o});
