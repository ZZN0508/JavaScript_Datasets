!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define("GadgetPlatform",n()):(e=e||self).GadgetPlatform=n()}(this,function(){"use strict";function i(){try{localStorage.setItem("ebay-font",n)}catch(e){}}function e(){var e,n,t;(t=(t=o&&o.load)&&/Apple/.test(window.navigator.vendor)?!((n=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent))&&parseInt(n[1],10)<603):t)?(o.load("1em Market Sans"),o.load("bold 1em Market Sans"),o.ready.then(i)):(e="https://ir.ebaystatic.com/cr/v/c1/vendor/fontfaceobserver.js",n=function(){var e=new FontFaceObserver("Market Sans"),n=new FontFaceObserver("Market Sans",{weight:"bold"});Promise.all([e.load(),n.load()]).then(i)},(t=document.createElement("script")).type="application/javascript",t.async=!0,t.onload=n,t.src=e,(e=document.getElementsByTagName("script")[0]).parentNode.insertBefore(t,e))}var o,n;function t(e,n){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),i=1;i<arguments.length;i++){var o=arguments[i];if(null!=o)for(var r=Object.keys(Object(o)),a=0,d=r.length;a<d;a++){var s=r[a],c=Object.getOwnPropertyDescriptor(o,s);void 0!==c&&c.enumerable&&(t[s]=o[s])}}return t}o=document.fonts,n="font-marketsans","fontDisplay"in document.documentElement.style||localStorage&&localStorage.getItem("ebay-font")===n||window.addEventListener("load",function(){requestAnimationFrame?requestAnimationFrame(e):e()}),Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:t});function d(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function r(e,n,t){return n&&s(e.prototype,n),t&&s(e,t),e}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function s(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c={DATA_MISSING:"dataMissing",TYPE_MISMATCH:"typeMismatch"},l=void 0;function u(e){return Array.isArray(e)?"array":null===e?"null":void 0===e?"undefined":a(e)}function f(e){return"string"==typeof e?e.split(".").join(",").replace(/\[\d\]/g,function(e){return","+e.replace(/[\[\]']+/g,"")}).split(","):e}function p(e,n){return n.reduce(function(e,n){return e&&void 0!==e[n]?e[n]:void 0},e)}function m(e,n,t,i){var o=3<arguments.length&&void 0!==i?i:"warn",r=void 0,a=p(e,n=f(n)),i=u(a),e=u(t);return"undefined"===e?(t="",e="string"):"object"===e&&function(e){if(e){for(var n in e)if(e.hasOwnProperty(n))return;return 1}}(t)&&(t={__isEmpty:!0}),"undefined"!==i?i!==e&&(r=c.TYPE_MISMATCH,a=t):(r=c.DATA_MISSING,a=t),l&&o&&r&&l[o]&&l[o]("event: %s, path: %s, default: %s",r,n,t),a}var v={has:function(e,n){return!("undefined"===(n=u(p(e,n=f(n))))||"null"===n)},get:function(e,n,t){return m(e,n,t)},need:function(e,n,t,i){return m(e,n,t,i)},setLogger:function(e){l=e}};if(v.privates={EVENT_TYPES:c},"undefined"!=typeof Element&&function(){var e,n=document.createElement("div"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in t)if(void 0!==n.style[e])return}(),"undefined"!=typeof Element)for(var h=["matches","matchesSelector","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],w=0;w<h.length;w++)if(Element.prototype[h[w]])break;var g=function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window;return"requestAnimationFrame"in n?n.requestAnimationFrame(e):n.setTimeout(e,0)};function y(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:document;d(this,y),this.doc=i,this.cb=t,this.js=e,this.jsSize=this.js&&this.js.length,this.css=n,this.cssSize=this.css&&this.css.length,i=(i.body||i.getElementsByTagName("head")[0]).childNodes,this.ref=i[i.length-1]}function b(e,n){var t=1<arguments.length&&void 0!==n?n:"",i=[],o=[];return Array.prototype.forEach.call(e,function(e){"nb_script"===e.id?(t&&(e.id=t),i.push(e.innerHTML)):o.push(e.innerHTML)}),i.concat(o)}function S(){var e=document.createElement("div");return e.id=j,e.style.display="none",document.body.appendChild(e),e}var E=(r(y,[{key:"init",value:function(){this.js&&this.css?this.loadCSS(this.css):this.cb()}},{key:"loadJS",value:function(e){var n,t=this;e&&(Array.isArray(e)?e.forEach(function(e){t.loadJS(e)}):((n=this.doc.createElement("script")).defer=!0,n.src=e,n.type="text/javascript",e=function e(){n.addEventListener&&n.removeEventListener("load",e),t.jsSize--,t.jsSize<=0&&t.cb()},n.addEventListener("load",e),this.ref.parentNode.insertBefore(n,this.ref.nextSibling)))}},{key:"loadCSS",value:function(e){var n,t=this;e&&(Array.isArray(e)?e.forEach(function(e){t.loadCSS(e)}):((n=this.doc.createElement("link")).rel="stylesheet",n.href=e,n.media="temp",e=function e(){n.addEventListener&&n.removeEventListener("load",e),n.media="all",t.cssSize--,t.cssSize<=0&&t.loadJS(t.js)},n.addEventListener("load",e),this.ref.parentNode.insertBefore(n,this.ref.nextSibling)))}}]),y),T=g,j="gh_user";function k(e,n){"complete"===(1<arguments.length&&void 0!==n?n:document).readyState?e():window.addEventListener("load",e)}(O={initAndRenderWidgets:function(o){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=void 0===(t=e.hasEncodedHtml)||t,n=e.js,t=e.css,a=void 0===(e=e.jsInline)?"":e;new E(n,t,function(){var e=document.getElementById(j)||S(),n=o.reduce(function(e,n){return e+(r?decodeURI(n.html):n.html)},"");e.innerHTML+=n;var t=e.querySelectorAll("script"),i=b(t),n=o.map(function(e){return e.init}),e="";a&&(e=(t="null"===(t=r?decodeURI(a):a)?"":t).slice(t.indexOf(">")+1,t.lastIndexOf("<")).trim()),function(e,n){var t=1<arguments.length&&void 0!==n?n:document,e=t.createTextNode(e),i=t.createElement("script");i.setAttribute("data-type","appended"),i.appendChild(e),T(function(){return t.body.appendChild(i)})}(n.join(" ; ").concat(" ; ").concat(i).concat(" ; ").concat(e)),"function"==typeof window.markoDynamicInitComponents&&window.markoDynamicInitComponents()}).init()},initAndRenderOnDemandWidgets:function(e,n,t){var i="",o=document.createElement("div");o.setAttribute("data-type","ondemand"),o.innerHTML+=e,o.classList.add("on-demand-widgets-placeholder"),e=(e=o.querySelector(".gh-module-with-target"))&&e.dataset.targetSelector||"#widgets-placeholder",(e=document.querySelector(e)).appendChild(o),e.style.display="block",(o=o.querySelectorAll("script"))&&0<o.length&&(i=b(o,"nb_ondemand_script")),(o=document.createElement("script")).classList.add("on-demand-scripts"),o.type="text/javascript",o.setAttribute("data-type","on-demand-scripts"),o.appendChild(document.createTextNode(i)),document.body.appendChild(o),"function"==typeof window.markoInitComponents&&(window.markoInitComponents(n),document.dispatchEvent(new CustomEvent("gadget-component-added",{detail:t})))}}).privates={HOLDER_ID:j,createHolder:S};function C(e){var n=e.renderType,t=e.renderDelay,i=e.widgets,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:I,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:document,e=i&&i[0],a=e&&e.js,d=e&&e.css,s=e&&e.jsInline;1===n?o(i,{js:a,css:d,jsInline:s}):2===n?k(function(){return o(i,{js:a,css:d,jsInline:s})},r):function(e,n,t){k(function(){window.setTimeout(n,e)},2<arguments.length&&void 0!==t?t:document)}(t,function(){return o(i,{js:a,css:d,jsInline:s})},r)}var A=v.need,I=O.initAndRenderWidgets,_=O.initAndRenderOnDemandWidgets,g=function(e){var n=e.renderedComponents,t=e.html,i=e.content,o=e.js,r=e.css,a=e.jsInline,d=e.onDemand,s=e.parameters,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:I;1===d?_(t,n,s):(window.widget_platform_renderedComponents=n,e([{html:t||i,init:""}],{hasEncodedHtml:!1,js:o,css:r,jsInline:a}))},O=function(e){var n=window.widget_platform_ondemandUASDoneEventType;n&&(document.dispatchEvent(new CustomEvent(n,{detail:A(e,"content.response.modules",{})})),delete window.widget_platform_ondemandUASDoneEventType)};function D(e){var n=void 0===(r=e.widgetResponse)?{}:r,t=e.onFallback,i=void 0===(a=e.initializer)?C:a;d(this,D);var o=n.widgets,r=n.queryParam,e=n.triggerFallBack,a=n.renderType,n=n.renderDelay;this.props={widgets:o||[],queryParam:r||{},triggerFallBack:void 0===e||e,onFallback:t,initializer:i,renderType:a,renderDelay:n}}function H(){var e=U(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});e&&e.initializeAndTrigger()}function M(e){!function(e){e=0<arguments.length&&void 0!==e?e:{};window&&e.widgetPlatformOndemandUASDoneEventType&&(window.widget_platform_ondemandUASDoneEventType=e.widgetPlatformOndemandUASDoneEventType),e.onDemand=1,H(e)}(e&&e.detail)}var L=(r(D,[{key:"initializeWidgets",value:function(){var e=this.props,n=e.widgets;(0,e.initializer)({widgets:n,renderType:e.renderType,renderDelay:e.renderDelay})}},{key:"handleFallback",value:function(){var e=this.props,n=e.queryParam;(0,e.onFallback)(n)}},{key:"init",value:function(){this.props.triggerFallBack?this.handleFallback():this.initializeWidgets()}}]),D),q=v.has,N=v.get,P="X_EBAY_C_CORRELATION_SESSION",F="raptor.require",R="trkCorrelationSessionInfo.getTrackingCorrelationSessionInfo",G=function(){if(q(window,F))return N(window,F,function(){})("ebay.context.Context")},x=function(){if(q(window,R))return N(window,R,function(){})()},z=function(e){window.trkCorrelationSessionInfo={},window.trkCorrelationSessionInfo.getTrackingInfo=function(){return JSON.parse(JSON.stringify(e))},window.trkCorrelationSessionInfo.getTrackingCorrelationSessionInfo=function(){return e[P]}},W=g,B=O,U=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=n.route||function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:window,n=(e="undefined"!==a((n=e).GH)&&n.GH&&"function"==typeof n.GH.getWidgetDeliveryPlatform&&n.GH.getWidgetDeliveryPlatform())&&e.base_path,e=e&&e.new_buyer_acquistion;return n&&e?n+e:"/gh/useracquisition"}(),t=function(e){var n,t=0<arguments.length&&void 0!==e?e:{},e={correlation:function(e){var n=x(),t={},i=null;if(n)return n;try{i=G()}catch(e){i=null}return(i=i&&i.pid)||(e=e||window,i=N(e,"GH.C.pageId",0)),i?(t[P]="operationId="+i,z(t),t[P]):null}(),show_optin_banner:(n=!1,"serviceWorker"in navigator&&"Notification"in window?"default"===Notification.permission:n)},n=(n=window.GH&&window.GH.C&&window.GH.C.xhrBaseUrl).replace(/^https?:\/\//,"");return window.location.hostname!==n&&(e.customReferer=encodeURIComponent(window.location.href)),Object.assign(e,t)}(n),i=n.method||"GET",o=JSON.stringify(n.body)||"",r={shouldRetry:!1,timeout:1e4};if(n.route&&(r.hasFullXhrUrl=!0),"HttpClient"in window)return new window.HttpClient(e,i,t,o,r,window).handlers({onload:function(e){return function(e,n){if(e=function(e){if(e instanceof ProgressEvent&&(e=e.target||e.currentTarget)instanceof XMLHttpRequest)return e.responseText}(e))try{var t=e&&JSON.parse(e),i=t.rawResponse?B:W;t.parameters=n,i(t)}catch(e){console.debug("Unable to parse Response",e)}}(e,n)},onerror:function(e){return function(e,n){var t=1<arguments.length&&void 0!==n?n:{};console.debug("useracquisition request has failed!",e);n=new CustomEvent("gadget-request-error",{detail:{err:e,parameters:t}});document.dispatchEvent(n),t.rawResponse&&B(e)}(e,n)}})},J=window.widget_platform,O={destroy:function(){document.removeEventListener("widget-platform-ondemand-uas-request",M)},init:g=function(){document&&document.addEventListener&&document.addEventListener("widget-platform-ondemand-uas-request",M,!1);try{new L({widgetResponse:J,onFallback:H}).init()}catch(e){console.debug("WidgetComponent init errored.")}},v:2};return void 0!==window.GH&&void 0!==window.GH.C&&g(),"undefined"!=typeof window&&"function"==typeof window.define&&window.define.amd&&(window.GadgetPlatform=O),O});
