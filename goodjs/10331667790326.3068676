OK.util.isIEMetro()&&document.documentElement.classList.add("ie-metro"),function(){var e=document.getElementById("topPanel");e&&e.addEventListener("click",function(e){e=(e.target||e.srcElement).tagName.toLowerCase();OK.Layers.stack.length&&"input"!=e&&"a"!=e&&OK.Layers.unregisterLast("topPanelClick")})}(),OK.showOnlineUsers={top:0,doResize:function(){}},OK.hideFeed=function(e){e=document.getElementById(e);e&&OK.css.display(e,0)},function(){function n(e){return e.replace(/st\.(fwd|layer\.direction)\=.*?(&|$)/g,"")}function g(e,n){var t;d.length?d[d.length-1].preventCloseOnEsc?OK.logging.logger.success("layerManager","escDisabledForLayer",d[d.length-1].id):(t=d.pop())?(a(t),d.length||o(),p(),null!==t.redirectAfterClose&&(OK.navigation.redirect?OK.navigation.redirect(t.redirectAfterClose):window.location.assign(t.redirectAfterClose)),u(t.id,!1,n),OK.logging.logger.success("layerManager","unregister",t.id),OK.logging.logger.success("layerManager",e,t.id)):OK.logging.logger.success("layerManager","popFailed"):OK.logging.logger.success("layerManager","stackEmpty")}var c,d=[],r=[],t=1,i={},u=function(e,n,t){if(OK.fn.isDebug()&&console.log("layer._call('"+e+"', '"+JSON.stringify(n)+"', '"+JSON.stringify(t)+"') topLayer = "+JSON.stringify(l())),i.hasOwnProperty(e))for(var r=0,o=i[e].length;r<o;r++)try{i[e][r].call(null,n,t)}catch(e){}},p=function(){var e,n=!d.length||1==d.length&&("posting_form"==d[0].id||"video_player"==d[0].id||0===d[0].id.indexOf("dd-menu"));1!=d.length||"modal_hook"!=d[0].id||(e=document.getElementById("hook_Modal_popLayerModal"))&&e.classList.contains("layer__disabled")&&(n=!0),require(["OK/OhManager"],function(e){e.switchScrolling(n)})};function h(){var e=OK.hookModel.getHookById("ForthColumnTopBannerInner");e&&e.handle()}function l(){return e()?d[d.length-1].id:null}var o=function(){OK.loader.use(["jQuery"],function(){c=!1,$("body").off(".popLayers")}),require(["OK/ToolbarGrowl"],function(e){e.showAny()}),h()},a=function(e){e.deactivateFn.call(e.hookInstance)},e=function(){return 0!=d.length};OK.Layers={register:function(e,n,t,r,o,i){OK.loader.execRequire("OK/ToolbarGrowl",function(e){e.hideAll()});for(var l={id:e,deactivateFn:n,hookInstance:t=t||null,preventCloseOnEsc:r=r||!1,keyHandler:o=o||function(){},redirectAfterClose:i=i||null},a=!1,s=0;s<d.length;s++)d[s].id==l.id&&(a=!0,d.splice(s,1),OK.logging.logger.success("layerManager","reRegister",l.id));d.push(l),1!=d.length||a||(OK.loader.use(["jQuery"],function(){$("body").on("click.popLayers",".modal_overlay, .modal-new_close_ovr, .layer_ovr, .ic_close, #hook_Block_PromoMainLayer .layerPanelClose, .js-close-layer",function(e){g("shadowClick"),e.stopImmediatePropagation()}).on("keydown.popLayers",function(e){var n=d[d.length-1];n&&n.keyHandler.call(this,e),27!==e.keyCode||c||(c=!0,g("esc"),e.preventDefault(),e.stopPropagation())}).on("keyup.popLayers",function(e){c=!1,27===e.keyCode&&e.preventDefault(),e.stopPropagation()})}),h()),u(l.id,!0),p(),OK.logging.logger.success("layerManager","register",l.id)},remove:function(e){for(var n,t=0;t<d.length;t++)d[t].id==e&&((n=d.splice(t,1))&&n[0]&&u(n[0].id,!1),OK.logging.logger.success("layerManager","unregister",e));n||OK.logging.logger.success("layerManager","unregisterLayerNotFound",e),!d.length&&n&&o(),p()},isAnyLayerOpened:e,isLayerOpened:function(e){if(d)for(var n=0;n<d.length;n++)if(d[n].id==e)return!0;return!1},unregisterAll:function(){for(var e=d.length;0<e;e--)g("unregisterAll")},unregisterLast:g,unregisterById:function(e,n){for(var t,r=0;r<d.length;r++)d[r].id===e&&(t=d[r],d.splice(r,1),t?(a(t),d.length||o(),p(),null!==t.redirectAfterClose&&(OK.navigation.redirect?OK.navigation.redirect(t.redirectAfterClose):window.location.assign(t.redirectAfterClose)),u(t.id,!1,n),OK.logging.logger.success("layerManager","unregister",t.id)):OK.logging.logger.success("layerManager","popFailed"))},stack:d,push:function(e){t<=1||(e=n(e),r.push({link:e}),0<(e=r.length-t)&&r.splice(0,e))},pop:function(){if(t<=1||0==r.length)return null;if(r.splice(r.length-1,1),0==r.length)return null;var e=r[r.length-1],n=e.link;return e.attrs&&(n+=e.attrs),r.splice(r.length-1,1),"undefined"!=typeof navigateOnUrlFromJS?navigateOnUrlFromJS(n):require(["OK/PopLayerPhoto"],function(e){e.handleOnNavigate(n)}),n},lastUrl:function(){if(0===r.length)return"";var e=r[r.length-1];return e?e.link:""},changeAttrs:function(e,n){var t;0!=r.length&&(t=0<=r[r.length-1].link.indexOf("?")?"&":"?",t+="st.fwd=",e=encodeURIComponent(e),r[r.length-1].attrs=t+=n?"on&st.lastelem="+e:"off&st.firstelem="+e)},clear:function(){r=[]},replace:function(e){t<=1||0==r.length||(e=n(e),r[r.length-1]={link:e})},setMaxSize:function(e){t=e},onLayerShown:OK.fn.empty,onLayerHidden:OK.fn.empty,subscribe:function(e,n){i.hasOwnProperty(e)?i[e].push(n):i[e]=[n]},unsubscribe:function(e,n){n?-1<(n=i[e].indexOf(n))&&i[e].splice(n,1):i[e]=[]},getTopLayerId:l},OK.historyManager.isHistorySupported()&&!window.onpopstate&&(window.onpopstate=function(e){e.state&&OK.Layers.unregisterAll()})}(),require(["OK/utils/throttle"],function(e){window.addEventListener("resize",e(100,function(){OK.setContentWidth()}))}),function(){var e,n,t,r;null!=document.getElementById("sc")&&(e=OK.scrollBar.width,n=document.createElement("style"),r=".fake-toolbar {width: "+e+"px}.scroll-right-indent { right: "+e+"px !important; }.scroll-right-padding { padding-right: "+e+"px !important; }.scroll-right-margin { margin-right: "+e+"px !important; }",t=document.getElementsByTagName("head")[0],OK.util.isIEMetro()||(r+="html.oh #hook_PopLayer_popLayer, html.oh .topPanel, html.oh .modal, html.oh .scroll-modal-indent {border-right:"+e+"px transparent solid}"),t.appendChild(n),n.styleSheet?n.styleSheet.cssText=r:(r=document.createTextNode(r),n.appendChild(r)))}(),window.addEventListener("message",function(e){"ok_ping"==e.data&&e.source.postMessage("ok_pong","*")},!1),require(["OK/StartupTimingLogger"],function(e){e.activate()}),require(["OK/DetectUsageGoogleTranslate"]);
