!function(){var kt,f,ut,lt,wr,ai,wi,ft,n,u,uoa,Ina,jna,pna,qna,rna,sna,tna,una,tla,nla,_ka,gia,hia,iia,kia,lia,mia,nia,oia,aha,_ga,Fga,Bea,zea,yea,xea,D1a,m$,$U,OV,uV,vV,wV,xV,yV,zV,AV,BV,CV,DV,EV,HV,JV,KV,LV,MV,NV,PV,_R,QR,sQ,sP,CP,SN,gC,NA,ix,lm,io,jo,ho,w9,d9,e9,f9,Vi,Xi,Yi,Zi,a8,P6,M6,J6,I6,C6,A6,Gg,Hg,Ag,Bg,Cg,sg,gg,$5,T5,V4,W4,T4,U4,X4,Y4,Z4,jd,kd,dd,ed,P2,pa,qa,ra,sa,ua,ta,Kb,Lb,lb,mb,va,wa,K,j;try{j={L_DistanceUnitKm_Text:"千米",L_DistanceUnitMeters_Text:"米",L_DistanceUnitMilesShortText_Text:"英里",L_DistanceUnitMilesLongText_Text:"英里",L_DistanceUnitFeetShort_Text:"英尺",L_LatLon_Format:"{0}，{1}",L_Duration:"{0} 小时 {1} 分钟",L_Duration_NoMin:"{0} 小时",L_Duration_Min:"{0} 分钟",L_DistanceUnitFeetSquareShort_Text:"平方英尺",L_DistanceUnitKmSquare_Text:"平方公里",L_DistanceUnitMetersSquare_Text:"平方米",L_DistanceUnitMilesSquareShortText_Text:"平方英里",L_AreaFieldString:"面积",L_IncorrectValue_text:"不可用",L_LengthFieldString:"长度",L_FocusDivDefaultLabel:"必应地图 - 交互以查看更多",L_microsoftcopyright_text:"© {year} Microsoft Corporation",L_Distance_Format:"{0} {1}",L_FormatFieldString:"{0}: {1}"},window.$MicrosoftMaps8.ResourceManager?window.$MicrosoftMaps8.ResourceManager.init("MapCore",j):window.$MicrosoftMaps8.ResourcesObject=j,function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e.prototype[n]=t[n])}(m,{length:Array.prototype.length,entities:function(){return Array.prototype.slice.apply(this)},sort:function(e){return Array.prototype.sort.call(this,e),this},reverse:function(){return Array.prototype.reverse.call(this),this},push:function(){return Array.prototype.push.apply(this,arguments),this},pop:function(){return new m([Array.prototype.pop.call(this)])},shift:function(){return new m([Array.prototype.shift.call(this)])},unshift:function(){return Array.prototype.unshift.apply(this,arguments),this},slice:function(){return new m(Array.prototype.slice.apply(this,arguments))},splice:function(){return new m(Array.prototype.splice.apply(this,arguments))},concat:function(e){return new m(Array.prototype.concat.apply(this.entities(),e.entities&&e.entities()||arguments))}}),q.Helper={get_guid:(K=0,function(e){if(!e)return"";if(e===window)return"win";if(e===document)return"doc";if(e.uniqueID)return e.uniqueID;var t="__$gimme$_guid__";return void 0===e[t]&&(e[t]=t+K++),e[t]})},q.Browser=function(){var e=navigator.userAgent.toLowerCase(),t=-1;"Microsoft Internet Explorer"===navigator.appName&&(e=navigator.userAgent,null!==new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1)));var n="undefined"!=typeof ActiveXObject||"undefined"!=typeof MSPointerEvent,i=null!==new RegExp("\\s+Edge/([0-9]+).[0-9]+").exec(navigator.userAgent),a=-1<e.indexOf("chrome")&&!i,r=!a&&-1<e.indexOf("safari");return{is_ie:n,is_edge:i,is_opera:"undefined"!=typeof opera,is_chrome:a,is_khtml:-1!==e.indexOf("khtml"),is_gecko:-1===e.indexOf("khtml")&&-1!==e.indexOf("gecko")&&!n,is_in_quirks_mode:"BackCompat"===document.compatMode,ie_version:t,is_webkit:-1!==e.indexOf("applewebkit/"),is_safari:r}}(),q.undefined={}._$gimme$_undefined,q.ext=m.prototype,n=q,n.ext.select=function(e){return n(e,this[0])},"undefined"==typeof g&&(window.g=n),n.Internals=new function(){function e(i){return function(e,t,n){this[i](e,t,n)}}return{addEventListener:e("addEventListener"),removeEventListener:e("removeEventListener"),attachEvent:e("attachEvent"),detachEvent:e("detachEvent")}},n.query=(va=void 0!==Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var n=e.length,i=0;i<n;i++)if(e[i]===t)return i;return-1},(ta=document.createElement("div")).innerHTML='<a href="#test">test</a>',wa="#test"===ta.firstChild.getAttribute("href")?Y0:Z0,pa=new ma("__$gimme$_unique__"),qa=new ma("__$gimme$_genSib__"),ra=new ma("__$gimme$_nth__"),sa={id:function(e,t){return e.id===t},tag:function(e,t){return e.tagName===t||"*"===t},classes:function(e,t){var n=e.className;return ja(n="string"!=typeof n?wa(e,"class"):n,t)},attributes:(lb={},mb={parse:function(e){var t=e.match(/^\[([\w-_]+)?(\=|\^=|\$=|\*=|\|=|~=|!=)?(.*)\]$/);return lb[e]={name:t&&t[1],delim:t&&t[2],val:t&&t[3].replace(/^['"]|["']$/g,"")}},"=":function(e,t){return e===t},"^=":function(e,t){return 0===e.indexOf(t)},"$=":function(e,t){var n=e.lastIndexOf(t);return-1!==n&&n+t.length===e.length},"*=":function(e,t){return-1!==e.indexOf(t)},"|=":function(e,t){return e===t||0===e.indexOf(t+"-")},"~=":function(e,t){return e===t||ha(e.split(" "),t)},"!=":function(e,t){return e!==t},unknown:function(){return!1}},function(e,t){for(var n,i,a=t.length;a--;){if(n=lb[t[a]]||mb.parse(t[a]),!(i=wa(e,n.name)))return!1;if(n.delim&&!mb[n.delim||"unknown"](i,n.val))return!1}return!0}),pseudos:(Kb={},Lb={parse:function(e){var t=e.match(/([\w-_]+)\b(\((((-?\d*)n)?([+-]?\d+)?|.*)\))?/),t={name:t&&t[1],param:{wholeValue:t&&t[3],a:t&&t[5]||0,b:t&&t[6]||0}};return"even"===t.param.wholeValue?(t.param.a=2,t.param.b=0):"odd"===t.param.wholeValue&&(t.param.a=2,t.param.b=1),Kb[e]=t},"first-child":Jb("previous"),"last-child":Jb("next"),"only-child":function(e){return Lb["first-child"](e)&&Lb["last-child"](e)},"nth-child":function(e,t){var n=1e4*ra.t,i=ra.name,a=e.parentNode,r=0;if(a){if(a[i+":parent"]!==ra.t){a[i+":parent"]=ra.t;for(var r=0,o=a.children||a.childNodes,s=-1,l=o.length;++s<l;)1===o[s].nodeType&&(o[s][i]=n+ ++r)}return e=e[i]-n-t.param.b,!t.param.a&&t.param.b?0==e:0<=t.param.a*e&&e%(t.param.a||1)==0}return!1},contains:function(e,t){return-1!==(e.textContent||e.innerText||e.innerHTML).indexOf(t.param.wholeValue)},not:function(){return!1}},function(e,t){for(var n,i=t.length;i--;)if(n=Kb[t[i]]||Lb.parse(t[i]),!Lb[n.name](e,n))return!1;return!0})," ":function(e,t){for(var n,i=[],a=e.length,r=0;r<a&&(n=da(t,e[r]),i=i.concat(n),!t.id||1!==n.length);r++);return ia(i)},">":function(e,t){for(var n=[],i=e.length,a=0;a<i;a++)n=n.concat(ga(e[a].childNodes,t));return n},"+":function(e,t){for(var n,i=[],a=e.length,r=0;r<a;r++){for(n=e[r].nextSibling;n&&1!==n.nodeType;)n=n.nextSibling;ea(t,n)&&i.push(n)}return i},"~":function(e,t){var n;qa.inc();for(var i=qa.name,a=[],r=e.length,o=0;o<r;o++)for(n=e[o].nextSibling;n&&n[i]!==qa.t;)1===n.nodeType&&(n[i]=qa.t,ea(t,n)&&a.push(n)),n=n.nextSibling;return a}},ta=new function(){function e(){this.propNames=[]}var t,n,i;return e.prototype.propNames=[],e.prototype.storePropertyValue=function(e,t){this[e]=t,this.propNames[e]||(this.propNames.push(e),this.propNames[e]=!0)},e.prototype.storeArrayValue=function(e,t){this[e]||(this[e]=[]),this[e].push(t),this.propNames[e]||(this.propNames.push(e),this.propNames[e]=!0)},{preprocessInput:function(e){return e.replace(/\s*([ >+~,])\s*/g,"$1")},reset:function(){t=[],n=[],i=new e},finish:function(){return i&&0<i.propNames.length&&n.push(i),0<n.length&&t.push(n),t},default:function(e){e=e.match(/(\w+|\*)/);return e?(e=e[0].toUpperCase(),i.storePropertyValue("tag",e),e.length):null},"#":function(e){var t=e.match(/#([_\-\w]+)/);return t?(e=t[1],i.storePropertyValue("id",e),t[0].length):null},".":function(e){var t=e.match(/\.([_\-\w\d]+)/);if(t)return e=t[1],i.storeArrayValue("classes",e),t[0].length},"[":function(e){e=e.match(/(\[.*"\]|.*?\])/);return e?(e=e[0],i.storeArrayValue("attributes",e),e.length):null},":":function(e){e=e.match(/:[\w-_]+\b(\(.*\))?/);return e?(e=e[0],i.storeArrayValue("pseudos",e),e.length):null}," ":function(){return n.push(i," "),i=new e,1},">":function(){return 0<i.propNames.length&&n.push(i),n.push(">"),i=new e,1},"~":function(){return n.push(i,"~"),i=new e,1},"+":function(){return n.push(i,"+"),i=new e,1},",":function(){return n.push(i),t.push(n),n=[],i=new e,1}}},ua=new function(o){this.parse=function(e){var t,n,i,a,r=o.preprocessInput;for(e=r&&r(e)||e,o.reset(),n=0,i=e.length;n<i;){if(a=e.charAt(n),!(t=t||o[a]||o.default))throw new Error('No suitable rule found to handle character "'+a+'"');if(!(a=t(e.substring(n,i))))throw new Error('No valid match found for "'+t.name+'" rule');n+=a,t=null}return o.finish()}}(ta),oa.Internal={unique:ia,index_of:va,contains:ha,contains_class:ja,has_class:sa.classes,get_attr:wa,get_class:function(e){var t=e.className;return t="string"!=typeof t?void 0!==e.getAttribute&&e.getAttribute("class")||"":t},set_class:function(e,t){"string"==typeof e.className?e.className=t:void 0!==e.setAttribute&&e.setAttribute("class",t)}},oa),n.Helper.index_of=n.query.Internal.index_of,n.Helper.contains=n.query.Internal.contains,n.Helper.unique=n.query.Internal.unique,n.Helper.get_attr=n.query.Internal.get_attr,n.Helper.contains_class=n.query.Internal.contains_class,n.Helper.has_class=n.query.Internal.has_class,n.Helper.get_class=n.query.Internal.get_class,n.Helper.set_class=n.query.Internal.set_class,n.Effects={Animation:function(e){var o,r,s,l=e.elements||[],t=e.duration||1,u=e.from||{},c=e.to||{};!function(){var e,t,n,i={},a={},r={};for(t in u)for(i[t]=[],a[t]=[],r[t]=[],e=l.length;e--;)n=l[e],i[t][e]="function"==typeof u[t]?u[t](n,t):u[t],a[t][e]="function"==typeof c[t]?c[t](n,t):c[t],r[t][e]=a[t][e]-i[t][e];u=i,c=a,o=r}(),r=e.animate,s=e.easing||function(e){return e},this.startTime=e.startTime||0,this.duration=t,this.add_element=function(e){l.push(e)},this.remove_element=function(e){for(var t=l.length;t--;)if(l[t]===e){l.splice(t,1);break}},this.tick=function(e){for(var t,n,i=s(e),a=l.length;a--;){for(t in n={},o)n[t]=u[t][a]+o[t][a]*i;r(l[a],n,e)}}},Storyboard:function(e){function t(){c||(c=!0,s=Date.now(),o=n.Effects.Animation.requestAnimationFrame(a))}function i(){n.Effects.Animation.cancelAnimationFrame(o),c=!1}function a(){var e=Date.now();l+=(e-s)/d*u,s=e,l=l<0?0:1<l?1:l,r(),-1===u&&0===l||1===u&&1===l?(i(),p&&p(l)):o=n.Effects.Animation.requestAnimationFrame(a)}function r(){for(var e,t=h.length;t--;)e=(d*l-h[t].startTime)/h[t].duration,0<=(e=-1===u&&e<0?0:1===u&&1<e?1:e)&&e<=1&&h[t].tick(e)}var o,s,l=0,u=1,c=!1,h=e.animations,d=e.duration||0,p=(e.interval,e.completed),m=e.aborted;this.begin=function(){l=0,u=1,t()},this.abort=function(){i(),m&&m(l)},this.pause=i,this.resume=function(){t()},this.forward=function(){u=1,t()},this.backward=function(){u=-1,t()},this.reverse=function(){u*=-1,t()},this.seek=function(e){l=e,r()},this.get_position=function(){return l},this.is_running=function(){return c},this.get_direction=function(){return u},this.get_animations=function(){return h},this.get_duration=function(){return d}},Easing:{Back:new function(){this.ease_in=function(e,t,n,i){return.5*Math.pow(1-e,0)*Math.sin(2*Math.PI*e*.5)*-1+e},this.ease_out=function(){},this.ease_in_out=function(){}},Bounce:new function(){this.ease_in=function(e,t,n){return t=t||1.5,n=n||4,Math.abs(Math.pow(e,t)*Math.cos(Math.PI*e*n))},this.ease_out=function(e,t,i){return 1-n.Effects.Easing.Bounce.ease_in(1-e,t,i)},this.ease_in_out=function(e,t,i){var a=0,r=n.Effects.Easing.Bounce.ease_in;return.5<e&&(r=n.Effects.Easing.Bounce.ease_out,e-=.5,a=.5),r(e,t,i)-a}},Elastic:new function(){this.ease_in=function(){},this.ease_out=function(e,t,n){return t=t||3.5,n=n||5,1-Math.pow(1-e,t)*Math.cos(2*Math.PI*e*n)},this.ease_in_out=function(){}},Exponential:new function(){function n(e,t){return Math.pow(e,t)}function i(e,t){return Math.pow(e,1/t)}this.ease_in=n,this.ease_out=i,this.ease_in_out=function(e,t){return e<=.5?.5*n(2*e,t):.5*i(2*(e-.5),t)+.5}}},Enums:{Directions:{vertically:1,horizontally:2,both:3},Speeds:{quickly:500,slowly:1e3}},RunningAnimations:(P2={},{add:function(e,t){P2[e]=t},remove:function(e){delete P2[e]},get:function(e){return P2[e]||new n.Effects.Storyboard({animations:[]})},contains:function(e){return!!P2[e]}})},n.Effects.Storyboard.create=function(e,t,i,a,r,o,s,l,u){r=Math.floor(r)||n.Effects.Enums.Speeds[r]||n.Effects.Enums.Speeds.quickly;var c=new n.Effects.Storyboard({duration:r,interval:u,completed:function(){s&&s.call(this),n.Effects.RunningAnimations.remove(o),c=null},aborted:function(){n.Effects.RunningAnimations.remove(o),c=null},animations:[new n.Effects.Animation({from:t,to:i,duration:r,animate:a,easing:l,elements:e})]});return o&&n.Effects.RunningAnimations.add(o,c),c},dd=0,ed={},n.Effects.Animation.requestAnimationFrame=(jd=window,(kd=jd.requestAnimationFrame||jd.webkitRequestAnimationFrame||jd.mozRequestAnimationFrame||jd.oRequestAnimationFrame||jd.msRequestAnimationFrame)?function(e,t){return e=ed[++dd]=fd(e,dd),kd(e,t),dd}:function(e){return e=ed[++dd]=fd(e,dd),Microsoft.Maps.setTimeout(e,16),dd}),n.Effects.Animation.cancelAnimationFrame=function(e){delete ed[e]},n.Ajax=new function(){function t(e,t){n(e,t,!0)}function i(e,t){n(e,t,!1)}function r(){var e=u.Internal.originalXMLHttpRequest;if(void 0!==e)return new e;if("undefined"==typeof ActiveXObject)throw new Error("XMLHttp is not supported");try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){throw new Error("Error invoking XMLHTTP")}}function n(n,t,i){var u=r();u.onreadystatechange=function(){var n;4===u.readyState&&(n=u.responseText,i&&n&&(n=eval("("+u.responseText+")")),t.call(u,n,u.status),u=null,t=null)},u.open("GET",n,!0),u.send("")}this.request_json=t,this.request_ahah=i},n.Screen=new function(){this.get_viewport_size=function(){return"undefined"!=typeof innerWidth?{width:window.innerWidth,height:window.innerHeight}:void 0!==document.documentElement&&void 0!==document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}:{width:document.getElementsByTagName("body")[0].clientWidth,height:document.getElementsByTagName("body")[0].clientHeight}},this.get_mouse_pos=function(e){var t,n={x:0,y:0};return void 0!==(e=e||window.event).pageX?(n.x=e.pageX,n.y=e.pageY):(t=this.get_scroll_pos(),n.x=e.clientX+t.x,n.y=e.clientY+t.y),n},this.get_scroll_pos=function(){return n(window).get_scroll_pos()}},n.Util=new function(){function e(e,t){function n(){i.apply(this,Array.prototype.slice.call(e,2)),t||(i=null)}var i=e[0],a=e[1];return!0===t?Microsoft.Maps.setInterval(n,a):Microsoft.Maps.setTimeout(n,a)}this.set_timeout=function(){return e(arguments,!1)},this.set_interval=function(){return e(arguments,!0)}},n.Style=new function(){function s(e){var t=e.scrollTop&&e!==document.documentElement&&e!==document.body&&"TEXTAREA"!==e.tagName&&"INPUT"!==e.tagName?-1:0,i={x:e.scrollLeft*t,y:e.scrollTop*t};return n.Browser.is_ie&&"static"===h(e,"position")?(t=e.style.position,e.style.position="relative",i.x+=e.offsetLeft,i.y+=e.offsetTop,e.style.position=t):(i.x+=e.offsetLeft,i.y+=e.offsetTop),i}function l(){var e,t;return void 0===l.constantValue&&((e=document.createElement("div")).style.cssText="position:absolute;visibility:hidden;top:0;left:0;border:1px solid #000;",t=document.createElement("div"),e.appendChild(t),document.body.appendChild(e),l.constantValue=1===t.offsetTop,document.body.removeChild(e),e=null),l.constantValue}function u(){var e,t,i,a,r,o;return void 0===u.constantValue&&(a=(i=document.documentElement).style.position,r=i.style.margin,o=i.style.border,i.style.position="static",i.style.margin="0",i.style.border="1px solid transparent",e=i.getBoundingClientRect(),t=n(window).get_scroll_pos(),u.constantValue={x:e.left+t.x,y:e.top+t.y},i.style.position=a,i.style.margin=r,i.style.border=o,document.documentElement.className=document.documentElement.className),u.constantValue}function h(e,t){var n,i="";return!e.currentStyle||"right"!==t&&"bottom"!==t?(n=document.defaultView&&document.defaultView.getComputedStyle&&document.defaultView.getComputedStyle(e,null)||e.currentStyle)&&((i=n[t]||"").match(/px$/)||(n=i.match(/(em|ex|%|in|cm|mm|pt|pc|small|medium|large|thin|thick|auto)$/))&&(i=a(t,i,n[0],e)+"px")):i=a(t,"auto","auto",e)+"px",i}function a(e,t,i,a){var r,o,s,l,u,c;if(!t)return 0;if("px"===i)return parseFloat(t);if("auto"!==t){switch(e){case"borderLeftWidth":case"borderRightWidth":case"borderTopWidth":case"borderBottomWidth":return"none"===(u=h(a,e=e.replace("Width","Style")))?0:parseFloat(u)}a=a||document.body,(c=document.createElement("div")).style.visbility="hidden",c.style.position="absolute",c.style.lineHeight="0","%"===i?(a=a.parentNode,"height"===e||"top"===e?c.style.height=t:"width"!==e&&"left"!==e||(c.style.width=t)):(c.style.borderStyle="solid",c.style.borderBottomWidth="0",c.style.borderTopWidth=t);try{a.appendChild(c)}catch(e){(a=a.parentNode).appendChild(c)}return a.offsetWidth,a.offsetHeight,t=c.offsetHeight||c.offsetWidth,a.removeChild(c),t}switch(e){case"top":case"left":return 0;case"bottom":case"right":if(l={bottom:["top","offsetTop","height","offsetHeight"],right:["left","offsetLeft","width","offsetWidth"]},"relative"===(s=n(a)).get_style("position"))return o=l[e][0],-parseInt(s.get_style(o));for(r=a.parentNode;r!==document&&"static"===n(r).get_style("position");)r=r.parentNode;return s=l[e][2],o=r===document?n.Screen.get_viewport_size()[s]:parseInt(n(r).get_style(s)),s=l[e][1],l=l[e][3],o-a[s]-a[l];case"height":return a.clientHeight||a.offsetHeight&&a.offsetHeight-parseFloat(h(a,"borderTopWidth"))-parseFloat(h(a,"borderBottomWidth"))||0;case"width":return a.clientWidth||a.offsetWidth&&a.offsetWidth-parseFloat(h(a,"borderLeftWidth"))-parseFloat(h(a,"borderRightWidth"))||0;default:return 0}}function r(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})}var o,c,e;this.get_relative_pos=s,this.get_absolute_pos=function(e){var t,i={x:0,y:0};if(e.getBoundingClientRect){var a=e.getBoundingClientRect(),r=u(),o=n(window).get_scroll_pos();i.x=a.left-r.x+o.x,i.y=a.top-r.y+o.y,i.width=a.width,i.height=a.height}else for(;null!==e;)t=s(e),i.x+=t.x,i.y+=t.y,(e=e.offsetParent)&&!l()&&(i.x+=parseFloat(h(e,"borderLeftWidth"))||0,i.y+=parseFloat(h(e,"borderTopWidth"))||0);return i},this.offset_includes_borders=l,this.get_bounding_client_rect_offsets=u,e=(void 0!==(e=document.createElement("div")).style.opacity?function(e,t){e.style.opacity=t}:void 0!==e.style.filter&&function(t,n){var e;n*=100;try{e=t.filters.item("DXImageTransform.Microsoft.Alpha"),n<100?(e.Opacity=n,e.enabled||(e.enabled=!0)):e.enabled=!1}catch(e){n<100&&(t.style.filter=(t.currentStyle||t.runtimeStyle).filter+" progid:DXImageTransform.Microsoft.Alpha(opacity="+n+")")}})||function(){},this.set_opacity=e,e=(void 0!==(e=document.createElement("div")).style.opacity?function(e){return parseFloat(e.style.opacity)||h(e,"opacity")}:void 0!==e.style.filter&&function(e){return(e=e.filters["DXIMageTransform.Microsoft.Alpha"])?e.Opacity/100:1})||function(){},this.get_opacity=e,this.get_rendered_style=h,this.normalize_style=a,o={},c=["O","ms","Moz","Webkit"],this.get_camelized_style_name=function(e,t){var n,i;return t=t||document.body,(n=o[e])||(i=r(e),void 0===t.style[i]&&(i=function(e,t){for(var n=r("-"+e),i=c.length;i--;)if(e=c[i]+n,void 0!==t.style[e])return e;return""}(i,t)||e),n=o[e]=i),n},this.get_dasherized_style_name=function(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}},n.Events=new function(){var m=n.Helper,s=null,l=null;this.capture_mouse=function(e,o){return n.Events.release_mouse(),!1!==o&&(o=!0),void 0!==(s=e).setCapture?e.setCapture(o):(l=function(t){var i,e,a,r=t.target;try{i=new MouseEvent(t.type,t)}catch(e){(i=document.createEvent("MouseEvents")).initMouseEvent(t.type,t.bubbles,t.cancelable,window,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget)}i.originalWhich=t.which,i.originalButtons=t.buttons,i.__defineGetter__&&(e=n.Screen.get_scroll_pos(),i.__defineGetter__("pageX",function(){return this.clientX+e.x}),i.__defineGetter__("pageY",function(){return this.clientY+e.y})),document.removeEventListener(t.type,l,!0),i.captureTarget=r,a=s,o||n(s).has(r)&&(a=r),a.dispatchEvent(i),null!==l&&document.addEventListener(t.type,l,!0),delete i.captureTarget,t.stopPropagation()},document.addEventListener("mouseover",l,!0),document.addEventListener("mouseout",l,!0),document.addEventListener("mousemove",l,!0),document.addEventListener("mouseup",l,!0),document.addEventListener("mousedown",l,!0),document.addEventListener("click",l,!0),document.addEventListener("dblclick",l,!0)),this},this.release_mouse=function(){return null!==s&&(void 0!==s.releaseCapture?s.releaseCapture():(document.removeEventListener("mouseover",l,!0),document.removeEventListener("mouseout",l,!0),document.removeEventListener("mousemove",l,!0),document.removeEventListener("mouseup",l,!0),document.removeEventListener("mousedown",l,!0),document.removeEventListener("click",l,!0),document.removeEventListener("dblclick",l,!0)),s=l=null),this},this.get_capture_target=function(e){return e.captureTarget||e.srcElement||e.target},this.Pseudo=new function(){function e(e,t,n){this.pseudoName=e,this.getNativeName=t,this.getProxiedHandler=n}function i(e,t,n){if(e!==t){for(var i=0;t&&t!=e;)i++,t=t.parentNode;return n=n||i,t===e&&n===i}}function a(s){if(!n.Browser.is_ie&&!n.Browser.is_edge)return s;var e=m.get_guid(s);return h[e]||(h[e]=function(e){var t,i,a,r,o;if(e.pointerType===e.MSPOINTER_TYPE_TOUCH||"touch"===e.pointerType){for(i in"MSPointerUp"===e.type||"pointerup"===e.type||"MSPointerCancel"===e.type||"pointercancel"===e.type?delete d[e.pointerId]:(t=n.Screen.get_mouse_pos(e),d[e.pointerId]={_$targetId:m.get_guid(e.target),identifier:e.pointerId,pageX:t.x,pageY:t.y}),a=[],r=[],d)d.hasOwnProperty(i)&&d[i]&&(o=d[i],a.push(o),o._$targetId===m.get_guid(e.target)&&r.push(o));e.touches=a,e.targetTouches=r,"MSPointerDown"!==e.type&&"pointerdown"!==e.type||(e.preventDefault=l),s.call(this,e),e.touches=e.targetTouches=null}})}function l(){c[this.pointerId]=!0;var e=n.Browser.is_ie&&n.Browser.ie_version<11;return document.addEventListener(e?"MSPointerUp":"pointerup",r,!0),document.addEventListener("click",o,!0),(e?MSPointerEvent:PointerEvent).prototype.preventDefault.call(this)}function r(e){u=e.pointerId,c[u]&&(c[u]=!1)}function o(e){var t,i,a=0;for(t in c)t=parseInt(t),!1===c[t]&&delete c[t]||a++,t===u&&(e.stopPropagation()||e.preventDefault());0===a&&(i=n.Browser.is_ie&&n.Browser.ie_version<11,document.removeEventListener(i?"MSPointerUp":"pointerup",r,!0),document.removeEventListener("click",o,!0))}function s(){}var u=null,c={},h={},d={},t=n.Browser.is_ie&&n.Browser.ie_version<11,p={touchstart:t?"MSPointerDown":"pointerdown",touchend:t?"MSPointerUp":"pointerup",touchmove:t?"MSPointerMove":"pointermove",touchcancel:t?"MSPointerCancel":"pointercancel"};return e.prototype.add=function(e,t,n){e.add_event(this.getNativeName(this.pseudoName),this.getProxiedHandler(t,e),n,!0)},e.prototype.remove=function(e,t,i){e.remove_event(this.getNativeName(this.pseudoName),this.getProxiedHandler(t,e,!0),i,!0);t=m.get_guid(t);t&&delete h[t],"touchstart"===this.pseudoName&&n(document).remove_event("touchend",s,!0).remove_event("touchcancel",s,!0)},{mouseenter:new e("mouseenter",function(){return"mouseover"},function(e){return n=e,e=m.get_guid(n),h[e]||(h[e]=function(e){var t=e.relatedTarget;t&&this!==t&&!i(this,t)&&n.call(this,e)});var n}),mouseleave:new e("mouseleave",function(){return"mouseout"},function(e){return n=e,e=m.get_guid(n),h[e]||(h[e]=function(e){var t=e.relatedTarget;t&&(this===t||i(this,t))||n.call(this,e)});var n}),mousewheel:new e("mousewheel",function(e){return n.Browser.is_gecko?"DOMMouseScroll":e},function(t){if(!n.Browser.is_gecko)return t;var e=m.get_guid(t);return h[e]||(h[e]=function(e){e.wheelDelta=-40*e.detail,t.call(this,e),e.wheelDelta=null})}),touchstart:new e("touchstart",function(e){return n.Browser.is_ie||n.Browser.is_edge?p[e]:e},function(e,t,i){return i||n(document).add_event("touchend",s,!0).add_event("touchcancel",s,!0),a(e)}),touchend:new e("touchend",function(e){return n.Browser.is_ie||n.Browser.is_edge?p[e]:e},a),touchmove:new e("touchmove",function(e){return n.Browser.is_ie||n.Browser.is_edge?p[e]:e},a),touchcancel:new e("touchcancel",function(e){return n.Browser.is_ie||n.Browser.is_edge?p[e]:e},a)}}},T4=n.Helper,U4=n.Internals,X4={},Y4={},Z4={load:!1,unload:!1,focus:!1,blur:!1,beforeunload:!1,stop:!1,beforeprint:!1,afterprint:!1,propertychange:!1,filterchange:!1,readystatechange:!1,losecapture:!1},n.ext.add_event=document.addEventListener?function(e,t,i,a){for(var r,o=e?e.split(","):[],s=0;s<o.length;s++)r=o[s].trim(),!a&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[r]?n.Events.Pseudo[r].add(this,t,i):this.for_each(function(e){U4.addEventListener.call(e,r,t,i)});return this}:document.attachEvent?function(e,l,u,t){for(var c,i=e?e.split(","):[],a=0;a<i.length;a++)c=i[a].trim(),!t&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[c]?n.Events.Pseudo[c].add(this,l,u):this.for_each(function(i){var e,t,a,r=T4.get_guid(i),o=T4.get_guid(l)+(u||!1).toString(),s="{"+r+" / "+c+" / "+o+"}";u&&(t=r,e=l,a=Z4[o=c],u=!1!==a&&(((a=a||(Z4[o]={}))[t]||(a[t]=[])).push(e),!0)),(a=X4[s])||(a=function(e){var t=Y4[c][r];t.remainingHandlers--,e=function(e,t){W4=W4||1,t.eventPhase=W4,t.target=t.srcElement,t.currentTarget=e;var i=n.Screen.get_mouse_pos(t);switch(t.pageX=i.x,t.pageY=i.y,t.type){case"keyup":case"keydown":case"keypress":"file"!==e.type&&(186===t.keyCode?t.keyCode=59:187===t.keyCode?t.keyCode=61:189===t.keyCode&&(t.keyCode=109)),t.which=t.keyCode,t.charCode=t.keyCode;break;case"mousedown":case"mouseup":case"click":case"dblclick":case"contextmenu":t.which=[1,1,3,t.button,2][t.button];break;case"mouseover":t.relatedTarget=t.fromElement;break;case"mouseout":t.relatedTarget=t.toElement}return t.preventDefault=function(){t.returnValue=!1},t.stopPropagation=function(){t.cancelBubble=!0},t}(i,e),Z4[c]&&1===W4&&(V4=function(e,t){for(var n,i,a,r,o,s=[],l=e;l;)s.push(l),l=l.parentNode;for(;n=s.pop();)if(i=T4.get_guid(n),Z4[c][i])for(V4=V4||n,r=Z4[c][i].length,a=0;a<r;a++)t.cancelBubble||(n===t.target&&(t.eventPhase=W4=2),(o=Z4[c])[i]&&o[i][a]&&o[i][a].call(n,t));return V4}(i,e)),W4=i===e.target?2:3,e.eventPhase=W4,u||e.cancelBubble||l.call(i,e),(!V4||e.cancelBubble||i==V4&&0===t.remainingHandlers)&&(W4=1,V4=void 0,t.remainingHandlers=t.handlerCount),e.eventPhase=e.target=e.currentTarget=e.relatedTarget=e.which=e.preventDefault=e.stopPropagation=e.pageX=e.pageY=void 0},X4[s]=a,U4.attachEvent.call(i,"on"+c,a),t=r,(e=(e=(a=(a=Y4[e=c])||(Y4[e]={}))[t])||(a[t]={handlerCount:0,remainingHandlers:0})).handlerCount++,e.remainingHandlers=e.handlerCount),s=null});return this}:function(){},n.ext.remove_event=document.addEventListener?function(e,t,i,a){for(var r,o=e?e.split(","):[],s=0;s<o.length;s++)r=o[s].trim(),!a&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[r]?n.Events.Pseudo[r].remove(this,t,i):this.for_each(function(e){U4.removeEventListener.call(e,r,t,i)});return this}:document.attachEvent?function(e,l,u,t){for(var c,i=e?e.split(","):[],a=0;a<i.length;a++)c=i[a].trim(),!t&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[c]?n.Events.Pseudo[c].remove(this,l,u):this.for_each(function(e){var t,i,a,r=T4.get_guid(e),o=T4.get_guid(l)+(u||!1).toString(),s="{"+r+" / "+c+" / "+o+"}";u&&(a=r,i=l,!(o=Z4[t=c])||(t=o[a])&&(-1!==(i=n(t).index_of(i))&&t.splice(i,1),0===t.length&&delete o[a])),(a=X4[s])&&(U4.detachEvent.call(e,"on"+c,a),delete X4[s],a=r,(a=Y4[r=c]&&Y4[r][a])&&(0<a.handlerCount&&a.handlerCount--,a.remainingHandlers=a.handlerCount)),s=null});return this}:function(){},T5=n.Helper,n.ext.add_class=function(e){var i=e.split(/\s+/);return this.for_each(function(e){var t=T5.get_class(e);n(i).for_each(function(e){T5.contains_class(t,[e])||(""===t?t=e:t+=" "+e)}),T5.set_class(e,t)}),this},n.ext.remove_class=function(e){return this.swap_class(e,"$1")},$5=n.Helper,n.ext.swap_class=function(e,i){"$1"!==i&&(i=" "+i+" ");var a=e.split(/\s+/);return this.for_each(function(e){var t=$5.get_class(e);n(a).for_each(function(e){e=new RegExp("(^| )"+e+"( |$)");t=t.replace(e,i)}),$5.set_class(e,t.replace(/^\s+|\s+$/g,""))}),this},gg=n.Helper,n.ext.has_class=function(e,t){t=this[t||0];return t&&gg.has_class(t,[e])||!1},n.ext.get_html=function(e){e=this[e||0];return e&&e.innerHTML||""},n.ext.set_html=function(t){return this.for_each(function(e){e.innerHTML=t}),this},n.ext.get_val=function(e){e=this[e||0];return e&&e.value||""},n.ext.set_val=function(t){return this.for_each(function(e){void 0!==e.value&&(e.value=t)}),this},sg=n.Helper.get_attr,n.ext.get_attr=function(e,t){t=this[t||0];return t&&sg(t,e)||""},n.ext.set_attr=function(n,i){return this.for_each(function(e){var t;"INPUT"!==e.tagName.toUpperCase()||!(t="checked"===n)&&"value"!==n?"CLASS"===n.toUpperCase()?e.className=i:e.setAttribute(n,i):(e[n]=i,t&&(e.defaultChecked=i))}),this},Ag=n.Style.get_rendered_style,Bg=n.Style.get_opacity,Cg=n.Style.get_camelized_style_name,n.ext.get_style=function(e,t){t=this[t||0];return t?"opacity"===e?Bg(t):Ag(t,Cg(e)):""},Gg=n.Style.set_opacity,Hg=n.Style.get_camelized_style_name,n.ext.set_style=function(a){return this.for_each(function(e){var t,n,i;for(t in a)switch(n=a[t],i=Hg(t)){case"height":case"maxHeight":case"minHeight":case"width":case"maxWidth":case"minWidth":case"top":case"right":case"bottom":case"left":case"marginTop":case"marginRight":case"marginBottom":case"marginLeft":case"paddingTop":case"paddingRight":case"paddingBottom":case"paddingLeft":e.style[i]="number"==typeof n&&n+"px"||n;break;case"opacity":Gg(e,n);break;default:e.style[i]=n}}),this},n.ext.get_native_prop=function(e,t){t=this[t||0];return t?t[e]:""},n.ext.parent=function(e){e=this[e||0];return n(e&&e.parentNode)},n.ext.element=function(e){return this[e||0]},n.ext.get_ancestor=function(e,t){for(var i=this[t||0],a=e;0<a--&&i;)i=i.parentNode;return n(i)},n.ext.get_sibling=function(e,t){var i=this[t||0];if(0!==e)for(var a=0<e?"nextSibling":"previousSibling",r=Math.abs(e),o=0;o<r&&(i=i[a]);)1===i.nodeType&&o++;return n(i)},n.ext.for_each=void 0!==Array.prototype.forEach?function(e,t){return this.entities().forEach(e,t),this}:function(e,t){for(var n=this.entities(),i=n.length,a=0;a<i;a++)e.call(t,n[a],a,n);return this},n.ext.iterate=function(e){for(var t,i=this.length,a=0;a<i;a++)t=n(this[a]),e.call(t,a);return e=null,this},n.ext.filter=function(e){for(var t=n(),i=this.length;i--;)e(this[i])&&t.unshift(this[i]);return t},n.ext.map=void 0!==Array.prototype.map?function(e,t){return n(this.entities().map(e,t))}:function(e,t){for(var i=n(),a=this.length;a--;)i.unshift(e.call(t,this[a]));return i},A6=n.Helper,n.ext.contains=function(e){return A6.contains(this.entities(),e)},C6=n.Helper,n.ext.index_of=function(e){return C6.index_of(this.entities(),e)},n.ext.select=function(e){return n(e,this[0])},n.ext.has=function(e,t){t=this[t||0];return 0<n(e,t).length},I6=n.Helper,n.ext.unique=function(){return n(I6.unique(this.entities()))},J6=n.Style.get_rendered_style,n.ext.get_style_pos=function(e){e=this[e||0];return{x:parseFloat(J6(e,"left")),y:parseFloat(J6(e,"top"))}},M6=n.Style.get_absolute_pos,n.ext.get_absolute_pos=function(e){e=this[e||0];return e&&M6(e)||{x:0,y:0}},P6=n.Style.get_relative_pos,n.ext.get_relative_pos=function(e){e=this[e||0];return e&&P6(e)||{x:0,y:0}},n.ext.get_scroll_pos=function(e){var t=this[e||0],e={x:0,y:0};return t===window?"undefined"!=typeof pageYOffset?(e.x=window.pageXOffset,e.y=window.pageYOffset):n.Browser.is_in_quirks_mode||void 0===document.documentElement.scrollTop?void 0!==document.body.scrollTop&&(e.x=document.body.scrollLeft,e.y=document.body.scrollTop):(e.x=document.documentElement.scrollLeft,e.y=document.documentElement.scrollTop):(e.x=t.scrollLeft,e.y=t.scrollTop),e},n.ext.animate=function(i,e,t,a,r){function o(e,t){var i=n(e).get_style(t)+"",e=parseFloat(i);return u.units[t]=i.replace(e,""),e}function s(e,t){var n=o(e,t),e=i[t]+"",t=e.match(/^[+\-*\/]/),t=t&&t[0]||"noOp";return function(e,t,n){switch(e){case"+":return t+n;case"-":return t-n;case"*":return t*n;case"/":return t/n;default:return n}}(t,n,e=Number(e.replace(t,"")))}var l,u={units:{},ops:{}},c={};for(l in i)u[l]=o,c[l]=s;return n.Effects.Storyboard.create(this,u,c,function(e,t){var i,a,r=n(e);for(i in t)"units"!==i&&(a={},a[i]=t[i]+u.units[i],r.set_style(a))},e,t,a,r).begin(),this},n.ext.bounce=function(e,t,i,a,r){return null===e&&(e=function(e){return n(e).get_style_pos().y}),n.Effects.Storyboard.create(this,{top:e},{top:t},function(e,t){e.style.top=Math.ceil(t.top)+"px"},i,a,r,n.Effects.Easing.Bounce.ease_out).begin(),this},n.ext.fade_to=Hh,n.ext.fade_in=function(e,t,n,i,a,r){return Hh.call(this,e,t,n,i,a,r)},n.ext.fade_out=function(e,t,n,i,a,r){return Hh.call(this,e,t,n,i,a,r)},n.ext.slide=function(e,t,i,a,r,o){function s(e,t){t="left"===t?"x":"y";var i=(i=e.__pos)||(e.__pos=n(e).get_style_pos());return"y"===t&&(e.__pos=n.undefined),i[t]}null===e&&(e={x:s,y:s});var l=Math.round,u=n.Effects.Easing.Exponential.ease_in_out;return n.Effects.Storyboard.create(this,{left:e.x,top:e.y},{left:t.x,top:t.y},function(e,t){e.style.top=l(t.top)+"px",e.style.left=l(t.left)+"px"},i,a,r,o||function(e){return u(e,4)}).begin(),this},n.ext.scroll_to=function(e,t,i,a){var r=n.Screen.get_scroll_pos(),o=n(this[0]).get_absolute_pos(),s=Math.round,l=n.Effects.Easing.Exponential.ease_out;return n.Effects.Storyboard.create([window],{scrollX:r.x,scrollY:r.y},{scrollX:o.x,scrollY:o.y},function(e,t){e.scrollTo(s(t.scrollX),s(t.scrollY))},e,t,i,a||function(e){return l(e,4)}).begin(),this},n.ext.veil=function(i,e,t,a,r){function o(e,t){var i=parseInt(n(e).get_style(t),10);return e[s]=e[s]||{},e[s][t]=i}var s,l,u,c=n.Effects.Enums.Directions;return i=Math.floor(i)||c[i]||c.vertically,s="_$gimme$_veil",l={},u={},(i&c.vertically)===c.vertically&&(u.height=u.paddingTop=u.paddingBottom=o,l.height=l.paddingTop=l.paddingBottom=0),(i&c.horizontally)===c.horizontally&&(u.width=u.paddingLeft=u.paddingRight=o,l.width=l.paddingLeft=l.paddingRight=0),(r=n.Effects.Storyboard.create(this.filter(function(e){return"none"!==(e.style.display||n(e).get_style("display"))}),u,l,function(e,t){e=e.style;(i&c.vertically)===c.vertically&&(e.height=t.height+"px",e.paddingTop=t.paddingTop+"px",e.paddingBottom=t.paddingBottom+"px"),(i&c.horizontally)===c.horizontally&&(e.width=t.width+"px",e.paddingRight=t.paddingRight+"px",e.paddingLeft=t.paddingLeft+"px")},e,t,a,r||function(e){return n.Effects.Easing.Exponential.ease_in_out(e,4)})).get_animations().push(new n.Effects.Animation({startTime:0,elements:this,animate:function(e){e.style.overflow="hidden"}}),new n.Effects.Animation({startTime:r.get_duration(),elements:this,animate:function(e){e.style.display="none"}})),r.begin(),this},n.ext.unveil=function(i,e,t,a,r){function o(e,t){var i,a,r,o=e._$gimme$_veil;return(o=o||(o||((r=e.cloneNode(!0)).style.cssText="position:absolute;top:0;left:0;visibility:hidden;margin:0;padding:0;border:0;height:;width:;",r.style.display="block",e.parentNode.appendChild(r),r=n(r),i=parseInt(n(e).get_style("height"),10)||parseInt(r.get_style("height"),10),a=parseInt(n(e).get_style("width"),10)||parseInt(r.get_style("width"),10),r[0].style.padding=e.style.padding,a={height:i,width:a,paddingTop:parseInt(r.get_style("paddingTop"),10),paddingBottom:parseInt(r.get_style("paddingBottom"),10),paddingRight:parseInt(r.get_style("paddingRight"),10),paddingLeft:parseInt(r.get_style("paddingLeft"),10)},e.parentNode.removeChild(r[0]),e.style.overflow="hidden",a)))[t]}function s(){return document.fullscreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled}var l,u,c=n.Effects.Enums.Directions;return i=Math.floor(i)||c[i]||c.vertically,c=n.Effects.Enums.Directions,l={},u={},((i=Math.floor(i)||c[i]||c.vertically)&c.vertically)===c.vertically&&(u.height=u.paddingTop=u.paddingBottom=0,l.height=l.paddingTop=l.paddingBottom=o),(i&c.horizontally)===c.horizontally&&(u.width=u.paddingLeft=u.paddingRight=0,l.width=l.paddingLeft=l.paddingRight=o),(r=n.Effects.Storyboard.create(this.filter(function(e){e=e.style.display||n(e).get_style("display");return"none"===e||null===e}),u,l,function(e,t){(i&c.vertically)===c.vertically&&(e.style.height=t.height+"px",e.style.paddingTop=t.paddingTop+"px",e.style.paddingBottom=t.paddingBottom+"px"),(i&c.horizontally)===c.horizontally&&(e.style.width=t.width+"px",e.style.paddingRight=t.paddingRight+"px",e.style.paddingLeft=t.paddingLeft+"px")},e,t,a,r||function(e){return n.Effects.Easing.Exponential.ease_in_out(e,4)})).get_animations().push(new n.Effects.Animation({startTime:0,elements:this,animate:function(e){e.style.overflow="hidden",e.style.display="block"}}),new n.Effects.Animation({startTime:r.get_duration(),elements:this,animate:function(e){e.style.overflow=""}})),n.ext.exit_full_screen=function(){s()&&(document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen())},n.ext.set_full_screen=function(e){e&&s()&&(e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.requestFullscreen())},r.begin(),this},n.toString=function(){return"Gimme v2.7.0 (Edmund) :: Thursday, June 28, 2012 3:44:28 PM"},Vi=n.ext,Xi=new RegExp('["\\b\\f\\n\\r\\t\\\\\\x00-\\x1F]',"i"),Yi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Zi=new RegExp("/[^A-Za-z0-9+/=]","g"),a8=n.Internals,Vi.append=function(e){var t=this,i=t[0];return i&&n(e).for_each(function(e){e.parentNode!==i&&(e.getRootElement?(e=e.getRootElement(),t.append(e)):i.appendChild(e))}),t},Vi.insertBefore=function(e,t){var i=this[0];return t.length&&(t=t[0]),i&&n(e).for_each(function(e){i.insertBefore(e,t)}),this},Vi.appendTo=function(t){return(t=n(t)[0])&&this.for_each(function(e){e.parentNode!==t&&t.appendChild(e)}),this},Vi.getParent=Vi.parent,Vi.appendText=function(t){return this.for_each(function(e){e.appendChild(document.createTextNode(t))}),this},Vi.appendHTML=function(t){return this.for_each(function(e){sj_appHTML(e,t)}),this},Vi.fadeIn=function(e,t,i,a){var r=this[0],o=(e=n(e)).get_style("opacity")||1;return e.set_style({opacity:0}),a?r.insertBefore(e[0],r.firstChild):e.appendTo(r),e.fade_in(0,o,t||300,null,function(){i&&i()},Ti),this},Vi.fadeOut=function(e,t,n){var i=this,a=this.get_style("opacity")||1;return i.fade_out(a,0,t||300,null,function(){e&&i.removeFromParent(),n&&n()},Ti),this},Vi.fadeToChild=function(t,e,i){var a=this[0],r=(t=n(t)).get_style("opacity")||1;t.set_style({opacity:0}).appendTo(a);var o=t.get_style("zIndex")||0,s=this.select(">*").set_style({position:"absolute",top:0,left:0,zIndex:0}).filter(function(e){return-1===t.index_of(e)});return s.length?t.fade_in(0,r,e||300,null,function(){t.set_style({zIndex:o}),s.removeFromParent(),i&&i()},Ti):t.set_style({opacity:1}),this},Vi.removeFromParent=function(){return this.for_each(function(e){e.parentNode&&e.parentNode.removeChild(e)}),this},Vi.get_size=function(){return new nt(this[0].clientWidth,this[0].clientHeight)},Vi.clear=function(){return this.for_each(function(e){for(var t=e.lastChild;t;)e.removeChild(t),t=e.lastChild}),this},Vi.set_text=function(t){return this.clear(),this.for_each(function(e){e.appendChild(document.createTextNode(t))}),this},Vi.getOpacity=function(){return parseFloat(this.get_style("opacity"))},Vi.fireEvent=function(n){return this.for_each(function(e){var t;document.createEventObject?(t=document.createEventObject(),e.fireEvent("on"+n,t)):((t=document.createEvent("HTMLEvents")).initEvent(n,!0,!0),e.dispatchEvent(t))}),this},Vi.inlineDataSvgs=function(){var p=/^(?:url\(['"]?)?data:(.+);base64,([^'")]+)(?:['"]?\))?$/,m=new DOMParser,g=this;return g.iterate(function(e){var t,i,a,o,s,l,u,c,h,d=g[e];if(!(d.children&&d.children.length||d.textContent&&d.textContent.trim())&&((t=n(d).get_style("background-image").match(p))&&(i=t[1],a=t[2],"image/svg+xml"===i)))try{if((s=(o=m.parseFromString(atob(a),i))&&o.rootElement)&&"svg"===s.tagName){for(u=(l=d.attributes)&&l.length,c=0;c<u;c++)(h=l[c]).value&&s.setAttribute(h.name,h.value);s.setAttribute("focusable","false"),s.style.backgroundImage="none",d.parentNode.replaceChild(s,d),g[e]=s}}catch(e){r.assert(!1,"Error creating SVG: "+e)}}),this},Vi.remove_attr=function(t){return this.for_each(function(e){e.removeAttribute(t)}),this},Vi.is_element_inView=function(e,t){var n=this[0].getBoundingClientRect();return 0<=n.top-(e||0)&&0<=n.left&&n.bottom<=(window.innerHeight||document.documentElement.clientHeight)-(t||0)&&n.right<=(window.innerWidth||document.documentElement.clientWidth)},Vi.exit_full_screen=function(){Ui()&&(document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen())},Vi.set_full_screen=function(e){e&&Ui()&&(e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.requestFullscreen())},a8.stringify=function(e,t){function o(e,t){var n,i,a;if(t+='"',Xi.test(e))for(n=e.length,i=0;i<n;i++)if(" "<=(a=e.charAt(i)))"\\"!==a&&'"'!==a||(t+="\\"),t+=a;else switch(a){case"\b":t+="\\b";break;case"\f":t+="\\f";break;case"\n":t+="\\n";break;case"\r":t+="\\r";break;case"\t":t+="\\t";break;default:t+="\\u00",a.charCodeAt()<16&&(t+="0"),t+=a.charCodeAt().toString(16)}else t+=e;return t+'"'}var n=window.JSON&&window.JSON.stringify;return n&&!t?n(e):function e(t,n){var i,a,r;switch(typeof t){case"object":if(t)if(t instanceof Number)n+=t.toString();else if(t instanceof Boolean)n+=t.toString();else if(t instanceof String)n=o(t,n);else if(t instanceof Array){for(n+="[",a=0;a<t.length;a++)0<a&&(n+=","),n=e(t[a],n);n+="]"}else{for(i in n+="{",a=0,t)t.hasOwnProperty(i)&&(r=t[i],void 0!==r&&"function"!=typeof r&&(0<a&&(n+=","),a++,n=o(i,n),n+=":",n=e(r,n)));n+="}"}else n+="null";break;case"number":case"boolean":n+=t.toString();break;case"string":n=o(t,n);break;default:n+="null"}return n}(e,"")},a8.base64Encode=function(e){if(!e||0===e.length)return e;for(var t,n,i,a=e.length,r=a%3,o=a-r,s="",l=0;l<o;l+=3)t=e.charCodeAt(l),n=e.charCodeAt(l+1),i=e.charCodeAt(l+2),s+=Yi.charAt((252&t)>>2),s+=Yi.charAt((3&t)<<4|(240&n)>>4),s+=Yi.charAt((15&n)<<2|(192&i)>>6),s+=Yi.charAt(63&i);switch(t=e.charCodeAt(l=o),n=e.charCodeAt(l+1),r){case 1:s+=Yi.charAt((252&t)>>2),s+=Yi.charAt((3&t)<<4),s+=Yi.charAt(64),s+=Yi.charAt(64);break;case 2:s+=Yi.charAt((252&t)>>2),s+=Yi.charAt((3&t)<<4|(240&n)>>4),s+=Yi.charAt((15&n)<<2),s+=Yi.charAt(64)}return s},a8.base64Decode=function(e){var t,n,i,a,r,o,s,l;if(!e||0===e.length)return e;if((t=e.length)%4!=0||Zi.exec(e))throw new Error("Not a valid base64 encoded string");for(n=t-4,i="",a=0;a<n;a+=4)r=e.charAt(a),o=e.charAt(a+1),s=e.charAt(a+2),l=e.charAt(a+3),i+=String.fromCharCode(Yi.indexOf(r)<<2|Yi.indexOf(o)>>4),i+=String.fromCharCode((15&Yi.indexOf(o))<<4|Yi.indexOf(s)>>2),i+=String.fromCharCode((3&Yi.indexOf(s))<<6|Yi.indexOf(l));return r=e.charAt(a=n),o=e.charAt(a+1),s=e.charAt(a+2),l=e.charAt(a+3),i+=String.fromCharCode(Yi.indexOf(r)<<2|Yi.indexOf(o)>>4),64!==Yi.indexOf(s)&&(i+=String.fromCharCode((15&Yi.indexOf(o))<<4|Yi.indexOf(s)>>2)),64!==Yi.indexOf(l)&&(i+=String.fromCharCode((3&Yi.indexOf(s))<<6|Yi.indexOf(l))),i},a8.isTouchDevice=function(){var e=(window.navigator&&(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)||window.PointerEvent)&&window.MSGesture;return"ontouchstart"in window||e||window.DocumentTouch&&document instanceof DocumentTouch},a8.HTMLEncode=function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},d9=kt=kt||{},e9=function(){var e,t,n;try{return e=(new Date).toString(),(t=window.localStorage).setItem(e,e),n=t.getItem(e)===e,t.removeItem(e),n&&t}catch(e){}}(),k9.isEnabled=function(){return!!e9},k9.getItem=function(e){var t,n,i;return e9?((t=e9.getItem(e))&&(n=k9._generateExpirationKey(e),(i=e9.getItem(n))&&(i=parseInt(i),Date.now()>i&&(t=null,e9.removeItem(e),e9.removeItem(n)))),t):null},k9.setItem=function(e,t,n){e9&&((!isFinite(n)||0<n)&&e9.setItem(e,t),0<n&&e9.setItem(k9._generateExpirationKey(e),(Date.now()+864e5*n).toString()))},k9.removeItem=function(e){var t;e9&&(t=k9._generateExpirationKey(e),e9.removeItem(e),e9.removeItem(t))},k9._generateExpirationKey=function(e){return"_$Maps_"+e+"_expiration"},f9=k9,d9.LocalStorageCache=f9;var u=window.$MicrosoftMaps8,i=u.GlobalConfig,p=this&&this.__extends||(w9=function(e,t){return(w9=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}w9(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),h=(H9.prototype.add=function(e){return this.z&&e.z?new H9(this.x+e.x,this.y+e.y,this.z+e.z):new H9(this.x+e.x,this.y+e.y)},H9.prototype.subtract=function(e){return this.z&&e.z?new H9(this.x-e.x,this.y-e.y,this.z-e.z):new H9(this.x-e.x,this.y-e.y)},H9.prototype.clone=function(){return new H9(this.x,this.y,this.z)},H9.prototype.equals=function(e,t){return H9.pointsEqual(this,e,t)},H9.pointsEqual=function(e,t,n){return!(!e||!t)&&(0<n?Math.abs(e.x-t.x)<=n&&Math.abs(e.y-t.y)<=n:e.x===t.x&&e.y===t.y&&e.z===t.z)},H9.prototype.toString=function(){return void 0===this.z?"[Point ("+this.x+", "+this.y+")]":"[Point ("+this.x+", "+this.y+", "+this.z+")]"},H9.prototype.scalarMultiply=function(e){return new H9(this.x*e,this.y*e,this.z?this.z*e:null)},H9.prototype.invert=function(){return new H9(-this.x,-this.y,this.z?-this.z:null)},H9),nt=(T9.Auto=new T9(-1,-1),T9),gr=(W9.prototype.invoke=function(e){var t,n=this;this._isScheduled()?(this._eventFilter&&(e=this._eventFilter(this._nextScheduledEventArgs,e)),this._nextScheduledEventArgs=e):(t=Date.now(),this._lastRaisedTime&&this._lastRaisedTime<t+this._interval?(this._nextScheduledEventArgs=e,this._nextScheduledEventId=Microsoft.Maps.setTimeout(function(){n._raiseScheduledEvent()},this._lastRaisedTime+this._interval-t)):(this.handler(e),this._lastRaisedTime=t))},W9.prototype.dispose=function(){this._clearScheduledEvent()},W9.prototype._raiseScheduledEvent=function(){this.handler(this._nextScheduledEventArgs),this._lastRaisedTime=Date.now(),this._clearScheduledEvent()},W9.prototype._isScheduled=function(){return null!==this._nextScheduledEventId},W9.prototype._clearScheduledEvent=function(){this._isScheduled()&&(clearTimeout(this._nextScheduledEventId),this._nextScheduledEventId=null)},W9),t=(bk.prototype.add=function(e,t){var n=this;return void 0===t&&(t=!1),r.assertIsFunction(e,"handler"),t?this._handlers.splice(0,0,e):this._handlers.push(e),{dispose:function(){return n.remove(e)}}},bk.prototype.addOne=function(t,e,n){if(void 0===e&&(e=!1),(n=void 0===n?!1:n)&&this.isPreviouslyInvoked)return t(this.lastInvokedArgs),null;var i=this.add(function(e){i.dispose(),t(e)},e);return i},bk.prototype.addThrottled=function(e,t,n){var i=this;return r.assertIsFunction(e,"handler"),r.assert(isFinite(t)&&0<t,"Argument: throttleInterval should be a positive number."),this._throttledEventInvokers.push(new gr(e,t,n)),{dispose:function(){return i._removeThrottledEventHandler(e)}}},bk.prototype.remove=function(e){var t;if("function"==typeof e){for(t=this._handlers.length;t--;)if(this._handlers[t]===e)return void this._handlers.splice(t,1)}else for(t=this._throttledEventInvokers.length;t--;)if(this._throttledEventInvokers[t].handler===e)return this._throttledEventInvokers[t].dispose(),void this._throttledEventInvokers.splice(t,1)},bk.prototype.invoke=function(e){var t,n,i,a;for(this.lastInvokedArgs=e,this.isPreviouslyInvoked=!0,i=(t=this._handlers.slice(n=0)).length;n<i;n++)t[n](e);for(a=this._throttledEventInvokers.slice(0),n=0;n<a.length;n++)a[n].invoke(e)},bk.prototype.hasHandlersRegistered=function(){return 0<this._handlers.length+this._throttledEventInvokers.length},bk.prototype.isHandlerRegistered=function(t){return this._handlers.some(function(e){return t===e})||this._throttledEventInvokers.some(function(e){return t===e.handler})},bk.prototype.dispose=function(){this._handlers=[];for(var e=this._throttledEventInvokers.length;e--;)this._throttledEventInvokers[e].dispose();this._throttledEventInvokers=[],this.lastInvokedArgs=null},bk.prototype._removeThrottledEventHandler=function(e){for(var t=this._throttledEventInvokers.length;t--;)if(this._throttledEventInvokers[t].handler===e)return this._throttledEventInvokers[t].dispose(),void this._throttledEventInvokers.splice(t,1)},bk),a=(Bk.getValue=function(e,t){if(r.assertNotNull(e,"object"),r.assertNotNullOrEmpty(t,"name"),e.hasOwnProperty(t))return e[t];var n=e["get"+Bk.capitalizeProp(t)];return n?n.call(e):e.get?e.get(t):1===e.length&&e.constructor===Bk._gimmeConstructor?Bk.getValue(e[0],t):e[t]},Bk.mergeProperties=function(e,t){var n,i;for(n in t)i=t[n],t.hasOwnProperty(n)&&void 0!==i&&(e[n]=i)},Bk.setValue=function(e,t,n,i){r.assertNotNull(e,"object"),r.assertNotNullOrEmpty(t,"name"),i||Bk.cancelAnimation(e,t);i=e["set"+Bk.capitalizeProp(t)];i?i.call(e,n):e.set?e.set(t,n):e.set_attr?null===n&&e.remove_attr?e.remove_attr(t):e.set_attr(t,n):e[t]=n},Bk.capitalizeProp=function(e){return"string"==typeof e?e.charAt(0).toUpperCase()+e.substring(1):e},Bk.areEqual=function(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(e instanceof Array&&t instanceof Array&&!e.length&&!t.length)return!0;if("object"==typeof e&&e&&t&&e.constructor===Object&&t.constructor===Object){for(var n in e)if(e.hasOwnProperty(n)&&!Bk.areEqual(e[n],t[n]))return!1;for(n in t)if(t.hasOwnProperty(n)&&!Bk.areEqual(e[n],t[n]))return!1;return!0}return e===t},Bk._lerp=function(e,t,n){if(typeof e==typeof t)switch(typeof e){case"object":var i,a={};for(i in e)e.hasOwnProperty(i)&&(a[i]=Bk._lerp(e[i],t[i],n));return a;case"number":return e+(t-e)*n;case"boolean":return n<.5?e:t}},Bk.cancelAnimation=function(e,t){var n=e[Bk._animationPrefix+t];n&&(n.onStop&&n.onStop(),n.abort(),e[Bk._animationPrefix+t]=null)},Bk.hasAnimation=function(e,t){return!!e[Bk._animationPrefix+t]},Bk.animate=function(i,a,o){function s(e){for(var t,n=0;n<g.length;n++)if((t=g[n]).time>=f*e){u=0===n?l:g[n-1],c=t,h=u.time/f,d=c.time/f;break}}var e,t;r.assertNotNull(i,"obj"),r.assertNotNullOrEmpty(a,"prop"),r.assertNotNull(o,"options"),r.assertNotNull(0===o.to||o.to||o.keyframes,"options.to or options.keyframes");var l,u,c,h,d,p=o.from||Bk.getValue(i,a),m=o.to,g=o.keyframes,f=0<=o.duration?o.duration:g&&g[g.length-1].time||300;Bk.cancelAnimation(i,a),0!==f?(e=o.easing&&Bk._easingFuncs[o.easing]||o.easing||Bk._easingFuncs.basic,t=n.Effects.Storyboard.create([i],{value:0},{value:1},function(e,t){t=t.value,g&&(t<h||d<t)&&s(t);var n=(t-h)/(d-h),n="function"==typeof c.value?c.value(n):Bk._lerp(u.value,c.value,n);Bk.setValue(i,a,n,!0),o.frameCallback&&o.frameCallback(t)},f,null,function(){i[Bk._animationPrefix+a]=null,o.repeat?t.begin():o.autoReverse?t.reverse():(o.onStop&&o.onStop(),o.onComplete&&o.onComplete())},e),(i[Bk._animationPrefix+a]=t).begin(),u=l={time:0,value:p},c={time:f,value:m},h=0,d=1,g&&s(0)):Bk.setValue(i,a,m)},Bk.addPropertyValue=function(e,t,n){var i,a,r,o,s=Bk.getValue(e,t)||"";if(n&&"string"==typeof s){for(a=0,r=(i=n.split(/\s+/)).length;a<r;a++)o=i[a],Bk._propertyContainsValues(s,[o])||(""===s?s=o:s+=" "+o);Bk.setValue(e,t,s)}},Bk.propertyHasValues=function(e,t,n){t=Bk.getValue(e,t);return!(!n||!t||"string"!=typeof t)&&Bk._propertyContainsValues(t,n.split(/\s+/))},Bk.removePropertyValue=function(e,t,n){Bk.swapPropertyValue(e,t,n,"$1")},Bk.swapPropertyValue=function(e,t,n,i){var a,r,o,s,l=Bk.getValue(e,t);if(n&&i&&"string"==typeof l){for("$1"!==i&&(i=" "+i+" "),r=0,o=(a=n.split(/\s+/)).length;r<o;r++)s=new RegExp("(^| )"+a[r]+"( |$)"),l=l.replace(s,i);Bk.setValue(e,t,l.replace(/^\s+|\s+$/g,""))}},Bk._propertyContainsValues=function(e,t){var n,i,a;if(!e)return!1;for(n=" "+e+" ",i=0,a=t.length;i<a;i++)if(-1===n.indexOf(" "+t[i]+" "))return!1;return!0},Bk._animationPrefix="__animation_",Bk._gimmeConstructor=n("").constructor,Bk._easingFuncs={linear:function(e){return e},basic:function(e){return e},exponentialOut:function(e){return n.Effects.Easing.Exponential.ease_out(e,4)},exponentialInOut:function(e){return n.Effects.Easing.Exponential.ease_in_out(e,16)}},Bk);String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substring(t=!t||t<0?0:t,t+e.length)===e}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){for(var n=this,i=n.indexOf(e);-1!==i;)i=(n=n.replace(e,t)).indexOf(e);return n}),lm=f=f||{},ho=0,lm._nextId=function(){return ho++},lm._clamp=function(e,t,n){return Math.min(Math.max(e,t),n)},lm._copyObject=function(e){for(var t,n={},i=Object.keys(e),a=0,r=i.length;a<r;a++)n[t=i[a]]=e[t];return n},lm._createElement=function(e){return e=document.createElement(e),n(e)},lm._convertToBool=function(e){return"string"==typeof e?"true"===e.toLowerCase():!!e},lm._distanceToWalkTime=function(e){return Math.ceil(720*e)},lm._deltaDecode=function(e){for(var t=0,n=e.length;n--;)e[n]=t+=e[n]},lm._disableSmoothing=function(e){for(var t,n=["imageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled","webkitImageSmoothingEnabled"],i=0,a=n.length;i<a;i++)if(e[t=n[i]]){e[t]=!1;break}},lm._defineJSEventForDomEvent=function(s,e,l){var u,a;return l=l||{},u=new t,a=function(e){var t,n,a,r,o;l.preventDefault&&e.preventDefault(),l.stopPropagation&&e.stopPropagation(),t={},"number"==typeof e.pageX&&(n=s.get_absolute_pos(),a=s[0],o=r=1,i.isJSEventScaleAware&&n.width&&n.height&&(r=a.offsetWidth/n.width,o=a.offsetHeight/n.height),r=(e.pageX-n.x)*r,o=(e.pageY-n.y)*o,t.point={x:r,y:o}),"number"==typeof e.wheelDelta?t.wheelDelta=e.wheelDelta/120:"number"==typeof e.detail&&(t.wheelDelta=-e.detail),"number"==typeof e.keyCode&&(t.keyCode=e.keyCode),t.target=e.target,l.argBuilder&&l.argBuilder(t,e),u.invoke(t)},s.add_event(e,a),e="jsEvent"+e+"_"+n.Helper.get_guid(a),s[0]&&(s[0][e]=a),u.id=e,u},lm._undefineJSEventForDomEvent=function(e,t,n){var i=e&&e[0];i&&(e.remove_event(t,i[n]),delete i[n])},lm._isArray=wm,lm._allIndexesOf=function(e,t){var n,i,a=[];if(!e)return a;for(n=0,i=e.length;n<i;n++)e[n]===t&&a.push(n);return a},lm._getFinite=function(e,t){return e="number"!=typeof e||!isFinite(e)?t:e},lm._getFirstIndex=zm,lm._getInsertionIndex=Am,lm._orderedDelete=function(e,t,n,i){var r,o=zm(e,t,n,i=void 0===i?a.getValue:i),s=e.length;if(0<=o)for(r=i(t,n);o<s;)if(t===e[o])e.splice(o,1),s--;else{if(i(e[o],n)!==r)break;o++}},lm._orderedInsert=function(e,t,n,i){return i=Am(e,t,n,i=void 0===i?a.getValue:i),e.splice(i,0,t),i},lm._formatString=function(e){for(var t,n,i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];if(e&&i){var r=/\d+/g,o=e.match(/{\d+}/g);if(o)for(t=0;t<o.length;t++)n=i[Number(o[t].match(r)[0])],e=e.replace(o[t],n=null==n?"":n)}return e},lm._replaceValues=function(e,t){var n,i,a,r=e;if(r&&t)for(i=0,a=(n=Object.keys(t)).length;i<a;i++)r=r.replace(n[i],t[n[i]]);return r},lm._getImageFromCss=function(e){var t,i=lm._createElement("img")[0],a=window.document.body;return a&&(i.className=e,i.style.display="none",a.appendChild(i),t=n(i).get_style("background-image"),a.removeChild(i),"none"===t&&((e=lm._createElement("div")[0]).className="MicrosoftMap",e.style.display="none",a.appendChild(e),e.appendChild(i),t=n(i).get_style("background-image"),a.removeChild(e)),t&&(t=t.substring(4,t.length-1),i.src=t.replace(/"/g,"")),i.className=""),i},lm._createAreaText=function(e,t,n){return n=n||v.L_AreaFieldString,n=v.L_FormatFieldString.replace("{0}",n),e<0?n.replace("{1}",v.L_IncorrectValue_text):(t=Hm(e,t),n.replace("{1}",t))},lm._readableTextFromArea=Hm,lm._formatAreaString=Im,lm._createLengthText=function(e,t,n){return n=n||v.L_LengthFieldString,n=v.L_FormatFieldString.replace("{0}",n),e<0?n.replace("{1}",v.L_IncorrectValue_text):(t=Km(e,t),n.replace("{1}",t))},lm._readableTextFromDistance=Km,lm._formatDistanceString=Lm,lm._formatLatLonString=function(e,t){return lm._formatString(v.L_LatLon_Format,lm._toFixed(e,6),lm._toFixed(t,6))},lm._toFixed=function(e,t){return e.toFixed(t).replace(".",u.GlobalConfig.dynamicProperties.cultureData.numberDecimalSeparator)},lm._format2Digit=Om,lm._formatShortDateString=function(e,t){return ao(e,i.dynamicProperties.cultureData.shortDatePattern,t)},lm._formatLongDateString=function(e){return ao(e,i.dynamicProperties.cultureData.longDatePattern)},lm._formatAbbrevLongDateString=function(e){var t=i.dynamicProperties.cultureData.longDatePattern;return ao(e,t=(t=t.replace("dddd","ddd")).replace("MMMM","MMM"))},lm._formatYearMonthString=function(e){return ao(e,i.dynamicProperties.cultureData.yearMonthPattern,!1,!0)},lm._formatWeekMonthDayString=function(e){return ao(e,i.dynamicProperties.cultureData.weekMonthDayPattern)},lm._formatDurationString=function(e,t){return t=(t=void 0===t?!1:t)?Math.ceil(e/60):Math.round(e/60),e=t%60,0===(t=Math.floor(t/60))?lm._formatString(v.L_Duration_Min,e):0==e?lm._formatString(v.L_Duration_NoMin,t):lm._formatString(v.L_Duration,t,e)},lm._formatTimeString=function(e){return lm._formatShortTimeString(e.getHours(),e.getMinutes(),e.getSeconds())},lm._formatUTCTimeString=function(e){return lm._formatShortTimeString(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())},lm._formatShortTimeString=function(e,t,n){var i,a=u.GlobalConfig.dynamicProperties.cultureData,r=(s=a.shortTimePattern).indexOf("H")<0,o=r?(i=12<=e,12<(o=e)?o-=12:o=o||12,e=o,"h"):"H",s=Om(s,o,e);return s=Om(s,"m",t),s=Om(s,"s",n),(s=r?s.replace("tt",i?a.pmDesignator:a.amDesignator):s).replace(/:/g,a.timeSeparator)},lm._getTimeString=function(e){return lm._formatUTCTimeString(new Date(lm._getTime(e)))},lm._getTime=function(e){var t,n,i=e&&e.match(/\((\d+)([-,+]?)(\d{2})?(\d{2})?\)/);return i&&i[1]&&(t=parseInt(i[1],10),i[2]&&i[3]&&i[4])&&(n="-"===i[2]?-1:1,e=parseInt(i[3],10),i=parseInt(i[4],10),isNaN(e)||isNaN(i)||(t+=n*(60*e+i)*6e4)),t},lm._generateRandomKey=function(){function e(){return(65536*(1+Math.random())|0).toString(16).substr(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},lm._getUrlParam=_m,lm._areArraysEqual=function(e,t){if(e===t)return!0;if(!e||!t||e.length!==t.length)return!1;for(var n=e.length-1;0<=n;){if(e[n]!==t[n])return!1;--n}return!0},lm._arePrimitivesEqual=function(e,t){return e===t},lm._isPerformanceTest=function(){var e=_m(window.location,"perftest");return"true"===e||"1"===e},lm._getPolygonId=function(){return _m(window.location,"polygon")},lm._getDpr=function(){return parseFloat(_m(window.location,"dpr"))||window.devicePixelRatio||1},lm._isHighContrastMode=function(){return window.matchMedia("(-ms-high-contrast:active)").matches},lm._formatHexColorString=function(e,t){if(e&&16777215!==e&&4294967295!==e){for(var n=e.toString(16);n.length<6;)n="0"+n;return"#"+(n=8===n.length?n.substr(2):n)}return t||""},lm._calcLuminance=function(e){return(.299*((16711680&e)>>16)+.587*((65280&e)>>8)+.114*(255&e))/256},lm._isLargeMapShownOnSerp=function(){var e=bo();return!(!e||!e.dynamicProperties)&&(e.isMapsAnswer&&e.dynamicProperties.largeMapShownOnSerp)},lm._isSmallMapShownOnSerp=function(){var e=bo();return!(!e||!e.dynamicProperties)&&(e.isMapsAnswer&&!e.dynamicProperties.largeMapShownOnSerp)},lm._isLocalOverlayShownOnSerp=function(){var e=bo(),t=e&&e.dynamicProperties;return!!t&&(e.isMapsAnswer&&t.localOverlayOnSerp&&t.localOverlayOnSerp.visible)},lm._isRealEstateOverlayShownOnSerp=function(){var e=bo(),t=e&&e.dynamicProperties;return!!t&&(e.isMapsAnswer&&t.realEstateOverlayOnSerp&&t.realEstateOverlayOnSerp.visible)},lm._isTravelOverlayShownOnSerp=function(){var e=bo(),t=e&&e.dynamicProperties;return!!t&&(e.isMapsAnswer&&t.travelOverlayOnSerp&&t.travelOverlayOnSerp.visible)},lm._isMapsSDK=function(){var e=bo();return!e||e.isSDK},lm._hasBingHeaders=function(){return"undefined"!=typeof _G},lm._isLocalOrRealEstateScenarioOverlayShownOnSerp=function(){return lm._isLocalOverlayShownOnSerp()||lm._isRealEstateOverlayShownOnSerp()},lm._getCssForTaskBackground=function(e,t,n){var i,a=document.createElement("style");return a.type="text/css",a.innerHTML=(i=".MicrosoftMap .taskCard.focus .titleBar.")+e+",\n                    "+i+"hover."+e+",\n                    "+i+e+" .catIcon,\n                    "+i+"hover."+e+" .catIcon,\n                    "+i+e+" ."+n+".titleIcon,\n                    "+i+"hover."+e+" ."+n+".titleIcon\n                    {background-color:"+t+"}",a},lm._clearDisposables=function(e){var t,n,i,a,r;if(e)if(Array.isArray(e)){for(i=0,a=(t=e).length;i<a;i++)(r=t[i])&&r.dispose&&r.dispose();t.length=0}else for(i=0,a=(n=Object.keys(e)).length;i<a;i++)(r=e[n[i]])&&r.dispose&&r.dispose(),delete e[n[i]]},lm._disposeEvents=function(e){if(e)for(var n in e)e.hasOwnProperty(n)&&e[n]instanceof t&&(e[n].dispose&&e[n].dispose(),delete e[n])},lm._nullifyClass=function(e){var t,n,i;if(e)for(t in e)e.hasOwnProperty(t)&&(n=e[t],n&&(i=typeof n,"function"!=i&&(wm(n)?e[t]=[]:"object"==i&&(e[t]=null))))},lm._getTileSubDomain=function(e){var t=e.charAt(e.length-1),e=parseInt(t)%2;return t=NaN!==e?e.toString():t},lm._getIsSlideCardEnabled=function(){var e,t,i,a=Microsoft.Maps.GlobalConfig.features.taskFramework;return void 0===lm._isSlideCardEnabled&&(lm._isSlideCardEnabled=a&&n("body")[0].clientWidth>=a.slideoutMinWidth,e={logData:{feature:it.TaskManager,action:w.Activated,data:{isSlideEnabled:lm._isSlideCardEnabled}},impressionGuid:Microsoft.Maps.GlobalConfig.dynamicProperties.mapsIG},t=Microsoft&&Microsoft.Maps&&Microsoft.Maps.GlobalDataEventHandler,i=Microsoft&&Microsoft.Maps&&Microsoft.Maps.DataHandlerKeys,t&&i&&Microsoft.Maps.setTimeout(function(){t.invokeHandler(i.instrumentationDataHandlerKey,e)},2e3)),lm._isSlideCardEnabled},lm.setVerticalTaskBarWidth=function(e){io=e},lm.getVerticalTaskBarWidth=function(){var e=0,t=Microsoft.Maps.GlobalConfig.features.taskBar;if(t&&t.showTaskBarL2Nav){if(io)return io;e=0<(t=n(".taskBar")).length?t.get_size().width:0}return e},lm.getSearchBoxHeaderHeight=function(){var e=0,t=Microsoft.Maps.GlobalConfig.features.taskBar;return e=t&&(t.searchBoxAsHeader||t.enableTCFDesignA)?0<(t=n(t.searchBoxAsHeader?".bm_searchBoxNavLeft.bm_tcfDesign_B":".MicrosoftMap .taskBar")).length?t.get_size().height:0:e},lm._isFeatureEnabled=function(e){var t=Microsoft&&Microsoft.Maps&&Microsoft.Maps.GlobalConfig;return t&&t.features[e]&&t.features[e].isEnabled},lm._updateTfeUrlDomain=function(e){var t=Microsoft&&Microsoft.Maps&&Microsoft.Maps.Internal;return t?(t=t._CoreConfig(),e.replace("{protocol}",t.urlProtocol).replace("{tfeDomainDynamic}",t.tfeDomainDynamic).replace("{tfeDomainStatic}",t.tfeDomainStatic)):e},lm._updateTfeMktAndUrl=function(e){var t=i.dynamicProperties,n=t.userRegion;return(e=n&&t.isGeopolUserRegion?e.replace(/{ur}/,n):e.replace(/&ur={ur}/,"")).replace("{mkt}",t.uiLanguage)},lm._updateSearchTaskStateWithAdsData=function(e,t){e&&t&&t.adProviderId&&(e.adBusinessLocationId=t.adBusinessLocationId,e.adImpressionGuid=t.adImpressionGuid,e.adProviderId=t.adProviderId,e.adQuery=t.adQuery,e.adRetailEntitySource=t.adRetailEntitySource,e.adStoreId=t.adStoreId,e.adTriggerType=t.adTriggerType,e.adYpid=t.adYpid)},lm._overrideTasktypeBasedOnCategory=function(e,t,i){var a,r=e;return t&&(a=t.searchQueryCategory||t.selectedCategoryId||t.category,"LocalListingTask"===e?(Microsoft.Maps.GlobalConfig.features.localSearch.enableCustomHotelsExperience&&Gn(a)?r="HotelsListingTask":Fn(a)?r="HouseListingTask":Microsoft.Maps.GlobalConfig.features.localSearch.enableCustomRestaurantsExperience&&In(a)?r="RestaurantsListingTask":Jn(a)&&(r="PolygonListingTask"),t.activatingElement=i&&n(i)):"LocalDetailsTask"===e&&(Microsoft.Maps.GlobalConfig.features.localSearch.enableCustomHotelsExperience&&Gn(a)?r="HotelsDetailsTask":Fn(a)?r="HouseDetailsTask":Microsoft.Maps.GlobalConfig.features.localSearch.enableCustomRestaurantsExperience&&In(a)&&(r="RestaurantDetailsTask"),t.activatingElement=i&&n(i))),r},lm._isHouseCategory=Fn,lm._isHotelsCategory=Gn,lm._isAttractionCategory=function(e){return co(e,["attraction","90012"])},lm._isRestaurantCategory=In,lm._isZipCodeCategory=Jn,lm._isCoreConfigSettingEnabled=function(e){var t=Vn();return t&&t[e]},lm._getPrimitiveIds=function(e){for(var t,n=wm(e)?e:[e],i=[],a=0;a<n.length;a++)(t=(t=n[a])&&t.entity&&t.entity.id)&&i.push(t);return i},lm._getHash=function(e){for(var t=0,n=0,i=0;i<e.length;i++)t+=e.charCodeAt(i)<<n,6<++n&&(n=0);return t.toString(16)},lm._renderAllPoiAndLabelsGL=Nn,lm._disableRenderGL=function(){var e=i.features.labels;e&&(e.glLabelAndPoi=!1),(e=i.features.taskFramework)&&(e.glMicroPoi=!1),i.glPolyline=!1},lm._showOrHideOverlayMenu=function(e){var t,i=n("#id_h");0<i.length&&(t=i.get_style("display"),e&&"none"===t?i.set_style({display:""}):e||"none"===t||i.set_style({display:"none"}))},lm._setFocusOnFirstMenuItem=function(e){0<e.length&&((e=n(e[e.length-1]).select(".dropdownEntry"))&&0<e.length&&(e[0].focus(),e[0].style.border="none"))},lm._isPercievedLoadSkeletonShown=function(){return jo},lm._setPercievedLoadSkeletonShown=function(e){jo=e},lm._decodeHTML=function(e){var t,n=e;return e&&((t=document.createElement("textarea")).innerHTML=e,n=t.value),n},lm._refocusPrintDropDownMenu=function(r){Microsoft.Maps.setTimeout(function(){var e,t=i.features.taskBar,a=n(document).select("[data-subtaskid='"+r+"']");t&&!t.showTaskBarL2Nav?0<(e=a&&a.select(".menu")).length&&((e[1]||e[0]).click(),Microsoft.Maps.setTimeout(function(){var e=n(".menuPrintItem",a[0]);0<e.length&&e[0].parentElement.focus()},150)):0<(e=n(".bm_MainActions .printIcon")).length&&e[0].parentElement.focus()},200)},lm._getCoreConfig=Vn,lm.supportWebGL=function(){var e=!1;if(Nn())try{Xn(document.createElement("canvas")),e=!0}catch(e){}return e},lm.createContext=Xn,lm.buildSkeletonCardContainer=function(e){var t,n="bm_cardWrapper";return e&&(n+=" "+e),t=Zn("div",n),e=Zn("div","panelWrapper left Light"),t.appendChild(e),n=Zn("div","panelContent"),e.appendChild(n),e=Zn("div","taskCard focus"),n.appendChild(e),n=Zn("div","cardFace"),e.appendChild(n),e=Zn("div","cardContent"),n.appendChild(e),n=Zn("div","contentRoot"),e.appendChild(n),t},lm.createElementWithClassName=Zn,lm.flipClickReturnToList=function(e){var t,i,a,r=n(".bm_navLeftBack");if(0===(r=e&&-1<e.id.toLowerCase().indexOf("collection")?n(".collectionBack"):r).length&&(0!==(r=0===(r=n(".backButtonContainer")).length?n("[data-tag=detailsCardBackBtnContainer]"):r).length&&"none"!==r.get_style("display")||(r=null)),e&&r&&0<r.length){for(t=0;t<r.length;t++)if(a=0<(i=0===(i=n(r[t]).select(".backArrowButton")).length&&n(r[t]).has_class("collectionBack")?n(r[t]):i).length?i.get_attr("data-task"):null){if((a=JSON.parse(a))&&a.id===e.id){i.fireEvent("click");break}}else if(-1<e.id.toLowerCase().indexOf("collection")){i.fireEvent("click");break}return!1}},lm.isSlideOutCard=function(e){if(e){var t=e.getForegroundTask(),e=e.getFirstTask();return lm._isSlideCardEnabled&&t&&e&&t!==e&&1===t.displayState.activationState&&2===e.displayState.activationState&&2===t.displayState.stackOrder&&1===e.displayState.stackOrder}return!1},lm.itineraryCloseButtonHandler=function(e,r){var o=e.changed.add(function(e){var t,i,a;e&&"percentLoaded"===e.name&&1===e.newValue&&(o.dispose(),0<(i=n("div[data-subtaskid="+r+"]")).length)&&(a=i[0],t=n(".bm_cardClose",a),e=n(".bm_ItinBack",a),i=n(".bm_itinDestinations",a),a=e?e.get_style("display"):"",0<i.length&&t.add_class(!e||-1<a.indexOf("none")?"itin":"itin back"))})};var at=function(e,t,n){this.position=e,this.value=t,this.tangentOutType=n},vt=(Yv.prototype.addKey=function(e){this._keys.push(e),this._tangentCalculated=!1},Yv.prototype.computeTangents=function(){if(!this._tangentCalculated){for(var e=0;e<this._keys.length;e++)this.computeTangent(e);this._tangentCalculated=!0}},Yv.prototype.computeTangent=function(e){var t,n,i,a;if(this._keys.length<=e||e<0)throw new Error("Index out of range");var r,o,s=this._keys[e],l=s.tangentOutType,u=0<e?this._keys[e-1].tangentOutType:l,c=a=n=s.position,h=i=t=s.value;0<e&&(c=this._keys[e-1].position,h=this._keys[e-1].value),e+1<this._keys.length&&(n=this._keys[e+1].position,t=this._keys[e+1].value),1===u?(r=n-c,o=t-h,s.tangentInValue=Math.abs(o)<this._CurveEpsilon?0:o*Math.abs(c-a)/r):s.tangentInValue=0===u?i-h:0,1===l?(r=n-c,o=t-h,s.tangentOutValue=Math.abs(o)<this._CurveEpsilon?0:o*Math.abs(n-a)/r):s.tangentOutValue=0===l?t-i:0},Yv.prototype.evaluate=function(e){if(0===this._keys.length)return 0;if(1===this._keys.length)return this._keys[0].value;if(!this._tangentCalculated)throw new Error("Curve tangents have not been precalculated.");if(this._lastValue&&this._lastValue.position===e)return this._lastValue.value;var t=this._keys[0],n=this._keys[this._keys.length-1],n=e<t.position?t.value:n.position<e?n.value:0+this.hermite(e);return this._lastValue={position:e,value:n},n},Yv.prototype.hasValueAt=function(e){return 0!==this._keys.length&&(1===this._keys.length?this._keys[0].position===e:this._keys[0].position<=e&&e<=this._keys[this._keys.length-1].position)},Yv.prototype.getHasValue=function(){return 0<this._keys.length},Yv.prototype.hermite=function(e){var t,n;if(this._keys.length<2)throw new Error("More than one value is required");for(var i=e,a=this._keys[0],r=null,o=1;o<this._keys.length;o++){if((r=this._keys[o]).position>=e){t=a.position,i=0,e=i=1e-10<(n=r.position-t)?(e-t)/n:i;break}a=r}if(2===a.tangentOutType)return(1<=e?r:a).value;var s=e*e,l=s*e,u=a.value,c=a.tangentOutValue,h=r.tangentInValue;return u*(2*l-3*s+1)+r.value*(-2*l+3*s)+c*(l-2*s+e)+h*(l-s)},Yv),ot=(Cw.parse=function(e,t){var n=Cw._getColorFormat(e),e=void 0!==n?new Cw(e,n=1===n&&2===t?2:n):Cw._parseViaBrowser(e);return e},Cw.prototype.toPacked=function(){return((255*this.alpha&255)<<24>>>0)+((255&this.red)<<16)+((255&this.green)<<8)+(255&this.blue)},Cw.prototype.toRgba=function(){return this.alpha<1?"rgba("+this.red+","+this.green+","+this.blue+","+k.roundToInterval(this.alpha,.01)+")":"rgb("+this.red+","+this.green+","+this.blue+")"},Cw._getColorFormat=function(e){var t;return"#"!==(e=e||"")[0]||7!==e.length&&9!==e.length||isNaN(parseInt(e.slice(1),16))?e.match(Cw.rgbRegex)&&(t=0):t=1,t},Cw._parseViaBrowser=function(e){var t,n,i;return e&&(n=document.createElement("div"),i=document.body,n.style.display="none",n.style.color=e,n.style.color&&(i.appendChild(n),e=getComputedStyle(n).color,i.removeChild(n),e&&e.match(Cw.rgbRegex)&&(t=new Cw(e,0)))),t},Cw.prototype._parseHex=function(e,t){var n=parseInt(e.slice(1),16);9===e.length?2===t?this.alpha=(n>>24&255)/255:(this.alpha=(255&n)/255,n>>=8):this.alpha=1,this.red=n>>16&255,this.green=n>>8&255,this.blue=255&n,r.assert(!isNaN(this.red),"red color is not as expected"),r.assert(!isNaN(this.green),"green color is not as expected"),r.assert(!isNaN(this.blue),"blue color is not as expected")},Cw.prototype._parseRgba=function(e){e=e&&e.match&&e.match(Cw.rgbRegex);e&&4<e.length&&this._populateColorComponents(e.slice(1))},Cw.prototype._populateColorComponents=function(e){e&&3<=e.length&&(this.red=parseInt(e[0]),r.assert(!isNaN(this.red),"red color is not as expected"),this.green=parseInt(e[1]),r.assert(!isNaN(this.green),"green color is not as expected"),this.blue=parseInt(e[2]),r.assert(!isNaN(this.blue),"blue color is not as expected"),3<e.length&&void 0!==e[3]?(this.alpha=parseFloat(e[3]),r.assert(!isNaN(this.alpha),"alpha color is not as expected")):this.alpha=1)},Cw.prototype._unpackColor=function(e){e=parseInt(e);this.red=e>>16&255,this.green=e>>8&255,this.blue=255&e,this.alpha=k.roundToInterval((e>>24&255)/255,.01)},Cw.transparent="rgba(255, 255, 255, 0.0)",Cw.white="rgb(255, 255, 255)",Cw.black="rgb(0, 0, 0)",Cw.rgbRegex=/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/,Cw),nu=function(e,t,n,i){this.x=e,this.y=t,this.z=n,this.w=i},gi=(ax.prototype.addKey=function(e,t,n,i,a,r){this._curveX.addKey(new at(e,t,r)),this._curveY.addKey(new at(e,n,r)),this._curveZ.addKey(new at(e,i,r)),this._curveW.addKey(new at(e,a,r))},ax.prototype.computeTangents=function(){this._curveX.computeTangents(),this._curveY.computeTangents(),this._curveZ.computeTangents(),this._curveW.computeTangents()},ax.prototype.evaluateCurve=function(e){return new nu(this._curveX.evaluate(e),this._curveY.evaluate(e),this._curveZ.evaluate(e),this._curveW.evaluate(e))},ax),tu=(ix=gi,p(jx,ix),jx.prototype.addKey=function(e,t,n,i,a,r){var o=t/255,s=n/255,l=i/255,u=a,c=0,t=0,n=0,i=Math.max(l,Math.max(o,s)),a=Math.min(l,Math.min(o,s));i===a?c=0:i===o&&l<=s?c=(s-l)/(i-a)*60:i===o&&s<l?c=(s-l)/(i-a)*60+360:i===s?c=(l-o)/(i-a)*60+120:i===l&&(c=(o-s)/(i-a)*60+240),n=.5*(i+a),i===a?t=0:n<=.5?t=(i-a)/(2*n):.5<n&&(t=(i-a)/(2-2*n)),ix.prototype.addKey.call(this,e,c/360,st.clamp(t,0,1),st.clamp(n,0,1),st.clamp(u,0,1),r)},jx.prototype.evaluate=function(e){e=ix.prototype.evaluateCurve.call(this,e);return st.hslaTorgba(e.x,e.y,e.z,e.w)},jx.prototype.evaluateHsla=function(e){return ix.prototype.evaluateCurve.call(this,e)},jx),st=(Cx.getComponent=function(e,t,n){return e<1/6?t+6*(n-t)*e:e<.5?n:e<2/3?t+6*(n-t)*(2/3-e):t},Cx.normalize=function(e){return e<0&&(e+=1),1<e&&--e,e},Cx.clamp=function(e,t,n){return e<t?t:n<e?n:e},Cx.applyHslaTransform=function(e,t){var n=e.x+t.x;return 1<n&&--n,{x:n,y:Cx.clamp(e.y+t.y,0,1),z:Cx.clamp(e.z+t.z,0,1),w:Cx.clamp(e.w+t.w,0,1)}},Cx.hslaTorgba=function(e,t,n,i){var a=n<.5?n*(1+t):n+t-n*t,r=2*n-a,t=Cx.getComponent(Cx.normalize(e+1/3),r,a),n=Cx.getComponent(Cx.normalize(e),r,a),a=Cx.getComponent(Cx.normalize(e-1/3),r,a);return new ot([Cx.clamp(Math.round(255*t),0,255),Cx.clamp(Math.round(255*n),0,255),Cx.clamp(Math.round(255*a),0,255),Cx.clamp(i,0,1)])},Cx.convertPackedTorgba=function(e){return new ot(e,3).toRgba()},Cx),iu=function(e,t,n){this.start=e,this.end=t,this.value=n},ru=(dy.prototype.addRange=function(e,t,n){this._ranges.push(new iu(e,t,n))},dy.prototype.evaluate=function(e){for(var t,n=0;n<this._ranges.length;n++)if((t=this._ranges[n]).start<=e&&t.end>=e)return t.value;return null},dy.prototype.hasValueAt=function(e){for(var t,n=0;n<this._ranges.length;n++)if((t=this._ranges[n]).start<=e&&t.end>=e)return!0;return!1},dy.prototype.getHasValue=function(){return 0<this._ranges.length},dy),nr=(ny.prototype.invert=function(){var e=this._values,t=e[0],n=e[1],i=e[2],a=e[3],r=e[4],o=e[5],e=t*a-n*i;if(0==e)throw new Error("Determinant is zero");return new ny(a/e,-n/e,-i/e,t/e,(i*o-a*r)/e,(n*r-t*o)/e)},ny.prototype.multiply=function(e){var t=this._values,n=t[0],i=t[1],a=t[2],r=t[3],o=t[4],s=t[5],l=(t=e.getValues())[0],u=t[1],c=t[2],h=t[3],e=t[4],t=t[5];return new ny(n*l+a*u,i*l+r*u,n*c+a*h,i*c+r*h,o+n*e+a*t,s+i*e+r*t)},ny.prototype.transform=function(e){return new h(this.projectX(e.x,e.y),this.projectY(e.x,e.y))},ny.prototype.projectX=function(e,t){var n=this._values;return e*n[0]+t*n[2]+n[4]},ny.prototype.projectY=function(e,t){var n=this._values;return e*n[1]+t*n[3]+n[5]},ny.prototype.scale=function(e,t){var n=this._values;return new ny(n[0]*e,n[1]*t,n[2]*e,n[3]*t,n[4]*e,n[5]*t)},ny.prototype.translate=function(e,t){var n=this._values;return new ny(n[0],n[1],n[2],n[3],n[4]+e,n[5]+t)},ny.prototype.rotate=function(e){if(0===e)return this;var t=this._values,n=Math.cos(e),i=Math.sin(e),a=t[0],r=t[2],e=t[4];return new ny(a*n-t[1]*i,a*i+t[1]*n,r*n-t[3]*i,r*i+t[3]*n,e*n-t[5]*i,e*i+t[5]*n)},ny.prototype.getValues=function(){var e=this._values;return[e[0],e[1],e[2],e[3],e[4],e[5]]},ny.prototype.equals=function(e){var t,n=e&&e.getValues();if(n&&6===n.length){for(t=0;t<6;t++)if(this._values[t]!==n[t])return!1;return!0}return!1},ny.prototype.nearlyEquals=function(e,t){var n,i=e&&e.getValues();if(i&&6===i.length){for(n=0;n<6;n++)if(Math.abs(this._values[n]-i[n])>t)return!1;return!0}return!1},ny.prototype.getZoomDirection=function(){var e=this.getValues();return e[0]<.9999||e[3]<.9999?-1:1.0001<e[0]||1.0001<e[3]?1:0},ny.identity=new ny(1,0,0,1,0,0),ny),rt=(xz.prototype._invokeChanged=function(e,t,n,i,a){this.revision++,this.changed&&this.changed.invoke({addedIndex:e,added:t,removedIndex:n,removed:i,reset:!0===a})},xz.prototype.insert=function(e,t){this._allowDuplicates||-1===this.indexOf(e)?this.insertAll([e],t):(this.remove(e),this.insert(e,t))},xz.prototype.insertAll=function(e,t){var n,i,a;if(e&&e.length){if(("number"!=typeof t||t<0||t>=this.length)&&(t=this.length),n=[],this._allowDuplicates)n=e;else for(i=0;i<e.length;i++)-1===this.indexOf(e[i])&&e.indexOf(e[i])===i&&n.push(e[i]);0<n.length&&(a=(a=[t,0]).concat(n),Array.prototype.splice.apply(this,a),this._invokeChanged(t,n,null,null))}},xz.prototype.remove=function(e){this.removeAt(this.indexOf(e))},xz.prototype.removeAt=function(e,t){void 0===t&&(t=1),0<=e&&1<=t&&e+t<=this.length&&(t=Array.prototype.splice.call(this,e,t),this._invokeChanged(null,null,e,t,0===this.length))},xz.prototype.clear=function(){var e=Array.prototype.splice.call(this,0,this.length);this._invokeChanged(null,null,0,e,!0)},xz.prototype.indexOf=function(e,t){return void 0===t&&(t=0),Array.prototype.indexOf.call(this,e,t)},xz.prototype.lastIndexOf=function(e,t){return void 0===t&&(t=this.length),Array.prototype.lastIndexOf.call(this,e,t)},xz.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),Array.prototype.slice.call(this,e,t)},xz.prototype.setValue=function(e,t){var n;e<0||(n=this[e],this[e]=t,this.length=Math.max(this.length,e+1),this._invokeChanged(e,[t],e,[n]))},xz.prototype.find=function(e){for(var t,n=0;n<this.length;n++)if(e(t=this[n]))return t;return null},xz.prototype.dispose=function(){f._clearDisposables(this.slice()),f._disposeEvents(this),this.clear()},xz);rt.prototype.length=Array.prototype.length;var dt=(bA.prototype.dispose=function(){this._privates&&this._privates.undefineProperties&&this._privates.undefineProperties(),this._privates={}},bA.fromObject=function(e){var t,n,i,r;if(e instanceof Array){for(t=new rt,n=0;n<e.length;n++)t.insert(bA.fromObject(e[n]));return t}if(!e||"object"!=typeof e||e instanceof bA)return e;for(i in r=new bA,e)e.hasOwnProperty(i)&&(r.defineProperty(i),a.setValue(r,i,bA.fromObject(e[i])));return r},bA),yt=function(e,t,n,i){this.sender=e,this.name=t,this.oldValue=n,this.newValue=i},oi=(NA=dt,p(OA,NA),OA.prototype.getId=function(){return this._id},OA.prototype.getFrameManager=function(){return this._frameManager},OA.prototype.setFrameManager=function(e){this._frameManager=e,this._coreMap=e.getMap()},OA.prototype.dispose=function(){this._coreMap&&(this._coreMap.getLayers().remove(this),this._coreMap=null),NA.prototype.dispose.call(this),f._clearDisposables(this._disposables),this._frameManager=null,f._disposeEvents(this)},OA._id=1,OA),tr=(ZA.prototype.intersects=function(e){return this.bbox.intersects(e.bbox)&&this._intersectsOneWay(e)&&e._intersectsOneWay(this)},ZA.prototype._intersectsOneWay=function(e){for(var t,n,i=0,a=this._normals.length;i<a;i++)if(t=this._projections[i],n=c.projectOntoAxis(this._normals[i],e.corners),t.min>n.max||t.max<n.min)return!1;return!0},ZA._computeCorners=function(e,t){var n,i,a,r=e.getCorners();if(0!==t)for(n=nr.identity.rotate(t),i=0,a=r.length;i<a;i++)r[i]=n.transform(r[i]);return r},ZA),gt=(rB.empty=function(){return new rB(null,null)},rB.fromPoints=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var i=(f._isArray(arguments[0])?arguments[0]:arguments)||[],a=Number.MAX_VALUE,r=a,o=-a,s=-r,l=0,u=i.length;l<u;l++)(e=i[l])&&(a=Math.min(a,e.x),r=Math.min(r,e.y),o=Math.max(o,e.x),s=Math.max(s,e.y));return a===Number.MAX_VALUE?rB.empty():new rB(new h(a,r),new h(o,s))},rB.fromSides=function(e,t,n,i){var a=Math.min(e,t),e=Math.max(e,t),t=Math.min(n,i),i=Math.max(n,i);return new rB(new h(a,t),new h(e,i))},rB.prototype.clone=function(){return new rB(this.minPoint&&this.minPoint.clone(),this.maxPoint&&this.maxPoint.clone())},rB.prototype.equals=function(e,t){if(e){var n=this.isEmpty(),i=e.isEmpty();return!(!n||!i)||!n&&!i&&(0<t?this.minPoint.equals(e.minPoint,t)&&this.maxPoint.equals(e.maxPoint,t):this.minPoint.equals(e.minPoint)&&this.maxPoint.equals(e.maxPoint))}return!1},rB.prototype.getCorners=function(){r.assert(!this.isEmpty(),"Calling rect.corners on an empty rect is a coding error");var e=this.minPoint.x,t=this.maxPoint.x,n=this.minPoint.y,i=this.maxPoint.y;return[new h(e,n),new h(t,n),new h(t,i),new h(e,i)]},rB.prototype.getSize=function(){return this.isEmpty()?new nt(0,0):new nt(this.maxPoint.x-this.minPoint.x,this.maxPoint.y-this.minPoint.y)},rB.prototype.getCenter=function(){return this.isEmpty()?null:{x:(this.minPoint.x+this.maxPoint.x)/2,y:(this.minPoint.y+this.maxPoint.y)/2}},rB.prototype.buffer=function(e,t){var n;r.assert(!this.isEmpty(),"Calling rect.buffer on an empty rect is a coding error"),this.minPoint.x=this.minPoint.x-e,this.minPoint.y=this.minPoint.y-t,this.maxPoint.x=this.maxPoint.x+e,this.maxPoint.y=this.maxPoint.y+t,this.minPoint.x>this.maxPoint.x&&(n=this.minPoint.x,this.minPoint.x=this.maxPoint.x,this.maxPoint.x=n),this.minPoint.y>this.maxPoint.y&&(n=this.minPoint.y,this.minPoint.y=this.maxPoint.y,this.maxPoint.y=n)},rB.prototype.intersect=function(e){return this.intersects(e)?(this.minPoint=new h(Math.max(this.minPoint.x,e.minPoint.x),Math.max(this.minPoint.y,e.minPoint.y)),this.maxPoint=new h(Math.min(this.maxPoint.x,e.maxPoint.x),Math.min(this.maxPoint.y,e.maxPoint.y))):this.minPoint=this.maxPoint=null,this},rB.prototype.intersects=function(e){return!this.isEmpty()&&!e.isEmpty()&&this.minPoint.x<=e.maxPoint.x&&this.minPoint.y<=e.maxPoint.y&&this.maxPoint.x>=e.minPoint.x&&this.maxPoint.y>=e.minPoint.y},rB.prototype.isEmpty=function(){return!this.minPoint||!this.maxPoint},rB.prototype.isInside=function(e){return!this.isEmpty()&&!e.isEmpty()&&this.minPoint.x>=e.minPoint.x&&this.minPoint.y>=e.minPoint.y&&this.maxPoint.x<=e.maxPoint.x&&this.maxPoint.y<=e.maxPoint.y},rB.prototype.pointInRect=function(e){return!this.isEmpty()&&e.x>=this.minPoint.x&&e.x<=this.maxPoint.x&&e.y>=this.minPoint.y&&e.y<=this.maxPoint.y},rB.prototype.rotate=function(e){return r.assert(!this.isEmpty(),"Calling rect.rotate on an empty rect is a coding error"),new tr(this,e)},rB.prototype.union=function(e){return e.isEmpty()||(this.isEmpty()?(this.minPoint=e.minPoint.clone(),this.maxPoint=e.maxPoint.clone()):(this.minPoint.x=Math.min(this.minPoint.x,e.minPoint.x),this.minPoint.y=Math.min(this.minPoint.y,e.minPoint.y),this.maxPoint.x=Math.max(this.maxPoint.x,e.maxPoint.x),this.maxPoint.y=Math.max(this.maxPoint.y,e.maxPoint.y))),this},rB.prototype.unionPoint=function(e){return this.isEmpty()?(this.minPoint=e.clone(),this.maxPoint=e.clone()):(this.minPoint.x=Math.min(this.minPoint.x,e.x),this.minPoint.y=Math.min(this.minPoint.y,e.y),this.maxPoint.x=Math.max(this.maxPoint.x,e.x),this.maxPoint.y=Math.max(this.maxPoint.y,e.y)),this},rB),c;gC=c=c||{},gC.degreesPerRadian=180/Math.PI,gC.radiansPerDegree=Math.PI/180,gC.loge2=Math.log(2),gC.twoPI=2*Math.PI,gC.thirtyDegreesInRadians=Math.PI/6,gC.MAX_ZOOM_LEVEL=23,gC.zoomDeltaBetweenLods=1/(gC.MAX_ZOOM_LEVEL-1),gC.markupVisible=0,gC.markupInvisible=255,gC.trySolve=function(e,t,n,i){return 0!=n-e?[n=(i-t)/(n-e),t-n*e]:null},gC.degreesToRadians=function(e){return e*gC.radiansPerDegree},gC.radiansToDegrees=function(e){return e*gC.degreesPerRadian},gC.normalizeRadian=function(e){for(;e<0;)e+=gC.twoPI;for(;e>=gC.twoPI;)e-=gC.twoPI;return e},gC.normalizeDegrees=function(e){return(360+e)%360},gC.log2=function(e){return Math.log(e)/gC.loge2},gC.rotatePoint=function(e,t,n){var i=Math.cos(n),n=Math.sin(n);return new h(e*i-t*n,e*n+t*i)},gC.getPointFromAngleAndRadius=function(e,t){var n=Math.sin(e)*t,t=Math.cos(e)*t;return new h(n,t)},gC.getVector2DFromMagnitudeAndDirection=function(e,t){var n=e*Math.cos(t),t=e*Math.sin(t);return new h(n,t)},gC.getAngleOfVector2D=function(e){return Math.atan2(e.y,e.x)},gC.getAngleOfSegment2D=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},gC.getMagnitudeOfVector2D=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},gC.getMidpoint2D=function(e,t){var n=(e.x+t.x)/2,t=(e.y+t.y)/2;return new h(n,t)},gC.getVectorSum2D=function(e,t){var n=e.x+t.x,t=e.y+t.y;return new h(n,t)},gC.getVectorDifference2D=function(e,t){var n=e.x-t.x,t=e.y-t.y;return new h(n,t)},gC.getEuclideanDistance2D=function(e,t){var n=t.x-e.x,e=t.y-e.y;return Math.sqrt(n*n+e*e)},gC.getDistanceFromPointToVector=function(e,t,n){var i=n.x-t.x,a=n.y-t.y;return 1<(n=((e.x-t.x)*i+(e.y-t.y)*a)/(i*i+a*a))?n=1:n<0&&(n=0),i=t.x+n*i,a=t.y+n*a,i-=e.x,e=a-e.y,Math.sqrt(i*i+e*e)},gC.mod=function(e,t){return 0===t?e:t===e?0:e-Math.floor(e/t)*t},gC.dotProduct2D=function(e,t){return e.x*t.x+e.y*t.y},gC.crossProduct2D=function(e,t){return e.x*t.y-e.y*t.x},gC.normalizeVector2D=function(e){var t=gC.getMagnitudeOfVector2D(e),n=e.x,e=e.y;return 0!==t&&(n/=t,e/=t),new h(n,e)},gC.projectOntoAxis=function(e,t){for(var n,i=Number.MAX_VALUE,a=-i,r=0,o=t.length;r<o;r++)(n=gC.dotProduct2D(e,t[r]))<i&&(i=n),a<n&&(a=n);return{min:i,max:a}},gC.wrap=function(e,t,n){if(n<=t)throw new Error("invalid argument exception");for(var i=n-t;e<t;)e+=i;for(;n<e;)e-=i;return e},gC.calculateStyleScaleForLod=function(e){return(e-1)/(gC.MAX_ZOOM_LEVEL-1)},gC.calculateZoomforStyleScale=function(e){return e*(gC.MAX_ZOOM_LEVEL-1)+1},gC.computeBoundingBox=function(e){var t;if(e&&0<e.length){for(var n=e[0].x,i=n,a=e[0].y,r=a,o=1;o<e.length;o++)(t=e[o].x)<n&&(n=t),i<t&&(i=t),(t=e[o].y)<a&&(a=t),r<t&&(r=t);return new gt(new h(n,a),new h(i,r))}return null},gC.getAngleBetween=function(e,t,n){return e&&t&&n&&!h.pointsEqual(e,t)&&!h.pointsEqual(e,n)?(t=gC.getAngleOfSegment2D(e,t),gC.getAngleOfSegment2D(e,n)-t):NaN},gC.getAngleDifference=function(e,t,n,i){var a=n||180,n=i||360,i=Math.abs(e-t);return i=a<i?Math.abs(Math.min(e,t)+n-Math.max(e,t)):i},gC.getAngleDifferenceInRadians=function(e,t){return gC.getAngleDifference(e,t,Math.PI,gC.twoPI)},gC.pointInCircle=function(e,t,n){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))<n},gC.matrixMultiply=function(e,t){var n,i;if(e&&t&&e[0].length===t.length){for(var a=e.length,r=t[0].length,o=new Array(a),s=t.length,l=0;l<a;l++)for(o[l]=new Array(r),n=0;n<r;n++)for(i=o[l][n]=0;i<s;i++)o[l][n]+=e[l][i]*t[i][n];return o}},gC.rotatingDirection=function(e,t,n){var i=e&&t&&n?0<(i=(n.y-e.y)*(t.x-e.x)-(t.y-e.y)*(n.x-e.x))?1:i<0?2:0:-1;return i},gC.polygonRotatingDirection=function(e){var t,n,i;if(!e||e.length<=2)return-1;for(n=e[e.length-1],i=t=0;i<e.length;i++)t+=(e[i].x-n.x)*(e[i].y+n.y),n=e[i];return 0===t?0:0<t?1:2},gC.intersect2D=function(e,t,n,i,a){var r,o,s,l,u,c;return e&&t&&n&&i?(r=t.y-e.y,l=e.x-t.x,o=i.y-n.y,0==(c=r*(u=n.x-i.x)-o*l)?null:(u=(u*(s=r*e.x+l*e.y)-l*(l=o*n.x+u*n.y))/c,c=(r*l-o*s)/c,!a||UC(u,e.x,t.x)&&UC(c,e.y,t.y)&&UC(u,n.x,i.x)&&UC(c,n.y,i.y)?new h(u,c):null)):null},gC.perpendicular2D=function(e){return new h(-e.y,e.x,e.z)},gC.intersectLineCircle=function(e,t,n,i,a){var r,o,s,l,u,c,d,p=[];if(e&&t&&n&&0<i){if(!a&&gC.pointInCircle(e,n,i)&&gC.pointInCircle(t,n,i))return p;(d=gC.trySolve(e.x,e.y,t.x,t.y))?(r=d[0],u=(o=d[1])-n.y,l=-2*n.x+2*u*r,c=n.x*n.x+u*u-i*i,0<(d=(d=[],c=(u=l)*u-4*(l=r*r+1)*(c=c),u=-u/(l*=2),0<c?(l=Math.sqrt(c)/l,d.push(u+l),d.push(u-l)):0==c&&d.push(u),d)).length&&(s=d[0]*r+o,(a||UC(d[0],e.x,t.x)&&UC(s,e.y,t.y))&&p.push(new h(d[0],s))),1<d.length&&(s=d[1]*r+o,(a||UC(d[1],e.x,t.x)&&UC(s,e.y,t.y))&&p.push(new h(d[1],s)))):p=function(e,t,n,i,a,r){var o=[],s=Math.abs(e-i.x),l=i.y;{var u;s<a?(u=Math.sqrt(a*a-s*s),i=l+u,u=l-u,(r||UC(i,t,n))&&o.push(new h(e,i)),(r||UC(u,t,n))&&o.push(new h(e,u))):s===a&&(r||UC(l,t,n))&&o.push(new h(e,l))}return o}(e.x,e.y,t.y,n,i,a)}return p},gC.deltaDecode=function(e){for(var t,n=0,i=e.length;0<i--;)t=e[i]+n,e[i]=t,n=e[i]};var k=(oG.greatCircleDistance=function(e,t){var n=c.degreesToRadians(t.latitude),i=c.degreesToRadians(e.latitude),a=c.degreesToRadians(t.longitude),t=c.degreesToRadians(e.longitude),e=Math.abs(n-i),t=Math.abs(a-t),e=Math.sin(e/2),t=Math.sin(t/2),t=2*Math.asin(Math.sqrt(e*e+Math.cos(i)*Math.cos(n)*t*t));return oG.earthRadiusMajorAxis*t},oG.getMapLocationFromLocationHeadingAndDistance=function(e,t,n){if(!e||null==t||null==n)throw new Error("location, headingInRadians and distanceInMeters must all be defined.");var i=n/oG.earthRadiusMajorAxis,a=c.degreesToRadians(e.latitude),n=c.degreesToRadians(e.longitude),e=Math.asin(Math.sin(a)*Math.cos(i)+Math.cos(a)*Math.sin(i)*Math.cos(t)),a=n+Math.atan2(Math.sin(t)*Math.sin(i)*Math.cos(a),Math.cos(i)-Math.sin(a)*Math.sin(e));return new o(c.radiansToDegrees(e),o.normalizeLongitude(c.radiansToDegrees(a)))},oG.isValidNumber=function(e){return"number"==typeof e&&isFinite(e)},oG.isValidAltitudeReference=function(e){return-1===e||0===e},oG.metersToDegrees=function(e){e=Math.PI/10800*(e/oG._metersPerMile);return c.radiansToDegrees(e)},oG.latitudeDegreesToMeters=function(e){return Math.sin(c.degreesToRadians(e))*this.earthRadiusMajorAxis},oG.longitudeDegreesToMeters=function(e){return c.degreesToRadians(e)*this.earthRadiusMajorAxis},oG.metersToLatitudeDegrees=function(e){return c.radiansToDegrees(Math.asin(e/this.earthRadiusMajorAxis))},oG.metersToLongitudeDegrees=function(e){return c.radiansToDegrees(e/this.earthRadiusMajorAxis)},oG.getAngleBetweenTwoLocations=function(e,t){return c.radiansToDegrees(c.normalizeRadian(Math.atan2(o.normalizeLongitude(t.longitude-e.longitude),t.latitude-e.latitude)))},oG.roundToInterval=function(e,t){return t&&(t=1/t,e=Math.round(e*t)/t),e},oG.getMetersPerDegreeOfLatitude=function(e){e=e*Math.PI/180;return 111132.92+-559.82*Math.cos(2*e)+1.175*Math.cos(4*e)+-.0023*Math.cos(6*e)},oG.getMetersPerDegreeOfLongitude=function(e){e=e*Math.PI/180;return 111412.84*Math.cos(e)+-93.5*Math.cos(3*e)+.118*Math.cos(5*e)},oG.earthRadiusMajorAxis=6378137,oG.earthRadiusMinorAxis=6356752.314245,oG.earthCircumference=2*Math.PI*oG.earthRadiusMajorAxis,oG.metersPerLongtitudeDegree=111319.4908,oG._metersPerMile=1852,oG),o=($G.prototype.clone=function(){return $G.cloneFrom(this)},$G.cloneFrom=function(e){return new $G(e.latitude,e.longitude,e.altitude,e.altitudeReference)},$G.prototype.toString=function(){return"[MapLocation ("+this.latitude+", "+this.longitude+")]"},$G.normalizeLongitude=function(e){return e<-180||180<e?e-360*Math.floor((e+180)/360):e},$G.areEqual=function(e,t,n,i){return i=i||0,e&&t&&Math.abs(e.latitude-t.latitude)<=i&&Math.abs(e.longitude-t.longitude)<=i&&(n||-1===e.altitudeReference&&-1===t.altitudeReference||e.altitudeReference===t.altitudeReference&&Math.abs(e.altitude-t.altitude)<=i)},$G.parseLatLong=function(e){var t,n;return e&&(2===(e=e.split(",")).length&&(t=parseFloat(e[0]),n=parseFloat(e[1]),isFinite(t)&&isFinite(n)))?new $G(t,n):null},$G),ir=(qH.prototype.getSize=function(){var e=this._elements[0];return new nt(e.offsetWidth,e.offsetHeight)},qH.prototype.getSizes=function(){var t=[];return this._elements.for_each(function(e){return t.push(new nt(e.offsetWidth,e.offsetHeight))}),t},qH.prototype.startMonitoring=function(e){var t=this;e&&(this._lastSizes=this.getSizes()),this._pollSizeHandler||(this._pollSizeHandler=function(){return t.pollSize()},i.useResizeObserver&&"undefined"!=typeof ResizeObserver?(this._resizeObserver=new ResizeObserver(this._pollSizeHandler),this._elements.for_each(function(e){t._resizeObserver.observe(e)})):(!this._intervalId&&0<this._interval&&(this._intervalId=Microsoft.Maps.setInterval(this._pollSizeHandler,this._interval)),this._window.add_event("resize",this._pollSizeHandler)))},qH.prototype.stopMonitoring=function(){this._pollSizeHandler&&(this._window.remove_event("resize",this._pollSizeHandler),this._pollSizeHandler=null),this._resizeObserver&&this._resizeObserver.disconnect(),this._intervalId&&(window.clearInterval(this._intervalId),this._intervalId=null)},qH.prototype.dispose=function(){this.stopMonitoring(),this._elements&&this._elements.clear(),this._window&&this._window.clear()},qH.prototype.pollSize=function(){var e,t,n=this._lastSizes,i=this.getSizes(),a=!1;if(n&&n.length==i.length){for(e=0,t=n.length;e<t;e++)if(n[e].width!==i[e].width&&0<i[e].width||n[e].height!==i[e].height&&0<i[e].height){a=!0;break}}else a=!0;a&&(this._lastSizes=i,this.resize.invoke(i))},qH),si=(EH.prototype.getObjectAsync=function(e){var t=this;this._isObjectLoaded?e(this._object):this._workCallbacks?this._workCallbacks.push(e):(this._workCallbacks=[e],this._activator(function(e){return t._onObjectLoaded(e)}))},EH.prototype._onObjectLoaded=function(e){this._object=e;for(var t=0;t<this._workCallbacks.length;t++)this._workCallbacks[t](e);this._activator=null,this._workCallbacks=null,this._isObjectLoaded=!0},EH),uu=(LH.prototype.logObject=function(e,t,n){this._logger.logObject(e,t,n)},LH.prototype.flush=function(){this._logger.flush()},LH.prototype.clear=function(){this._logger.clear()},LH),fu=(PH.prototype.interpolate=function(e,t,n){var i=this._lerp(e.cameraLocation.latitude,t.cameraLocation.latitude,n),a=this._lerp(e.cameraLocation.longitude,t.cameraLocation.longitude,n),s=this._lerp(e.cameraLocation.altitude,t.cameraLocation.altitude,n),l=e.heading,e=t.heading;return 180<Math.abs(e-l)&&(e<l?e+=360:l+=360),r.log(null,"Interpolate to latitude: {0}, longitude: {1}",i.toString(),a.toString()),n=this._lerp(l,e,n),new y(new o(i,a,s,t.cameraLocation.altitudeReference),n)},PH.prototype._lerp=function(e,t,n){return(t-e)*n+e},PH.defaultAnimation=new PH(300),PH),eu=(bI.prototype.hasUserLayers=function(){return 1<=this._userLayers.length},bI.prototype.isBaseLayer=function(e){return this._baseLayers&&-1!==this._baseLayers.indexOf(e)},bI.prototype.setBaseLayers=function(e){var t=this;this._baseLayersChangeHandler&&this._baseLayersChangeHandler.dispose(),this._baseLayers=e,this._onLayersChanged({reset:!0}),this._baseLayersChangeHandler=this._baseLayers&&this._baseLayers.changed.add(function(e){return t._onLayersChanged(e,!1)})},bI.prototype.dispose=function(){this._baseLayersChangeHandler&&this._baseLayersChangeHandler.dispose(),this._userLayerZIndexChangedEventHandlers&&this._userLayersChangeHandler.dispose(),f._clearDisposables(this._userLayerZIndexChangedEventHandlers),f._disposeEvents(this),f._nullifyClass(this)},bI.prototype._onLayersChanged=function(e,t){var n,i,a,o,s,l=this,u=t&&this._baseLayers?this._baseLayers.length:0;if(e.reset){if(Array.prototype.splice.call(this,0,this.length),this._baseLayers)for(i=0,a=this._baseLayers.length;i<a;i++)Array.prototype.push.call(this,this._baseLayers[i]);for(i=0,a=this._userLayers.length;i<a;i++)Array.prototype.push.call(this,this._userLayers[i]);this._invokeChanged(0,null,0,null,!0)}else{if(e.removed){if(t)for(i=0,a=e.removed.length;i<a;i++)n=e.removed[i],(o=this._userLayerZIndexChangedEventHandlers[n.getId()])&&(o.dispose(),o=null,delete this._userLayerZIndexChangedEventHandlers[n.getId()]);Array.prototype.splice.call(this,u+e.removedIndex,e.removed.length),this._invokeChanged(0,null,u+e.removedIndex,e.removed)}if(e.added){if(t)for(i=0,a=e.added.length;i<a;i++)(n=e.added[i]).changed&&(this._userLayerZIndexChangedEventHandlers[n.getId()]=n.changed.add(function(e){l._onUserLayerChanged(e)}));(s=[u+e.addedIndex,0]).push.apply(s,e.added),Array.prototype.splice.apply(this,s),this._invokeChanged(u+e.addedIndex,e.added)}}t&&r.logLayersChanged(e)},bI.prototype._onUserLayerChanged=function(e){var t=e.name;"zIndex"!==t&&"opacity"!==t&&"visible"!==t&&"iconOnlyLimit"!==t&&"highlighted"!==t||(this.revision++,this.layerChanged.invoke(e.sender))},bI.prototype._invokeChanged=function(e,t,n,i,a){this.revision++,this.changed.invoke({addedIndex:e,added:t,removedIndex:n,removed:i,reset:!0===a})},bI),ou=function(e,t){this.view=e,this.cancel=!1,this.cause=t},rr=(DI.prototype.addSet=function(e){this._sets.push(e)},DI.prototype.getSets=function(){return this._sets},DI.prototype.getPrimitives=function(){var e,t;if(!this._allPrimitives)for(this._allPrimitives=[],e=0;e<this._sets.length;e++)t=this._sets[e].getPrimitives(),this._allPrimitives=Array.prototype.concat.apply(this._allPrimitives,t);return this._allPrimitives},DI.prototype.dispose=function(){this._sets=[],this._allPrimitives=[]},DI),ur=(HI.prototype.getUnclippedPrimitiveSet=function(){return this._unclippedPrimitiveSet},HI.prototype.getPrimitives=function(e,t){var n;if(1===e)return t?(this._exactlyScreenSpaceClippedPrimitives||(n=this._unclippedPrimitiveSet.getPrimitives(),this._exactlyScreenSpaceClippedPrimitives=!f._getCoreConfig().oneClip&&this.frame.viewport?ni.clip(this._getScreenSpacePrimitives(n),this.frame.viewport,1):n),this._exactlyScreenSpaceClippedPrimitives):(this._exactlyWorldSpaceClippedPrimitives||(n=this._unclippedPrimitiveSet.getPrimitives(),this._exactlyWorldSpaceClippedPrimitives=this.frame.viewport?ni.clip(this._getWorldSpacePrimitives(n),this.frame.viewport,1):n),this._exactlyWorldSpaceClippedPrimitives);if(2===e)return this._unclippedPrimitiveSet.getPrimitives();throw new Error("Unsupported clippingMode")},HI.prototype.dispose=function(){this.frame=null,this.layer=null,this._unclippedPrimitiveSet&&this._unclippedPrimitiveSet.dispose(),this._exactlyScreenSpaceClippedPrimitives=[],this._exactlyWorldSpaceClippedPrimitives=[]},HI.prototype._getScreenSpacePrimitives=function(e){var t,n,i,a,r=[],o=this.layer.getRenderTarget();if(1===o)return e;if(2===o)for(t=0;t<e.length;t++)1===(n=e[t]).geometryType||0===n.geometryType?r.push(n):n.entity&&(a=(i=Microsoft.Maps.Internal._EntityHelper)&&i.getDisplayName(n.entity),i&&!a||r.push(n));return r},HI.prototype._getWorldSpacePrimitives=function(e){var t,n,i,a=this.layer.getRenderTarget();if(1===a)return[];for(t=[],n=0;n<e.length;n++)i=e[n],0!==a&&1===i.geometryType||t.push(i);return t},HI),ni;(ni||(ni={})).clip=function(e,t,n){if(e&&0<e.length)switch(n){case 1:e=function(e,t){for(var n,i,a,r,o=[],s={},l=b.fromRegionId(t).splitByInternationalDateLine(),c=[],h=[],d=[],p=[],m=0;m<l.length;m++)c.push(l[m].getNorth()),h.push(l[m].getSouth()),d.push(l[m].getEast()),p.push(l[m].getWest());for(m=0;m<e.length;++m)if(n=e[m],u.Pushpin&&n instanceof u.Pushpin&&n.hasVectorIcon())o.push(n);else if(i=n.crs,w=n.geometry,i&&w){if(!(a=s[i.id])){for(a=[],r=0;r<l.length;r++){var g=i.projectToY(c[r],p[r]),f=i.projectToY(h[r],d[r]),_=i.projectToX(c[r],p[r]),y=i.projectToX(h[r],d[r]);a.push(gt.fromSides(_,y,g,f))}s[i.id]=a}if(C=void 0,M=w.bounds,(C=M[1]===M[3]?w.boundingBox&&w.boundingBox.originalBounds||M:M)&&3<C.length){var v=C[0],w=C[1],M=C[2],C=C[3],S=gt.fromSides(C,w,v,M),L=!1;for(r=0;r<l.length;r++)if(S.intersects(a[r])){L=!0;break}L&&o.push(n)}}return o}(e,t);break;case 2:break;default:r.assert(!1,"Invalid ClippingMode")}return e};var su=(HJ.prototype.getId=function(){return this._id},HJ.prototype.getPrimitives=function(){return this._primitives},HJ.prototype.getRevisions=function(){return this._revisions},HJ),hu=(MJ.prototype.getLayer=function(){return this._layer},MJ.prototype.getFrame=function(){return this._frame},MJ.prototype.hasCompleted=function(){return 3===this._state},MJ.prototype.hasFailed=function(){return 5===this._state},MJ.prototype.getCompositeSet=function(){if(3!==this._state)throw new Error("The 'getCompositeSet' may not be called until the 'completed' event is raised.");return this._compositeSet},MJ.prototype.beginLoad=function(){var e,t=this;if(1!==this._state)throw new Error("The 'beginLoad' method has already been called on this object.");this._state=2,(e=this._layer.getDataSource())?this._loadOnDataSourceAvailability(e):this._layerChangeHandler=this._layer.changed.add(function(e){"dataSource"===e.name&&(t._layerChangeHandler.dispose(),t._loadOnDataSourceAvailability(e.newValue))})},MJ.prototype.cancelLoad=function(){this._state=4,this._cancelOutstandingRequests(),this.cancelled.invoke()},MJ.prototype.dispose=function(){this._layer=null,this._frame=null,this._requestRegionIds=[],this._layerChangeHandler&&this._layerChangeHandler.dispose(),this._compositeSet.dispose(),this.completed.dispose(),this.cancelled.dispose(),this.failed.dispose()},MJ.prototype._loadOnDataSourceAvailability=function(e){var t,n,i,a,r;if(4!==this._state)for(a=this._frame.viewport,t=b.fromRegionId(a),e.spatialIndex?(n=a.crs).getScale?(i=n.getScale(a),this._requestRegionIds=e.spatialIndex.getRegionsInBounds(t,i)):(a=Math.max(MJ._minGroundResolution,n.getGroundResolution(a)),this._requestRegionIds=e.spatialIndex.getRegions(t,a)):this._requestRegionIds=[t],this._pendingSetCount=this._requestRegionIds.length,r=0;r<this._requestRegionIds.length;r++)this._requestPrimitives(this._requestRegionIds[r],e)},MJ.prototype._requestPrimitives=function(t,e){var n,i=this;r.assertNotNull(this.getFrame().view,"view"),n=l.fromLocation(this.getFrame().view.cameraLocation,!0);try{e.getPrimitives(t,function(e){return i._onDataSourceResponse(t,e)},MJ._dataSourceRequestorId,n)}catch(e){(n=u.logger)&&n.logCriticalError(e,null,!0,!0),this._onDataSourceResponse(t,{primitives:[],requestFailed:!1})}},MJ.prototype._getSetId=function(e){var t=this._layer.getDataSource(),n=t.getDataUniquenessKey;return n?this._layer.getId()+"_"+n.call(t,e):this._layer.getId()+"_DV"+this._layer.dataVersion},MJ.prototype._cancelOutstandingRequests=function(){var e,t,n=this._layer.getDataSource(),i=this._requestRegionIds;if(i&&n&&n.cancelPrimitivesRequest)for(e=0;e<i.length;e++)t=i[e],n.cancelPrimitivesRequest(t,MJ._dataSourceRequestorId)},MJ.prototype._onDataSourceResponse=function(e,t){var n,i,a,r;if(2===this._state){if(t){if(e=this._getSetId(e),n=t.primitives||[],this._isBaseLayer)for(i=0,a=n.length;i<a;i++)(r=n[i]).entity,r.layer=this._layer;e=new su(e,n,!this._layer.getDataSource().getDataUniquenessKey),this._compositeSet.addSet(e),!t.requestFailed||t.requestAborted||!this._abortOnFirstDataFailure&&this._isBaseLayer||(this._cancelOutstandingRequests(),this._state=5,this.failed.invoke())}this._pendingSetCount--,0===this._pendingSetCount&&(this._state=3,this.completed.invoke())}},MJ._dataSourceRequestorId="FrameManager",MJ._minGroundResolution=.01,MJ),fr=(vK.prototype.setFrame=function(e){var t=this;this._map.getMode()&&(this._lastViewChangeFrameNumber!==e.lastViewChangeFrameNumber||this._cachedDataVersion!==this._layer.dataVersion?(this._lastViewChangeFrameNumber=e.lastViewChangeFrameNumber,this._layer.dataVersion++,!this._currentDataLoader||this._currentDataLoader.hasCompleted()||this._currentDataLoader.hasFailed()||this._currentDataLoader.cancelLoad(),this._currentFrame=e,this._currentDataLoaderCompletedHandler&&this._currentDataLoaderCompletedHandler.dispose(),this._currentDataLoaderFailedHandler&&this._currentDataLoaderFailedHandler.dispose(),this._currentDataLoader&&this._currentDataLoader.dispose(),this._currentDataLoader=new hu(this._layer,this._isBaseLayer,e),this._currentDataLoaderCompletedHandler=this._currentDataLoader.completed.addOne(function(){return t._onDataLoaderCompleted()}),this._currentDataLoaderFailedHandler=this._currentDataLoader.failed.addOne(function(){return t._onDataLoaderFailed()}),this._currentDataLoader.beginLoad()):(this._latestLayerFrameData.frame=e,this.dataLoaded.invoke({frame:e})))},vK.prototype.getLatestFrameData=function(){return this._latestLayerFrameData},vK.prototype._getFrameZeroData=function(){return new ur(ti.frameZero,this._layer,new rr)},vK.prototype.dispose=function(){f._clearDisposables(this._disposables),!this._currentDataLoader||this._currentDataLoader.hasCompleted()||this._currentDataLoader.hasFailed()||this._currentDataLoader.cancelLoad(),this._currentDataLoaderCompletedHandler&&this._currentDataLoaderCompletedHandler.dispose(),this._currentDataLoaderFailedHandler&&this._currentDataLoaderFailedHandler.dispose(),this._currentDataLoader&&this._currentDataLoader.dispose(),this._latestLayerFrameData&&this._latestLayerFrameData.dispose()},vK.prototype._onDataLoaderCompleted=function(){var e=this._currentDataLoader.getFrame().frameNumber,t=this._currentDataLoader.getCompositeSet();this._cachedDataVersion=this._layer.dataVersion,e===this._currentFrame.frameNumber&&t&&(this._latestLayerFrameData=new ur(this._currentFrame,this._layer,t),t={frame:this._latestLayerFrameData.frame},this.dataLoaded.invoke(t))},vK.prototype._onDataLoaderFailed=function(){this._currentDataLoader.getFrame().frameNumber;var e={frame:this._currentDataLoader.getFrame(),layer:this._layer,reason:2,errorMessage:"Failed to get primitives for layer '"+this._layer.getId()+"'"};this.dataLoadFailed.invoke(e)},vK.prototype._onLayerInvalidated=function(e){var t=this;this._layer.dataVersion++,Microsoft.Maps.setTimeout(function(){t._isViewChanging||t.layerInvalidated.invoke(e)},0)},vK.prototype._cancelPendingRequests=function(){!this._currentDataLoader||this._currentDataLoader.hasCompleted()||this._currentDataLoader.hasFailed()||this._currentDataLoader.cancelLoad()},vK),er=(PK.prototype.getMap=function(){return this._map},PK.prototype.getLayer=function(){return this._layer},PK.prototype.getFrame=function(){return{frameNumber:this._frame.frameNumber,purpose:this._frame.purpose,view:this._frame.view,viewport:this._frame.viewport,lastViewChangeFrameNumber:this._frame.lastViewChangeFrameNumber,cause:this._frame.cause,causeEntityIds:this._frame.causeEntityIds,causeLayerIds:this._frame.causeLayerIds}},PK.prototype.isCurrent=function(e){return e.frameNumber===this._frame.frameNumber},PK.prototype.getFrameData=function(){return this._dataMonitor instanceof fr?this._dataMonitor.getLatestFrameData():null},PK.prototype.setFrame=function(e){this._frame=e,this._loadingDataState=1,this._renderingPrimitivesState=1,this._renderingLabelsState=1,this._isFrameComplete=!1,this._hasFrameFailed=!1,this._dataMonitor.setFrame(e,this._map)},PK.prototype.completeDataLoadingPhase=function(e){this.isCurrent(e)&&(r.assert(1===this._loadingDataState,"loadingDataState("+this._loadingDataState+"): Should be in 'awaiting' state."),this._loadingDataState=2,this._invokePendingEvents())},PK.prototype.completePrimitiveRenderingPhase=function(e){this.isCurrent(e)&&(1===this._renderingPrimitivesState&&(this._renderingPrimitivesState=2),this._invokePendingEvents())},PK.prototype.completeLabelRenderingPhase=function(e){this.isCurrent(e)&&1===this._renderingLabelsState&&(this._renderingLabelsState=2,this._invokePendingEvents())},PK.prototype.failFrame=function(e,t,n){this.isCurrent(e)&&(this.frameFailed.invoke({frame:this.getFrame(),layer:this._layer,reason:t,errorMessage:n}),this._hasFrameFailed=!0)},PK.prototype.dispose=function(){this._modeFrameRenderedHandler&&this._modeFrameRenderedHandler.dispose(),this._modeFrameFailedHandler&&this._modeFrameFailedHandler.dispose();for(var e=0;e<this._disposables.length;e++)this._disposables[e].dispose()},PK.prototype._invokePendingEvents=function(){this._hasFrameFailed||(2===this._loadingDataState?(this.dataLoaded.invoke({frame:this._frame,layer:this._layer}),this._loadingDataState=3,this._invokePendingEvents()):3===this._loadingDataState&&2===this._renderingPrimitivesState?(this._renderingPrimitivesState=3,this.primitivesRendered.invoke({frame:this._frame,layer:this._layer}),this._invokePendingEvents()):3===this._loadingDataState&&2===this._renderingLabelsState&&(this.labelsRendered.invoke({frame:this._frame,layer:this._layer}),this._renderingLabelsState=3,this._invokePendingEvents()),3!==this._loadingDataState||3!==this._renderingPrimitivesState||3!==this._renderingLabelsState||this._isFrameComplete||(this.frameRendered.invoke({frame:this._frame,layer:this._layer}),this._isFrameComplete=!0))},PK.prototype._onMapChanged=function(e){var t=this;"mode"===e.name&&(this._modeFrameRenderedHandler&&this._modeFrameRenderedHandler.dispose(),this._modeFrameFailedHandler&&this._modeFrameFailedHandler.dispose(),e=e.newValue,this._modeFrameRenderedHandler=e.onFrameRendered.add(function(e){return t._onModeFrameRendered(e)}),this._modeFrameFailedHandler=e.onFrameFailed&&e.onFrameFailed.add(function(e){return t._onModeFrameFailed(e)}))},PK.prototype._onModeFrameRendered=function(e){this.completePrimitiveRenderingPhase(e.frame)},PK.prototype._onModeFrameFailed=function(e){this.failFrame(e.frame,e.reason,e.errorMessage)},PK.prototype._onDataMonitorDataLoaded=function(e){this.completeDataLoadingPhase(e.frame)},PK.prototype._onDataMonitorDataLoadFailed=function(e){this.failFrame(e.frame,e.reason,e.errorMessage)},PK.prototype._onDataMonitorLayerInvalidated=function(e){this.layerInvalidated.invoke(e)},PK.prototype._setPrimitiveViewState=function(e,t){var n=e.entity;e.viewState=t,n&&n.changed&&n.changed.invoke()},PK.prototype._onPrimitiveHoverStarted=function(e){e=e.primitive;e&&2!==e.viewState&&3!==e.viewState&&this._setPrimitiveViewState(e,1)},PK.prototype._onPrimitiveHoverStopped=function(e){e=e.primitive;e&&1===e.viewState&&this._setPrimitiveViewState(e,0)},PK.prototype._onPrimitiveTapped=function(e){var t=e.primitive,n=t&&t.entity,i=u.GlobalDataEventHandler,a=u.DataHandlerKeys,t=u.TaskTypes;i&&n&&n.id&&(e=(e=e&&e.location)?[e.latitude,e.longitude]:null,i.invokeHandler(a.taskDataHandlerKey,{type:t.polygonEntityDetailsTask,state:{entryPoint:"BasemapPrimitive",id:"vdpid:"+n.id,taskTitle:n.name,point:e}}))},PK),hi=(LL.prototype.getGoal=function(){return this._goal},LL.prototype.setGoal=function(e){this._goal=e},LL.prototype.getCount=function(){return this._count},LL.prototype.resetCount=function(){this._count=0},LL.prototype.incrementCount=function(){this._count++},LL.prototype.hasReachedGoal=function(){return this._count>=this._goal},LL),cu=(NL.prototype.setLayerCount=function(e){this._dataLoadedGoalCounter.setGoal(e),this._primitivesRenderedGoalCounter.setGoal(e),this._labelsRenderedGoalCounter.setGoal(e)},NL.prototype.resetEventCounts=function(){this._dataLoadedGoalCounter.resetCount(),this._primitivesRenderedGoalCounter.resetCount(),this._labelsRenderedGoalCounter.resetCount()},NL.prototype.incrementDataLoadedCount=function(){this._dataLoadedGoalCounter.incrementCount()},NL.prototype.incrementPrimitivesRenderedCount=function(){this._primitivesRenderedGoalCounter.incrementCount()},NL.prototype.incrementLabelsRenderedCount=function(){this._labelsRenderedGoalCounter.incrementCount()},NL.prototype.haveAllLayersLoadedData=function(){return this._dataLoadedGoalCounter.hasReachedGoal()},NL.prototype.haveAllLayersRenderedPrimitives=function(){return this._primitivesRenderedGoalCounter.hasReachedGoal()},NL.prototype.haveAllLayersRenderedLabels=function(){return this._labelsRenderedGoalCounter.hasReachedGoal()},NL.prototype.haveAllLayersCompleted=function(){return this.haveAllLayersLoadedData()&&this.haveAllLayersRenderedPrimitives()&&this.haveAllLayersRenderedLabels()},NL),or=(PL.prototype.getLayerFrameData=function(){return this._layerData},PL.prototype.getLayerFrameDataByLayer=function(e){for(var t=0;t<this._layerData.length;t++)if(this._layerData[t].layer===e)return this._layerData[t];return null},PL.prototype.getPrimitives=function(e,t){return t?(this._allScreenSpacePrimitives||(this._allScreenSpacePrimitives=this._getFilteredPrimitives(e,t)),this._allScreenSpacePrimitives):(this._allWorldSpacePrimitives||(this._allWorldSpacePrimitives=this._getFilteredPrimitives(e,t)),this._allWorldSpacePrimitives)},PL.prototype._getFilteredPrimitives=function(e,t){for(var n,i,a,r=[],o=this._layerData.length,s=0;s<o;s++){var l=this._layerData[s],u=l.getPrimitives(e,t),l=l.layer,c=this._layerFilters;if(c&&c.length&&l.canBeFiltered)for(n=0;n<c.length;n++)u=c[n].filterPrimitives(u);for(i=u.length,a=0;a<i;a++)r.push(u[a])}return r},PL),ti=(jM.prototype.disable=function(){this._disabled=!0,this.onDisabled.invoke()},jM.prototype.enable=function(){this._disabled&&(this._disabled=!1,this._setFrame(0))},jM.prototype.initializeLayers=function(){for(var e=0;e<this._allLayers.length;e++)this._addLayer(this._allLayers[e]);this._map.getMode()&&this._setFrame(0,null,null,2)},jM.prototype.getFrame=function(){return 0===this._currentFrameNumber?null:{frameNumber:this._currentFrameNumber,purpose:this._currentFramePurpose,view:this._currentFrameView,viewport:this._currentFrameViewport,lastViewChangeFrameNumber:this._lastViewChangeFrameNumber,cause:this._lastFrameChangeCause,causeEntityIds:this._lastFrameChangeEntityIds,causeLayerIds:this._lastFrameChangeLayerIds}},jM.prototype.getFrameData=function(){var e,t,n;if(0===this._currentFrameNumber)return null;if(!this._currentFrameData){for(e=[],t=0;t<this._layerFrameManagers.length;t++)(n=this._layerInfoDictionary[this._layerFrameManagers[t].getLayer().getId()])&&n.currentFrameData&&e.push(n.currentFrameData);this._currentFrameData=new or(this.getFrame(),e)}return this._currentFrameData},jM.prototype.isCurrent=function(e){return e.frameNumber===this._currentFrameNumber},jM.prototype.hasCurrentFrameCompletedDataLoadingPhase=function(){return this._frameEventAggregator.haveAllLayersLoadedData()},jM.prototype.hasCurrentFrameCompletedPrimitiveRenderingPhase=function(){return this._frameEventAggregator.haveAllLayersRenderedPrimitives()},jM.prototype.hasCurrentFrameCompletedLabelRenderingPhase=function(){return this._frameEventAggregator.haveAllLayersRenderedLabels()},jM.prototype.hasCurrentFrameRendered=function(){return this._frameEventAggregator.haveAllLayersCompleted()},jM.prototype.hasCurrentFrameFailed=function(){return!this._isCurrentFramePending()&&!this._frameEventAggregator.haveAllLayersCompleted()},jM.prototype.isMapReady=function(){return this._isMapReady},jM.prototype.completePrimitiveRenderingPhase=function(e){if(this.isCurrent(e))for(var t=0;t<this._layerFrameManagers.length;t++)this._layerFrameManagers[t].completePrimitiveRenderingPhase(e)},jM.prototype.completeLabelRenderingPhase=function(e){if(this.isCurrent(e))for(var t=0;t<this._layerFrameManagers.length;t++)this._layerFrameManagers[t].completeLabelRenderingPhase(e)},jM.prototype.dispose=function(){var e,t,n;for(this._stopTimeoutTimer(),f._clearDisposables(this._disposables),e=0,t=this._layerFrameManagersDisposables.length;e<t;e++)n=this._layerFrameManagersDisposables[e],f._clearDisposables(n);f._clearDisposables(this._layerFrameManagers),this._map=null,this._layerInfoDictionary=null,this._currentFrameViewport=null,this._frameEventAggregator=null,this._currentFrameView=null,this._lastUpdatedView=null,this._lastUpdatedViewport=null},jM.prototype.hackHackSetFrame=function(e){this._setFrame(99,null,null,null,e)},jM.prototype._setFrame=function(e,t,n,i,a){var r,o,s;if(!this._disabled&&this._map&&!this._map.isDisposed()&&this._map.getMode()&&0!==this._map.getActualSize().width&&0!==this._map.getActualSize().height){for(ei.setStartTime("FrameSet"),r=this.getFrame(),this._isCurrentFramePending()&&this._failFrame(r,1,null),this._lastFrameChangeCause=e,this._lastFrameChangeEntityIds=n,this._lastFrameChangeLayerIds=t,this._currentFrameNumber++,this._currentFramePurpose=i||this._currentFramePurpose,this._currentFrameView=this._map.getView(),this._currentFrameViewport=this._map.getViewport(),y.areEqual(this._currentFrameView,this._lastUpdatedView)?this._currentFrameViewport.areEqual(this._lastUpdatedViewport)?a&&(this._lastViewChangeFrameNumber=this._currentFrameNumber):(this._lastUpdatedViewport=this._currentFrameViewport,this._lastViewChangeFrameNumber=this._currentFrameNumber):(this._lastUpdatedView=this._currentFrameView,this._lastViewChangeFrameNumber=this._currentFrameNumber),this._currentFrameData=null,this._dataPendingLayersId={},this._frameEventAggregator.resetEventCounts(),this._startTimeoutTimer(),r=this.getFrame(),s=0;s<this._layerFrameManagers.length;s++)o=this._layerFrameManagers[s].getLayer(),this._dataPendingLayersId[o.getId()]=!0,!o.isBaseLayer||o instanceof ht||this._layerFrameManagers[s].setFrame(r);for(s=0;s<this._layerFrameManagers.length;s++)(o=this._layerFrameManagers[s].getLayer()).isBaseLayer&&o instanceof ht&&this._layerFrameManagers[s].setFrame(r);for(s=0;s<this._layerFrameManagers.length;s++)this._layerFrameManagers[s].getLayer().isBaseLayer||this._layerFrameManagers[s].setFrame(r);this.frameSet.invoke({frame:r}),this._map.frameManagerLoaded.invoke(this),0===this._layerFrameManagers.length&&(this.dataLoaded.invoke({frame:r}),this.primitivesRendered.invoke({frame:r}),this.labelsRendered.invoke({frame:r}),this._checkIfFrameIsFullyRendered())}},jM.prototype._failFrame=function(e,t,n){this.isCurrent(e)&&(this._stopTimeoutTimer(),this.frameFailed.invoke({frame:e,reason:t,errorMessage:n}),this._isMapReady||1!==t&&(this._isMapReady=!0,this.mapReady.invoke()),5===t&&this._setFrame(8))},jM.prototype._addLayer=function(e){var t=this,n=new er(this._map,e,this._allLayers.isBaseLayer(e));e.setFrameManager(n),this._layerFrameManagers.push(n),this._layerInfoDictionary[e.getId()]={layer:e,currentFrameData:null,previousFrameData:null,previousTargetFrameData:null},this._frameEventAggregator.setLayerCount(this._layerFrameManagers.length),(e=[]).push(n.dataLoaded.add(function(e){return t._onLayerDataLoaded(e)})),e.push(n.primitivesRendered.add(function(e){return t._onLayerPrimitivesRendered(e)})),e.push(n.labelsRendered.add(function(e){return t._onLayerLabelsRendered(e)})),e.push(n.frameFailed.add(function(e){return t._onLayerFailed(e)})),e.push(n.layerInvalidated.add(function(e){return t._onLayerInvalidated(e)})),this._layerFrameManagersDisposables.push(e)},jM.prototype._removeLayer=function(e){var t,n,i=e.getFrameManager();if(i)for(i.dispose(),i=this._layerFrameManagers.indexOf(i),this._layerFrameManagers.splice(i,1),this._frameEventAggregator.setLayerCount(this._layerFrameManagers.length),t=this._layerFrameManagersDisposables[i],this._layerFrameManagersDisposables.splice(i,1),n=0;n<t.length;n++)t[n].dispose();delete this._layerInfoDictionary[e.getId()]},jM.prototype._checkIfFrameIsFullyRendered=function(){this._frameEventAggregator.haveAllLayersCompleted()&&(this._stopTimeoutTimer(),this.frameRendered.invoke({frame:this.getFrame()}),"undefined"!=typeof sj_evt&&sj_evt.fire("frameRendered"),this._isMapReady||(this._isMapReady=!0,this.mapReady.invoke()))},jM.prototype._updateMapFrameData=function(){for(var e,t,n=Object.keys(this._layerInfoDictionary),i=0,a=n.length;i<a;i++)t=(e=this._layerInfoDictionary[n[i]]).layer.getFrameManager(),e.previousFrameData=e.currentFrameData,e.currentFrameData&&2===e.currentFrameData.frame.purpose&&(e.previousTargetFrameData=e.currentFrameData),e.currentFrameData=t.getFrameData();this._currentFrameData=null},jM.prototype._startTimeoutTimer=function(){var e=this;this._intervalId&&window.clearInterval(this._intervalId),this._intervalId=Microsoft.Maps.setInterval(function(){e._onFrameTimedOut()},jM._timeoutDuration)},jM.prototype._stopTimeoutTimer=function(){this._intervalId&&window.clearInterval(this._intervalId),this._intervalId=0},jM.prototype._isCurrentFramePending=function(){return!!this._intervalId},jM.prototype._onMapChanged=function(e){var t=this,n=null;"actualSize"===e.name?n=3:"mode"===e.name&&(n=5),null!==n&&Microsoft.Maps.setTimeout(function(){return t._setFrame(n)},0)},jM.prototype._onMapLayersCollectionChanged=function(e){var t,n,i=[];if(e.reset){for(n=this._layerFrameManagers.length;n--;)t=this._layerFrameManagers[n].getLayer(),i.push(t.getId()),this._removeLayer(t);for(n=0;n<this._allLayers.length;n++)t=this._allLayers[n],i.push(t.getId()),this._addLayer(t)}if(e.added)for(n=0;n<e.added.length;n++)t=e.added[n],i.push(t.getId()),this._addLayer(t);if(e.removed)for(n=0;n<e.removed.length;n++)t=e.removed[n],i.push(t.getId()),this._removeLayer(t);this._setFrame(4,i)},jM.prototype._onMapViewChanged=function(){this._setFrame(6,null,null,2)},jM.prototype._onMapPanStopped=function(){this._setFrame(1,null,null,2)},jM.prototype._onMapZoomStopped=function(){this._setFrame(1,null,null,2)},jM.prototype._onLayerDataLoaded=function(e){this.layerDataLoaded.invoke(e),e.layer&&delete this._dataPendingLayersId[e.layer.getId()],this.isCurrent(e.frame)&&(this._frameEventAggregator.incrementDataLoadedCount(),this._frameEventAggregator.haveAllLayersLoadedData()&&(this._updateMapFrameData(),this.dataLoaded.invoke({frame:e.frame})),this._checkIfFrameIsFullyRendered())},jM.prototype._onLayerPrimitivesRendered=function(e){this.layerPrimitivesRendered.invoke(e),this.isCurrent(e.frame)&&(this._frameEventAggregator.incrementPrimitivesRenderedCount(),this._frameEventAggregator.haveAllLayersRenderedPrimitives()&&this.primitivesRendered.invoke({frame:e.frame}),this._checkIfFrameIsFullyRendered())},jM.prototype._onLayerLabelsRendered=function(e){this.layerLabelsRendered.invoke(e),this.isCurrent(e.frame)&&(this._frameEventAggregator.incrementLabelsRenderedCount(),this._frameEventAggregator.haveAllLayersRenderedLabels()&&this.labelsRendered.invoke({frame:e.frame}),this._checkIfFrameIsFullyRendered())},jM.prototype._onLayerFailed=function(e){var t,n;this.layerFrameFailed.invoke(e),this._isCurrentFramePending()&&((t=u.logger)&&(n={feature:it.MapControl,action:w.Error,data:{}},e&&(n.data={layerId:e.layer?e.layer.getId():"",reason:e.reason,errorMessage:"Layer failed; "+e.errorMessage}),t.logCriticalError(null,n,!0)),this._failFrame(e.frame,e.reason,e.errorMessage),this._stopTimeoutTimer())},jM.prototype._onLayerInvalidated=function(e){var t,n;e&&(t=e.entityIds,n=[e.layerId]),this._setFrame(4,n,t)},jM.prototype._onFrameTimedOut=function(){var e,t,n,i;r.assert(this._isCurrentFramePending(),"A timeout cannot occur unless the current frame is pending."),this._stopTimeoutTimer(),e=this.getFrame(),(t=u.logger)&&(i="",0<(n=Object.keys(this._dataPendingLayersId)).length&&(i=" Layers failed to download data: "+n.join(",").replace(/\d+/gi,"***")),i={feature:it.MapControl,action:w.Error,data:{errorMessage:"Frame timed out."+i}},t.logCriticalError(null,i,!0)),this._failFrame(e,5,null)},jM.prototype._initGlobalProcessingEvents=function(){var e,t,n;"undefined"!=typeof sj_evt&&(e=!0,t=-1,n=function(){e||(-1!==t&&clearTimeout(t),e=!0,sj_evt.fire("MapsProcessingStarted"))},this._disposables.push(this.frameRendered.add(function(){t=Microsoft.Maps.setTimeout(function(){t=-1,e&&(e=!1,sj_evt.fire("MapsProcessingFinished"))},200)},!0)),this._disposables.push(this.frameSet.add(n,!0)),this._disposables.push(this._map.viewChanging.add(n,!0)))},jM.frameZero={frameNumber:0,purpose:2,view:null,viewport:null,lastViewChangeFrameNumber:0,cause:0},jM._timeoutDuration=2e4,jM),lu=(JN.prototype.end=function(e){this._logged||(this._perfManager.end(this,e),this._logged=!0)},JN.prototype.timestamp=function(){return this._timestamp},JN.prototype.key=function(){return this._key},JN),w=(ON.Activated="A",ON.CenterPoint="CP",ON.Deactivated="D",ON.Clicked="C",ON.Reactivated="RE",ON.Removed="R",ON.Focused="F",ON.Hovered="H",ON.Collapsed="CL",ON.ClientInstNamespace="CI",ON.Submitted="S",ON.Selected="SE",ON.EntryPoint="EP",ON.Expanded="EX",ON.Impression="I",ON.Error="ERR",ON.Warning="WRN",ON.Perf="PRF",ON),au=(PN.ContextMenu="ContextMenu",PN.LocalSearch="LocalSearch",PN.LocalListing="LocalListing",PN.LocalListingAlongRoute="LocalListingAlongRoute",PN.LocalDetails="LocalDetails",PN.Collections="Collections",PN.MyPlacesNew="MyPlacesNew",PN.POI="POI",PN.POIAlongRoute="POIAlongRoute",PN.Landmarks="Landmarks",PN.SearchBox="SearchBox",PN.SearchButton="SearchButton",PN.TaskBar="TaskBar",PN.CategoriesBar="CategoriesBar",PN.Autosuggest="Autosuggest",PN.Feedback="Feedback",PN.DirectionsWaypointSearch="DirectionsWaypointSearch",PN.DirectionsRouteList="DirectionsRouteList",PN.TaskCard="TaskCard",PN.TransitStop="TransitStop",PN.TransitLine="TransitLine",PN.NearbyParking="NearbyParking",PN.Geochain="Geochain",PN.Permalink="Permalink",PN.FallbackRequery="FallbackRequery",PN.ItineraryListings="ItineraryListings",PN.ItineraryDetails="ItineraryDetails",PN.ItineraryPOI="ItineraryPOI",PN.TravelL2="TravelL2",PN.VenueMap="VenueMap",PN.SerpAnswer="SerpAnswer",PN.ServerPagination="ServerPagination",PN.Infobox="Infobox",PN.MapsTour="MapsTour",PN.QuerySwitch="QuerySwitch",PN.MobileListMap="MobileListMap",PN.LayerManager="LayerManager",PN.Nearby="Nearby",PN),it=(QN.ContextMenu="CM",QN.TaskManager="TM",QN.TaskBar="TB",QN.CategoriesBar="CB",QN.FiltersBar="FSB",QN.MapControl="MC",QN.POI="POI",QN.LayerPOI="LMPOI",QN.DetailsCard="DC",QN.ListingCard="LC",QN.Landmarks="L",QN.LandmarksDeal="LD",QN.CardModel="CD",QN.NearbyControl="NBC",QN.NearbySearch="NBS",QN.RecommendedSearch="RS",QN.ISDK="IS",QN.Network="NW",QN.BaseMapData="BD",QN.SearchBox="SB",QN.ShowMeCategoryLayers="SMC",QN.SDK="SDK",QN),vu=(RN.Autosuggest="AS",RN.Collections="CX",RN.Directions="DD",RN.Embed="EMB",RN.Print="PRT",RN.Share="SH",RN.Search="SR",RN.Streetside="SS",RN.Traffic="T",RN.LocateMe="LM",RN.Feedback="FB",RN.TaskManager="TM",RN.Tips="TP",RN.Fullscreen="FS",RN.Overlay="OV",RN.BirdseyeV2="B2",RN.VenueMap="VM",RN.Commutability="CMT",RN),yu=(SN=InstrumentationBase,p(TN,SN),TN.prototype.log=function(e,t){e&&t&&SN.prototype.logObject.call(this,TN.getPerfLogDataObject(e,t))},TN.prototype.start=function(e){return e?new lu(e,this._getTimestamp(),this):null},TN.prototype.end=function(e,t){var n;e&&(n=e.key(),t=t?n+TN.KeySeparator+t:n,n=e.timestamp&&e.timestamp(),this._getTimestamp()&&n&&this.logObject(TN.getPerfLogDataObject(t,this._getTimestamp().getTime()-e.timestamp().getTime())))},TN.prototype.checkpoint=function(e){e&&this.logObject(TN.getPerfLogDataObject(e,this._getTimestamp()))},TN.prototype._getTimestamp=function(){return new Date},TN.getPerfLogDataObject=function(e,t){return{T:"CI.ClientPerf",FID:w.ClientInstNamespace,key:e,value:t}},TN.KeySeparator=".",TN),y=(eO.prototype.clone=function(){var e=new eO(this.cameraLocation.clone(),this.heading);return e.pitch=this.pitch,e.verticalFov=this.verticalFov,e},eO.areEqual=function(e,t){return e===t||!(!e||!t)&&(!!eO.areNumbersEqual(e.heading,t.heading)&&(!!eO.areNumbersEqual(e.pitch,t.pitch)&&(!!eO.areNumbersEqual(e.verticalFov,t.verticalFov)&&!!o.areEqual(e.cameraLocation,t.cameraLocation))))},eO.areCameraAltitudesEqual=function(e,t){return e.cameraLocation.altitude===t.cameraLocation.altitude&&e.cameraLocation.altitudeReference===t.cameraLocation.altitudeReference},eO.areNumbersEqual=function(e,t){return e===t||null!=e&&null!=t&&Math.abs(e-t)<=1e-6},eO),sr=(oO.zoomIn="ZoomIn",oO.zoomOut="ZoomOut",oO),d=(pO.mapZoomActionName="MapZoom",pO.mapLayerAdded="MapLayerAdded",pO.mapLayerRemoved="MapLayerRemoved",pO.mapPanActionName="MapPan",pO.mapSetViewActionName="SetView",pO.mapTypeChangedActionName="MapTypeChanged",pO.mapControlSDKPageNameKey="sdk",pO.oneMapOverlayPageNameKey="omo",pO.mapControlMsftPageNameKey="msft",pO.osMapsFeatureKey="os",pO),pu=(qO.prototype._onMapFrameManagerLoaded=function(){var t=this,e=this._map.getFrameManager();this._disposables.push(e.frameSet.add(function(e){return t._onFrameManagerFrameSet(e)})),this._disposables.push(e.frameRendered.add(function(e){return t._onFrameRendered(e)}))},qO.prototype._onMapLabelControllerLoaded=function(){var t=this;this._disposables.push(this._map.getLabelController().instrumentLabelingPass.add(function(e){return t._onInstrumentLabelingPass(e)}))},qO.prototype.setMapMode=function(e){0!==e.mapModeType||(e=this._map.getMapType().id)===s.ordnanceSurvey&&this._logMapTypeChangedInst(e)},qO.prototype._onInstrumentLabelingPass=function(e){e.landmarksCount&&(e={feature:it.Landmarks,action:w.Activated,data:{CT:e.landmarksCount,DCT:e.landmarkDealsCount}},this._logger.logObject(e,null,!0))},qO.prototype._onFrameManagerFrameSet=function(){r.log(null,"Frame set {0}",Date.now()),r.logResourceLoadOrder(null,"FrameSet")},qO.prototype._onMapLayersChanged=function(e){var t,n,i=[],a=!0;for(e.added?i=e.added:e.removed&&(i=e.removed,a=!1),t=0;t<i.length;t++)(n=i[t]).logWhenAddedOrRemoved&&this._logLayerChangedInst(a,n.logId)},qO.prototype._onMapViewChanging=function(e){3===e.cause&&(this._state=3,this._mapViewChangingHandler.dispose())},qO.prototype._onMapTypeChanged=function(e){e&&this._logMapTypeChangedInst(e.newMapTypeId)},qO.prototype._onMapPanStarted=function(){this._state=2},qO.prototype._onMapZoomStarted=function(){this._state=1},qO.prototype._onFrameRendered=function(){r.log(null,"Frame Rendered {0}",Date.now()),r.logResourceLoadOrder(null,"FrameRendered");var e=null;switch(this._state){case 3:e=w.Activated;break;case 2:e=d.mapPanActionName;break;case 1:e=d.mapZoomActionName;break;default:e=d.mapSetViewActionName}this._state=0,e&&this._logClientInst(e),this._lastZoomLevel=this._map.getMercatorZoomLevel()},qO.prototype._constructMapInstrumentationData=function(e){var t=this._map,n=t.isDisposed(),i=!n&&t.getView(),t=!n&&t.getMode(),t={CP:i&&i.cameraLocation,H:i&&i.heading,A:i&&i.cameraLocation.altitude,MM:t&&t.getDisplayName()};return e!==w.Activated&&e!==w.Deactivated||(t.T=Date.now()),e===d.mapZoomActionName&&this._lastZoomLevel&&(e=this._map.getMercatorZoomLevel(),t.ZD=e>this._lastZoomLevel?sr.zoomIn:sr.zoomOut),t},qO.prototype._logLayerChangedInst=function(e,t){e=e?d.mapLayerAdded:d.mapLayerRemoved,e=this._createLogData(e);e.data.ID=t,this._logger.logObject(e,null,!1)},qO.prototype._logMapTypeChangedInst=function(e){var t=this._createLogData(d.mapTypeChangedActionName),n=i.dynamicProperties;t.data.MS=e,this._logger.logObject(t,null,!1),e===s.ordnanceSurvey&&(this._map.getMapOptions().sessionKey||n.sessionKey?this._logSnrPageNameForMapControl(d.osMapsFeatureKey,!1):(n=this._map.getConfig().logServiceUrlFormat.replace(/{credentials}/,this._map.getMapOptions().credentials).replace(/{name}/,"imageryOS").replace(/{mkt}/,i.dynamicProperties.market),tt.downloadJsonp(n,"ordnanceSurvey",null,null,null,null,null,3)))},qO.prototype._logClientInst=function(e){var t;i.enableInstrumentation&&(t=e===w.Activated||e===d.mapSetViewActionName,e=this._createLogData(e),this._logger.logObject(e,null,t))},qO.prototype._createLogData=function(e){var t=this._constructMapInstrumentationData(e);return{feature:it.MapControl,action:e,data:t}},qO.prototype._logSnrPageNameForMapControl=function(e,t){var a,r;(i.enableInstrumentation||i.enableErrorInstrumentation||i.perfSDKInclusions)&&(a=i.dynamicProperties,r=this._map.getConfig().serverInstrumentationUrlFormat.replace("{origin}",a.origin).replace("{q}","").replace("{f}",e),-1<window.location.href.toUpperCase().indexOf("MONITR")&&(r+="&FORM=MONITR"),(e=a.sdkCustomerScenarioId)&&(r+="&sid="+e),tt.downloadGeneric(r,"pagename",function(e){!t||"object"!=typeof e||(e=n(e).select("div[id=ImpressionGuid]").get_attr("name"))&&(a.mapsIG=e,i.isMapsAnswer||(a.impressionGuid=e),et.igUpdatedPromise.resolve())},t?"document":null,null,null,3))},qO.prototype.dispose=function(){this._logger&&this._logClientInst(w.Deactivated),f._clearDisposables(this._disposables),this._mapViewChangingHandler.dispose(),this._map=null,this._logger=null},qO),l;sP=l=l||{},CP=Math.tan(c.degreesToRadians(25)),sP.fromLocation=function(e,t,n){var i=e.altitude*CP;return zP(t?0:e.latitude,i/500,n=void 0===n?256:n)},sP.toLocation=function(e,t,n,i){return i=sP.toAltitude(e,t,n,i=void 0===i?256:i),new o(e.latitude,e.longitude,i,0)},sP.toAltitude=function(e,t,n,i){return 500*yP(n?0:e.latitude,t,i=void 0===i?256:i)/CP},sP.toScale=function(e,t,n,i){return yP(n?0:e.latitude,t,i=void 0===i?256:i)},sP.fromScale=function(e,t,n,i){return zP(n?0:e.latitude,t,i=void 0===i?256:i)};var wu=(dQ.prototype.getSceneBounds=function(){return this._bounds},dQ.prototype.getScene=function(e,t,n,i){var a;return e?e===this._scene.crs&&(!this._bounds||this._isIntersecting(this._bounds,t))&&i>=this._minHeading&&i<=this._maxHeading&&(n>=this._minScale||e.sceneMetadata)&&n<=this._maxScale&&(a=this._scene):(!this._bounds||this._isIntersecting(this._bounds,t))&&i>=this._minHeading&&i<=this._maxHeading&&n>=this._minScale&&n<=this._maxScale&&(a=this._scene),a},dQ.prototype.dispose=function(){this._scene&&this._scene.dispose(),this._bounds=null},dQ.prototype._isIntersecting=function(e,t){return t instanceof o?e.contains(t):e.intersects(t)},dQ),ht=(sQ=oi,p(tQ,sQ),tQ.prototype.addScene=function(e,t,n,i,a,r,o){var s=this;this._disposables.push(t.tileUrlTemplateChanged.add(function(e){s._currentScene===e&&(s._lastViewChangeFrameNumber=-1,s.layerInvalidated.invoke({layerId:s.getId()}))})),this.addSceneContributor(new wu(e,t,n,i,a,r,o))},tQ.prototype.addSceneContributor=function(e){this._sceneContributors.push(e),this._sceneContributors.sort(function(e,t){return t.priority-e.priority})},tQ.prototype.getScene=function(e,t,n,i){var a,r,o,s;for(this._currentSceneContributer=null,a=0,r=this._sceneContributors.length;a<r;a++)if((s=(o=this._sceneContributors[a]).getScene(e,t,n,i))&&(!e||s.crs===e))return this._currentSceneContributer=o,s;return null},tQ.prototype.getAvailableRasterTiles=function(){if(this._currentScene&&this._currentScene.getPercentCompleted()<100){var e=[];return this.isCritical&&e.push.apply(e,this._currentScene.getAllPendingRequestsBackgroundTiles(this._coreMap.getMapOptions().liteMode)),e.push.apply(e,this._rasterTiles),e}return this._rasterTiles},tQ.prototype.getPercentComplete=function(){return this._currentScene?this._currentScene.getPercentCompleted():100},tQ.prototype.getCurrentCrs=function(){return this._currentScene?this._currentScene.crs:null},tQ.prototype.getCurrentScene=function(){return this._currentScene},tQ.prototype.getTileSize=function(){return this._currentScene?this._currentScene.getTileSize():TileSystemHelper.tileLength},tQ.prototype.getLastViewChangeFrameNumber=function(){return this._lastViewChangeFrameNumber},tQ.prototype.setFrame=function(t,n){var i=this,e=(this._currentFrame=t).view,a=l.fromLocation(e.cameraLocation,!0),a=l.toScale(e.cameraLocation,a,!0),r=this.getVisible()&&this.getScene(null,n.getBounds(),a,e.heading);this._currentScene&&this._currentScene!==r&&this._currentScene.cancelAllPendingRequests(),this._currentScene=r,tQ._previousMapTypeId!==n.getMapType().id&&(n.getMapType().id===s.birdseyeV2&&r.crs.reset(),tQ._previousMapTypeId=n.getMapType().id),r&&(this._lastViewChangeFrameNumber!==t.lastViewChangeFrameNumber||n.getMapType().id===s.birdseyeV2||r.getPercentCompleted()<100||!this._rasterTiles)?(this._lastViewChangeFrameNumber=t.lastViewChangeFrameNumber,this._rasterTiles=[],r.setFrame(t),r.crs.update?n.getBirdseyeV2Manager().then(function(e){r.crs.update(n,function(){i._currentFrame.frameNumber===t.frameNumber&&(e.onCrsUpdate(i,0),t.view.cameraLocation=n.getView().cameraLocation,i._getAllTiles(i._currentFrame))},function(){i._currentFrame.frameNumber===t.frameNumber&&(e.onCrsUpdate(i,1),t.view.cameraLocation=n.getView().cameraLocation,i._getAllTiles(i._currentFrame))},function(){i._currentFrame.frameNumber===t.frameNumber&&e.onCrsUpdate(i,2)})}):this._getAllTiles(t)):(r||(this._rasterTiles=null),this.crsReady.invoke({frame:t}),this._raiseEventsOnDataLoad())},tQ.prototype.onCriticalDataLoaded=function(){var n=this;return new Promise(function(e){var t;n._currentScene&&(t=n._currentScene.getPercentCompleted())>n._minCriticalDataLoadedPercentage?e(t):n._pendingCriticalDataLoadedResolves.push(e)})},tQ.prototype.dispose=function(){f._clearDisposables(this._sceneContributors),this._pendingCriticalDataLoadedResolves=[],this._rasterTiles=null,sQ.prototype.dispose.call(this)},tQ.prototype._raiseEventsOnDataLoad=function(){var t=this._currentScene?this._currentScene.getPercentCompleted():100,e=this._currentScene?this._currentScene.getPercentFailed():0;t>this._minCriticalDataLoadedPercentage&&(this._pendingCriticalDataLoadedResolves.forEach(function(e){e(t)}),this._pendingCriticalDataLoadedResolves=[]),100===t&&(100===e?this.dataLoadFailed.invoke():this.dataLoaded.invoke({frame:this._currentFrame}))},tQ.prototype.getAllTilesForAnimation=function(e,t,n,i){this._currentScene.getAllTiles(e,[t],i,this.isCritical,!0,!1,n,this._coreMap.getDpiScale(),this._coreMap.getMapOptions().liteMode,this._networkPriority,this._enableCORS,this._useCredentialsForCORS,this._downloadTimeoutInMS)},tQ.prototype.refreshBackgroundTiles=function(e,t){this._currentScene.getAllTiles(e,t,null,this.isCritical,!1,!0,!0,this._coreMap.getDpiScale(),this._coreMap.getMapOptions().liteMode,this._networkPriority,this._enableCORS,this._useCredentialsForCORS,this._downloadTimeoutInMS)},tQ.prototype._getAllTiles=function(e){var t=this;this._lastViewChangeFrameNumber===e.lastViewChangeFrameNumber&&(this._currentCrs=this._currentScene.crs,this.crsReady.invoke({frame:e}),0===this._currentScene.getAllTiles(this._currentFrame.viewport,[this._currentFrame.view],function(e){e&&(t.tileDownloaded.invoke(e),t._rasterTiles.push(e)),t._raiseEventsOnDataLoad()},this.isCritical,!1,!1,!0,this._coreMap.getDpiScale(),this._coreMap.getMapOptions().liteMode,this._networkPriority,this._enableCORS,this._useCredentialsForCORS,this._downloadTimeoutInMS,-1,this._currentSceneContributer.getSceneBounds())&&this._raiseEventsOnDataLoad())},tQ),hr=(wR.prototype._setSource=function(e){var t=this;this._sourceChangedHandler&&this._sourceChangedHandler.dispose(),this._source=e,this._sourceChangedHandler=this._source&&this._attachChangeHandler(this._source,function(){return t._checkForValueChange()}),this._checkForValueChange(),this._twoWay&&this._updateSourceFromDest()},wR.prototype._attachChangeHandler=function(e,t){if(e.changed)return e.changed.add(t);if(e.add_event){e.add_event("change",t);var n=e[0];return"INPUT"===n.tagName.toUpperCase()&&"TEXT"===n.type.toUpperCase()&&e.add_event("keyup",t),{dispose:function(){e.remove_event("change",t),e.remove_event("keyup",t)}}}},wR.prototype._checkForValueChange=function(){var e=this._getValue();!this._childBinding&&this._converter&&(e=this._converter(e)),a.areEqual(this._value,e=void 0===e?null:e)||(this._value=e,this._updateDestination())},wR.prototype._getValue=function(){return this._source?this._isIdentity?this._source:a.getValue(this._source,this._sourceProperty):null},wR.prototype._updateSourceFromDest=function(){this._source&&(this._paused=!0,a.setValue(this._source,this._sourceProperty,a.getValue(this._toObj,this._toProperty)),this._paused=!1)},wR.prototype._updateDestination=function(){this._paused||(this._paused=!0,this._childBinding?this._childBinding._setSource(this._value):a.setValue(this._toObj,this._toProperty,this._value),this._paused=!1)},wR.prototype.dispose=function(){this._sourceChangedHandler&&this._sourceChangedHandler.dispose(),this._sourceChangedHandler=null,this._source=null,this._childBinding&&this._childBinding.dispose(),this._childBinding=null,this._destChangedHandler&&this._destChangedHandler.dispose(),this._destChangedHandler=null,this._value=null},wR._identityMarker="$self$",wR),bu=(LR.prototype.setValue=function(e){this._eventHandle&&this._eventHandle.dispose(),e&&(r.assertInstanceOf(e,t,"jsEvent"),this._eventHandle=e.add(this._handler))},LR.prototype.dispose=function(){this._eventHandle&&this._eventHandle.dispose(),this._binding&&this._binding.dispose()},LR),cr=(QR=oi,p(RR,QR),RR.prototype.dispose=function(){QR.prototype.dispose.call(this),this._dataSourceInvalidatedHandler&&(this._dataSourceInvalidatedHandler.dispose(),this._dataSourceInvalidatedHandler=null)},RR.prototype._onDataSourceChanged=function(e,t){e!==t&&(this._dataSourceInvalidatedHandler&&(this._dataSourceInvalidatedHandler.dispose(),this._dataSourceInvalidatedHandler=null),t&&t.invalidated&&(this._dataSourceInvalidatedHandler=t.invalidated.add(function(){return r.clearTestHooksLog(r.TileLogTag)})))},RR),lr=(_R=rt,p(aS,_R),aS.prototype.getTemplateSelector=function(){return this._templateSelectorPromise},aS.prototype.setTemplateSelector=function(e){this._resolveBaseMapTemplateSelector&&this._resolveBaseMapTemplateSelector(e)},aS.prototype.dispose=function(){this.clear(),this._templateSelectorPromise.then(function(e){e.dispose()})},aS),ar=(tS.prototype._create=function(){function e(e,t){e.apply(this,t)}e.prototype=this._objectConstructor.prototype,this._objectPool.push(new e(this._objectConstructor,this._constructorArguments))},tS.prototype.acquire=function(){return 0===this._objectPool.length&&this._create(),this._objectPool.pop()},tS.prototype.release=function(e){this._objectPool.push(e)},tS.prototype.dispose=function(){for(var e,t=this._objectPool.length;t--;)(e=this._objectPool[t]).dispose&&e.dispose();this._objectPool=null},tS),ct=(CS.prototype.toLatitude=function(e,t){return t},CS.prototype.toLongitude=function(e){return e},CS.prototype.projectToX=function(e,t){return t},CS.prototype.projectToY=function(e){return e},CS.prototype.getScale=function(e){var t=b.fromRegionId(e),n=(t.height,t.width),t=k.greatCircleDistance(new o(0,t.getWest()),new o(0,t.getEast()));return 360<=n?t=k.earthCircumference:180<n&&(t=k.earthCircumference-t),t/e.pixelWidth},CS.prototype.getGroundResolution=function(e){var t=b.fromRegionId(e),n=(t.height,t.width),i=k.greatCircleDistance(t.getNorthwest(),t.getSoutheast());return 360<=n?i=k.earthCircumference:180<n&&0<t.getNorth()&&t.getSouth()<0&&(i=k.earthCircumference-i),i/Math.sqrt(e.pixelWidth*e.pixelWidth+e.pixelHeight*e.pixelHeight)},CS.instance=new CS,CS),b=(VS.prototype.buffer=function(e){void 0===e&&(e=.1),this._northWest=this._southEast=null,this.width+=e*this.width,this.height+=e*this.height,this.bounds=[this.getNorth(),this.getEast(),this.getSouth(),this.getWest()]},VS.prototype.getNorthwest=function(){return this._northWest||(this._northWest=new o(this.getNorth(),this.getWest(),this.center.altitude)),this._northWest},VS.prototype.getSoutheast=function(){return this._southEast||(this._southEast=new o(this.getSouth(),this.getEast(),this.center.altitude)),this._southEast},VS.prototype.getNorth=function(){return this.center.latitude+this.height/2},VS.prototype.getSouth=function(){return this.center.latitude-this.height/2},VS.prototype.getWest=function(){return 360<=this.width?-180:o.normalizeLongitude(this.center.longitude-this.width/2)},VS.prototype.getEast=function(){return 360<=this.width?180:o.normalizeLongitude(this.center.longitude+this.width/2)},VS.prototype.toString=function(){return this.getNorth()+","+this.getWest()+","+this.getSouth()+","+this.getEast()},VS.prototype.clone=function(){return new VS(this.center.clone(),this.width,this.height)},VS.prototype.containsLatLong=function(e,t){return t=o.normalizeLongitude(t),e=Math.abs(this.center.latitude-e),180<(t=Math.abs(this.center.longitude-t))&&(t=360-t),e<=this.height/2+1e-8&&t<=this.width/2+1e-8},VS.prototype.contains=function(e){return this.containsLatLong(e.latitude,e.longitude)},VS.prototype.intersects=function(e,t){void 0===t&&(t=0);var n=Math.abs(this.center.latitude-e.center.latitude),i=Math.abs(this.center.longitude-e.center.longitude);return 180<i&&(i=360-i),n<=this.height*(1+t)/2+e.height/2&&i<=this.width*(1+t)/2+e.width/2},VS.prototype.crossesInternationalDateLine=function(e){var t,n=this.getEast()<this.getWest();return n||(t=this.originalBounds)&&(n=360<(t=Math.abs(t[1]-t[3]))||e&&360===t),n},VS.prototype.splitByInternationalDateLine=function(){var e,t,n,i;return this.crossesInternationalDateLine()?(e=this.getNorth(),t=this.getWest(),n=this.getSouth(),i=this.getEast(),[VS.fromEdges(e,t,n,180),VS.fromEdges(e,-180,n,i)]):[this]},VS.merge=function(e,t){var n,i,a,r,o,s=null;if(e&&t){for(var l=[],u=Math.max(e.getNorth(),t.getNorth()),c=Math.min(e.getSouth(),t.getSouth()),h=0,d=[e,t],h=0;h<d.length;h++)(n=d[h]).crossesInternationalDateLine()?(l.push([n.getWest(),180]),l.push([-180,n.getEast()])):l.push([n.getWest(),n.getEast()]);for(l.sort(function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]}),i=[],a=l[0],h=1;h<l.length;)r=l[h],a[1]>=r[0]?a[1]=Math.max(a[1],r[1]):(i.push(a),a=r),h++;i.push(a);var p=i.length,m=i[0][0]+360-i[p-1][1],g=[i[p-1][1],i[0][0]];for(h=1;h<p;h++)m<(o=i[h][0]-i[h-1][1])&&(m=o,g=[i[h-1][1],i[h][0]]);s=VS.fromEdges(u,g[1],c,g[0])}else e?t||(s=e):s=t;return s},VS.fromEdges=function(e,t,n,i,a,r,s){var l;return s&&(l=[e,i,n,t]),360<Math.abs(i-t)&&(t=-180,i=180),t=o.normalizeLongitude(t),(i=o.normalizeLongitude(i))<t&&(i+=360),s=o.normalizeLongitude(s=(t+i)/2),new VS(new o((n+e)/2,s,a,r),i-t,e-n,l)},VS.fromCorners=function(e,t){return VS.fromEdges(e.latitude,e.longitude,t.latitude,t.longitude,e.altitude)},VS.fromLocations=function(){for(var e,t,n,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];for(var r,s,l,u,c,h,d,p,m,g,_=(r=(r=f._isArray(arguments[0])?arguments[0]:arguments)||[]).length,y=new Array(_),v=0;_--;)m=(p=r[_]).latitude,g=p.longitude,isFinite(m)&&isFinite(g)&&(s=void 0===s?m:Math.max(s,m),l=void 0===l?m:Math.min(l,m),y[v++]=g=o.normalizeLongitude(g),c=void 0===c?g:Math.max(c,g),u=void 0===u?g:Math.min(u,g),-1!==p.altitudeReference&&(h=p.altitude,d=p.altitudeReference));if(v&&180<c-u){for(y.length=v,y.sort(function(e,t){return e-t}),e=y[0]+360-y[v-1],t=0,_=1;_<v;_++)e<(n=y[_]-y[_-1])&&(e=n,t=_);u=y[t],c=y[(t||v)-1]}return VS.fromEdges(s,u,l,c,h,d)},VS.fromShapes=function(e){var t,n,i,a,r=null;if(e)if(e instanceof Array)for(n=0,i=e.length;n<i;n++)t=VS.fromShapes(e[n]),r=VS.merge(r,t);else e instanceof bi?r=new VS(e.getLocation(),0,0):e instanceof kr?(a=e.getRings())&&1<=a.length&&(r=VS.fromLocations(a[0])):e instanceof di?r=VS.fromLocations(e.getLocations()):e.geometry&&e.geometry.boundingBox&&(r=e.geometry.boundingBox);return r},VS.fromString=function(e){var t,n,i=null,a=e.split(",");return a&&4===a.length&&(t=parseFloat(a[0]),n=parseFloat(a[1]),e=parseFloat(a[2]),a=parseFloat(a[3]),i=VS.fromEdges(t,n,e,a)),i},VS.fromRegionId=function(e,t){var n,i,a;if(r.assert(e&&e.bounds&&4===e.bounds.length,"Invalid regionId"),n=e.boundingBox)t||(n=n.clone());else{t=e.crs,VS._createMapLocationObjectPool();var o=VS._mapLocationObjectPool.acquire(),s=VS._mapLocationObjectPool.acquire(),l=VS._mapLocationObjectPool.acquire(),u=VS._mapLocationObjectPool.acquire();o.latitude=t.toLatitude(e.bounds[3],e.bounds[0]),o.longitude=t.toLongitude(e.bounds[3],e.bounds[0]),s.latitude=t.toLatitude(e.bounds[1],e.bounds[0]),s.longitude=t.toLongitude(e.bounds[1],e.bounds[0]),l.latitude=t.toLatitude(e.bounds[1],e.bounds[2]),l.longitude=t.toLongitude(e.bounds[1],e.bounds[2]),u.latitude=t.toLatitude(e.bounds[3],e.bounds[2]),u.longitude=t.toLongitude(e.bounds[3],e.bounds[2]);try{if(i=o,a=l,e.crs&&e.crs.heading)switch(e.crs.heading){case 0:break;case 90:i=u,a=s;break;case 180:i=l,a=o;break;case 270:i=s,a=u;break;default:r.assert(!1,"custom crs heading not implemented")}t.sceneMetadata&&(i.latitude=Math.max(o.latitude,s.latitude,l.latitude,u.latitude),i.longitude=Math.min(o.longitude,s.longitude,l.longitude,u.longitude),a.latitude=Math.min(o.latitude,s.latitude,l.latitude,u.latitude),a.longitude=Math.max(o.longitude,s.longitude,l.longitude,u.longitude)),n=VS.fromCorners(i,a),e.boundingBox=n}finally{VS._mapLocationObjectPool.release(o),VS._mapLocationObjectPool.release(s),VS._mapLocationObjectPool.release(l),VS._mapLocationObjectPool.release(u)}}return n},VS.areEqual=function(e,t,n){var i,a,r=!1;return e&&t&&(i=e.getNorthwest(),a=e.getSoutheast(),e=t.getNorthwest(),t=t.getSoutheast(),r=o.areEqual(i,e,!0,n)&&o.areEqual(a,t,!0,n)),r},VS._createMapLocationObjectPool=function(){VS._mapLocationObjectPool||(VS._mapLocationObjectPool=new af(4,o,[0,0]))},VS),vr=(VU.getPooledImage=function(e,t){var n=(VU._imagePool=!VU._imagePool?new sf(VU):VU._imagePool).acquire();return n.image||(n.image=document.createElement("img")),e?n.image.crossOrigin=t?"use-credentials":"anonymous":delete n.image.crossOrigin,n},VU.prototype.release=function(){var e=this;this.image&&(this.image.src=""),n.Browser.is_ie?Microsoft.Maps.setTimeout(function(){VU._imagePool.release(e)},1e3):VU._imagePool.release(this)},VU),tt;$U=tt=tt||{},uV={},vV={},wV=0,xV=0,yV=0,zV=-1,AV={},BV=window.$MicrosoftMaps8.toString()+".NetworkCallbacks.",CV="{callback}",DV="~DispatchKey~",EV="jsonso=",HV=25e3,JV=15e3,KV=5,LV=1e3,MV=-1,NV=-1,PV=function(){var e=null,t=u.Internal.originalXMLHttpRequest;return void 0!==t?e=new t:"undefined"!=typeof ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLHTTP")),e},$U.downloadGeneric=function(n,e,t,i,a,r,o,s,l){n=tV(n);var u=(yV++).toString(),c=u+DV+n;return aV(n,n,t,a,function(e){gV(e,i||"text",null,null,s).send()},null,r,"number"==typeof o?o:1,e,u,HV,null,!1,l),uV[n].abortCallback=function(e,t){hV(null,n,null,t)},c},$U.downloadImage=function(e,t,n,i,a,r,o,s,l){void 0===l&&(l=15e3),e=tV(e),JV=Math.min(JV,l);var u=(xV++).toString(),c=(yV++).toString(),h=c+DV+u;return aV(e,e,n,i,function(e){var n=vr.getPooledImage(o,s),t=n.image;t.onload=function(){var e=uV[u];e&&1===e.status&&oV(2,u,n)},t.onerror=function(){var e=uV[u];e&&1===e.status&&oV(!t.complete||0===t.naturalWidth?3:2,u,n)},e.abortCallback=function(e,t){oV(t,u,n)},t.onabort=function(){e.abortCallback&&e.abortCallback(null,3)},n.image.src=e.url},null,a,"number"==typeof r?r:0,t,c,l,u,!0),uV[u].abortCallback=function(e,t){oV(t,u,null)},h},$U.downloadJson=function(i,e,t,a,r,o,s,l,u,c){void 0===l&&(l=!0),i=tV(i);var h=(yV++).toString(),d=h+DV+i;return u=u||{},l&&!u["Content-Type"]&&(u["Content-Type"]="application/json; charset=utf-8"),aV(i,i,t,a,function(e){gV(e,null,u,o).send()},function(e){var t={succeeded:!1};try{t.response=n.Internals.parseJSON(e),t.succeeded=!0}catch(e){}return t},r,"number"==typeof s?s:1,e,h,HV,null,!1,c),uV[i].abortCallback=function(e,t){hV(null,i,null,t)},d},$U.downloadJsonp=function(i,e,t,n,a,o,s,l,u,c){var h,d,p,m,g,_,y;i=tV(i);var v=!0,b=(yV++).toString(),w=i;return a=a||function(e){for(var t=parseInt(f._getHash(e),16),n=uV[t.toString(16)];n&&n.sourceUrl!==e;)n=uV[(++t).toString(16)];return t.toString(16)}(w),h=b+DV+a,i.indexOf(CV)<0&&(v=!1),p=!1,/\{jsonso}/gi.test(i)?(d=o?"reverse":"normal",i=i.replace(/\{jsonso}/gi,a)):0<=i.indexOf(EV)?0<=(m=i.indexOf(EV))&&((g=i.indexOf("&",m))<0&&(g=i.length),a=i.substr(_=m+EV.length,g-_)):(v||0<=(m=i.indexOf("jsonp="))&&((g=i.indexOf("&",m))<0&&(g=i.length),d=i.substr(_=m+6,g-_)),d=d||"f"+a,p=!0),v&&(_=BV+d,i=i.replace(CV,_)),c=aV(w,i,t,n,function(e){var t;t=e,(e=document.createElement("script")).type="text/javascript",e.src=t.url,e.async=!0,e.onerror=function(){Microsoft.Maps.setTimeout(function(){t.abortCallback&&t.abortCallback(null,3)},0)},t.scriptElement=e,t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),document.getElementsByTagName("head")[0].appendChild(e)},null,s,"number"==typeof l?l:1,e,b,HV,a,!1,u,c),p&&(vV[a]?vV[a]++:vV[a]=1,y=uV[a],v?$U.callbacks[d]=function(e,t,n,i){r.assert(t===a||!t,"If specified, the jsonsoInner parameter must equal jsonso."),4!==i&&3!==i&&(vV[a]-=Object.keys(y.successCallbacks).length),hV(e,a,n,i),0===vV[a]&&(delete $U.callbacks[d],delete vV[a])}:window[d]=function(e,t,n,i){4!==i&&3!==i&&(vV[a]-=Object.keys(y.successCallbacks).length),hV(e,a,n,i),0===vV[a]&&(delete window[d],delete vV[a])}),c&&c===uV[a]?c.abortCallback=function(e,t){var n=window[d]||$U.callbacks[p?d:"normal"];n&&n(null,a,3===t?500:504,t),3===t&&r.logNetworkData(i,"error")}:iV(c,0,"downloadJsonp mismatch"),h},$U.abortRequest=function(e){var t,n;e&&((e=e)&&(n=1===(n=e.toString().split(DV)).length?n[0]:(t=n[0],n[1])),(n=uV[(e={requestId:n,callbackId:t}).requestId])&&(t=Object.keys(n.successCallbacks).length,r.assert(!!(e=e.callbackId),"Abort request should return back valid dispatchKey"),n.successCallbacks[e]&&(1<t?(n.errorCallbacks[e]&&n.errorCallbacks[e](n.callbackStates[e],4),delete n.errorCallbacks[e],delete n.callbackStates[e],delete n.successCallbacks[e]):n.abortCallback&&n.abortCallback(null,4))))},$U.callbacks={normal:hV,reverse:function(e,t){hV(t,e)}},$U.doPost=function(e,t,n){var i,a;e=tV(e);var r=PV(),o=n.headers||{},s=n.onError||function(){},l=n.onSuccess||function(){};if(n.queryParameters)for(i in e.indexOf("?")<0&&(e+="?"),n.queryParameters)n.queryParameters.hasOwnProperty(i)&&(e+="&"+encodeURIComponent(i)+"="+encodeURIComponent(n.queryParameters[i]));for(a in r.open("POST",e,!0),r.timeout=HV,r.ontimeout=s,o)o.hasOwnProperty(a)&&r.setRequestHeader(a,o[a]);r.onabort=s,r.onerror=s,r.onreadystatechange=function(){4===r.readyState&&(200===r.status?l(r.responseText):s(r.responseText,r.status,r.statusText))},r.send(t)};var ku=(DZ.prototype.getCopyrights=function(e,t,n,a,o,s,l,u,c){r.assertNotNull(t,"imageryId"),s=s||0,o=Math.round(o),t&&a&&o&&l&&(l=e.replace(/{imagerySet}/,t).replace(/{productId}/,n).replace(/{zoom}/,o.toString()).replace(/{minLat}/,a[2].toString()).replace(/{minLon}/,a[3].toString()).replace(/{maxLat}/,a[0].toString()).replace(/{maxLon}/,a[1].toString()).replace(/{heading}/,s.toString()).replace(/{credentials}/,l).replace(/{mkt}/,i.dynamicProperties.market).replace(/{ml}/,u.getConfig().copyrightMapLayers),this._downloadCopyright(l,u,c))},DZ.prototype._copyrightServiceCallback=function(e,t,n,a){var r;if(!t.isDisposed()){if(r=[],e)if((e=e.resourceSets&&0<e.resourceSets.length&&e.resourceSets[0]&&e.resourceSets[0].resources[0]&&e.resourceSets[0].resources[0].imageryProviders)&&0<e.length&&""!==e[0])Array.prototype.push.apply(r,e);else if(a&&t.getMapType().id===s.ordnanceSurvey&&-1<a.indexOf("OrdnanceSurvey"))return a=a.replace("OrdnanceSurvey","RoadOnDemand"),void this._downloadCopyright(a,t,n);!i.isSDK&&f._hasBingHeaders()||r.push(this._getDefaultCopyright()),n(r)}},DZ.prototype._downloadCopyright=function(t,n,i){var a=this,e=Math.floor(1e6*Math.random()).toString();tt.downloadJsonp(t,"copyright",function(e){return a._copyrightServiceCallback(e,n,i,t)},function(){return a._copyrightServiceCallback(null,n,i)},e.toString(),null,null,3)},DZ.prototype._getDefaultCopyright=function(){return String.fromCharCode(169)+" "+(new Date).getFullYear()+" Microsoft Corporation"},DZ.instance=new DZ,DZ),ci=($Z.prototype.getCopyrights=function(t,n,i,a,r){var o=this;ii.instance.authenticateClientAndRetrieveSessionId(function(e){!o._map.isDisposed()&&e&&ku.instance.getCopyrights(o._imageryCopyrightUrlFormat,o._getImageryId(i),t,n,i,a,e,o._map,r)})},$Z.prototype._getImageryId=function(e){var t=this._imageryId,n=this._map.getLabelController();return"Aerial"===t&&n&&n.getIsLabelsEnabled()&&(t+="WithLabels"),"AerialWithLabels"!==t&&"Road"!==t||(t+="OnDemand"),t="OrdnanceSurvey"===t&&(18<e||e<12)?"RoadOnDemand":t},$Z),du=(m$=rt,p(n$,m$),n$.prototype.dispose=function(){for(var e=0,t=this.length;e<t;e++)this[e].dispose();this._miscCache.clear(),this._templateSelectorCache.clear(),window.clearTimeout(this._timerId),this.clear(),this._map=null},n$.prototype.updateCustomMapStyle=function(e){this._customMapStyleManager.update(e)},n$.prototype._getSupportedMapTypeDefs=function(e,t){var n,i,a,r,o,l,u,c,h,d,p=this._map.getMapOptions(),m=p.supportedMapTypes,g=[];if(m&&0!==m.length){if(n=[s.birdseye,s.birdseyeV2,s.streetside],i=m.length,-1<n.indexOf(m[0])){for(a=1;a<i;){if(h=m[a],-1===n.indexOf(h)){m[a]=m[0],m[0]=h;break}a++}i<=a&&(m=[s.road].concat(m))}for(this._coreConfig.defaultMapType=m[0],t&&p.mapType===t&&m.indexOf(t)<0&&(p.mapType=m[0]),r={},o=0,l=e;o<l.length;o++)(d=l[o]).mapTypeEnabled&&0<=m.indexOf(d.mapType)&&(r[d.mapType]=d);for(u=0,c=m;u<c.length;u++)(d=r[h=c[u]])&&g.push(d)}else g=e;return g},n$.prototype._isMapTypeAvailable=function(e){var t,n=this._map.getMapOptions();switch(e){case s.birdseye:case s.birdseyeV2:return!n.disableBirdseye;case s.streetside:return t=i.features.streetside,!n.disableStreetside&&t&&t.isEnabled;case s.ordnanceSurvey:return i.features.ordnanceSurvey.isEnabled;case s.grayscale:case s.canvasDark:case s.canvasLight:case s.roadDark:case s.getTilePrimerId(s.grayscale):case s.getTilePrimerId(s.canvasDark):case s.getTilePrimerId(s.canvasLight):case s.getTilePrimerId(s.roadDark):return!i.isMapsVertical;default:return!0}},n$.prototype._loadLayer=function(e,t){var n,i,a,r,o;if(e.imageryScenes&&0<e.imageryScenes.length)for(i=n=new ht(e.id,e.zIndex,1,!0,void 0,void 0,void 0,this._map.getMapOptions().enableCORS),a=0,r=e.imageryScenes.length;a<r;a++)o=e.imageryScenes[a],this._addScene(r-a,i,o,t);else n=new cr(e.id),this._getDelayLoadedDataSource(this._getDataSourceDragonflyKeyByMapType(t)).getObjectAsync(function(e){n.setDataSource(e)});return n.setVisible(!!e.visible),n.setRenderTarget(1),n.isBaseLayer=!0,n.canBeFiltered=!0,n},n$.prototype._getDataSourceDragonflyKeyByMapType=function(e){var t="BaseMapDataSource";return e.id===s.ordnanceSurvey?t="BaseMapOSDataSource":e.id===s.streetside&&(t="BaseMapStreetsideDataSource"),t},n$.prototype._addScene=function(r,s,c,e){var h,d,p,m,g,_=this,t=i.isMapsVertical,v=i.compositeSplit,w=c.maxZoom&&l.toScale(null,c.maxZoom,!0),M=c.minZoom&&l.toScale(null,c.minZoom,!0),C=c.imageryId,S=this._map,n=S.getMapOptions(),a=this._coreConfig,e={"{domain}":this._tileDomainName,"{protocol}":a.urlProtocol,"{tfeDomainDynamic}":a.tfeDomainDynamic,"{tfeDomainStatic}":a.tfeDomainStatic,"{tileUrlParam}":c.tileUrlParam,"{tileUrlWithoutLabelParam}":c.tileUrlWithoutLabelParam,"{cstl}":e.cstl,"{dpi}":this._dpiParam},L=n.allTileFeatures||t?c.tileFeaturesMapsVertical:c.tileFeaturesSDK,P=c.tileFeaturesWithoutLabel,T=f._replaceValues(c.tileUrl,e),n=n.backgroundColor;"Mercator"===C&&n&&(T=this._getMercatorBackgroundTileUrl(n));var x=f._replaceValues(c.tileUrlWithoutLabel,e),e=[{name:"RasterImageryScene"},{name:"EnhancedBirdseyeCrs"}],e=v?e:e.concat([{name:"BirdseyeV2ImageryScene"},{name:"BirdseyeV2Crs"}]),k=function(){for(var e=["N","E","S","W"],t=S.getMapOptions().birdseyeTransitionPaddingPtg,n=0;n<4;n++)m=(p=90*n)-45,g=p+45,d=new ci(C,S,_._coreConfig.beV2ImageryCopyrightUrlFormat),h=new u.BirdseyeV2ImageryScene(S,new y(l.toLocation(new o(0,0),0,!0)),new u.BirdseyeV2Crs(p,_._coreConfig.birdseyeV2MetadataUrl.replace("{dir}",e[n]),t),C,T,L,d,x,P),s.addScene(r,h,m,g,w,M,c.bounds&&b.fromString(c.bounds))};this._container.instanceAsyncAll(e,function(e){var t,n,i,a;switch(C){case"Synth":case"SynthWithLabels":for(t=["dir_n","dir_e","dir_s","dir_w"],n=0;n<4;n++)m=(p=90*n)-45,g=p+45,d=new ci(C,S,_._coreConfig.imageryCopyrightUrlFormat),i=T.replace("{dir}",t[n]),a=x.replace("{dir}",t[n]),h=new e.RasterImageryScene(S,new y(l.toLocation(new o(0,0),0,!0)),new e.EnhancedBirdseyeCrs(p,_._coreConfig.elevationServiceUrl),C,i,L,d,a,P),s.addScene(r,h,m,g,w,M,c.bounds&&b.fromString(c.bounds));break;case"BirdseyeV2":v||k();break;default:d=new ci(C,S,_._coreConfig.imageryCopyrightUrlFormat),h=e.RasterImageryScene.createMercatorImageryScene(C,T,L,d,S,x,P,_._customMapStyleManager),s.addScene(r,h,0,360,w,M,c.bounds&&b.fromString(c.bounds))}},!t),v&&this._map.getBirdseyeV2Manager().then(k)},n$.prototype._getDelayLoadedBaseMapTemplateSelector=function(t,e){var n=this,a=t,r=e?this._mapLiteTemplateUrlFormat:this._mapTemplateUrlFormat,e=this._templateSelectorCache.getItem(a);return e||(e=new si(function(e){n._container.instanceAsync("BaseMapTemplateSelector",e,{mapTemplateUrlFormat:r,stlVersion:i.stlVersion,templateName:t,hitTest:n._map.getIsMapHitTestable()})}),this._templateSelectorCache.addItem(a,e)),e},n$.prototype._getDelayLoadedDataSource=function(t){var n=this,e=this._miscCache.getItem(t);return e||(e=new si(function(e){n._container.instanceAsync(t,e,n._coreConfig)}),this._miscCache.addItem(t,e)),e},n$.prototype._loadTemplateAsync=function(e,t,n,i){var a=this;if(!e)throw new Error("_loadTemplateAsync called with null templateName");this._getDelayLoadedBaseMapTemplateSelector(e,t).getObjectAsync(function(e){i&&e.selectorReady(),a._setTemplateSelector(e,n)})},n$.prototype._setTemplateSelector=function(e,t){if(!e)throw new Error("MapTypeCollection._setTemplateSelector called with null templateSelector");t.setTemplateSelector(e);for(var n=0;n<t.length;n++)t[n].setTemplateSelector(e);0==--this._pendingCount&&this._completionCallback&&(this._timerId=Microsoft.Maps.setTimeout(this._completionCallback,0,this))},n$.prototype._getMercatorBackgroundTileUrl=function(e){var t,n=document.createElement("canvas");return n.width=n.height=256,(t=n.getContext("2d")).fillStyle=e,t.fillRect(0,0,256,256),n.toDataURL()},n$),gu=(yaa.prototype.attach=function(e){var t=this;r.assert(!this._eventHandlers,"A map has already been attached to this overlay behavior"),this._map=e,this._eventHandlers=[],this._eventHandlers.push(e.primitiveTapped.add(function(e){return t._onPrimitiveTapped(e)})),this._eventHandlers.push(e.primitiveHoverStarted.add(function(e){return t._onPrimitiveHoverStarted(e)})),this._eventHandlers.push(e.primitiveHoverStopped.add(function(e){return t._onPrimitiveHoverStopped(e)})),this._eventHandlers.push(e.mapTapped.add(function(){return t._hideOverlay()})),this._eventHandlers.push(e.mapZoomStarted.add(function(){return t._hideOverlay()})),this._eventHandlers.push(e.mapZoomChanged.add(function(){return t._hideOverlay()})),this._eventHandlers.push(e.mapModeChanged.add(function(){return t._hideOverlay()})),this._eventHandlers.push(e.contextMenuInvoked.add(function(){return t._hideOverlay()}))},yaa.prototype.detach=function(){r.assertNotNull(this._eventHandlers,"This overlay behavior is not currently attached to a map"),this._hideOverlay(),this._eventHandlers.forEach(function(e){e.dispose()}),this._eventHandlers=null,this._map=null},yaa.prototype._onPrimitiveHoverStarted=function(e){var t=e.layer;t&&2===t.overlayEvent&&this._showOverlay(t,e.primitive)},yaa.prototype._onPrimitiveHoverStopped=function(e){e=e.layer;e&&2===e.overlayEvent&&this._hideOverlay()},yaa.prototype._onPrimitiveTapped=function(e){var t=e.layer;t&&1===t.overlayEvent&&(this._overlayPrimitive&&this._hideOverlay(),this._showOverlay(t,e.primitive))},yaa.prototype._showOverlay=function(e,t){ki.showOverlay(this._map,e,t),this._overlayPrimitive=t},yaa.prototype._hideOverlay=function(){ki.hideOverlay(this._map,this._overlayPrimitive),this._overlayPrimitive=null},yaa),nf=function(e,t){this.cause=e,this.animation=t},yr=function(e,t){this.oldMapTypeId=e,this.newMapTypeId=t},pt=function(e,t){this.cause=e,this.isInAnimation=t||!1},pr=(Waa.prototype.getLocation=function(){return this._location},Waa.prototype.getPoint=function(){return this._point},Waa.prototype.interpolate=function(e,t,n){r.assert(e.cameraLocation.altitudeReference===t.cameraLocation.altitudeReference,"Can't interpolate between different altitude references");var i=e.cameraLocation.altitude,e=(t.cameraLocation.altitude-i)*n+i,n=this._map.getMode();return 0===n.mapModeType?(i=n.getTileSize(),this._updateMapView(n.getCurrentCrs(),i.width,i.height,this._map.getActualSize(),t.heading,e,t.cameraLocation.altitudeReference)):(e=this._map.getMode().getCameraForLocationToPoint(this._location,this._point,e,t.cameraLocation.altitudeReference),this._mapView?(this._mapView.cameraLocation=e,this._mapView.heading=t.heading):this._mapView=new y(e,t.heading)),this._mapView},Waa.prototype._updateMapView=function(e,t,n,i,a,r,s){this._location.altitude=r;var u=Math.pow(2,l.fromLocation(this._location,!0)),c=u*t,t=u*n,u=e.projectToX(this._location.latitude,this._location.longitude),n=e.projectToY(this._location.latitude,this._location.longitude),c=u-(this._point.x-i.width/2)/c,t=n-(this._point.y-i.height/2)/t;this._mapView?(this._mapView.cameraLocation.latitude=e.toLatitude(c,t),this._mapView.cameraLocation.longitude=e.toLongitude(c,t),this._mapView.cameraLocation.altitude=r,this._mapView.cameraLocation.altitudeReference=s,this._mapView.heading=a):(s=new o(e.toLatitude(c,t),e.toLongitude(c,t),r,s),this._mapView=new y(s,a))},Waa),li=function(e,t){this.zoom=l.fromLocation(e.getView().cameraLocation,!0),this.location=t.getLocation(),this.point=t.getPoint()},ii=(A0a.prototype.authenticateClientAndRetrieveSessionId=function(e,t){this._resetOnSessionExpiry(),this._hasValidCredentials?e&&e(this._logServiceResponse.sessionId):!1!==this._hasValidCredentials&&this._originalCredentials?(e&&this._callbackPool.push(e),this._isAuthInProgress||(this._isAuthInProgress=!0,this._initiateAuthCallwithRetry())):(this._hasValidCredentials=!1,this._showInvalidCredentialsError(),t&&t())},A0a.prototype._initiateAuthCallwithRetry=function(){var t=this,e=this._logServiceUriFormat.replace(/{credentials}/,this._originalCredentials).replace(/{mkt}/,i.dynamicProperties.market).replace(/{name}/,"MVC");tt.downloadJsonp(e,"auth",function(e){return t._logServiceSuccessCallback(e)},function(){return t._logServiceErrorCallback()},"_logCallbackRequest",!1,null,0,null,A0a._getReferrerPolicy())},A0a.prototype.getSessionId=function(){var e;return this._resetOnSessionExpiry()&&this.authenticateClientAndRetrieveSessionId(null),(e=this._logServiceResponse&&this._logServiceResponse.authenticationResultCode===this._validAuthenticationResultCode?this._logServiceResponse.sessionId:e)||this._originalCredentials},A0a.prototype._resetOnSessionExpiry=function(){return!!(!this._isAuthInProgress&&!isNaN(this._sessionKeyExpiryTime)&&!1!==this._hasValidCredentials&&this._mapOptions&&this._mapOptions.enableSessionKeyRenew&&Date.now()>this._sessionKeyExpiryTime)&&(this._logServiceResponse=null,this._hasValidCredentials=void 0,!(this._authFailureCount=0))},A0a.prototype._logServiceSuccessCallback=function(t){var e,n,a;if(r.assertNotNull(t,"response"),this._isAuthInProgress=!1,this._authFailureCount=0,this._hasValidCredentials=t.authenticationResultCode===this._validAuthenticationResultCode,e=t.features,this._logServiceResponse=t,this._hasValidCredentials?t.sessionIdExpirationTime&&(this._sessionKeyExpiryTime=new Date(t.sessionIdExpirationTime).getTime()-A0a._sessionExpMargin):this._showInvalidCredentialsError(),this._callbackPool.forEach(function(e){try{e&&e(t.sessionId)}catch(e){}}),this._callbackPool=[],i.featuresEnabledByAuthKey&&e&&0<e.length){for(-1===i.platformCommonParam.indexOf(n="&setfeatures=")&&(i.platformCommonParam+=n+e.join(",")),n=i.tileSourceParam,a=0;a<e.length;a++)if("openmapdata"===e[a].toLocaleLowerCase()){this.isKeyBasedDataSrcFeatureEnabled=!0,i.tileSourceParam="o";break}n!==i.tileSourceParam&&this.onAuthBasedFeatureEnabled.invoke()}},A0a.prototype._logServiceErrorCallback=function(){var e,t,n=this;this._authFailureCount<A0a._maxAuthenticationRetries?(this._authFailureCount++,Microsoft.Maps.setTimeout(function(){n._initiateAuthCallwithRetry()},100*this._authFailureCount)):(t={authenticationResultCode:this._validAuthenticationResultCode,sessionId:this._originalCredentials},this._logServiceSuccessCallback(t),(e=u.logger)&&(t={feature:it.MapControl,action:w.Error,data:{errorMessage:"MapAuthentication failed after "+A0a._maxAuthenticationRetries+" tries."}},e.logCriticalError(null,t)))},A0a.prototype._showInvalidCredentialsError=function(){var e,t,n,i,a,r=this._mapInstances;if(0<r.length)for(e=0;e<r.length;e++)r[e].isDisposed()||0!==(t=r[e].getRootElement()).select("#"+(n="missingCredential")).length||(i=f._createElement("div").set_attr("id",n).set_attr("aria-label",this._getInvalidCredentialsMessage()),a=f._createElement("div").appendTo(i).set_text(this._invalidCredentialsMessage).set_style({background:"#f8f7f5",padding:"10px",color:"#000",fontSize:"14px"}),f._createElement("a").appendTo(a).set_attr("href",this._devSignUpUrl).set_text(this._devSignUpUrl),t[0].insertBefore(i[0],t[0].firstChild),i.set_style({position:"absolute",overflow:"hidden",width:"100%",top:"50%",textAlign:"center",zIndex:9999}).set_attr("tabindex","0").set_attr("role","alert"));console.error(this._getInvalidCredentialsMessage())},A0a.prototype._getInvalidCredentialsMessage=function(){return this._invalidCredentialsMessage+this._devSignUpUrl},A0a._getReferrerPolicy=function(){var e,t=window.location,n=t?t.href:null,a=t?t.origin:null;return f._getCoreConfig().passReferrer&&n&&a&&((t=decodeURIComponent(i.dynamicProperties.scriptReferrer))?t===n.toLowerCase()?e="no-referrer-when-downgrade":((a=a.toLowerCase()).endsWith("/")||(a+="/"),t.endsWith("/")||(t+="/"),t===a&&(e="strict-origin-when-cross-origin")):e="no-referrer"),e},A0a._sessionExpMargin=6e4,A0a._maxAuthenticationRetries=5,A0a),tf=(kba.getMercatorZoomLevel=function(e){return e.getMercatorZoomLevel()},kba.getMapBounds=function(e,t){return e.getBounds(t)},kba.getViewportCenter=function(e,t,n){t=t||e.getViewportPadding(),n=n||e.getActualSize();return new h(t.left+(n.width-t.left-t.right)/2,t.top+(n.height-t.top-t.bottom)/2)},kba.getViewportCenterOffset=function(e){var t=kba.getViewportCenter(e),e=e.getActualSize();return new nt(t.x-e.width/2,t.y-e.height/2)},kba.getMapCenter=function(e){var t=kba.getViewportCenter(e);return e.getMode().tryPointToLocation(t)},kba.setMapCenter=function(e,t,n,i,a,r,o,s,l){l=kba.constructView(e,t,n,i,o,s,l);return e.setView(l,a,r),l},kba.constructView=function(e,t,n,i,a,r,o){"number"!=typeof n&&(n=kba.getMercatorZoomLevel(e)),!0!==a&&(n=Math.floor(n)),null==i&&(i=e.getView().heading);a=e.getMode(),r=kba.getViewportCenter(e,r,o),o=a.getCameraForLocationToPoint(t,r,l.toAltitude(t,n,!0),0,o);return new y(o,i)},kba.setZoomLevel=function(e,t,n,i){var a=kba.getMapCenter(e);kba.setMapCenter(e,a,t,null,n,i)},kba.zoomAroundLocation=function(e,t,n,i,a,r){var o,s=e.getMapOptions().navigationOptions;s&&s.lockCameraAltitude||!e.canZoom(n)||(s=(o=e.getMode()).tryLocationToPoint(t),r=o.getMapViewZoomedAboutLocation(e.getTargetView(),t,n,r),s=i?new pr(e,t,s):null,e.setView(r,s,a))},kba.centerMapIfPrimitiveOutOfView=function(e,t){var n=kba.getMapBounds(e,!0),t=t.geometry,t=new o(t.y,t.x);n.contains(t)||kba.setMapCenter(e,t,e.getMercatorZoomLevel())},kba.getZoomLevelForLocationsToBecomeVisible=function(e,t,n,i){if(!t||0===t.length)return null;for(var a,r=0,s=0,u=n||kba.getMapCenter(e),c=0,h=t.length;c<h;c++)r<(a=Math.abs(u.latitude-t[c].latitude))&&(r=a),s<(a=Math.abs(u.longitude-t[c].longitude))&&(s=a);try{var d=new o(u.latitude-r,u.longitude+s),p=new o(u.latitude+r,u.longitude+s),m=new o(u.latitude+r,u.longitude-s),g=new o(u.latitude-r,u.longitude-s),f=e.getMode().getMapViewForLocationsInView([m,g,d,p],i),_=l.fromLocation(f.cameraLocation,!0);return _<3?NaN:_}catch(e){return NaN}},kba._getColorMapping=function(e){switch(e){case 1:case 2:case 3:return e-1;case 7:return 3;case 4:return 4;case 8:return 5;default:return 0}},kba),rf=(D1a=dt,p(E1a,D1a),E1a.prototype.getCopyrightControl=function(){return this._coreConfig.useOverlayQuadrants&&this._mapOverlayManager?this._mapOverlayManager.getCopyrightControl():this._copyrightControl},E1a.prototype.getLogoControl=function(){return this._coreConfig.useOverlayQuadrants&&this._mapOverlayManager?this._mapOverlayManager.getLogoControl():this._logoControl},E1a.prototype.getSizeHelper=function(){return this._sizeHelper},E1a.prototype.getDefaultAerialZoomCutOffForBirdsEyeMode=function(){return this._coreConfig.aerialCutOffZoom},E1a.prototype.getId=function(){return this._id},E1a.prototype.getConfig=function(){return this._coreConfig},E1a.prototype.getDpiScale=function(){return this._tileDpiScale},E1a.prototype.getLabelDpiScale=function(){return this._labelDpiScale},E1a.prototype.getZoomOffset=function(){var e=this.getDpiScale();return 1<e?Math.floor(c.log2(e)):0},E1a.prototype.getLabelController=function(){return this._labelController},E1a.prototype.getNavigationBar=function(){return this._navigationBar},E1a.prototype.getScaleBar=function(){return this._coreConfig.useOverlayQuadrants&&this._mapOverlayManager?this._mapOverlayManager.getScaleBar():this._scaleBarControl},E1a.prototype.getMapOptions=function(){return this._mapOptions},E1a.prototype.getLayers=function(){return this._layers},E1a.prototype.getAllLayers=function(){return this._allLayers},E1a.prototype.getOverlays=function(){return this._overlayCollection},E1a.prototype.getMapOverlayManager=function(){return this._mapOverlayManager},E1a.prototype.getRootElement=function(){return this._rootElement},E1a.prototype.getContainer=function(){return this._container},E1a.prototype.getMapTypes=function(){return this._mapTypes},E1a.prototype.getLandmarksManager=function(){return this._landmarksManagerPromise},E1a.prototype.getOverlayManager=function(){return this._overlayManager},E1a.prototype.getCityPolygonManager=function(){return this._cityPolygonManagerPromise},E1a.prototype.getBirdseyeV2Manager=function(){return this._birdseyeV2ManagerPromise},E1a.prototype.isLocationInView=function(e){var t=this.getMode();return!(!e||!t)&&((e=t.tryLocationToPoint(e))&&0<=e.x&&e.x<=this.getActualSize().width&&0<=e.y&&e.y<=this.getActualSize().height)},E1a.prototype.getFrameManager=function(){return this._frameManager},E1a.prototype.isDisposed=function(){return this._isDisposed},E1a.prototype.isPanning=function(){return this._isPanning},E1a.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,D1a.prototype.dispose.call(this),this._viewStoryboard&&this._viewStoryboard.abort(),this._mapOverlayBehavior&&this._mapOverlayBehavior.detach(),this._overlayElement.clear()&&this._overlayElement.removeFromParent(),this._modeElement.clear()&&this._modeElement.removeFromParent(),this._rootElement.clear()&&this._rootElement.removeFromParent(),this._parentElement.clear(),(n.Browser.is_ie||n.Browser.is_edge)&&n(window).remove_event("beforeunload",this._beforeUnloadDummyHandler),this._pageHideHandler&&n(window).remove_event("pagehide",this._pageHideHandler),f._clearDisposables(this._disposables),f._nullifyClass(this))},E1a.prototype.getView=function(){return this._view},E1a.prototype.getTargetView=function(){return this._targetView},E1a.prototype.getViewport=function(){var e=this.getBounds(),t=this.getActualSize()||{width:0,height:0},n=t.width,t=t.height;return new u.Viewport(n,t,e.bounds,e.crs)},E1a.prototype.getMercatorZoomLevel=function(){return this._view?l.fromLocation(this._view.cameraLocation,!0):0},E1a.prototype.getBounds=function(e,t){var n=t||this.getView();if(!n)return new b(new o(0,0),0,0);var i=e?this.getViewportPadding():{left:0,right:0,top:0,bottom:0},a=this.getActualSize(),r=new h(i.left,i.top),s=new h(a.width-i.right,i.top),l=new h(a.width-i.right,a.height-i.bottom),u=new h(i.left,a.height-i.bottom),t=this.getMode(),u=0===n.heading?(e=t.tryPointToLocation(r,n),i=t.tryPointToLocation(l,n),b.fromCorners(e,i)):(new fi).accumulateLocations([t.tryPointToLocation(r,n),t.tryPointToLocation(s,n),t.tryPointToLocation(l,n),t.tryPointToLocation(u,n)]);return t.getTileSize&&(n=this.getMercatorZoomLevel(),t=Math.pow(2,n)*t.getTileSize().width,a.width>t&&(u=b.fromEdges(u.getNorth(),-180,u.getSouth(),180))),u=u.width<=1e-9?b.fromEdges(u.getNorth(),-180,u.getSouth(),180):u},E1a.prototype.getCopyrights=function(e){var t=this.getMode();t&&t.getCopyrights(e)},E1a.prototype.getIsMapHitTestable=function(){return this._mapOptions&&this._mapOptions.testHooksOptions&&this._mapOptions.testHooksOptions.hitTest},E1a._getBootstrapLocation=function(){var e,t=i.dynamicProperties,n=t.location;if(!(n&&"0,0"!==n||(n=t.reverseIPLocation))){var a=ui,s=parseFloat(a.getItem("centerLatitude")),u=parseFloat(a.getItem("centerLongitude"));if(isFinite(s)&&isFinite(u)){if(e=parseFloat(a.getItem("zoom")),isFinite(e))return a=l.toAltitude(new o(s,u),e,!0),{center:new o(s,u,a),zoom:e};n=s+","+u}else n=t.marketLocation,r.assert(!!n,"unable to determine bootstrap location"),n=n||"47.603569,-122.329453"}return{center:o.parseLatLong(n),zoom:t.zoom}},E1a.prototype.setView=function(e,i,a,t){function o(e){return u.ZoomAroundLocationAnimator&&e instanceof u.ZoomAroundLocationAnimator}var s,l,c,h,d,p,m;this._isDisposed||(r.assertNotNull(e,"mapView"),r.assertNotNull(e.cameraLocation,"mapView.cameraLocation"),r.assert(-1!==e.cameraLocation.altitudeReference,"Invalid AltitudeReference"),s=this,(1===(a=a||0)||2===a)&&this._mapOptions&&this._mapOptions.navigationOptions&&((p=this._mapOptions.navigationOptions).lockCameraAltitude&&(e.cameraLocation.altitude=this._targetView.cameraLocation.altitude,e.cameraLocation.altitudeReference=this._targetView.cameraLocation.altitudeReference),this._enforceMinMaxAltitude(e),p.lockCameraHeading&&(e.heading=this._targetView.heading)),!t&&y.areEqual(e,this._targetView))||(this._view=this._view||e,(h=this._getConstrainViewArgs(e,a)).cancel)||(l=this._view,c=e,i&&(this._workDispatcher&&this._workDispatcher.cancelAllDispatch(),l=l.clone(),c=c.clone(),m=l.cameraLocation.longitude,d=c.cameraLocation.longitude,180<Math.abs(m-d)&&(m<0?d-=360:d+=360,c.cameraLocation.longitude=d)),this._workDispatcher&&this._workDispatcher.cancelDispatchWithKey(E1a._animationFrameWorkDispatcherKey,0),m=p=0,(d=this._viewStoryboard)&&(m=d.get_duration(),p=(1-d.get_position())*m,d.abort(),this._viewStoryboard=null),e=h.view,h=this._targetView,this._targetView=e,h&&e&&h.cameraLocation&&e.cameraLocation&&(y.areCameraAltitudesEqual(h,e)||this.mapZoomChanged.invoke()),this.changed.invoke(new yt(this,"targetView",h,e)),this.targetViewChanged.invoke(new nf(a,i)),h=i?i.duration:0,m=Math.max(m,E1a._viewChangeMaxPercent*h),m=Math.min(p+h,m),i&&0<m?(this._viewStoryboard=n.Effects.Storyboard.create([this],{percent:0},{percent:1},function(e,t){r.groupCollapsed(null,"Animation frame: {0}",t.percent.toString()),t=i.interpolate(l,c,t.percent),s._view,s._view=t,s._raiseViewChangingEvent(new pt(a,!0)),o(i)&&s.mapZoomContinued.hasHandlersRegistered()&&s.mapZoomContinued.invoke(new li(s,i)),r.groupEnd()},m,null,function(){s._workDispatcher.dispatch(function(){var e=s._view;s._view=s._targetView,s._saveView(),s.changed.invoke(new yt(s,"view",e,s._view)),s.viewChanged.invoke(new pt(a)),o(i)&&s.mapZoomStopped.hasHandlersRegistered()?s.mapZoomStopped.invoke(new li(s,i)):(e=s.getFrameManager())&&e.hackHackSetFrame(t),s.copyrightChanged&&s.copyrightChanged.invoke()},E1a._animationFrameWorkDispatcherKey,0)},function(e){return e},E1a._animationInterval),this._viewStoryboard.begin(),o(i)&&this.mapZoomStarted.hasHandlersRegistered()&&this.mapZoomStarted.invoke(new li(this,i))):(m=this._view,this._view=e,this.changed.invoke(new yt(this,"view",m,e)),this._raiseViewChangingEvent(new pt(a,!0)),2!==a&&(this.viewChanged.invoke(new pt(a)),this.copyrightChanged&&this.copyrightChanged.invoke(),this._saveView(),this._coreConfig.disableHachHackSetFrame||(e=this.getFrameManager())&&e.hackHackSetFrame(t))))},E1a.prototype.canZoom=function(e){if(this._isDisposed)return!1;var t=this.getMode(),n=this.getTargetView(),i=n.cameraLocation,e=t.getMapViewZoomedAboutLocation(n,i,e),e=this._getConstrainViewArgs(e).view;return this._enforceMinMaxAltitude(e),!y.areCameraAltitudesEqual(n,e)},E1a.prototype.getMapType=function(){return this._mapType},E1a.prototype.setMapType=function(e){"string"==typeof e&&(e=this._resolveMapType(e)),this._isDisposed||e===this._mapType||(this._mapType,this.setBaseLayers(this._resolveMapType(e)))},E1a.prototype.createMapType=function(e){return this._resolveMapType(e)},E1a.prototype.getTemplateSelector=function(){return this._mapType&&this._mapType.getTemplateSelector()},E1a.prototype.setMinZoom=function(e,t,n){var i,a;if("number"==typeof e){if(!1!==t&&(t=!0),e=Math.round(e),i=l.toAltitude(new o(0,0),e,!0),"number"==typeof(a=this._mapOptions.navigationOptions.minCameraAltitude)&&i<a)throw new Error("minZoom to set is greater than map's currently allowed maximum zoom level");!1!==n&&(this._mapOptions.minZoom=e),this._mapOptions.navigationOptions.maxCameraAltitude=i,t&&this._targetView.cameraLocation.altitude>i&&((t=this._targetView.cameraLocation.clone()).altitude=i,this.setView(new y(t)))}},E1a.prototype.setMaxZoom=function(e,t){var n,i;if("number"==typeof e){if(!1!==t&&(t=!0),e=Math.round(e),n=l.toAltitude(new o(0,0),e,!0),"number"==typeof(i=this._mapOptions.navigationOptions.maxCameraAltitude)&&i<n)throw new Error("maxZoom to set is smaller than map's currently allowed minimal zoom level");this._mapOptions.maxZoom=e,this._mapOptions.navigationOptions.minCameraAltitude=n,t&&this._targetView.cameraLocation.altitude<n&&((t=this._targetView.cameraLocation.clone()).altitude=n,this.setView(new y(t)))}},E1a.prototype.setMaxBounds=function(e,t){var n;!1!==t&&(t=!0),n=this.getMode().getMapViewForLocationsInView([new o(e.getNorth(),e.getEast()),new o(e.getSouth(),e.getWest())]),"number"!=typeof this._mapOptions.minZoom&&this.setMinZoom(l.fromLocation(n.cameraLocation,!0),!1,!1),this._mapOptions.maxBounds=e,t&&(this._view?(t=this._getConstrainViewArgs(this._view.clone(),0),this.setView(t.view)):this.setView(n))},E1a.prototype.setMapLayerHighlight=function(e,t){for(var n,i=!1,a=0;a<this._layers.length;a++)if((n=this._layers[a]).getId()===e){i=!0,n.setHighlighted(t);break}return i},E1a._initializeMapOptions=function(e,t){var n=(e=e||{credentials:null}).labelOptions=e.labelOptions||{},i=e.navigationOptions=e.navigationOptions||{};if(e.trafficOptions=e.trafficOptions||{},e.showCopyright="boolean"!=typeof e.showCopyright||e.showCopyright,e.liteMode=("boolean"==typeof e.liteMode?e:t).liteMode,"number"==typeof i.minZoomFraming||(i.minZoomFraming=3),"boolean"!=typeof i.lockCameraHeading&&(i.lockCameraHeading=!0),void 0!==e.disableStreetside&&null!==e.supportedMapTypes||(e.disableStreetside=!1),e.showDashboard="boolean"!=typeof e.showDashboard||e.showDashboard,e.showScalebar="boolean"!=typeof e.showScalebar||e.showScalebar,e.mapType&&!s.isValid(e.mapType))throw new Error("Invalid map type");return void 0===n.labelVisibility&&(n.labelVisibility=wt.visible),e.liteMode||(n.testRenderStyles=!1),e.tileDomainName=e.tileDomainName||t.tfeDomainDynamic,e.supportedMapTypes||(e.supportedMapTypes=[s.road,s.aerial,s.birdseye,s.streetside,s.ordnanceSurvey],f._isFeatureEnabled("birdseyeV2UI")&&e.supportedMapTypes.splice(2,1,s.birdseyeV2)),e.liteMode&&(e.showLandmarks=!1),e},E1a.prototype._raiseViewChangingEvent=function(e){this.viewChanging.invoke(e),this._previousViewChangeArg=e,this._onPaintEventHandler||this._raiseViewChangingAfterPaintEvent()},E1a.prototype._raiseViewChangingAfterPaintEvent=function(){this._previousViewChangeArg&&(this.viewChangingAfterPaint.invoke(this._previousViewChangeArg),this._previousViewChangeArg=null)},E1a.prototype._getDefaultSize=function(e){var t,n,a,r;if(i.isMapsVertical)return new nt(-1,-1);for(a=e;0<a.length&&("HTML"!==a[0].tagName&&(-1!==t||-1!==n));)"function"==typeof Element&&a[0]instanceof Element?(0<parseFloat(a.get_style("width"))&&(t=-1),0<parseFloat(a.get_style("height"))&&(n=-1)):(0<(r=a.get_size()).width&&(t=-1),0<r.height&&(n=-1)),a=a.parent();return new nt(t=-1===t?t:-2,n=-1===n?n:-2)},E1a.prototype._resolveMapType=function(e,t){var n;return this._isDisposed?null:(n=t=t||this.getMapTypes()[s.road],"string"==typeof e?!(t=this._mapTypes[e])||(e===s.ordnanceSurvey&&i.features.ordnanceSurvey.isEnabled||e!==s.ordnanceSurvey)&&(n=t):n=e,n)},E1a.prototype._setViewportPadding=function(e){return{left:(e=e||{}).left||0,top:e.top||0,right:e.right||0,bottom:e.bottom||0}},E1a.prototype._saveView=function(){var e,t;this._isDisposed||(e=this.getView().cameraLocation,t=this._coreConfig.locateMeViewExpirationDays,ui.setItem("centerLatitude",e.latitude.toString(),t),ui.setItem("centerLongitude",e.longitude.toString(),t),ui.setItem("zoom",this.getMercatorZoomLevel().toString(),t))},E1a.prototype._onMapTypeChanged=function(e,t){var n;if(!t||!s.isValid(t.id))throw new Error("Map._onMapTypeChanged trying to set map type to unsupported value");t.id!==s.road||!f._isHighContrastMode()||(n=this.getMapTypes().find(function(e){return e.id===s.highContrast}))&&(t=n),this._mapType=t,e&&t&&e.id&&t.id&&this.mapTypeChangeStarted.invoke(new yr(e.id,t.id)),this._allLayers.setBaseLayers(t),e&&t&&e.id&&t.id&&this.mapTypeChanged.invoke(new yr(e.id,t.id)),this._view&&(n=this.getMercatorZoomLevel(),e=null,t=this._view.cameraLocation,n<this._mapType.minZoom?e=l.toAltitude(t,this._mapType.minZoom,!0):n>this._mapType.maxZoom&&(e=l.toAltitude(t,this._mapType.maxZoom,!0)),e&&(t=new o(t.latitude,t.longitude,e,t.altitudeReference),t=new y(t,this._view.heading),this.setView(t)))},E1a.prototype._onMapModePaint=function(){var e,t=this;r.logDebugData("Map - onMapModePaint"),e=function(){t._modePaintHandler&&(t._modeElement.fadeToChild(t.getMode().getRootElement()),t.modeDOMsMounted.invoke(t.getMode().mapModeType),t._modePaintHandler.dispose(),t._modePaintHandler=null,t._frameRenderedHandler&&t._frameRenderedHandler.dispose(),t._frameFailedHandler&&t._frameFailedHandler.dispose())},this._frameManager&&(this._frameManager.frameRendered.isPreviouslyInvoked||this._frameManager.frameFailed.isPreviouslyInvoked?e():this._frameRenderedHandler||(this._frameRenderedHandler=this._frameManager.frameRendered.addOne(e),this._frameFailedHandler=this._frameManager.frameFailed.addOne(e)))},E1a.prototype._instantiateMapInCompositeMapMode=function(a){var o=this,l=this.getContainer();l.instanceAsync("CompositeMapMode",function(e){function t(){o._instantiateFrameManager(),o._disposables.push(o._modePaintHandler=e.onFrameRendered.addOne(function(){return o._onMapModePaint()})),o._targetView||o.setView(a,null,3)}function n(e){o._disposables.push(e),o._birdseyeV2ManagerPromise.resolve(e),o._mapType.id===s.birdseyeV2&&e.onMapTypeChanged({oldMapTypeId:null,newMapTypeId:s.birdseyeV2}),i&&t()}var i=!!u.BirdseyeV2Manager;o._instrumentationManager.setMapMode(e),r.logDebugData("Map - Composite Map mode ctor: mapMode.onPaint "+e.onPaint),o.setMode(e),o._view=o._view||a,i?n(new u.BirdseyeV2Manager(o)):(t(),o._frameManager.frameRendered.addOne(function(){l.instanceAsync("BirdseyeV2Manager",n,{Map:o})}))},void 0,!i.isMapsVertical)},E1a.prototype._instantiateMapInStreetsideMapMode=function(n){var r=this;this._view=this._targetView=n,this.getContainer().instanceAsync("StreetsideModeBootstrapper",function(a){var e=r._mapOptions.streetsideOptions||{},t=r._mapOptions.streetsideOptions&&r._mapOptions.streetsideOptions.panoramaInfo;a.isAvailable(t||r.getView().cameraLocation,function(e){var t=r._mapOptions.streetsideOptions||{},n=new lr({mapType:s.streetside,templateName:"097A0D85-2585-425A-8471-60BDD3C5B7C3",data:[],minZoom:18,maxZoom:23,mapTypeEnabled:!0},r._mapOptions,0);r._disposables.push(n),r._mapType=n,r._instantiateFrameManager(),t.zoomIn=!0,t.entryPoint=i.isMapsVertical?"Permalink":"SDK",t.perfClickToImmersionTimeSource="SS_PCI",t.heading=r._mapOptions.heading,t.pitch=r._mapOptions.pitch,a.show(e,t)},function(){r._mapOptions.mapTypeId=s.road,r.setBaseLayers(r._resolveMapType(s.road,r.getMapTypes()[s.road])),r._instantiateMapInCompositeMapMode(n),e.onErrorLoading&&e.onErrorLoading()},e)},void 0,!i.isMapsVertical)},E1a.prototype._instantiateFrameManager=function(){var e,n=this;0===this._bootstrapState&&(this._onFrameManagerLoaded(new ti(this,this._allLayers)),e=i.features.labels.glLabelAndPoi?"LabelControllerGL":"LabelController",this._container.instanceAsync(e,function(e){var t;n._isDisposed||(n._labelController=e,n._disposables.push(n._labelController),n._labelController.attach(n),n.labelControllerLoaded.invoke(),t=n._mapOptions.labelOptions.labelVisibility===wt.visible||n.getMapType().id===s.road&&!n._mapOptions.allowHidingLabelsOfRoad,n._labelController.setIsLabelsEnabled(t),n.navigationBarLoaded.addOne(function(){return n.getNavigationBar().getHelper().setLabelVisible(t)},!1,!0),r.logDebugData("Map - onMapModePaint - LabelController created"))},{CoreConfig:this._coreConfig},!1,function(e,t){console.log(t)}),this._bootstrapState=1)},E1a.prototype._onFrameManagerLoaded=function(e){var t=this;this._isDisposed||(this._frameManager=e,this._disposables.push(this._frameManager),this.frameManagerLoaded.invoke(this._frameManager),this._disposables.push(this._frameManager.frameRendered.addOne(function(){return t._postInit()})),this._disposables.push(this._frameManager.frameFailed.addOne(function(){return t._postInit()})),this._frameManager.initializeLayers(),r.logDebugData("Map - onMapModePaint - MapFrameManager created"),i.isMapsVertical?this._container.downloadDependencyAsync("TransientLens"):this._disposables.push(this._frameManager.dataLoaded.addOne(function(){t._container.downloadDependencyAsync("MapInteraction")})))},E1a.prototype._postInit=function(){var n=this;r.logDebugData("Map - postInit"),2!==this._bootstrapState&&(this._container.instanceAsync("BrowserKeyProvider",function(e){n._disposables.push(e)}),this._container.instanceAsync("BrowserPointerProvider",function(e){n._disposables.push(e)}),this._container.instanceAsync("GlobalDataEventHandler",function(){var e=i.features.streetside;!n.getMapOptions().disableStreetsideAutoCoverage&&e&&e.isEnabled&&n._container.instanceAsync("StreetsideAutoEntryBehavior",null,{Map:n})}),this._overlayCollection=new rt,this._container.instanceAsync("OverlayManager",function(e){e.getRootElement().appendTo(n._overlayElement),r.logDebugData("Map - postInit - Overlay Manager created"),n._overlayManager.resolve(e)}),this._mapOptions&&!1!==this._mapOptions.showLandmarks&&this._container.instanceAsync("LandmarksManager",function(e){n._isDisposed||(e.selectorReady(),n._disposables.push(n._landmarksManager=e),n._landmarksManagerPromise.resolve(e))},{map:this,coreConfig:this._coreConfig,container:this._container}),this._bootstrapState=2,0===this.getMode().mapModeType&&this._postInitForCompositeMode(),this._container.instanceAsync("CityPolygonManager",function(e){var t;n._isDisposed||(n._disposables.push(n._cityPolygonManager=e),n._cityPolygonManagerPromise.resolve(e),(t=f._getPolygonId())&&n._cityPolygonManager.addLayer(t,7,17),n._disposables.push(e))},{map:this,coreConfig:this._coreConfig}))},E1a.prototype._postInitForCompositeMode=function(){var e,t=this;this._haveCalledPostInitForCompositeMode||(this._haveCalledPostInitForCompositeMode=!0,this._mapOptions.maxBounds&&this.setMaxBounds(this._mapOptions.maxBounds),"boolean"==typeof this._mapOptions.hideNavBar&&this._mapOptions.hideNavBar||this._createNavigationBar(),this._coreConfig.useOverlayQuadrants?this._container.instanceAsync("MapOverlayManager",function(e){t._disposables.push(t._mapOverlayManager=e)},{Map:this,RootElement:this._overlayElement}):(this._mapOptions&&this._mapOptions.showLogo&&(e=void 0===this._mapOptions.enableClickableLogo||this._mapOptions.enableClickableLogo,this._container.instanceAsync("LogoControl",function(e){t._logoControl=e,t._disposables.push(e),t._container.instanceAsync("LogoOverlay",function(e){t.getOverlays().insert(e)},{LogoControl:e})},{Map:this,Clickable:e})),this._createCopyrightControl(),this._createScaleBar()))},E1a.prototype._createNavigationBar=function(){var t=this;this._container.instanceAsync("NavigationBar",function(e){r.logDebugData("Map - postInit - Navigation Bar created"),t._navigationBar=e,t._disposables.push(t._navigationBar,e.mapTypeButtonClicked.add(function(e){return t.mapTypeButtonClicked.invoke(e)})),t.navigationBarLoaded.invoke(),t._container.instanceAsync("NavigationBarOverlay",function(e){t.getOverlays().insert(e)},{NavigationBar:e})},{Map:this,CoreConfig:this._coreConfig,DragonflyContainer:this._container})},E1a.prototype._createCopyrightControl=function(){var e,t=this;this._mapOptions.showCopyright&&(e=!(!this._mapOptions||!this._mapOptions.showTermsLink)&&this._mapOptions.showTermsLink,this._container.instanceAsync("CopyrightControl",function(e){t._copyrightControl=e,t._disposables.push(e),t._container.instanceAsync("CopyrightOverlay",function(e){t.getOverlays().insert(e),t.copyrightControlLoaded.invoke(t._copyrightControl)},{CopyrightControl:e})},{Map:this,CoreConfig:this._coreConfig,ShowTermsLink:e}))},E1a.prototype._createScaleBar=function(){var t=this;this._mapOptions.showScalebar&&this._container.instanceAsync("ScaleBar",function(e){t._scaleBarControl=e,t._disposables.push(t._scaleBarControl),t._container.instanceAsync("ScaleBarOverlay",function(e){t.getOverlays().insert(e)},{ScaleBar:e})},{Map:this})},E1a.prototype._onModeChanged=function(e,t){var n=this,i=null,a=e&&e.mapModeType,o=t&&t.mapModeType;a!==o&&(i={oldMode:a,newMode:o},this._disposables.indexOf(t)<0&&this._disposables.push(t)),i&&this.mapModeChanged.invoke(i),e&&e.deactivated&&e.deactivated(),r.logDebugData("Map - onModeChanged event"),0!==this._bootstrapState&&(this._modeElement.fadeToChild(t.getRootElement()),this.modeDOMsMounted.invoke(t.mapModeType)),t&&t.activated&&t.activated(),this.copyrightChanged&&this.copyrightChanged.invoke(),this._onPaintEventHandler&&(this._onPaintEventHandler.dispose(),this._onPaintEventHandler=null),t&&t.onPaint&&(this._onPaintEventHandler=t.onPaint.add(function(){return n._raiseViewChangingAfterPaintEvent()})),0===t.mapModeType&&2===this._bootstrapState&&this._postInitForCompositeMode(),2===t.mapModeType?this._overlayElement&&this._overlayElement.set_style({transform:""}):this._overlayElement&&this._overlayElement.set_style({transform:"scale(1)"})},E1a.prototype._onActualSizeChanged=function(e,t){var n=this,i=t&&t.width,t=t&&t.height;0<i&&0<t&&Microsoft.Maps.setAsync(function(){var e;n._targetView&&(n._mapOptions.maxBounds&&n.setMaxBounds(n._mapOptions.maxBounds,!1),e=n._getConstrainViewArgs(n._targetView,1),n.setView(e.view),n.actualSizeChanged.invoke())})},E1a.prototype._onDesiredSizeChanged=function(e,t){var n,a,r=t&&t.width,o=t&&t.height;if(i.isMapsVertical||(0<this._parentElement.length&&"function"==typeof Element&&this._parentElement[0]instanceof Element?(n=parseFloat(this._parentElement.get_style("width")),t=parseFloat(this._parentElement.get_style("height")),0===n&&this._parentElement.set_style({width:"100%"}),0===t&&this._parentElement.set_style({height:"100%"})):(0===(a=this._parentElement.get_size()).width&&this._parentElement.set_style({width:"100%"}),0===a.height&&this._parentElement.set_style({height:"100%"}))),o={position:(a=-1===r||-1===o)?"absolute":"relative",width:-1===r?"100%":-2===r?"100vw":r+"px",height:-1===o?"100%":-2===o?"100vh":o+"px"},a){switch(this._parentElement.get_style("position")){case"relative":case"absolute":break;default:this._parentElement.set_style({position:"relative"})}o.top=o.left=0}this._rootElement.set_style(o),this._sizeHelper.pollSize()},E1a.prototype._getConstrainViewArgs=function(e,t){t=new ou(e,t);return this.constrainView.invoke(t),t},E1a.prototype._enforceMinMaxAltitude=function(e){var t=this._mapOptions.navigationOptions;"number"==typeof t.minCameraAltitude&&(e.cameraLocation.altitude=Math.max(t.minCameraAltitude,e.cameraLocation.altitude)),"number"==typeof t.maxCameraAltitude&&(e.cameraLocation.altitude=Math.min(t.maxCameraAltitude,e.cameraLocation.altitude))},E1a.prototype._onDisplayTileBoundariesChanged=function(){},E1a.prototype.getLogoEnd=function(){var e,t=0;return this._logoControl&&((e=this._logoControl.getRootElement())&&(t=e.get_relative_pos().x+e.get_size().width)),t},E1a.prototype._updateMapOptions=function(e,t){for(var n,i,a,r,o,l=Object.keys(t),u=0,c=l.length;u<c;u++)i=t[n=l[u]],"disableStreetside"===n&&this._containsOption(e,n)||(i&&"object"==typeof i?(e[n]||(e[n]={}),this._updateMapOptions(e[n],i)):e[n]=t[n],"customMapStyle"===n&&(this._mapTypes.updateCustomMapStyle(i),e[n]=t[n],this.getMode()&&this.setView(new y(this._view.cameraLocation),null,0,!0)));this._navigationBar&&((o=r=a=!1)!==e.showDashboard&&(a=!e.disableZooming&&!1!==e.showZoomButtons,r=!1!==e.showMapTypeSelector,o=this._mapType.id!==s.birdseyeV2&&!1!==e.showLocateMeButton),this._navigationBar.setZoomInButtonVisible(a),this._navigationBar.setZoomOutButtonVisible(a),this._navigationBar.setMapStyleSelectorControlVisible(r),this._navigationBar.setLocateMeButtonVisible(o)),"boolean"!=typeof t.disableScrollWheelZoom&&"boolean"!=typeof t.disableKeyboardInput||this.interactionModeUpdated.invoke()},E1a.prototype._containsOption=function(e,t){return void 0!==e[t]},E1a.prototype._processNavigationBarMapOptions=function(){var e=this.getMapOptions();e.navigationBarMode=void 0===e.navigationBarMode?i.isMobile?ut.compact:ut.default:e.navigationBarMode,e.showMapTypeSelector=void 0===e.showMapTypeSelector||e.showMapTypeSelector,e.showZoomButtons=void 0===e.showZoomButtons||e.showZoomButtons;var t=void 0===e.showLocateMeButton,n=void 0===e.showTrafficButton,a=void 0===e.navigationBarOrientation;switch(e.navigationBarMode){case ut.compact:e.showLocateMeButton=!t&&e.showLocateMeButton,e.showTrafficButton=!n&&e.showTrafficButton,e.navigationBarOrientation=a?lt.horizontal:e.navigationBarOrientation;break;case ut.minified:e.showLocateMeButton=!t&&e.showLocateMeButton,e.showTrafficButton=n||e.showTrafficButton,e.navigationBarOrientation=a?lt.vertical:e.navigationBarOrientation;break;default:e.showLocateMeButton=t||e.showLocateMeButton,e.showTrafficButton=!n&&e.showTrafficButton,e.navigationBarOrientation=a?lt.vertical:e.navigationBarOrientation}e.disableBirdseye=void 0!==e.disableBirdseye&&e.disableBirdseye,this._processTrafficOptions()},E1a.prototype._processTrafficOptions=function(){var e=this.getMapOptions().trafficOptions,t=i.features.traffic;e&&t&&(e.opacity=void 0===e.opacity?this.getConfig().liteMode?t.defaultTrafficLayerOpacityLiteMode:t.defaultTrafficLayerOpacity:e.opacity,e.incidentsVisible=void 0===e.incidentsVisible||e.incidentsVisible,e.flowVisible=void 0===e.flowVisible||e.flowVisible,e.legendVisible=void 0!==e.legendVisible&&e.legendVisible)},E1a.prototype._processDpiOptions=function(){var e,t=1;(this._coreConfig.allowHighDpi||this._coreConfig.allowHybridHighDpi)&&(!(e="boolean"!=typeof(e=this._mapOptions.enableHighDpi)?1.5<=f._getDpr():e)||this._coreConfig.allowHighDpi&&(t=2)),this._tileDpiScale=t,this._labelDpiScale=1},E1a.prototype._beforeUnloadDummyHandler=function(){},E1a.prototype._AuthenticateMap=function(){var e=this,t=new ii(this._mapOptions&&this._mapOptions.credentials,!1,this);this._disposables.push(t.onAuthBasedFeatureEnabled.addOne(function(){e.setView(e.getView(),null,0,!0)})),t.authenticateClientAndRetrieveSessionId(null)},E1a.DEFAULT_ZOOM_CUT_OFF_FOR_AERIAL_MODE=21,E1a._nextMapId=1,E1a._animationInterval=15,E1a._animationFrameWorkDispatcherKey="animationFrame",E1a._viewChangeMaxPercent=1.5,E1a),wt;xea=wt=wt||{},xea[xea.hidden=0]="hidden",xea[xea.visible=1]="visible",yea=ut=ut||{},yea[yea.default=0]="default",yea[yea.compact=1]="compact",yea[yea.minified=2]="minified",yea[yea.square=3]="square",zea=lt=lt||{},zea[zea.vertical=0]="vertical",zea[zea.horizontal=1]="horizontal",Aea.minimized=0,Aea.expanded=1,Aea.hidden=2,wr=Aea,Bea=ai=ai||{},Bea[Bea.topLeft=0]="topLeft",Bea[Bea.TopLeft=0]="TopLeft",Bea[Bea.bottomLeft=1]="bottomLeft",Bea[Bea.BottomLeft=1]="BottomLeft",Bea[Bea.topRight=2]="topRight",Bea[Bea.TopRight=2]="TopRight",Bea[Bea.bottomRight=3]="bottomRight",Bea[Bea.BottomRight=3]="BottomRight",Bea[Bea.none=4]="none",Bea[Bea.None=4]="None";var uf=(Cea.prototype.hasValueAt=function(e){return this._multiplier.hasValueAt(e)},Cea.prototype.getHasValue=function(){return this._multiplier.getHasValue()},Cea.prototype.evaluate=function(e){return this._multiplier.evaluate(e)},Cea),ff=(Gea.prototype.hasValueAt=function(e){return this.getHasValue()&&(this._hue.hasValueAt(e)||this._saturation.hasValueAt(e)||this._luminance.hasValueAt(e)||this._alpha.hasValueAt(e))},Gea.prototype.getHasValue=function(){return this._hue&&this._hue.getHasValue()||this._saturation&&this._saturation.getHasValue()||this._luminance&&this._luminance.getHasValue()||this._alpha&&this._alpha.getHasValue()},Gea.prototype.evaluate=function(e){return{x:this._hue?this._hue.evaluate(e)/360:0,y:this._saturation?this._saturation.evaluate(e):0,z:this._luminance?this._luminance.evaluate(e):0,w:this._alpha?this._alpha.evaluate(e):0}},Gea),r=(Nea.assertNotNull=function(e,t){Nea.assert(0===e||e||!1===e,t+" cannot be null")},Nea.assertNotNullOrEmpty=function(e,t){Nea.assertNotNull(e,t),Nea.assertIsString(e,t),Nea.assert(0<e.length,t+" cannot be an empty string")},Nea.assertInstanceOf=function(e,t,n){Nea.assertNotNull(t,"ctor"),Nea.assert(e instanceof t,n+" must be an instance of "+Nea.getName(t))},Nea.assertIsString=function(e,t){Nea.assert("string"==typeof e,t+" must be a string")},Nea.assertIsFunction=function(e,t){Nea.assert("function"==typeof e,t+" must be a function")},Nea.assertIsInteger=function(e,t){Nea.assert("number"==typeof e&&e%1==0,t+" must be an integer")},Nea.assert=function(){},Nea.logObject=function(e,t,n){var i,a;if(Nea.isDebugRun)try{console&&void 0!==console.log&&(a=t,a+=": %O",console.log.apply(console,[a,n]))}catch(e){}!window.perfRun||(i=Nea._getCurrentGroupinMainStack())&&(a=null,a=window.verbose?Nea._formatLogString(t):Nea._formatLogString(e),i[Nea._getLogKey(i)+"__"+a]=n)},Nea.log=function(e){for(var t,n,i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];if(Nea.isDebugRun)try{console&&void 0!==console.log&&(n=f._formatString.apply(null,Array.prototype.slice.call(arguments,1)),console.log.apply(console,[n]))}catch(e){}!window.perfRun||(t=Nea._getCurrentGroupinMainStack())&&(n=null,window.verbose?(n=f._formatString.apply(null,Array.prototype.slice.call(arguments,1)),n=Nea._formatLogString(n),t[Nea._getLogKey(t)]=n):e&&(Array.prototype.splice.call(arguments,1,1),n=f._formatString.apply(null,arguments),n=Nea._formatLogString(n),t[Nea._getLogKey(t)]=n))},Nea.throwException=function(e){throw e},Nea.trace=function(){if(Nea.isDebugRun)try{var e=window.console;e&&void 0!==e.trace&&e.trace.apply(e)}catch(e){}},Nea.profile=function(e){if(Nea.isDebugRun||window.perfRun)try{console&&void 0!==console.profile&&console.profile.apply(console,[e])}catch(e){}},Nea.profileEnd=function(){if(Nea.isDebugRun||window.perfRun)try{console&&void 0!==console.profileEnd&&console.profileEnd.apply(console)}catch(e){}},Nea.time=function(n){if(Nea.isDebugRun||window.perfRun)try{var i=window.console;(i&&void 0===i.time||window.perfRun)&&(i.time=function(e){var t;n&&(t=Nea._getEpochTime(),i.timeHash||(i.timeHash={}),e="timeKey_"+e.toString(),i.timeHash[e]=t)}),i.time.apply(i,[n])}catch(e){}},Nea.timeEnd=function(e){if(Nea.isDebugRun||window.perfRun)try{var i=window.console;(i&&void 0===i.timeEnd||window.perfRun)&&(i.timeEnd=function(e){var t,n=Nea._getEpochTime();i.timeHash&&(t="timeKey_"+e.toString(),(t=i.timeHash[t])&&Nea.logString(e+": "+(n-t)+"ms"))}),i.timeEnd.apply(i,[e])}catch(e){}},Nea.timeStamp=function(e){if(Nea.isDebugRun||window.perfRun)try{var t=window.console;t&&void 0!==t.timeStamp&&t.timeStamp.apply(t,[e])}catch(e){}},Nea.group=function(e){for(var t,n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(Nea.isDebugRun)try{var a=window.console,r=Nea._getEpochTime().toString(),o=f._formatString.call(null,Array.prototype.slice.call(arguments,1));a&&void 0!==a.group?(a.group.apply(a,[o]),Nea.logString("Group start Timestamp: "+r)):a.log.apply(a,[o])}catch(e){}window.perfRun&&(r=Nea._getMainPerfStack(),(a=Nea._getCurrentGroupinMainStack())&&(o=null,window.verbose?(o=f._formatString.apply(null,Array.prototype.slice.call(arguments,1)),o=Nea._formatLogString(o),a[o=Nea._getLogKey(a)+"__"+o]=t={},r.push(t)):e?(Array.prototype.splice.call(arguments,1,1),o=f._formatString.apply(null,arguments),o=Nea._formatLogString(o),a[o=Nea._getLogKey(a)+"__"+o]=t={},r.push(t)):r.push(null)))},Nea.groupEnd=function(){var e,t;if(Nea.isDebugRun)try{t=Nea._getEpochTime().toString(),(e=window.console)&&void 0!==e.groupEnd&&(Nea.logString("Group End Timestamp: "+t),e.groupEnd.apply(e))}catch(e){}window.perfRun&&((e=Nea._getMainPerfStack())&&Nea._getLastElement(e)&&window.verbose&&(t=Nea._getEpochTime().toString(),Nea.logString("Group End Timestamp: "+t)),e.pop())},Nea.groupCollapsed=function(e){for(var t,n,i,a,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(Nea.isDebugRun)try{n=Nea._getEpochTime().toString(),(t=window.console)&&void 0!==t.groupCollapsed&&(i=f._formatString.apply(null,Array.prototype.slice.call(arguments,1)),t.groupCollapsed.apply(t,[i]),Nea.logString("Group start Timestamp: "+n))}catch(e){}window.perfRun&&(t=Nea._getMainPerfStack(),(n=Nea._getCurrentGroupinMainStack())&&(i=null,window.verbose?(i=f._formatString.apply(null,Array.prototype.slice.call(arguments,1)),i=Nea._formatLogString(i),n[i=Nea._getLogKey(n)+"__"+i]=a={},t.push(a)):e?(Array.prototype.splice.call(arguments,1,1),i=f._formatString.apply(null,arguments),i=Nea._formatLogString(i),n[i=Nea._getLogKey(n)+"__"+i]=a={},t.push(a)):t.push(null)))},Nea.setPerfRun=function(e,t){window.perfRun=e,window.verbose=t,Nea.setupPerfObject()},Nea.setDebugRun=function(e){Nea.isDebugRun=e},Nea.getName=function(e){e=/function (.{1,})\(/.exec(e.toString());return e&&1<e.length?e[1]:"Unknown"},Nea.setTestHook=function(e,t,n){this._logElement=f._createElement("div").set_attr("id","testHook").appendTo(e),this._debugElement=f._createElement("div").set_attr("id","debugHook").appendTo(e),this._perfTestHookElement=f._createElement("div").set_attr("id","perfTestHook").appendTo(e),this.enableFunctionalTestHooks=!0,Nea._setMap(n),"undefined"!=typeof FunctionalTestHooks&&FunctionalTestHooks.setTestHookSettings(u,t,f._getUrlParam,pi.fromString)},Nea._setMap=function(e){this.enableFunctionalTestHooks&&(!window.$map||window.$map.isDisposed?(Nea._map=window.$map=e,window.$map.frameManagerLoaded.addOne(function(){window.$map.getFrameManager().primitivesRendered.addOne(function(){window.$mapLoaded=!0})})):e.getMapOptions().navigationOptions&&e.getMapOptions().navigationOptions.lockCameraAltitude&&(window.$overviewMap=e))},Nea.setLabelLogElement=function(e){this._labelLogElement=e},Nea.logPoiLayerStyleStart=function(){this.enableFunctionalTestHooks&&(this._poiLayerStyle=Nea._poiLayerStyleStart)},Nea.logPoiLayerStyleEnd=function(e){var t;this.enableFunctionalTestHooks&&e&&((t=this._poiLayerStyle)!==Nea._poiLayerStyleStart&&this.logTestData(e,t+="}"),this._poiLayerStyle="")},Nea.logVectorImageTemplate=function(e,t){function n(e){var t=e&&e.vectorType,n="";return n="number"==typeof t?"VR{Type: "+t+", FillStyle: "+((e=e.style||{}).fillStyle||"nofill")+", StrokeStyle: "+(e.strokeStyle||"nostroke")+"}":n}var i;this.enableFunctionalTestHooks&&this._poiLayerStyle&&(i=[],e&&(i=i.concat(e.map(n))),i="VT{"+(i=t?i.concat(t.map(n)):i).join("")+"}",this._poiLayerStyle+=i)},Nea.logLabelData=function(e){var t,n,i,a,r,o,s,l;if(e&&(this.enableFunctionalTestHooks||this._labelLogElement))for(n=0,i=(t=Object.keys(e)).length;n<i;n++)(l=e[t[n]])&&l.region&&l.region.anchor&&l.region.bounds&&l.region.bounds.bbox&&l.region.bounds.bbox.minPoint&&l.region.bounds.bbox.maxPoint&&(a=l.region.bounds.bbox.minPoint,r=l.region.bounds.bbox.maxPoint,o=l.region.anchor,s=l.style&&l.style.styleStatic.showBackground,s="Label::text:"+l.text+(l.secondaryText?" secondaryText:"+l.secondaryText:"")+" type:"+l.type+" minPoint:("+a.x+","+a.y+") maxPoint:("+r.x+","+r.y+") anchorPoint:("+o.x+","+o.y+") showBackground:"+(s?1:0),this.enableFunctionalTestHooks&&this.logTestData(Nea.UserLogTag,s),this._labelLogElement&&this.logLabelText(l.text))},Nea.logResourceLoadOrder=function(e,t){this.enableFunctionalTestHooks&&this.logPerfTestData(e=e||Nea.LoadOrderTag,t)},Nea.logPerfInstrumentation=function(e,t){var n;this.enableFunctionalTestHooks&&(n="PerfLog::",this.logPerfTestData(e=e||Nea.PerfLogTag,n+=t))},Nea.logPushpinPrimitive=function(e,t){var n,i,r,s,l,u,c;this.enableFunctionalTestHooks&&e&&t&&(s=t.entity?a.getValue(t.entity,"name"):null,l=t.entity&&a.getValue(t.entity,"title")||"",u=t.entity?t.entity.id:null,c=-1,a.getValue(t,"taskDisplayState")&&(c=(c=a.getValue(t,"viewState"))||0),(i=t.geometry)&&1===t.geometryType&&(n=new o(t.crs.toLatitude(i.x,i.y),t.crs.toLongitude(i.x,i.y)),Nea._map&&Nea._map.getMode&&Nea._map.getMode()&&Nea._map.getMode().tryLocationToPoint&&(2!==(i=Nea._map.getMode()).mapModeType?((r=i.tryLocationToPoint(n)).x=Math.ceil(r.x),r.y=Math.ceil(r.y)):r=new h(0,0),u=s&&u&&0===u.indexOf("rs")?"RoadShield::name:"+s:"Pushpin::title:"+l+" id:"+u,t.entity&&a.getValue(t.entity,"tj")&&(u+=" [TRANSIT]"),u+=" viewState:"+c+" location:("+n.latitude+","+n.longitude+")"+(r?" Point:("+r.x+","+r.y+")":""),this.logTestData(e,u))))},Nea.logLayersChanged=function(e){var t;this.enableFunctionalTestHooks&&e&&(e.added&&(t=e.added[0],this.logTestData(Nea.TileLogTag,"UserLayer::"+t.getId()+"::added")),e.removed&&(t=e.removed[0],this.logTestData(Nea.TileLogTag,"UserLayer::"+t.getId()+"::removed")))},Nea.logVectorRenderingData=function(e,t,n,i){this.enableFunctionalTestHooks&&this._logElement.set_attr("data-"+Nea.VectorDataRenderLogTag,"[p"+e+"_gc"+i+"_tc"+n+"_v"+t+"]")},Nea.logShapePrimitive=function(e){var t,n,i,r;if(this.enableFunctionalTestHooks&&e){if(t="",2==e.geometryType&&e._options)t="Directions::Geometry::Line length: "+(n=e.geometry).y.length+" locations:[("+n.y[0]+","+n.x[0]+") ("+n.y[n.y.length-1]+","+n.x[n.x.length-1]+")]";else if(2==e.geometryType)n=e.geometry,t="Polyline::title:"+(e.entity?a.getValue(e.entity,"title"):"")+"Line length: "+n.y.length+" locations:[("+n.y[0]+","+n.x[0]+")]";else if(3==e.geometryType)for(t="Geometry::Area::Rings Count: "+(i=e.geometry.rings).length,r=0;r<i.length;r++)t+=" [Ring #:"+(r+1).toString()+", X vertex length:"+i[r].x.length+",Y vertex length:"+i[r].y.length+"]";this.logTestData(Nea.TileLogTag,t)}},Nea.logNetworkData=function(e,t){Nea.enableFunctionalTestHooks&&e&&Nea.logTestData(Nea.NetworkLogTag,e+":"+t)},Nea.clearTestHooksLog=function(e){this.enableFunctionalTestHooks&&this._logElement.set_attr("data-"+e,""),this._labelLogElement&&e===Nea.UserLogTag&&this._labelLogElement.set_attr("data-label","")},Nea.getFunctionalTestHooksEnabled=function(){return this.enableFunctionalTestHooks},Nea.addDataTag=function(e,t){e.set_attr("data-tag",t)},Nea.addStreetsideArrowTesthook=function(e,t,n,i){var a;this.enableFunctionalTestHooks&&e&&t&&n&&((a=f._createElement("a")).set_attr("href","#"),a.set_attr("class",t),a.set_attr("data-tag",t),e.append(a),n&&a.set_text(n),i&&a.add_event("click",i),a.set_style({pointerEvents:"auto",position:"relative",opacity:0}))},Nea.removeStreetsideArrowTesthooks=function(e){if(this.enableFunctionalTestHooks)for(var t=0;t<e.length;t++)n("."+e[t].replace(".","\\.")).removeFromParent()},Nea.logDebugData=function(e){this.enableFunctionalTestHooks&&this.logDataToTestElement(this._debugElement,"tag",e)},Nea.logLabelDrawOrder=function(e){Nea.enableFunctionalTestHooks&&e&&Nea.logTestData(Nea.LabelDrawOrderTag,e)},Nea.logTestData=function(e,t){this.logDataToTestElement(this._logElement,e,t)},Nea.logLabelText=function(e){this.logDataToTestElement(this._labelLogElement,"label",e)},Nea.logPerfTestData=function(e,t){this.logDataToTestElement(this._perfTestHookElement,e,t)},Nea.logDataToTestElement=function(e,t,n){var i="data-"+t,t=e.get_attr(i);-1==t.indexOf(n)&&(t=t?t+","+n:n),e.set_attr(i,t)},Nea.logString=function(e){var t;if(Nea.isDebugRun)try{console&&void 0!==console.log&&console.log.apply(console,[e])}catch(e){}!window.perfRun||(t=Nea._getCurrentGroupinMainStack())&&(e=Nea._formatLogString(e),t[Nea._getLogKey(t)]=e)},Nea.setupPerfObject=function(){window.perf={};var e=[];e.push(window.perf),window.mainPerfStack=e},Nea._getEpochTime=function(){return Date.now()},Nea._getPropertyCount=function(e){var t,n=0;if(e)for(t in e)e.hasOwnProperty(t)&&++n;return n},Nea._formatLogString=function(e){if(e)return(e=(e=(e=e.replaceAll(" ","_")).replaceAll(":","$")).replaceAll(",","_")).replaceAll(".","#")},Nea._getLogKey=function(e){return"__"+Nea._getEpochTime().toString()+"__"+(Nea._getPropertyCount(e)+1).toString()},Nea._getCurrentGroupinMainStack=function(){var e=Nea._getMainPerfStack();return Nea._getLastElement(e)},Nea._getMainPerfStack=function(){return window.mainPerfStack},Nea._getLastElement=function(e){if(e){var t=e.length;if(0<t)return e[t-1]}return null},Nea.TileLogTag="tile",Nea.VectorDataRenderLogTag="vectorDataRender",Nea.UserLogTag="user",Nea.NetworkLogTag="network",Nea.LoadOrderTag="loadOrder",Nea.LabelDrawOrderTag="LabelDrawOrder",Nea.PerfLogTag="perfLogs",Nea._poiLayerStyleStart="PLS{",Nea),vi=(hga.prototype.addItem=function(e,t,n){var i;t&&((i=this._dictionary[e])?a.areEqual(i.item,t)||(this._dictionary[e].item=t,this._moveNodeToHead(i)):this._addNewItem(e,t,n))},hga.prototype.convertToArray=function(){for(var e=[],t=this._headNode;t;)e.push(t.item),t=t.next;return e},hga.prototype.getItem=function(e){var t,e=this._dictionary[e];return e?(t=e.item,this._moveNodeToHead(e)):t=null,t},hga.prototype.clear=function(){for(;0<this._count;)this._deleteTailNode()},hga.prototype.getCount=function(){return this._count},hga.prototype.getInternalDictionary=function(){return this._dictionary},hga.prototype.setCapacity=function(e){var t,n;if(0<e){if(this._capacity>e&&this._count>e)for(t=this._count-e,n=0;n<t;n++)this._deleteTailNode();this._capacity=e}},hga.prototype.getCapacity=function(){return this._capacity},hga.prototype._addNewItem=function(e,t,n){this._count===this._capacity&&(n?this._capacity++:this._deleteTailNode());t={key:e,item:t};0===this._count?this._headNode=this._tailNode=t:(t.next=this._headNode,this._headNode.previous=t,this._headNode=t),this._dictionary[e]=t,this._count++},hga.prototype._removeNode=function(e){if(1===this._count)return r.assert(e===this._headNode,"The only node must be the head node."),r.assert(e===this._tailNode,"The only node must be the tail node."),this._headNode=null,void(this._tailNode=null);var t=e.previous,n=e.next;t?t.next=n:(r.assert(e===this._headNode,"Only the head node can have null previous."),this._headNode=n),n?n.previous=t:(r.assert(e===this._tailNode,"Only the tail node can have null next."),this._tailNode=t)},hga.prototype._moveNodeToHead=function(e){e!==this._headNode&&(this._removeNode(e),this._headNode&&(this._headNode.previous=e),e.previous=null,e.next=this._headNode,this._headNode=e)},hga.prototype._deleteTailNode=function(){var e;this._tailNode&&(e=this._tailNode,this._removeNode(e),delete this._dictionary[e.key],this._count--,(e=e.item)&&e.dispose&&e.dispose(),Array.isArray(e)&&f._clearDisposables(e))},hga),ef=(Fga=h,p(Gga,Fga),Gga),of=(Lga.prototype.dispatch=function(e,t,n){if(!this._disposed){r.assertIsFunction(e,"f"),e[Lga._orderAttributeKey]=n||0,e[Lga._dispatchKey]=t||"";for(var i=this._dispatchedQuery.length;i--;)if(this._dispatchedQuery[i]===e)return;this._dispatchedQuery.push(e),this._ensureTimer()}},Lga.prototype.cancelDispatch=function(e){for(var t=this._dispatchedQuery.length;t--;)this._dispatchedQuery[t]===e&&this._dispatchedQuery.splice(t,1);for(t=this._runningQuery.length;t--;)this._runningQuery[t]===e&&this._runningQuery.splice(t,1)},Lga.prototype.cancelDispatchWithKey=function(e){r.assertNotNullOrEmpty(e,"Key cannot be empty or null");for(var t=this._dispatchedQuery.length;t--;)this._dispatchedQuery[t]&&this._dispatchedQuery[t][Lga._dispatchKey]===e&&this._dispatchedQuery.splice(t,1);for(t=this._runningQuery.length;t--;)this._runningQuery[t]&&this._runningQuery[t][Lga._dispatchKey]===e&&this._runningQuery.splice(t,1)},Lga.prototype.dispose=function(){this.tickRaised.dispose(),this._runningQuery=[],this._dispatchedQuery=[],this._disposed=!0},Lga.prototype._tick=function(){var e,t,n;if(!this._disposed)for(this.tickRaised.invoke(),e=Date.now(),this._tickTimeoutId=null,this._dispatchedQuery.length&&this._ensureTimer(),t=this._dispatchedQuery,this._dispatchedQuery=this._runningQuery,this._runningQuery=t,this._runningQuery.sort(this._sortByOrder),n=!1;this._runningQuery.length;)n?this._dispatchedQuery.push(this._runningQuery.shift()):(r.groupCollapsed(null,"Dispatcher Tick"),this._runningQuery.shift()(),r.groupEnd(),Date.now()-e>Lga.MaxDispatchTime&&(n=!0))},Lga.prototype._sortByOrder=function(e,t){return e[Lga._orderAttributeKey]-t[Lga._orderAttributeKey]},Lga.prototype._ensureTimer=function(){var e=this;this._tickTimeoutId||(this._tickTimeoutId=Lga._requestAnimFrame(function(){try{e._tick()}catch(e){if(!u.logger)throw e;u.logger.logCriticalError(e)}}))},Lga.MaxDispatchTime=50,Lga._orderAttributeKey="$mm$dispatchOrder",Lga._dispatchKey="$mm$dispatchkey",Lga._requestAnimFrame=n.Effects.Animation.requestAnimationFrame,Lga),sf=(_ga=ar,p(a6a,_ga),a6a.prototype.release=function(e){this._objectPool.length===this._capacity?e.dispose&&e.dispose():_ga.prototype.release.call(this,e)},a6a._defaultCapacity=256,a6a),hf=(h6a.prototype.dispatch=function(e,t,n){var i,a;if(void 0===n&&(n=5),!this._disposed){for(r.assertIsFunction(e,"f"),(i=this._dispatchedQueryWithPriority[n])||(this._dispatchedQueryWithPriority[n]=i=[]),a=i.length;a--;)if(i[a].action===e)return;i.push({action:e,dispatchGroupKey:t}),this._ensureTimer()}},h6a.prototype.cancelDispatch=function(e,t){r.assertNotNull(e,"f:action cannot be empty"),this._cancel(e,null,t)},h6a.prototype.cancelAllDispatch=function(){this._dispatchedQueryWithPriority={}},h6a.prototype.cancelDispatchWithKey=function(e,t){r.assertNotNullOrEmpty(e,"Key cannot be empty or null"),this._cancel(null,e,t)},h6a.prototype.dispose=function(){this._disposed=!0,this._dispatchedQueryWithPriority={}},h6a.prototype._cancel=function(e,t,n){var i,a;if(void 0!==n&&0<=n)i=this._dispatchedQueryWithPriority[n],this._cancelActionInWorkCollection(i,e,t);else for(a=0;a<=5;a++)i=this._dispatchedQueryWithPriority[a],this._cancelActionInWorkCollection(i,e,t)},h6a.prototype._cancelActionInWorkCollection=function(e,t,n){for(var i=e&&e.length||0;i--;)e[i]&&(n?e[i].dispatchGroupKey===n&&e.splice(i,1):t&&e[i].action===t&&e.splice(i,1))},h6a.prototype._tick=function(){this._tickTimeoutId=null;for(var e=0,t=Date.now(),n=null,i=0;i<=5;i++){for(n=this._dispatchedQueryWithPriority[i];e<h6a._throttleElapseTime&&n&&0<n.length;)n.shift().action(),e=Date.now()-t;if(n&&0<n.length){this._ensureTimer();break}}},h6a.prototype._ensureTimer=function(){var e=this;this._tickTimeoutId||(this._tickTimeoutId=Microsoft.Maps.setTimeout(function(){e._tick()},0))},h6a._throttleElapseTime=5,h6a),cf=(G6a.prototype._next=function(){return this._items[this._index++]},G6a.prototype.hasNext=function(){return this._index<this._items.length},G6a.prototype.isRunning=function(){return this._isRunning},G6a.prototype.run=function(){this._isRunning||(this._isRunning=!0,this._totalRunningTime=0,this._iterate())},G6a.prototype.stop=function(){this._workDispatcher&&this._workDispatcher.cancelDispatch(this._action,this._priority),this._isRunning=!1},G6a.prototype.reset=function(){this.stop(),this._index=0},G6a.prototype._iterate=function(){for(var e,t=Date.now();this._isRunning&&this.hasNext()&&Date.now()-t<G6a._yieldThreshold;)e=this._next(),this._iterationCallback(e,this._index-1);this._totalRunningTime+=Date.now()-t,this.hasNext()?this._isRunning&&this._workDispatcher&&this._workDispatcher.dispatch(this._action,null,this._priority):(this._completionCallback&&this._completionCallback(this._index,this._totalRunningTime),this._isRunning=!1)},G6a._yieldThreshold=30,G6a),ri=function(){this.id=f._nextId().toString()},lf=(Q6a.prototype.clear=function(){this._dictionary={},this._order=[]},Q6a.prototype.getCount=function(){return this._order.length},Q6a.prototype.addItem=function(e,t){this._dictionary[e]||this._order.push(e),this._dictionary[e]=t},Q6a.prototype.getAt=function(e){var t;return t=0<=e&&e<this.getCount()?this.getItem(this._order[e]):t},Q6a.prototype.getItem=function(e){return this._dictionary[e]},Q6a.prototype.removeItem=function(e){this._dictionary[e]&&(delete this._dictionary[e],this._order.splice(this._order.indexOf(e),1))},Q6a),yi=(X6a.init=function(e,t){var n,i=X6a[e]=!X6a[e]?new X6a:X6a[e];for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n])},X6a);yi.init("MapCore",u.ResourcesObject),u.ResourcesObject=null;var v=yi.MapCore,ui=kt.LocalStorageCache,af=(aha=ar,p(bha,aha),bha.prototype.acquire=function(){if(0===this._objectPool.length)throw new Error("Pooled objects have been allocated already");return aha.prototype.acquire.call(this)},bha.prototype.release=function(e){if(this._objectPool.length===this._capacity)throw new Error("Object pool is already full");aha.prototype.release.call(this,e)},bha),pi=(iha.prototype.toString=function(e,t){var n,i,a,r,o,s,l="";if(this.protocol&&(l+=this.protocol+":","http"!==this.protocol&&"https"!==this.protocol&&"ftp"!==this.protocol||(l+="//")),this.host&&(l+=this.host),this.port&&(l+=":"+this.port),this.path&&(l+="/"+this.path),this.queryStringParameters)for(n=!0,a=0,r=(i=Object.keys(this.queryStringParameters)).length;a<r;a++)o=i[a],s=this.queryStringParameters[o],t&&!s||(n?(l+="?",n=!1):l+="&",l+=e?o+"="+s:encodeURIComponent(o)+"="+encodeURIComponent(s));return this.fragment&&(l+="#"+encodeURI(this.fragment)),l},iha.fromString=function(e){var t,n,i,a;if(!e)throw new Error("Input should be a well-formed url");var r=new iha,e=e,o=e.split("#");if(2<o.length)throw new Error("More than one fragment is found in the input");if(2===o.length&&(e=o[0],r.fragment=decodeURIComponent(o[1])),2<(o=e.split("?")).length)throw new Error("More than one query param identifier ('?') is found in the input");if(2===o.length)for(e=o[0],r.queryStringParameters={},o=o[1].split("&"),t=0;t<o.length;t++)0<(a=(n=o[t]).indexOf("="))&&(i=decodeURIComponent(n.substring(0,a)),a=decodeURIComponent(n.substring(a+1)),r.queryStringParameters[i]=a);if(2<(o=e.split("://")).length)throw new Error("More than one protocol identifier ('://') is found in the input");if(2===o.length&&(e=o[1],r.protocol=o[0]),1<(o=e.split("/")).length&&(e=o[0],r.path=o.slice(1).join("/")),0<=e.indexOf("@"))throw new Error("Unsupported url");if(2<(o=e.split(":")).length)throw new Error("More than one port identifier (':') is found in the input");if(r.host=o[0],2===o.length){if(e=parseInt(o[1]),isNaN(e))throw new Error("port number should be an integer");r.port=e}return r},iha.prototype.protocolAndDomain=function(){return(this.protocol+"://"+this.host+(void 0===this.port?"":":"+this.port)).toLowerCase()},iha);function bt(){}Dha.prototype.then=function(e,t){"function"!=typeof e&&(e=null),"function"!=typeof t&&(t=null);var n=new Dha(bt);return this._addContinuation({child:n,fulfill:e,reject:t}),n},Dha.resolve=function(e){if(e instanceof Dha)return e;var t=new Dha(bt);return t._resolve(e),t},Dha.reject=function(e){var t=new Dha(bt);return t._reject(e),t},Dha.all=function(e){var n=e.length,i=[],a=new Dha(bt);return e.length?e.forEach(function(e,t){Dha.resolve(e).then(function(e){i[t]=e,0==--n&&a._fulfill(i)},function(e){Dha._isSettled(a._state)||a._reject(e)})}):a._fulfill(i),a},Dha.race=function(e){e.length;var t=new Dha(bt);return e.length?e.forEach(function(e){Dha.resolve(e).then(function(e){Dha._isSettled(t._state)||t._fulfill(e)},function(e){Dha._isSettled(t._state)||t._reject(e)})}):t._fulfill(null),t},Dha._dispatchQueue=function(){var e,t,n=Dha._asyncQueue;for(Dha._asyncQueue=[],e=Dha._asyncTimerId=0,t=n.length;e<t;e++)n[e]()},Dha._queueAction=function(e){Dha._asyncQueue.push(e),Dha._asyncTimerId||(Dha._asyncTimerId=Microsoft.Maps.setTimeout(Dha._dispatchQueue,0))},Dha._isSettled=function(e){return 0!==e},Dha.prototype._fulfill=function(e){Dha._isSettled(this._state)||(this._value=e,this._state=1,this._execContinuations())},Dha.prototype._reject=function(e){Dha._isSettled(this._state)||(this._value=e,this._state=2,this._execContinuations())},Dha.prototype._addContinuation=function(e){var t=this;this._continuations?this._continuations.push(e):Dha._queueAction(function(){return t._execContinuation(e)})},Dha.prototype._execContinuations=function(){var i=this;Dha._isSettled(this._state)&&Dha._queueAction(function(){var e,t,n=i._continuations;for(i._continuations=null,e=0,t=n.length;e<t;e++)i._execContinuation(n[e])})},Dha.prototype._isObjectOrFunction=function(e){return e&&("function"==typeof e||"object"==typeof e)},Dha.prototype._isObject=function(e){return e&&"object"==typeof e},Dha.prototype._isFunction=function(e){return"function"==typeof e},Dha.prototype._resolve=function(e){var t,n,i=this;if(e===this)this._reject(new TypeError);else if(this._isObjectOrFunction(e))if((t=e).constructor===this.constructor)t.then(function(e){return i._resolve(e)},function(e){return i._reject(e)});else{try{n=t.then}catch(e){this._reject(e)}this._isFunction(n)?this._resolveThenable(t,n):this._fulfill(e)}else this._fulfill(e)},Dha.prototype._resolveThenable=function(e,t){var n,i,a=this;try{t.call(e,function(e){n||i||(n=!0,a._resolve(e))},function(e){n||i||(i=!0,a._reject(e))})}catch(e){n||i||this._reject(e)}},Dha.prototype._resolveOrReject=function(e,t){try{this._resolve(e(t))}catch(e){this._reject(e)}},Dha.prototype._execContinuation=function(e){var t,n,i;if(Dha._isSettled(this._state))switch(t=e.child,n=this._value,this._state){case 1:(i=e.fulfill)?t._resolveOrReject(i,n):t._fulfill(n);break;case 2:(i=e.reject)?t._resolveOrReject(i,n):t._reject(n)}},Dha._asyncQueue=[],wi=Dha,wi.prototype.catch=function(e){return this.then(null,e)},function(){var e,t,n="undefined"!=typeof global?global:self,i=n.Promise,a=["resolve","reject","all","race"],r=!!i;if(r)for(e=0,t=a.length;e<t;e++)if(!(a[e]in i)){r=!1;break}r||(n.Promise=wi)}(),X7a.prototype.then=function(e,t){return this._promise.then(e,t)},ft=X7a,gia=n.Transition=n.Transition||{},hia=n.Style.get_camelized_style_name,iia=n.Style.get_dasherized_style_name,kia={default:"ease",line:"linear",in:"ease-in",out:"ease-out","in-out":"ease-in-out","in-sine":"cubic-bezier(0.47,0,0.745,0.715)","out-sine":"cubic-bezier(0.39,0.575,0.565,1)","in-out-sine":"cubic-bezier(0.445,0.05,0.55,0.95)","in-quad":"cubic-bezier(0.55,0.085,0.68,0.53)","out-quad":"cubic-bezier(0.25,0.46,0.45,0.94)","in-out-quad":"cubic-bezier(0.455,0.03,0.515,0.955)","in-cubic":"cubic-bezier(0.55,0.055,0.675,0.19)","out-cubic":"cubic-bezier(0.215,0.61,0.355,1)","in-out-cubic":"cubic-bezier(0.645,0.045,0.355,1)","in-quart":"cubic-bezier(0.895,0.03,0.685,0.22)","out-quart":"cubic-bezier(0.165,0.84,0.44,1)","in-out-quart":"cubic-bezier(0.77,0,0.175,1)","in-back":"cubic-bezier(0.6,-0.28,0.735,0.045)","out-back":"cubic-bezier(0.175,0.885,0.32,1.275)","in-out-back":"cubic-bezier(0.68,-0.55,0.265,1.55)"},lia="ease",mia=document.createElement("div"),nia=hia("transition",mia),oia=void 0!==mia.style[nia],gia.run=function(e,t,i){e&&e.length&&t&&t.length?(oia?bia:function(e,t,i){for(var a=[],r=0,o=0,s=t.length;o<s;o++){var l=t[o],u=l.delay||0,c=l.duration||0,h=l.property,d=l.from,p=l.to;"number"==typeof(d=void 0===d?e.get_style(h):d)&&"number"==typeof p&&((l={})[h]=d,(d={})[h]=p,d=new n.Effects.Animation({elements:e,duration:c,startTime:u,from:l,to:d,animate:eia,easing:null}),a.push(d),r=Math.max(r,u+c))}new n.Effects.Storyboard({duration:r,completed:i,animations:a}).begin()})(e,t,i):i&&i()},n.Internals.parseJSON=function(e){return(JSON&&JSON.parse||(e="("+e+")")&&eval)(e)};var vf=(m8a.prototype.then=function(e){var t=this._value;if(e="function"!=typeof e?null:e)try{t=e(t)}catch(e){}return new m8a(t)},m8a),fi=(r8a.prototype.accumulate=function(e,t){var n,i;for(r.assertNotNull(e,"bounds"),r.assert(4===e.length,"The 'bounds' parameter must always be of length 4."),r.assertNotNull(t,"crs"),n=this._getCorners(t,e),i=0;i<n.length;i++)this._accumulateLocation(n[i].latitude,n[i].longitude)},r8a.prototype.accumulateLocations=function(e){for(var t=0;t<e.length;t++)this._accumulateLocation(e[t].latitude,e[t].longitude);return this.getBounds()},r8a.prototype.accumulateLocationRect=function(e){for(var t,n=0;n<e.length;n++)t=e[n],this._accumulateLocation(t.getNorth(),t.getWest()),this._accumulateLocation(t.getSouth(),t.getEast());return this.getBounds()},r8a.prototype.accumulateLatLon=function(e,t){for(var n=0;n<e.length;n++)this._accumulateLocation(e[n],t[n]);return this.getBounds()},r8a.prototype.getBounds=function(){var e=this._bounds;return e?b.fromEdges(e[0],e[1],e[2],e[3],null,null,!0):null},r8a.prototype._getCorners=function(e,t){if(t[0]===t[2]&&t[1]===t[3])return[new o(e.toLatitude(t[1],t[0]),e.toLongitude(t[1],t[0]))];var n=[];return n[0]=new o(e.toLatitude(t[3],t[0]),e.toLongitude(t[3],t[0])),n[1]=new o(e.toLatitude(t[1],t[0]),e.toLongitude(t[1],t[0])),n[2]=new o(e.toLatitude(t[3],t[2]),e.toLongitude(t[3],t[2])),n[3]=new o(e.toLatitude(t[1],t[2]),e.toLongitude(t[1],t[2])),n},r8a.prototype._accumulateLocation=function(e,t){this._bounds?(this._bounds[0]=Math.max(this._bounds[0],e),this._bounds[1]=Math.min(this._bounds[1],t),this._bounds[2]=Math.min(this._bounds[2],e),this._bounds[3]=Math.max(this._bounds[3],t)):this._bounds=[e,t,e,t]},r8a),yf=(K8a._pascalCase=function(e){return"string"!=typeof e?e:e.charAt(0).toUpperCase()+e.substring(1)},K8a.initialize=function(e,t){var n,i;if(!K8a._elementHierarchy)for(K8a._elementHierarchy={},n=0,i=e.length;n<i;n++){var a=e[n]||{},r=t[a.nameId],a=t[(e[a.parentId]||{}).nameId];r&&(K8a._elementHierarchy[r]=a)}},K8a.prototype.update=function(e,t){var n,i;for(this._stylesheets[t=void 0===t?0:t]=e,this._customSettings={},this._elementStyles={},this._extensionHierarchy={},this.hasCustomStyle=!1,this.styleString="",this.buildingVisible=!0,this.flatBuildings=!1,n=this._stylesheets.length-1;0<=n;n--)(i=this._stylesheets[n])&&this._initiate(i);this._initStyleString(),this.customMapStyleVersion++,this.changed.invoke()},K8a.prototype.settingHasValue=function(e,t){return this._customSettings&&this._customSettings[K8a._pascalCase(e)]===t},K8a.prototype.getElementStyle=function(e,t){var n,i=this.getElementItem(e,t);if(i)switch(i.type){case 3:case 2:n=i.value;break;case 1:n=st.convertPackedTorgba(i.value)}return n},K8a.prototype.getElementItem=function(e,t){var n,i,a,r;if(this.hasCustomStyle&&e&&t)for(i={},a=0<=e.indexOf(".");e&&!i[e]&&(n=(r=this._elementStyles[e])&&r[t],i[e]=!0,!n);)if(a){if(-1===(r=this._extensionHierarchy[e]||"").indexOf("."))return;e=r}else e=K8a._elementHierarchy[e];return n},K8a.prototype.getElementBucket=function(e,t){for(var n;e&&this.styleEntryBucketMap&&!(n=this.styleEntryBucketMap.getEntryBucket(e,t));)e=(0<=e.indexOf(".")?this._extensionHierarchy:K8a._elementHierarchy)[e];return n},K8a.prototype._initiate=function(e){(e=e||{}).elements=e.elements||{},e.settings=e.settings||{},e.extensions=e.extensions||{},this._parseCustomMapStyle(e)},K8a.prototype._initStyleString=function(){for(var e,t,n="",i=0,a=Object.keys(this._elementStyles);i<a.length;i++)e=a[i],(e=this._getElementString(e,this._elementStyles[e]))&&(n+=e+"_");(t=this._getSettingsString(this._customSettings))&&(n+=t),"_"===n.charAt(n.length-1)&&(n=n.substring(0,n.length-1)),this.styleString=n},K8a.prototype._parseCustomMapStyle=function(e){for(var t,n,i,a,r,o,s=e.elements,l=0,u=Object.keys(s);l<u.length;l++)(t=s[n=u[l]])&&(n=K8a._pascalCase(n),n=this._elementStyles[n]=this._elementStyles[n]||{},this._parseProperties(t,n));for(this._parseExtensions(e.extensions),i=e.settings,a=0,r=Object.keys(i);a<r.length;a++)o=r[a],this._customSettings[K8a._pascalCase(o)]=i[o];"boolean"==typeof i.flatBuildings&&(this.flatBuildings=i.flatBuildings)},K8a.prototype._parseExtensions=function(e){for(var t,n,i,a=0,r=Object.keys(e);a<r.length;a++)for(var o=r[a],s=e[o]||{},l=0,u=Object.keys(s);l<u.length;l++)(i=s[n=u[l]])&&(n=this._elementStyles[t=o+"."+n]=this._elementStyles[t]||{},this._parseProperties(i,n,{parent:!0}),(i=i.parent)&&(i=0<=i.indexOf(".")?i:K8a._pascalCase(i),this._extensionHierarchy[t]=i))},K8a.prototype._parseProperties=function(e,t,n){var i,a,r,o,s;if(void 0===n&&(n={}),e)for(i=0,a=Object.keys(e);i<a.length;i++)if(o=e[r=a[i]],!n[r]&&null!=o){var l=void 0,u=!1,c=void 0;switch("object"==typeof o?(l=o.value,u=o.ignoreTransform):l=o,typeof l){case"boolean":c={type:3,value:l};break;case"number":c={type:2,value:l,ignoreTransform:u};break;case"string":(s=ot.parse(l,2))&&(c={type:1,value:s.toPacked(),ignoreTransform:u})}c&&(t&&(t[K8a._pascalCase(r)]=c),this.hasCustomStyle=!0)}},K8a.prototype._getElementString=function(e,t){var n,i=K8a._elementMapping[e];if(!i)return"";for(var a="",r="bld"===i,o=0,s=Object.keys(t);o<s.length;o++){var l=s[o],u=K8a._propertyMapping[l],c=t[l];if(u&&c){var h,d=void 0,p=!1;switch(c.type){case 3:d=(h=c.value)?"1":"0",r&&"v"===u&&!h&&(this.buildingVisible=!1);break;case 2:d=c.value.toString(),p=c.ignoreTransform;break;case 1:n=new ot(c.value,3),d=this._convertColorToHex(n).slice(1),p=c.ignoreTransform}d&&(a+=this._addToString(a,i,u,d,p))}}return a},K8a.prototype._addToString=function(e,t,n,i,a){t=e?";":t+"|";return t+=n+":"+i,a&&(t+=",it:1"),t},K8a.prototype._getSettingsString=function(e){for(var t,n,i="",a=0,r=Object.keys(e);a<r.length;a++)if(l=r[a],t=K8a._propertyMapping[l]){var o=void 0,s=e[l],l=void 0;switch("object"==typeof s&&(l=(s=s.value).ignoreTransform),typeof s){case"boolean":o=s?"1":"0";break;case"number":o=s.toString();break;case"string":(n=ot.parse(s,2))&&(o=this._convertColorToHex(n).slice(1))}o&&(i+=this._addToString(i,"g",t,o,l))}return i},K8a.prototype._convertColorToHex=function(e){var t="";return"#"+(t=e.alpha<1?this._convertNumberToHex(Math.round(255*e.alpha)):t)+this._convertNumberToHex(e.red)+this._convertNumberToHex(e.green)+this._convertNumberToHex(e.blue)},K8a.prototype._convertNumberToHex=function(e){e=e.toString(16);return e.length<2?"0"+e:e},K8a._elementMapping={ActivityZone:"az",AdminDistrict:"ad",AdminDistrictCapital:"adc",Airport:"ap",Archipelago:"arc",Area:"ar",ArterialRoad:"ard",Bare:"br",Building:"bld",BuildingLine:"bl",Business:"bs",Camera:"cmr",Capital:"cp",Cemetery:"cm",Continent:"ct",Contour:"cn",ControlledAccessHighway:"cah",CountryRegion:"cr",CountryRegionCapital:"crc",District:"ds",Education:"ed",EducationBuilding:"eb",FoodPoint:"fp",FoodZone:"fz",Forest:"fr",GolfCourse:"gc",HighSpeedRailway:"hsr",HighSpeedRamp:"hsrp",Highway:"hg",Incident:"in",IndigenousPeoplesReserve:"ipr",IndoorPoint:"ip",Island:"is",Military:"ima",MajorRoad:"mr",MapElement:"me",MapLine:"ml",Medical:"md",MedicalBuilding:"mb",Metro:"mt",NaturalPoint:"np",Nautical:"nt",Neighborhood:"nh",Park:"pr",Peak:"pk",PlayingField:"pf",Point:"pt",PointOfInterest:"poi",Political:"pl",PopulatedPlace:"pp",Railway:"rl",Ramp:"rm",Reserve:"rsv",River:"rv",Road:"rd",RoadExit:"re",RoadShield:"rs",Runway:"rw",Sand:"sn",SecureZone:"szn",SecurityLine:"sl",ServiceZone:"sz",Settings:"g",ShoppingCenter:"sct",Stadium:"sta",Street:"st",Structure:"str",TollRoad:"tr",Track:"trk",Trail:"trl",Transit:"trn",TransitBuilding:"tb",Transportation:"trs",Underground:"ug",UnpavedStreet:"us",Vegetation:"vg",VenueFootprint:"vf",VolcanicPeak:"vp",Walkway:"wlk",Wall:"wl",Water:"wt",WaterPoint:"wp",WaterRoute:"wr",Zone:"zn"},K8a._propertyMapping={BorderOutlineColor:"boc",BorderStrokeColor:"bsc",BorderVisible:"bv",FillColor:"fc",IconColor:"ic",LabelColor:"lbc",LabelOutlineColor:"loc",LabelVisible:"lv",LandColor:"lc",ShadedReliefVisible:"srv",StrokeColor:"sc",Visible:"v"},K8a),pf=(S9a.prototype.getGeneralizations=function(e,t,n){var i,a,r,o;if(e.generalizable&&e.x.length>S9a._minimumGeneralizationCoordinates&&t&&t<=S9a._maximumGeneralizationZoom&&(a=S9a._getGeneralizationBucketKey(t),0===(i=this._initializeGeneralization(e,a,t,n)).length&&n))for(i.push(0),n.calculateProjectedCoordinates(0,e,0),this._lastRenderableX=n.lastProjectedX,this._lastRenderableY=n.lastProjectedY,r=e.x.length,this._hasNextProjectedCoordinates=!1,o=1;o<r;o++)this._hasNextProjectedCoordinates?(this._currentProjectedX=this._nextProjectedX,this._currentProjectedY=this._nextProjectedY,this._hasNextProjectedCoordinates=!1):(n.calculateProjectedCoordinates(o,e,0),this._currentProjectedX=n.lastProjectedX,this._currentProjectedY=n.lastProjectedY),this._isCoordinateIgnorable(o,o===r-1,e,n)||(i.push(o),this._lastRenderableX=this._currentProjectedX,this._lastRenderableY=this._currentProjectedY);return i},S9a.prototype._isCoordinateIgnorable=function(e,t,n,i){if(!t){if(this._consecutiveIgnoredCoordinatesCount<S9a._maxConsecutiveSkippedCoordinates){var a=this._currentProjectedX-this._lastRenderableX,r=this._currentProjectedY-this._lastRenderableY,o=Math.sqrt(a*a+r*r),s=0===this._totalPerpendicularDistance&&o<this._tolerance;if(s||(i.calculateProjectedCoordinates(e+1,n,0),this._nextProjectedX=i.lastProjectedX,this._nextProjectedY=i.lastProjectedY,this._hasNextProjectedCoordinates=!0,t=this._nextProjectedX-this._lastRenderableX,o=this._nextProjectedY-this._lastRenderableY,i=this._lastRenderableX+(n=(a*t+r*o)/(e=t*t+o*o))*t,n=this._lastRenderableY+n*o,(s=!(i<this._lastRenderableX&&i<this._nextProjectedX||i>this._lastRenderableX&&i>this._nextProjectedX||n<this._lastRenderableY&&n<this._nextProjectedY||n>this._lastRenderableY&&n>this._nextProjectedY))&&(e=Math.sqrt(e),this._totalPerpendicularDistance+=Math.abs(a*o-r*t)/e,s=this._totalPerpendicularDistance<this._tolerance)),s)return this._consecutiveIgnoredCoordinatesCount++,!0}this._consecutiveIgnoredCoordinatesCount=0,this._totalPerpendicularDistance=0}return!1},S9a.prototype._initializeGeneralization=function(e,t,n,i){i&&e.generalizationCrs!==i.destinationCrs&&(e.generalizations=null,e.generalizationCrs=i.destinationCrs),e.generalizations||(e.generalizations={});i=e.generalizations[t];return i&&0!==i.length||(e.generalizations[t]=[],i=e.generalizations[t],this._totalPerpendicularDistance=0,this._consecutiveIgnoredCoordinatesCount=0,this._tolerance=S9a._getPixelTolerance(n)),i},S9a._getPixelTolerance=function(e){return S9a._maximumPixelToleranceLimit/Math.pow(2,S9a._zoomLevelGeneralizationBucketSize-e%S9a._zoomLevelGeneralizationBucketSize-1)},S9a._getGeneralizationBucketKey=function(e){return"z"+Math.floor(e/S9a._zoomLevelGeneralizationBucketSize)},S9a.instance=new S9a,S9a._maximumGeneralizationZoom=17,S9a._minimumGeneralizationCoordinates=20,S9a._maximumPixelToleranceLimit=1,S9a._zoomLevelGeneralizationBucketSize=3,S9a._maxConsecutiveSkippedCoordinates=100,S9a),s=(vka.getTilePrimerId=function(e){return"tp"+e},vka.isValid=function(e){switch(e){case vka.aerial:case vka.birdseye:case vka.road:case vka.streetside:case vka.ordnanceSurvey:case vka.mercator:case vka.grayscale:case vka.canvasDark:case vka.canvasLight:case vka.highContrast:case vka.birdseyeV2:case vka.roadDark:return!0}return!1},vka.aerial="a",vka.birdseye="be",vka.none="",vka.ordnanceSurvey="os",vka.road="r",vka.streetside="x",vka.mercator="m",vka.grayscale="cg",vka.canvasDark="wd",vka.canvasLight="wl",vka.highContrast="hc",vka.roadDark="rd",vka.birdseyeV2="be2",vka),wf=(yka.prototype.interpolate=function(e,t,n){var i=this._interpolateProgress(e.cameraLocation.latitude,t.cameraLocation.latitude,n),a=this._interpolateProgress(e.cameraLocation.longitude,t.cameraLocation.longitude,n),r=this._interpolateProgress(e.cameraLocation.altitude,t.cameraLocation.altitude,n,!0),s=e.heading,e=t.heading;return 180<Math.abs(e-s)&&(e<s?e+=360:s+=360),n=this._interpolateProgress(s,e,n),new y(new o(i,a,r,t.cameraLocation.altitudeReference),n)},yka.prototype._interpolateProgress=function(e,t,n,i){if(void 0===i&&(i=!1),this.zoomDelta<0)n=Math.pow(n,2);else if(0<this.zoomDelta)n=1-Math.pow(1-n,2);else if(this.duration>yka._minDurationForZoomEffectDuringPan&&i)return Math.sin(n*Math.PI)*e*yka._zoomAnimationFactorDuringLongPan*(1+Math.log(this.duration/yka._minDurationForZoomEffectDuringPan))+e;return(t-e)*n+e},yka._pixelDistancePerZoom=500,yka._pixelDistanceFactorPerHeadingDegree=4,yka._slowAnimationThresholdDuration=225,yka._minDurationForZoomEffectDuringPan=500,yka._zoomAnimationFactorDuringLongPan=.4,yka._durationMultiplierDuringShortPan=10,yka),bi=(_ka=ri,p(ala,_ka),ala.getLocation=function(e,t){var n,i;return e&&t&&(n=e.toLatitude(t.x,t.y),i=e.toLongitude(t.x,t.y),i=new o(n,i)),i},ala.prototype.getLocation=function(){return ala.getLocation(this.crs,this.geometry)},ala.prototype.isTapEnabled=function(){return!0},ala.prototype.setLocation=function(e){this.geometry={x:e.longitude,y:e.latitude,bounds:[e.latitude,e.longitude,e.latitude,e.longitude]}},ala.prototype.dispose=function(){this.isDisposed||(f._nullifyClass(this),this.isDisposed=!0)},ala),bf=(nla=bi,p(ola,nla),ola.prototype.isHoverEnabled=function(){return!0},ola.prototype.isMoveEnabled=function(){return!0},ola),br=(tla=dt,p(ula,tla),ula),ki=(Ala.showOverlay=function(e,t,n){var i;Ala._primitive||(i=t.overlayTemplate,n.getOverlayTemplate&&(i=n.getOverlayTemplate()),Ala._createOverlay(e,i,n,t))},Ala.hideOverlay=function(e,t){!Ala._overlay||!Ala._primitive||Ala._primitive!==t||t&&t!==Ala._overlay.getPrimitive()||(e=e.getOverlays())&&-1!==e.indexOf(Ala._overlay)&&(e.remove(Ala._overlay),Ala._overlay=null,Ala._primitive=null)},Ala.getOverlay=function(){return Ala._overlay},Ala._createOverlay=function(e,t,n,i){var a;t&&1===n.geometryType&&(a=t.applyDataTemplate({primitive:n}),t=n.geometry,t="number"==typeof i.overlayAlignment?i.overlayAlignment:new o(n.crs.toLatitude(t.x,t.y),n.crs.toLongitude(t.x,t.y)),Ala._overlay=new br(a,t,i.overlayAnchor,n),Ala._primitive=n,e.getOverlays().insert(Ala._overlay))},Ala),ei=(Pla.prototype._onMapFrameManagerLoaded=function(){var t=this,e=this._map.getFrameManager();this._disposables.push(e.frameFailed.add(function(e){return t._onFrameFailed(e)})),this._disposables.push(e.frameSet.add(function(e){return t._onFrameManagerFrameSet(e)})),this._disposables.push(e.frameRendered.add(function(){return t._onFrameRendered()})),this._disposables.push(e.primitivesRendered.add(function(){t._currentFramePrimitivesRenderedTime=Date.now()-t._framesetStartTime})),this._disposables.push(e.labelsRendered.add(function(){t._currentFrameLabelsRenderedTime=Date.now()-t._framesetStartTime})),this._disposables.push(e.dataLoaded.add(function(){t._currentFrameDataLoadTime+=Date.now()-t._lastFramesetStartTime}))},Pla.prototype._onMapControlInitialized=function(){Pla._logStatus.Maps_BST&&i.isMapsVertical||(Pla.mark("Maps_BST",i.isMapsVertical?null:this._getControlTimeTillNow()),Pla._logStatus.Maps_BST=!0)},Pla.prototype._logPPLT=function(){var e;i.isMapsVertical&&(e=window.Maps_PPLT,delete window.Maps_PPLT,e&&!Pla._logStatus.Maps_PPLT&&(Pla.record("Maps_PPLT",Math.round(e)),Pla._logStatus.Maps_PPLT=!0))},Pla.prototype._getControlTimeTillNow=function(){return Math.round(e._PerfV2BSCTime-e._PerfV2STime+(Pla._firstInitializationTime-e._PerfV2ISTime)+(Date.now()-this._initializationTime))},Pla.prototype._onNavigationBarLoaded=function(){this._navigationBarLoaded=!0,this._tryLogPLT(),this._tryLogPLTex()},Pla.prototype._tryLogPLT=function(){Pla._logStatus.Maps_PLT&&i.isMapsVertical||this._isPLTLogged||this._navigationBarLoaded&&this._frameRendered&&(this._isPLTLogged=!0,Pla._logStatus.Maps_PLT=!0,Pla.mark("Maps_PLT"),i.isMapsVertical||Pla.record("Maps_CLT",this._getControlTimeTillNow()),this._logResourceData(),Pla.tryFlush())},Pla.prototype._logResourceData=function(){var e=this;if(!Pla._logStatus.resourceData&&"undefined"!=typeof performance){if(Pla._logStatus.resourceData=!0,performance.getEntriesByType){for(var t=performance.getEntriesByType("resource"),n=0,a=0,r=0,o=0,s=0,l=0,u=0,c=0,h=0,d=0,p=0,m=0,g=0,f=0,_=0,y=0,v=i.isOnChina?"tiles.ditu.":"tiles.virtualearth.net",b=0;b<t.length;b++){var w=t[b],M=w.name?w.name.toLowerCase():"",C=Math.floor(w.domainLookupEnd-w.domainLookupStart),S=Math.floor(w.connectEnd-w.connectStart),L=Math.floor(0<w.secureConnectionStart?w.connectEnd-w.secureConnectionStart:0),P=Math.floor(w.responseStart-w.requestStart),T=0<w.responseStart?Math.floor(w.responseEnd-w.responseStart):0;-1<M.indexOf(v)?(h=Math.max(C,h),d=Math.max(S,d),p=Math.max(L,p),m=Math.max(P,m),f=Math.max(T,f)):Pla.rmsUrlIdentifier.test(M)?(s=Math.max(C,s),l=Math.max(S,l),u=Math.max(L,u),c=Math.max(P,c),y=Math.max(T,y),w.encodedBodySize&&(r++,a+=w.encodedBodySize),w.transferSize&&0<w.transferSize&&(o++,n+=w.transferSize)):-1<M.indexOf("/stl?")&&(g=Math.max(P,g),_=Math.max(T,_))}0<r&&(Pla.record("Maps_CM",Math.round(o/r*100)),Pla.record("Maps_ERS",a),Pla.record("Maps_TRS",n),0===o&&Pla.mark("Maps_PLT2"),o===r&&Pla.mark("Maps_PLT1")),s&&Pla.record("Maps_BDNST",s),l&&Pla.record("Maps_BCT",l),u&&Pla.record("Maps_BSSLT",u),c&&Pla.record("Maps_BTTFB",c),y&&Pla.record("Maps_BDT",y),h&&Pla.record("Maps_TSDNST",h),d&&Pla.record("Maps_TSCT",d),p&&Pla.record("Maps_TSSSLT",p),m&&Pla.record("Maps_TSTTFB",m),g&&Pla.record("Maps_XSRTTFB",g),_&&Pla.record("Maps_XSRDT",_),f&&Pla.record("Maps_TSDT",f)}this._logMemory("Maps_MEM"),this._timerId=Microsoft.Maps.setTimeout(function(){e._logMemory("Maps_LMEM")},126e4)}},Pla.prototype._updateControlStartTime=function(){var t,n,a,r,o;if(!i.isMapsVertical&&"undefined"!=typeof performance&&performance.getEntriesByType&&performance.timing)for(t=performance.getEntriesByType("resource"),n=/\/maps\/(sdk\/|sdkrelease\/)?mapcontrol(\?|$)/gi,a=0;a<t.length;a++)if(o=(r=t[a]).name||"",n.test(o)){0<r.fetchStart&&(e._PerfV2STime=performance.timing.navigationStart+r.fetchStart);break}},Pla.prototype._logMemory=function(e){var t;"undefined"==typeof performance||(t=performance.memory)&&t.usedJSHeapSize&&Pla.record(e,Math.round(t.usedJSHeapSize/1e3))},Pla.prototype._onMapPanStarted=function(){this._panStartTime=Date.now(),this._totalTicks=0,this._isPanning=!0},Pla.prototype._onMapPanStopped=function(){var e;0<this._totalTicks&&(e=(Date.now()-this._panStartTime)/1e3,Pla.record("Maps_PFPS",Math.round(this._totalTicks/e)))},Pla.prototype._onMapZoomStarted=function(){this._zoomStartTime=Date.now(),this._totalTicks=0,this._isZooming=!0},Pla.prototype._onMapZoomStopped=function(){var e;0<this._totalTicks&&(e=Math.round(this._totalTicks/((Date.now()-this._zoomStartTime)/1e3)),Pla.record("Maps_ZFPS",e))},Pla.prototype._onFrameFailed=function(e){1!==e.reason&&(this._framesetStartTime=-1,this._frameRendered||(this._frameRendered=!0,this._tryLogPLT())),Pla.record("Maps_FFAIL",e.reason)},Pla.prototype._onFrameManagerFrameSet=function(e){this._lastFramesetStartTime=Date.now(),-1!==this._framesetStartTime&&1!==e.frame.cause||(this._currentFrameDataLoadTime=0,this._framesetStartTime=Date.now())},Pla.prototype._tryLogPLTex=function(){var e,t,n;if((!Pla._logStatus.Maps_PLTEX||!i.isMapsVertical)&&!this._isPLTexLogged&&this._isPLTLogged){for(e=!1,t=Object.keys(Pla._logStartKey),n=0;n<t.length;n++)Pla._logStartKey[t[n]].includeinPLT&&(e=!0);e||(this._isPLTexLogged=!0,Pla._logStatus.Maps_PLTEX=!0,Pla.mark("Maps_PLTEX"))}},Pla.prototype._onFrameRendered=function(){this._frameRendered||(this._frameRendered=!0,this._logPPLT(),this._tryLogPLT()),this._tryLogPLTex();var e=this._isPanning?"Maps_PTTG":this._isZooming?"Maps_ZTTG":"Maps_VCTTG";Pla.record(e,Date.now()-this._framesetStartTime),Pla.record("Maps_FDL",this._currentFrameDataLoadTime),Pla.record("Maps_PRT",this._currentFramePrimitivesRenderedTime),Pla.record("Maps_LRT",this._currentFrameLabelsRenderedTime),this._isPanning=this._isZooming=!1,this._framesetStartTime=-1,Pla.tryFlush()},Pla.prototype.dispose=function(){Pla.tryFlush(),et.dispose(),f._clearDisposables(this._disposables),clearTimeout(this._timerId),clearTimeout(Pla._keyExpiredTimerId),Pla._keyExpiredTimerId=-1,this._map=null},Pla.tryFlush=function(){i.enableInstrumentation&&"undefined"!=typeof perf&&perf.flush&&(i.isMapsVertical||i.isMapsAnswer)?perf.flush():et.tryFlush()},Pla.record=function(e,t){i.testHooksEnabled&&console.log(Date.now()-performance.timing.navigationStart+" - PerfV2 key:"+e+" Value:"+t),(i.enableInstrumentation&&"undefined"!=typeof perf&&perf.record&&(i.isMapsVertical||i.isMapsAnswer)?perf:et).record(e,t)},Pla.mark=function(e,t){var n;i.testHooksEnabled&&console.log(Date.now()-performance.timing.navigationStart+" - PerfV2 key:"+e+" Value:"+(t||Date.now()-performance.timing.navigationStart)),i.enableInstrumentation&&"undefined"!=typeof perf&&perf.mark&&(i.isMapsVertical||i.isMapsAnswer)?(n=void 0,t&&window.performance&&performance.timing&&(n=performance.timing.navigationStart+t),perf.mark(e,n)):et.mark(e,t)},Pla.removeKey=function(e){delete Pla._logStartKey[e]},Pla.setStartTime=function(e,t,n){"FrameSet"!==e&&Pla._startWatchForActiveKeys(),Pla._logStartKey[e]={startTime:t||Date.now(),includeinPLT:n}},Pla.getStartTime=function(e,t){var n=Pla._logStartKey[e]&&"number"==typeof Pla._logStartKey[e].startTime?Pla._logStartKey[e].startTime:0;return t&&Pla.removeKey(e),n},Pla.log=function(e,t){t=t||Pla.getStartTime(e,!0),Pla.removeKey(e),0<t&&(t=Math.round(Date.now()-t),Pla.record(e,t))},Pla.getLogKeyFromUrl=function(e){var t=null;return e&&(-1<(e=pi.fromString(e).path.toLowerCase()).indexOf("localoverlaybfpr")?t="Maps_lobfpr":-1<e.indexOf("localpoioverlaybfpr")?t="Maps_lpobfpr":-1<e.indexOf("overlaybfpr")?t="Maps_obfpr":-1<e.indexOf("landmarkdeals")&&(t="Maps_lmd")),t},Pla._startWatchForActiveKeys=function(){-1===Pla._keyExpiredTimerId&&(Pla._keyExpiredTimerId=Microsoft.Maps.setTimeout(function(){var e,t,n;for(Pla._keyExpiredTimerId=-1,e=Date.now(),t=Object.keys(Pla._logStartKey),n=0;n<t.length;n++)2e4<e-Pla._logStartKey[t[n]].startTime&&delete Pla._logStartKey[t[n]];0<Object.keys(Pla._logStartKey).length&&Pla._startWatchForActiveKeys()},1e4))},Pla._logStatus={},Pla._logStartKey={},Pla._keyExpiredTimerId=-1,Pla.rmsUrlIdentifier=/bing.com\/(\w|\/|,)+\.(css|js)/gi,Pla),et;jna=et=et||{},pna=1e3,qna=[],rna=[],sna=-1,tna=!1,una=i.perfSDKInclusions,jna.igUpdatedPromise=new ft,jna.record=function(e,t){var n;(i.enableInstrumentation||una&&una[e.toLowerCase()])&&("Maps_CLT"===e&&(n="experimental"===f._getCoreConfig().mapcontrolVersion,e=i.isMapsAnswer?"Maps_CLTserp":i.isMsftPartner?n?"Maps_CLTme":"Maps_CLTmr":n?"Maps_CLTse":"Maps_CLTsr"),rna.push(e+":"+Math.round(t)),kna())},jna.mark=function(t,n){var a;(i.enableInstrumentation||una&&una[t.toLowerCase()])&&(n||(a=window.performance,n=Date.now()-(a&&a.timing?a.timing.navigationStart:e._PerfV2STime)),qna.push(t+":"+Math.round(n).toString(36)),kna())},jna.tryFlush=nna,jna.dispose=function(){nna(),clearTimeout(sna)};var kr=(Ina=ri,p(Jna,Ina),Jna.prototype.isTapEnabled=function(){return!0},Jna.getRings=function(e,t){var n,i,a,r,s,l,u,c,h;if(!e||!t||t.rings.length<1)return null;for(n=[],i=0,a=t.rings.length;i<a;i++){for(s=[],l=0,u=(r=t.rings[i]).x.length;l<u;l++)c=e.toLatitude(r.x[l],r.y[l]),h=e.toLongitude(r.x[l],r.y[l]),s.push(new o(c,o.normalizeLongitude(h)));n.push(s)}return n},Jna.prototype.getRings=function(){return Jna.getRings(this.crs,this.geometry)},Jna.prototype.setRings=function(e,t){this.setArea(e,t)},Jna.prototype.getTemplate=function(){return this._template},Jna.prototype.setTemplate=function(e){this._template=e},Jna.prototype.setArea=function(e,t){var n,i,a,r,o,s,l,u;if(e.rings)this.geometry=e;else{for(a=[],i=(o=!((o=e)[n=0]instanceof Array)?[e]:e).length;n<i;n++)s=o[n],a.push(this._getRing(s));this.geometry={rings:a,bounds:null}}for(n=0,i=(a=(l=this.geometry).rings).length;n<i;n++)r=a[n],this._closeRing(r),r.generalizable=t,di.worldWrapLongitudes(r.x)&&(l.bounds=null);if(!l.bounds){for(u=new fi,n=0,i=a.length;n<i;n++)r=a[n],u.accumulateLatLon(r.y,r.x);e=u.getBounds(),l.boundingBox=e,l.bounds=e?e.bounds:null}},Jna.prototype.dispose=function(){this.isDisposed||(f._nullifyClass(this),this.isDisposed=!0)},Jna.prototype._getRing=function(e){for(var t=[],n=[],i=0;i<e.length;i++)t.push(e[i].longitude),n.push(e[i].latitude);return{x:t,y:n}},Jna.prototype._closeRing=function(e){e&&(e instanceof Array?!e.length||e[0].latitude===e[e.length-1].latitude&&e[0].longitude===e[e.length-1].longitude||e.push(new o(e[0].latitude,e[0].longitude)):(e=e).x.length&&e.y.length&&(e.x[0]!==e.x[e.x.length-1]||e.y[0]!==e.y[e.y.length-1])&&(e.x.push(e.x[0]),e.y.push(e.y[0])))},Jna),di=(uoa=ri,p(voa,uoa),voa.getLocations=function(e,t){var n,i,a,r=[];if(e&&t)for(n=0;n<t.x.length;n++)i=e.toLatitude(t.x[n],t.y[n]),a=e.toLongitude(t.x[n],t.y[n]),r.push(new o(i,o.normalizeLongitude(a)));return r},voa.prototype.getLocations=function(){return voa.getLocations(this.crs,this.geometry)},voa.prototype.getTemplate=function(){return this._template},voa.prototype.setTemplate=function(e){this._template=e},voa.prototype.setLine=function(e,t){var n=new fi;if(e instanceof Array){for(var i=e.length,a=new Array(i),r=new Array(i);i--;)r[i]=e[i].longitude,a[i]=e[i].latitude;this.geometry={x:r,y:a,bounds:null}}else this.geometry=e;!voa.worldWrapLongitudes(this.geometry.x)&&this.geometry.bounds||(this.geometry.boundingBox=n.accumulateLatLon(this.geometry.y,this.geometry.x),this.geometry.bounds=this.geometry.boundingBox?this.geometry.boundingBox.bounds:null),this.geometry.generalizable=t},voa.prototype.dispose=function(){this.isDisposed||(f._disposeEvents(this),f._nullifyClass(this),this.isDisposed=!0)},voa.worldWrapLongitudes=function(e){for(var t,n,i=!1,a=o.normalizeLongitude((e=e||[])[0]),r=0,s=1<e.length&&e[0]===e[e.length-1],l=0,u=e.length;l<u;l++)180<(n=(t=r+o.normalizeLongitude(e[l]))-a)?(r-=360,t-=360):n<-180&&(r+=360,t+=360),t!==e[l]&&(e[l]=t,i=!0),a=t;return i&&s&&(e[e.length-1]=e[0]),i},voa),kf=(Zoa.prototype.getWeight=function(){return this._weight},Zoa.prototype.setWeight=function(e){"number"==typeof e&&isFinite(e)&&(this._weight=e<0?0:e)},Zoa),e=u.Internal=u.Internal||{};e._BoundsAccumulator=fi,e._ComponentNames=it,e._CurveKey=at,e._Curve=vt,e._Color=ot,e._CurveVector4=gi,e._CurveColor=tu,e._CurveColorHelper=st,e.CustomMapStyleManager=yf,e._DiscreteRangeCollectionSpline=ru,e._ElementSizeHelper=ir,e._ExternalPromise=ft,e._EntryPoints=au,e._FeatureNames=vu,e._Helper=f,e._InstrumentationBase=InstrumentationBase,e.Iterator=cf,e._LayerFrameManager=er,e._LocalStorageCache=kt.LocalStorageCache,e._LoggingWrapper=uu,e._LoggerConstants=w,e._MapFrameData=or,e._ObjectWithId=ri,e._Overlay=br,e._ObservableObject=dt,e._ObservableCollection=rt,e._Observable=a,e._ObservableObjectChangedArgs=yt,e._JSEvent=t,e._Binding=hr,e._EventBinding=bu,e._NAARectangle=tr,e._VectorMath=c,e._Dispatcher=of,e._WorkDispatcher=hf,e._Network=tt,e._Gimme=n,e._Debug=r,e._LatLonCrs=ct,e._LruCache=vi,e._TransformCurve=uf,e._HslaTransformCurve=ff,e._Url=pi,e.MapFrameManager=ti,e.MapHelper=tf,e.OrderedDictionary=lf,e.DelayLoadedObject=si,e.StaticPromise=vf,e._GeometryGeneralizer=pf,e._MapAuthentication=ii,e.ViewChangeArgs=pt,e._PerfV2Logger=ei,u=window.$MicrosoftMaps8,u.Anchor=ef,u.BasicMapAnimation=fu,u.ClientPerf=yu,u.ImageryMapLayer=ht,u.LatLonCrs=ct,u.Location=o,u.LocationRect=b,u.LabelVisibility=wt,u.NetworkCallbacks=tt.callbacks,u.Matrix2D=nr,u.CoreMap=rf,u.MapLayer=oi,u.MapMath=k,u.MapTypeId=s,u.MapQuadrant=ai,u.NavigationBarMode=ut,u.NavigationBarOrientation=lt,u.OverviewMapMode=wr,u.MapView=y,u.MapViewAnimator=wf,u.MoveableSimplePointPrimitive=bf,u.Point=h,u.PooledImage=vr,u.PrimitiveOverlayHelper=ki,u.Rectangle=gt,u.SimplePointPrimitive=bi,u.SimpleLinePrimitive=di,u.SimpleAreaPrimitive=kr,u.Size=nt,u.ResourceManager=yi,u.VectorMapLayer=cr,u.WeightedLocation=kf,u.ZoomLevel=l,u.ZoomAroundLocationAnimator=pr}catch(dr){if(!u.logger)throw dr;u.logger.logCriticalError(dr)}function Zoa(e,t){this._weight=1,this.location=e,this.setWeight(t)}function voa(e,t,n,i){var a=uoa.call(this)||this;return a.crs=ct.instance,a.geometryType=2,a.entity=t,a.disposables=[],a.setLine(e,i),a._template=n,a}function Jna(e,t,n,i){var a=Ina.call(this)||this;return a.crs=ct.instance,a.geometryType=3,a.setArea(e,i),a.entity=t,a._template=n,a}function kna(){tna&&-1===sna&&(sna=Microsoft.Maps.setTimeout(nna,pna))}function nna(){jna.igUpdatedPromise.then(function(){var e,t,n,a;(0<qna.length||0<rna.length)&&(e=Date.now(),t="id:"+Math.round(1e4*Math.random())+","+(0<qna.length?'P:"'+qna.join(",")+'",':"")+(0<rna.length?'S:"'+rna.join(",")+'",':"")+'v: 1.1, T: "CI.Perf", FID: "CI", Name: "PerfV2"',n=(a=i.dynamicProperties).impressionGuid,a=a.origin+"/fd/ls/lsp.aspx",tt.doPost(a,"<ClientInstRequest><Events>"+("<E><T>Event.ClientInst</T><IG>"+n+"</IG><TS>"+e+"</TS><D><![CDATA[{"+t+"}]]></D></E>")+"</Events><STS>"+e+"</STS></ClientInstRequest>",{headers:{"Content-Type":"text/plain;charset=UTF-8"}}),qna=[],rna=[],tna=!0,clearTimeout(sna),sna=-1)})}function Pla(e){var t=this;this._disposables=[],this._initializationTime=Date.now(),Pla._firstInitializationTime||(Pla._firstInitializationTime=this._initializationTime),this._map=e,this._totalTicks=0,this._framesetStartTime=-1,this._updateControlStartTime(),this._onMapControlInitialized(),this._disposables.push(this._map.frameManagerLoaded.addOne(function(){return t._onMapFrameManagerLoaded()})),this._disposables.push(this._map.mapZoomStarted.add(function(){return t._onMapZoomStarted()})),this._disposables.push(this._map.mapZoomStopped.add(function(){return t._onMapZoomStopped()})),this._disposables.push(this._map.mapPanStarted.add(function(){return t._onMapPanStarted()})),this._disposables.push(this._map.mapPanStopped.add(function(){return t._onMapPanStopped()})),this._disposables.push(this._map.viewChanging.add(function(){t._totalTicks++})),this._disposables.push(this._map.navigationBarLoaded.addOne(function(){return t._onNavigationBarLoaded()})),"undefined"!=typeof performance&&(performance.setResourceTimingBufferSize&&performance.setResourceTimingBufferSize(250),e=performance.timing,i.isMapsVertical&&e&&(0<(e=e.responseEnd-e.responseStart)&&!Pla._logStatus.Maps_CS&&(Pla.record("Maps_CS",Math.floor(72e4/e)),Pla._logStatus.Maps_CS=!0)))}function Ala(){}function ula(e,t,n,i){var a=tla.call(this)||this;return a.defineProperty("overlayElement"),a.defineProperty("alignment"),a.defineProperty("anchor"),a.defineProperty("primitive"),a.setOverlayElement(e),a.setAlignment(t),a.setAnchor(n),i&&a.setPrimitive(i),a}function ola(e,t,n,i){return nla.call(this,e,t,n,i)||this}function ala(e,t,n,i,a){var r=_ka.call(this)||this;return r.crs=ct.instance,r.geometryType=1,r.setLocation(e),r.entity=t,r.anchor=i,r.image=n,r.imageSize=a,r}function yka(e,t,n,i){var a,r,o,s,c,h;void 0===n&&(n=2e3),void 0===i&&(i=1200),this.duration=0,this.zoomDelta=0,c=parseInt(f._getUrlParam(window.location,"maxDuration")),this._maxAnimationDuration=i=c||i,n=parseInt(f._getUrlParam(window.location,"velocity"))||n,(a=u.Internal.TileSystemHelper)&&(r=l.fromLocation(t.cameraLocation,!0),o=l.fromLocation(e.cameraLocation,!0),this.zoomDelta=r-o,h=Math.min(r,o),s=a.latLongToPixelXY(t.cameraLocation,h),c=a.latLongToPixelXY(e.cameraLocation,h),e=Math.sqrt(Math.pow(s.x-c.x,2)+Math.pow(s.y-c.y,2))+Math.abs(r-o)*yka._pixelDistancePerZoom+Math.abs(t.heading-e.heading)*yka._pixelDistanceFactorPerHeadingDegree,(h=a.getMapSize(h))/2<e&&(e=Math.max(0,h-e)),this.duration=i<(n=e/n*1e3)?0:n,0<this.duration&&this.duration<yka._slowAnimationThresholdDuration&&(this.duration=Math.min(this.duration*yka._durationMultiplierDuringShortPan,yka._slowAnimationThresholdDuration)))}function vka(){this.collinsBart="cb"}function S9a(){if(S9a.instance)return S9a.instance}function K8a(e){this._stylesheets=[],this.customMapStyleVersion=0,this.changed=new t,this.update(null,0)}function r8a(){}function m8a(e){this._value=e}function bia(e,t,n){for(var i,a,r,o,s,l={},u={},c=[],h={},d=0,p=0,m=t.length;p<m;p++){var g=t[p],f=g.property,_=g.from,y=g.duration,v=g.delay||0;void 0===y&&(y=500),_&&(l[f]=_),u[f]=g.to,r=c,o=h,s=f,_=y,f=v,g=g.ease,o[s]||((g=void 0===g?lia:g)in kia&&(g=kia[g]),g=(s=iia(hia(s,mia)))+" "+dia(_,"ms")+" "+g,0<f&&(g=g+" "+dia(f,"ms")),o[s]=!0,r.push(g)),d=Math.max(d,y+v)}(i={})[nia]=c.join(","),e.set_style(l),e.get_native_prop("offsetHeight"),a=function(){i[nia]="",e.set_style(i),n&&n()},e.set_style(i).set_style(u),Microsoft.Maps.setTimeout(a,d)}function dia(e,t){return e="string"!=typeof e||e.match(/^[\-\.0-9]+$/)?""+e+t:e}function eia(e,t){n(e).set_style(t)}function X7a(){var n=this;this._promise=new Promise(function(e,t){n.resolve=e,n.reject=t})}function Dha(e){var t=this;this._state=0,this._continuations=[];try{e(function(e){t._resolve(e)},function(e){t._reject(e)})}catch(e){this._reject(e)}}function iha(){}function bha(e,t,n){var i,a=aha.call(this,t,n)||this;for(a._capacity=e,i=0;i<e;i++)aha.prototype._create.call(a);return a}function X6a(){}function Q6a(){this.clear()}function G6a(e,t,n,i,a){var r=this;this._workDispatcher=e,this._index=0,this._items=t,this._iterationCallback=n,this._completionCallback=i,this._priority=a,this._action=function(){r._iterate()}}function h6a(){this._dispatchedQueryWithPriority={}}function a6a(e,t,n){void 0===n&&(n=a6a._defaultCapacity);t=_ga.call(this,e,t)||this;return t._capacity=n,t}function Lga(){this._dispatchedQuery=[],this._runningQuery=[],this.tickRaised=new t}function Gga(e,t,n){void 0===n&&(n=1);t=Fga.call(this,e,t)||this;return t.units=n,t}function hga(e){this._capacity=e,this._count=0,this._dictionary={}}function Nea(){}function Gea(e,t,n,i){this._hue=e,this._saturation=t,this._luminance=n,this._alpha=i}function Cea(e){this._multiplier=e}function Aea(){}function E1a(e,a,o,u,c,h,d){var p,m=this,g={};(m=D1a.call(this,g)||this)._mapOptions=a=E1a._initializeMapOptions(a,u),m._coreConfig=u,a.disableInstrumentation&&(i.enableInstrumentation=!1,i.enableErrorInstrumentation=!1,i.perfSDKInclusions=null),v={position:"absolute",overflow:"hidden",width:"100%",height:"100%",top:"0",left:"0"},m._privates=g,m._disposables=[],m._disposables.push(m._workDispatcher=d),f._getUrlParam(window.location,"labelTest")&&(_=f._createElement("div").set_attr("id","labelTestHook").appendTo(e),r.setLabelLogElement(_)),m._id=E1a._nextMapId++,m._container=o,m._disposables.push(m._container),m._processDpiOptions(),e=m._parentElement=n(e),g=m._rootElement=f._createElement("div").appendTo(e).add_class("MicrosoftMap").set_style({"-ms-touch-action":"none"}),m._sizeHelper=new ir(g),m._disposables.push(m._sizeHelper),m._disposables.push(m._sizeHelper.resize.add(function(e){m._privates.setActualSize(e[0]),m.mapResized.invoke()})),m._modeElement=f._createElement("div").appendTo(g).set_style(v),m._overlayElement=f._createElement("div").appendTo(g).set_style(v).set_style({pointerEvents:"none",transform:"scale(1)"}),m._overlayElement.set_style({"z-Index":100}),a.allowInfoboxOverflow&&m._overlayElement.set_style({overflow:"visible"}),m._disposables.push(m.copyrightControlLoaded=new t,m.frameManagerLoaded=new t,m.labelControllerLoaded=new t,m.navigationBarLoaded=new t,m.mapTypeButtonClicked=new t,m.constrainView=new t,m.viewChanging=new t,m.viewChanged=new t,m.targetViewChanged=new t,m.mapResized=new t,m.primitiveTapped=new t,m.primitiveDoubleTapped=new t,m.primitiveHoverStarted=new t,m.primitiveHoverStopped=new t,m.primitiveMoveStarted=new t,m.primitiveMoveContinued=new t,m.primitiveMoveStopped=new t,m.primitiveManipulationStarted=new t,m.primitiveManipulationContinued=new t,m.primitiveManipulationStopped=new t,m.boxZoomStarted=new t,m.boxZoomContinued=new t,m.boxZoomStopped=new t,m.boxZoomCancelled=new t,m.mapPanStarted=new t,m.mapPanContinued=new t,m.mapPanStopped=new t,m.mapZoomStarted=new t,m.mapZoomContinued=new t,m.mapZoomStopped=new t,m.mapManipulationStarted=new t,m.mapManipulationContinued=new t,m.mapManipulationStopped=new t,m.mapTapped=new t,m.mapDoubleTapped=new t,m.keyPressed=new t,m.keyReleased=new t,m.pointerMoved=new t,m.pointerEntered=new t,m.pointerExited=new t,m.pointerWheelChanged=new t,m.pointerPressed=new t,m.pointerReleased=new t,m.contextMenuInvoked=new t,m.copyrightChanged=new t,m.mapTypeChanged=new t,m.mapTypeChangeStarted=new t,m.mapModeChanged=new t,m.actualSizeChanged=new t,m.mapZoomChanged=new t,m.mapRadialMenuChanged=new t,m.setViewInvoked=new t,m.interactionModeUpdated=new t,m.mapOptionsChanged=new t,m.viewChangingAfterPaint=new t,m.birdseyeV2SceneTransitioned=new t,m.modeDOMsMounted=new t),m._disposables.push(m.mapOptionsChanged.add(function(e){m._updateMapOptions(m._mapOptions,e)}),m.mapPanStarted.add(function(){m._isPanning=!0}),m.mapPanStopped.add(function(){m._isPanning=!1})),d=null,a.testHooksOptions&&(a.testHooksOptions.perfRun&&r.setPerfRun(!0,!0),a.testHooksOptions.debugRun&&r.setDebugRun(!0),a.testHooksOptions.enableFunctionalTestHooks&&r.setTestHook(e,u,m),a.testHooksOptions.perfTest&&(d="perfTest")),m._AuthenticateMap(),m._mapOverlayBehavior=new gu,m._mapOverlayBehavior.attach(m);var _=m._getDefaultSize(e),g=_.width,v=_.height;return m._privates.defineProperty("baseLayers",function(e,t){return m._onMapTypeChanged(e,t)},function(e,t){return m._resolveMapType(e,t)}),m._privates.defineProperty("mode",function(e,t){return m._onModeChanged(e,t)}),m._privates.defineProperty("actualSize",function(e,t){return m._onActualSizeChanged(e,t)},null,{isPrivate:!0}),m._privates.defineProperty("desiredSize",function(e,t){return m._onDesiredSizeChanged(e,t)},null,{defaultValue:new nt(g,v)}),m._privates.defineProperty("viewportPadding",null,function(e){return m._setViewportPadding(e)},{defaultValue:{left:0,top:0,right:0,bottom:0}}),m._birdseyeV2ManagerPromise=new ft,m._disposables.push(m._mapTypes=new du(m,u,o,a.mapType,a.tileDomainName),m._layers=new rt),a.center?(p={center:a.center,zoom:void 0},a.center.altitude&&(p.zoom=l.fromLocation(a.center,!0))):p=E1a._getBootstrapLocation(),r.assert(0<u.defaultZoomLevel,"defaultZoomLevel in config is set to incorrect value. coreConfig.defaultZoomLevel = "+u.defaultZoomLevel),(!u.defaultZoomLevel||u.defaultZoomLevel<=0)&&(u.defaultZoomLevel=11),e="number"==typeof a.zoom?a.zoom:p.zoom||u.defaultZoomLevel,_=u.defaultMapType||s.road,(u=a&&a.mapType||_)===s.birdseye&&(m.getMapOptions().disableBirdseye||e<=m._coreConfig.aerialCutOffZoom)&&(u=s.aerial),a.disableStreetside&&(u===s.streetside&&(u=_),a.disableStreetsideAutoCoverage=!0),m._disposables.push(m._allLayers=new eu(m)),m.setBaseLayers(m._resolveMapType(u,m.getMapTypes()[s.road])),o.registerInstance("Map",m),o.registerInstance("allLayers",m._allLayers),m._instrumentationManager=new pu(m,c,h,d),m._landmarksManagerPromise=new ft,m._overlayManager=new ft,m._cityPolygonManagerPromise=new ft,m._disposables.push(m._instrumentationManager),a=a.heading||0,m.setMinZoom(m._mapOptions.minZoom,!1),m.setMaxZoom(m._mapOptions.maxZoom,!1),m.setDesiredSize(new nt(g,v)),m._bootstrapState=0,a=m.getView()||new y(l.toLocation(p.center,e,!0),a),u===s.streetside?m._instantiateMapInStreetsideMapMode(a):m._instantiateMapInCompositeMapMode(a),m._processNavigationBarMapOptions(),i.disposeMapOnPageHide&&(m._pageHideHandler=function(){m.dispose()},n(window).add_event("pagehide",m._pageHideHandler)),(n.Browser.is_ie||n.Browser.is_edge)&&n(window).add_event("beforeunload",m._beforeUnloadDummyHandler),m}function kba(){}function A0a(n,a,r){var o,s;return this._sessionKeyExpiryTime=NaN,this._validAuthenticationResultCode="ValidCredentials",this._invalidCredentialsMessage="The specified credentials are invalid. You can sign up for a free developer account at ",this._devSignUpUrl="http://www.bingmapsportal.com",A0a.instance?(o=A0a.instance,r&&o._mapInstances.push(r),n&&!1===o._hasValidCredentials&&(o._originalCredentials=n,o._logServiceResponse=null,o._hasValidCredentials=void 0)):(this._mapInstances=[],s=i.dynamicProperties,r&&this._mapInstances.push(r),r=this._mapOptions=r&&r.getMapOptions(),r=s.sessionKey||r&&r.sessionKey,this._originalCredentials=s.credentials||n,this._logServiceUriFormat=e._CoreConfig().logServiceUrlFormat,this._callbackPool=[],r&&(this._logServiceResponse=r?{authenticationResultCode:this._validAuthenticationResultCode,sessionId:r}:null,this._hasValidCredentials=!0),this.onAuthBasedFeatureEnabled=new t,this._authFailureCount=0,A0a.instance=o=this),this._hasValidCredentials||(a?o._originalCredentials||(o._hasValidCredentials=!1):o.authenticateClientAndRetrieveSessionId(null)),o}function Waa(e,t,n,i){this._map=e,this._location=t,this._point=n,this.duration=i||225}function yaa(){}function n$(e,t,n,a,r,o){var l,u,c,h,d,p,m,g,_,y,v,b,w,M,C=m$.call(this)||this;C._map=e,C._mapTemplateUrlFormat=t.mapTemplateUrlFormat,C._mapLiteTemplateUrlFormat=t.mapLiteTemplateUrlFormat,C._container=n,C._coreConfig=t,C._templateSelectorCache=new vi(50),C._miscCache=new vi(25),C._completionCallback=o,C._tileDomainName=r,C._pendingCount=t.mapTypeDefinitions.length,n=C._customMapStyleManager=n.instance("CustomMapStyleManager"),(l=C._map.getMapOptions()).customMapStyle&&n.update(l.customMapStyle),u=!!l.liteMode,C._dpiParam=2===e.getDpiScale()?"d2":"";for(var S=e.getZoomOffset(),L="1"===f._getUrlParam(window.location,"loadallstyles"),P=t.mapTypeDefinitions,T=0,x=(P=f._isFeatureEnabled("supportedMaps")?C._getSupportedMapTypeDefs(P,a):P).length;T<x;T++)if((c=P[T])&&c.mapTypeEnabled&&C._isMapTypeAvailable(c.mapType)){if(h=c.data,d=c.liteModeAware,i.isSDK&&!i.isMobile&&c.mapType===s.aerial)for(c.maxZoom=20,p=0;p<h.length;p++)if((m=h[p]).imageryScenes)for(g=0;g<m.imageryScenes.length;g++)"Aerial"===m.imageryScenes[g].imageryId&&(m.imageryScenes[g].maxZoom=20);for(_=new lr(c,l,S),y=0,v=h.length;y<v;y++)w=!!(b=h[y]).liteMode,b.tilePrimer||d&&u!=w||_.insert(C._loadLayer(b,_));M=L||_.id===a,C._loadTemplateAsync(l.enableBingStyle&&c.templateNameBing||c.templateName,u,_,M),C[_.id]=_,C.insert(_)}return C}function $Z(e,t,n){this._imageryId=e,this._map=t,this._imageryCopyrightUrlFormat=n}function DZ(){if(DZ.instance)return DZ.instance}function aV(e,t,n,i,a,r,o,s,l,c,h,d,p,m,g){var f,_;_=(f=t).toLowerCase(),y=f,u.ClientApi&&0<u.ClientApi.length&&(-1<_.indexOf("dev.virtualearth.net/rest")||-1<_.indexOf("dev.ditu.live.com/rest"))&&(y+=-1<f.indexOf("?")?"&":"?",y+="clientApi="+encodeURIComponent(u.ClientApi)),t=y,"undefined"!=typeof FunctionalTestHooks&&FunctionalTestHooks.validateUrl(t);var y=p&&d?uV[d]:uV[t];return function o(e){-1===zV&&(zV=Microsoft.Maps.setTimeout(function(){var e,t,n;zV=-1;var i=Date.now(),a=!1,r=HV;for(e in uV)uV.hasOwnProperty(e)&&(t=uV[e],1===t.status&&(n=t.timeoutDuration-(i-t.startTime),n<=0?t.abortCallback(null,5):(r=Math.min(r,n),a=!0)));a&&o(Math.min(r,JV))},Math.max(LV,e)))}(Math.min(JV,HV)),y||(y={sourceUrl:e,url:t,status:0,successCallbacks:{},errorCallbacks:{},parseResponseCallback:r,callbackStates:{},executor:a,priority:s,hostname:(a=t)?((OV=OV||document.createElement("a")).href=a,OV.hostname):"",jsonso:d,callerId:l,startTime:Date.now(),timeoutDuration:h,logKey:m,referrerPolicy:g,isJsonpRequest:!p&&!!d},d&&(uV[d]=y),p||(uV[t]=y)),y.successCallbacks[c]=n,i&&(y.errorCallbacks[c]=i),o&&(y.callbackStates[c]=o),0===s?nV():Microsoft.Maps.setTimeout(nV,KV),y}function gV(e,t,n,i,a){var r,o,s,l=PV(),u=null;if(e.abortCallback=function(e,t){u=t,l.abort()},l.onreadystatechange=function(){a&&a(l),4===l.readyState&&0!==l.status&&hV(l.response||l.responseText,e.sourceUrl,l.status,2)},l.onabort=function(){return hV(null,e.sourceUrl,null,u)},l.open("GET",e.url),i&&(l.withCredentials=!0),n)for(o=0,s=(r=Object.keys(n)).length;o<s;o++)l.setRequestHeader(r[o],n[r[o]]);return t&&(l.responseType=t),l}function hV(e,t,n,a){var r,o,s,l,u,c=uV[t];if(!c||i.networkJsonpFix&&4===c.status&&c.isJsonpRequest)return window[t]===t&&(r="XsrPrefetchCallback",window[r]?window[r](e,t):window[t]=e),void delete uV[t];c.abortCallback=null,1===c.status&&(wV--,AV[c.hostname]--),c.status=a||2,c.scriptElement&&c.scriptElement.parentNode&&c.scriptElement.parentNode.removeChild(c.scriptElement),c.scriptElement=null,t!==c.url&&(i.networkJsonpFix&&4===c.status&&c.isJsonpRequest||delete uV[t]),delete uV[c.url],(a=2===c.status)&&void 0!==n&&((a=200<=n&&n<300)||(c.status=3)),a&&c.parseResponseCallback&&204!==n&&((a=(t=c.parseResponseCallback(e)).succeeded)||(c.status=3),e=t.response);var h=c.successCallbacks,d=c.callbackStates,p=c.errorCallbacks;if(c.successCallbacks={},c.callbackStates={},c.errorCallbacks={},a)try{for(c.logKey&&(o=Date.now()-c.networkStartTime,ei.record(c.logKey,o)),l=0,u=Object.keys(h);l<u.length;l++)(s=h[u[l]])&&s(e,d[u[l]])}catch(e){if(!Microsoft.Maps.logger)throw e;Microsoft.Maps.logger.logCriticalError(e)}else try{for(iV(c,n),l=0,u=Object.keys(p);l<u.length;l++)p[u[l]](d[u[l]],c.status)}catch(e){if(!Microsoft.Maps.logger)throw e;Microsoft.Maps.logger.logCriticalError(e)}nV()}function iV(e,t,n){var i=u.logger;e=e||{},i&&(n||3===e.status||5===e.status)&&(r.logNetworkData(e.url,"error"),n={feature:it.Network,action:w.Error,data:{httpStatus:""+(t||""),status:""+e.status,cid:e.callerId||"",url:e.url||"",msg:n||""}},i.logCriticalError(null,n))}function nV(){var e,t;for(-1===NV&&(e=u.Internal._CoreConfig(),NV=e.maxConcurrentNetworkRequest,MV=e.maxConcurrentNetworkRequestPerDomain);wV<NV&&(t=function(){var e,t,n,i,a=-1,r=null;for(e in uV)uV.hasOwnProperty(e)&&(t=uV[e],0===t.status&&(n=1e3*t.priority,i=AV[t.hostname]||0,n+=MV<=i?1e4:i,(n<a||-1===a)&&(a=n,r=t)));return r}());)wV++,AV[t.hostname]||(AV[t.hostname]=0),AV[t.hostname]++,t.status=1,t.networkStartTime=Date.now(),t.executor(t)}function oV(e,t,n){var i;n&&((i=n.image)&&(i.onload=i.onerror=i.onabort=null),4!==e&&5!==e||((i=uV[t])&&(i.isAborted=!0),n.release(),n=null)),hV(n,t,2===e?200:5===e?504:3===e?500:null,e)}function tV(e){var t,n=ii.instance,a=i.dynamicProperties;return e=e.replace("{srcparam}",i.tileSourceParam?"&src="+i.tileSourceParam:"").replace("{credentials}",n&&n.getSessionId()).replace("{cmnPltParam}",i.platformCommonParam),t=a.compositionHandlerGenerationId,n&&n.isKeyBasedDataSrcFeatureEnabled&&"o"===i.tileSourceParam&&(t=a.osmGenerationId),e.replace("{odmgenid}",t)}function VU(){this.image=document.createElement("img")}function VS(e,t,n,i){this.center=e,this.width=t,this.height=n,this.crs=ct.instance,this.bounds=[this.getNorth(),this.getEast(),this.getSouth(),this.getWest()],this.originalBounds=i&&i.slice()}function CS(){if(CS.instance)return CS.instance;this.id="LatLon",this.bounds=[90,180,-90,-180]}function tS(e,t){this._objectPool=[],this._objectConstructor=e,this._constructorArguments=t}function aS(e,t,n){var i,a,r,o,s,l,u,c,h,d=_R.call(this)||this;for(d.id=e.mapType,i=(null===(i=t.mapTypeOptions)||void 0===i?void 0:i[e.mapType])||{},d.minZoom=i.minZoom||e.minZoom,d.maxZoom=i.maxZoom||e.maxZoom,a=0,r=Number.MAX_VALUE,o=0,s=e.data;o<s.length;o++)if(l=s[o].imageryScenes)for(u=0,c=l;u<c.length;u++)h=c[u],r=Math.min(r,h.minZoom),a=Math.max(a,h.maxZoom);switch(r<=a&&(d.minZoom=Math.max(d.minZoom,r),d.maxZoom=Math.min(d.maxZoom,a)),d.maxZoom-=n,d.cstl=t.enableBingStyle&&e.cstlBing||e.cstl||"",d._templateSelectorPromise=new Promise(function(e){d._resolveBaseMapTemplateSelector=e}),d.backgroundTileColor="#f3f2ed",d.id){case"be":case"be2":d.displayName="BirdsEye",d.backgroundTileColor="#626963";break;case"r":d.displayName="Road";break;case"a":d.displayName="Aerial",d.backgroundTileColor="#011422";break;case"os":d.displayName="OrdnanceSurvey"}return d}function RR(e,t,n,i){var a=QR.call(this,e,i)||this;return a.defineProperty("dataSource",function(e,t){return a._onDataSourceChanged(e,t)}),t&&a.setDataSource(t),n&&a.setTemplateSelector(n),a.dataVersion=0,a}function LR(e,t,n){r.assertNotNull(e,"fromObj"),r.assertNotNullOrEmpty(t,"fromExpression"),r.assertIsFunction(n,"handler"),this._eventHandle=null,this._handler=n,this._binding=new hr(e,t,this,"value")}function wR(e,t,n,i,a,o){var s,l=this;if(r.assertNotNullOrEmpty(t,"fromExpression"),r.assertNotNull(n,"toObj"),r.assertNotNullOrEmpty(i,"toProperty"),o=o||"OneWay",s=t.split("."),this._source=null,this._sourceChangedHandler=null,this._destChangedHandler=null,this._sourceProperty=s[0],this._value=null,this._childBinding=null,this._paused=!1,this._twoWay=!1,this._converter=a,this._toObj=n,this._toProperty=i,this._isIdentity=t===wR._identityMarker,1<s.length)s.splice(0,1),this._childBinding=new wR(null,s.join("."),n,i,a,o);else if("TwoWay"===o){if(this._isIdentity)throw new Error("Two-way binding on entire data context is not allowed.");this._twoWay=!0,this._destChangedHandler=this._attachChangeHandler(n,function(){return l._updateSourceFromDest()})}this._setSource(e)}function tQ(e,n,a,r,o,s,l,u,c,h){void 0===l&&(l=18e5);h=sQ.call(this,e,n,a,r,o,c=void 0===c?!1:c,h=void 0===h?"":h)||this;return h._minCriticalDataLoadedPercentage=80,h._networkPriority=s,h._sceneContributors=[],h._pendingCriticalDataLoadedResolves=[],h._cacheDuration=l,h.setRenderTarget(0),h._rasterTiles=[],h._disposables.push(h.tileDownloaded=new t),h._disposables.push(h.dataLoaded=new t),h._disposables.push(h.crsReady=new t),h._disposables.push(h.dataLoadFailed=new t),h._disposables.push(h.layerInvalidated=new t),void 0===u&&(u=(i.isMapsVertical||i.isMapsAnswer)&&!f._isFeatureEnabled("disableImageCORS")),h._enableCORS=u,h}function dQ(e,t,n,i,a,r,o){this.priority=e,this._scene=t,this._minHeading=n||0,this._maxHeading=i||0,this._minScale=a||l.toScale(null,23,!0),this._maxScale=r||l.toScale(null,1,!0),this._bounds=o}function yP(e,t,n){return Math.cos(c.degreesToRadians(e))*k.earthCircumference/(n*Math.pow(2,t))}function zP(e,t,n){return c.log2(Math.cos(c.degreesToRadians(e))*k.earthCircumference/(n*t))}function qO(e,t){var n=this;this._disposables=[],this._map=e,this._logger=t,(i.enableInstrumentation||i.perfSDKInclusions)&&this._disposables.push(new ei(this._map)),(t=this._map.getMapOptions().parentPageIG)&&(i.dynamicProperties.mapsIG=i.dynamicProperties.impressionGuid=t),this._disposables.push(this._map.frameManagerLoaded.addOne(function(){return n._onMapFrameManagerLoaded()})),this._disposables.push(this._map.labelControllerLoaded.add(function(){return n._onMapLabelControllerLoaded()})),this._disposables.push(this._map.mapZoomStarted.add(function(e){return n._onMapZoomStarted(e)})),this._disposables.push(this._map.mapPanStarted.add(function(e){return n._onMapPanStarted(e)})),this._disposables.push(this._map.getAllLayers().changed.add(function(e){return n._onMapLayersChanged(e)})),this._disposables.push(this._map.mapTypeChanged.add(function(e){return n._onMapTypeChanged(e)})),this._mapViewChangingHandler=this._map.viewChanging.add(function(e){return n._onMapViewChanging(e)}),this._map.getConfig().enableClientInstrumentationIG&&this._logSnrPageNameForMapControl(i.isSDK?d.mapControlSDKPageNameKey:i.isMsftPartner?d.mapControlMsftPageNameKey:d.oneMapOverlayPageNameKey,!0)}function pO(){}function oO(){}function eO(e,t){this.cameraLocation=e,this.heading=((t||0)%360+360)%360,this.heading=315<this.heading?this.heading-360:this.heading}function TN(e){return SN.call(this,"Event.ClientPerf",e)||this}function RN(){}function QN(){}function PN(){}function ON(){}function JN(e,t,n){this._key=e,this._timestamp=t,this._perfManager=n}function jM(e,n){var i=this;this._map=e,this._allLayers=n,this._currentFrameNumber=this._lastViewChangeFrameNumber=0,this._currentFramePurpose=2,this._currentFrameView=null,this._currentFrameViewport=null,this._disposables=[],this._layerFrameManagers=[],this._layerFrameManagersDisposables=[],this._hiddenLayers=[],this._hiddenLayersDisposables=[],this._frameEventAggregator=new cu,this._layerInfoDictionary={},this._dataPendingLayersId={},this._disposables.push(e.changed.add(function(e){return i._onMapChanged(e)})),e.labelControllerLoaded.addOne(function(){i._disposables.push(e.getLabelController().labelsEnabledChanged.add(function(){return i._setFrame(9)}))},!1,!0),this._disposables.push(n.changed.add(function(e){return i._onMapLayersCollectionChanged(e)})),this._disposables.push(e.getAllLayers().layerChanged.add(function(e){e=e?e.getId():null;i._setFrame(4,[e],null,2)})),e.getConfig().disableHachHackSetFrame?this._disposables.push(e.viewChanged.add(function(e){return i._onMapViewChanged(e)})):(this._disposables.push(e.mapPanStopped.add(function(e){return i._onMapPanStopped(e)})),this._disposables.push(e.mapZoomStopped.add(function(e){return i._onMapZoomStopped(e)}))),this._disposables.push(this.frameSet=new t,this.dataLoaded=new t,this.primitivesRendered=new t,this.labelsRendered=new t,this.frameRendered=new t,this.frameFailed=new t,this.mapReady=new t,this.layerDataLoaded=new t,this.layerPrimitivesRendered=new t,this.layerLabelsRendered=new t,this.layerFrameRendered=new t,this.layerFrameFailed=new t,this.onDisabled=new t),this._initGlobalProcessingEvents()}function PL(e,t){var n,i,a;for(this.frame=e,this._layerData=t,this._layerFilters=[],n=0,i=t.length;n<i;n++)(a=t[n].layer).filterPrimitives&&this._layerFilters.push(a)}function NL(){this._dataLoadedGoalCounter=new hi,this._primitivesRenderedGoalCounter=new hi,this._labelsRenderedGoalCounter=new hi}function LL(){this._goal=0,this._count=0}function PK(e,n,i){var a,r=this;this._map=e,this._layer=n,this._disposables=[],n instanceof ht?this._dataMonitor=n:(this._dataMonitor=new fr(e,n,i),this._disposables.push(this._dataMonitor)),this._frame=ti.frameZero,this._disposables.push(e.changed.add(function(e){return r._onMapChanged(e)})),(a=e.getMode())&&(this._modeFrameRenderedHandler=a.onFrameRendered.add(function(e){return r._onModeFrameRendered(e)}),this._modeFrameFailedHandler=a.onFrameFailed&&a.onFrameFailed.add(function(e){return r._onModeFrameFailed(e)})),n instanceof ht?n.crsReady.add(function(e){return r._onDataMonitorDataLoaded(e)}):(this._disposables.push(this._dataMonitor.dataLoaded.add(function(e){return r._onDataMonitorDataLoaded(e)})),this._disposables.push(this._dataMonitor.dataLoadFailed.add(function(e){return r._onDataMonitorDataLoadFailed(e)}))),this._disposables.push(this._dataMonitor.layerInvalidated.add(function(e){return r._onDataMonitorLayerInvalidated(e)})),i&&e.getConfig().clickBasemapPrimitives&&this._disposables.push(n.primitiveHoverStarted.add(function(e){return r._onPrimitiveHoverStarted(e)}),n.primitiveHoverStopped.add(function(e){return r._onPrimitiveHoverStopped(e)}),n.primitiveTapped.add(function(e){return r._onPrimitiveTapped(e)})),this.frameSet=new t,this.dataLoaded=new t,this.primitivesRendered=new t,this.labelsRendered=new t,this.frameRendered=new t,this.frameFailed=new t,this.layerInvalidated=new t}function vK(e,n,i){var a,r=this;this._map=e,this._layer=n,this._isBaseLayer=i,this._latestLayerFrameData=this._getFrameZeroData(),this._disposables=[],i=n.getDataSource(),a={layerId:n?n.getId():null},i&&i.invalidated&&this._disposables.push(n.getDataSource().invalidated.add(function(e){a.entityIds=e&&e.entityIds,r._onLayerInvalidated(a)})),n.changed&&this._disposables.push(n.changed.add(function(e){("dataSource"===e.name&&void 0!==e.oldValue||"visible"===e.name)&&(e.newValue&&e.newValue.invalidated&&r._disposables.push(e.newValue.invalidated.add(function(){return r._onLayerInvalidated(a)})),r._onLayerInvalidated(a))})),this._disposables.push(this._map.viewChanging.add(function(){r._isViewChanging||r._cancelPendingRequests(),r._isViewChanging=!0})),this._disposables.push(this._map.viewChanged.add(function(){return r._isViewChanging=!1})),this.dataLoaded=new t,this.dataLoadFailed=new t,this.layerInvalidated=new t}function MJ(e,n,i){r.assertNotNull(e,"layer"),r.assertNotNull(i,"frame"),this._layer=e,this._isBaseLayer=n,this._frame=i,this._abortOnFirstDataFailure=f._getCoreConfig().abortOnFirstDataFailure,this._state=1,this._compositeSet=new rr,this.completed=new t,this.cancelled=new t,this.failed=new t}function HJ(e,t,n){r.assertNotNull(e,"id"),r.assertNotNull(t,"primitives"),this._id=e,this._primitives=t,n&&(this._revisions=this._primitives.map(function(e){return e.revision}))}function HI(e,t,n){r.assertNotNull(e,"frame"),r.assertNotNull(t,"layer"),r.assertNotNull(n,"primitiveSet"),this.frame=e,this.layer=t,this._unclippedPrimitiveSet=n}function DI(){this._sets=[]}function bI(e){var n=this;this._userLayerZIndexChangedEventHandlers={},this.revision=0,this.length=0,this.changed=new t,this.layerChanged=new t,this._userLayers=e.getLayers(),this._userLayersChangeHandler=this._userLayers.changed.add(function(e){return n._onLayersChanged(e,!0)}),this.setBaseLayers(e.getBaseLayers())}function PH(e){this.duration=e}function LH(){this._logger=u.logger}function EH(e){this._activator=e}function qH(e,i){this._interval=i=void 0===i?1e3:i,this._elements=e,this._window=n(window),this.resize=new t,this.startMonitoring()}function $G(e,t,n,i){e="number"!=typeof e?parseFloat(e):e;if(isNaN(e)||e<-90||90<e)throw Error("Invalid latitude");if(this.latitude=e,t="number"!=typeof t?parseFloat(t):t,isNaN(t))throw Error("Invalid longitude");this.longitude=t,this.altitude=n||0,this.altitudeReference=k.isValidAltitudeReference(i)?i:-1}function oG(){}function UC(e,t,n){t=e-t,e=n-e;return 0<t&&0<e||t<0&&e<0||0==t||0==e}function rB(e,t){this.minPoint=e,this.maxPoint=t}function ZA(e,t,n){var i,a,r;if(this._rect=e,this._rotation=t=t||0,this.corners=ZA._computeCorners(e,t),n)for(i=0,a=this.corners.length;i<a;i++)(r=this.corners[i]).x+=n.x,r.y+=n.y;this.bbox=c.computeBoundingBox(this.corners),t=[c.getVectorDifference2D(this.corners[1],this.corners[0]),c.getVectorDifference2D(this.corners[2],this.corners[1])],this._normals=[c.normalizeVector2D(new h(-t[0].y,t[0].x)),c.normalizeVector2D(new h(-t[1].y,t[1].x))],this._projections=[c.projectOntoAxis(this._normals[0],this.corners),c.projectOntoAxis(this._normals[1],this.corners)]}function OA(e,n,i,a,r,o,s){void 0===o&&(o=!1),void 0===s&&(s="");var l=this,u={};return(l=NA.call(this,u)||this)._internalId="UserLayer_"+OA._id++,l._id=e||l._internalId,l.logWhenAddedOrRemoved=o,l.logId=s,l.isCritical=a,l._disposables=[],u.defineProperty("zIndex",null,null,{defaultValue:n||0}),u.defineProperty("visible",null,null,{defaultValue:"boolean"!=typeof r||r}),u.defineProperty("opacity",null,null,{defaultValue:"number"==typeof i?i:1}),u.defineProperty("renderTarget",null,null,{defaultValue:0}),u.defineProperty("iconOnlyLimit",null,null,{defaultValue:0}),u.defineProperty("highlighted"),u.defineProperty("templateSelector",null),l.defineProperty=u.defineProperty,l._disposables.push(l.primitiveTapped=new t,l.primitiveDoubleTapped=new t,l.primitiveHoverStarted=new t,l.primitiveHoverStopped=new t,l.primitiveMoveStarted=new t,l.primitiveMoveContinued=new t,l.primitiveMoveStopped=new t,l.primitiveManipulationStarted=new t,l.primitiveManipulationContinued=new t,l.primitiveManipulationStopped=new t,l.contextMenuInvoked=new t,l.primitivePointerPressed=new t,l.primitivePointerReleased=new t),l.setVisible(!0),l.overlayEvent=1,l}function bA(l){var u,c,h=this;this.revision=0,l=l||this,this._privates=l,u={},this.changed=new t,c={},l.defineProperty=function(i,e,o,t){function n(e){var t,n;o&&(e=o(e,u[i])),n=e,e=u[t=i],u[t]=n,a.areEqual(e,n)||(h.revision++,c[t]&&c[t].call(h,e,n),h.changed&&h.changed.invoke(new yt(h,t,e,n)))}var s;r.assertNotNullOrEmpty(i,"name"),e&&r.assertIsFunction(e,"onChanged"),o&&r.assertIsFunction(o,"typeConverter"),s=t&&t.defaultValue,t=t&&t.isPrivate?l:h,void 0!==s&&n(s),s=a.capitalizeProp(i),e&&(c[i]=e),h["get"+s]=function(){return u[i]},t["set"+s]=n},l.undefineProperties=function(){function e(){return null}function t(){}var n,i,r,o,s=Object.keys(u);for(c={},n=0,i=s.length;n<i;n++)r=s[n],o=a.capitalizeProp(r),h["get"+o]=e,h["set"+o]=l["set"+o]=t,u[r]=null;h.changed&&h.changed.dispose()}}function xz(e,n){void 0===n&&(n=!0),this.revision=0,this._allowDuplicates=n,this.changed=new t,e&&Array.prototype.push.apply(this,e)}function ny(e,t,n,i,a,r){this._values=[e,t,n,i,a,r]}function dy(){this._ranges=[]}function Cx(){}function jx(){return ix.call(this)||this}function ax(){this._curveX=new vt,this._curveY=new vt,this._curveZ=new vt,this._curveW=new vt}function Cw(e,t){if(e instanceof Array)this._populateColorComponents(e);else switch(t){case 1:case 2:this._parseHex(e,t);break;case 0:this._parseRgba(e);break;case 3:this._unpackColor(e)}}function Yv(){this._CurveEpsilon=1.192093e-7,this._keys=[]}function wm(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}function zm(e,t,n,i){for(var r,o,s=(i=void 0===i?a.getValue:i)(t,n),l=0,u=e.length-1,c=-1;l<=u;)(o=i(e[r=(l+u)/2|0],n))===s?u=(c=r)-1:s<o?u=r-1:l=1+r;return c}function Am(e,t,n,i){for(var r,o=(i=void 0===i?a.getValue:i)(t,n),s=0,l=e.length;s<l;)i(e[r=(s+l)/2|0],n)<=o?s=1+r:l=r;return s}function Hm(e,t){e/=1e6;return t||(e*=.385641),Im(e,t)}function Im(e,t){var n,i=1;return t?e<.1?(e*=1e6,n=v.L_DistanceUnitMetersSquare_Text,i=0):n=v.L_DistanceUnitKmSquare_Text:e<.1?(e*=27878400,n=v.L_DistanceUnitFeetSquareShort_Text,i=0):n=v.L_DistanceUnitMilesSquareShortText_Text,lm._formatString(v.L_Distance_Format,lm._toFixed(e,i),n)}function Km(e,t){return Lm(e/=t?1e3:1609.34,t)}function Lm(e,t,n,i){var a,r=1,n=50<=e&&n;return e=e&&n?Math.round(e):e,t?e<.1?(e*=1e3,a=v.L_DistanceUnitMeters_Text,r=0):a=v.L_DistanceUnitKm_Text:e<.1?(e*=5280,a=v.L_DistanceUnitFeetShort_Text,r=0):a=u.GlobalConfig.features.directions.bestModeEnabled&&i?v.L_DistanceUnitMilesLongText_Text:v.L_DistanceUnitMilesShortText_Text,lm._formatString(v.L_Distance_Format,lm._toFixed(e,n?0:r),a)}function Om(e,t,n){var i=t+t;return e.indexOf(i)<0?e.replace(t,n):e.replace(i,(n<10?"0":"")+n)}function _m(e,t,n){void 0===n&&(n=!0);t=encodeURI(t).replace(/[\.\(\)\*\+]/g,"\\$&"),e=new RegExp("^(?:.*[&\\?]"+t+"=([^&]*))?.*$","i").exec(e.search),e=e&&e[1]||"";return n?decodeURIComponent(e):e}function Fn(e){return co(e,["house"])}function Gn(e){return co(e,["91572","13344","hotel","vacationrental"])}function In(e){return co(e,["90287","90232","91649","restaurant","food & drink","food & dining"])}function Jn(e){return co(e,["zipcode","ZipCode"])}function Nn(){return!(i.isMapsAnswer&&!i.isMapsVertical)&&i.features.labels.glLabelAndPoi}function Vn(){var e=Microsoft&&Microsoft.Maps&&Microsoft.Maps.Internal;return e&&e._CoreConfig&&e._CoreConfig()}function Xn(e,t,n,a,r){var o,s,l,u=["webgl","experimental-webgl"];if(window.WebGLRenderingContext){for(o={antialias:n,premultipliedAlpha:!0,preserveDrawingBuffer:a,stencil:!1,failIfMajorPerformanceCaveat:!t},l=0;l<u.length;l++)if(s=e.getContext(u[l],o)){s.enable(s.BLEND),r?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST),s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA),s.clearColor(0,0,0,0);var c=i.features.labels,h=1024*(1<=c.textureMulti?c.textureMulti:8),c=s.getParameter(s.MAX_TEXTURE_SIZE);if(h<=c)return s;throw new Error("Hardware texture size "+c+", does not meet the required texture size of "+h)}throw new Error("WebGL initialization failed")}throw new Error("Browser does not support WebGL")}function Zn(e,t){e=document.createElement(e);return e.className=t,e}function ao(e,t,n,a){for(var r,o=i.dynamicProperties.cultureData,s=[],l=-1,u=t.length,c=0;c<u;c++){var h=t.charAt(c),d="'/dMy".indexOf(h),p=0<=d;if(0<=(l=l<0&&!p?c:l)&&(p||c===u-1)&&(s.push(t.substring(l,p?c:c+1)),l=-1),0===d){for(r=c+1;r<u&&"'"!==t.charAt(r);r++);s.push(t.substring(c+1,r)),c=r}else if(1===d)s.push(o.dateSeparator);else if(1<d){for(r=c+1;r<u&&t.charAt(r)===h;r++);s.push(function(e,t,n,a,r){var o,s,l,u=i.dynamicProperties.cultureData;switch(e){case"d":o=3<t?u.dayNames[a?n.getUTCDay():n.getDay()]:3===t?u.abbreviatedDayNames[a?n.getUTCDay():n.getDay()]:((s=a?n.getUTCDate():n.getDate())<10&&1<t?"0":"")+s;break;case"M":l=a?n.getUTCMonth():n.getMonth(),3<t?(o=u.monthGenitiveNames&&!r?u.monthGenitiveNames[l]:o)&&o.length||(o=u.monthNames[l]):3===t?(o=u.abbreviatedMonthGenitiveNames&&!r?u.abbreviatedMonthGenitiveNames[l]:o)&&o.length||(o=u.abbreviatedMonthNames[l]):o=(++l<10&&1<t?"0":"")+l;break;case"y":l=a?n.getUTCFullYear():n.getFullYear(),o=2<t?l.toString():((l%=100)<10&&1<t?"0":"")+l;break;default:o=""}return o}(h,r-c,e,n,a)),c=r-1}}return s.join("")}function bo(){return Microsoft&&Microsoft.Maps&&Microsoft.Maps.GlobalConfig}function co(e,t){var n,i,a;if(e&&t&&((n=e.split("."))&&n.length))for(i=0,a=n.length;i<a;i++)if(n[i]&&-1<t.indexOf(n[i].toLowerCase()))return!0;return!1}function Bk(){}function bk(){this._handlers=[],this._throttledEventInvokers=[],this.isPreviouslyInvoked=!1,this.lastInvokedArgs=null}function W9(e,t,n){r.assertIsFunction(e,"handler"),r.assert(isFinite(t)&&0<t,"Argument: interval should be a positive number."),this.handler=e,this._interval=t,this._eventFilter=n,this._nextScheduledEventId=null}function T9(e,t){this.width=e,this.height=t}function H9(e,t,n){this.x=e,this.y=t,this.z=n}function k9(){}function Ti(e){return n.Effects.Easing.Exponential.ease_in_out(e,4)}function Ui(){return!!(document.fullscreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled)}function Hh(e,t,i,a,r){return this.set_style({zoom:1}),null===e&&(e=function(e,t){return Number(n(e).get_style(t))}),n.Effects.Storyboard.create(this,{opacity:e},{opacity:t},function(e,t){n(e).set_style({opacity:t.opacity})},i,a,r,null).begin(),this}function fd(e,t){return function(){try{ed[t]&&e(Date.now()),delete ed[t]}catch(e){if(!Microsoft.Maps.logger)throw e;Microsoft.Maps.logger.logCriticalError(e)}}}function ba(e,t){if(e===document||!t)return t;for(var n=t;(n=n.parentNode)&&n!==e;);return n===e&&t||null}function da(e,t){var n,i,a,r,o,s;if(t=t||document,e.id)return ga([(o=t,s=e.id,ba(o,(o.document||document).getElementById(s)))],e);if(delete e.id,n=t.getElementsByTagName(e.tag||"*"),(!e.classes||e.classes.length<1)&&(!e.attributes||e.attributes.length<1)&&(!e.pseudos||e.pseudos.length<1))return fa(n);for(i=[],r=n.length,a=0;a<r;a++)ea(e,n[a])&&i.push(n[a]);return i}function ea(e,t){if(t){for(var n=e.propNames,i=n.length,a=0;a<i;a++)if(!sa[n[a]](t,e[n[a]]))return;return 1}}function fa(e){for(var t=[],n=e.length,i=0;i<n;i++)t[i]=e[i];return t}function ga(e,t){for(var n=[],i=e.length,a=0;a<i;a++)e[a]&&1===e[a].nodeType&&ea(t,e[a])&&n.push(e[a]);return n}function ha(e,t){return-1!==va(e,t)}function ia(e){var t;pa.inc();for(var n=pa.name,i=[],a=e.length,r=0;r<a;r++)(t=e[r])[n]!==pa.t&&(t[n]=pa.t,i.push(t));return i}function ja(e,t){if(!e)return!1;for(var n=" "+e+" ",i=t.length;i--;)if(-1===n.indexOf(" "+t[i]+" "))return!1;return!0}function ma(e){this.name=e,this.f=0,this.t=1,this.inc=function(){this.f=(this.t+=2)-1}}function oa(t,n){var i,a,r,o,s,l,u;if(n=n||document,ra.inc(),"string"!=typeof t)return function(e,t){for(var n,i=[],a=t.length;(n=ba(e,t[--a]||t))&&i.push(n),a;);return i}(n||document,t);i=[];try{i=fa(n.querySelectorAll(t))}catch(e){for(o=(a=ua.parse(t)).length,r=0;r<o;r++){for(var c=a[r],h=c.length%2-1,d=0===h?da(c[h],n):[n||document];c[++h];)s=c[h++],(u=c[h]).root=n,l=d,u=u,d=sa[s](l,u);i=1<o?i.concat(d):d}}return i}function Y0(e,t){return e.getAttribute(t)}function Z0(e,t){switch(t.toLowerCase()){case"class":return e.className||null;case"id":return e.id||null;case"href":case"src":if(void 0!==e.getAttribute)return e.getAttribute(t,2)}return e.attributes&&e.attributes[t]&&e.attributes[t].nodeValue||e.getAttribute(t)}function Jb(e){var n=e+"Sibling";return function(e){for(var t=e[n];t&&1!==t.nodeType;)t=t[n];return!t}}function m(e){Array.prototype.push.apply(this,e)}function q(e,t){return e&&e instanceof m?e:new m((e?(t||"string"==typeof e)&&q.query(e,t):[])||e instanceof Array&&e||[e])}}.call(window);
