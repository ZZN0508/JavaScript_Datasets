define("OK/banners/BannerLoader",["OK/logger"],function(s){"use strict";var u={};function t(e){n("onAdsSuccess",e)}function r(e){n("onNoAds",e)}function i(e){n("onScriptError",e)}function n(e,n){if(o=n&&n.slot?n.slot:"",s.success("new-banners",e,o),u.hasOwnProperty(e))for(var t=u[e],r=0,i=t.length;r<i;r++){var a=t[r];"function"==typeof a&&a(n)}var o}return{requestBanner:function(n){window.MRGtag||(window.MRGtag=[],window.MRGtag.push({preventAutoLoad:!0})),require(["mrg/ads"],function(e){window.MRGtag.push({element:n,onAdsSuccess:t,onNoAds:r,onScriptError:i})},function(e){s.success("new-banners","adsLoadingFailed")})},subscribeToEvents:function(e,n){var t,r,i,a,o=[];for(t in n)n.hasOwnProperty(t)&&(r=function(n,t){return function(e){e&&e.slot===n&&t.call(null,e)}}(e,n[t]),a=r,(i=t)&&"function"==typeof a&&(u.hasOwnProperty(i)||(u[i]=[]),u[i].push(a),1)&&o.push({event:t,listener:r}));return{remove:function(){for(;0<o.length;){var e=o.pop();n=e.event,e=e.listener,n&&u.hasOwnProperty(n)&&(0<=(e=(n=u[n]).indexOf(e))&&n.splice(e,1))}var n}}},publishEvent:n}}),define("OK/banners/BannerController",["OK/banners/BannerLoader","OK/banners/StickyBannerContainer","OK/ViewportWidthObserver","OK/utils/dom","OK/logger"],function(o,n,a,t,s){"use strict";var b="data-ad-slot",v="data-ad-query",r="data-site-zone",B="data-pass-height",y="data-pass-width",w="data-json-params",m="h",_="w",J="_SITEID",E="t",O="a",A="g",N="lang",C="u",T="v",P="la",R="test_id",S="_SITEZONE",I="l",D="group",K="ism",L="grname",k="grdesc",H="grpic",M="act",x="_STRING",q={i:"user_id",n:"user_name",r:"days_to_birth",d:"days_birth",m:"month_birth"},i="banner-layout-container",u="__ready",c="__hidden",l=[],p=[],h=[];function V(e){return e.getAttribute(b)}function d(e){var n;e&&(0<=(n=h.indexOf(e))&&h.splice(n,1),clearTimeout(e))}function f(e){e&&j(Y(e.el),!0)}function g(e){e&&j(Y(e.el),!1)}function j(e,n){e&&(e.classList.toggle(u,n),e.classList.toggle(c,!n))}function U(e){e=G(e);e&&n.activate(e)}function W(e){e=G(e);e&&n.deactivate(e)}function G(e){return e&&e.el?t.parent(e.el,"hookBlock"):null}function Y(e){return e?t.parent(e,i,5,!0):null}function F(e,n){n=parseInt(e.getAttribute(n),10);return n=isNaN(n)?0:n}function Z(e,n){j(Y(e),!1),function(e,n){var t={};t[J]=163;var r=X(e);r&&(t[S]=r);var i,a,o,s=(o=e).getAttribute(w)&&JSON.parse(o.getAttribute(w))||{};i=t,a=s,r=Q("hook_Cfg_CurrentUser"),(o=r.bannerTargeting||{}).t?i[E]=o.t:o.a&&(i[O]=o.a,i[A]=o.g),r.lang&&(i[N]=r.lang),a.wu&&o.u&&(i[C]=o.u),a.wv&&o.v&&((o=function(e){var n,t="";for(n in e)e.hasOwnProperty(n)&&(t&&(t+="&"),t+=q[n]+"="+e[n]);return t}(o.v))&&(i[T]=o)),a=t,i=s,o=Q("hook_Cfg_BannerConfig"),i.la&&o.lastApps&&(a[P]=o.lastApps),o.expr&&(a[R]=o.expr),i=t,a=s,o=Q("hook_Cfg_BanData"),a.sz?i[S]=a.sz:a.wsz&&o.sitezone&&(i[S]=o.sitezone),o.groupId&&(i[D]=o.groupId),o.isaMember&&(i[K]=o.isaMember),i=t,(o=s).cow&&(i[I]="1"),o.grname&&(i[L]=o.grname),o.grdesc&&(i[k]=o.grdesc),o.grpic&&(i[H]=o.grpic),o.act&&(i[M]="1"),o._STRING&&(i[x]=o._STRING),"true"===e.getAttribute(B)&&(t[m]=document.documentElement.clientHeight),"true"===e.getAttribute(y)&&(t[_]=(o=e,u=window.getComputedStyle(o,null),e=parseInt(u.paddingLeft,10),u=parseInt(u.paddingRight,10),o.clientWidth-e-u));var u,c,l=(u=n.getAttribute(v),c={},u.replace(/([^=]*)=([^&]*)&*/g,function(e,n,t){c[n]=decodeURIComponent(t)}),c);!function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])}(l,t);var p,h=[];for(p in l)l.hasOwnProperty(p)&&h.push(p+"="+encodeURIComponent(l[p]));var d=s.b_count;if(d&&0<d){var f=V(n),s=z(f,0);n.setAttribute(b,s);for(var g=1;g<d;g++)h.push("q="+z(f,g))}n.setAttribute(v,h.join("&"))}(e,n),o.requestBanner(n)}function z(e,n){return encodeURIComponent(e+"."+n+"?n="+n)}function Q(e){e=document.getElementById(e);return e&&OK.util.parseJSON(e.innerHTML)||{}}function X(e){return e.getAttribute(r)}function e(e){for(var n=0;n<e.length;n++){var t=e[n];t&&"function"==typeof t.remove&&t.remove()}}return{activate:function(n){var e,t,r,i=function(e){e=Array.prototype.slice.call(e.getElementsByTagName("ins"));return 0===e.length?null:e[0]}(n);i&&(e=V(i),t=o.subscribeToEvents(e,{onAdsSuccess:f,onHideBanner:g}),p.push(t),"true"===n.getAttribute("data-sticky-banner")&&(t=o.subscribeToEvents(e,{onAdsSuccess:U,onHideBanner:W}),p.push(t)),(t=function(n,t){var r,i=F(n,"data-refresh-timeout");if(i<=0)return null;function e(e){r=function(n,t,e){d(r);e=setTimeout(function(){var e=V(t);o.publishEvent("onRefreshBanner",{el:t,slot:e}),Z(n,t)},e);return h.push(e),e}(n,t,i)}var a=V(t);return o.subscribeToEvents(a,{onAdsSuccess:e,onNoAds:e,onScriptError:e,onHideBanner:function(e){d(r)}})}(n,i))&&p.push(t),0<(r=F(n,"data-right-visibility-min-width"))?(t=a.onToggle(r,function(e){e?Z(n,i):function(e){e.innerHTML="";var n=e.getAttribute(b);o.publishEvent("onHideBanner",{el:e,slot:n})}(i)}),l.push(t),function(e,n,t){e=e<=window.innerWidth;t&&(n+="."+t),n=n,s.success("new-banners",e?"activate.binv":"activate.boutv",n)}(r,e,X(n))):Z(n,i))},deactivate:function(){e(l),e(p),function(e){for(var n=0;n<e.length;n++){var t=e[n];t&&clearTimeout(t)}}(h),l=[],p=[],h=[]}}}),define("OK/banners/bannerNew/hooks/BannerNavigationDataProviderHookJs",["require","exports","OK/JsonCustomHook","OK/BanDataCfgJs"],function(e,n,t,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,t=((i=t.JsonCustomHook)&&(a.__proto__=i),((a.prototype=Object.create(i&&i.prototype)).constructor=a).prototype.applyContent=function(e){r.BanDataCfgJs.getInstance().setData(e)},a);function a(e,n){i.call(this,"json_abp",n)}n.default=t}),define("OK/banners/bannerNew/config/ApplicationBannerCfgJs",["require","exports"],function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ApplicationBannerCfgJs=void 0;function t(e){this.discussionsTopSlot=+e.discussionsTop}t.prototype.getDiscussionsTopSlot=function(){return this.discussionsTopSlot},n.ApplicationBannerCfgJs=t}),define("OK/banners/bannerNew/config/BannerMultiloadCfgJs",["require","exports"],function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BannerMultiloadCfgJs=void 0;var t={maxLatency:"500",heartbeatDelay:"150",concurrency:"9999",url:"https://ad.mail.ru/adq/"};n.BannerMultiloadCfgJs=function(e){e=Object.assign(Object.assign({},t),e),this.maxLatency=+e.maxLatency,this.heartbeatDelay=+e.heartbeatDelay,this.concurrency=+e.concurrency,this.url=e.url}}),define("OK/banners/bannerNew/config/BannerRefreshPolicyCfgJs",["require","exports"],function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BannerRefreshPolicyCfgJs=void 0;function t(e){this.data=e}t.prototype.getTimeout=function(e){e="timeout."+e,e=this.data.hasOwnProperty(e)?this.data[e]:null;return null!==e?e:this.data["timeout.default"]},t.prototype.getTransition=function(e){e="transition."+e,e=this.data.hasOwnProperty(e)?this.data[e]:null;return null!==e?e:this.data["transition.default"]||!1},n.BannerRefreshPolicyCfgJs=t}),define("OK/banners/bannerNew/config/BannerCfgJs",["require","exports","OK/GwtConfig","OK/banners/bannerNew/config/ApplicationBannerCfgJs","OK/banners/bannerNew/config/BannerMultiloadCfgJs","OK/banners/bannerNew/config/BannerRefreshPolicyCfgJs"],function(e,n,t,r,i,a){"use strict";var o;Object.defineProperty(n,"__esModule",{value:!0}),n.BannerCfgJs=void 0;var s,t=((s=t.GwtConfig)&&(u.__proto__=s),((u.prototype=Object.create(s&&s.prototype)).constructor=u).prototype.setData=function(e){s.prototype.setData.call(this,e),this.lastApplications=this.data.lastApps,this.applicationBannerCfg=new r.ApplicationBannerCfgJs(this.data.applicationBannerSlots||{}),this.multiLoad=new i.BannerMultiloadCfgJs(this.data.adm||{}),this.timeoutCfg=new a.BannerRefreshPolicyCfgJs(this.data.timeouts),this.expr=this.data.expr||null,this.vhaBannerDebug=this.data.vha_debug||!1,this.abpWhiteListEnabled=this.data.abp_wl||!1,this.discussionsRefreshEnabled=this.data.dre||!1},u.prototype.getApplicationBannerCfg=function(){return this.applicationBannerCfg},u.getInstance=function(){return o=o||new u},u.getLastApplications=function(){try{return u.getInstance().lastApplications}catch(e){return null}},u.getMultiLoad=function(){try{return u.getInstance().multiLoad}catch(e){return new i.BannerMultiloadCfgJs({})}},u.getRefreshPolicyCfg=function(){try{return u.getInstance().timeoutCfg}catch(e){return new a.BannerRefreshPolicyCfgJs({})}},u.getCurrentExperiment=function(){try{return u.getInstance().expr}catch(e){return null}},u);function u(){s.call(this,"BannerConfig")}n.BannerCfgJs=t}),define("OK/banners/bannerNew/utils/BannerCommon",["require","exports","OK/utils/environment","OK/cookie"],function(e,n,t,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getEffectiveViewportHeight=n.createLog=n.log=void 0;function i(){}var a=t.isDebug&&"true"===r.readCookie("banners-debug");n.log=function(){for(var e=arguments.length,n=Array(e);e--;)n[e]=arguments[e];for(var t,r=[],i=arguments.length;i--;)r[i]=arguments[i];a&&(t=["[native banner]"].concat(r,n),console.log.apply(console,t))},n.createLog=function(r){return a?function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var t=["[native banner / "+r+"]"].concat(e);console.log.apply(console,t)}:i},n.getEffectiveViewportHeight=function(){var e=window.OK.topPanelHeight();return window.innerHeight-e}}),define("OK/banners/bannerNew/utils/BufferedCommandJs",["require","exports"],function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BufferedCommandJs=void 0;function t(e,n,t){var r=this;this.bufferingPeriod=e,this.heartbeatPeriod=n,this.bufferingTimer=new i(function(){r.heartbeatTimer.cancel(),r.doExecute()}),this.heartbeatTimer=new i(function(){r.bufferingTimer.cancel(),r.doExecute()}),this.execute=t}t.prototype.doExecute=function(){this.execute(),this.running=!1},t.prototype.destroy=function(){this.running&&(null!==this.bufferingTimer&&this.bufferingTimer.cancel(),null!==this.heartbeatTimer&&this.heartbeatTimer.cancel())},t.prototype.force=function(){this.bufferingTimer.cancel(),this.heartbeatTimer.cancel(),this.doExecute()},t.prototype.invoke=function(){this.running?this.heartbeatTimer.cancel():(this.running=!0,this.bufferingTimer.schedule(this.bufferingPeriod())),this.heartbeatTimer.schedule(this.heartbeatPeriod())},n.BufferedCommandJs=t;var i=function(e){this.callback=e};i.prototype.schedule=function(e){this.cancel(),this.timer=setTimeout(this.callback,e)},i.prototype.cancel=function(){this.timer&&(clearTimeout(this.timer),this.timer=0)}}),define("OK/banners/bannerNew/transport/BannerTransportJs",["require","exports","OK/banners/bannerNew/config/BannerCfgJs","OK/banners/bannerNew/utils/BannerCommon","OK/banners/bannerNew/utils/BufferedCommandJs","OK/logger"],function(e,n,a,t,r,o){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BannerTransportJs=void 0;function i(){this.requests=new E,this.flushCommand=new r.BufferedCommandJs(function(){return a.BannerCfgJs.getMultiLoad().maxLatency},function(){return a.BannerCfgJs.getMultiLoad().heartbeatDelay},this.flush.bind(this))}var s=t.createLog("BannerTransportJs"),u="rb_tadq_"+Date.now(),c=1,l={},p={},h=0,d=[],f=0,g={},b=null;function v(e){return"blwrapper_"+e}function B(){return Object.getOwnPropertyNames(p).length<a.BannerCfgJs.getMultiLoad().concurrency}function y(e,n){s("sendJSONPRequest",e,n);var t,r=f+++"";n.forEach(function(e){g[e]=r}),t=r,n=e,(e=document.createElement("script")).type="text/javascript",e.src=n+"&nn="+h,e.async=!0,e.id=v(t),e.onerror=function(e){w(t)},document.head.appendChild(e),p[t]=Date.now()}function w(e){for(var n in g)g.hasOwnProperty(n)&&g[n]==e&&m(n,"")}function m(e,n){s("handleResponse",{id:e,response:n});try{var t=l[e];t&&t.handleResponse(n)}catch(e){o.errorEx(e,"BannerTransport","callback")}try{var r=g[e];delete g[e],r&&function(e){try{delete p[e];var n,t=v(e),r=document.getElementById(t);null!==r&&r.parentNode&&(r.parentNode.removeChild(r),h++),B()&&d.length&&y((n=d.shift()).url,n.reqIds)}catch(e){throw o.errorEx(e,"BannerTransport","cleanup_"),e}}(r)}catch(e){o.errorEx(e,"BannerTransport","after_callback")}}i.prototype.flush=function(){var e=a.BannerCfgJs.getMultiLoad().url,t=[],r=this.requests.requests,n=Object.getOwnPropertyNames(r),i=[];n.length&&(n.forEach(function(e){var n=r[e];i.push(n),t.push("q="+encodeURIComponent(e+"?n="+n)),o.success("ad",OK.getCurrentDesktopModelId(),e)}),s("flush, q",t),this.appendCookielessUserSyncParameters(),e=e+"?callback="+u+"&_SITEID=163&"+t.join("&")+"&"+this.encodeParams(this.requests.params),this.requests.clear(),s("flush",e,i),this.addJSONPRequest(e,i))},i.prototype.appendCookielessUserSyncParameters=function(){var i=this;[localStorage,sessionStorage].forEach(function(n){if(n)try{var e=n.getItem("rb_sync_id");if(e){var t,r=JSON.parse(e);for(t in r)r.hasOwnProperty(t)&&(i.requests.params[t]=r[t])}}catch(e){s("can not get rb_sync_id from "+n,e)}})},i.prototype.sendJSONP=function(e,n,t){this.requests.addRequest(e,n,t)||(this.flushCommand.force(),this.requests.addRequest(e,n,t)),this.flushCommand.invoke()},i.prototype.sendRequest=function(e,n,t){var r="nbnr"+c++;l[r]=new _(r,t),this.sendJSONP(r,e,n)},i.prototype.addJSONPRequest=function(e,n){B()?(s("addJSONPRequest now",e,n),y(e,n)):(s("addJSONPRequest queue",e,n),this.queueJSONPRequest(e,n))},i.prototype.queueJSONPRequest=function(e,n){d.push(new J(e,n))},i.prototype.sendClick=function(e,n){var t=this;setTimeout(function(){(new Image).src=e+"?"+t.encodeParams(n)},100)},i.prototype.encodeParams=function(t){var e=Object.getOwnPropertyNames(t);if(e.length){var r=[];return e.forEach(function(e){var n=t[e];null!=n&&r.push(e+"="+encodeURIComponent(n))}),r.join("&")}return""},i.appendParam=function(e,n,t){if(null!==t)switch(typeof t){case"string":e[n]=t;break;case"number":e[n]=t+""}return e},i.getInstance=function(){return b=null===b?new i:b},n.BannerTransportJs=i,window[u]=function(e){if(s("handleAdq",e),null!==e)try{var n=e.length;if(0!==n)for(var t=0;t<n;t++){var r,i,a=e[t];null!==a&&"object"==typeof a?(r=a.name)?void 0!==(i=a.html)?m(r,i):o.errorEx(new Error("ADQ invalid 'html'"),"BannerTransport","adq-html"):o.errorEx(new Error("ADQ invalid 'name'"),"BannerTransport","adq-name"):o.errorEx(new Error("ADQ invalid item"),"BannerTransport","adq-item")}else o.errorEx(new Error("ADQ empty array"),"BannerTransport","adq-array")}catch(e){o.errorEx(new Error("ADQ unexpected"),"BannerTransport","adq-unknown")}else o.errorEx(new Error("ADQ null response"),"BannerTransport","adq-callback")},setInterval(function(){try{var n=[];Object.getOwnPropertyNames(p).forEach(function(e){5e3<Date.now()-p[e]&&n.push(e)}),n.forEach(function(e){w(e)})}catch(n){o.errorEx(n,"BannerTransport","cleanup")}},5e3);var _=function(e,n){this.id=e,this.request=n,this.request.setCancellationListener(this)};_.prototype.handleResponse=function(e){this.request.handleResponse(e)},_.prototype.onCancel=function(){delete l[this.id]};var J=function(e,n){this.url=e,this.reqIds=n},E=function(){this.requests={},this.params={}};E.prototype.clear=function(){this.requests={},this.params={}},E.prototype.addRequest=function(e,n,t){var r=this;if(this.requests.hasOwnProperty(n))return!1;for(var i=(i=Object.getOwnPropertyNames(this.params)).filter(function(e){return t.hasOwnProperty(e)}),a=0;a<i.length;a++){var o=i[a];if(t[o]!==this.params[o])return!1}return this.requests[n]=e,Object.getOwnPropertyNames(t).forEach(function(e){r.params[e]=t[e]}),!0}}),define("OK/banners/bannerNew/utils/BannerConstantJs",["require","exports"],function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BannerConstantJs=void 0;function t(){}(n.BannerConstantJs=t).TARGETING_PARAMETER="t",t.RECOMMENDED_TARGETING_PARAMETER="tr",t.USER_AGE="a",t.USER_GENDER="g",t.PERSONAL_DATA_KEY="v",t.UNIQUE_ID_KEY="u",t.POSITION_KEY="p",t.IN_LAYER="layer",t.WITH_LAST_APPS="la",t.PERSONAL_DATA_ID_KEY="i",t.PERSONAL_DATA_NAME_KEY="n",t.PERSONAL_DATA_BIRTH_DAY_KEY="d",t.PERSONAL_DATA_BIRTH_MONTH_KEY="m",t.PERSONAL_DATA_DAYS_TO_BIRTH_KEY="r",t.PERSONAL_DATA_IS_COMPANYOWNER="cow",t.WITH_UNIQUE_ID="wu",t.WITH_PERSONAL_DATA="wv",t.VIEWPORT_HEIGHT="h",t.EXPR="test_id",t.EXPR_4246="rf4246",t.EXPR_DELAY="rfd",t.VISIBLE="visible",t.SITEZONE_PARAM="_SITEZONE",t.WITH_SITE_ZONE_BANNER_PARAM="wsz",t.SITE_ZONE_BANNER_PARAM="sz",t.SITENAME="sitename",t.GROUP_ID_PARAM="group",t.GROUP_NAME_PARAM="grname",t.GROUP_DESCRIPTION_PARAM="grdesc",t.GROUP_AVATAR_URL_PARAM="grpic",t.IS_GROUP_ACTIVE_MEMBER_PARAM="ism",t.LANGUAGE="lang",t.APPS_BANNERS_WITH_CUSTOM_TITLE="act",t.APPS_BANNERS_APP_SHORT_NAME="_STRING"}),define("OK/banners/bannerNew/banners/BannerProxyJs",["require","exports","OK/banners/bannerNew/utils/BannerCommon","OK/logger"],function(e,n,t,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BannerProxyJs=void 0;var i=t.createLog("BannerProxyJs"),t=function(e){this.delegate=null,this.ops=null,this.options=e};t.prototype.init=function(e){if(null===this.ops){this.ops=[],this.ops.push(e?0:1);try{this.delegate=this.options.createDelegate(),i("delegate",this.delegate)}catch(e){return i("error",e),void r.errorEx(e,"BannerProxy","delegate_init_"+this.options.key())}for(var n=0;n<this.ops.length;n++){var t=this.ops[n];if(i("op",t),null===this.delegate)return;try{switch(t){case 0:this.delegate.init(!0);break;case 1:this.delegate.init(!1);break;case 2:this.delegate.show();break;case 3:this.delegate.hide();break;case 4:this.delegate.destroy()}}catch(e){return i("error",e),void r.errorEx(e,"BannerProxy","delegate_replay_"+t)}}}},t.prototype.show=function(){null!==this.delegate?this.delegate.show():this.ops.push(2)},t.prototype.hide=function(){null!==this.delegate?this.delegate.hide():this.ops.push(3)},t.prototype.destroy=function(){null!==this.delegate?(this.delegate.destroy(),this.delegate=null):this.ops.push(4)},n.BannerProxyJs=t}),define("OK/banners/bannerNew/data/BannerDataNull",["require","exports"],function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BannerDataNull=void 0;function t(){}(n.BannerDataNull=t).NULL=new t}),define("OK/banners/bannerNew/data/BannerDataText",["require","exports"],function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BannerDataText=void 0,n.BannerDataText=function(e){this.text=e}}),define("OK/banners/bannerNew/data/BannerDataJson",["require","exports"],function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BannerDataJson=void 0;function t(e){this.height=t.getStringNotNull(e,t.INTERNAL_HEIGHT_KEY),this.width=t.getStringNotNull(e,t.INTERNAL_WIDTH_KEY),this.clickUrl=t.getStringNotNull(e,t.INTERNAL_PIXEL_URL_KEY),this.targetUrl=t.getTargetUrl(e)}t.getStringNotNull=function(e,n){return e[n]||""},t.getTargetUrl=function(e){return(t.getStringNotNull(e,t.INTERNAL_URL_KEY)||t.getStringNotNull(e,t.INTERNAL_URL_1_KEY)).replace(/^https?:\/\/[^\/]+/,"")},(n.BannerDataJson=t).INTERNAL_IMG_URL_KEY="img_file",t.INTERNAL_PIXEL_URL_KEY="click_url",t.INTERNAL_URL_KEY="url",t.INTERNAL_URL_1_KEY="url1",t.INTERNAL_HEIGHT_KEY="height",t.INTERNAL_WIDTH_KEY="width",t.INTERNAL_TITLE_KEY="title"}),define("OK/banners/bannerNew/data/BannerDataImage",["require","exports","OK/banners/bannerNew/data/BannerDataJson"],function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BannerDataImage=void 0;var r,i=((r=t.BannerDataJson)&&(a.__proto__=r),(a.prototype=Object.create(r&&r.prototype)).constructor=a);function a(e){r.call(this,e);var n=(e.img_file||"").trim();this.url=n||null,this.title=t.BannerDataJson.getStringNotNull(e,t.BannerDataJson.INTERNAL_TITLE_KEY),this.impressionUrls=e.impression_urls}n.BannerDataImage=i}),define("OK/banners/bannerNew/BannerModelJs",["require","exports","OK/banners/bannerNew/utils/BannerConstantJs","OK/banners/bannerNew/transport/BannerTransportJs","OK/banners/bannerNew/data/BannerDataNull","OK/banners/bannerNew/data/BannerDataText","OK/banners/bannerNew/data/BannerDataJson","OK/CurrentUserCfg","OK/banners/bannerNew/data/BannerDataImage","OK/utils/utils"],function(e,n,r,i,t,a,o,s,u,c){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.RequestJs=n.BannerModelJs=void 0;function l(e,n,t){this.loader=t,this.slot=e,this.params=n}l.prototype.request=function(e){e=new p(e,this.slot);return this.process(e),e},l.prototype.click=function(e){var n={r:Date.now()+""},t=s.CurrentUserCfg.getInstance().getBannerParameters()[r.BannerConstantJs.TARGETING_PARAMETER];t&&i.BannerTransportJs.appendParam(n,r.BannerConstantJs.TARGETING_PARAMETER,t),this.loader.sendClick(e,n)},l.prototype.process=function(e){null!==this.slot.getValue()?this.sendReq(e):e.handleResponse(null)},l.prototype.sendReq=function(e){this.loader.sendRequest(this.slot.getValue(),this.params.asJSON(),e)},n.BannerModelJs=l;var p=function(e,n){this.ready=e,this.slot=n};p.prototype.getResponse=function(){return this.response},p.prototype.cancel=function(){null!==this.cancellationListener&&this.cancellationListener.onCancel()},p.prototype.handleResponse=function(e){var n;e?null===(n=this.tryParseJSON(e))?this.response=new a.BannerDataText(e):n.hasOwnProperty(o.BannerDataJson.INTERNAL_IMG_URL_KEY)?this.response=new u.BannerDataImage(n):this.response=t.BannerDataNull.NULL:this.response=t.BannerDataNull.NULL,this.ready.handleResponse(this.response)},p.prototype.tryParseJSON=function(e){e=e.trim();try{return c.parseJson(e)}catch(e){return null}},p.prototype.setCancellationListener=function(e){this.cancellationListener=e},n.RequestJs=p}),define("OK/banners/bannerNew/config/BannerParamsJs",["require","exports","OK/banners/bannerNew/utils/BannerConstantJs","OK/banners/bannerNew/transport/BannerTransportJs","OK/banners/bannerNew/config/BannerCfgJs","OK/banners/bannerNew/utils/BannerCommon","OK/CurrentUserCfg","OK/utils/dom"],function(e,n,s,u,c,l,p,h){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BannerParamsJs=void 0;var r={};r[s.BannerConstantJs.PERSONAL_DATA_ID_KEY]="user_id",r[s.BannerConstantJs.PERSONAL_DATA_NAME_KEY]="user_name",r[s.BannerConstantJs.PERSONAL_DATA_DAYS_TO_BIRTH_KEY]="days_to_birth",r[s.BannerConstantJs.PERSONAL_DATA_BIRTH_DAY_KEY]="days_birth",r[s.BannerConstantJs.PERSONAL_DATA_BIRTH_MONTH_KEY]="month_birth";function d(e,n,t){this.withViewportHeight=!1,this.considerCompactFooter=!1,this.withUniqueId=e,this.withPersonalData=n,this.withLastApps=t}d.prototype.asJSON=function(){var e,n,t,r,i={},a=p.CurrentUserCfg.getInstance();null!==a&&((e=(t=a.getBannerParameters())[s.BannerConstantJs.TARGETING_PARAMETER])?u.BannerTransportJs.appendParam(i,s.BannerConstantJs.TARGETING_PARAMETER,e):(n=t[s.BannerConstantJs.USER_AGE])&&(u.BannerTransportJs.appendParam(i,s.BannerConstantJs.USER_AGE,n),u.BannerTransportJs.appendParam(i,s.BannerConstantJs.USER_GENDER,t[s.BannerConstantJs.USER_GENDER])),n=t[s.BannerConstantJs.UNIQUE_ID_KEY],this.withUniqueId&&null!==n&&u.BannerTransportJs.appendParam(i,s.BannerConstantJs.UNIQUE_ID_KEY,n),t=d.getPersonalData(t),this.withPersonalData&&null!==t&&u.BannerTransportJs.appendParam(i,s.BannerConstantJs.PERSONAL_DATA_KEY,t),(a=a.getLanguage())&&u.BannerTransportJs.appendParam(i,s.BannerConstantJs.LANGUAGE,a)),!this.withLastApps||null!==(r=c.BannerCfgJs.getLastApplications())&&(i[s.BannerConstantJs.WITH_LAST_APPS]=r),this.withViewportHeight&&(o=l.getEffectiveViewportHeight(),this.considerCompactFooter&&(o-=(r=h.firstByClass(document.body,"compact-footer"))?r.offsetHeight:0),i[s.BannerConstantJs.VIEWPORT_HEIGHT]=o+"");var o=c.BannerCfgJs.getCurrentExperiment();return o&&(i[s.BannerConstantJs.EXPR]=o),i},d.prototype.setWithViewportHeight=function(e){this.withViewportHeight=e},d.prototype.setConsiderCompactFooter=function(){this.considerCompactFooter=!0},d.getPersonalData=function(e){var n=e[s.BannerConstantJs.PERSONAL_DATA_KEY];if(!n)return null;var t=[];return Object.getOwnPropertyNames(n).forEach(function(e){t.push(r[e]+"="+n[e])}),t.join("&")},n.BannerParamsJs=d}),define("OK/banners/bannerNew/utils/JSEvaluatorJs",["require","exports"],function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JSEvaluatorJs=void 0;var JSEvaluatorJs=function(){var t=this;this.logErrorWrapper=function(e,n){t.logError(e,n)}};JSEvaluatorJs.findNearestPlace=function(e,n){for(;null!==e&&0<n;){var t=e.getAttribute(JSEvaluatorJs.JSPLACE_ATTR_NAME);if(t)return t;e=e.parentElement,n--}return null},JSEvaluatorJs.evalScript=function evalScript(text){text.replace(/(^[^<]*<!--)|(-->[^>]*$)/g,""),text&&(window.execScript?window.execScript(text):window.eval?window.eval(text):eval(text))},JSEvaluatorJs.prototype.findAndEvalScripts=function(e){var i=this,e=e.getElementsByTagName("script");e.length&&Array.from(e).forEach(function(e){var n,t,r=e.getAttribute("src");null!==r&&r.trim()?((n=e.parentNode).removeChild(e),(t=document.createElement("script")).src=r,t.type="text/javascript",null!==(r=e.getAttribute("onload"))&&i.addOnloadScript(t,r),n.appendChild(t)):(t=e.innerHTML,i.evalInlineJS(e,t))})},JSEvaluatorJs.prototype.evalInlineJS=function(e,n){if(n)try{this.setUpEvalContext(e),JSEvaluatorJs.evalScript(n)}catch(n){this.logError(e,n)}finally{OK.logging.tearDown()}},JSEvaluatorJs.prototype.setUpEvalContext=function(e){OK.logging.setUp(OK.fn.delegate(this.logErrorWrapper,[e],this))},JSEvaluatorJs.prototype.logError=function(e,n){},JSEvaluatorJs.prototype.addOnloadScript=function(e,n){var t=this;e.onload=function(){t.evalInlineJS(e,n)}},exports.JSEvaluatorJs=JSEvaluatorJs,JSEvaluatorJs.JSPLACE_ATTR_NAME="jsplace"}),define("OK/banners/bannerNew/utils/HtmlRendererJs",["require","exports","OK/banners/bannerNew/utils/BannerCommon","OK/banners/bannerNew/utils/JSEvaluatorJs","OK/logger"],function(e,n,t,r,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.HtmlRendererJs=void 0;var a=new r.JSEvaluatorJs,o=(t.createLog("HtmlRendererJs"),!1);a.logError=function(e,n){var t=r.JSEvaluatorJs.findNearestPlace(e,3)||"unknown",e=n.message?n.message.substr(64):"";i.trace("testing",n.stack,"jsban_"+t,e)};function s(){this.log=t.createLog("HtmlRendererJs")}s.prototype.setBannerPlace=function(e,n){e.setAttribute(r.JSEvaluatorJs.JSPLACE_ATTR_NAME,"p"+n)},s.prototype.setBannerHtml=function(e,n){o=!0,this.log("setBannerHtml",{el:e,html:n}),e.innerHTML=n,a.findAndEvalScripts(e),o=!1},s.isInjection=function(){return o},n.HtmlRendererJs=s}),define("OK/banners/bannerNew/BannerViewJs",["require","exports","OK/banners/bannerNew/data/BannerDataNull","OK/banners/bannerNew/data/BannerDataImage","OK/banners/bannerNew/data/BannerDataText","OK/banners/bannerNew/utils/HtmlRendererJs","OK/DispatcherJs","OK/BanDataCfgJs"],function(e,n,t,r,i,a,o,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BannerViewJs=void 0;var u={},c=0,l=null;function p(){"function"==typeof window.trg_gc&&window.trg_gc()}function h(){return l=null===l?new a.HtmlRendererJs:l}var d={container:null,slot:null,inline:!1,onRender:null,onError:null},f=function(e){this.contentChangeObserver=null;e=Object.assign(Object.assign({},d),e);this.options=e,this.container=e.container,this.uid=""+c++,null!==e.slot.getValue()&&h().setBannerPlace(e.container,e.slot.getValue()),this.heightChangeWatcher=new m(this),this.nullBannerRenderer=new B(this),this.textBannerRenderer=new y(this),this.imageBannerRenderer=new w(this)};f.prototype.isInline=function(){return this.options.inline},f.prototype.attach=function(e){(u[this.uid]=this).banner=e,this.heightChangeWatcher.start(),this.createBannerDomObserver(this.container)},f.prototype.detach=function(){this.destroyBannerDomObserver(),this.heightChangeWatcher.stop(),this.renderBannerForDetach(),this.banner=null,u[this.uid]=null},f.prototype.isInViewport=function(e){if("hidden"===document.visibilityState)return!1;if(e&&window.OK.Layers.isAnyLayerOpened())return!1;var n=this.container,t=s.BanDataCfgJs.getInstance().checkInViewportThreshold,r=window.pageYOffset,i=window.innerHeight,e=n.getBoundingClientRect(),n=e.height*t,t=e.top+r,e=e.bottom+r;if(i<n)return!1;i+=r;return t+n<i&&r<t||r<e-n&&e<i||t<r&&i<e},f.prototype.getContainer=function(){return this.container},f.prototype.showContainer=function(){var e=this;this.container.style.display="block",this.container.style.visibility="hidden",setTimeout(function(){null!==e.container&&(e.container.style.visibility="visible")},100)},f.prototype.hideContainer=function(){this.container.style.display="none"},f.prototype.setBannerHtml=function(e){h().setBannerHtml(this.container,e)},f.prototype.renderBannerForDetach=function(){var e=t.BannerDataNull.NULL;this.showBannerDivNull(e),this.container.classList.toggle("banner_new__loaded",!0),p(),this.options.onRender&&this.options.onRender(e)},f.prototype.renderBanner=function(e){e instanceof t.BannerDataNull?this.showBannerDivNull(e):e instanceof r.BannerDataImage?this.showBannerDivImage(e):e instanceof i.BannerDataText&&this.showBannerDivText(e),this.container.classList.toggle("banner_new__loaded",!0),p(),this.options.onRender&&this.options.onRender(e),this.options.onError&&e instanceof t.BannerDataNull&&this.options.onError(e)},f.prototype.showBannerDivNull=function(e){this.nullBannerRenderer.showBannerDiv(e)},f.prototype.showBannerDivText=function(e){this.textBannerRenderer.showBannerDiv(e)},f.prototype.showBannerDivImage=function(e){this.imageBannerRenderer.showBannerDiv(e)},f.prototype.encodeClickParam=function(){return"nbnr_"+this.uid},f.prototype.createBannerDomObserver=function(e){var t,n;window.MutationObserver&&(t=this.heightChangeWatcher,(n=new MutationObserver(function(e){for(var n=0;n<e.length;++n)0<e[n].addedNodes.length&&t.start()})).observe(e,{childList:!0}),this.contentChangeObserver=n)},f.prototype.destroyBannerDomObserver=function(){var e=this.contentChangeObserver;e&&e.disconnect()},n.BannerViewJs=f;f=function(e){this.bannerView=e};f.prototype.showBannerDiv=function(e){};var g,b,v,B=((v=f)&&(E.__proto__=v),((E.prototype=Object.create(v&&v.prototype)).constructor=E).prototype.showBannerDiv=function(e){this.bannerView.hideContainer(),this.bannerView.container.innerHTML=""},E),y=((b=f)&&(J.__proto__=b),((J.prototype=Object.create(b&&b.prototype)).constructor=J).prototype.showBannerDiv=function(e){this.bannerView.showContainer(),this.bannerView.setBannerHtml(e.text)},J),w=((g=f)&&(_.__proto__=g),((_.prototype=Object.create(g&&g.prototype)).constructor=_).prototype.showBannerDiv=function(e){this.bannerView.showContainer(),this.bannerView.setBannerHtml(this.renderHtml(e,this.bannerView.encodeClickParam())),null!==e&&null!==e.impressionUrls&&e.impressionUrls.length&&setTimeout(function(){e.impressionUrls.forEach(function(e){(new Image).src=e})},10)},_.prototype.renderHtml=function(e,n){return'<div class="rb_div"><div class="rb_banner"><a href="'+e.targetUrl+'" onclick="rb_js_bannerClick(\''+n+'\');return false;"><img src="'+e.url+'" width="'+e.width+'" height="'+e.height+'" border="0" alt="'+e.title+'" title="'+e.title+'"/></a></div></div>'},_),m=function(e){this.running=!1,this.height=0,this.count=0,this.heightChangeWatcher=0,this.bannerView=e};function _(){g.apply(this,arguments)}function J(){b.apply(this,arguments)}function E(){v.apply(this,arguments)}m.prototype.start=function(){var n,t=this;this.running||(n=this.bannerView.container,this.count=0,this.running=!0,this.height=n.offsetHeight,this.heightChangeWatcher=setInterval(function(){var e=n.offsetHeight;t.count<15?(0<e&&e!==t.height&&(t.height=e,o.DispatcherJs.get().bannerViewStateChangedEvent.trigger()),t.count++):t.stop()},100))},m.prototype.stop=function(){this.running&&(clearInterval(this.heightChangeWatcher),this.running=!1)},window.rb_js_bannerClick=function(e){e=e.slice("nbnr_".length),e=u[e];e&&null!==e.banner&&e.banner.handleBannerClick()}}),define("OK/banners/bannerNew/utils/DurationJs",["require","exports"],function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DurationJs=void 0;function t(){this.start=performance.now()}t.prototype.elapsedMillis=function(){return performance.now()-this.start},n.DurationJs=t}),define("OK/banners/bannerNew/banners/SimpleBannerJs",["require","exports","OK/banners/bannerNew/BannerViewJs","OK/banners/bannerNew/utils/DurationJs","OK/DispatcherJs","OK/banners/bannerNew/data/BannerDataNull","OK/banners/bannerNew/data/BannerDataJson","OK/logger"],function(e,n,i,a,t,r,o,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.NavigationTriggerJs=n.TimeoutTriggerJs=n.RefreshTriggerBaseJs=n.LoggingTriggerJs=n.SimpleBannerJs=void 0;var u=function(e){var n=this;this.request=null,this.visible=!1,this.inLayer=!1,this.banner=null;var t=e.view,r=e.model;this.options=e,this.model=r,t instanceof HTMLElement&&(t=new i.BannerViewJs({container:t,slot:r.slot})),this.view=t,this.durationSinceLastRefresh=new a.DurationJs,this.triggers=[],this.listener={handleResponse:function(e){n.handleResponse(e)}}};u.prototype.setInLayer=function(e){return this.inLayer=e,this},u.prototype.isInViewport=function(){return this.view.isInViewport(!this.inLayer)},u.prototype.attachRefreshTrigger=function(e,n){e.attach(this),this.triggers.push(new c(e,n))},u.prototype.init=function(n){n?this.view.showContainer():this.view.hideContainer(),this.triggers.forEach(function(e){e.init(n)})},u.prototype.destroy=function(){this.hide(),this.triggers.forEach(function(e){e.destroy()})},u.prototype.show=function(){var n=0;try{this.visible||(this.visible=!0,this.view.attach(this),n=1,this.requestBanner(),n=2,this.triggers.forEach(function(e){e.show()}))}catch(e){throw s.errorEx(e,"SimpleBanner","show_"+n),e}},u.prototype.hide=function(){this.visible?(this.triggers.forEach(function(e){e.hide()}),this.visible=!1,this.cancelBanner(),this.view.detach()):this.view.renderBanner(r.BannerDataNull.NULL)},u.prototype.cancelBanner=function(){null!==this.request&&(this.request.cancel(),this.request=null)},u.prototype.requestBanner=function(){this.visible&&(this.cancelBanner(),this.request=this.model.request(this.listener),this.durationSinceLastRefresh=new a.DurationJs)},u.prototype.getDurationSinceLastRefresh=function(){return this.durationSinceLastRefresh},u.prototype.handleResponse=function(e){this.banner=e,this.view.renderBanner(e),this.request=null,this.options.onAfterHandleResponse&&this.options.onAfterHandleResponse(e)},u.prototype.handleBannerClick=function(){var e;this.banner instanceof o.BannerDataJson&&(e=this.banner,this.model.click(e.clickUrl),window.navigateOnUrlFromJS(e.targetUrl))},n.SimpleBannerJs=u;var c=function(e,n){void 0===n&&(n=null),this.delegate=e=void 0===e?null:e,this.place=n};c.prototype.init=function(e){try{this.delegate.init(e)}catch(e){this.logAndRethrow(e,"init")}},c.prototype.show=function(){try{this.delegate.show()}catch(e){this.logAndRethrow(e,"show")}},c.prototype.hide=function(){try{this.delegate.hide()}catch(e){this.logAndRethrow(e,"hide")}},c.prototype.destroy=function(){try{this.delegate.destroy()}catch(e){this.logAndRethrow(e,"destroy")}},c.prototype.attach=function(e){this.delegate.attach(e)},c.prototype.logAndRethrow=function(e,n){throw s.errorEx(e,"SimpleBanner",this.place+"-"+n),e},n.LoggingTriggerJs=c;var l,p=((l=c)&&(h.__proto__=l),((h.prototype=Object.create(l&&l.prototype)).constructor=h).prototype.attach=function(e){this.banner=e},h.prototype.refresh=function(){this.banner.requestBanner()},h.prototype.getDurationSinceLastRefresh=function(){return this.banner.getDurationSinceLastRefresh()},h);function h(){l.apply(this,arguments),this.banner=null}n.RefreshTriggerBaseJs=p;var d,u=((d=p)&&(f.__proto__=d),((f.prototype=Object.create(d&&d.prototype)).constructor=f).prototype.init=function(e){},f.prototype.show=function(){var n=this;null===this.refresher&&(this.refresher=setInterval(function(){var e=n.intervalProvider.getValue();null!==e&&0!==e&&n.getDurationSinceLastRefresh().elapsedMillis()>1e3*e&&n.banner.isInViewport()&&n.refresh()},1e3))},f.prototype.hide=function(){this.refresher&&clearInterval(this.refresher)},f.prototype.destroy=function(){},f);function f(e){d.call(this),this.refresher=null,this.intervalProvider=e}n.TimeoutTriggerJs=u;var g,p=((g=p)&&(b.__proto__=g),((b.prototype=Object.create(g&&g.prototype)).constructor=b).prototype.init=function(e){},b.prototype.show=function(){t.DispatcherJs.get().updateEvent.attach(this.onUpdate,this)},b.prototype.hide=function(){t.DispatcherJs.get().updateEvent.detach(this.onUpdate,this)},b.prototype.onUpdate=function(){this.enabledProvider.getValue()&&this.refresh()},b.prototype.destroy=function(){},b);function b(e){g.call(this),this.enabledProvider=e}n.NavigationTriggerJs=p}),define("OK/banners/bannerNew/ValueProviderJs",["require","exports"],function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ValueProviderJs=void 0;function t(e){this.getValue=e}t.create=function(e){return new t(function(){return e})},n.ValueProviderJs=t}),define("OK/banners/bannerNew/hooks/BaseBannerHookJs",["require","exports","OK/banners/bannerNew/transport/BannerTransportJs","OK/banners/bannerNew/utils/BannerConstantJs","OK/DispatcherJs","OK/banners/bannerNew/banners/BannerProxyJs","OK/banners/bannerNew/BannerModelJs","OK/BanDataCfgJs","OK/banners/bannerNew/utils/BannerCommon","OK/banners/bannerNew/config/BannerCfgJs","OK/banners/bannerNew/config/BannerParamsJs","OK/banners/bannerNew/BannerViewJs","OK/banners/blockDetect/adbWhitelistDetect","OK/banners/bannerNew/banners/SimpleBannerJs","OK/banners/bannerNew/ValueProviderJs","OK/logger","OK/utils/utils"],function(e,n,o,u,s,i,c,r,l,p,a,h,t,d,f,g,b){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.HookBannerParamsJs=n.BaseBannerHookJs=void 0;function v(e,n){this.position=null,this.banner=null,this.visible=!0,this.params=null,this.el=n,this.hookId=n.getAttribute("data-hook-id"),this.hookType=e,this.name=this.hookId,this.log=l.createLog("BaseBannerHookJs["+this.name+"]"),this.showBannerTimeout=500}v.prototype.needCleanElement=function(){return!1},v.prototype.activate=function(){this.params=this.readBannerParams(),this.needCleanElement()&&(this.el.removeAttribute("data-hook-id"),this.el.removeAttribute("data-module"),this.el.removeAttribute("data-params")),this.log("activate"),this.log("params",this.params),this.showBannerOnActivate()&&this.showBanner()},v.prototype.showBanner=function(){var e=this;return p.BannerCfgJs.getInstance().abpWhiteListEnabled?t.detect({adbWhiteListEnabled:!0}).then(function(){return e.doShowBanner(!0)},function(){return e.doShowBanner(!1)}):this.doShowBanner(!1)},v.prototype.doShowBanner=function(e){var r=this;return this.clearBannerContent(),null!==this.params?(this.params.setAdblockWhitelist(e),new Promise(function(n,t){setTimeout(function(){try{var e=r.el;null!==e&&(r.banner=new i.BannerProxyJs({createDelegate:function(){return r.createBannerDelegate(r.params,e)},key:function(){return"banner"}}),r.banner.init(r.visible),r.banner.show(),r.log("banner",r.banner),n())}catch(e){r.log("error",e),g.errorEx(e,"BannerHook-"+r.name,"init_view_"),t(e)}},r.showBannerTimeout)})):Promise.reject()},v.prototype.deactivate=function(){null!==this.banner&&(this.banner.destroy(),this.banner=null)},v.prototype.showBannerOnActivate=function(){return!0},v.prototype.logEmptyBanner=function(){},v.prototype.createBannerDelegate=function(e,n){var t=f.ValueProviderJs.create(e.getPosition());return this.buildInlineBanner(n,e,t,this.name)},v.prototype.buildInlineBanner=function(e,n,t,r){var i=this,a=new c.BannerModelJs(t,n,o.BannerTransportJs.getInstance()),t=new h.BannerViewJs({container:e,slot:t,inline:!0,onRender:function(){s.DispatcherJs.get().bannerViewStateChangedEvent.trigger()},onError:function(){i.logEmptyBanner()}}),t=this.createBanner(t,a);t.setInLayer(n.getInLayer());a=new f.ValueProviderJs(function(){return p.BannerCfgJs.getRefreshPolicyCfg().getTransition(r)}),n=new f.ValueProviderJs(function(){return p.BannerCfgJs.getRefreshPolicyCfg().getTimeout(r)});return t.attachRefreshTrigger(new d.NavigationTriggerJs(a),"navi_hook"),t.attachRefreshTrigger(new d.TimeoutTriggerJs(n),"timeout_hook"),t},v.prototype.createBanner=function(e,n){return new d.SimpleBannerJs({view:e,model:n})},v.prototype.getBannerJsonParams=function(){var e=this.el.getAttribute("data-params");return null===e?null:b.parseJson(e)},v.prototype.readBannerParams=function(){var e=this.getBannerJsonParams();if(l.log("bannerParams",e),null===e)return null;var n=e[u.BannerConstantJs.WITH_UNIQUE_ID],t=e[u.BannerConstantJs.WITH_PERSONAL_DATA],r=e[u.BannerConstantJs.WITH_LAST_APPS],i=e[u.BannerConstantJs.POSITION_KEY]||this.position,a=!!e[u.BannerConstantJs.PERSONAL_DATA_IS_COMPANYOWNER],o=e[u.BannerConstantJs.WITH_SITE_ZONE_BANNER_PARAM],o=new y(n,t,r,i,a,o);e.grname&&o.setAuxGroupParameters(e.grname,e.grdesc,e.grpic),this.visible=e.visible,this.readAdditionalParams(e,o),e[u.BannerConstantJs.APPS_BANNERS_WITH_CUSTOM_TITLE]&&o.setUseAppsCustomTitle(!0),e[u.BannerConstantJs.APPS_BANNERS_APP_SHORT_NAME]&&o.setAppShortName(e[u.BannerConstantJs.APPS_BANNERS_APP_SHORT_NAME]),o.setDelay(e[u.BannerConstantJs.EXPR_DELAY]||50),o.setInLayer(e[u.BannerConstantJs.IN_LAYER]||!1),e.passWidth&&(s=this.el,s=v.getInnerWidth(s),o.setWidth(s));var s=e[u.BannerConstantJs.SITE_ZONE_BANNER_PARAM];s&&o.setSiteZone(s);e=e[u.BannerConstantJs.SITENAME];return e&&o.setSitename(e),o},v.prototype.readAdditionalParams=function(e,n){},v.prototype.clearBannerContent=function(){this.el.innerHTML=""},v.getInnerWidth=function(e){var n=window.getComputedStyle(e,null),t=parseInt(n.paddingLeft,10),n=parseInt(n.paddingRight,10);return e.clientWidth-t-n},n.BaseBannerHookJs=v;var B,y=((B=a.BannerParamsJs)&&(w.__proto__=B),((w.prototype=Object.create(B&&B.prototype)).constructor=w).prototype.setDelay=function(e){this.delay=e},w.prototype.setInv=function(e){this.inv=e},w.prototype.getDelay=function(){return this.delay},w.prototype.setInLayer=function(e){this.inLayer=e},w.prototype.getInLayer=function(){return this.inLayer},w.prototype.setAdblockWhitelist=function(e){this.adblockWhitelist=e},w.prototype.getAdblockWhitelist=function(){return this.adblockWhitelist},w.prototype.getPosition=function(){return this.position},w.prototype.isCompanyOwner=function(){return this.companyOwner},w.prototype.setAuxGroupParameters=function(e,n,t){this.groupName=e,this.groupDescription=n,this.groupAvatarUrl=t},w.prototype.setUseAppsCustomTitle=function(e){this.useAppsCustomTitle=e},w.prototype.setAppShortName=function(e){this.appShortName=e},w.prototype.getWidth=function(){return this.width},w.prototype.setWidth=function(e){this.width=e},w.prototype.setSiteZone=function(e){this.siteZone=e},w.prototype.setSitename=function(e){this.sitename=e},w.prototype.asJSON=function(){var e=a.BannerParamsJs.prototype.asJSON.call(this);this.isCompanyOwner()&&o.BannerTransportJs.appendParam(e,"l","1");var n=r.BanDataCfgJs.getInstance();l.log("[banDataProvider]",n);var t=null;return this.siteZone?t=this.siteZone:this.withSiteZone&&n.sitezone&&(t=n.sitezone),null!==t&&o.BannerTransportJs.appendParam(e,u.BannerConstantJs.SITEZONE_PARAM,t),n.groupId&&o.BannerTransportJs.appendParam(e,u.BannerConstantJs.GROUP_ID_PARAM,n.groupId),n.isaMember&&o.BannerTransportJs.appendParam(e,u.BannerConstantJs.IS_GROUP_ACTIVE_MEMBER_PARAM,n.isaMember),this.groupName&&o.BannerTransportJs.appendParam(e,u.BannerConstantJs.GROUP_NAME_PARAM,this.groupName),this.groupDescription&&o.BannerTransportJs.appendParam(e,u.BannerConstantJs.GROUP_DESCRIPTION_PARAM,this.groupDescription),this.groupAvatarUrl&&o.BannerTransportJs.appendParam(e,u.BannerConstantJs.GROUP_AVATAR_URL_PARAM,this.groupAvatarUrl),this.useAppsCustomTitle&&o.BannerTransportJs.appendParam(e,u.BannerConstantJs.APPS_BANNERS_WITH_CUSTOM_TITLE,"1"),this.appShortName&&o.BannerTransportJs.appendParam(e,u.BannerConstantJs.APPS_BANNERS_APP_SHORT_NAME,this.appShortName),0<this.getWidth()&&o.BannerTransportJs.appendParam(e,"w",this.getWidth()+""),this.inv&&o.BannerTransportJs.appendParam(e,"inv","1"),this.adblockWhitelist&&o.BannerTransportJs.appendParam(e,"d","1"),window.OK.isStateRedesign()&&o.BannerTransportJs.appendParam(e,"web2021","1"),this.sitename&&o.BannerTransportJs.appendParam(e,"sitename",this.sitename),e},w);function w(e,n,t,r,i,a){B.call(this,e,n,t),this.groupName=null,this.groupDescription=null,this.groupAvatarUrl=null,this.useAppsCustomTitle=!1,this.appShortName=null,this.delay=0,this.width=0,this.siteZone=null,this.sitename=null,this.adblockWhitelist=!1,this.inv=!1,this.inLayer=!1,this.position=r,this.companyOwner=i,this.withSiteZone=a}n.HookBannerParamsJs=y,n.default=v}),define("OK/banners/bannerNew/hooks/AppsRecommendBannerHookJs",["require","exports","OK/banners/bannerNew/hooks/BaseBannerHookJs","OK/banners/bannerNew/banners/SimpleBannerJs"],function(e,n,t,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AppsRecommendBannerHookJs=void 0;var i,t=((i=t.BaseBannerHookJs)&&(a.__proto__=i),((a.prototype=Object.create(i&&i.prototype)).constructor=a).prototype.createBanner=function(e,n){return new r.SimpleBannerJs({view:e,model:n,onAfterHandleResponse:function(e){var n=document.getElementById("bannerLoaderId");n&&(n.style.display="none")}})},a);function a(e,n){i.call(this,"BanMailRAPPS",n)}n.AppsRecommendBannerHookJs=t,n.default=t}),define("OK/EventBus",["OK/EventFactory"],function(e){"use strict";var n=e.create();function r(e){this.prefix=e.prefix,this.name=e.name,this.listeners=new Map}return r.EVENT_NAME="okeventbus",r.registeredBuses=new Set,r.getRegisteredBuses=function(){return r.registeredBuses},r.getHost=function(){return n},r.createEvent=function(e){return new CustomEvent(r.EVENT_NAME,{detail:e,bubbles:!1,cancelable:!0})},r.on=function(e){if(n.list.includes(e))throw new Error("EventBus: РїРѕРІС‚РѕСЂРЅРѕРµ РґРѕР±Р°РІР»РµРЅРёРµ РѕР±СЂР°Р±РѕС‚С‡РёРєР°");n.attach(e)},r.off=function(e){n.detach(e)},r.emit=function(e){e=r.createEvent(e);return n.trigger(e),!e.defaultPrevented},r.findRegistered=function(n){var t=null;return r.registeredBuses.forEach(function(e){!t&&e.isMe(n)&&(t=e)}),t},r.create=function(e){return r.getInstance(e)},r.getInstance=function(e){var n=r.findRegistered(e);return n||(n=new r(e),r.getRegisteredBuses().add(n)),n},r.prototype={emit:function(e,n){return r.emit({prefix:this.prefix,name:this.name,data:e,target:n})},on:function(e,n){n=this.makeListener(e,n);r.on(n)},off:function(e){var n=this.listeners.get(e);n&&(n.bus=void 0,r.off(n),this.listeners.delete(e))},isMe:function(e){return this.name===e.name&&this.prefix===e.prefix},makeListener:function(t,r){if(this.listeners.has(t))throw new Error("EventBus["+this.prefix+", "+this.name+"]: РїРѕРІС‚РѕСЂРЅРѕРµ РґРѕР±Р°РІР»РµРЅРёРµ РѕР±СЂР°Р±РѕС‚С‡РёРєР°");var e=function(e){var n=e.detail;if(!e.defaultPrevented&&this.isMe(n)&&(!r||!n.target||r!==n.target))return t(n.data,e)}.bind(this);return this.listeners.set(t,e),e}},r}),define("OK/banners/bannerNew/hooks/BannerAppsHookJs",["require","exports","OK/banners/bannerNew/hooks/BaseBannerHookJs","OK/EventBus"],function(e,n,t,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BannerAppsHookJs=void 0;var o,t=((o=t.BaseBannerHookJs)&&(r.__proto__=o),((r.prototype=Object.create(o&&o.prototype)).constructor=r).prototype.activate=function(){o.prototype.activate.call(this),this.el.addEventListener("ShowInterstitialAppBanner",this.onShowBanner),this.el.addEventListener("PrepareInterstitialAppBanner",this.onPrepareAds),this.el.addEventListener("ad_start",this.onStartAds),this.el.addEventListener("ad_finish",this.onFinishAds)},r.prototype.showBannerOnActivate=function(){return!1},r.prototype.clearBannerContent=function(){this.clearContentBeforeShow&&(this.el.innerHTML="")},r.prototype.showLayer=function(){this.layer.classList.contains("invisible")&&this.layer.classList.remove("invisible")},r.prototype.hideLayer=function(){this.layer.classList.contains("invisible")||this.layer.classList.add("invisible")},r.prototype.deactivate=function(){this.el.removeEventListener("ShowInterstitialAppBanner",this.onShowBanner),this.el.removeEventListener("PrepareInterstitialAppBanner",this.onPrepareAds),this.el.removeEventListener("ad_start",this.onStartAds),this.el.removeEventListener("ad_finish",this.onFinishAds),o.prototype.deactivate.call(this)},r);function r(e,n){var i=this;o.call(this,"BanMailRBNew",n),this.onShowBanner=function(e){if(i.preparedAd)return i.showLayer(),void(i.preparedAd=!1);o.prototype.showBanner.call(i).catch(function(e){a.create({name:"errored",prefix:"InterstitialAppBanner"}).emit({event:"error",reason:e},null)})},this.onPrepareAds=function(e){var n=e.detail,e=n.limit,n=n.ignorePrepared,t=a.create({name:"prepare",prefix:"InterstitialAppBanner"}),r=a.create({name:"prepare_repeated",prefix:"InterstitialAppBanner"});i.preparedAd&&e&&!n?setTimeout(function(){r.emit({event:"prepared"},null)},0):(i.preparedAd=!0,o.prototype.showBanner.call(i).then(function(){t.emit({event:"prepared"},null)}).catch(function(e){a.create({name:"errored",prefix:"InterstitialAppBanner"}).emit({event:"error",reason:e},null)}))},this.onStartAds=function(e){if(i.preparedAd)return!1;i.showLayer(),a.create({name:"started",prefix:"InterstitialAppBanner"}).emit({event:"start"},null)},this.onFinishAds=function(e){i.hideLayer(),i.banner.destroy(),i.banner=null,a.create({name:"finished",prefix:"InterstitialAppBanner"}).emit({event:"finish"},null)},this.logEmptyBanner=function(){a.create({name:"errored",prefix:"InterstitialAppBanner"}).emit({event:"error",reason:"banner is null"},null),i.preparedAd=!1},this.layer=document.querySelector(".app-interstitial-layer"),this.clearContentBeforeShow=!1,this.showBannerTimeout=0}n.BannerAppsHookJs=t,n.default=t}),define("OK/banners/bannerNew/hooks/BannerHookJs",["require","exports","OK/banners/bannerNew/hooks/BaseBannerHookJs"],function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BannerHookJs=void 0;var r,t=((r=t.BaseBannerHookJs)&&(i.__proto__=r),(i.prototype=Object.create(r&&r.prototype)).constructor=i);function i(e,n){r.call(this,"BanMailRBNew",n)}n.BannerHookJs=t,n.default=t}),define("OK/banners/bannerNew/banners/ConditionalBannerJs",["require","exports","OK/DispatcherJs","OK/BanDataCfgJs","OK/logger"],function(e,n,t,r,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ForthColumnCondition=n.BannerNavigationDataConditionJs=n.VisibilityConditionJs=n.ConditionalBannerJs=void 0;var a=function(e,n){this.visiblity=!1,this.effective=null,this.conditions=new Array,this.delegate=e,this.blockId=" "+n+" ",this.attachCondition(new s)};a.prototype.attachCondition=function(e){this.conditions.push(e),e.setBanner(this)},a.prototype.init=function(e){this.delegate.init(e),this.conditions.forEach(function(e){e.init()})},a.prototype.show=function(){this.visiblity=!0,this.updateBannerState()},a.prototype.hide=function(){this.visiblity=!1,this.updateBannerState()},a.prototype.updateBannerState=function(){try{var n=!0;this.conditions.forEach(function(e){n=n&&e.isVisible()});var e=this.visiblity&&n;null!==this.effective&&!this.effective||e?null!==this.effective&&this.effective||!e||this.delegate.show():this.delegate.hide(),this.effective=e}catch(n){throw i.errorEx(n,"Banner","upBaSt"),n}},a.prototype.destroy=function(){this.conditions.forEach(function(e){e.destroy()}),this.conditions=null,this.delegate.destroy()},n.ConditionalBannerJs=a;a=function(){this.banner=null};a.prototype.setBanner=function(e){this.banner=e},a.prototype.getBanner=function(){return this.banner},a.prototype.updateBannerState=function(){this.banner.updateBannerState()},n.VisibilityConditionJs=a;var o,s=((o=a)&&(u.__proto__=o),((u.prototype=Object.create(o&&o.prototype)).constructor=u).prototype.init=function(){t.DispatcherJs.get().updateEvent.attach(this.onUpdateEvent,this)},u.prototype.destroy=function(){t.DispatcherJs.get().updateEvent.detach(this.onUpdateEvent,this)},u.prototype.isVisible=function(){var e=r.BanDataCfgJs.getInstance().blocks;return null===e||-1===e.indexOf(this.getBanner().blockId)},u.prototype.onUpdateEvent=function(){this.updateBannerState()},u);function u(){o.apply(this,arguments)}n.BannerNavigationDataConditionJs=s;var c,a=((c=a)&&(l.__proto__=c),((l.prototype=Object.create(c&&c.prototype)).constructor=l).prototype.init=function(){t.DispatcherJs.get().forthColumnToggledEvent.attach(this.onForthColumnToggled,this)},l.prototype.destroy=function(){t.DispatcherJs.get().forthColumnToggledEvent.detach(this.onForthColumnToggled,this)},l.prototype.onForthColumnToggled=function(){this.updateBannerState()},l.prototype.isVisible=function(){return t.DispatcherJs.isWideLayout()},l);function l(){c.apply(this,arguments)}n.ForthColumnCondition=a}),define("OK/banners/bannerNew/hooks/ForthColumnBannerHookJs",["require","exports","OK/banners/bannerNew/hooks/BaseBannerHookJs","OK/banners/bannerNew/banners/ConditionalBannerJs","OK/banners/bannerNew/utils/BannerCommon","OK/BanDataCfgJs"],function(e,n,t,r,i,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ForthColumnBannerHookJs=void 0;var o,t=((o=t.BaseBannerHookJs)&&(s.__proto__=o),((s.prototype=Object.create(o&&o.prototype)).constructor=s).prototype.needCleanElement=function(){return!0},s.prototype.createBannerDelegate=function(e,n){n=o.prototype.createBannerDelegate.call(this,e,n),n=new r.ConditionalBannerJs(n,"ForthColumnTopBanner");return n.attachCondition(new r.ForthColumnCondition),n},s.prototype.readAdditionalParams=function(e,n){a.BanDataCfgJs.getInstance().inv&&(n.setWithViewportHeight(!0),n.setInv(!0))},s);function s(e,n){i.log("ForthColumnBannerHookJs init"),o.call(this,"BanMailRB4",n)}n.ForthColumnBannerHookJs=t,n.default=t}),define("OK/ViewportTracker",["OK/utils/throttle","OK/utils/dom"],function(n,a){"use strict";var o=[],s=!1,u=n(100,function(){o.forEach(function(e){e.calculate()})});function c(n){var t=null;return o.some(function(e){if(e.element===n)return t=e,!0}),t}function r(e,n){n=e.indexOf(n);-1<n&&e.splice(n,1)}function l(e,n,t,r){this.element=e,this.container=n,this.callback=t,this.predicate=r?r.bind(this):null}function p(e){this.element=e,this.items=[],this.listener=n(100,this.calculate.bind(this)),this.element.addEventListener("scroll",this.listener),this.updateRect()}return l.prototype={destroy:function(){this.container=null},isInViewport:function(){var e,n=this.container.rect,t=n.top,r=n.bottom;try{e=this.element.getBoundingClientRect()}catch(n){e={top:0,right:0,bottom:0,left:0,width:0,height:0}}return e.top>=t&&e.top<=r||e.bottom>=t&&e.bottom<=r},calculate:function(){var e=this.predicate?this.predicate():this.isInViewport();this.visible!==e&&(this.visible=e,this.callback.call(this.element,e))}},p.prototype={add:function(e){this.items.push(e),this.updateRect(),e.calculate()},updateRect:function(){this.rect=this.element.getBoundingClientRect()},remove:function(n){var t=null;this.items.forEach(function(e){if(e.element===n)return t=e,!0}),t&&(t.destroy(),r(this.items,t))},isEmpty:function(){return 0===this.items.length},isLast:function(e){return this.items[this.items.length-1]===e},calculate:function(){this.updateRect(),this.items.forEach(function(e){e.calculate()})},destroy:function(){this.element.removeEventListener("scroll",this.listener)}},{add:function(e,n,t){var r,i=a.parent(e,"js-viewport-container");(r=c(i=null===i?window:i))||(r=new p(i),o.push(r)),r.add(new l(e,r,n,t)),s||(window.addEventListener("resize",u),s=!0)},remove:function(e){var n=a.parent(e,"js-viewport-container");(n=c(n=null===n?window:n))&&(n.remove(e),n.isEmpty()&&(n.destroy(),r(o,n))),s&&0===o.length&&(window.removeEventListener("resize",u),s=!1)},getContainer:function(e){return c(a.parent(e,"js-viewport-container"))}}}),define("OK/webapi",["OK/utils/vanilla","OK/logger"],function(c,l){"use strict";var a=0,p=!1,h="api.communication-error";var e={invoke:function(e,n,t){var o,s,u,r={id:++a},i=(t=t||{}).filter;return null!=n&&(r.parameters=n),null!=i&&(r.filter=i),o=t,s="/web-api/v2/"+e,r=r=r,u=JSON.stringify(r,null,2),new Promise(function(n,t){var e=c.ajax({contentType:"application/json; charset=utf-8",url:s,dataType:"json",data:u}),r=e.xhr;function i(){r.abort(),p=!0,a(),t({type:2,typeName:"ABORT",errorCode:"abort",errorMessage:r.statusText||"abort"})}function a(){o.signal&&o.signal.removeEventListener("abort",i)}o.signal&&o.signal.addEventListener("abort",i),e.then(function(e){p=!1,a();e=e.response;e.success?n(e.result):t(e.error)},function(e){p||l.error(h),a(),p=!0,t({type:200,typeName:"SERVER_ERROR",errorCode:h,errorMessage:e.statusText||h})})})}};return"undefined"!=typeof window&&(window.webapi=e),e}),define("OK/banners/bannerNew/hooks/MediaTopicLayerContentHookJs",["require","exports","OK/banners/bannerNew/hooks/BaseBannerHookJs","OK/ViewportTracker","OK/webapi"],function(e,n,t,r,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a,o={attributes:!(n.MediaTopicLayerContentHookJs=void 0),childList:!0,subtree:!0},t=((a=t.BaseBannerHookJs)&&(s.__proto__=a),((s.prototype=Object.create(a&&a.prototype)).constructor=s).prototype.activate=function(){a.prototype.activate.call(this),r.add(this.el,this.viewportHandler),this.tracking=!0},s.prototype.deactivate=function(){this.observer.disconnect(),this.stopTrack(),a.prototype.deactivate.call(this)},s.prototype.readAdditionalParams=function(e,n){this.topicId=e.topicId},s.prototype.stopTrack=function(){this.tracking&&(r.remove(this.el,this.viewportHandler),this.tracking=!1)},s);function s(e,n){var t=this;a.call(this,"MediaTopicLayerContentBlock",n),this.tracking=!1,this.callbackMutation=function(){var e,n;t.el.hasChildNodes()&&0<t.el.clientHeight&&(null!=(n=(e=t.el.parentNode).querySelector(".layer-banner-stubs"))&&e.removeChild(n))},this.viewportHandler=function(e){if(e)return t.stopTrack(),i.invoke("mediatopic/scrollToBottom",{topicId:t.topicId})},this.observer=new MutationObserver(this.callbackMutation),this.observer.observe(this.el,o)}n.MediaTopicLayerContentHookJs=t,n.default=t}),define("OK/banners/bannerNew/banners/CompositeBannerJs",["require","exports"],function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CompositeBannerJs=void 0;function t(){this.banners=new Array,this.defaultVisible=null,this.visible=null}t.prototype.addBanner=function(e){return this.banners.push(e),null!==this.defaultVisible&&e.init(this.defaultVisible),null!==this.visible&&(this.visible?e.show():e.hide()),this},t.prototype.init=function(n){this.defaultVisible=n,this.banners.forEach(function(e){e.init(n)})},t.prototype.show=function(){this.banners.forEach(function(e){e.show()}),this.visible=!0},t.prototype.hide=function(){this.banners.forEach(function(e){e.hide()}),this.visible=!1},t.prototype.destroy=function(){this.banners.forEach(function(e){e.destroy()}),this.defaultVisible=null,this.visible=null},n.CompositeBannerJs=t}),define("OK/banners/bannerNew/banners/ViewportHeightAwareBannersJs",["require","exports","OK/banners/bannerNew/banners/CompositeBannerJs","OK/banners/bannerNew/utils/BannerCommon","OK/DispatcherJs"],function(e,n,t,r,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ViewportHeightAwareBannersJs=void 0;var a,t=((a=t.CompositeBannerJs)&&(o.__proto__=a),((o.prototype=Object.create(a&&a.prototype)).constructor=o).prototype.init=function(e){a.prototype.init.call(this,e),r.getEffectiveViewportHeight()>this.options.threshold?this.configureBanners(this.options.tallBanners):this.configureBanners(this.options.shortBanners)},o.prototype.configureBanners=function(e){var t=this;e.forEach(function(e){var n=t.renderBannerPlace(e);t.addBanner(t.options.createBanner(n,e))}),i.DispatcherJs.get().bannerViewStateChangedEvent.trigger()},o.prototype.renderBannerPlace=function(e){var n=document.createElement("div");return n.classList.add("banner"+e,o.JS_BANNER_PLACE_CLASS),this.options.content.appendChild(n),n},o);function o(e){a.call(this),this.options=e}(n.ViewportHeightAwareBannersJs=t).JS_BANNER_PLACE_CLASS="js-place"}),define("OK/banners/bannerNew/hooks/ViewportHeightAwareBannersHookJs",["require","exports","OK/banners/bannerNew/hooks/BaseBannerHookJs","OK/banners/bannerNew/banners/ConditionalBannerJs","OK/banners/bannerNew/banners/ViewportHeightAwareBannersJs","OK/banners/bannerNew/ValueProviderJs","OK/banners/bannerNew/utils/HtmlRendererJs","OK/banners/bannerNew/config/BannerCfgJs","OK/BannerLogger","OK/BanDataCfgJs"],function(e,n,t,i,a,o,r,s,u,c){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ViewportHeightAwareBannersHookJs=void 0;var l,t=((l=t.BaseBannerHookJs)&&(p.__proto__=l),((p.prototype=Object.create(l&&l.prototype)).constructor=p).prototype.needCleanElement=function(){return!0},p.prototype.showBanner=function(){var n=this,e=l.prototype.showBanner.call(this);return s.BannerCfgJs.getInstance().vhaBannerDebug&&e.then(function(e){n.bannerLogger=new u.BannerLogger("native",n.el,r.HtmlRendererJs.isInjection)}),e},p.prototype.deactivate=function(){this.bannerLogger&&(this.bannerLogger.destroy(),this.bannerLogger=null),l.prototype.deactivate.call(this)},p.prototype.createBannerDelegate=function(t,e){var r=this;return new i.ConditionalBannerJs(new a.ViewportHeightAwareBannersJs({content:e,threshold:this.threshold,tallBanners:this.tallBanners,shortBanners:this.shortBanners,createBanner:function(e,n){return r.buildInlineBanner(e,t,o.ValueProviderJs.create(n),"slot"+n)}}),"ViewportHeightAwareBanner")},p.prototype.readAdditionalParams=function(e,n){this.threshold=+e.threshold||800,this.tallBanners=this.convertToIntegerArray(e.tallBanners||""),this.shortBanners=this.convertToIntegerArray(e.shortBanners||""),c.BanDataCfgJs.getInstance().inv?n.setInv(!0):(n.setConsiderCompactFooter(),n.setWithViewportHeight(!0))},p.prototype.convertToIntegerArray=function(e){var n=[];return e.split(",").forEach(function(e){n.push(parseInt(e,10))}),n},p);function p(e,n){l.call(this,"VHAB",n),this.threshold=0,this.tallBanners=null,this.shortBanners=null}n.ViewportHeightAwareBannersHookJs=t,n.default=t}),define("OK/banners/bannerNew/discussions/DiscussionsBannerParamJs",["require","exports","OK/banners/bannerNew/config/BannerParamsJs","OK/banners/bannerNew/transport/BannerTransportJs","OK/banners/bannerNew/utils/BannerConstantJs"],function(e,n,t,r,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DiscussionsBannerParamJs=void 0;var a,t=((a=t.BannerParamsJs)&&(o.__proto__=a),((o.prototype=Object.create(a&&a.prototype)).constructor=o).prototype.asJSON=function(){var e=a.prototype.asJSON.call(this);return this.sitezone&&r.BannerTransportJs.appendParam(e,i.BannerConstantJs.SITEZONE_PARAM,this.sitezone),e},o);function o(e,n,t,r){a.call(this,e,n,t),this.sitezone=r,a.prototype.setWithViewportHeight.call(this,!0)}n.DiscussionsBannerParamJs=t}),define("OK/banners/bannerNew/discussions/DiscussionsBannerJs",["require","exports","OK/banners/bannerNew/ValueProviderJs","OK/banners/bannerNew/config/BannerCfgJs","OK/banners/bannerNew/discussions/DiscussionsBannerParamJs","OK/banners/bannerNew/banners/CompositeBannerJs","OK/banners/bannerNew/banners/SimpleBannerJs","OK/banners/bannerNew/banners/BannerProxyJs","OK/banners/bannerNew/transport/BannerTransportJs","OK/banners/bannerNew/BannerModelJs","OK/DispatcherJs"],function(e,n,i,a,o,s,u,t,c,l,p){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DiscussionsBannerJs=void 0;function r(e){this.topBanner=e,this.topBannerSlot=new i.ValueProviderJs(function(){return a.BannerCfgJs.getInstance().getApplicationBannerCfg().getDiscussionsTopSlot()})}r.prototype.init=function(e){var r=this;this.banner=new t.BannerProxyJs({createDelegate:function(){var e=new o.DiscussionsBannerParamJs(!1,!0,!0,"6"),n=new l.BannerModelJs(r.topBannerSlot,e,c.BannerTransportJs.getInstance()),t=new u.SimpleBannerJs({view:r.topBanner,model:n}).setInLayer(!0);return a.BannerCfgJs.getInstance().discussionsRefreshEnabled&&(e=new i.ValueProviderJs(function(){return a.BannerCfgJs.getRefreshPolicyCfg().getTransition("discussionsBanner")}),n=new i.ValueProviderJs(function(){return a.BannerCfgJs.getRefreshPolicyCfg().getTimeout("discussionsBanner")}),t.attachRefreshTrigger(new u.NavigationTriggerJs(e),"navi_hook"),t.attachRefreshTrigger(new u.TimeoutTriggerJs(n),"timeout_hook")),(new s.CompositeBannerJs).addBanner(t)},key:function(){return"disc"}}),this.banner.init(e),p.DispatcherJs.get().forthColumnToggledEvent.attach(this.onColumnToggled,this)},r.prototype.show=function(){null===this.banner&&this.init(!1),this.banner.show()},r.prototype.hide=function(){null!==this.banner&&this.banner.hide()},r.prototype.destroy=function(){null!==this.banner&&(this.banner.destroy(),this.banner=null),p.DispatcherJs.get().forthColumnToggledEvent.detach(this.onColumnToggled,this)},r.prototype.onColumnToggled=function(e){e?this.show():this.hide()},n.DiscussionsBannerJs=r}),define("b/banners",["OK/banners/BannerController","OK/banners/BannerLoader","OK/banners/bannerNew/hooks/BannerNavigationDataProviderHookJs","OK/banners/bannerNew/hooks/BaseBannerHookJs","OK/banners/bannerNew/hooks/AppsRecommendBannerHookJs","OK/banners/bannerNew/hooks/BannerAppsHookJs","OK/banners/bannerNew/hooks/BannerHookJs","OK/banners/bannerNew/hooks/ForthColumnBannerHookJs","OK/banners/bannerNew/hooks/MediaTopicLayerContentHookJs","OK/banners/bannerNew/hooks/ViewportHeightAwareBannersHookJs","OK/banners/bannerNew/discussions/DiscussionsBannerJs"],{});
