define("modules/helpers/nflTokenHelper",["jquery","modules/services/deferredService","modules/helpers/browserHelper","modules/helpers/stringHelper","modules/helpers/dateHelper"],function(e,n,r,t,o){var i=function(){var l=function(){return localStorage.getItem("authorizationProviderUserId")},u=function(){return localStorage.getItem("deviceInfo")},a=function(){return localStorage.getItem("identityProviderId")},s=function(){return localStorage.getItem("networkType")},f=function(){var e=u();return{ClientType:i.getClientType(),DeviceId:i.getDeviceId(),DeviceInfo:e?btoa(e):null,NetworkType:s(),UserAgent:r.getUserAgent()}},d=function(r){var t=e.Deferred(),o=f();return e.extend(o,{AuthorizationProviderUserId:l(),IdentityProviderId:a(),Uid:r?r.UID:null,UidSignature:r?r.UIDSignature:null,SignatureTimestamp:r?parseInt(r.signatureTimestamp):null}),n.postJson("/oauth/nfl/token/full",o).done(function(e){t.resolve(i.transformToken(e))}).fail(function(){t.resolve(null)}),t.promise()},c=function(){var r=e.Deferred(),t=f();return e.extend(t,{AuthorizationProviderUserId:l(),IdentityProviderId:a()}),n.postJson("/oauth/nfl/token/mvpd",t).done(function(e){r.resolve(i.transformToken(e))}).fail(function(){r.reject(null)}),r.promise()},p=function(r){var t=e.Deferred(),o=f();return e.extend(o,{Uid:r?r.UID:null,UidSignature:r?r.UIDSignature:null,SignatureTimestamp:r?parseInt(r.signatureTimestamp):null}),n.postJson("/oauth/nfl/token/user",o).done(function(e){t.resolve(i.transformToken(e))}).fail(function(){t.reject(null)}),t.promise()},v=function(){var r=e.Deferred(),t=f();return n.postJson("/oauth/nfl/token/client",t).done(function(e){r.resolve(i.transformToken(e))}).fail(function(){r.reject(null)}),r.promise()};return{getClientType:function(){var e="WEB_DESKTOP_DESKTOP";return r.isIOS()&&r.isMobile()?e="WEB_IOS_MOBILE_WEB":r.isIOS()&&r.isTablet()?e="WEB_IOS_TABLET_WEB":r.isAndroid()&&r.isMobile()?e="WEB_ANDROID_MOBILE_WEB":r.isAndroid()&&r.isTablet()&&(e="WEB_ANDROID_TABLET_WEB"),e},getDeviceId:function(){var e=this.getTokenFromLs();return e&&e.rawData&&e.rawData.deviceId?e.rawData.deviceId:t.generateGuid()},isTokenExpired:function(e){return!e||!e.expires||o.getDateByMS(e.expires)<=o.getCurrentDate()||o.getDateByMS(e.expires)>=o.addHours(o.getCurrentDate(),2)},getTokenFromLs:function(){var e=localStorage.getItem("nfl.nflToken");return e?JSON.parse(e):null},getToken:function(n){var r=e.Deferred(),t=i.getTokenFromLs();if(t&&!i.isTokenExpired(t))return r.resolve(t),r.promise();var o,u=void 0!==n?n:{},a=!e.isEmptyObject(u),s=l();return o=s&&a?d:s&&!a?c:!s&&a?p:v,e.when(o(u)).done(function(e){r.resolve(e)}).fail(function(){r.resolve(null)}),r.promise()},transformToken:function(n){if(!n||!n.accessToken)return null;var r=t.parseJwt(n.accessToken);return{expires:1e3*n.expiresIn,rawData:e.extend({},n,r)}},storeToken:function(e){e&&localStorage.setItem("nfl.nflToken",JSON.stringify(e))},removeToken:function(){localStorage.removeItem("nfl.nflToken")}}}();return i});
//# sourceMappingURL=nflTokenHelper.js.map