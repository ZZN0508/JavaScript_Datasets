!function(e,t,c){function s(e){}function o(e,t,o){for(this.callback=o||s,this.errors=[],this.fields={},this.form=this._formByNameOrNode(e)||{},this.messages={},this.handlers={},e=0,o=t.length;e<o;e++){var n=t[e];if((n.name||n.names)&&n.rules)if(n.names)for(var i=0;i<n.names.length;i++)this._addField(n,n.names[i]);else this._addField(n,n.name)}var a,r=this.form.onsubmit;this.form.onsubmit=(a=this,function(e){try{return a._validateForm(e)&&(r===c||r())}catch(e){}})}function n(e,t){var o;if(!(0<e.length)||"radio"!==e[0].type&&"checkbox"!==e[0].type)return e[t];for(o=0;o<e.length;o++)if(e[o].checked)return e[o][t]}var p={required:"The %s field is required.",valid_phoneno:"The %s field is not valid.",matches:"The %s field does not match the %s field.",default:"The %s field is still set to default, please change.",valid_email:"The %s field must contain a valid email address.",valid_emails:"The %s field must contain all valid email addresses.",min_length:"The %s field must be at least %s characters in length.",max_length:"The %s field must not exceed %s characters in length.",exact_length:"The %s field must be exactly %s characters in length.",greater_than:"The %s field must contain a number greater than %s.",less_than:"The %s field must contain a number less than %s.",alpha:"The %s field must only contain alphabetical characters.",alpha_numeric:"The %s field must only contain alpha-numeric characters.",alpha_dash:"The %s field must only contain alpha-numeric characters, underscores, and dashes.",alpha_numeric_dash_combo:"The %s field must contain only combination of alpha-numeric characters and dashes.",alphanumeric_combo:"The %s field must contain only combination of alpha-numeric characters.",numeric:"The %s field must contain only numbers.",integer:"The %s field must contain an integer.",decimal:"The %s field must contain a decimal number.",is_natural:"The %s field must contain only positive numbers.",is_natural_no_zero:"The %s field must contain a number greater than zero.",valid_ip:"The %s field must contain a valid IP.",valid_base64:"The %s field must contain a base64 string.",valid_credit_card:"The %s field must contain a valid credit card number.",is_file_type:"The %s field must contain only %s files.",valid_url:"The %s field must contain a valid URL.",valid_ca_zip:"The %s field must contain a valid Postal Code."},i=/^[ABCEGHJKLMNPRSTVXY]{1}\d{1}[A-Z]{1} *\d{1}[A-Z]{1}\d{1}$/,a=/^(\\+)|(9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\d{1,14}$/,d=/^(.+?)\[(.+)\]$/,r=/^[0-9]+$/,l=/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[-])[A-Za-z\d][A-Za-z\d-]+$/i,u=/^(?=.*[0-9])(?=.*[a-zA-Z])([a-zA-Z0-9]+)$/,m=/^\-?[0-9]+$/,g=/^\-?[0-9]*\.?[0-9]+$/,f=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,h=/^[a-z]+$/i,y=/^[a-z0-9]+$/i,v=/^[a-z0-9_\-]+$/i,C=/^[0-9]+$/i,T=/^[1-9][0-9]*$/i,w=/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i,S=/[^a-zA-Z0-9\/\+=]/i,L=/^[\d\-\s]+$/,k=/^((http|https):\/\/(\w+:{0,1}\w*@)?(\S+)|)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;o.prototype.setMessage=function(e,t){return this.messages[e]=t,this},o.prototype.registerCallback=function(e,t){return e&&"string"==typeof e&&t&&"function"==typeof t&&(this.handlers[e]=t),this},o.prototype._formByNameOrNode=function(e){return"object"==typeof e?e:t.forms[e]},o.prototype._addField=function(e,t){this.fields[t]={name:t,display:e.display||t,rules:e.rules,id:null,type:null,value:null,checked:null}},o.prototype._validateForm=function(e){for(var t in this.errors=[],this.fields){var o;this.fields.hasOwnProperty(t)&&(o=this.fields[t]||{},(t=this.form[o.name])&&t!==c&&(o.id=n(t,"id"),o.type=(0<t.length?t[0]:t).type,o.value=n(t,"value"),o.checked=n(t,"checked"),this._validateField(o)))}return"function"==typeof this.callback&&this.callback(this.errors,e),0<this.errors.length&&(e&&e.preventDefault?e.preventDefault():event&&(event.returnValue=!1)),!0},o.prototype._validateField=function(e){for(var t=e.rules.split("|"),o=e.rules.indexOf("required"),n=!e.value||""===e.value||e.value===c,i=0,a=t.length;i<a;i++){var r=t[i],s=null,l=!1,u=d.exec(r);if((-1!==o||-1!==r.indexOf("!callback_")||!n)&&(u&&(r=u[1],s=u[2]),"!"===r.charAt(0)&&(r=r.substring(1,r.length)),"function"==typeof this._hooks[r]?this._hooks[r].apply(this,[e,s])||(l=!0):"callback_"===r.substring(0,9)&&(r=r.substring(9,r.length),"function"==typeof this.handlers[r]&&!1===this.handlers[r].apply(this,[e.value,s])&&(l=!0)),l)){t=this.messages[r+"#"+e.name]||this.messages[r]||p[r],o="An error has occurred with the "+e.display+" field.",t&&(o=t.replace("%s",e.display),s&&((cu=0<=s.indexOf("###")&&s.split("###"))?cu[1]&&(o=cu[1]):o=o.replace("%s",this.fields[s]?this.fields[s].display:s))),this.errors.push({Id:e.id,Name:e.name,Message:o,Rule:r});break}}},o.prototype._hooks={required:function(e){var t=e.value.trim();return"checkbox"===e.type||"radio"===e.type?!0===e.checked:null!==t&&""!==t},default:function(e,t){return e.value!==t},matches:function(e,t){t=this.form[t];return!!t&&e.value===t.value},valid_ca_zip:function(e){return i.test(e.value)},valid_email:function(e){return f.test(e.value)},valid_emails:function(e){e=e.value.split(",");for(var t=0;t<e.length;t++)if(!f.test(e[t]))return!1;return!0},min_length:function(e,t){return!!r.test(t)&&e.value.length>=parseInt(t,10)},max_length:function(e,t){return!!r.test(t)&&e.value.length<=parseInt(t,10)},exact_length:function(e,t){return!!r.test(t)&&e.value.length===parseInt(t,10)},greater_than:function(e,t){return!!g.test(e.value)&&parseFloat(e.value)>parseFloat(t)},less_than:function(e,t){return!!g.test(e.value)&&parseFloat(e.value)<parseFloat(t)},alpha:function(e){return h.test(e.value)},alpha_numeric:function(e){return y.test(e.value)},alpha_dash:function(e){return v.test(e.value)},alpha_numeric_dash_combo:function(e){return l.test(e.value)},alphanumeric_combo:function(e){return u.test(e.value)},numeric:function(e){return r.test(e.value)},integer:function(e){return m.test(e.value)},decimal:function(e){return g.test(e.value)},is_natural:function(e){return C.test(e.value)},is_natural_no_zero:function(e){return T.test(e.value)},valid_ip:function(e){return w.test(e.value)},valid_phoneno:function(e){return a.test(e.value)},valid_base64:function(e){return S.test(e.value)},valid_url:function(e){return k.test(e.value)},valid_credit_card:function(e){if(!L.test(e.value))return!1;for(var t=0,o=0,n=!1,i=(e=e.value.replace(/\D/g,"")).length-1;0<=i;i--)o=e.charAt(i),o=parseInt(o,10),n&&9<(o*=2)&&(o-=9),t+=o,n=!n;return 0==t%10},is_file_type:function(e,t){if("file"!==e.type)return!0;for(var o=e.value.substr(e.value.lastIndexOf(".")+1),n=t.split(","),i=!1,a=0,r=n.length;a<r;a++)o==n[a]&&(i=!0);return i}},e.FormValidator=o}(window,document);var LRNameSpace={};!function(i){i.Storage=function(n,o){return{isLocalStorageNameSupported:function(e){if(!window[e])return!1;var t=window[e];try{return t.setItem("test","1"),t.removeItem("test"),!0}catch(e){return!1}},setBrowserStorage:function(e,t){var o=!0;this.isLocalStorageNameSupported("localStorage")&&(localStorage.setItem(e,t),o=!1),this.isLocalStorageNameSupported("sessionStorage")&&(sessionStorage.setItem(e,t),o=!1),o&&n&&n.options&&i.cookies.setItem(e,t,"",n.options.appPath)},getBrowserStorage:function(e){if(o&&e===o.storedTokenName){var t=this.getBrowserStorage("lr-session-token");if(t)return t=t.replace(/"/g,""),this.setBrowserStorage(o.storedTokenName,t),t}return(this.isLocalStorageNameSupported("localStorage")&&null!==localStorage.getItem(e)&&void 0!==localStorage.getItem(e)&&""!==localStorage.getItem(e)?localStorage:this.isLocalStorageNameSupported("sessionStorage")&&null!==sessionStorage.getItem(e)&&void 0!==sessionStorage.getItem(e)&&""!==sessionStorage.getItem(e)?sessionStorage:i.cookies).getItem(e)},removeBrowserStorage:function(e){var t=!0;this.isLocalStorageNameSupported("localStorage")&&(localStorage.removeItem(e),t=!1),this.isLocalStorageNameSupported("sessionStorage")&&(sessionStorage.removeItem(e),t=!1),t&&n&&n.options&&i.cookies.removeItem(e,n.options.appPath)}}}}(LRNameSpace),LRNameSpace.cookies={intToString:function(e){return e.toString()},stringToInt:function(e){return parseInt(e,10)||0},isSameSiteNoneCompatible:function(e){return!this.isSameSiteNoneIncompatible(e.toString())},isSameSiteNoneIncompatible:function(e){return this.hasWebKitSameSiteBug(e)||this.dropsUnrecognizedSameSiteCookies(e)},hasWebKitSameSiteBug:function(e){return this.isIosVersion(12,e)||this.isMacosxVersion(10,14,e)&&(this.isSafari(e)||this.isMacEmbeddedBrowser(e))},dropsUnrecognizedSameSiteCookies:function(e){return this.isChromiumBased(e)&&this.isChromiumVersionAtLeast(51,e)&&!this.isChromiumVersionAtLeast(67,e)||this.isUcBrowser(e)&&!this.isUcBrowserVersionAtLeast(12,13,2,e)},regexContains:function(e,t){return null!==e.match(t)},extractRegexMatch:function(e,t,o){t=e.match(t);return null!==t&&void 0!==t[o]?t[o]:null},isIosVersion:function(e,t){return this.extractRegexMatch(t,/\(iP.+; CPU .*OS (\d+)[_\d]*.*\) AppleWebKit\//,1)===this.intToString(e)},isMacosxVersion:function(e,t,o){var n=/\(Macintosh;.*Mac OS X (\d+)_(\d+)[_\d]*.*\) AppleWebKit\//;return this.extractRegexMatch(o,n,1)===this.intToString(e)&&this.extractRegexMatch(o,n,2)===this.intToString(t)},isSafari:function(e){return null!==e.match(/Version\/.* Safari\//)&&!this.isChromiumBased(e)},isMacEmbeddedBrowser:function(e){return this.regexContains(e,/^Mozilla\/[.\d]+ \(Macintosh;.*Mac OS X [_\d]+\) AppleWebKit\/[.\d]+ \(KHTML, like Gecko\)$/)},isChromiumBased:function(e){return this.regexContains(e,/Chrom(e|ium)/)},isChromiumVersionAtLeast:function(e,t){return e<=this.stringToInt(this.extractRegexMatch(t,/Chrom[^ /]+\/(\d+)[.\d]* /,1))},isUcBrowser:function(e){return this.regexContains(e,/UCBrowser\//)},isUcBrowserVersionAtLeast:function(e,t,o,n){var i=/UCBrowser\/(\d+)\.(\d+)\.(\d+)[.\d]* /,a=this.stringToInt(this.extractRegexMatch(n,i,1)),r=this.stringToInt(this.extractRegexMatch(n,i,2)),i=this.stringToInt(this.extractRegexMatch(n,i,3));return a!==e?e<a:r!==t?t<r:o<=i},getItem:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t,o,n,i,a){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var r="";if(o)switch(o.constructor){case Number:r="; expires="+function(e){if(e===1/0)return"Fri, 31 Dec 9999 23:59:59 GMT";var t=new Date;return t.setTime(t.getTime()+1e3*e),t.toGMTString()}(o)+o===1/0?"":"; max-age="+o;break;case String:r="; expires="+o;break;case Date:r="; expires="+o.toUTCString()}"lr-user--token"===e&&(a=!0);var s=navigator.userAgent;return"lr-session-token"===e&&this.isSameSiteNoneCompatible(s)?document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+r+(i?"; domain="+i:"")+(n?"; path="+n:"")+";secure;SameSite=None":document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+r+(i?"; domain="+i:"")+(n?"; path="+n:"")+(a?"; secure":""),!0},removeItem:function(e,t,o){return!!this.hasItem(e)&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(o?"; domain="+o:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return!!e&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=e.length,o=0;o<t;o++)e[o]=decodeURIComponent(e[o]);return e}},LRNameSpace.Utilities=function(){var e=navigator.userAgent.toLowerCase(),o={version:(e.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(e),opera:/opera/.test(e),msie:(/msie/.test(e)||/trident/.test(e))&&!/opera/.test(e),mozilla:/mozilla/.test(e)&&!/(compatible|webkit)/.test(e)},i=!1,a=!1,n=[];function r(){if(!a&&(a=!0,n)){for(var e=0;e<n.length;e++)n[e].call(window,[]);n=[]}}function s(){var n,e,t;i||(i=!0,document.addEventListener&&!o.opera&&document.addEventListener("DOMContentLoaded",r,!1),o.msie&&window===top&&function(){if(!a){try{document.documentElement.doScroll("left")}catch(e){return}r()}}(),o.opera&&document.addEventListener("DOMContentLoaded",function(){if(!a){for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].disabled)return;r()}},!1),o.safari&&function(){if(!a&&("loaded"===document.readyState||"complete"===document.readyState)){if(void 0===n){for(var e=document.getElementsByTagName("link"),t=0;t<e.length;t++)"stylesheet"===e[t].getAttribute("rel")&&n++;var o=document.getElementsByTagName("style");n+=o.length}document.styleSheets.length===n&&r()}}(),e=r,t=window.onload,"function"!=typeof window.onload?window.onload=e:window.onload=function(){t&&t(),e()})}return{browser:o,getHashParam:function(e){var t=window.location.hash.match(new RegExp(e+"=([^&]*)"));return window.location.hash&&null!=t?t[1]:this.getQueryParameterByName(e)},keysToLowerCase:function(e){for(var t,o=Object.keys(e),n=o.length,i={};n--;)i[(t=o[n]).toLowerCase()]=e[t],"object"==typeof i[t.toLowerCase()]&&null!=i[t.toLowerCase()]&&(i[t.toLowerCase()]=this.keysToLowerCase(i[t.toLowerCase()]));return i},elementsByClass:function(e,t){if(""!==e){t=t||document.body;for(var o=[],n=new RegExp("(^| )"+e+"( |$)"),i=t.getElementsByTagName("*"),a=0,r=i.length;a<r;a++)n.test(i[a].className)&&o.push(i[a]);return o}},isValidUrl:function(e){return!!/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i.test(e)},hasClass:function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},addclass:function(e,t){return!this.hasClass(e,t)&&(e.className+=" "+t,!0)},isSubstring:function(e,t){for(var o in t)if(-1!==t[o].indexOf(e))return o;return!1},isJsonString:function(e){try{return JSON.parse(e)}catch(e){return!1}},addEvent:function(e,t,o){var n=[];t instanceof Array?n=t:n.push(t);for(var i=0;i<n.length;i++)n[i]["on"+e]=o},getQueryParameterByName:function(e,t){t="&"+(t||location.search),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null==t?null:decodeURIComponent(t[1].replace(/\+/g," "))},getParameterByName:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");e=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))},getQueryStringValue:function(e,t){e=e||window.location.href,e=new RegExp("[?&]"+t+"=([^&#]*)","i").exec(e);return e?e[1]:null},extend:function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},ready:function(e,t){s(),a?e.call(window,[]):n.push(function(){return e.call(window,[])})},parseQueryString:function(e){var t={};if((e||""!==e)&&"string"==typeof e)for(var o=e.split("&"),n=0;n<o.length;n++){var i=o[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t},encodedString:function(e){return e=-1===e.indexOf("%2B")?e.replace(/\+/g,"%2B"):e},mergeOptions:function(e,t){var o,n,i={};for(o in e)i[o]=e[o];for(n in t)i[n]=t[n];return i},mergeObjects:function(e,t,o){var n,i,a=[];for(i in e){for(var r in t)n=o?t[r]===e[i]:t[r].name===e[i].name;if(n)break;a.push(e[i])}return a.concat(t)},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},randomString:function(e){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split("");e=e||Math.floor(Math.random()*t.length);for(var o="",n=0;n<e;n++)o+=t[Math.floor(Math.random()*t.length)];return o},findInSchema:function(e,t,o,n){for(var i=0;i<e.length;i++)if((n?e[i]&&e[i][t].toLowerCase():e[i]&&e[i][t])===o)return e[i];return null},jsonToQueryString:function(t){return Object.keys(t).map(function(e){return t[e]?encodeURIComponent(e)+"="+encodeURIComponent(t[e]):""}).join("&")},insertBefore:function(e,t){t.parentNode.insertBefore(e,t)},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},keyslowerToUpperCamelCase:function(e){for(var t,o=Object.keys(e),n=o.length,i={};n--;)i[(t=o[n]).charAt(0).toUpperCase()+t.substr(1)]=e[t];return i},findElementByRegex:function(e,t,o){for(var n=o?document.querySelectorAll(o):document.querySelectorAll("*"),i=[],a=0;a<n.length;a++)t.test(n[a][e])&&i.push(n[a]);return i},isObject:function(e){return e instanceof Object&&e.constructor===Object},parseString:function(e){return void 0!==e&&JSON.parse(e)},containsObject:function(e,t,o){if(o){for(var n=0;n<e.length;n++)if(e[n][o]===t[o])return!0;return!1}}}},LRNameSpace.ProgressiveProfiling=function(m,g,f,h){return{fetchSchema:function(e){m.util.ajaxCall("get",h.configApiDomain+"progressiveProfilingSchema?apikey="+m.options.apiKey+"&appName="+m.options.appName,"",e)},execStep:function(r,e){var s,l,u,c,p,d;m.progressiveProfilingSchema&&(s=e.onSuccess||function(){},l=e.onError||function(){},u=e.container||"",c=e.classPrefix||"",p=e.templateName||"",(d=m.storage.getBrowserStorage(h.storedTokenName))&&m.util.ajaxCall("get",h.apiDomain+"/auth/socialidentity?apiKey="+m.options.apiKey+"&access_token="+d,"",function(e){var t,o,n,i,a=m.util.findInSchema(m.progressiveProfilingSchema.ProfilingSteps,"Step",r);a?((t={}).Profile=e,t.access_token=d,"email"===(o=e.Provider.toLowerCase())||"raas"===o||m.options.progressiveProfilingTraditional?(m.options.progressiveProfilingTraditional&&"email"!==o&&"raas"!==o&&(e=m.LoggedinSocialProvderProfile),n=a.Schema,i=g.mapSchema(n,e,null,!0),t.Profile=e,0<i.length?g.createForm(i,"progressiveProfiling",u,function(e){f.updateData(t,u,e,s,l,c,i,"progressiveProfiling")},function(e){l(e)},c):g.loginHandleToken(t,"",s,l)):(e=a.Scopes,(a=m.util.findInSchema(e,"Provider",o,!0))?(e="https://"+(m.options.customDomain||m.options.appName+"."+h.hubDomain)+"/RequestHandlor.aspx?apikey="+m.options.apiKey+"&provider="+o+"&scope="+a.Scopes,(a=[]).push({Name:o,Endpoint:e}),g.renderCustomInterface(u,"",p,"","",a),g.socialLogin(u,s,l)):g.loginHandleToken(t,"",s,l))):m.log("Step Schema not found.")}))}}},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,o=Number(arguments[1])||0;for((o=o<0?Math.ceil(o):Math.floor(o))<0&&(o+=t);o<t;o++)if(o in this&&this[o]===e)return o;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e){"use strict";if(null==this)throw new TypeError;var t=Object(this),o=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n,i=[],a=arguments[1],r=0;r<o;r++)r in t&&(n=t[r],e.call(a,n,r,t)&&i.push(n));return i}),function(i){"use strict";function n(){for(var e=i.location.hash?i.location.hash.substr(1).split("&"):[],t={},o=0;o<e.length;o++){var n=e[o].split("=");t[n[0]]=decodeURIComponent(n[1])}return t}function a(e){var t,o=[];for(t in e)o.push(t+"="+encodeURIComponent(e[t]));i.location.hash=o.join("&")}i.hash={get:function(e){var t=n();return e?t[e]:t},add:function(e){var t,o=n();for(t in e)o[t]=e[t];a(o)},remove:function(e){e="string"==typeof e?[e]:e;for(var t=n(),o=0;o<e.length;o++)delete t[e[o]];a(t)},clear:function(){a({})}}}(window),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),o=1;o<arguments.length;o++){var n=arguments[o];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},writable:!0,configurable:!0});var LoginRadiusDefaults={idPrefix:"loginradius-",classPrefix:"loginradius-",apiDomain:"https://api.loginradius.com/identity/v2",hubDomain:"hub.loginradius.com",cloudApiDomain:"https://cloud-api.loginradius.com/",configApiDomain:"https://config.lrcontent.com/ciam/",socialApiDomain:"https://api.loginradius.com/api/v2/",externalLibrary:"https://auth.lrcontent.com/v2/external-libs/",isRegFormSchemaLock:!1,isSecurityFormSchemaLock:!1,innerHTML:!1,autoFilledFieldforPasswordLesLogin:!1,socialRegFormId:"",lrResponseCounter:0,LRPhoneNo:"",lrCounterJwtResponse:"",lrCounterTokenResponse:"",storedTokenName:"LRTokenKey",storedTwoFAToken:"lr2fatok",storedSessionTokenData:"lrSessionTokenObj",storedOTPAuth:"lrotpauthver",storedGAAuth:"lrgaauthver",storedEmailOTPAuth:"lremailotpauthver",storedSQAuth:"lrsqauthver",storedUidName:"lr-user-uid",tokenCookie:"lr-user--token",isSSOInitFired:!1,pingCount:1,messages:{tokenValid:{Message:"Access token is not valid",Description:"LoginRadius Access Token is invalid, please verify the authentication response",ErrorCode:905},twofaTokenValid:{Message:"Token is not valid",Description:"Your session is not valid."},twofaGAAuthDisable:{Message:"Already Disabled",Description:"Google authenticator is already disabled."},twofaOTPAuthDisable:{Message:"Already Disabled",Description:"SMS authenticator is already disabled."},twofaAuthRequired:{Message:"Cannot Disable",Description:"Two factor authentication is required, So atleast one authenticator should be required."},invalidEmail:{Message:"Invalid Email",Description:"The email entered is not a valid email."},invalidPhone:{Message:"Invalid Phone",Description:"The mobile number entered is not valid."},disabledAccountLinking:"Account Linking disabled in your account",noSecurityQuestions:"There are no security questions for this application",invalidSott:"Something went wrong, please try again.",notValidMessage:"Error Message element not valid",passwordStrengthMessage:"Password strength meter configuration is not valid.",otpSent:"Verification Code Sent Successfully",vTokenError:{Message:"Verification token not found in query string."},notFound:"Data not found.",emailNotVerified:{Message:"The email is not verified, please verify the link in your email",Description:"The email is not verified, please verify the link in your email",ErrorCode:970},phoneNotVerified:{Message:"Phone number is not verified",Description:"The provided phone number is not verified, please use a verified phone number for login.",ErrorCode:1066},blockedUser:{Message:"User is blocked",Description:"This user is blocked by site admin",ErrorCode:991},unverifiedUser:{Message:"This Uid have only traditional unverified account",Description:"This Uid have only traditional unverified account",ErrorCode:1028}},buttonNames:{login:"Login",socialregistration:"Login",loginrequiredfieldsupdate:"Login",registration:"Register",verifyemail:"Verify",resetpassword:"Reset Password",resetpin:"Reset PIN",sociallogin:"Login",otp:"Verify",twofaotp:"Verify",twofaemailotp:"Verify",showqrcode:"Verify",updatephone:"Update",changephone:"Update",forgotpassword:"Send",forgotpin:"Send",securityquestions:"Get",changepassword:"Submit",changepin:"Change PIN",resendemailverification:"Send",addemail:"Send",removeemail:"Send",changeusername:"Submit",profileeditor:"Update Profile",otplogin:"Verification Code",passwordlessloginbuttonlabel:"Email me a link to Sign In",passwordlessloginotpbuttonlabel:"Send Verification Code to Sign In",createtwofactorauthentication:"2-Step Verification",sendotp:"Send Verification Code",resendotp:"Resend Verification Code",changenumber:"Change Number",backupcode:"Login",backupcodebutton:"Try another way to Sign In",backupcodebackbutton:"Back",generatebackupcodebutton:"Generate Backup Codes",disablegoogleauthenticator:"Disable Google Authenticator",disablesqauthenticator:"Disable Security Questions",disableemailotpauthenticator:"Disable Email Verification",disableotpauthenticator:"Disable SMS Verification",updatesecurityquestion:"Update Security Question",resetpwdbysecq:"Reset Password By SecurityQ",resetpinbysecq:"Reset PIN By SecurityQ",smartlogin:"Smart Login",validatecode:"Validate",onetouchlogin:"Login",progressiveprofiling:"Progressive Profiling",privacypolicyupdate:"Accept",updatephone2fa:"Update",pinsetup:"Set Pin",pinlogin:"Login",pinreauthentication:"Verify",pinloginbackbtn:"Back",consentlogin:"Submit Consent",customeventconsent:"Submit Consent",consenteditor:"Submit Consent",resetBackupCode:"Reset Backup Code",emailotp:"Verify Identity via Email ",googleauthenticator:"Verify Identity via Google authenticator app",securityquestionsauthenticator:"Verify Identity via Security Questions",mfasecurityquestion:"Submit",otpauthenticator:"Verify Identity via SMS",mfaselectemails:"Submit"},templates:{consentMainTemplate:"loginradius_consent_custom_tmpl",consentGroupTemplate:"loginradius_consent_group_tmpl",consentOptionTemplate:"loginradius_consent_option_tmpl"},options:{passwordlessLoginEmailTemplate:"",callbackUrl:window.location,callbackInsideSameWindow:"",callbackType:"",scope:"",loginUrl:"",deleteUrl:"",emailTemplate:"",verificationUrl:"",verificationEmailTemplate:"",resetPasswordEmailTemplate:"",resetPINEmailTemplate:"",resetPasswordConfirmationEmailTemplate:"",resetPINConfirmationEmailTemplate:"",smartLoginRedirectUrl:"",autoLoginRedirectUrl:"",smartLoginEmailTemplate:"",autoLoginEmailTemplate:"",smsTemplate2FA:"",smsTemplateForgot:"",smsTemplateWelcome:"",smsTemplateOneTouchLoginWelcome:"",smsTemplateOneTouchLogin:"",passwordlessLoginSMSTemplate:"",smsTemplate2FAWelcome:"",smsTemplatePhoneVerification:"",smsTemplateUpdatePhone:"",welcomeEmailTemplate:"",onetouchLoginEmailTemplate:"",deleteUserEmailTemplate:"",onetouchLoginRedirectUrl:"",resetPasswordUrl:"",resetPINUrl:"",templateName:"",debugMode:!1,tokenType:"lrtoken",integrationName:"",smartLoginPingCount:100,smartLoginPingInterval:5,crossDeviceSSOPingCount:100,crossDeviceSSOPingInterval:5,maskSensitiveInput:!1,enableHeaderSott:!0,accessTokenResponse:!0,rbaOneclickEmailTemplate:"",rbaOTPSmsTemplate:"",rbaCityEmailTemplate:"",rbaCountryEmailTemplate:"",rbaBrowserEmailTemplate:"",rbaIpEmailTemplate:"",rbaCitySmsTemplate:"",rbaCountrySmsTemplate:"",rbaBrowserSmsTemplate:"",rbaIpSmsTemplate:"",setLRSession:!1,askOptionalFieldsOnProgressiveSteps:!0,disableResendOTPButton:!1,disableResendOTPButtonDelay:5,EmailTemplate2FA:"",authenticatorOptionsOrder:["emailotp","securityquestion","googleauth","sms"]},regexExpression:{emailRegex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,phoneRegex:/^(\\+)|(9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\d{8,14}$/},_uuidFormat:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i};function LoginRadiusUtility(v,e){var l=LoginRadiusDefaults.buttonNames,C=new LRNameSpace.Utilities,u=this;u.elementById=function(e,t){var o=document.getElementById(e);if(o)return o;t||v.log("Unable to find id: "+e)},u.getThisObjectName=function(){for(var e in v.global)if("frameElement"!==e&&"webkitStorageInfo"!==e&&"webkitIndexedDB"!==e&&v.global[e]===v)return e},u.serialize=function(e,t){if(e&&"FORM"===e.nodeName){for(var o,n=[],i=e.elements.length-1;0<=i;--i)if(""!==e.elements[i].name&&(t||""!==e.elements[i].value.trim()))switch("emailid"!==e.elements[i].name||v.options.usernameLogin||v.options.duplicateEmailWithUniqueUsername||(e.elements[i].value=e.elements[i].value.toLowerCase()),e.elements[i].nodeName){case"INPUT":switch(e.elements[i].type){case"text":case"hidden":case"button":case"reset":case"submit":case"email":var a=e.elements[i].name;"emailid"===a&&(a="email"),e.elements[i].disabled||n.push(a+"="+encodeURIComponent(e.elements[i].value.trim()));break;case"password":n.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].value));break;case"checkbox":n.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].checked));break;case"radio":e.elements[i].checked&&n.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].value))}break;case"TEXTAREA":n.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].value.trim()));break;case"SELECT":switch(e.elements[i].type){case"select-one":n.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].value.trim()));break;case"select-multiple":for(o=e.elements[i].options.length-1;0<=o;--o)e.elements[i].options[o].selected&&n.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].options[o].value.trim()))}break;case"BUTTON":switch(e.elements[i].type){case"reset":case"submit":case"button":n.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].value.trim()))}}return n.join("&")}},u.addJs=function(e,t){var o=(t=t||document).getElementsByTagName("head")[0],t=t.createElement("script");return t.src=e,t.type="text/javascript",o.appendChild(t),t},u.hashTmpl=function e(t,o){t=/\W/.test(t)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<#").join("\t").replace(/((^|#>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)#>/g,"',$1,'").split("\t").join("');").split("#>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):n[t]=n[t]||(u.elementById(t)?e(u.elementById(t).innerHTML):"");return"function"==typeof t?o?t(o):t:""};var n={};u.tmpl=function e(t,o){t=/\W/.test(t)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):n[t]=n[t]||(u.elementById(t)?e(u.elementById(t).innerHTML):"");return"function"==typeof t?o?t(o):t:""},u.jsonpCall=function(e,t,o,n){v.$hooks.call("startProcess",n);o=o||"Loginradius"+Math.floor(1e18*Math.random()+1);window[o]=function(e){t(e),v.$hooks.call("endProcess",n)};o=-1!==e.indexOf("?")?e+"&callback="+o:e+"?callback="+o;u.addJs(o)},u.getButtonAttribute=function(e,t,o,n,i){var a,t=t||LoginRadiusDefaults.idPrefix;v.buttonElements[e]?a=(a=v.buttonElements[e]).cloneNode(!0):((a=document.createElement("input")).type="button",a.value=v.buttonsName[e]||l[e]||n),o&&(a.onclick=o),n&&(a.datavalue=n.trim()),a.id=t+"button-"+e;n="";return(n=document.createElement("div")).setAttribute("class",t+"-form-element-content content-"+t+e),n.appendChild(a),n},u.ajaxCall=function(e,t,o,n,i,a){var r=this,s=i;i&&-1!==i.indexOf("##")&&(s=i.split("##")[1]),v.$hooks.call("startProcess",i,o);try{var l=new XMLHttpRequest;if(v.options.projectionFields&&i){var u=Object.keys(v.options.projectionFields),c=["verifyOTP","updateData"],p=!1,d=i;if(v.LRCheckRegistration?(p=-1!==c.indexOf(i),d="registration"):v.LRCheckLogin&&(p=-1!==c.indexOf(i),d="login"),-1!==u.indexOf(i)||p)if((g=v.options.projectionFields[d])&&0<g.length){var m=["ErrorCode","Profile/Uid","Profile/IsDeleted","access_token","Profile/EmailVerified","Profile/PhoneIdVerified","Profile/PhoneId","PhoneId","PhoneIdVerified","EmailVerified","Uid","IsDeleted"];(v.options.twoFactorAuthentication||v.options.optionalTwoFactorAuthentication)&&m.push("SecondFactorAuthentication/SecondFactorAuthenticationToken","SecondFactorAuthentication/IsOTPAuthenticatorVerified","SecondFactorAuthentication/IsGoogleAuthenticatorVerified","SecondFactorAuthentication/OTPPhoneNo","SecondFactorAuthentication/ManualEntryCode");for(var g=C.mergeObjects(g,m,!0),f="&fields=",h=0;h<g.length;h++)h===g.length-1?f+=g[h]:f=f+g[h]+",";t+=f}}var y=v.util.getQueryParameterByName("access_token",t);v.options.passAccessTokenInHeader&&y&&-1<t.indexOf(LoginRadiusDefaults.apiDomain)||-1!==["setCustomToken","setToken"].indexOf(i)?(t=t.replace("&access_token="+y,"").replace("?access_token="+y+"&","?").replace("?access_token="+y,"?"),l.open(e,t,!0),l.setRequestHeader("Authorization","Bearer "+y)):l.open(e,t,!0),(-1<t.indexOf("/ssologin/")||"setToken"===i)&&(l.withCredentials=!0),-1===t.indexOf("cdn")&&-1===t.indexOf(".json")&&l.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.sottcheck&&(l.setRequestHeader("X-LoginRadius-Sott",v.options.sott),delete o.sottcheck),o?(o="string"==typeof o||o instanceof String?JSON.stringify(C.parseQueryString(o)):JSON.stringify(o),l.setRequestHeader("Content-Type","application/json"),l.send(o)):l.send(null),l.onreadystatechange=function(){var e,t;4===l.readyState&&((t=l.response)&&(e=JSON.parse(t),-1<Object.keys(e).map(function(e){return e.toLowerCase()}).indexOf("errorcode")?v.$hooks.call("xhrEndWithError",i):v.$hooks.call("xhrEndWithSuccess",i)),"500"==l.status&&((e=JSON.parse(t)).ErrorCode="500",t=JSON.stringify(e),v.$hooks.call("xhrEndWithError",i)),(t=r.isJsonString(t))&&(v.$hooks.call("successCallback",s,t,o),a?n(a,t):n(t)),v.$hooks.call("endProcess",i))},l.onerror=function(){v.$hooks.call("xhrEndWithError",i)}}catch(e){}},u.openWindow=function(e){if(e=e||u.href,!v.options.isMobile){var t=document.createElement("a");t.href=e;var o=C.getQueryParameterByName("provider",t.search),n="";v.options.noCallbackForSocialLogin&&(e+="&nocallback=true&callbackguid="+(n=v.util.randomString(16)));t=o&&"facebook"===o.toLowerCase()?"650":"450",t=v.options.customizeSocialPopup||"menubar=1,resizable=1,width="+t+",height=450,scrollbars=1";return window.open(e,"lrpopupchildwindow",t),v.$hooks.call("socialCalls",o,n),!1}n="no";v.options.debugMode&&(n="yes");var i=window.open(e,"_blank","location="+n);i.addEventListener("loadstop",function(e){e=null===(e=new RegExp("[\\?&]token=([^&#]*)").exec(e.url))?"":decodeURIComponent(e[1].replace(/\+/g," "));null!=e&&""!==e&&(i.close(),html5passToken(e))})},u.addHTMLContent=function(e,t,o,n,i){o=o||!1;var a=u.elementById(e);if(a||n)o||(a.innerHTML=""),n?(n=l[n.toLowerCase()],i=i||LoginRadiusDefaults.idPrefix,n=u.elementById(i+"submit-"+n.toLowerCase().replace(/ /g,"-")),C.insertBefore(t,n)):a.appendChild(t);else{var r=C.elementsByClass(e);if(r&&0<r.length)for(var s=0;s<r.length;s++)o||(r[s].innerHTML=""),r[s].appendChild(t)}},u.addRecaptchaJS=function(e){window.grecaptcha||!v.options.v2Recaptcha&&!e?!window.grecaptcha&&v.options.invisibleRecaptcha&&u.addJs("https://www.google.com/recaptcha/api.js"):v.options.v2RecaptchaLanguage?u.addJs("https://www.google.com/recaptcha/api.js?render=explicit&hl="+v.options.v2RecaptchaLanguage):u.addJs("https://www.google.com/recaptcha/api.js?render=explicit"),(v.options.tencentCaptcha||v.options.tencentCaptchaAsFallback)&&u.addJs("https://ssl.captcha.qq.com/TCaptcha.js")},u.renderV2Recaptcha=function(t,e,o){var n,i,a=u.elementById(t);(v.options.v2Recaptcha||e||v.options.invisibleRecaptcha||v.options.tencentCaptcha||v.options.tencentCaptchaAsFallback)&&(window.grecaptcha&&a&&a.innerHTML&&grecaptcha.reset(window[t+"lr_recaptcha_widgets_idprefix"]),i=setInterval(function(){n||(n=setInterval(function(){var e;window.grecaptcha?a&&""===a.innerHTML&&(e={sitekey:v.options.v2RecaptchaSiteKey||"6LeAiwITAAAAADlqb06JIGepBs8ZRo3OZ7C0W7U3",theme:"light",callback:function(e){a.style.display="block",o&&o(e)}},v.options.invisibleRecaptcha&&(e.size="invisible",e.callback="onCaptchaSubmit"),window[t+"lr_recaptcha_widgets_idprefix"]=grecaptcha.render(t,e),clearInterval(n)):(t+="_tencent",(e=document.getElementById(t))&&(e.style.display="block"),"undefined"!=typeof TencentCaptcha&&new TencentCaptcha(document.getElementById(t)),clearInterval(n))},1e3),clearInterval(i))},1e3))},u.captchaSchema=function(e,t,o,n){var i;!v.options.v2Recaptcha&&!o||u.elementById(e)?v.options.invisibleRecaptcha&&!u.elementById(e)&&(i={type:"captcha",name:"g-recaptcha-response",html:'<div id="'+e+'" style="'+("hide"===o?"display:none":"")+'" class="g-recaptcha" data-sitekey="'+(v.options.v2RecaptchaSiteKey||"6LeAiwITAAAAADlqb06JIGepBs8ZRo3OZ7C0W7U3")+'" data-size="invisible" data-callback="onCaptchaSubmit"></div>',display:"Captcha",rules:""},t.push(i)):t.push({type:"captcha",name:"g-recaptcha-response",html:'<div id="'+e+'" class="recaptcha_widget"></div>',display:"Captcha",rules:"required"}),u.elementById(e)||!v.options.tencentCaptcha&&!v.options.tencentCaptchaAsFallback||(window.onTencentCaptchaSubmit=function(e){0==e.ret&&(n?n(e):window.onTencentCaptchaSubmitCallback(e))},e={type:"captcha",name:"TencentCaptcha",html:"<div "+(o?"style=display:none; ":"")+' id= "'+e+'_tencent"  class="TencentCaptcha"  data-appid="'+v.options.tencentCaptchaAppid+'" data-cbfn="onTencentCaptchaSubmit"></div>',display:"Captcha",rules:""},t.push(e))},u.checkPhoneOrEmailLogin=function(e){var t=C.parseQueryString(e);return(t.emailid||t.email)&&(v.options.duplicateEmailWithUniqueUsername&&!t.username?e=e.replace("emailid","username").replace("email","username"):(t=t.emailid||t.email,LoginRadiusDefaults.regexExpression.emailRegex.test(t)?e=e.replace("emailid","email"):v.options.phoneLogin&&LoginRadiusDefaults.regexExpression.phoneRegex.test(t)?(e=e.replace("emailid","phone").replace("email","phone"),e+="&phoneApi=1"):v.options.usernameLogin&&(e=e.replace("emailid","username").replace("email","username")))),e},u.disableResendOTPButton=function(e){var t=v.options.disableResendOTPButtonDelay,o=e.target;o&&(o.disabled=!0,setTimeout(function(){o.disabled=!1},1e3*t))}}function LoginRadiusApiFramework(c,p){var e=this;e.init=function(){c.lrApiFramework=!0},e.login=function(e,t,o){c.getAppConfiguration(function(){p.loginController(c.util.jsonToQueryString(e),null,t,o)})},e.otpLogin=function(e,t,o){c.getAppConfiguration(function(){p.loginOTPController(c.util.jsonToQueryString(e),null,t,o)})},e.twoFALogin=function(e,t,o,n,i,a,r,s){n=n||function(){},r=r||function(){},s=s||function(){},i=i||function(){},a=a||function(){},c.getAppConfiguration(function(){p.login2FAController(c.util.jsonToQueryString(e),null,t,o,"",r,s,n,i,a)})},e.registration=function(e,t,o,n,i,a){i=i||function(){},a=a||function(){},c.getAppConfiguration(function(){p.registrationController(t,null,o,n,"",e,i,a)})},e.forgotPassword=function(e,t,o){c.getAppConfiguration(function(){p.forgotPasswordController(c.util.jsonToQueryString(e),"",t,o)})},e.forgotPIN=function(e,t,o){c.getAppConfiguration(function(){p.forgotPINController(c.util.jsonToQueryString(e),"",t,o)})},e.resetPassword=function(e,t,o){c.getAppConfiguration(function(){p.resetPasswordController(c.util.jsonToQueryString(e),t,o)})},e.resetPIN=function(e,t,o){c.getAppConfiguration(function(){p.resetPINController(c.util.jsonToQueryString(e),t,o)})},e.emailVerification=function(e,t,o){c.getAppConfiguration(function(){p.emailVerificationController(e.vtoken,t,o)})},e.socialLogin=function(e,t,o,n,i,a){c.getAppConfiguration(function(){c.LoginRadiusHostedPage&&c.SSOinitFired||(n=n||function(){},i=i||function(){},p.socialLoginReceiveToken(e.token,a,t,o,null,n,i))})},e.resendEmailVerification=function(e,t,o){c.getAppConfiguration(function(){p.resendEmailVerificationController(c.util.jsonToQueryString(e),t,o)})},e.twoFAResendOTP=function(e,t,o){c.getAppConfiguration(function(){p.resendOTP2FAController(c.util.jsonToQueryString(e),t,o)})},e.twoFAVerifyOTP=function(e,t,o){c.getAppConfiguration(function(){p.verify2FAOTPController(c.util.jsonToQueryString(e),t,o)})},e.twoFAUpdatePhone=function(e,t,o,n,i,a,r){n=n||function(){},i=i||function(){},a=a||function(){},r=r||function(){},c.getAppConfiguration(function(){p.update2FAPhoneNumberController(e,null,t,o,null,n,i,a,r)})},e.updatePhone=function(e,t,o,n,i,a,r){a=a||function(){},r=r||function(){},n=n||function(){},i=i||function(){},c.getAppConfiguration(function(){p.updatePhoneNumberController(c.util.jsonToQueryString(e),null,t,o,null,a,r,n,i)})},e.verifyOTP=function(e,t,o,n){c.getAppConfiguration(function(){p.verifyOTPController(e,t,o,n)})},e.resendOTP=function(e,t,o){c.getAppConfiguration(function(){p.resendOTPController(c.util.jsonToQueryString(e),t,o)})},e.addEmail=function(e,t,o){c.getAppConfiguration(function(){p.addEmailController(c.util.jsonToQueryString(e),t,o)})},e.removeEmail=function(e,t,o){c.getAppConfiguration(function(){p.removeEmailController(c.util.jsonToQueryString(e),t,o)})},e.changeUsername=function(e,t,o){c.getAppConfiguration(function(){p.changeUsernameController(c.util.jsonToQueryString(e),t,o)})},e.changePassword=function(e,t,o){c.getAppConfiguration(function(){p.changePasswordController(c.util.jsonToQueryString(e),t,o)})},e.changePIN=function(e,t,o){c.getAppConfiguration(function(){p.changePINController(c.util.jsonToQueryString(e),t,o)})},e.checkPhoneNumberAvailability=function(e,t,o){c.getAppConfiguration(function(){p.checkPhoneNumberAvailabilityController(c.util.jsonToQueryString(e),t,o)})},e.resetPasswordByPhone=function(e,t,o){c.getAppConfiguration(function(){p.resetPasswordByPhoneController(c.util.jsonToQueryString(e),t,o)})},e.resetPINByPhone=function(e,t,o){c.getAppConfiguration(function(){p.resetPINByPhoneController(c.util.jsonToQueryString(e),t,o)})},e.forgotPasswordbyPhone=function(e,t,o){c.getAppConfiguration(function(){p.forgotPasswordbyPhoneController(c.util.jsonToQueryString(e),null,t,o)})},e.forgotPINbyPhone=function(e,t,o){c.getAppConfiguration(function(){p.forgotPINbyPhoneController(c.util.jsonToQueryString(e),null,t,o)})},e.updateData=function(e,t,o,n,i,a){var r=n,s=i,l={};"object"==typeof n&&(l=n,r=i,s=a);var u={};u.Profile=l,u.access_token=o,c.getAppConfiguration(function(){p.updateData(u,null,t,r,s,"",e)})},e.checkEmailAvailability=function(e,t,o){c.getAppConfiguration(function(){p.checkEmailAvailabilityController(c.util.jsonToQueryString(e),t,o)})},e.checkUserNameAvailability=function(e,t,o){c.getAppConfiguration(function(){p.checkUserNameAvailabilityController(c.util.jsonToQueryString(e),t,o)})},e.resetPasswordBySecurityQuestion=function(e,t,o){c.getAppConfiguration(function(){p.resetPasswordBySecurityQuestionController(c.util.jsonToQueryString(e),t,o)})},e.resetPINBySecurityQuestion=function(e,t,o){c.getAppConfiguration(function(){p.resetPINBySecurityQuestionController(c.util.jsonToQueryString(e),t,o)})},e.updateSecurityQuestion=function(e,t,o){c.getAppConfiguration(function(){p.updateSecurityQuestionController(c.util.jsonToQueryString(e),t,o)})},e.resetTwoFactor=function(e,t,o){c.getAppConfiguration(function(){p.resetTwoFactorAuthenticationController(e,t,o)})},e.invalidateToken=function(e,t,o){c.getAppConfiguration(function(){p.invalidateToken(e,t,o)})},e.validateToken=function(e,t,o){c.getAppConfiguration(function(){p.validateToken(e,t,o)})},e.getSocialData=function(e,t,o,n,i){c.getAppConfiguration(function(){p.getSocialDataController(e,t,o,n,i)})},e.postSocialData=function(e,t,o,n,i,a){c.getAppConfiguration(function(){p.postSocialDataController(e,t,o,n,i,a)})},e.getCustomObjects=function(e,t,o){c.getAppConfiguration(function(){p.getCustomObjectsController(e,t,o)})},e.createCustomObject=function(e,t,o,n){c.getAppConfiguration(function(){p.createCustomObjectController(e,t,o,n)})},e.getCustomObjectById=function(e,t,o,n){c.getAppConfiguration(function(){p.getCustomObjectByIdController(e,t,o,n)})},e.deleteCustomObjectById=function(e,t,o,n){c.getAppConfiguration(function(){p.deleteCustomObjectController(e,t,o,n)})},e.updateCustomObjectById=function(e,t,o,n,i,a){c.getAppConfiguration(function(){p.updateCustomObjectController(e,t,o,a,n,i)})},e.getBackupCode=function(e,t,o){c.getAppConfiguration(function(){p.getBackupCodeController(e,t,o)})},e.resetBackupCode=function(e,t,o){c.getAppConfiguration(function(){p.resetBackupCodeController(e,t,o)})},e.autoLogin=e.smartLogin=function(e,t,o){c.getAppConfiguration(function(){p.smartLoginController(c.util.jsonToQueryString(e),t,o)})},e.verifyConsent=function(e,t,o){c.getAppConfiguration(function(){p.verifyConsentController(e,t,o)})},e.fetchConsentLogs=function(e,t){c.getAppConfiguration(function(){p.consentLogsController(e,t)})},e.updateConsents=function(e,t,o){c.getAppConfiguration(function(){p.updateConsentController(e,t,o)})},e.submitConsentbyConsentToken=function(e,t,o){var n=e.consentToken||"";n?c.getAppConfiguration(function(){p.submitConsentController(n,e,t,o)}):(o({response:"consentToken is required parameter"}),c.log("consentToken is required parameter"))},e.submitConsentbyAccesToken=function(e,t,o){c.getAppConfiguration(function(){p.customEventConsentController(e,t,o)})}}function setLoginRadiusDefaultSchema(e){e.loginFormSchema=[{type:"string",name:"emailid",display:"Email Id",rules:"required|valid_email",permission:"r"},{type:"password",name:"password",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"}],e.backupCodeFormSchema=[{type:"string",name:"backupcode",display:"Backup Code",rules:"required",permission:"r"}],e.resetPasswordByPhoneSchema=[{type:"string",name:"otp",display:"Verification Code",rules:"required",permission:"r"},{type:"password",name:"password",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"}],e.resetPINByPhoneSchema=[{type:"string",name:"otp",display:"Verification Code",rules:"required",permission:"r"},{type:"password",name:"pin",display:"PIN",rules:"required|min_length[4]|max_length[32]",permission:"w"}],e.checkPhoneNumberSchema=[{type:"string",name:"phone",display:"Phone Number",rules:"required|valid_phoneno",permission:"r"}],e.QRCodeSchema=[{type:"string",name:"googleAuthenticatorCode",display:"Google Authenticator Code",rules:"required",permission:"r"}],e.getSecQSchema=[{type:"string",name:"emailid",display:"Email Id",rules:"required|valid_email",permission:"r"}],e.otpSchema=[{type:"string",name:"otp",display:"Verification Code",rules:"required",permission:"r"}],e.forgotPasswordFormSchema=[{type:"string",name:"emailid",display:"Email",rules:"required",permission:"r"}],e.forgotPINFormSchema=[{type:"string",name:"emailid",display:"Email",rules:"required",permission:"r"}],e.smartLoginSchema=[{type:"string",name:"emailid",display:"Email Id",rules:"required",permission:"r"}],e.passwordLessLoginSchema=[{type:"string",name:"emailid",display:"Email",rules:"required",permission:"r"},{type:"string",name:"name",display:"Name",rules:"",permission:"r"}],e.changePasswordFormSchema=[{type:"password",name:"oldpassword",display:"Old Password",rules:"required",permission:"w"},{type:"password",name:"newpassword",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"},{type:"password",name:"confirmnewpassword",display:"Confirm Password",rules:"required|min_length[6]|max_length[32]|matches[newpassword]",permission:"w"}],e.emailSchema=e.forgotPasswordFormSchema,e.addEmailSchema=[{type:"string",name:"emailid",display:"Email",rules:"required|valid_email",permission:"r"},{type:"string",name:"type",display:"Type",rules:"required",permission:"r"}],e.changeUsernameFormSchema=[{type:"string",name:"username",display:"Username",rules:"required",permission:"r"}],e.changePINFormSchema=[{type:"password",name:"oldpin",display:"Old PIN",rules:"required",permission:"w"},{type:"password",name:"newpin",display:"PIN",rules:"required",permission:"w"},{type:"password",name:"confirmnewpin",display:"Confirm PIN",rules:"required|matches[newpin]",permission:"w"}],e.resetPasswordFormSchema=[{type:"password",name:"password",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"},{type:"password",name:"confirmpassword",display:"Confirm Password",rules:"required|matches[password]|min_length[6]|max_length[32]",permission:"w"},{type:"hidden",name:"resettoken",display:"",rules:"required",permission:"w",value:""}],e.resetPINFormSchema=[{type:"password",name:"pin",display:"PIN",rules:"required|min_length[4]|max_length[32]",permission:"w"},{type:"password",name:"confirmpin",display:"Confirm PIN",rules:"required|matches[pin]|min_length[4]|max_length[32]",permission:"w"},{type:"hidden",name:"resettoken",display:"",rules:"required",permission:"w",value:""}],e.pinLoginFormSchema=[{type:"password",name:"pin",display:"PIN",rules:"required",permission:"r"}],e.privacyPolicySchema=[{type:"multi",name:"acceptprivacypolicy",display:"I agree to the terms of service",rules:"",permission:"r"}],e.btnOTPSchema={type:"button",name:"click",display:"click",rules:"",permission:"r",event:"click",eventCallback:function(){}},e.defaultBtnSchema={type:"button",name:"default",display:"default",rules:"",permission:"r",event:"click",eventCallback:function(){}}}function setLoginRadiusModuleFunctions(l,s){var u=LoginRadiusDefaults.options,c=new SetLoginRadiusCommonFunctions(l),e=new LoginRadiusControllers(l,c),p=l.util;l.version="3.17.0",l.LRCheckRegistration=!1,l.passwordlessLoginFlag=!1,l.socialLoginFlag=!1,l.LRCheckLogin=!1,l.LRCheck2FA=!1,l.loginAction=!1,l.options="",l.consentOptions="",l.sessionData={getUid:function(){return l.storage.getBrowserStorage(LoginRadiusDefaults.storedUidName)},getToken:function(){return l.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName)}},l.errorMessages=[],l.validationMessages=[],l.formCustomLabel={},l.formElementsTitle={},l.defaultOptionField={},l.formValidations={},l.formPlaceholder={},l.formElementAttributes={},l.buttonElements={},l.passwordMeterConfiguration=[],l.buttonsName={},l.eventsName={},l.log=function(e){l.options.debugMode&&"undefined"!=typeof console&&console.error(e)},l.customInterface=function(e,t){var o=t.templateName||"";n(function(){c.renderCustomInterface(e,"",o)})},l.clearSession=function(){l.storage.removeBrowserStorage(LoginRadiusDefaults.storedTokenName),l.storage.removeBrowserStorage(LoginRadiusDefaults.storedUidName),l.storage.removeBrowserStorage(LoginRadiusDefaults.storedTwoFAToken)},l.setSessionToken=function(e){e={session_token:e.session_token,session_expires_in:e.session_expires_in};l.storage.setBrowserStorage(LoginRadiusDefaults.storedSessionTokenData,JSON.stringify(e))},l.getSessionToken=function(){var e=JSON.parse(l.storage.getBrowserStorage(LoginRadiusDefaults.storedSessionTokenData));return e&&e.session_expires_in&&new Date<new Date(e.session_expires_in)?e.session_token:(l.removeSessionToken(),!1)},l.removeSessionToken=function(){l.storage.removeBrowserStorage(LoginRadiusDefaults.storedSessionTokenData)},l.documentCookies=Object.assign({},LRNameSpace.cookies);var d=[];function n(e){l.isApiCallingStarted||""!==l.options?l.isApiCallingStarted&&(""!==l.options?e():"logout"===l.useraction?(l.isApiCallingStarted=!1,n(e)):d.push(e)):(l.isApiCallingStarted=!0,d.push(e),p.ajaxCall("get",LoginRadiusDefaults.configApiDomain+"appInfo?apikey="+s.apiKey,"",function(e){var t,o,n,i=e,a={};s.securityQuestionEnabled=i.IsSecurityQuestion,s.appName=s.appName||i.AppName,s.RegistrationFormSchema=i.RegistrationFormSchema,s.loginLockedType=i.LoginLockedConfiguration&&i.LoginLockedConfiguration.LoginLockedType,s.securityQuestionEnabled&&(s.SecurityQuestions=i.SecurityQuestions.Questions,s.securityQuestionsCount=void 0===s.securityQuestionsCount?i.SecurityQuestions.SecurityQuestionCount:s.securityQuestionsCount),void 0===s.passwordLength&&s.displayPasswordStrength&&s.RegistrationFormSchema&&(t=p.findInSchema(s.RegistrationFormSchema,"name","password").rules.split("|"),o=(n=p.isSubstring("min_length[",Object.keys(t).map(function(e){return t[e]})))?t[n].substring(t[n].lastIndexOf("min_length[")+11,t[n].lastIndexOf("]")):"",n=(e=p.isSubstring("max_length[",Object.keys(t).map(function(e){return t[e]})))?t[e].substring(t[e].lastIndexOf("max_length[")+11,t[e].lastIndexOf("]")):"",e={},o&&(e.min=parseInt(o)),n&&(e.max=parseInt(n)),s.passwordLength=e),s.SocialSchema=i.SocialSchema,s.maskSensitiveInput=s.encryptedAnswer||s.maskSensitiveInput,s.noCallbackForSocialLogin=void 0!==s.noCallback?s.noCallback:s.noCallbackForSocialLogin,s.v2RecaptchaSiteKey=s.v2RecaptchaSiteKey||i.V2RecaptchaSiteKey,i.TwoFactorAuthentication.IsEnabled&&(a.optionalTwoFactorAuthentication=!0,a.twoFactorAuthentication=!1,a.googleAuthentication=i.TwoFactorAuthentication.IsGoogleAuthenticator,a.emailOTPAuthentication=i.TwoFactorAuthentication.IsEmailOTPAuthenticator,a.securityQuestionAuthentication=i.TwoFactorAuthentication.IsSecurityQuestionAuthenticator,i.TwoFactorAuthentication.IsRequired&&(a.optionalTwoFactorAuthentication=!1,a.twoFactorAuthentication=!0)),s.otpEmailVerification=void 0===s.otpEmailVerification?i.OTPEmailVerification:s.otpEmailVerification,s.optionalTwoFactorAuthentication=(void 0===s.optionalTwoFactorAuthentication?a:s).optionalTwoFactorAuthentication,s.twoFactorAuthentication=(void 0===s.twoFactorAuthentication?a:s).twoFactorAuthentication,s.googleAuthentication=(void 0===s.googleAuthentication?a:s).googleAuthentication,s.phoneLogin=void 0===s.phoneLogin?i.IsPhoneLogin:s.phoneLogin,s.passwordlessLoginOTP=void 0===s.instantOTPLogin&&void 0===s.passwordlessLoginOTP?i.IsInstantSignin.SmsOtp:s.instantOTPLogin||s.passwordlessLoginOTP,"optional"===i.EmailVerificationFlow?a.optionalEmailVerification=!0:"disabled"===i.EmailVerificationFlow&&(a.disabledEmailVerification=!0),s.optionalEmailVerification=(void 0===s.optionalEmailVerification?a:s).optionalEmailVerification,s.disabledEmailVerification=(void 0===s.disabledEmailVerification?a:s).disabledEmailVerification,s.loginOnEmailVerification=void 0===s.loginOnEmailVerification?i.IsLoginOnEmailVerification:s.loginOnEmailVerification,s.passwordlessLogin=void 0===s.instantLinkLogin&&void 0===s.passwordlessLogin?i.IsInstantSignin.EmailLink:s.instantLinkLogin||s.passwordlessLogin,s.askRequiredFieldForTraditionalLogin=void 0===s.askRequiredFieldForTraditionalLogin?i.AskRequiredFieldsOnTraditionalLogin:s.askRequiredFieldForTraditionalLogin,s.stayLogin=void 0===s.stayLogin?i.IsRememberMe:s.stayLogin,s.disableSignup=void 0===s.disableSignup?i.IsDisabledRegistration:s.disableSignup,s.riskBasedAuthentication=void 0===s.riskBasedAuthentication?i.IsRiskBasedAuthentication:s.riskBasedAuthentication,s.noCallbackForSocialLogin=void 0===s.noCallbackForSocialLogin?i.IsNoCallbackForSocialLogin:s.noCallbackForSocialLogin,s.usernameLogin=void 0===s.usernameLogin?i.IsUserNameLogin:s.usernameLogin,s.promptPasswordOnSocialLogin=void 0===s.promptPasswordOnSocialLogin?i.AskPasswordOnSocialLogin:s.promptPasswordOnSocialLogin,s.v2Recaptcha=void 0===s.v2Recaptcha?i.IsV2Recaptcha:s.v2Recaptcha,s.invisibleRecaptcha=void 0===s.invisibleRecaptcha?i.IsInvisibleRecaptcha:s.invisibleRecaptcha,s.askOptionalFieldsOnRegistration=void 0===s.askOptionalFieldsOnRegistration?i.AskOptionalFieldsOnSocialSignup:s.askOptionalFieldsOnRegistration,s.askEmailForUnverifiedProfileAlways=void 0===s.askEmailForUnverifiedProfileAlways?i.AskEmailIdForUnverifiedUserLogin:s.askEmailForUnverifiedProfileAlways,s.logoutOnVerifyEmail=void 0===s.logoutOnVerifyEmail?i.IsLogoutOnEmailVerification:s.logoutOnVerifyEmail,s.disableAccountLinking=i.IsDisabledAccountLinking,s.duplicateEmailWithUniqueUsername=i.DuplicateEmailWithUniqueUsername,s.customDomain=s.customDomain||i.CustomDomain,s.optionalRecaptchaConfiguration=i.OptionalRecaptchaConfiguration,s.tencentCaptchaAppid=void 0===s.tencentCaptchaAppid?i.QQTencentCaptchaKey:s.tencentCaptchaAppid,s.privacyPolicyConfiguration=i.PrivacyPolicyConfiguration,s.isConsentManagementEnabled=(void 0===s.IsConsentManagementEnabled?i:s).IsConsentManagementEnabled,a.isPINAuthentication=!1,i.PINAuthentication&&i.PINAuthentication.IsEnabled&&(a.isPINAuthentication=!0,a.PINConfiguration=Object.assign({},i.PINAuthentication.Configuration),s.PINConfiguration?s.PINConfiguration=Object.assign({},a.PINConfiguration,s.PINConfiguration):s.PINConfiguration=Object.assign({},a.PINConfiguration)),s.isPINAuthentication=a.isPINAuthentication,s.isPINAuthentication&&(l.pinSchema=[],i=p.findInSchema(s.RegistrationFormSchema,"name","pin"),p.isEmpty(i)?l.log("Pin schema is not defined"):(l.pinSchema.push(i),!s.PINConfiguration.IsRequired||l.pinSchema[0].rules&&-1!==l.pinSchema[0].rules.indexOf("required")||(l.pinSchema[0].rules=l.pinSchema[0].rules?[l.pinSchema[0].rules,"required"].join("|"):"required"),i=p.findInSchema(s.RegistrationFormSchema,"name","confirmpin"),p.isEmpty(i)||l.pinSchema.push(i))),s.isConsentManagementEnabled&&c.setConsentTemplate(),s.emailOTPAuthentication=a.emailOTPAuthentication,s.securityQuestionAuthentication=a.securityQuestionAuthentication,s=p.mergeOptions(u,s),l.options=s;for(var r=0;r<d.length;r++)d[r]()},"registrationSchema"))}var m=[];l.getConsentConfiguration=function(e){l.isConsentApiCallingStarted||""!==l.consentOptions?l.isConsentApiCallingStarted&&(""!==l.consentOptions?e(l.consentOptions):m.push(e)):(l.isConsentApiCallingStarted=!0,m.push(e),p.ajaxCall("get",LoginRadiusDefaults.configApiDomain+"consent?apiKey="+l.options.apiKey,"",function(e){if(e){l.consentOptions={},l.consentsList={};for(var t="",o=0;o<e.length;o++){for(var n=0;n<e[o].Events.length;n++)t=e[o].Events[n].Name,"true"===e[o].Events[n].IsCustom&&(t="custom_"+t),l.consentOptions[t]={},l.consentOptions[t].ConsentForm=e[o].ConsentForm,l.consentOptions[t].TermOfService=e[o].TermOfService,l.consentOptions[t].PrivacyPolicy=e[o].PrivacyPolicy;for(var i=0;i<e[o].ConsentForm.length;i++)for(var a=e[o].ConsentForm[i],r=0;r<a.Consents.length;r++)l.consentsList[a.Consents[r].ConsentId]||(l.consentsList[a.Consents[r].ConsentId]=a.Consents[r])}for(var s=0;s<m.length;s++)m[s](l.consentOptions)}else l.isConsentApiCallingStarted=!1}))},l.getAppConfiguration=n,l.progressiveProfiling=new LRNameSpace.ProgressiveProfiling(l,c,e,LoginRadiusDefaults),l.progressiveProfiling.init=function(){n(function(){l.progressiveProfiling.fetchSchema(function(e){l.progressiveProfilingSchema=e,l.$hooks.register("registrationSchemaFilter",function(e,t){l.options.progressiveProfilingTraditional&&(l.LoggedinSocialProvderProfile=t)})},"progressiveProfilingSchema")})}}function LoginRadiusHooksModel(T){var g=T.util,o=LoginRadiusDefaults.messages;T.$hooks={hooks:[],register:function(e,t,o){void 0===T.$hooks.hooks[e]&&(T.$hooks.hooks[e]=[]),parseInt(o,10)===o&&T.$hooks.hooks[e].length>o+1?T.$hooks.hooks[e].splice(o,0,t):T.$hooks.hooks[e].push(t)},call:function(e){var t=Array.prototype.splice.call(arguments,1);if(void 0!==T.$hooks.hooks[e])for(var o=0,n=T.$hooks.hooks[e].length;o<n;++o)T.$hooks.hooks[e]&&T.$hooks.hooks[e][o]&&T.$hooks.hooks[e][o].apply(null,t)}},T.$hooks.register("addEventOnElement",function(e){g.extend(T.eventsName,e)}),T.$hooks.register("mapErrorMessages",function(e){if(e.code&&e.message)T.errorMessages.push(e);else if(g.isArray(e))for(var t=0;t<e.length;t++)e[t].code&&e[t].message?T.errorMessages.push(e[t]):T.log(o.notValidMessage);else T.log(o.notValidMessage)}),T.$hooks.register("passwordMeterConfiguration",function(e){g.isArray(e)?g.extend(T.passwordMeterConfiguration,e):T.log(o.passwordStrengthMessage)}),T.$hooks.register("setButtonsName",function(e){for(var t,o=Object.keys(e),n=o.length,i={};n--;)i[(t=o[n]).toLowerCase()]=e[t];g.extend(T.buttonsName,i)}),T.$hooks.register("mapValidationMessages",function(e){if(e.rule&&e.message)T.validationMessages.push(e);else if(g.isArray(e))for(var t=0;t<e.length;t++)e[t].rule&&e[t].message?T.validationMessages.push(e[t]):T.log(o.notValidMessage);else T.log(o.notValidMessage)}),T.$hooks.register("customizeFormLabel",function(e){g.extend(T.formCustomLabel,e)}),T.$hooks.register("customizeElementTitle",function(e){g.extend(T.formElementsTitle,e)}),T.$hooks.register("defaultChoiceOption",function(e){g.extend(T.defaultOptionField,e)}),T.$hooks.register("customizeFormPlaceholder",function(e){g.extend(T.formPlaceholder,e)}),T.$hooks.register("formValidationRules",function(e){g.extend(T.formValidations,e)}),T.$hooks.register("formAttributes",function(e){g.extend(T.formElementAttributes,e)}),T.$hooks.register("buttonAttributes",function(e){g.extend(T.buttonElements,e)}),T.$hooks.register("addFormCaptcha",function(i,a,r){T.getAppConfiguration(function(){r&&(T.options[r]=!0);var e=i+"recaptcha_widget";g.addRecaptchaJS();var t=[];g.captchaSchema(e,t,!1,a);var o,n=document.createElement("div");n.setAttribute("name",t[0].name),T.options.invisibleRecaptcha&&(o=a.toString(),o=/function ([^\(]*)/.exec(o)[1],t[0].html=t[0].html.replace("onCaptchaSubmit",o)),n.innerHTML=t[0].html,g.addHTMLContent(i,n,!0),g.renderV2Recaptcha(e,!1,a)})}),T.$hooks.register("addFormCaptchaExecute",function(e){var t,o=e+"recaptcha_widget",e=g.elementById(o+"_tencent");T.options.invisibleRecaptcha?t=setInterval(function(){if("undefined"!=typeof grecaptcha){try{grecaptcha.execute(window[o])}catch(e){}clearInterval(t)}},1e3):e&&"none"!==e.style.display&&(T.options.tencentCaptcha||T.options.tencentCaptchaAsFallback&&!window.grecaptcha)&&e.click()}),T.$hooks.register("successCallback",function(t,o,e){var a,r,n,i,s,l,u,c,p,d,m="";t&&(T.$hooks.register("setCurrentAction",function(){T.storage.setBrowserStorage("LRSetSafariToken",t)}),m="verifyotp"===t.toLowerCase()?"otp":t.toLowerCase()),"1132"==o.ErrorCode?!T.LRCheckLogin&&T.LRCheck2FA||(T.options.v2Recaptcha||T.options.invisibleRecaptcha||T.options.tencentCaptcha||T.options.tencentCaptchaAsFallback||(T.options.v2Recaptcha=!0),"verifyemail"===m&&(g.elementById("loginradius-submit-verify").style.display="block"),i=T.LRPrefix.replace("##","")+"recaptcha_widget_"+m,(i=T.util.elementById(n=i,!0))&&(i.style.display="block"),window.grecaptcha&&i&&""!==i.innerHTML?grecaptcha.reset(window[n+"lr_recaptcha_widgets_idprefix"]):T.util.renderV2Recaptcha(n,!1)):"1148"==o.ErrorCode||"1165"==o.ErrorCode?(n=g.parseString(e))&&!n.hasOwnProperty("securityanswer")&&(a=m,T.options.securityQuestionEnabled&&(r=g.jsonToQueryString(JSON.parse(e)),new LoginRadiusControllers(T).getSecurityQuestionsController(r,function(i){if(0<i.length)for(var e=0;e<i.length;e++)-1!==r.indexOf(i[e].name)&&i.splice(e,1);var t,o,n;0<i.length&&(t=document.createElement("div"),o=[],n=T.LRPrefix.split("##"),new SetLoginRadiusCommonFunctions(T).createFormFields(i,t,a,o,n[0],n[1]),new FormValidator(n[1]+a,o,function(e){T.mergeFormErrors={},T.mergeFormErrors=e}),T.$hooks.register("startProcess",function(e,t){for(var o={},n=0;n<i.length;n++)t&&t[i[n].name]&&(o[i[n].name]=t[i[n].name],delete t[i[n].name]);t&&(t.securityanswer=o)}),T.util.addHTMLContent("",t,!0,a,n[0]))}))):"1194"==o.ErrorCode?function(t,e){var o="",n=T.privacyPolicySchema.slice();n[0].rules="Strict"===T.options.privacyPolicyConfiguration.Mode?"required":"";var i=new SetLoginRadiusCommonFunctions(T),a=new LoginRadiusControllers(T,i);T.$hooks.call("getCurrentActionOptions",e);var r=function(){},s=function(){},l="";T.currentActionOptions[e]&&(r=T.currentActionOptions[e].onSuccess||r,s=T.currentActionOptions[e].onError||s,l=T.currentActionOptions[e].classPrefix||l),"socialLogin"===e?(o=T.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),T.$hooks.call("socialLoginFormRender")):o=t.Data.access_token,i.createForm(n,"privacyPolicyUpdate",T.currentLRContainer,function(e){a.updatePrivacyPolicy(o,t,r,s,null,T.currentLRContainer,l)},function(e){s(i.setMappedMessage(e))})}(o,t):"1243"==o.ErrorCode?(e=t,T.pinSchema&&T.pinSchema.length?(s=o.Data.PINAuthToken,(l=new SetLoginRadiusCommonFunctions(T)).setPINRule(g.findInSchema(T.pinSchema,"name","confirmpin")),u=new LoginRadiusControllers(T,l),T.$hooks.call("getCurrentActionOptions",e),c=function(){},p=function(){},d="",T.currentActionOptions[e]&&(c=T.currentActionOptions[e].onSuccess||c,p=T.currentActionOptions[e].onError||p,d=T.currentActionOptions[e].classPrefix||d),l.createForm(T.pinSchema,"pinSetup",T.currentLRContainer,function(e){u.configurePINController(s,e,c,p,T.currentLRContainer,d)},function(e){p(l.setMappedMessage(e))})):T.log("Pin Schema is not defined in the schema")):1226===o.ErrorCode&&o.Data&&o.Data.ConsentToken&&!T.lrApiFramework&&T.getConsentConfiguration(function(e){!function(e,l,t){var o,u=e.Data.ConsentToken;e.Data.ConsentProfile&&e.Data.ConsentProfile.Consents&&e.Data.ConsentProfile.Consents.Options&&(o=e.Data.ConsentProfile.Consents.Options);for(var c=new SetLoginRadiusCommonFunctions(T),p=new LoginRadiusControllers(T,c),d="",m=[],g=[],n=0;n<e.Data.Events.length;n++)m.push(e.Data.Events[n].Name);T.$hooks.call("getCurrentActionOptions",l);var f=function(){},h=function(){},y="",v="";T.currentActionOptions[l]&&(f=T.currentActionOptions[l].onSuccess||f,h=T.currentActionOptions[l].onError||h,y=T.currentActionOptions[l].classPrefix||y,v=T.currentActionOptions[l].container||"");var v=v||T.currentLRContainer,C=function(r,s){var e=[],t=c.createConsentInterface(r[s],o);""!==t&&(e.push({html:t,type:"html",name:"consent"}),c.createForm(e,"consentlogin",v,function(e){var t=c.consentValidation(e,s);if(0<t.length)h(c.setMappedMessage(t));else if(d=d?d+"&"+e:e,g.push({Event:s,IsCustom:!1}),m.splice(0,1),0<m.length)C(r,m[0]);else{var o,n=T.util.parseQueryString(d),i=[];for(o in n){var a=o.replace("consent_","");i.push({ConsentOptionId:a,IsAccepted:n[o]})}n={},0<i.length&&(n.Events=g,n.Data=i),p.submitConsentController(u,n,f,h,v,y,l)}},function(e){h(c.setMappedMessage(e))}))};"socialLogin"===l&&T.$hooks.call("socialLoginFormRender"),C(t,m[0])}(o,t,e)})}),T.$hooks.register("afterFormRender",function(e,t,o,n){var i=T.options.RegistrationFormSchema,a=[];if("registration"===e){for(var r,s,l={},u=0;u<i.length;u++)i[u]&&i[u].DataSource&&null!==i[u].DataSource&&(l[i[u].DataSource]=i[u],l[i[u].DataSource].children=[]);for(s in l)l.hasOwnProperty(s)&&((r=l[s]).ParentDataSource&&null!=r.ParentDataSource?l[r.ParentDataSource].children:a).push(r);0<a.length&&function(r,e,s){for(var l=[],u=new SetLoginRadiusCommonFunctions(T),t=0;t<e.length;t++)e[t].ParentDataSource||g.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/"+e[t].DataSource+"?apiKey="+T.options.apiKey,"",function(e,t){if(l[e.DataSource]=t,l[e.DataSource])for(var o=0;o<l[e.DataSource].length;o++){var n=document.createElement("option");n.setAttribute("value",l[e.DataSource][o].Id),n.appendChild(document.createTextNode(l[e.DataSource][o].Key));var i=document.getElementById(s+"registration-"+e.name);i&&i.appendChild(n)}if(e&&e.children&&0<e.children.length)for(var a=0;a<e.children.length;a++)u.addChangeEventHandler(r,e,e.children[a],s)},"registration",e[t])}(t,a,o)}"validatecode"===e&&function(i,e,a){for(var t=0;t<e.length;t++)e[t].DataSource&&T.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/"+e[t].DataSource+"?apiKey="+T.options.apiKey,"",function(e,t){for(var o=0;o<t.length;o++){var n=document.createElement("option");n.setAttribute("value",t[o].Id),n.appendChild(document.createTextNode(t[o].Key)),document.getElementById(a+i+"-"+e.name).appendChild(n)}},"registration",e[t])}(e,i,o)}),T.$hooks.register("setLocaleBasedInfo",function(e){for(var t in e)if(e.hasOwnProperty(t))switch(t){case"labels":g.extend(T.formCustomLabel,e[t]);break;case"placeholders":g.extend(T.formPlaceholder,e[t]);break;case"validationMessages":T.$hooks.call("mapValidationMessages",e[t]);break;case"errorMessages":T.$hooks.call("mapErrorMessages",e[t]);break;case"passwordMeterConfiguration":T.$hooks.call("passwordMeterConfiguration",e[t]);break;case"buttonsName":T.$hooks.call("setButtonsName",e[t])}})}function SetLoginRadiusCommonFunctions(A){var D=this,y=LoginRadiusDefaults.messages,C=LoginRadiusDefaults.buttonNames,O=new LoginRadiusControllers(A,D);function T(o,n,e,t){var i=A.util.elementById(e+"_tencent"),a=!1;"profileeditor"===t&&(a=!0);t=A.util.elementById(e);window.grecaptcha&&A.options.invisibleRecaptcha&&t&&""!==t.innerHTML&&"none"!==t.style.display?grecaptcha.execute(window[e+"lr_recaptcha_widgets_idprefix"]):i&&"none"!==i.style.display&&(A.options.tencentCaptcha||A.options.tencentCaptchaAsFallback&&!window.grecaptcha)?window.onTencentCaptchaSubmitCallback=function(e){var t=A.util.serialize(o,a);t+="&qq_captcha_ticket="+e.ticket,t+="&qq_captcha_randstr="+e.randstr,n(t)}:n(A.util.serialize(o,a))}function w(e,t,o,n,i){var a="linksignin";"passwordlessLoginOTPButtonLabel"===e&&(a="otpsignin");var r=document.createElement("input");r.type="submit";var s=A.buttonsName[e.toLowerCase()]||C[e.toLowerCase()],l=C[e.toLowerCase()];r.value=s,r.id=n+a+"-"+l.toLowerCase().replace(/ /g,"-"),r.setAttribute("class",i+a+" "+a+"-"+n+l.toLowerCase().replace(/ /g,"-")),A.options.disableButtonOnsubmit&&(A.$hooks.register("startProcess",function(e){("otpsignin"===a&&window.lrpasswordlessloginotp||"linksignin"===a&&window.lrpasswordlesslogin)&&(r.disabled=!0)}),A.$hooks.register("xhrEndWithError",function(e){("otpsignin"===a&&window.lrpasswordlessloginotp||"linksignin"===a&&window.lrpasswordlesslogin)&&(r.disabled=!1)}),A.$hooks.register("xhrEndWithSuccess",function(e){("otpsignin"===a&&window.lrpasswordlessloginotp||"linksignin"===a&&window.lrpasswordlesslogin)&&A.options.enableSubmitOnSuccess&&(r.disabled=!1)})),t.appendChild(r),A.util.addEvent("click",o,function(e){window.lrpasswordlessloginotp=!1,window.lrpasswordlesslogin=!1}),"passwordlessLoginOTPButtonLabel"===e?A.util.addEvent("click",r,function(e){window.lrpasswordlessloginotp=!0,window.lrpasswordlesslogin=!1}):A.util.addEvent("click",r,function(e){window.lrpasswordlesslogin=!0,window.lrpasswordlessloginotp=!1})}D.renderCustomInterface=function(e,w,S,L,k,t){function o(e){var t,o=e;A.options.providerCountry&&!A.options.providersList&&(o=function(e,t){for(var o=[{Name:"Facebook",country:"global",except:"china"},{Name:"Google",country:"global",except:"china"},{Name:"Yahoo",country:"global",except:"china"},{Name:"Live",country:"global",except:"china"},{Name:"Twitter",country:"global",except:"china"},{Name:"Linkedin",country:"global",except:"china"},{Name:"Myspace",country:"US"},{Name:"Foursquare",country:"global",except:"china"},{Name:"Vkontakte",country:"Russia"},{Name:"Renren",country:"China"},{Name:"QQ",country:"China"},{Name:"Kaixin",country:"China"},{Name:"Github",country:"global",except:"china"},{Name:"Mailru",country:"Russia"},{Name:"Amazon",country:"US"},{Name:"Paypal",country:"global"},{Name:"Salesforce",country:"global"},{Name:"ODNOKLASSNIKI",country:"Russia"},{Name:"WORDPRESS",country:"global"},{Name:"GOOGLEPLUS",country:"global",except:"china"},{Name:"Disqus",country:"global",except:"china"},{Name:"INSTAGRAM",country:"global",except:"china"},{Name:"SINAWEIBO",country:"China"},{Name:"XING",country:"Germany"},{Name:"PINTEREST",country:"global",except:"china"},{Name:"LINE",country:"global"},{Name:"AOL",country:"US"}],n=0;n<o.length;n++)for(var i=0;i<t.length;i++)if(t[i]&&t[i].Name.toLowerCase()===o[n].Name.toLowerCase()){if(o[n].country.toLowerCase()===e.toLowerCase()||"global"===o[n].country.toLowerCase()&&!o[n].except||o[n].except&&o[n].except.toLowerCase()!==e.toLowerCase())continue;t.splice(i,1)}return t}(A.options.providerCountry,o)),A.$hooks.call("socialInterfaceProviders",o),A.options.providersList&&(t=A.options.providersList);var n=A.options.hashTemplate?A.util.hashTmpl:A.util.tmpl,i=S.split(","),e=A.util.getQueryParameterByName("scope");""===A.options.scope&&e&&(A.options.scope=e);var a="&callback="+A.options.callbackUrl+"&same_window="+A.options.callbackInsideSameWindow+"&is_access_token="+A.options.accessTokenResponse+"&callbacktype="+A.options.callbackType+"&disablesignup="+A.options.disableSignup;-1===a.indexOf("scope")&&(a+="&scope="+A.options.scope),A.options.isMobile&&(a+="&ismobile=true"),k&&(a+="&ac_linking=true"),A.options.isCustomScope&&(a+="&is_custom_scope=true");for(var r=A.util.getThisObjectName(),s=0;s<i.length;s++){var l=A.util.elementById(i[s]);l&&-1!==l.innerHTML.indexOf("ac_linking")&&(a=a.replace("&ac_linking=true",""));var u=[];P[s]="";for(var c=0;c<o.length;c++){o[c].ObjectName=r,-1===o[c].Endpoint.indexOf("callback=")&&(o[c].Endpoint+=a);var p={islinked:!1,providerId:!1};w&&w[o[c].Name.toLowerCase()]&&(p.islinked=!0,p.providerId=w[o[c].Name.toLowerCase()]),o[c].isLinked=p.islinked,o[c].providerId=p.providerId;p=o[c];u.push(p)}for(var d=[],m=0;m<u.length;m++)u[m].isLinked&&d.push(u[m]);if(0<d.length){for(var g=0;g<u.length;g++)u[g].isLinked||d.push(u[g]);u=d}for(var f=0;f<u.length;f++)""!==i[s]&&(void 0!==t&&-1===t.indexOf(u[f].Name)&&-1===t.indexOf(u[f].Name.toLowerCase())||(P[s]+=n(i[s],u[f])))}for(var h=A.options.selector.split(","),y=0;y<h.length;y++)if(0===(v=h[y]).indexOf(".")){var v=v.replace(".",""),C=A.util.elementsByClass(v);if(C&&0<C.length)for(var T=0;T<C.length;T++)L?C[T].innerHTML+=P[y]:C[T].innerHTML=P[y]}else""===v||(v=A.util.elementById(v))&&(L?v.innerHTML+=P[y]:v.innerHTML=P[y])}A.options.selector=e;var P=[];t?o(t):void 0!==A.options.SocialSchema&&o(A.options.SocialSchema.Providers)},D.mapRegistrationSchema=function(e,t,o){var n,i,a,r=A.util.parseQueryString(t),s={},l={},u={},t=[],c=[];for(n in r)if(-1!==n.indexOf("cf_"))s[n.replace("cf_","")]=r[n],delete r[n];else if(-1!==n.indexOf("consent_")){var p={ConsentOptionId:n.replace("consent_",""),IsAccepted:r[n]};c.push(p),delete r[n]}else if("emailsubscription"===n)r.IsEmailSubscribed=!("on"!==r[n]&&"true"!==r[n]),delete r[n];else if("emailid"===n||"email"===n)l.value=r[n],l.type="Primary";else if("SecurityQuestionAnswer"!==n&&-1!==n.indexOf("securityQuestion")){for(var d={},m=0;m<A.options.securityQuestionsCount;m++)r["securityAnswer"+m]&&r["securityQuestion"+m]&&(d[r["securityQuestion"+m]]=r["securityAnswer"+m]),delete r["securityQuestion"+m],delete r["securityAnswer"+m];0!==Object.keys(d).length&&(r.SecurityQuestionAnswer=d)}else"country"===n?u=-1!==r[n].indexOf("|")?{code:r[n].split("|")[0],name:r[n].split("|")[1]}:{code:"",name:r[n]}:(i=A.util.findInSchema(e,"name",n))&&i.Parent&&(a=-1!==n.indexOf("_")?n.split("_")[1]:n,void 0===r[i.Parent]?(r[i.Parent]=[],(p={})[a]=r[n],"Addresses"===i.Parent?p.type="personal":"PhoneNumbers"!==i.Parent||p.phonetype||(p.phonetype="default"),r[i.Parent].push(p)):("Addresses"!==i.Parent||r[i.Parent][0].type||(r[i.Parent][0].type="personal"),r[i.Parent][0][a]=r[n]),delete r[n]);return 0!==Object.keys(s).length&&(r.CustomFields=s),0!==Object.keys(l).length&&(t.push(l),r.email=t),0!==Object.keys(u).length&&(r.country=u),A.options.isPINAuthentication&&A.options.PINConfiguration.AskOnRegistration&&(r=D.sanitizePinData(r)),0<c.length&&(r.Consents={Events:[{Event:"Register",IsCustom:!1}],Data:c}),r},D.showQRCode=function(e,t,o,n,i,a,r){var s,l,u=A.QRCodeSchema.slice();function c(e,t){var o;e&&u.splice(0,0,{type:"image",name:"qrcode",display:"QR Code",rules:"",permission:"r",value:e}),t&&(o=i||LoginRadiusDefaults.classPrefix,u.splice(1,0,{type:"button",name:"ManualEntryCode",display:"Get Manual Entry Code",rules:"",permission:"r",title:"Use this code when you unable to scan QR code. Tap 'Enter a provided key' then enter the email address of your Account and enter this key in your authenticator app",event:"click",eventCallback:function(e){document.getElementsByClassName("content-"+o+"ManualEntryCode")[0].innerHTML=t}}))}A.options.maskSensitiveInput?u[0].type="password":u[0].type="string",e.SecondFactorAuthentication?(s=e.SecondFactorAuthentication.QRCode,l=e.SecondFactorAuthentication.ManualEntryCode,e.SecondFactorAuthentication.IsGoogleAuthenticatorVerified||c(s,l)):(s=e.QRCode,l=e.ManualEntryCode,e.IsGoogleAuthenticatorVerified||c(s,l)),D.createForm(u,"showQRcode",t,function(e){O.verify2FAOTPController(e,o,n,a,r)},function(e){n(e)},i)},D.showMFASecurityQuestions=function(o,n,i,a,r,s,l){var e=!0,t="";A.$hooks.register("afterFormRender",function(e,t,o,n){var i;!A.LRCheckLogin&&n&&"loginradius-mfasecurityquestion"===n.name&&(i=A.util.findInSchema(n,"type","submit"),n=A.util.findInSchema(n,"name","setsecurityquestions"),i.style.display=n?"none":"block")}),o&&o.SecurityQuestions&&(t=o.SecurityQuestions,o.haveSecurityQuestionOnProfile=!0);var u=[];!A.LRCheckLogin&&o.haveSecurityQuestionOnProfile?u.push({type:"button",name:"enablesecurityquestions",display:"Enable Security Questions Authenticator",rules:"",permission:"r",event:"click",eventCallback:function(){O.verifyMFASecurityQuestionsByAccessTokenController("",i,a,!0)}}):u=D.getSecurityQuestionSchema([],!1,t),0<t.length&&o&&!o.IsSecurityQuestionAuthenticatorVerified&&u.push({type:"button",name:"setsecurityquestions",display:"Set Security Questions",rules:"",permission:"r",event:"click",eventCallback:function(e){var t=Object.assign({},o);delete t.SecurityQuestions,LoginRadiusDefaults.innerHTML=!1,e.target.style.display="none",t.haveSecurityQuestionOnProfile=!1,D.showMFASecurityQuestions(t,n,i,a,r,s,l)}}),(e=0<u.length?!1:e)?a([D.setMappedMessage(y.noSecurityQuestions)]):D.createForm(u,"mfasecurityquestion",n,function(e){A.LRCheckLogin?o&&o.IsSecurityQuestionAuthenticatorVerified||t&&0<t.length?O.verifyMFASecurityQuestionsController(e,i,a,s,l):O.submitMFASecurityQuestionsController(e,i,a,s,l):O.verifyMFASecurityQuestionsByAccessTokenController(e,i,a,o.haveSecurityQuestionOnProfile,t)},function(e){a(e)},r)},D.disableMFAOptions=function(e,o,t){var n,i=A.storage.getBrowserStorage(LoginRadiusDefaults.storedGAAuth),a=A.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth),r={googleauthenticator:{field:i,name:"googleauthenticator",defaultKey:"storedGAAuth"},emailotpauthenticator:{field:A.storage.getBrowserStorage(LoginRadiusDefaults.storedEmailOTPAuth),name:"Email authenticator",defaultKey:"storedEmailOTPAuth"},otpauthenticator:{field:a,name:"OTP authenticator",defaultKey:"storedOTPAuth"},sqauthenticator:{field:A.storage.getBrowserStorage(LoginRadiusDefaults.storedSQAuth),name:"Security Questions authenticator",defaultKey:"storedSQAuth"}},s=e.emailotpauthenticator,l=0;for(n in r)n===e?s=r[n]:"false"!==r[n].field&&l++;A.options.twoFactorAuthentication?"false"===s.field?t([{Message:s.name+"has already disabled."}]):0<l?O.resetTwoFactorAuthenticationController(e,function(e,t){A.storage.setBrowserStorage(LoginRadiusDefaults[s.defaultKey],!1),o(e,t)},t):0===l&&t([{Message:"TwoFactorAuthentication is required, So atleast one authenticator should be required."}]):O.resetTwoFactorAuthenticationController(e,o,t)};var r=!(D.getSecurityQuestionSchema=function(e,t,o){var n=[],i=A.options.SecurityQuestions,a=A.options.securityQuestionsCount;if(o&&(a=(i=o).length),i){function r(e){var t=new RegExp("securityQuestion"),o=e.target.id.split("securityQuestion")[1];l[o]=e.target.selectedIndex;for(var n=A.util.findElementByRegex("id",t,"select"),i=0;i<n.length;i++)for(var a=1;a<n[i].options.length;a++)-1<l.indexOf(n[i].options[a].index)&&n[i].options[a].index!==n[i].options.selectedIndex?n[i].options[a].style.display="none":n[i].options[a].style.display="block"}var s=[],l=[];if(!o)for(var u=0;u<i.length;u++){var c={};c.text=i[u].Question,c.value=i[u].QuestionId,s.push(c),l.push(0)}for(var p=0;p<a;p++){var d={};o?(d.type="html",d.name="securityQuestion"+p,d.html=i[p].Question):(d.type="option",d.options=s,d.name="securityQuestion"+p,d.display="Security Question",d.event="change",d.eventCallback=r),d.rules=t?"optional":"required",d.permission="r",(t?e:n).push(d);d={};A.options.maskSensitiveInput?d.type="password":d.type="string",d.name=o?i[p].QuestionId:"securityAnswer"+p,d.display="Answer",d.rules=t?"optional":"required",d.permission="r",(t?e:n).push(d)}}return n});function S(e,t){e=e.toLowerCase();return"changepassword"===e&&t.PutChangePassword||("profileeditor"===e||"loginRequiredFieldsUpdate"===e||"progressiveProfiling"===e||"socialRegistration"===e)&&t.PutUpdateProfile||"forgotpassword"===e&&(A.options.phoneLogin&&t.PostForgotPasswordByPhone&&t.PostForgotPasswordByEmail||!A.options.phoneLogin&&t.PostForgotPasswordByEmail)||"login"===e&&(A.options.usernameLogin&&t.PostLoginByUserNameAndPassword&&A.options.phoneLogin&&t.PostLoginByEmailAndPassword&&t.PostLoginByPhoneAndPassword||A.options.phoneLogin&&t.PostLoginByEmailAndPassword&&t.PostLoginByPhoneAndPassword||!A.options.phoneLogin&&A.options.usernameLogin&&t.PostLoginByUserNameAndPassword||!A.options.usernameLogin&&!A.options.phoneLogin&&t.PostLoginByEmailAndPassword)}D.socialLogin=function(o,n,i,a){window.html5passToken=function(e){var t;r||(r=!0,o=LoginRadiusDefaults.socialRegFormId||o,(t=A.storage.getBrowserStorage("LRSetSafariToken"))&&(A.$hooks.call("getCurrentActionOptions",t),n=window.LRSafarionSuccess||n,i=window.LRSafarionError||i),O.socialLoginReceiveToken(e,o,n,i,a))};var e=A.util.getHashParam("lr-token");e&&window.html5passToken(e),A.loginRadiusHtml5PassToken=window.html5passToken,A.options.isMobile||A.options.noCallbackForSocialLogin?A.$hooks.register("socialCalls",function(e,t){A.options.noCallbackForSocialLogin&&D.pingForSocialLogin(t,function(e){e.access_token?O.socialLoginReceiveToken(e.access_token,o,n,i,a):n(e)},function(){})}):A.util.addEvent("message",window,function(e){-1===e.origin.indexOf(A.options.customDomain)&&-1===e.origin.indexOf(LoginRadiusDefaults.hubDomain)||(o=LoginRadiusDefaults.socialRegFormId||o,"string"==typeof e.data&&LoginRadiusDefaults._uuidFormat.test(e.data)&&O.socialLoginReceiveToken(e.data,o,n,i,a))})},D.resetPassword=function(t,o,n,i,a){var e,r,s,l,u,c=A.resetPasswordFormSchema.slice();null==A.util.getHashParam("vtype")?(c=A.resetPasswordByPhoneSchema.slice(),D.setPasswordRule(A.util.findInSchema(c,"name","password")),a?(a.email?(e="email",s=a.email):a.username&&(e="username",s=a.username),c.push({type:"hidden",name:e,value:s})):A.options.phoneLogin&&(r="&"+LoginRadiusDefaults.LRPhoneNo,A.util.findInSchema(c,"name","resendotp")||(l=Object.assign({},A.btnOTPSchema,{name:"resendotp",display:"Resend Verification Code",eventCallback:function(e){A.options.disableResendOTPButton&&A.util.disableResendOTPButton(e),O.forgotPasswordbyPhoneController(LoginRadiusDefaults.LRPhoneNo,t,o,n,i,function(){})}}),c.push(l)))):(D.setPasswordRule(A.util.findInSchema(c,"name","password")),D.setPasswordRule(A.util.findInSchema(c,"name","confirmpassword")),(s=A.util.getHashParam("vtoken"))?A.options.verifyEmailByOTP?(l=A.util.getQueryParameterByName("email"),u="&otp="+s,u+="&email="+encodeURIComponent(l.replace(/ /g,"+")),c.splice(2,1)):A.resetPasswordFormSchema[2].value=s:n([{Message:"Verification Token not found in query string."}])),D.createForm(c,"resetpassword",t,function(e){-1===e.indexOf("otp")||a?(u&&(e+=u),O.resetPasswordController(e,o,n,t,i)):O.resetPasswordByPhoneController(e+r,o,n,t,i)},function(e){n(e)},i)},D.resetPIN=function(t,o,n,i,a){var e,r,s,l,u,c=A.resetPINFormSchema.slice();null==A.util.getHashParam("vtype")?(c=A.resetPINByPhoneSchema.slice(),D.setPINRule(A.util.findInSchema(c,"name","pin")),a?(a.email?(e="email",s=a.email):a.username&&(e="username",s=a.username),c.push({type:"hidden",name:e,value:s})):A.options.phoneLogin&&(r="&"+LoginRadiusDefaults.LRPhoneNo,A.util.findInSchema(c,"name","resendotp")||(l=Object.assign({},A.btnOTPSchema,{name:"resendotp",display:"Resend Verification Code",eventCallback:function(e){A.options.disableResendOTPButton&&A.util.disableResendOTPButton(e),O.forgotPINbyPhoneController(LoginRadiusDefaults.LRPhoneNo,t,o,n,i,function(){})}}),c.push(l)))):(D.setPINRule(A.util.findInSchema(c,"name","pin")),D.setPINRule(A.util.findInSchema(c,"name","confirmpin")),(s=A.util.getHashParam("vtoken"))?A.options.verifyEmailByOTP?(l=A.util.getQueryParameterByName("email"),u="&otp="+s,u+="&email="+encodeURIComponent(l.replace(/ /g,"+")),c.splice(2,1)):A.resetPINFormSchema[2].value=s:n([{Message:"Verification Token not found in query string."}])),D.createForm(c,"resetpin",t,function(e){-1===e.indexOf("otp")||a?(u&&(e+=u),O.resetPINController(e,o,n,t,i)):O.resetPINByPhoneController(e+r,o,n,t,i)},function(e){n(e)},i)},D.setPasswordRule=function(e,t){A.options.passwordLength=A.options.passwordlength||A.options.passwordLength;var o,n=A.util.findInSchema(A.options.RegistrationFormSchema,"name","password").rules;e&&e.rules&&((o=new RegExp(/matches\[\w*\]/).exec(e.rules))?(o=o[0],e.rules=[n,o].join("|")):e.rules=n,A.options.passwordLength&&A.options.passwordLength.min&&A.options.passwordLength.max&&(e.rules=e.rules||"",e.rules=e.rules.replace("min_length[6]","min_length["+A.options.passwordLength.min+"]").replace("max_length[32]","max_length["+A.options.passwordLength.max+"]"))),(t=t||!1)&&e&&(e.rules="required")},D.setPINRule=function(e){var t,o;A.pinSchema&&A.pinSchema.length&&(t=A.pinSchema[0].rules,e&&e.rules&&((o=new RegExp(/matches\[\w*\]/).exec(e.rules))?(o=o[0],e.rules=[t,o].join("|")):e.rules=t,A.options.PINConfiguration.IsRequired&&-1===e.rules.indexOf("required")&&(e.rules=e.rules?[e.rules,"required"].join("|"):"required")))},D.changeNumberForm=function(t,e,o,n,i,a,r,s){var l=A.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),u=A.util.getButtonAttribute("changenumber",i),c=A.util.getButtonAttribute("disableotpauthenticator",i),p=A.storage.getBrowserStorage(LoginRadiusDefaults.storedGAAuth),d=A.storage.getBrowserStorage(LoginRadiusDefaults.storedSQAuth),d="false"!==A.storage.getBrowserStorage(LoginRadiusDefaults.storedEmailOTPAuth)||"false"!==p||"false"!==d;e?(e.appendChild(u),l&&!A.LRCheckLogin&&(A.options.optionalTwoFactorAuthentication||d&&A.options.twoFactorAuthentication)&&e.appendChild(c)):(A.util.addHTMLContent(t,u,a),l&&!A.LRCheckLogin&&(A.options.optionalTwoFactorAuthentication||d&&A.options.twoFactorAuthentication)&&A.util.addHTMLContent(t,c,!0)),A.util.addEvent("click",c,function(e){D.disableMFAOptions("otpauthenticator",o,n)}),A.util.addEvent("click",u,function(e){document.getElementsByName(i+"changePhone")[0]||(LoginRadiusDefaults.innerHTML=!1,D.updatePhoneNumber(t,o,n,i,"changePhone",r,s))})},D.validateAndCall=function(e){LoginRadiusDefaults.isSSOInitFired?A.options.appName?e():A.log("LoginRadius site name (app name) required to do SSO"):A.log("Init method should be called first then login.")},D.logout=function(n){D.validateAndCall(function(){var e=A.options.tokenExpire?"?tokenExpire=1":"",t=A.options.tokenExpire?"tokenExpire":"logout",o=A.options.customDomain||A.options.appName+"."+LoginRadiusDefaults.hubDomain;A.util.ajaxCall("get","https://"+o+"/ssologin/"+t+e,"",function(e){LRNameSpace.cookies.removeItem(LoginRadiusDefaults.tokenCookie,A.options.appPath),A.clearSession(),n&&n()})})},D.otpEmailVerification=function(o,n,i,a,r){var e=A.otpSchema;D.createForm(e,"otp",o,function(e){var t="string"!=typeof r?(e=A.util.parseQueryString(e),A.util.mergeOptions(r,e)):r+"&"+e;O.emailVerificationController(t,n,i,o,a,!0)},function(e){i(e)},a)},D.loginHandleToken=function(e,t,o,n,i,a){var r,s,l,u,c,p,d,m,g,f,h;LoginRadiusDefaults.lrResponseCounter=0,LoginRadiusDefaults.lrCounterJwtResponse="",LoginRadiusDefaults.lrCounterTokenResponse="",e&&(e.ErrorCode?n(D.loginRadiusErrorTojsError(e)):(e.Data&&e.Data.hasOwnProperty("Profile")&&(delete(e=e.Data).Data,delete e.IsPosted),A.options.privacyPolicyConfiguration.IsEnabled&&e.Profile&&(p=!1,e.Profile.PrivacyPolicy&&e.Profile.PrivacyPolicy.Version&&(p=D.checkForLatestPrivacyPolicy(e.Profile)),e.Profile=Object.assign({},e.Profile,{IsLatestPrivacyPolicy:p})),r=function(){A.LoginRadiusHostedPage&&LRNameSpace.cookies.setItem("lr-session-token",e.access_token),LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterTokenResponse=e,A.options.tokenType&&"jwt"===A.options.tokenType.toLowerCase()?2===LoginRadiusDefaults.lrResponseCounter&&LoginRadiusDefaults.lrCounterJwtResponse&&LoginRadiusDefaults.lrCounterJwtResponse.signature&&(e.jwttoken=LoginRadiusDefaults.lrCounterJwtResponse.signature,null!=t&&""!==t?o(e,A.util.parseQueryString(t)):o(e)):null!=t&&""!==t?o(e,A.util.parseQueryString(t)):o(e)},h=A.storage.getBrowserStorage("LRSetSafariToken"),A.storage.removeBrowserStorage("LRSetSafariToken"),A.setHostedToken||h?o(e):(u=A.registrationFormSchema&&0<A.registrationFormSchema.length?A.registrationFormSchema:A.options.RegistrationFormSchema,d=(c=A.util.findInSchema(u,"name","phoneid"))&&-1!==c.rules.indexOf("required")&&A.options.phoneLogin,s=e.Profile||e.Data,p=!(A.options.disabledEmailVerification||A.options.optionalEmailVerification),s&&!s.EmailVerified&&p&&!a?n([D.setMappedMessage(y.emailNotVerified)]):d&&s&&!s.PhoneIdVerified&&!a?s.PhoneId?(m={phone:s.PhoneId},l=A.currentLRContainer,g=i+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp",O.resendOTPController(m,function(){D.verifyOTP("phone="+s.PhoneId,l,o,n,i),D.resendOTP("phone="+s.PhoneId+"&noPhoneVerified=false",l,o,n,i)},n,g,l,i)):A.log("Phone ID is required field."):(s&&s.Uid&&A.storage.setBrowserStorage(LoginRadiusDefaults.storedUidName,s.Uid),A.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,e.access_token),A.options.isPINAuthentication&&A.options.PINConfiguration.PINLogin&&e&&e.session_token&&A.setSessionToken(e),LoginRadiusDefaults.isSSOInitFired&&e.access_token?(D.setToken(e.access_token),u=!!(-1===(h=navigator.userAgent.toLowerCase()).indexOf("crios")&&-1===h.indexOf("chrome")&&0<=h.indexOf("safari")),c=/ipad|iphone|ipod/.test(h)&&!window.MSStream,p=0<=h.indexOf("ucbrowser"),d=/crios/i.test(h),a=A.options.customDomain||A.options.appName+"."+LoginRadiusDefaults.hubDomain,m=A.util.getQueryParameterByName("vtype"),g=A.util.getQueryParameterByName("vtoken"),h=window.location.href,m&&(h=h.replace("?vtype="+m,"").replace("&vtype="+m,"")),g&&(h=h.replace("&vtoken="+g,"").replace("?vtoken="+g,"")),h=encodeURIComponent(h),u||c&&p||c&&d?(A.options.askRequiredFieldForTraditionalLogin||A.storage.setBrowserStorage("LRTraditionalLogin",!0),A.$hooks.call("setCurrentAction"),A.options.stayLogin?(f=A.storage.getBrowserStorage("lr-rememberme"),A.storage.removeBrowserStorage("lr-rememberme"),window.location="https://"+a+"/ssologin/setCustomSafariToken?token="+e.access_token+"&apiKey="+A.options.apiKey+"&isrememberMe="+f+"&callback="+h):window.location="https://"+a+"/ssologin/setSafariToken?token="+e.access_token+"&apiKey="+A.options.apiKey+"&callback="+h):(f="",h="setToken",A.options.stayLogin&&(f="&isrememberMe="+A.storage.getBrowserStorage("lr-rememberme"),A.storage.removeBrowserStorage("lr-rememberme"),h="setCustomToken"),A.util.ajaxCall("get","https://"+a+"/ssologin/"+h+"?access_token="+e.access_token+"&apiKey="+A.options.apiKey+f,"",function(){r()},"setToken"))):r(),A.options.tokenType&&"jwt"===A.options.tokenType.toLowerCase()&&D.getJwtToken(e.access_token,o,n)))))},D.getJwtToken=function(e,t,o){A.util.ajaxCall("get",LoginRadiusDefaults.cloudApiDomain+"sso/jwt/api/token?apikey="+A.options.apiKey+"&jwtapp="+A.options.integrationName+"&access_token="+e,"",function(e){LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterJwtResponse=e,2===LoginRadiusDefaults.lrResponseCounter&&(e.ErrorCode?o(e):(LoginRadiusDefaults.lrCounterTokenResponse.jwttoken=e.signature,t(LoginRadiusDefaults.lrCounterTokenResponse)))},"JWTToken")},D.mapSchema=function(t,e,o,n){e=A.util.keysToLowerCase(e);var i=[];Object.keys(t).forEach(function(e){i.push(t[e])});for(var a=0;a<t.length;a++)if(null!=t[a])if("emailid"===t[a].name.toLowerCase()&&e.email&&e.email[0]&&e.email[0].value&&""!==e.email[0].value){if(e.emailverified||(A.options.disabledEmailVerification||A.options.optionalEmailVerification)&&!A.options.askEmailForUnverifiedProfileAlways){i[a].value=e.email[0].value,t[a]=null;continue}if(!A.options.askEmailForUnverifiedProfileAlways||A.setHostedToken){i[a]=t[a]=null;continue}}else if("country"===t[a].name.toLowerCase()&&""===t[a].Parent&&e.country&&null!=e.country.name&&""!==e.country.name&&"unknown"!==e.country.name.toLowerCase())i[a].value=e.country.name,e.country.code&&(i[a].value=e.country.code+"|"+i[a].value),t[a]=null;else if("emailsubscription"===t[a].name.toLowerCase()&&e.isemailsubscribed&&""!==e.isemailsubscribed)i[a].value=e.isemailsubscribed,t[a]=null;else if("phoneid"===t[a].name.toLowerCase()&&e.phoneid&&""!==e.phoneid)i[a].value=e.phoneid.replace("+",""),t[a]=null;else if("birthdate"===t[a].name.toLowerCase()&&e.birthdate&&""!==e.birthdate){var r=e.birthdate.replace("-","/").replace("-","/").split("/");if(r[2]&&""!==r[2]){i[a].value=e.birthdate,t[a]=null;continue}}else if("password"===t[a].name.toLowerCase()||"confirmpassword"===t[a].name.toLowerCase()){if(null!=e.password||!A.options.promptPasswordOnSocialLogin&&!A.options.promptPasswordOnFirstLoginForSocial){i[a]=t[a]=null;continue}}else if("pin"===t[a].name.toLowerCase()||"confirmpin"===t[a].name.toLowerCase()){if(e.pin&&e.pin.pin||!A.options.isPINAuthentication){i[a]=t[a]=null;continue}}else if(""!==t[a].Parent&&void 0!==t[a].Parent&&null!==t[a].Parent){if(t[a].Parent&&e[t[a].Parent.toLowerCase()]&&void 0!==e[t[a].Parent.toLowerCase()]){var s=-1!==t[a].name.indexOf("_")?t[a].name.split("_")[1]:t[a].name,r=Object.keys(e[t[a].Parent.toLowerCase()]).length-1;if("object"!=typeof e[t[a].Parent.toLowerCase()]||!e[t[a].Parent.toLowerCase()][r]||!e[t[a].Parent.toLowerCase()][r][s.toLowerCase()]){i[a].value=e[t[a].Parent.toLowerCase()][t[a].name.toLowerCase()],t[a]=null;continue}if(null!=e[t[a].Parent.toLowerCase()][r][s.toLowerCase()]&&void 0!==e[t[a].Parent.toLowerCase()][r][s.toLowerCase()]&&"unknown"!==e[t[a].Parent.toLowerCase()][r][s.toLowerCase()]){i[a].value=e[t[a].Parent.toLowerCase()][r][s.toLowerCase()],t[a]=null;continue}}}else{if(0===t[a].name.indexOf("cf_")&&e.customfields&&e.customfields[t[a].name.replace("cf_","").toLowerCase()]){i[a].value=e.customfields[t[a].name.replace("cf_","").toLowerCase()],t[a]=null;continue}t[a].name&&"object"!=typeof e[t[a].name.toLowerCase()]&&null!=e[t[a].name.toLowerCase()]&&""!==e[t[a].name.toLowerCase()]&&void 0!==e[t[a].name.toLowerCase()]&&"unknown"!==e[t[a].name.toLowerCase()]&&(i[a].value=e[t[a].name.toLowerCase()],t[a]=null)}if(t=t.filter(function(e){return e}),o&&"profileeditor"===o&&!e.ErrorCode)return i=i.filter(function(e){return e});for(var l=0;l<t.length;l++)if(null!=t[l].rules&&""!==t[l].rules&&-1<t[l].rules.indexOf("required")||A.options.askOptionalFieldsOnRegistration&&!0===e.firstlogin&&"email"!==e.registrationprovider.toLowerCase()||A.options.askOptionalFieldsOnProgressiveSteps&&n||A.askPinOnLogin)return o&&!e.ErrorCode?i=i.filter(function(e){return e}):t;return[]},D.loginRadiusErrorTojsError=function(e){var t=[];return t.push(D.setMappedMessage(e)),t},D.setMappedMessage=function(e){for(var t=0;t<A.errorMessages.length;t++)A.errorMessages[t].code==e.ErrorCode&&(e.Message=A.errorMessages[t].message||e.Message,e.Description=A.errorMessages[t].description||e.Description);return e},D.setCustomLabel=function(e){for(var t=0;t<e.length;t++)e[t]&&A.formCustomLabel[e[t].name]&&(e[t].display=A.formCustomLabel[e[t].name])},D.setCustomTitle=function(e){for(var t=0;t<e.length;t++)e[t]&&A.formElementsTitle[e[t].name]&&(e[t].title=A.formElementsTitle[e[t].name])},D.setPlaceholder=function(e){for(var t=0;t<e.length;t++)e[t]&&A.formPlaceholder[e[t].name]&&(e[t].placeholder=A.formPlaceholder[e[t].name])},D.setValidation=function(e){A.formValidations[e.name]&&(e.rules=A.formValidations[e.name])},D.setAttribute=function(e,t){if(A.formElementAttributes[e.name])for(var o=A.formElementAttributes[e.name].split("&"),n=0;n<o.length;n++){var i=o[n].split("="),a=i.splice(0,1),i=i.join("=");t.setAttribute(a,i)}},D.verifyOTP=function(o,e,n,i,t,a,r){var s=!1,l="otp",u="";A.LRCheck2FA&&(A.options.twoFactorAuthentication||A.options.optionalTwoFactorAuthentication)&&!A.LRCheckRegistration&&(s=!0,l="twofaotp");var c,p=A.otpSchema;o.mfaEmailToken&&o.EmailId?(u=o.EmailId,l="twofaemailotp",LoginRadiusDefaults.innerHTML=!1,(c=A.util.findInSchema(p,"name","emailid"))?c.value=o.EmailId:p.push({type:"hidden",name:"emailid",value:o.EmailId})):((c=o)&&"string"==typeof o&&(c=JSON.parse(JSON.stringify(o)),c=A.util.parseQueryString(c)),u=c.phone||c.phoneid||c.phoneId||c.phoneNo2FA||""),u&&p&&p[0]&&"otp"===p[0].name&&A.$hooks.register("afterFormRender",function(e,t,o,n){n&&n.name==="loginradius-"+l&&n[0].name===p[0].name&&n[0].labels&&n[0].labels[0].innerText&&-1!==n[0].labels[0].innerText.indexOf("%value")&&(n[0].labels[0].innerText=n[0].labels[0].innerText.replace("%value",u))}),D.createForm(p,l,e,function(e){var t;s?(o.mfaEmailToken&&"string"==typeof e&&(e+="&mfaEmailToken=true"),O.verify2FAOTPController(e,n,i,a,r)):(("string"==typeof o||o instanceof String)&&(o=A.util.parseQueryString(o)),e=A.util.parseQueryString(e),o.phone?t={phone:o.phone}:(o.phoneid||o.phoneId)&&(t={phone:o.phoneid||o.phoneId}),o.onetouchloginflag&&(e.onetouchloginflag=!0),o.haveToken&&(e.haveToken=!0),O.verifyOTPController(e,t,n,i,a,r))},function(e){i(e)},t)},D.resendOTP=function(e,t,o,n,i,a,r,s){var l={},u=!0;(e="string"==typeof e||e instanceof String?A.util.parseQueryString(e):e).noPhoneVerified&&(u=!1);var c=!0;e.phoneid||e.phoneId?(c=!1,l={phone:e.phoneid||e.phoneId}):e.phone?(A.socialLoginFlag||(c=!1),l=e):e.phoneNo2FA||e.phoneno2fa?l={phoneno2fa:e.phoneNo2FA||e.phoneno2fa}:e.SecondFactorAuthentication&&e.SecondFactorAuthentication.OTPPhoneNo&&(l={phoneno2fa:e.SecondFactorAuthentication.OTPPhoneNo});var p=A.util.getButtonAttribute("resendotp",i),d=i||LoginRadiusDefaults.classPrefix,m=c?"twofaotp":"otp",i=document.getElementsByName(d+m)[0];i||(m="twofaotp"==m?"otp":"twofaotp",i=document.getElementsByName(d+m)[0]),i&&((m=A.util.findInSchema(i,"type","submit"))?m.parentNode.insertBefore(p,m.nextSibling):i.appendChild(p)),!A.LRCheckLogin||!c||u&&"false"!==A.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth)||D.changeNumberForm(t,i,o,n,d,"",a,r),e.onetouchloginflag&&(l.onetouchloginflag=!0),e.updatePhone&&(l.updatePhone=!0),A.util.addEvent("click",p,function(e){A.options.disableResendOTPButton&&A.util.disableResendOTPButton(e),s?(e=A.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))&&D.isValidToken(e,n)&&A.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/phone?apiKey="+A.options.apiKey+"&access_token="+e+"&smsTemplate="+A.options.smsTemplateUpdatePhone,l,function(e){e.ErrorCode&&n(D.loginRadiusErrorTojsError(e))},"updatePhone"):D.resendOTPManually(l,t,o,n,d,a,r)})},D.sendInstantSignInLink=function(e,t,o,n,i){var a,e=A.util.parseQueryString(e),e=e.emailid||e.email;LoginRadiusDefaults.regexExpression.emailRegex.test(e)||A.options.usernameLogin||A.options.duplicateEmailWithUniqueUsername?(LoginRadiusDefaults.regexExpression.emailRegex.test(e)?a="email="+e:(A.options.usernameLogin||A.options.duplicateEmailWithUniqueUsername)&&(a="username="+e),e=A.options.instantLinkLoginEmailTemplate||A.options.passwordlessLoginEmailTemplate,A.util.ajaxCall("GET",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/email?apiKey="+A.options.apiKey+"&verificationUrl="+A.options.verificationUrl+"&passwordlesslogintemplate="+e+"&"+a,"",function(e){window.lrpasswordlessloginotp=!1,window.lrpasswordlesslogin=!1,e.ErrorCode?o(D.loginRadiusErrorTojsError(e)):t(e)},"passwordlessLogin")):o([D.setMappedMessage(y.invalidEmail)])},D.sendInstantSignInOtp=function(e,n,i,o,a){var r,s,e=A.util.parseQueryString(e),e=e.emailid||e.email;LoginRadiusDefaults.regexExpression.phoneRegex.test(e)?(s=A.options.smsTemplateInstantOTPLogin||A.options.passwordlessLoginSMSTemplate,A.util.ajaxCall("GET",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/otp?apiKey="+A.options.apiKey+"&"+(r="phone="+e)+"&smsTemplate="+s,"",function(e){window.lrpasswordlessloginotp=!1,window.lrpasswordlesslogin=!1,e.ErrorCode?i(D.loginRadiusErrorTojsError(e)):(n(e),e.Data&&e.Data.Sid&&(A.$hooks.register("beforeFormRender",function(e,t){var o;A.util.findInSchema(t,"name","resendotp")||(o=Object.assign({},A.btnOTPSchema,{name:"resendotp",display:"Resend Verification Code",eventCallback:function(e){A.options.disableResendOTPButton&&A.util.disableResendOTPButton(e),D.resendOTPHandler({data:r,onsuccess:n,onerror:i,smstemplate:s,action:"sendInstantSignInResendOtp"})}}),t.push(o))}),e=A.otpSchema,D.createForm(e,"otp",o,function(e){var t=a+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp";O.verifyInstantOTP(e,A.util.parseQueryString(r),n,i,t,o,a)},function(e){i(D.setMappedMessage(e))},a)))},"passwordlessLogin")):i([D.setMappedMessage(y.invalidPhone)])},D.resendOTPManually=function(e,t,o,n,i,a,r){var s,l=i+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp";A.LRCheck2FA&&(A.options.twoFactorAuthentication||A.options.optionalTwoFactorAuthentication)&&!A.LRCheckRegistration?"false"===A.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth)?(s={data:e,onsuccess:o,onerror:n,smstemplate:A.options.smsTemplate2FA,action:"update2FANumberResendOTP"},D.resendOTPHandler(s)):O.resendOTP2FAController(e,o,n,l,t,i):O.resendOTPController(e,o,n,l,t,i)},D.updatePhoneNumber=function(t,o,n,i,e,a,r){A.LRCheck2FA&&(A.options.twoFactorAuthentication||A.options.optionalTwoFactorAuthentication)&&(A.checkPhoneNumberSchema[0].name="phoneNo2FA"),i=i||LoginRadiusDefaults.classPrefix,document.getElementsByName(i+"showQRcode")[0]&&(LoginRadiusDefaults.innerHTML=!0),D.createForm(A.checkPhoneNumberSchema,e||"updatePhone",t,function(e){-1===e.indexOf("phone=")&&(A.options.twoFactorAuthentication||A.options.optionalTwoFactorAuthentication)?O.update2FAPhoneNumberController(e,t,o,n,i,a,r):O.updatePhoneNumberController(e,t,o,n,i,a,r)},function(e){n(e)},i)},D.pingForSmartLogin=function(t,o,n){var i=A.options.autoLoginPingInterval||A.options.smartLoginPingInterval,a=A.options.autoLoginPingCount||A.options.smartLoginPingCount;A.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/smartlogin/ping?apiKey="+A.options.apiKey+"&clientGuid="+t,"",function(e){1139===e.ErrorCode||1140===e.ErrorCode?setTimeout(function(){LoginRadiusDefaults.pingCount<a&&(D.pingForSmartLogin(t,o,n),LoginRadiusDefaults.pingCount++)},1e3*i):e.ErrorCode&&1139!==e.ErrorCode?(n(e),LoginRadiusDefaults.pingCount=0):(LoginRadiusDefaults.pingCount=0,o(e))},"pingSmartLogin")},D.pingForSocialLogin=function(t,o,n){var i=A.options.autoLoginPingInterval||A.options.smartLoginPingInterval,a=A.options.autoLoginPingCount||A.options.smartLoginPingCount;A.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/ping?apiKey="+A.options.apiKey+"&clientGuid="+t+"&verificationUrl="+A.options.verificationUrl+"&emailTemplate="+A.options.verificationEmailTemplate+"&welcomeEmailTemplate="+A.options.welcomeEmailTemplate,"",function(e){1139===e.ErrorCode||1140===e.ErrorCode?setTimeout(function(){LoginRadiusDefaults.pingCount<a&&(D.pingForSocialLogin(t,o,n),LoginRadiusDefaults.pingCount++)},1e3*i):e.ErrorCode&&1139!==e.ErrorCode?(n(e),LoginRadiusDefaults.pingCount=0):(LoginRadiusDefaults.pingCount=0,o(e))},"socialLogin")},D.pingForCrossDeviceSSO=function(t,o,n,i){var a=A.options.crossDeviceSSOPingInterval,r=A.options.crossDeviceSSOPingCount,s=1;A.util.ajaxCall("get",LoginRadiusDefaults.cloudApiDomain+"sso/mobile/token?apiKey="+A.options.apiKey+"&code="+t,"",function(e){e&&null===e.access_token?A.CDSSOPingApiTimeout=setTimeout(function(){s<r&&(D.pingForCrossDeviceSSO(t,o,n,i),s++)},1e3*a):(s=0,i(),o(e))},"pingForCrossDeviceSSO")},D.generateCrossDeviceSSOCode=function(a,e,r,s,l,u){e=e||"60";60<+e?A.log("QR code expiry time should not be more than 60 seconds."):A.util.ajaxCall("get",LoginRadiusDefaults.cloudApiDomain+"sso/mobile/generate?apikey="+A.options.apiKey+"&expiry="+e,"",function(e){var o,t,n,i;e.ErrorCode?s(D.loginRadiusErrorTojsError(e)):e&&e.code&&(o=[],QRCode.toDataURL(e.code,function(e,t){o.push({type:"image",name:"qrcode",display:"QR Code",rules:"",permission:"r",value:t})}),t=l||LoginRadiusDefaults.idPrefix,n=l||LoginRadiusDefaults.classPrefix,(i=document.createElement("div")).setAttribute("name",t+"crossDeviceSSO"),D.createFormFields(o,i,"crossDeviceSSO",[],n,t,s),A.util.addHTMLContent(a,i,LoginRadiusDefaults.innerHTML),D.pingForCrossDeviceSSO(e.code,function(e){D.loginHandleToken(e,"",r,s,"",!0)},s,u))},"crossDeviceSSO")},D.addChangeEventHandler=function(l,e,t,u){A.util.addEvent("change",document.getElementById(u+"registration-"+e.name),function(e){A.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/"+t.DataSource+"?apiKey="+A.options.apiKey+"&parentId="+this.value,"",function(e,t){var o=document.getElementById(u+"registration-"+e.name);if(t.ErrorCode)for(var n=1;n<o.options.length;n++)o.options[n]=null;else for(var i=0;i<t.length;i++)if(0===i&&1<o.options.length){for(var a=1;a<o.options.length;a++)o.options[a]=null;var r=document.createElement("option");r.setAttribute("value",t[i].Id),r.appendChild(document.createTextNode(t[i].Key)),o.appendChild(r)}else{r=document.createElement("option");r.setAttribute("value",t[i].Id),r.appendChild(document.createTextNode(t[i].Key)),o.appendChild(r)}for(var s=0;s<e.children.length;s++)D.addChangeEventHandler(l,e,e.children[s],u)},"registration",t)})},D.createFormFields=function(e,t,l,o,n,i,a){var u;function r(e){var t=Math.random(),o=this.value,n=A.util.elementById(l+"-password-strength-meter"),i=A.util.elementById(l+"-password-strength-text");i.innerHTML="";var a=0;0<o.length&&(a++,o.match(/[a-z]/)&&o.match(/[A-Z]/)&&a++,o.match(/\d+/)&&a++,o.match(/.[!,@,#,$,%,^,&,*,?,_,~,-,(,)]/)&&a++,12<o.length&&a++),n.value=a;var r=document.getElementsByClassName(l+"-password");if(0<r.length)for(var s=0;s<r.length;s++)r[s].parentNode.removeChild(r[s]);n=A.util.elementById(t)?A.util.elementById(t):document.createElement("style");n.type="text/css",n.id=t,n.setAttribute("class",l+"-password");t=-1!==navigator.userAgent.indexOf("Firefox");n.innerHTML=t?"#"+l+"-password-strength-meter::-moz-meter-bar { background: "+u[a].color+" !important; }":"#"+l+"-password-strength-meter::-webkit-meter-optimum-value { background: "+u[a].color+" !important; }",document.body.appendChild(n),""!==o&&0<a?(i.innerHTML="Strength: "+u[a].Message,i.style.color=""):""!==o&&(i.innerHTML=u[a].Message,i.style.color=u[a].color)}a=a||function(){};for(var s,c,p,d=0;d<e.length;d++)if(e[d]){switch(D.setValidation(e[d]),e[d].rules&&""!==e[d].rules&&-1<e[d].rules.indexOf("custom_validation")&&-1===e[d].rules.indexOf("callback_custom_validation")&&(e[d].rules=e[d].rules.replace(/custom_validation\b/g,"callback_custom_validation")),o[d]={},o[d].name=e[d].name,o[d].display=e[d].display,o[d].rules=e[d].rules,e[d].type){case"text":m=document.createElement("textarea");break;case"html":case"captcha":m=document.createElement("div");break;case"password":(m=document.createElement("input")).type="password";break;case"hidden":(m=document.createElement("input")).type="hidden",m.value=e[d].value||"";break;case"option":var m=document.createElement("select"),g=document.createElement("option");if(g.appendChild(document.createTextNode("-- select --")),g.setAttribute("value",""),m.appendChild(g),null==e[d].DataSource&&null!=e[d].options){for(var f=0;f<e[d].options.length;f++){var h=document.createElement("option");h.setAttribute("value",e[d].options[f].value),"country"===e[d].name&&h.setAttribute("value",e[d].options[f].value+"|"+e[d].options[f].text),h.appendChild(document.createTextNode(e[d].options[f].text)),m.appendChild(h)}A.defaultOptionField[e[d].name]&&(m.value=A.defaultOptionField[e[d].name])}break;case"multi":(m=document.createElement("input")).type="checkbox";break;case"email":(m=document.createElement("input")).type="email";break;case"button":(m=document.createElement("input")).type="button",m.value=e[d].display;break;case"image":(m=document.createElement("img")).src=e[d].value,m.type="image";break;default:(m=document.createElement("input")).type="text"}if(e[d].title&&(m.title=e[d].title),e[d].disabled&&(m.disabled=e[d].disabled),D.setAttribute(e[d],m),e[d].placeholder&&(m.placeholder=e[d].placeholder),e[d].value&&("multi"===e[d].type?m.checked=!0:m.value=e[d].value),"html"===e[d].type){var y=document.createElement("div");if(y.setAttribute("class",n+"-form-element-content content-"+i+e[d].name),y.innerHTML=e[d].html,e[d].event&&A.util.addEvent(e[d].event,y,e[d].eventCallback),"consent"===e[d].name)for(var v=y.getElementsByTagName("input"),C=0;C<v.length;C++)v[C].setAttribute("id",i+l+"-"+v[C].name);t.appendChild(y)}else if("captcha"===e[d].type){var T=document.createElement("div");T.setAttribute("class",n+"-form-element-content content-"+i+e[d].name),T.innerHTML=e[d].html,A.options.formValidationMessage&&((y=document.createElement("div")).setAttribute("id","validation-"+i+l+"-"+e[d].name),y.setAttribute("class",n+"validation-message validation-"+i+e[d].name),T.appendChild(y)),t.appendChild(T)}else{if(m.setAttribute("name",e[d].name),"registration"===l&&(e[d].name&&("phoneid"===e[d].name.toLowerCase()||"phone"===e[d].name.toLowerCase())&&A.options.existPhoneNumber&&A.util.addEvent("blur",m,function(e){var t,o=a;""!==(t=e).target.value.trim()&&O.checkPhoneNumberAvailabilityController("phone="+t.target.value,function(e){e.IsExist?-1!==t.target.parentNode.getAttribute("class").indexOf("phoneid")&&(t.target.parentNode.childNodes[2].innerHTML="phone already exists, enter unique phone number"):-1!==t.target.parentNode.getAttribute("class").indexOf("phoneid")&&(t.target.parentNode.childNodes[2].innerHTML="")},o)}),e[d].name&&"username"===e[d].name.toLowerCase()&&A.options.existUsername&&A.util.addEvent("blur",m,function(e){var t,o=a;""!==(t=e).target.value.trim()&&O.checkUserNameAvailabilityController("username="+t.target.value,function(e){e.IsExist?-1!==t.target.parentNode.getAttribute("class").indexOf("username")&&(t.target.parentNode.childNodes[2].innerHTML="username already exists, enter unique username"):-1!==t.target.parentNode.getAttribute("class").indexOf("username")&&(t.target.parentNode.childNodes[2].innerHTML="")},o)})),"emailid"===e[d].name&&A.util.addEvent("keyup",m,function(e){32===e.keyCode&&(this.value=this.value.trim())}),m.setAttribute("id",i+l+"-"+e[d].name),e[d].event&&A.util.addEvent(e[d].event,m,e[d].eventCallback),A.eventsName[m.id]){var w=A.eventsName[m.id];if(A.util.isArray(w))for(var S=0;S<w.length;S++)w[S].event&&w[S].eventCallback&&A.util.addEvent(w[S].event,m,w[S].eventCallback);else A.util.addEvent(w.event,m,w.eventCallback)}if("hidden"===e[d].type)t.appendChild(m);else if("button"===e[d].type){var L=document.createElement("div");L.setAttribute("class",n+"-form-element-content content-"+i+e[d].name),L.appendChild(m),t.appendChild(L)}else{L=document.createElement("label");L.setAttribute("for",i+l+"-"+e[d].name),L.innerHTML=e[d].display,m.setAttribute("class",n+e[d].type+" "+i+e[d].name),e[d].rules&&-1!==e[d].rules.indexOf("required")&&(m.className+=" lr-required");var k=document.createElement("div");if(k.setAttribute("class",n+"-form-element-content content-"+i+e[d].name),"multi"===e[d].type?(k.appendChild(m),k.appendChild(L)):(k.appendChild(L),k.appendChild(m)),e[d].style&&0<e[d].style.length)for(var P=0;P<e[d].style.length;P++)k.style[e[d].style[P].key]=e[d].style[P].value;if(A.options.formValidationMessage&&((b=document.createElement("div")).setAttribute("id","validation-"+i+l+"-"+e[d].name),b.setAttribute("class",n+"validation-message validation-"+i+e[d].name),k.appendChild(b)),A.options.displayPasswordStrength&&("password"===m.name||"newpassword"===m.name)&&("registration"===l||"resetpassword"===l||"setpassword"===l||"changepassword"===l||"socialRegistration"===l||"loginRequiredFieldsUpdate"===l)){if(A.options.passwordLength&&A.options.passwordLength.min,A.options.passwordLength&&A.options.passwordLength.max,e[d].rules)for(var R=e[d].rules.split("|"),E=0;E<R.length;E++)(-1<R[E].indexOf("min_length")||-1<R[E].indexOf("max_length"))&&R[E].substring(11,R[E].length-1);L=document.createElement("meter");L.setAttribute("max","4"),L.setAttribute("id",l+"-password-strength-meter");var b=document.createElement("div");b.setAttribute("id",l+"-password-strength-text"),m.parentNode.appendChild(L),m.parentNode.appendChild(b),p=c=s=void 0,s={0:"worst",1:"bad",2:"weak",3:"good",4:"strong",5:"secure"},c={0:"#dd514c",1:"orange",2:"yellow",3:"#5eb95e",4:"blue",5:"violet"},p={0:"Worst",1:"Bad",2:"Weak",3:"Good",4:"Strong",5:"Secure"},u=function(){var e,t=[],o=A.passwordMeterConfiguration;for(e in s)o[e]&&o[e].case?o[e].case.toLowerCase()===s[e]&&t.push({color:o[e].color||c[e],Message:o[e].message||p[e]}):t.push({color:c[e],Message:p[e]});return t}(),A.util.addEvent("keyup",m,r)}t.appendChild(k)}}}},D.setToken=function(e){LRNameSpace.cookies.setItem(LoginRadiusDefaults.tokenCookie,e,"",A.options.appPath)},D.resetGoogleCaptcha=function(e,t){A.options.optionalRecaptchaConfiguration.IsEnabled&&"registration"!==e&&(e=A.util.elementById(t,!0),window.grecaptcha&&e&&""!==e.innerHTML&&grecaptcha.reset(window[t+"lr_recaptcha_widgets_idprefix"]))},D.createForm=function(e,c,t,p,d,m){var o,n,g=m||LoginRadiusDefaults.idPrefix,f=m||LoginRadiusDefaults.classPrefix;if(A.LRPrefix=m+"##"+LoginRadiusDefaults.idPrefix,("Captcha"===A.options.loginLockedType&&"registration"!==c||A.options.optionalRecaptchaConfiguration.IsEnabled)&&(n=A.options.optionalRecaptchaConfiguration.Apis,("Captcha"===A.options.loginLockedType||n&&S(c,n))&&(o=m+LoginRadiusDefaults.idPrefix+"recaptcha_widget_"+c.toLowerCase(),A.util.addRecaptchaJS(),A.util.captchaSchema(o,e))),A.$hooks.call("beforeFormRender",c,e),LoginRadiusDefaults.isRegFormSchemaLock=!1,LoginRadiusDefaults.isSecurityFormSchemaLock=!1,A.options.apiKey){if(D.setCustomLabel(e),D.setPlaceholder(e),D.setCustomTitle(e),0<e.length){var i=[],h=document.createElement("form");h.setAttribute("name",g+c),h.setAttribute("method","POST"),D.createFormFields(e,h,c,i,f,g,d);var a,r=document.createElement("input"),s=A.buttonsName[c.toLowerCase()]||C[c.toLowerCase()],l=C[c.toLowerCase()].toLowerCase().replace(/ /g,"-");r.type="submit",A.options.isPINAuthentication&&"loginRequiredFieldsUpdate"===c&&A.util.findInSchema(e,"name","pin")?r.value="Continue":r.value=s,r.id=g+"submit-"+l,r.setAttribute("class",f+"submit submit-"+g+l),A.options.disableButtonOnsubmit&&(A.$hooks.register("eventCalls",function(e){window.lrpasswordlessloginotp||window.lrpasswordlesslogin||(a=e)}),A.$hooks.register("startProcess",function(e){a===c&&(r.disabled=!0)}),A.$hooks.register("xhrEndWithError",function(e){a===c&&(r.disabled=!1)}),A.$hooks.register("xhrEndWithSuccess",function(e){a===c&&A.options.enableSubmitOnSuccess&&(r.disabled=!1)})),h.appendChild(r),A.options.passwordlessLogin&&"login"===c&&w("passwordlessloginbuttonlabel",h,r,g,f),A.options.passwordlessLoginOTP&&"login"===c&&w("passwordlessLoginOTPButtonLabel",h,r,g,f),A.util.addHTMLContent(t,h,LoginRadiusDefaults.innerHTML),A.$hooks.call("afterFormRender",c,t,f,h),LoginRadiusDefaults.innerHTML=!1;var u,y=new FormValidator(g+c,i,function(e,t){var o=document.getElementsByTagName("form"),n="";if(o[g+c])n=o[g+c];else if("object"==typeof o)for(var i=0;i<o.length;i++)if(o[i].name===g+c){n=o[i];break}A.currentLRContainer=n.parentElement.id,A.$hooks.call("eventCalls",c,f),A.mergeFormErrors&&0<A.mergeFormErrors.length&&(e=A.util.mergeObjects(e,A.mergeFormErrors));for(var a=A.util.elementsByClass(f+"validation-message"),r=0;r<a.length;r++)a[r].innerHTML="";var s=m+g+"recaptcha_widget";s+="_"+c.toLowerCase();var l=A.util.elementById(s+"_tencent");if(A.options.invisibleRecaptcha&&(window.onCaptchaSubmit=function(e){p(A.util.serialize(h)),grecaptcha.reset(window[s+"lr_recaptcha_widgets_idprefix"])}),l&&"none"!==l.style.display&&(A.options.tencentCaptcha||A.options.tencentCaptchaAsFallback&&!window.grecaptcha)&&0==e.length&&l.click(),0<e.length){A.$hooks.call("afterValidation",c);for(var u=0;u<e.length;u++)if(e[u].Id===g+""+c+"-password"&&"login"===c&&(A.options.passwordlessLogin&&window.lrpasswordlesslogin||A.options.passwordlessLoginOTP&&window.lrpasswordlessloginotp)){if(1===e.length||0===e.length)return T(h,p,s,c),D.resetGoogleCaptcha(c,s),!0}else A.options.formValidationMessage&&"resettoken"!==e[u].Name&&(A.util.elementById("validation-"+g+c+"-"+e[u].Name).innerHTML=e[u].Message);A.options.formValidationMessage||(d(e),D.resetGoogleCaptcha(c,s))}else T(h,p,s,c),D.resetGoogleCaptcha(c,s);t&&t.preventDefault?t.preventDefault():event&&(event.returnValue=!1)});if(A.validationMessages&&0<A.validationMessages.length)for(var v=0;v<A.validationMessages.length;v++)y.setMessage(A.validationMessages[v].rule,A.validationMessages[v].message),"valid_date"!==A.validationMessages[v].rule&&"callback_valid_date"!==A.validationMessages[v].rule||(u=A.validationMessages[v].message);y.registerCallback("valid_date",function(e){var t=e.split("/");-1!==e.indexOf("-")&&(t=e.split("-"));var o=parseInt(t[1],10),n=parseInt(t[0],10),e=parseInt(t[2],10);if(e<1e3||3e3<e||0===n||12<n)return!1;t=[31,28,31,30,31,30,31,31,30,31,30,31];return(e%400==0||e%100!=0&&e%4==0)&&(t[1]=29),0<o&&o<=t[n-1]}).setMessage("valid_date",u||"The %s field must contain a valid date."),y.registerCallback("custom_validation",function(e,t){t=(t=t.split("###")[0]).split("or").join("|");try{return!!new RegExp(t,"g").test(e)}catch(e){return A.log("Invalid custom validation regex expression"),!1}}).setMessage("custom_validation","The %s field is not valid."),A.Validator=y}}else A.log("API key must be set.");A.options.optionalRecaptchaConfiguration.IsEnabled&&n&&S(c,n)&&"registration"!==c&&A.util.renderV2Recaptcha(o,!0)},D.createConsentInterface=function(e,t){var o="";if(e){for(var n=0;n<e.ConsentForm.length;n++)if("Group"===e.ConsentForm[n].Type){if(e.ConsentForm[n].Consents.length){var i={consentGroupTitle:e.ConsentForm[n].Title,consentGroupDescription:e.ConsentForm[n].Description};o+=A.util.hashTmpl(LoginRadiusDefaults.templates.consentGroupTemplate,i);for(var a=0;a<e.ConsentForm[n].Consents.length;a++){var r={consentTitle:e.ConsentForm[n].Consents[a].Title,consentDescription:e.ConsentForm[n].Consents[a].Description,consentId:"consent_"+e.ConsentForm[n].Consents[a].ConsentId};o+=A.util.hashTmpl(LoginRadiusDefaults.templates.consentOptionTemplate,r)}}}else if("Consent"===e.ConsentForm[n].Type)for(var s=0;s<e.ConsentForm[n].Consents.length;s++){var l={consentTitle:e.ConsentForm[n].Consents[s].Title,consentDescription:e.ConsentForm[n].Consents[s].Description,consentId:"consent_"+e.ConsentForm[n].Consents[s].ConsentId};o+=A.util.hashTmpl(LoginRadiusDefaults.templates.consentOptionTemplate,l)}if(o+=A.util.hashTmpl(LoginRadiusDefaults.templates.consentMainTemplate,e),t){var u=document.createElement("div");u.innerHTML=o.trim();for(var c=0;c<t.length;c++){var p=u.querySelector('input[name="consent_'+t[c].ConsentOptionId+'"]');p&&p.setAttribute("checked","checked")}o=u.innerHTML||""}}return o},D.createConsentOptionInterface=function(e,t){var o="";if(e){for(var n in e){n={consentTitle:e[n].Title,consentDescription:e[n].Description,consentId:"consent_"+e[n].ConsentId,checked:!!e[n].checked};o+=A.util.hashTmpl(LoginRadiusDefaults.templates.consentOptionTemplate,n)}if(t){var i=document.createElement("div");i.innerHTML=o.trim();for(var a=0;a<t.length;a++)e[t[a].ConsentOptionId]&&i.querySelector('input[name="consent_'+t[a].ConsentOptionId+'"]').setAttribute("checked","checked");o=i.innerHTML||""}}return o},D.setConsentTemplate=function(){var e,t,o,n,i=document.getElementById(LoginRadiusDefaults.templates.consentMainTemplate);i&&((e=document.createElement("div")).innerHTML=i.innerHTML,i.append(e),(t=document.createElement("script")).type="text/html",t.id=LoginRadiusDefaults.templates.consentOptionTemplate,t.innerHTML=this.decodeHtml(document.getElementById(LoginRadiusDefaults.templates.consentOptionTemplate).innerHTML),!(o=document.getElementById(LoginRadiusDefaults.templates.consentGroupTemplate))||(n=o.querySelectorAll("#"+LoginRadiusDefaults.templates.consentOptionTemplate)[0])&&n.remove(),(n=document.createElement("script")).type="text/html",n.id=LoginRadiusDefaults.templates.consentGroupTemplate,n.innerHTML=this.decodeHtml(o.innerHTML),o.remove(),i.innerHTML=this.decodeHtml(e.innerHTML),e.remove(),document.body.append(n),document.body.append(t))},D.consentValidation=function(e,t){var o=A.util.parseQueryString(e),n=[];if(t){if(A.consentOptions[t]&&A.consentOptions[t].ConsentForm)for(var i=A.consentOptions[t].ConsentForm,a=0;a<i.length;a++)var r=i[a],n="Group"===r.Type?D.setConsentValidation(r,o,n,!0):D.setConsentValidation(r,o,n)}else{var s,l={Type:"Consent",Consents:[]};for(s in A.consentsList)l.Consents.push(A.consentsList[s]);n=D.setConsentValidation(l,o,n)}return n},D.setConsentValidation=function(e,t,o,n){var i=!1;if(n&&e.IsRequiredAtleastOne&&0===e.Consents.length)o.push({Id:e.GroupId,Name:e.Title,Message:"In "+e.Title+" group should have at least one consent"});else{for(var a=0;a<e.Consents.length;a++)n&&e.IsRequiredAtleastOne&&"true"===t["consent_"+e.Consents[a].ConsentId]&&(i=!0),e.Consents[a].IsRequired&&"true"!==t["consent_"+e.Consents[a].ConsentId]&&o.push({Id:e.Consents[a].ConsentId,Name:e.Consents[a].Title,Message:e.Consents[a].Title+" consent is required"});e.IsRequiredAtleastOne&&!i&&o.push({Id:e.GroupId,Name:e.Title,Message:"In "+e.Title+" group at least one consent is required"})}return o},D.isValidToken=function(e,t){return!!e||(t([D.setMappedMessage(y.tokenValid)]),!1)},D.decodeHtml=function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value},D.checkForLatestPrivacyPolicy=function(e){for(var t=A.options.privacyPolicyConfiguration.PrivacyPolicies,o=(new Date).getTime(),n={},i=0;i<t.length;i++)new Date(t[i].StartDateTime).getTime()<o&&(A.util.isEmpty(n)||!A.util.isEmpty(n)&&new Date(n.StartDateTime).getTime()<new Date(t[i].StartDateTime).getTime())&&(n=t[i]);return n.Version===e.PrivacyPolicy.Version},D.sanitizePinData=function(e){var t=Object.assign({},e),e={PIN:"",Skipped:null};return t.hasOwnProperty("pin")&&t.pin?e.PIN=t.pin:e.Skipped=!0,delete t.pin,t.PINInfo=e,t},D.sanitizeSecurityQuesData=function(e){var t,o=A.util.parseQueryString(e),n={},i=["email","username","phone","password","pin","phoneApi"];for(t in o)-1===i.indexOf(t)&&(n[t]=o[t],delete o[t]);return o.securityanswer=n,o},D.loadQRCodeScript=function(e){var t;A.options.isCrossDeviceSSOEnabled&&((t=document.createElement("script")).src=LoginRadiusDefaults.externalLibrary+"qrcode.js",t.type="text/javascript",t.onload=function(){e()},document.getElementsByTagName("head")[0].appendChild(t))},D.resendOTPHandler=function(t){var e,o;"update2FANumberResendOTP"===t.action?(e=A.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),(o=A.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))&&!A.LRCheckLogin?A.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apiKey="+A.options.apiKey+"&access_token="+o+"&smsTemplate="+t.smstemplate,t.data,function(e){e.ErrorCode?t.onerror(D.loginRadiusErrorTojsError(e)):t.onsuccess(e,t.data)},"updatePhone"):e?A.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/?apiKey="+A.options.apiKey+"&SecondFactorAuthenticationToken="+e+"&smsTemplate2FA="+t.smstemplate,t.data,function(e){e.ErrorCode?t.onerror(D.loginRadiusErrorTojsError(e)):t.onsuccess(e,t.data)},"login"):t.onerror([D.setMappedMessage(y.twofaTokenValid)])):"smartLoginResendOTP"===t.action?A.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/otp?apiKey="+A.options.apiKey+"&phone="+t.data+"&smsTemplate="+t.smstemplate,"",function(e){e.ErrorCode?t.onerror(D.loginRadiusErrorTojsError(e)):t.onsuccess(e)},"loginOTP"):"sendInstantSignInResendOtp"===t.action&&A.util.ajaxCall("GET",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/otp?apiKey="+A.options.apiKey+"&"+t.data+"&smsTemplate="+t.smstemplate,"",function(e){e.ErrorCode?t.onerror(D.loginRadiusErrorTojsError(e)):t.onsuccess(e)},"passwordlessLogin")},D.addResendOTPBtn=function(r,s,l){A.$hooks.register("afterFormRender",function(e,t,o,n){var i,a;r&&n&&"loginradius-twofaemailotp"===n.name&&(A.util.findInSchema(n,"id","loginradius-button-resendotp")||(i=A.util.getButtonAttribute("resendotp",o,function(e){A.options.disableResendOTPButton&&A.util.disableResendOTPButton(e),O.sendMFAEmailOTPController({EmailId:n[1].value},s,l,t,o,"resend")}),(a=A.util.findInSchema(n,"type","submit"))?a.parentNode.insertBefore(i,a.nextSibling):n.appendChild(i)))})}}function LoginRadiusControllers(P,R){var h=LoginRadiusDefaults.messages,E=this;function i(e,t,o,n,i){t?P.util.ajaxCall(e,LoginRadiusDefaults.apiDomain+"/auth/customobject/"+o+"?apiKey="+P.options.apiKey+"&access_token="+t+"&objectname="+P.options.customObjectName,"",function(e){e.ErrorCode?i(R.loginRadiusErrorTojsError(e)):n(e)},"CustomObject"):i([R.setMappedMessage(h.twofaTokenValid)])}E.handleFeatures=function(e,t,o,n,i,a,r){var s,l,u,c,p=e.Profile;"string"!=typeof t&&(t=P.util.jsonToQueryString(t)),n&&P.options.periodicPasswordReset&&p.PasswordExpirationDate&&new Date(p.PasswordExpirationDate)<=new Date?(R.setPasswordRule(P.changePasswordFormSchema[1]),R.setPasswordRule(P.changePasswordFormSchema[2]),n(p,e)):o&&(P.options.askRequiredFieldForTraditionalLogin||LoginRadiusDefaults.autoFilledFieldforPasswordLesLogin||P.askPinOnLogin)?(s=p,l=t,u=o,c=i,n=a,P.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,(p=e).access_token),P.options.isPINAuthentication&&P.options.PINConfiguration.PINLogin&&p&&p.session_token&&P.setSessionToken(p),o=P.options,o=(o=JSON.parse(JSON.stringify(o))).RegistrationFormSchema,s.IsDeleted?n(R.loginRadiusErrorTojsError(s)):(P.options.autoFilledFieldForTraditional&&P.$hooks.register("beforeFormRender",function(e,t){"loginRequiredFieldsUpdate"===e&&((e=P.util.findInSchema(t,"name","emailid"))&&e.value&&(e.disabled=!0),(t=P.util.findInSchema(t,"name","phoneid"))&&t.value&&(t.disabled=!0))}),P.registrationFormSchema=R.mapSchema(o,s,P.options.autoFilledFieldForTraditional),0<P.registrationFormSchema.length?(R.setPasswordRule(P.util.findInSchema(o,"name","password")),R.setPasswordRule(P.util.findInSchema(o,"name","confirmpassword")),P.$hooks.call("registrationSchemaFilter",o,s),u(s,p,p.access_token,l,c,n)):R.loginHandleToken(p,l,c,n))):R.loginHandleToken(e,t,i,a,r)},E.verifyOTPController=function(t,e,o,n,i,a){var r=LoginRadiusDefaults.apiDomain+"/auth/phone/otp?apiKey="+P.options.apiKey+"&otp="+t.otp+"&smsTemplate="+P.options.smsTemplateWelcome;t.haveToken&&(r+="&access_token="+P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName)),t.onetouchloginflag&&(r=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/phone/verify?apiKey="+P.options.apiKey+"&otp="+t.otp+"&smsTemplate="+P.options.smsTemplateOneTouchLoginWelcome),P.util.ajaxCall("put",r,e,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):t.onetouchloginflag&&!P.options.askRequiredFieldsOnPasswordLessLogin?R.loginHandleToken(e,"",o,n,"",!0):e.access_token?(LoginRadiusDefaults.autoFilledFieldforPasswordLesLogin=!0,E.handleFeatures(e,t,a,i,o,n)):o(e,t)},"verifyOTP")},E.updateSecurityQuestionController=function(e,t,o){for(var n=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),i=P.util.parseQueryString(e),a=0;a<P.options.securityQuestionsCount;a++)i[i["securityQuestion"+a]]=i["securityAnswer"+a],delete i["securityQuestion"+a],delete i["securityAnswer"+a];e={SecurityQuestionAnswer:i};R.isValidToken(n,o)&&P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account?apikey="+P.options.apiKey+"&access_token="+n,e,function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"updateSecurityQuestion")},E.resetTwoFactorAuthenticationController=function(t,o,n){var e,i=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),a={};a[t]=!0,R.isValidToken(i,n)&&(e="/auth/account/2FA/authenticator","emailotpauthenticator"===t?(e="/auth/account/2fa/authenticator/otp/email",a={}):"sqauthenticator"===t&&(e="/auth/account/2fa/authenticator/securityquestionanswer",a={}),P.util.ajaxCall("delete",LoginRadiusDefaults.apiDomain+e+"?apikey="+P.options.apiKey+"&access_token="+i,a,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e,t)},"resetTwoFactorAuthentication"))},E.forgotPasswordController=function(o,n,i,a,r){var e=P.options.forgotPasswordUrl||P.options.resetPasswordUrl;P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/password?apiKey="+P.options.apiKey+"&resetPasswordUrl="+e+"&emailTemplate="+P.options.resetPasswordEmailTemplate,o,function(e){var t;e.ErrorCode?a(R.loginRadiusErrorTojsError(e)):(t=P.util.parseQueryString(o),i(e,t),P.options.otpEmailVerification&&!P.options.verifyEmailByOTP&&R.resetPassword(n,i,a,r,t))},"forgotPassword")},E.forgotPINController=function(o,n,i,a,r){var e=P.util.parseQueryString(o).hasOwnProperty("username")?"username":"email",t=P.options.forgotPINUrl||P.options.resetPINUrl;P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/pin/forgot/"+e+"?apiKey="+P.options.apiKey+"&resetPINUrl="+t+"&emailTemplate="+P.options.resetPINEmailTemplate,o,function(e){var t;e.ErrorCode?a(R.loginRadiusErrorTojsError(e)):(t=P.util.parseQueryString(o),i(e,t),P.options.otpEmailVerification&&!P.options.verifyEmailByOTP&&R.resetPIN(n,i,a,r,t))},"forgotPIN")},E.loginController=function(o,n,i,a,r,s,l,u,c){P.options.verificationEmailTemplate=P.options.emailTemplate||P.options.verificationEmailTemplate;var e="emailTemplate="+P.options.verificationEmailTemplate+"&verificationUrl="+P.options.verificationUrl;P.options.phoneLogin&&(e+="&smsTemplate="+P.options.smsTemplatePhoneVerification),P.options.riskBasedAuthentication&&(e+="&RbaOneclickEmailTemplate="+P.options.rbaOneclickEmailTemplate+"&RbaOTPSmsTemplate="+P.options.rbaOTPSmsTemplate+"&RbaCityEmailTemplate="+P.options.rbaCityEmailTemplate+"&RbaCountryEmailTemplate="+P.options.rbaCountryEmailTemplate+"&RbaBrowserEmailTemplate="+P.options.rbaBrowserEmailTemplate+"&RbaIpEmailTemplate="+P.options.rbaIpEmailTemplate+"&RbaCitySmsTemplate="+P.options.rbaCitySmsTemplate+"&RbaCountrySmsTemplate="+P.options.rbaCountrySmsTemplate,e+="&RbaBrowserSmsTemplate="+P.options.rbaBrowserSmsTemplate+"&RbaIpSmsTemplate="+P.options.rbaIpSmsTemplate),("string"==typeof(o=P.util.checkPhoneOrEmailLogin(o))||o instanceof String)&&(o=P.util.parseQueryString(o)),P.options.duplicateEmailWithUniqueUsername&&(delete o.email,delete o.phoneid);e=LoginRadiusDefaults.apiDomain+"/auth/login?apiKey="+P.options.apiKey+"&loginUrl="+P.options.loginUrl+"&"+e;o["g-recaptcha-response"]&&(e+="&g-recaptcha-response="+o["g-recaptcha-response"],delete o["g-recaptcha-response"]),o.qq_captcha_randstr&&(e+="&qq_captcha_randstr="+o.qq_captcha_randstr,delete o.qq_captcha_randstr),o.qq_captcha_ticket&&(e+="&qq_captcha_ticket="+o.qq_captcha_ticket,delete o.qq_captcha_ticket),P.util.ajaxCall("post",e,o,function(e){var t;P.options.stayLogin&&P.storage.setBrowserStorage("lr-rememberme",o.stayLogin),e.ErrorCode?("970"==e.ErrorCode&&P.options.otpEmailVerification&&!P.options.verifyEmailByOTP?R.otpEmailVerification(n,i,a,l,o):"1167"==e.ErrorCode&&(e.PhoneId||o.phone)?(delete o.email,o.phone=e.PhoneId||o.phone,E.loginOTPController(o,n,i,a,l,"no")):P.options.phoneLogin&&"1066"==e.ErrorCode&&(R.verifyOTP=u||R.verifyOTP,R.resendOTP=c||R.resendOTP,R.verifyOTP(o,n,i,a,l,r,s),R.resendOTP(o,n,i,a,l,r,s)),a(R.loginRadiusErrorTojsError(e))):(P.askPinOnLogin=!1,t=e.Profile,P.options.isPINAuthentication&&t&&(P.options.PINConfiguration.AskOnlyOnFirstLogin&&t.FirstLogin||P.options.PINConfiguration.AskOnLogin)&&(null!==t.PIN&&t.PIN.PIN||(P.askPinOnLogin=!0)),E.handleFeatures(e,o,s,r,i,a,l))},"login")},E.loginOTPController=function(e,o,n,i,a,t){var r,s,l=e=P.util.checkPhoneOrEmailLogin(e);(l="string"==typeof e||e instanceof String?P.util.parseQueryString(e):l).email||l.username?R.sendInstantSignInLink(e,n,i,o,a):(r=P.options.smsTemplateInstantOTPLogin||P.options.passwordlessLoginSMSTemplate,P.$hooks.register("beforeFormRender",function(e,t){P.util.findInSchema(t,"name","resendotp")||t.push({type:"button",name:"resendotp",display:"Resend Verification Code",rules:"",permission:"r",event:"click",eventCallback:function(e){P.options.disableResendOTPButton&&P.util.disableResendOTPButton(e);e={data:l.phone,onsuccess:n,onerror:i,smstemplate:r,action:"smartLoginResendOTP"};R.resendOTPHandler(e)}})}),s=function(){var e=P.otpSchema;R.createForm(e,"otp",o,function(e){var t=a+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp";E.verifyInstantOTP(e,l,n,i,t,o,a)},function(e){i(R.setMappedMessage(e))},a)},t?s():P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/otp?apiKey="+P.options.apiKey+"&phone="+l.phone+"&smsTemplate="+r,"",function(e){e.ErrorCode?i(R.loginRadiusErrorTojsError(e)):(n(e),s())},"loginOTP"))},E.loginPINController=function(t,e,o,n,i,a,r,s){P.options.verificationEmailTemplate=P.options.emailTemplate||P.options.verificationEmailTemplate,("string"==typeof t||t instanceof String)&&(t=P.util.parseQueryString(t));s=LoginRadiusDefaults.apiDomain+"/auth/login/pin?apiKey="+P.options.apiKey+"&session_token="+s;P.util.ajaxCall("post",s,t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):E.handleFeatures(e,t,r,a,o,n,i)},"login")},E.login2FAController=function(o,m,g,f,h,y,v,C,T,w){P.LRCheck2FA=!0,o=P.util.checkPhoneOrEmailLogin(o);var S=!1,L=!1,k=function(s,e){var t=e.IsOTPAuthenticatorVerified||"",o=e.IsGoogleAuthenticatorVerified||"",n=e.IsEmailOtpAuthenticatorVerified||"",i=e.IsSecurityQuestionAuthenticatorVerified||"";null!==e.EmailOTPStatus||t||o||i||(L=!0),P.$hooks.register("afterFormRender",function(e,t,o,n){n&&P.LRCheck2FA&&(P.util.findInSchema(n,"id","loginradius-button-backupcodebackbutton")||(o=P.util.getButtonAttribute("backupcodebackbutton",o,function(){L=!0,k(s,s.SecondFactorAuthentication)}),n.appendChild(o)))});var a,r,l,u,c=P.util.getButtonAttribute("otpauthenticator",h),p=!1,d=P.options.authenticatorOptionsOrder;for(a in d)d[a]&&("emailotp"===d[a]?function(){var a,r,e;P.options.emailOTPAuthentication&&(!o&&!t&&!i&&P.options.twoFactorAuthentication||n)&&s.SecondFactorAuthentication&&s.SecondFactorAuthentication.Email&&s.SecondFactorAuthentication.Email.length&&(S=!0,(a=s.SecondFactorAuthentication.Email)&&(r=function(e){R.addResendOTPBtn(S,g,f),L||i||o||t?E.sendMFAEmailOTPController({EmailId:e},g,f,m,h):R.verifyOTP({mfaEmailToken:!0,EmailId:e},m,g,f,h)},LoginRadiusDefaults.innerHTML=!0,e=P.util.getButtonAttribute("emailotp",h,function(e){if(1<a.length){LoginRadiusDefaults.innerHTML=!1;for(var t,o=[],n=0;n<a.length;n++)a[n]&&((t={}).text=a[n],t.value=a[n],o.push(t));var i={type:"option"};i.options=o,i.name="sendemailotp",i.rules="required",i.display="Select email to send verification code",R.createForm([i],"mfaselectemails",m,function(e){e=P.util.parseQueryString(e),r(e.sendemailotp)})}else s.SecondFactorAuthentication.Email&&s.SecondFactorAuthentication.Email[0]&&r(s.SecondFactorAuthentication.Email[0])}),P.util.addHTMLContent(m,e,p),p=!0))}():"sms"===d[a]?(l=void 0,i||n||t||o||!P.options.twoFactorAuthentication?(i||o||n||!P.options.twoFactorAuthentication)&&(!P.options.optionalTwoFactorAuthentication||t||i||o||n||""===s.SecondFactorAuthentication.OTPPhoneNo||null==s.SecondFactorAuthentication.OTPPhoneNo)&&!t||(h=h||LoginRadiusDefaults.classPrefix,l=document.getElementsByName(h+"showQRcode")[0],P.options.googleAuthentication&&l?l.appendChild(c):(P.util.addHTMLContent(m,c,p),p=!0)):P.options.googleAuthentication||P.options.emailOTPAuthentication||P.options.securityQuestionAuthentication?(u=P.util.getButtonAttribute("otpauthenticator",h,function(){LoginRadiusDefaults.innerHTML=!1,R.updatePhoneNumber=C||R.updatePhoneNumber,R.updatePhoneNumber(m,g,f,h,"",y,v)}),P.util.addHTMLContent(m,u,p),p=!0):(R.updatePhoneNumber=C||R.updatePhoneNumber,R.updatePhoneNumber(m,g,f,h,"",y,v))):"securityquestion"===d[a]?P.options.securityQuestionAuthentication&&(!n&&!o&&!t&&P.options.twoFactorAuthentication||i)&&(r=P.util.getButtonAttribute("securityquestionsauthenticator",h,function(){LoginRadiusDefaults.innerHTML=!1,R.showMFASecurityQuestions(s.SecondFactorAuthentication,m,g,f,h,y,v)}),P.util.addHTMLContent(m,r,p),p=!0):"googleauth"===d[a]&&(P.options.googleAuthentication&&(!n&&!t&&!i&&P.options.twoFactorAuthentication||o)&&(r=P.util.getButtonAttribute("googleauthenticator",h,function(){LoginRadiusDefaults.innerHTML=!1,R.showQRCode(s,m,g,f,h,y,v)}),P.util.addHTMLContent(m,r,p),p=!0)));(i||n||t||o)&&(e=P.util.getButtonAttribute("backupcodebutton",h),P.util.addHTMLContent(m,e,p),P.util.addEvent("click",e,function(e){var t,o,n,i,a;LoginRadiusDefaults.innerHTML=!1,t=g,o=f,n=h,i=y,a=v,R.createForm(P.backupCodeFormSchema,"backupcode",m,function(e){E.backupCodeController(e,t,o,i,a)},function(e){o(e)},n)})),P.util.addEvent("click",c,function(e){var t="phoneNo2FA="+s.SecondFactorAuthentication.OTPPhoneNo;LoginRadiusDefaults.innerHTML=!1,S=!1,(i||o||n||L)&&R.resendOTPManually(t,m,g,f,h,y,v),s.phone=s.SecondFactorAuthentication.OTPPhoneNo,R.verifyOTP=T||R.verifyOTP,R.resendOTP=w||R.resendOTP,R.verifyOTP(s,m,g,f,h,y,v),R.resendOTP(s,m,g,f,h,y,v)})},e=LoginRadiusDefaults.apiDomain+"/auth/login/2FA/";P.options.verificationEmailTemplate=P.options.emailTemplate||P.options.verificationEmailTemplate;var t="post",n=window.lrbackupcode?(e=e+"backupcode?apiKey="+P.options.apiKey+"&"+o,t="get",""):(e=e+"?apiKey="+P.options.apiKey+"&loginUrl="+P.options.loginUrl+"&emailTemplate="+P.options.verificationEmailTemplate+"&verificationUrl="+P.options.verificationUrl+"&smsTemplate="+P.options.smsTemplateWelcome+"&smsTemplate2FA="+P.options.smsTemplate2FA+"&EmailTemplate2FA="+P.options.EmailTemplate2FA,P.util.parseQueryString(o));P.util.ajaxCall(t,e,n,function(e){var t;P.options.stayLogin&&P.storage.setBrowserStorage("lr-rememberme",P.util.getQueryParameterByName("stayLogin",o)),e.ErrorCode?(P.options.phoneLogin&&"1066"==e.ErrorCode&&(t="phone="+P.util.getQueryParameterByName("phone",o),t+="&noPhoneVerified=false",P.options.optionalTwoFactorAuthentication=!1,P.options.twoFactorAuthentication=!1,R.verifyOTP=T||R.verifyOTP,R.resendOTP=w||R.resendOTP,R.verifyOTP(t,m,g,f,h,y,v),R.resendOTP(t,m,g,f,h,y,v)),f(R.loginRadiusErrorTojsError(e))):(e.SecondFactorAuthentication?(P.storage.setBrowserStorage(LoginRadiusDefaults.storedTwoFAToken,e.SecondFactorAuthentication.SecondFactorAuthenticationToken),P.storage.setBrowserStorage(LoginRadiusDefaults.storedOTPAuth,e.SecondFactorAuthentication.IsOTPAuthenticatorVerified),"00000000-0000-0000-0000-000000000000"===e.access_token&&(k(e,e.SecondFactorAuthentication),delete e.access_token,g(e,o))):E.handleFeatures(e,o,v,y,g,f,h),P.lrApiFramework&&g(e))},"login")},E.resendOTPController=function(e,t,o,n,i,a){var r=e.updatePhone?P.options.smsTemplateUpdatePhone:P.options.smsTemplatePhoneVerification,s=LoginRadiusDefaults.apiDomain+"/auth/phone/otp?apiKey="+P.options.apiKey+"&smsTemplate="+r,r="post";e.onetouchloginflag&&(r="get","string"!=typeof e&&(e=P.util.jsonToQueryString(e)),s=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/phone?apikey="+P.options.apiKey+"&"+e+"&smstemplate="+P.options.smsTemplatePhoneVerification),P.util.ajaxCall(r,s,e,function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):(P.log(h.otpSent),t(e))},"resendOTP")},E.resendOTP2FAController=function(e,t,o,n,i,a){var r=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),s=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);s&&!P.LRCheckLogin?P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apiKey="+P.options.apiKey+"&access_token="+s+"&smsTemplate="+P.options.smsTemplate2FA,e,function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):(P.log(h.otpSent),t(e))},"resendOTP"):r?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/resend?apiKey="+P.options.apiKey+"&SecondFactorAuthenticationToken="+r+"&smsTemplate2FA="+P.options.smsTemplate2FA,"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):P.log(h.otpSent)},"resendOTP"):o([R.setMappedMessage(h.twofaTokenValid)])},E.verify2FAOTPController=function(t,o,n,i,a){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),r=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),s="",l=!1,u=(l=t&&"string"==typeof t?-1!==t.indexOf("mfaEmailToken=true"):l)?"twofaemailotp":"twofaotp",c=l?"put":"get",p="";"put"==c&&(s=P.util.parseQueryString(t)).email&&(s.emailid=s.email,delete s.email),e&&!P.LRCheckLogin?(p=LoginRadiusDefaults.apiDomain+(l?"/auth/account/2fa/verification/otp/email?apiKey="+P.options.apiKey+"&access_token="+e:"/auth/account/2FA/Verification?apiKey="+P.options.apiKey+"&access_token="+e+"&"+t+"&smsTemplate="+P.options.smsTemplate2FAWelcome),P.util.ajaxCall(c,p,s,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e,t)},"verifyOTP##"+u)):r?(p=LoginRadiusDefaults.apiDomain+(l?"/auth/login/2fa/verification/otp/email?apiKey="+P.options.apiKey+"&SecondFactorAuthenticationToken="+r:"/auth/login/2FA/Verification?apiKey="+P.options.apiKey+"&SecondFactorAuthenticationToken="+r+"&"+t+"&smsTemplate2FA="+P.options.smsTemplate2FAWelcome),t&&-1!==t.indexOf("googleAuthenticatorCode")&&(u="showqrcode"),P.util.ajaxCall(c,p,s,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):E.handleFeatures(e,t,a,i,o,n)},"verifyOTP##"+u)):n([R.setMappedMessage(h.twofaTokenValid)])},E.backupCodeController=function(t,o,n,i,a){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken);e?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/backupcode?apiKey="+P.options.apiKey+"&SecondFactorAuthenticationToken="+e+"&"+t+"&smsTemplate2FA="+P.options.smsTemplate2FAWelcome,"",function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):E.handleFeatures(e,t,a,i,o,n)},"login"):n([R.setMappedMessage(h.twofaTokenValid)])},E.checkPhoneNumberAvailabilityController=function(e,t,o){P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/phone?apiKey="+P.options.apiKey+"&"+e,"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"checkPhone")},E.update2FAPhoneNumberController=function(t,o,n,i,a,r,s,l,u){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),c=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);c&&!P.LRCheckLogin?P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apiKey="+P.options.apiKey+"&access_token="+c+"&smsTemplate="+P.options.smsTemplate2FA,t,function(e){e.ErrorCode?i(R.loginRadiusErrorTojsError(e)):(R.verifyOTP=l||R.verifyOTP,R.resendOTP=u||R.resendOTP,R.verifyOTP(t,o,n,i,a,r,s),R.resendOTP(t,o,n,i,a,r,s),n(e,t))},"updatePhone"):e?P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/?apiKey="+P.options.apiKey+"&SecondFactorAuthenticationToken="+e+"&smsTemplate2FA="+P.options.smsTemplate2FA,t,function(e){e.ErrorCode?i(R.loginRadiusErrorTojsError(e)):(n(e,t),R.verifyOTP=l||R.verifyOTP,R.resendOTP=u||R.resendOTP,R.verifyOTP(t,o,n,i,a,r,s),R.resendOTP(t,o,n,i,a,r,s))},"login"):i([R.setMappedMessage(h.twofaTokenValid)])},E.updatePhoneNumberController=function(t,o,n,i,a,r,s,l,u){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);R.isValidToken(e,i)&&P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/phone?apiKey="+P.options.apiKey+"&access_token="+e+"&smsTemplate="+P.options.smsTemplateUpdatePhone,t,function(e){e.ErrorCode?i(R.loginRadiusErrorTojsError(e)):(R.verifyOTP=l||R.verifyOTP,R.resendOTP=u||R.resendOTP,R.verifyOTP(t+"&haveToken=true",o,n,i,a,r,s),R.resendOTP(t+"&updatePhone=true",o,n,i,a,r,s,!0),n(e,t))},"updatePhone")},E.resetPasswordByPhoneController=function(t,o,n,e,i){P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/otp?apiKey="+P.options.apiKey+"&smsTemplate="+P.options.smsTemplateWelcome,t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e,t)},"resetPassword")},E.resetPINByPhoneController=function(t,o,n,e,i){P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/pin/reset/otp/phone?apiKey="+P.options.apiKey+"&smsTemplate="+P.options.smsTemplateWelcome,t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e,t)},"resetPIN")},E.forgotPasswordbyPhoneController=function(t,o,n,i,a,r){P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/password/otp?apiKey="+P.options.apiKey+"&smsTemplate="+P.options.smsTemplateForgot,t,function(e){e.ErrorCode?i(R.loginRadiusErrorTojsError(e)):(n(e,t),(r||R.resetPassword)(o,n,i,a))},"forgotPassword")},E.forgotPINbyPhoneController=function(t,o,n,i,a,r){P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/pin/forgot/otp?apiKey="+P.options.apiKey+"&smsTemplate="+P.options.smsTemplateForgot,t,function(e){e.ErrorCode?i(R.loginRadiusErrorTojsError(e)):(n(e,t),(r||R.resetPIN)(o,n,i,a))},"forgotPIN")},E.registrationController=function(n,i,a,r,s,e,l,u){P.LRCheckRegistration=!0;var t=n;P.lrApiFramework||(t=R.mapRegistrationSchema(e,n));var o="emailTemplate="+P.options.verificationEmailTemplate+"&verificationUrl="+P.options.verificationUrl+"&welcomeEmailTemplate="+P.options.welcomeEmailTemplate;P.options.phoneLogin&&(o+="&smsTemplate="+P.options.smsTemplatePhoneVerification),P.options.preventVerificationEmail&&(o+="&options=PreventVerificationEmail");e="";P.options.invisibleRecaptcha||P.options.v2Recaptcha||P.options.tencentCaptcha?e=LoginRadiusDefaults.apiDomain+"/auth/register/captcha?apiKey="+P.options.apiKey+"&"+o:P.options.sott?(e=LoginRadiusDefaults.apiDomain+"/auth/register?apiKey="+P.options.apiKey+"&"+o,P.options.enableHeaderSott?(P.options.sott=decodeURIComponent(P.options.sott),t.sottcheck=!0):e+="&sott="+P.util.encodedString(P.options.sott)):P.options.vNextUX?P.log("SOTT commonOption is missing in configuration. You can use a static SOTT generated from Admin Console or create it at run-time using the API. For more details on SOTT generation, please refer to https://www.loginradius.com/docs/api/v2/customer-identity-api/sott-usage/."):P.log("url is not set as sott option is not defined"),""!==e&&P.util.ajaxCall("post",e,t,function(t){var o,e;(t=t&&P.util.isObject(t)?P.util.keyslowerToUpperCamelCase(t):t).ErrorCode?1049===t.ErrorCode?(P.options.vNextUX&&(h.invalidSott="An error occurred, please refresh the page to proceed with registration."),r([R.setMappedMessage(h.invalidSott)]),P.log(t.Description)):r(R.loginRadiusErrorTojsError(t)):(o=function(e){e.push({type:"button",name:"skip",display:"Skip",rules:"",permission:"r",event:"click",eventCallback:function(e){R.loginHandleToken(t,n,a,r)}})},P.options.phoneLogin&&("string"==typeof n||n instanceof String)&&-1!==n.indexOf("phoneid")?(-1===P.util.findInSchema(P.registrationFormSchema,"name","phoneid").rules.indexOf("required")&&P.$hooks.register("beforeFormRender",function(e,t){"otp"!==e||P.util.findInSchema(t,"name","skip")||o(t)}),R.verifyOTP=l||R.verifyOTP,R.resendOTP=u||R.resendOTP,R.verifyOTP(n,i,a,r,s),R.resendOTP(n,i,a,r,s)):(e=P.util.parseQueryString(n),P.options.disabledEmailVerification||P.options.optionalEmailVerification?(t.Data&&(delete(t=t.Data).Data,delete t.IsPosted),P.options.askRequiredFieldForTraditionalLogin=!1,P.options.disabledEmailVerification||!P.options.otpEmailVerification||P.options.verifyEmailByOTP?R.loginHandleToken(t,n,a,r):(P.$hooks.register("beforeFormRender",function(e,t){"otp"!==e||P.util.findInSchema(t,"name","skip")||o(t)}),R.otpEmailVerification(i,function(e){e.access_token||R.loginHandleToken(t,n,a,r)},r,s,e))):(a(t,e),P.options.otpEmailVerification&&!P.options.verifyEmailByOTP&&R.otpEmailVerification(i,a,r,s,e))))},"registration")},E.periodicalPasswordRestController=function(e,t,o,n,i,a){P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/change?apiKey="+P.options.apiKey+"&access_token="+i.access_token,e,function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):R.loginHandleToken(i,a,t,o)},"periodicPassword")},E.changePasswordController=function(t,o,n){P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/change?apiKey="+P.options.apiKey+"&access_token="+P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e,P.util.parseQueryString(t))},"changePassword")},E.changePINController=function(t,o,n){P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/pin/change?apiKey="+P.options.apiKey+"&access_token="+P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e,P.util.parseQueryString(t))},"changePIN")},E.resendEmailVerificationController=function(t,o,n){P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/register?apiKey="+P.options.apiKey+"&verificationUrl="+P.options.verificationUrl+"&emailTemplate="+P.options.verificationEmailTemplate,t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e,P.util.parseQueryString(t))},"resendVerificationEmail")},E.addEmailController=function(t,o,n){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);R.isValidToken(e,n)&&P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+P.options.apiKey+"&access_token="+e+"&verificationUrl="+P.options.verificationUrl+"&emailTemplate="+P.options.addEmailTemplate,t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):(o(e,P.util.parseQueryString(t)),P.options.otpEmailVerification&&!P.options.verifyEmailByOTP&&R.otpEmailVerification(P.currentLRContainer,o,n,"",t))},"addEmail")},E.removeEmailController=function(t,o,n){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);R.isValidToken(e,n)&&P.util.ajaxCall("delete",LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+P.options.apiKey+"&access_token="+e,t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e,P.util.parseQueryString(t))},"removeEmail")},E.changeUsernameController=function(t,o,n){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);R.isValidToken(e,n)&&P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/username?apiKey="+P.options.apiKey+"&access_token="+e,t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e,P.util.parseQueryString(t))},"changeUsername")},E.resetPasswordController=function(t,o,n,e,i){t+="&welcomeEmailTemplate="+P.options.welcomeEmailTemplate+"&ResetPasswordEmailTemplate="+P.options.resetPasswordConfirmationEmailTemplate,P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/reset?apiKey="+P.options.apiKey,t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e,P.util.parseQueryString(t))},"resetPassword")},E.resetPINController=function(t,o,n,e,i){var a=P.util.parseQueryString(t),r=a.hasOwnProperty("resettoken")?LoginRadiusDefaults.apiDomain+"/auth/pin/reset/token?apiKey="+P.options.apiKey:(a=a.hasOwnProperty("username")?"username":"email",LoginRadiusDefaults.apiDomain+"/auth/pin/reset/otp/"+a+"?apiKey="+P.options.apiKey);t+="&welcomeEmailTemplate="+P.options.welcomeEmailTemplate+"&ResetPINEmailTemplate="+P.options.resetPINConfirmationEmailTemplate,P.util.ajaxCall("put",r,t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e,P.util.parseQueryString(t))},"resetPIN")},E.emailVerificationController=function(e,t,o,n,i,a){var r,s,l="get";e?(r=LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+P.options.apiKey+"&welcomeEmailTemplate="+P.options.welcomeEmailTemplate,s="",a?(l="put",s=e):r+="&verificationtoken="+e+"&url="+P.options.verificationUrl,(e="##otp")===(e=P.options.verifyEmailByOTP?"":e)&&(P.currentActionOptions||(P.currentActionOptions={}),P.currentActionOptions.otp={},P.currentActionOptions.otp.onSuccess=t||function(){},P.currentActionOptions.otp.onError=o||function(){},P.currentActionOptions.otp.classPrefix=i||""),P.util.ajaxCall(l,r,s,function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):P.options.loginOnEmailVerification?null==e.Data?t(e):e.Data&&e.Data.access_token?R.loginHandleToken(e.Data,"",t,o):e.Data&&t(e):P.options.logoutOnVerifyEmail?R.logout(t(e)):t(e)},"verifyEmail"+e)):o(a?[h.notFound]:[h.vTokenError])},E.deleteUserConfirmController=function(e,t,o){e?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/delete?apiKey="+P.options.apiKey+"&deletetoken="+e,"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"deleteUserConfirm"):o([h.vTokenError])},E.checkEmailAvailabilityController=function(e,t,o){P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+P.options.apiKey+"&"+e,"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"checkEmail")},E.checkUserNameAvailabilityController=function(e,t,o){P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/username?apiKey="+P.options.apiKey+"&"+e,"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"checkUsername")},E.resetPasswordBySecurityQuestionController=function(t,o,n){var e=R.sanitizeSecurityQuesData(t);P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/securityanswer/?apikey="+P.options.apiKey,e,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e,t)},"resetPasswordBySecurityQuestion")},E.resetPINBySecurityQuestionController=function(t,o,n){var e=R.sanitizeSecurityQuesData(t),i=e.hasOwnProperty("email")?"email":e.hasOwnProperty("phone")?"phone":"username";P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/pin/reset/securityanswer/"+i+"?apikey="+P.options.apiKey,e,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e,t)},"resetPINBySecurityQuestion")},E.getSecurityQuestionsController=function(e,t,o){var n="/auth/securityquestion/";-1!==e.indexOf("username")?n+="username?apiKey=":-1!==e.indexOf("phone")?n+="phone?apiKey=":n+="email?apiKey=",P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+n+P.options.apiKey+"&"+e,"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(function(e){for(var t=[],o=0;o<e.length;o++){var n={};P.options.maskSensitiveInput?n.type="password":n.type="string",n.name=e[o].QuestionId,n.display=e[o].Question,n.rules="required",n.permission="r",t.push(n)}return t}(e))},"securityQuestion")},E.getBackupCodeController=function(e,t,o){e?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA/backupcode?apikey="+P.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"backupCode"):o([R.setMappedMessage(h.twofaTokenValid)])},E.resetBackupCodeController=function(e,t,o){e?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA/backupcode/reset?apikey="+P.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"backupCode"):o([R.setMappedMessage(h.twofaTokenValid)])},E.getSocialDataController=function(e,t,o,n,i){e?(n+="?access_token="+e,P.util.ajaxCall("get",LoginRadiusDefaults.socialApiDomain+(n=i?n+"&"+i:n),"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"socialAPI")):o([R.setMappedMessage(h.twofaTokenValid)])},E.postSocialDataController=function(e,t,o,n,i,a){e?(n+="?access_token="+e,P.util.ajaxCall("post",LoginRadiusDefaults.socialApiDomain+(n=i?n+"&"+i:n),a,function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"socialAPI")):o([R.setMappedMessage(h.twofaTokenValid)])},E.createCustomObjectController=function(e,t,o,n){e?P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/customobject?apiKey="+P.options.apiKey+"&access_token="+e+"&objectname="+P.options.customObjectName,t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e)},"createCustomObject"):n([R.setMappedMessage(h.twofaTokenValid)])},E.getCustomObjectByIdController=function(e,t,o,n){i("get",e,t,o,n)},E.getCustomObjectsController=function(e,t,o){e?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/customobject?apiKey="+P.options.apiKey+"&access_token="+e+"&objectname="+P.options.customObjectName,"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"getCustomObject"):o([R.setMappedMessage(h.twofaTokenValid)])},E.updateCustomObjectController=function(e,t,o,n,i,a){e?P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/customobject/"+t+"?apiKey="+P.options.apiKey+"&access_token="+e+"&objectname="+P.options.customObjectName+(n?"&updatetype="+n:""),o,function(e){e.ErrorCode?a(R.loginRadiusErrorTojsError(e)):i(e)},"updateCustomObject"):a([R.setMappedMessage(h.twofaTokenValid)])},E.deleteCustomObjectController=function(e,t,o,n){i("delete",e,t,o,n)},E.updateData=function(e,s,l,u,c,p,d,t,o){var m=e.Profile||e.Data,g=l;P.lrApiFramework||(g=R.mapRegistrationSchema(d,l,m)),P.options.isPINAuthentication&&!P.options.PINConfiguration.AskOnRegistration&&(g=R.sanitizePinData(g));var f=e.access_token;o=o||P.setHostedToken,t=t||"updateData",P.options.verificationEmailTemplate=P.options.emailTemplate||P.options.verificationEmailTemplate,0<Object.keys(g).length?P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+P.options.apiKey+"&access_token="+f+"&verificationUrl="+P.options.verificationUrl+"&emailTemplate="+P.options.verificationEmailTemplate,g,function(r){r.ErrorCode?c(R.loginRadiusErrorTojsError(r)):function(e){var t=g.emailid||g.email,o=g.phone||g.phoneid,n=P.util.findInSchema(d,"name","phoneid"),i=n&&-1!==n.rules.indexOf("required"),a=P.util.findInSchema(d,"name","emailid"),n=a&&-1!==a.rules.indexOf("required");P.storage.setBrowserStorage(LoginRadiusDefaults.storedUidName,m.Uid);a=P.util.parseQueryString(window.location.search.replace("?",""));(void 0===o||o)&&m.PhoneIdVerified&&void 0===t||(void 0===t||t)&&m.EmailVerified&&void 0===o||(o&&!i||void 0===o)&&(P.options.disabledEmailVerification||P.options.optionalEmailVerification)?t&&!m.EmailVerified&&a.return_url&&-1!==a.return_url.toLowerCase().indexOf("/saml/")?c([R.setMappedMessage(h.emailNotVerified)]):(delete r.IsPosted,r.access_token=f,e(),LoginRadiusDefaults.isSSOInitFired&&R.setToken(f)):o&&m&&!m.PhoneIdVerified?((o=new SetLoginRadiusCommonFunctions(P)).verifyOTP(l,s,u,c,p),o.resendOTP(l+"&noPhoneVerified=false",s,u,c,p)):!t||!n||m.EmailVerified||P.options.disabledEmailVerification||P.options.optionalEmailVerification?e():c([R.setMappedMessage(h.emailNotVerified)])}(o?function(){e.Data=e.Profile,delete e.Profile,r.Data&&(e.Data=r.Data),R.loginHandleToken(e,l,u,c)}:function(){r.Data&&(r.Profile=r.Data,delete r.Data,delete r.IsPosted),r.access_token?R.loginHandleToken(r,l,u,c):u(r,P.util.parseQueryString(l))})},t):R.loginHandleToken(e,l,u,c)},E.oneTouchLoginController=function(e,r,t,o,s,n){function i(o,e,n,t,i,a){R.createForm(P.registrationFormSchema,"loginRequiredFieldsUpdate",r,function(e){var t={};t.Profile=o,t.access_token=n,E.updateData(t,r,e,i,a,s,P.registrationFormSchema,"login",!0)},function(e){a(R.setMappedMessage(e))})}var a,l,u=P.util.checkPhoneOrEmailLogin(e),c=P.util.parseQueryString(u),p=n?"POST":"GET",e="";c.phone?(l=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/phone?apikey="+P.options.apiKey+"&smstemplate="+P.options.smsTemplateOneTouchLogin,n?e=Object.assign({},c):l=l+"&"+u,P.util.ajaxCall(p,l,e,function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):(R.verifyOTP(u+"&onetouchloginflag=true",r,t,o,s,"",i),R.resendOTP(u+"&onetouchloginflag=true",r,t,o,s,"",i))},"oneTouchLogin")):(a=P.util.randomString(16),l=P.options.noRegistrationEmailTemplate||P.options.onetouchLoginEmailTemplate,l=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/email?apikey="+P.options.apiKey+"&onetouchloginemailtemplate="+l+"&welcomeemailtemplate="+P.options.welcomeEmailTemplate+"&redirectUrl="+P.options.onetouchLoginRedirectUrl,n?e=Object.assign({},c,{clientGuid:a}):l=l+"&"+u+"&clientGuid="+a,P.util.ajaxCall(p,l,e,function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):e.IsPosted&&(t(e),R.pingForSmartLogin(a,function(e){P.options.askRequiredFieldsOnPasswordLessLogin?(LoginRadiusDefaults.autoFilledFieldforPasswordLesLogin=!0,E.handleFeatures(e,u,i,"",t,o)):R.loginHandleToken(e,"",t,o,"",!0)},o))},"oneTouchLogin"))},E.smartLoginController=function(e,t,o){var n=P.util.randomString(16),i=P.options.autoLoginRedirectUrl||P.options.smartLoginRedirectUrl,a=P.options.autoLoginEmailTemplate||P.options.smartLoginEmailTemplate;P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/smartlogin?apikey="+P.options.apiKey+"&"+e+"&clientGuid="+n+"&smartloginemailtemplate="+a+"&welcomeemailtemplate="+P.options.welcomeEmailTemplate+"&redirectUrl="+i,"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):e.IsPosted&&(t(e),R.pingForSmartLogin(n,function(e){R.loginHandleToken(e,"",t,o)},o))},"smartLogin")},E.verifyInstantOTP=function(t,e,o,n,i,a,r){e="phone="+e.phone+"&"+t;P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/otp/verify?apiKey="+P.options.apiKey+"&smsTemplate="+P.options.smsTemplateWelcome,e,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):R.loginHandleToken(e,t,o,n)},"login##otp")},E.socialLoginReceiveToken=function(r,s,l,u,c,p,e,t){var d,m;function o(e){var t,o,n,i,a;P.LRCheckLogin=!0,e.IsDeleted?u([R.setMappedMessage(h.blockedUser)]):((t={}).Profile=e,t.access_token=r,R.setPasswordRule(P.util.findInSchema(m,"name","password")),R.setPasswordRule(P.util.findInSchema(m,"name","confirmpassword")),i=!1,P.options.autoFilledFieldForSocial&&(i=!0,P.$hooks.register("beforeFormRender",function(e,t){"socialRegistration"===e&&((e=P.util.findInSchema(t,"name","emailid"))&&e.value&&(e.disabled=!0),(t=P.util.findInSchema(t,"name","phoneid"))&&t.value&&(t.disabled=!0))})),P.registrationFormSchema=R.mapSchema(m,e,i),P.$hooks.call("registrationSchemaFilter",m,e),n=P.storage.getBrowserStorage("LRTraditionalLogin"),P.storage.removeBrowserStorage("LRTraditionalLogin"),0<P.registrationFormSchema.length&&!n?s?(P.$hooks.call("socialLoginFormRender"),R.createForm(P.registrationFormSchema,"socialRegistration",s,function(e){E.updateData(t,s,e,l,u,c,P.registrationFormSchema,"socialLogin")},function(e){u(e)},c)):p(r,P.registrationFormSchema,e):(i=(a=(o=P.util.findInSchema(d,"name","phoneid"))&&-1!==o.rules.indexOf("required"))?!!e.PhoneIdVerified:e.PhoneIdVerified,n=(o=(n=P.util.findInSchema(d,"name","emailid"))&&-1!==n.rules.indexOf("required"))?!!e.EmailVerified:e.EmailVerified,(!i&&a||!n&&o)&&(!i&&a||!P.options.disabledEmailVerification&&!P.options.optionalEmailVerification)?null==e.Email||e.EmailVerified?(i={phone:e.PhoneId},u([R.setMappedMessage(h.phoneNotVerified)],i),a=c+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp",E.resendOTPController(i,function(){P.socialLoginFlag=!0,R.verifyOTP("phone="+e.PhoneId,s,l,u,c),R.resendOTP("phone="+e.PhoneId+"&noPhoneVerified=false",s,l,u,c)},u,a,s,c)):u([R.setMappedMessage(h.emailNotVerified)]):(P.storage.setBrowserStorage(LoginRadiusDefaults.storedUidName,e.Uid),LoginRadiusDefaults.isSSOInitFired&&R.setToken(r),R.loginHandleToken(t,"",l,u))))}P.currentLRContainer=s,P.options.verificationEmailTemplate=P.options.emailTemplate||P.options.verificationEmailTemplate,P.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,r),e=e&&0<e.length?e:P.options.RegistrationFormSchema,d=e,m=JSON.parse(JSON.stringify(d)),t?o(t):P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+P.options.apiKey+"&access_token="+r+"&verificationUrl="+P.options.verificationUrl+"&emailTemplate="+P.options.verificationEmailTemplate+"&welcomeEmailTemplate="+P.options.welcomeEmailTemplate,"",function(e){e.ErrorCode?u(R.loginRadiusErrorTojsError(e)):o(e)},"socialLogin")},E.accountLinkingReceiveToken=function(t,o,n){P.options.noCallbackForSocialLogin?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/socialidentity?apiKey="+P.options.apiKey+"&access_token="+t,"",function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):e.Uid!==P.storage.getBrowserStorage(LoginRadiusDefaults.storedUidName)?P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/socialidentity?apiKey="+P.options.apiKey+"&access_token="+P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"candidatetoken="+t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e)},"linkAccount"):o({IsPosted:!0})},"linkAccount"):P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/socialidentity?apiKey="+P.options.apiKey+"&access_token="+P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"candidatetoken="+t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e)},"linkAccount")},E.validateToken=function(e,t,o){e?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/access_token/Validate?apikey="+P.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"validateToken"):o([R.setMappedMessage(h.twofaTokenValid)])},E.invalidateToken=function(e,t,o){e?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/access_token/InValidate?apikey="+P.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"invalidateToken"):o([R.setMappedMessage(h.twofaTokenValid)])},E.updatePrivacyPolicy=function(o,n,i,a,r,s,l){P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/privacypolicy/accept?apikey="+P.options.apiKey+"&access_token="+o,"",function(e){var t;e.ErrorCode?a(R.loginRadiusErrorTojsError(e)):(r?t=e:((t=n.Data||{}).access_token=o,t.Profile=e,t.Profile=Object.assign({},t.Profile,{IsLatestPrivacyPolicy:!0})),t.Profile&&("email"===t.Profile.RegistrationProvider.toLowerCase()?R.loginHandleToken(t,"",i,a):E.socialLoginReceiveToken(o,s,i,a,l)))},"updatePrivacyPolicy")},E.configurePINController=function(e,t,o,n,i,a){P.util.ajaxCall("POST",LoginRadiusDefaults.apiDomain+"/auth/pin/set/pinauthtoken?apikey="+P.options.apiKey+"&pinauthtoken="+e,t,function(e){e&&e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):e&&e.Profile&&("email"===e.Profile.RegistrationProvider.toLowerCase()?R.loginHandleToken(e,"",o,n):E.socialLoginReceiveToken(e.access_token,i,o,n,a))},"pinSetup")},E.pinReauthController=function(e,t,o,n){var i=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);i&&P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/reauth/pin?apiKey="+P.options.apiKey+"&access_token="+i,e,function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"pinreauthentication")},E.customEventConsentController=function(e,t,o,n){var i=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);i&&P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/consent/profile?apiKey="+P.options.apiKey+"&access_token="+i,e,function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"customeventconsent")},E.submitConsentController=function(e,t,o,n,r,s,i){e&&P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/consent/?apiKey="+P.options.apiKey+"&consenttoken="+e,t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):e&&e.Profile&&("email"===e.Profile.RegistrationProvider.toLowerCase()?E.handleFeatures(e,"",function(o,e,n,t,i,a){R.createForm(P.registrationFormSchema,"loginRequiredFieldsUpdate",r,function(e){var t={};t.Profile=o,t.access_token=n,E.updateData(t,r,e,i,a,s,P.registrationFormSchema,"login",!0)},function(e){a(R.setMappedMessage(e))})},"",o,n,s):E.socialLoginReceiveToken(e.access_token,r,o,n,s,"","",e.Profile))},i=i||"submitconsent")},E.verifyConsentController=function(e,t,o){var n=!!e.isCustom&&e.isCustom,i=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);i&&P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/consent/verify?apiKey="+P.options.apiKey+"&access_token="+i+"&event="+e.event+"&isCustom="+n,"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"verifyconsent")},E.consentLogsController=function(t,o){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);e&&P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/consent/logs?apiKey="+P.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"cosentlogs")},E.updateConsentController=function(e,t,o){var n=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);n&&P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/consent/?apiKey="+P.options.apiKey+"&access_token="+n,e,function(e){e.ErrorCode?o(R.loginRadiusErrorTojsError(e)):t(e)},"updateconsent")},E.sendMFAEmailOTPController=function(t,o,n,i,a,r){var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),s=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);s&&!P.LRCheckLogin?P.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2fa/otp/email?apiKey="+P.options.apiKey+"&access_token="+s+"&EmailId="+t.EmailId+"&EmailTemplate2FA="+P.options.EmailTemplate2FA,"",function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):(r||(t.mfaEmailToken=!0,R.verifyOTP(t,i,o,n,a)),o(e,t))},"sendMFAEmailOTP"):e?P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/login/2fa/otp/email?apiKey="+P.options.apiKey+"&secondfactorauthenticationtoken="+e+"&EmailTemplate2FA="+P.options.EmailTemplate2FA,t,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):(r||(t.mfaEmailToken=!0,R.verifyOTP(t,i,o,n,a)),o(e,t))},"sendMFAEmailOTP"):n([R.setMappedMessage(h.twofaTokenValid)])},E.submitMFASecurityQuestionsController=function(t,o,n,i,a){for(var e=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),r=P.util.parseQueryString(t),s=[],l=0;l<P.options.securityQuestionsCount;l++)s.push({QuestionId:r["securityQuestion"+l],Answer:r["securityAnswer"+l]});P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/2fa/securityquestionanswer?apiKey="+P.options.apiKey+"&secondfactorauthenticationtoken="+e,{SecurityQuestionAnswer:s},function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):(P.LRCheck2FA=!1,E.handleFeatures(e,t,a,i,o,n))},"submitMFASecurityQuestionsController")},E.verifyMFASecurityQuestionsController=function(t,o,n,i,a){var e,r=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),s=P.util.parseQueryString(t),l=[];for(e in s)"setsecurityquestions"!==e&&l.push({QuestionId:e,Answer:s[e]});P.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/login/2fa/verification/securityquestionanswer?apiKey="+P.options.apiKey+"&secondfactorauthenticationtoken="+r,s={SecurityQuestionAnswer:l},function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):(P.LRCheck2FA=!1,E.handleFeatures(e,t,a,i,o,n))},"verifyMFASecurityQuestionsController")},E.verifyMFASecurityQuestionsByAccessTokenController=function(t,o,n,e,i){var a=P.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),r={};if(t){var r=P.util.parseQueryString(t),s=[];if(i)for(var l in r)s.push({QuestionId:l,Answer:r[l]});else for(var u=0;u<P.options.securityQuestionsCount;u++)s.push({QuestionId:r["securityQuestion"+u],Answer:r["securityAnswer"+u]});r={SecurityQuestionAnswer:s}}r.ReplaceSecurityQuestionAnswer=!e,P.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/2fa/securityquestionanswer?apiKey="+P.options.apiKey+"&access_token="+a,r,function(e){e.ErrorCode?n(R.loginRadiusErrorTojsError(e)):o(e,t)},"verifyMFASecurityQuestionsController")}}var LoginRadiusV2=function(o){this.global=window;var y=this,v=new SetLoginRadiusCommonFunctions(y),C=new LoginRadiusControllers(y,v),a=LoginRadiusDefaults.buttonNames,h=LoginRadiusDefaults.messages,c=LoginRadiusDefaults._uuidFormat,e=hash.get("lr-token");try{e&&window.opener&&window.opener.html5passToken&&(window.opener.html5passToken(e),document.write("<style type='text/css'>body { display: none !important; } </style>"),hash.remove("lr-token"),window.close())}catch(e){}var t=new LRNameSpace.Utilities;y.util=new LoginRadiusUtility(y,o),y.storage=new LRNameSpace.Storage(y,LoginRadiusDefaults);var T=y.util=Object.assign(t,y.util,y.storage);function p(e,t,o,n){var i,a,r,s;e&&(r="get",a="",s=LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/email/verify?apiKey="+y.options.apiKey+"&verificationtoken="+e+"&welcomeEmailTemplate="+y.options.welcomeEmailTemplate,y.options.otpEmailVerification&&(a={email:(i=T.getQueryParameterByName("email"))?i.replace(/ /g,"+"):"",otp:e,welcomeemailtemplate:y.options.welcomeEmailTemplate},r="post",s=LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/email/verifyotp?apiKey="+y.options.apiKey),T.ajaxCall(r,s,a,function(e){e.ErrorCode?o(v.loginRadiusErrorTojsError(e)):v.loginHandleToken(e,"",t,o,n)},"passwordlessLogin"))}function w(t,o,n,i,a){y.$hooks.call("registrationSchemaFilter",a);var e,r=i+LoginRadiusDefaults.idPrefix+"recaptcha_widget_registration";if(y.options.isConsentManagementEnabled||T.captchaSchema(r,a),y.options.privacyPolicyConfiguration.IsEnabled&&((e=y.privacyPolicySchema.slice())[0].rules="Strict"===y.options.privacyPolicyConfiguration.Mode?"required":"",a.push(e[0])),y.options.isPINAuthentication&&y.options.PINConfiguration.AskOnRegistration)v.setPINRule(T.findInSchema(a,"name","pin")),v.setPINRule(T.findInSchema(a,"name","confirmpin"));else{for(var s=[],l=0;l<a.length;l++)"pin"!==a[l].name&&"confirmpin"!==a[l].name&&s.push(a[l]);a=s}a.push({type:"html",name:"termsandcondition",html:y.options.termsAndConditionHtml||""}),v.setPasswordRule(T.findInSchema(a,"name","password")),v.setPasswordRule(T.findInSchema(a,"name","confirmpassword")),y.registrationFormSchema=a,y.options.isConsentManagementEnabled?y.getConsentConfiguration(function(e){e=v.createConsentInterface(e.Register);""!==e&&a.push({html:e,name:"consent",type:"html"}),T.captchaSchema(r,a),u(a,t,o,n,r,i,!0),T.renderV2Recaptcha(r,!0)}):(u(a,t,o,n,r,i,!1),T.renderV2Recaptcha(r,!0))}function u(o,n,i,a,r,s,l){v.createForm(o,"registration",n,function(e){var t=[];0<(t=l?v.consentValidation(e,"Register"):t).length?a(t):C.registrationController(e,n,function(e,t){window.grecaptcha&&y.options.v2Recaptcha&&grecaptcha.reset(window[r+"lr_recaptcha_widgets_idprefix"]),i(e,t)},function(e){window.grecaptcha&&y.options.v2Recaptcha&&grecaptcha.reset(window[r+"lr_recaptcha_widgets_idprefix"]),a(e)},s,o)},function(e){window.grecaptcha&&y.options.v2Recaptcha&&grecaptcha.reset(window[r+"lr_recaptcha_widgets_idprefix"]),a(e)},s)}function S(d,m,g,e){var t=document.createElement("input");t.setAttribute("type","button");var o=y.buttonsName["createTwoFactorAuthentication".toLowerCase()]||a.createtwofactorauthentication;t.setAttribute("value",o);var f=e||LoginRadiusDefaults.classPrefix;document.getElementsByName(f+"profileeditor")[0]?y.options.showTwoFactorOnProfile&&document.getElementsByName(f+"profileeditor")[0].appendChild(t):(y.options.twoFactorAuthentication||y.options.optionalTwoFactorAuthentication)&&T.addHTMLContent(d,t);function h(){y.options.optionalTwoFactorAuthentication||y.options.twoFactorAuthentication?T.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apikey="+y.options.apiKey+"&access_token="+y.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"",function(s){y.$hooks.register("afterFormRender",function(e,t,o,n){n&&y.LRCheck2FA&&(y.util.findInSchema(n,"id","loginradius-button-backupcodebackbutton")||(o=y.util.getButtonAttribute("backupcodebackbutton",o,function(){h()}),n.appendChild(o)))}),y.LRCheck2FA=!0;var e,t,o,n=y.LRCheckLogin=!1;if(s.ErrorCode)g(v.loginRadiusErrorTojsError(s));else{y.storage.setBrowserStorage(LoginRadiusDefaults.storedOTPAuth,s.IsOTPAuthenticatorVerified),y.storage.setBrowserStorage(LoginRadiusDefaults.storedGAAuth,s.IsGoogleAuthenticatorVerified),y.storage.setBrowserStorage(LoginRadiusDefaults.storedEmailOTPAuth,s.IsEmailOtpAuthenticatorVerified),y.storage.setBrowserStorage(LoginRadiusDefaults.storedSQAuth,s.IsSecurityQuestionAuthenticatorVerified);var i,l=y.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth),u=y.storage.getBrowserStorage(LoginRadiusDefaults.storedGAAuth),c=y.storage.getBrowserStorage(LoginRadiusDefaults.storedSQAuth),a=y.storage.getBrowserStorage(LoginRadiusDefaults.storedEmailOTPAuth),r=s.IsOTPAuthenticatorVerified,p=y.options.authenticatorOptionsOrder;for(i in p)p[i]&&("emailotp"===p[i]?function(){var a,r,e;y.options.emailOTPAuthentication&&s.Email&&s.Email.length&&(s.IsEmailOtpAuthenticatorVerified?(("false"!==l||"false"!==u||"false"!==c)&&y.options.twoFactorAuthentication||y.options.optionalTwoFactorAuthentication)&&(e=y.util.getButtonAttribute("disableemailotpauthenticator",f),y.util.addHTMLContent(d,e,n),n=!0,y.util.addEvent("click",e,function(e){v.disableMFAOptions("emailotpauthenticator",m,g)})):(a=s.Email)&&(r=function(e){v.addResendOTPBtn(!y.LRCheckLogin,m,g),C.sendMFAEmailOTPController({EmailId:e},m,g,d,f)},LoginRadiusDefaults.innerHTML=!0,e=y.util.getButtonAttribute("emailotp",f,function(e){if(1<a.length){LoginRadiusDefaults.innerHTML=!1;for(var t,o=[],n=0;n<a.length;n++)a[n]&&((t={}).text=a[n],t.value=a[n],o.push(t));var i={type:"option"};i.options=o,i.name="sendemailotp",i.rules="required",i.display="Select email to send verification code",v.createForm([i],"mfaselectemails",d,function(e){e=y.util.parseQueryString(e),r(e.sendemailotp)})}else s.Email&&s.Email[0]&&r(s.Email[0])}),y.util.addHTMLContent(d,e,n),n=!0))}():"sms"===p[i]?r?(LoginRadiusDefaults.innerHTML=!0,v.changeNumberForm(d,"",m,g,f,LoginRadiusDefaults.innerHTML)):(o=y.util.getButtonAttribute("otpauthenticator",f,function(){LoginRadiusDefaults.innerHTML=!1,v.updatePhoneNumber(d,m,g,f,"updatePhone2FA")}),y.util.addHTMLContent(d,o,n),n=!0):"securityquestion"===p[i]?(0,y.options.securityQuestionAuthentication&&(s.IsSecurityQuestionAuthenticatorVerified?(("false"!==l||"false"!==a||"false"!==u)&&y.options.twoFactorAuthentication||y.options.optionalTwoFactorAuthentication)&&(e=y.util.getButtonAttribute("disablesqauthenticator",f),y.util.addHTMLContent(d,e,n),n=!0,y.util.addEvent("click",e,function(){v.disableMFAOptions("sqauthenticator",m,g)})):(t=y.util.getButtonAttribute("securityquestionsauthenticator",f,function(){LoginRadiusDefaults.innerHTML=!1,v.showMFASecurityQuestions(s,d,m,g,f)}),y.util.addHTMLContent(d,t,n),n=!0))):"googleauth"===p[i]&&(0,y.options.googleAuthentication&&(s.IsGoogleAuthenticatorVerified?(("false"!==l||"false"!==a||"false"!==c)&&y.options.twoFactorAuthentication||y.options.optionalTwoFactorAuthentication)&&(e=y.util.getButtonAttribute("disablegoogleauthenticator",f),y.util.addHTMLContent(d,e,n),n=!0,y.util.addEvent("click",e,function(e){v.disableMFAOptions("googleauthenticator",m,g)})):(t=y.util.getButtonAttribute("googleauthenticator",f,function(){LoginRadiusDefaults.innerHTML=!1,v.showQRCode(s,d,m,g,f)}),y.util.addHTMLContent(d,t,n),n=!0))))}},"createTwoFactorAuthentication"):y.log("Two Factor Authentication will not work, please set in commonOpitons either twoFactorAuthentication or optionalTwoFactorAuthentication")}T.addEvent("click",t,function(e){h(),e.target.parentNode&&e.target.parentNode.removeChild(e.target)})}function L(e){var t,o;y.options.duplicateEmailWithUniqueUsername?((t=T.findInSchema(e,"name","emailid")).display="Username",t.rules="required"):(y.options.usernameLogin&&-1===(o=T.findInSchema(e,"name","emailid")).display.indexOf("/Username")&&(o.display=o.display+"/Username",o.rules="required"),(y.options.phoneLogin||y.options.passwordlessLoginOTP)&&(o||((o=T.findInSchema(e,"name","emailid")).rules="required"),-1===o.display.indexOf("/Phone")&&(o.display=o.display+"/Phone")))}function r(a,r,s,l){var e=y.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);e?T.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+y.options.apiKey+"&access_token="+e,"",function(i){y.getConsentConfiguration(function(e){var t,o,n;o=[],n="",i&&i.ConsentProfile&&i.ConsentProfile.Consents&&(t=i.ConsentProfile.Consents,n=v.createConsentOptionInterface(y.consentsList,t)),o.push({html:n,name:"consent",type:"html"}),v.createForm(o,"consenteditor",a,function(e){var t=v.consentValidation(e);if(0<t.length)s(t);else{var o,n=y.util.parseQueryString(e),i=[];for(o in n){var a=o.replace("consent_","");i.push({ConsentOptionId:a,IsAccepted:n[o]})}(n={}).Consents=i,C.updateConsentController(n,r,s)}},function(e){s(e)},l)})}):s([v.setMappedMessage(h.tokenValid)])}function n(i,s){var d=(s=s||{}).onSuccess||function(){},m=s.onError||function(){},g=s.container||"",f=s.classPrefix||"",u=s.templateName||"";y.$hooks.register("getCurrentActionOptions",function(e){i==e&&(window.LRSafarionSuccess=d||function(){},window.LRSafarionError=m||function(){}),y.currentActionOptions||(y.currentActionOptions={}),y.currentActionOptions[i]={},y.currentActionOptions[i].onSuccess=d||function(){},y.currentActionOptions[i].onError=m||function(){},y.currentActionOptions[i].container=g,y.currentActionOptions[i].classPrefix=f||"",y.currentActionOptions[i].templateName=u||""}),y.getAppConfiguration(function(){"registration"!==i&&"updateSecurityQuestion"!==i&&y.$hooks.call("beforeInit",i);var e={};function t(){var e,t=d,o=m,n=f,i=T.getHashParam("vtoken");"oneclicksignin"!==(e=T.getHashParam("vtype"))&&"passwordlesslogin"!==e||y.passwordlessLoginFlag||(y.passwordlessLoginFlag=!0,p(i,t,o,n))}function o(){!function(t,o,n,i){var a,r,e=T.getHashParam("vtoken"),s=T.getHashParam("vtype"),l=!1;y.options.v2Recaptcha||y.options.invisibleRecaptcha||y.options.tencentCaptcha||y.options.tencentCaptchaAsFallback?l=!0:y.options.privacyPolicyConfiguration.IsEnabled&&y.log("Captcha should be enabled for passwordless login if using with privacy policy"),"noregistration"!==s&&"onetouchlogin"!==s||(a=o,r=n,e&&T.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/email/autologin?apiKey="+y.options.apiKey+"&verificationtoken="+e+"&welcomeEmailTemplate="+y.options.welcomeEmailTemplate,"",function(e){e.ErrorCode?r(v.loginRadiusErrorTojsError(e)):v.loginHandleToken(e,"",a,r)},"smartlogin"));var u,s=y.passwordLessLoginSchema;y.options.phoneLogin&&((e=T.findInSchema(s,"name","emailid")).display=e.display+"/Phone"),l&&(T.addRecaptchaJS(),u=i+LoginRadiusDefaults.idPrefix+t,T.captchaSchema(u,s)),v.createForm(s,"oneTouchLogin",t,function(e){C.oneTouchLoginController(e,t,o,n,i,l)},function(e){n(e)},i),l&&T.renderV2Recaptcha(u,!0)}(g,d,m,f)}function n(){var e,t=g,o=d,n=m,i=f;L(e=y.smartLoginSchema),v.createForm(e,"smartlogin",t,function(e){e=T.checkPhoneOrEmailLogin(e);-1!==e.indexOf("phone")?C.loginOTPController(e,t,o,n,i):C.smartLoginController(e,o,n)},function(e){n(e)},i)}e.privacyPolicyUpdate=function(){var t,e,o=g,n=d,i=m,a=f;y.options.privacyPolicyConfiguration.IsEnabled&&((t=y.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))?((e=y.privacyPolicySchema.slice())[0].rules="Strict"===y.options.privacyPolicyConfiguration.Mode?"required":"",v.createForm(e,"privacyPolicyUpdate",o,function(e){C.updatePrivacyPolicy(t,"",n,i,!0,o,a)},function(e){i(v.setMappedMessage(e))})):i([v.setMappedMessage(h.tokenValid)]))},e.login=function(){function t(e,o){v.createForm(e,o,r,function(n){var e,t;y.LRCheckLogin=!0,window.lrpasswordlesslogin?v.sendInstantSignInLink(n,i,a,r,s):window.lrpasswordlessloginotp?v.sendInstantSignInOtp(n,i,a,r,s):(e=function(o,e,n,t,i,a){v.createForm(y.registrationFormSchema,"loginRequiredFieldsUpdate",r,function(e){var t={};t.Profile=o,t.access_token=n,C.updateData(t,r,e,i,a,s,y.registrationFormSchema,"login",!0)},function(e){a(v.setMappedMessage(e))})},t=function(t,o){v.createForm(y.changePasswordFormSchema,"changepassword",r,function(e){C.periodicalPasswordRestController(e,i,a,t,o,n)},function(e){a(e)})},y.options.twoFactorAuthentication||y.options.optionalTwoFactorAuthentication?C.login2FAController(n,r,i,a,s,t,e):"pinLogin"===o?C.loginPINController(n,r,i,a,s,t,e,l):C.loginController(n,r,i,a,t,e,s))},function(e){a(v.setMappedMessage(e))},s)}var r,i,a,s,o,e,n,l;r=g,i=d,a=m,s=f,e=T.getHashParam("vtoken"),n=T.getHashParam("vtype"),l=y.getSessionToken(),y.currentLRContainer=r,"oneclicksignin"!==n&&"passwordlesslogin"!==n||y.passwordlessLoginFlag||(y.passwordlessLoginFlag=!0,p(e,i,a,s)),o=y.loginFormSchema,y.loginAction=!0,L(o),o=JSON.parse(JSON.stringify(function(e){if(y.options.stayLogin){for(var t=!0,o=0;o<e.length;o++)"stayLogin"===e[o].name&&(t=!1);t&&e.push({type:"multi",name:"stayLogin",display:"Remember me",rules:null,permission:"w"})}return e}(o))),v.setPasswordRule(o[1],y.loginAction),!y.passwordlessLoginFlag&&!y.options.twoFactorAuthentication&&!y.options.optionalTwoFactorAuthentication&&y.options.isPINAuthentication&&y.options.PINConfiguration&&y.options.PINConfiguration.PINLogin&&l?(n=y.pinLoginFormSchema.slice(),e=Object.assign({},y.defaultBtnSchema,{name:"backtologinform",display:LoginRadiusDefaults.buttonNames.pinloginbackbtn,eventCallback:function(e){t(o,"login")}}),n.push(e),y.loginAction=!0,o.rules="required",t(n,"pinLogin")):t(o,"login")},e.registration=function(){var e=setInterval(function(){var r,s,l,u;LoginRadiusDefaults.isRegFormSchemaLock||(LoginRadiusDefaults.isRegFormSchemaLock=!0,y.$hooks.call("beforeInit",i),r=g,s=d,l=m,u=f,T.addRecaptchaJS(),y.registrationFormSchema=y.registrationFormSchema&&0<y.registrationFormSchema.length?y.registrationFormSchema:y.options.RegistrationFormSchema,function(e){for(var t,o,n=JSON.parse(JSON.stringify(e)),i=[],a=0;a<n.length;a++)n[a]&&y.options.showSplitForm&&n[a].DataSource&&null!==n[a].DataSource&&(t=JSON.parse(JSON.stringify(n[a])),o=JSON.parse(JSON.stringify(T.findInSchema(n,"name","cf_"+n[a].DataSource+"Code"))),t.name="recordid",o.name="code",i.push(t),i.push(o));0<i.length&&y.options.showSplitForm?v.createForm(i,"validatecode",r,function(e){T.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/validatecode?apiKey="+y.options.apiKey,e,function(e){1==e.IsValid?w(r,s,l,u,n):l(e)},"registration")}):(y.options.securityQuestionEnabled&&y.options.SecurityQuestions&&v.getSecurityQuestionSchema(n,!0),w(r,s,l,u,n))}(y.registrationFormSchema),clearInterval(e))},1e3)},e.resetPassword=function(){v.resetPassword(g,d,m,f)},e.resetPIN=function(){v.resetPIN(g,d,m,f)},e.forgotPassword=function(){var e,t=g,o=d,n=m,i=f;L(e=y.forgotPasswordFormSchema),v.createForm(e,"forgotpassword",t,function(e){-1!==(e=T.checkPhoneOrEmailLogin(e)).indexOf("phoneApi=1")?(LoginRadiusDefaults.LRPhoneNo=e,C.forgotPasswordbyPhoneController(e,t,o,n,i)):C.forgotPasswordController(e,t,o,n,i)},function(e){n(e)},i)},e.forgotPIN=function(){var e,t=g,o=d,n=m,i=f;L(e=y.forgotPINFormSchema),v.createForm(e,"forgotPIN",t,function(e){-1!==(e=T.checkPhoneOrEmailLogin(e)).indexOf("phoneApi=1")?(LoginRadiusDefaults.LRPhoneNo=e,C.forgotPINbyPhoneController(e,t,o,n,i)):C.forgotPINController(e,t,o,n,i)},function(e){n(e)},i)},e.verifyEmail=function(){function t(e){var t=T.getHashParam("vtoken");if(y.options.verifyEmailByOTP){var o={};(o=e?T.mergeOptions(o,T.parseQueryString(e)):o).otp=t;try{o.email=T.getQueryParameterByName("email").replace(/ /g,"+"),C.emailVerificationController(o,n,i,a,r,!0)}catch(e){y.log(e)}}else C.emailVerificationController(t,n,i,a,r)}var n,i,a,r;n=d,i=m,r=f,(a=g)&&"Captcha"===y.options.loginLockedType&&(y.$hooks.register("afterFormRender",function(e,t,o,n){n&&"loginradius-verifyemail"===n.name&&"loginradius-submit-verify"===n[0].id&&(n[0].style.display="none")}),v.createForm([],"verifyemail",a,function(e){t(e)},function(e){i(e)},r)),t()},e.changePassword=function(){var e=g,t=d,o=m,n=f,i=y.changePasswordFormSchema;v.setPasswordRule(T.findInSchema(i,"name","newpassword")),v.setPasswordRule(T.findInSchema(i,"name","confirmnewpassword")),v.createForm(i,"changepassword",e,function(e){C.changePasswordController(e,t,o)},function(e){o(e)},n)},e.changePIN=function(){var e=g,t=d,o=m,n=f,i=y.changePINFormSchema.slice();v.setPINRule(T.findInSchema(i,"name","newpin")),v.setPINRule(T.findInSchema(i,"name","confirmnewpin")),v.createForm(i,"changepin",e,function(e){C.changePINController(e,t,o)},function(e){o(e)},n)},e.crossDeviceSSO=function(){v.loadQRCodeScript(function(){var e,t=g,o=s.expirytime,n=d,i=m,a=f;y.options.isCrossDeviceSSOEnabled&&(e=setInterval(function(){y.CDSSOPingApiTimeout&&clearTimeout(y.CDSSOPingApiTimeout),v.generateCrossDeviceSSOCode(t,o,n,i,a,function(){clearInterval(e)})},1e3*o),v.generateCrossDeviceSSOCode(t,o,n,i,a,function(){clearInterval(e)}))})},e.socialLogin=function(){var e=T.elementById(g);e&&T.addEvent("click",e,function(){LoginRadiusDefaults.socialRegFormId=this.id}),LoginRadiusDefaults.socialRegFormId=g,v.socialLogin(g,d,m,f)},e.linkAccount=function(){var i,e,a=g,r=d,s=m,l=u;y.options.disableAccountLinking?y.log(h.disabledAccountLinking):(i=a.split(","),(e=y.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))?T.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+y.options.apiKey+"&access_token="+e,"",function(e){if(e.ErrorCode)s(v.loginRadiusErrorTojsError(e));else if(e.EmailVerified||e.PhoneIdVerified){var t={};if(e.Identities)for(var o=0,n=e.Identities.length;o<n;o++)t[e.Identities[o].Provider]=e.Identities[o].ID;1===i.length?v.renderCustomInterface(a,t,l,"",!0):v.renderCustomInterface(a,t,y.options.linkedAccountsTemplate+","+y.options.notLinkedAccountsTemplate,!0,!0),window.html5passToken=function(e){C.accountLinkingReceiveToken(e,r,s)},y.options.isMobile||y.options.noCallbackForSocialLogin?y.$hooks.register("socialCalls",function(e,t){y.options.noCallbackForSocialLogin&&v.pingForSocialLogin(t,function(e){e.access_token?C.accountLinkingReceiveToken(e.access_token,r,s):r(e)},function(){})}):T.addEvent("message",window,function(e){-1===e.origin.indexOf(y.options.customDomain)&&-1===e.origin.indexOf(LoginRadiusDefaults.hubDomain)||"string"==typeof e.data&&c.test(e.data)&&C.accountLinkingReceiveToken(e.data,r,s)})}else s([v.setMappedMessage(h.unverifiedUser)])},"linkAccount"):s([v.setMappedMessage(h.tokenValid)]))},e.unLinkAccount=function(){var o=T.unLinkAccount;T.unLinkAccount=function(e,t){o(e,t,d,m)}},e.profileEditor=function(){var a,s,l=g,u=d,c=m,p=f;(s=y.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))?(a=function(r){T.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+y.options.apiKey+"&access_token="+s,"",function(e){var t=JSON.parse(JSON.stringify(r)),t=v.mapSchema(t,e,"profileeditor"),o=[],n=[],i={};i.Profile=e,i.access_token=s;for(var a=0;a<t.length;a++)t[a].name&&-1===t[a].name.indexOf("emailid")&&-1===t[a].name.indexOf("phoneid")&&o.push(t[a]),t[a].permission&&"h"!==t[a].permission&&n.push(t[a]);v.createForm(o,"profileeditor",l,function(e){C.updateData(i,l,e,u,c,p,o,"profileEditor")},function(e){c(e)},p),(y.options.optionalTwoFactorAuthentication||y.options.twoFactorAuthentication)&&S(l,u,c,p),y.$hooks.call("renderProfileEditorHook",e,n)},"profileEditor")},y.registrationFormSchema=y.registrationFormSchema&&0<y.registrationFormSchema.length?y.registrationFormSchema:y.options.RegistrationFormSchema,y.progressiveProfiling.showInEditor?y.progressiveProfiling.fetchSchema(function(e){var t=y.registrationFormSchema.slice();if(e&&e.ProfilingSteps)for(var o=0;o<e.ProfilingSteps.length;o++)for(var n=e.ProfilingSteps[o].Schema,i=0;i<n.length;i++)y.util.containsObject(t,n[i],"name")||t.push(n[i]);a(t)}):a(y.registrationFormSchema)):c([v.setMappedMessage(h.tokenValid)])},e.deleteUser=function(){var e,t=d,o=m;(e=y.sessionData.getToken())?T.ajaxCall("delete",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+y.options.apiKey+"&access_token="+e+"&deleteUrl="+y.options.deleteUrl+"&emailTemplate="+y.options.deleteUserEmailTemplate,{},function(e){e.ErrorCode?o(v.loginRadiusErrorTojsError(e)):t(e)},"deleteUser"):o([h.vTokenError])},e.deleteUserConfirm=function(){var e=d,t=m,o=T.getHashParam("vtoken");C.deleteUserConfirmController(o,e,t)},e.updatePhone=function(){y.LRCheck2FA=!1,v.updatePhoneNumber(g,d,m,f)},e.changeUsername=function(){var t=d,o=m;v.createForm(y.changeUsernameFormSchema,"changeUsername",g,function(e){C.changeUsernameController(e,t,o)},function(e){o(e)},f)},e.resendVerificationEmail=function(){var t=d,o=m;v.createForm(y.emailSchema,"resendEmailVerification",g,function(e){C.resendEmailVerificationController(e,t,o)},function(e){o(e)},f)},e.addEmail=function(){var t=d,o=m;v.createForm(y.addEmailSchema,"addemail",g,function(e){C.addEmailController(e,t,o)},function(e){o(e)},f)},e.removeEmail=function(){var t=d,o=m;v.createForm(y.emailSchema,"removeemail",g,function(e){C.removeEmailController(e,t,o)},function(e){o(e)},f)},e.createTwoFactorAuthentication=function(){S(g,d,m,f)},e.backupCodeButton=function(){var t=g,o=d,n=m,i=f;T.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apikey="+y.options.apiKey+"&access_token="+y.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"",function(e){(e.IsSecurityQuestionAuthenticatorVerified||e.IsEmailOtpAuthenticatorVerified||e.IsOTPAuthenticatorVerified||e.IsGoogleAuthenticatorVerified)&&(e=y.util.getButtonAttribute("generatebackupcodebutton",i),T.addHTMLContent(t,e),T.addEvent("click",e,function(e){y.api.getBackupCode(y.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),o,n)}))})},e.resetBackupCodeButton=function(){var o=g,n=d,i=m;T.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apikey="+y.options.apiKey+"&access_token="+y.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"",function(e){var t;(e.IsSecurityQuestionAuthenticatorVerified||e.IsEmailOtpAuthenticatorVerified||e.IsOTPAuthenticatorVerified||e.IsGoogleAuthenticatorVerified)&&((t=document.createElement("input")).setAttribute("type","button"),e=y.buttonsName["resetBackupCode".toLowerCase()]||a.resetBackupCode,t.setAttribute("value",e),T.addHTMLContent(o,t),T.addEvent("click",t,function(e){y.api.resetBackupCode(y.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),n,i)}))})},e.updateSecurityQuestion=function(){var r=setInterval(function(){var e,t,o,n,i,a;LoginRadiusDefaults.isSecurityFormSchemaLock||(LoginRadiusDefaults.isSecurityFormSchemaLock=!0,e=g,t=d,o=m,n=f,y.options.securityQuestionEnabled&&(y.registrationFormSchema=y.registrationFormSchema&&0<y.registrationFormSchema.length?y.registrationFormSchema:y.options.RegistrationFormSchema,a=y.registrationFormSchema,i=!0,(i=(a=v.getSecurityQuestionSchema(a))&&0<a.length?!1:i)?o([v.setMappedMessage(h.noSecurityQuestions)]):v.createForm(a,"updatesecurityquestion",e,function(e){C.updateSecurityQuestionController(e,t,o)},function(e){o(e)},n)),clearInterval(r))},1e3)},e.resetPasswordBySecurityQuestion=function(){var o,e,n=g,i=d,a=m,r=f;y.options.securityQuestionEnabled&&(o=!0,L(e=y.getSecQSchema),v.createForm(e,"securityquestions",n,function(e){e=T.checkPhoneOrEmailLogin(e),C.getSecurityQuestionsController(e,function(e){0<e.length&&(o=!1);var t=y.loginFormSchema.slice();v.setPasswordRule(y.util.findInSchema(t,"name","password")),v.setPasswordRule(y.util.findInSchema(t,"name","confirmpassword"));e=T.mergeObjects(t,e);y.loginAction||L(e),o?a([v.setMappedMessage(h.noSecurityQuestions)]):v.createForm(e,"resetpwdbysecq",n,function(e){e=T.checkPhoneOrEmailLogin(e),C.resetPasswordBySecurityQuestionController(e,i,a)},function(e){a(e)},r)},function(e){a(e)})},function(e){a(e)},r))},e.resetPINBySecurityQuestion=function(){var o,e,n=g,i=d,a=m,r=f;y.options.securityQuestionEnabled&&(o=!0,L(e=y.getSecQSchema),v.createForm(e,"securityquestions",n,function(e){e=T.checkPhoneOrEmailLogin(e),C.getSecurityQuestionsController(e,function(e){0<e.length&&(o=!1);var t=y.resetPINFormSchema.slice(0,1);t.push(y.loginFormSchema[0]),v.setPINRule(y.util.findInSchema(t,"name","pin"));e=T.mergeObjects(t,e);y.loginAction||L(e),o?a([v.setMappedMessage(h.noSecurityQuestions)]):v.createForm(e,"resetpinbysecq",n,function(e){e=T.checkPhoneOrEmailLogin(e),C.resetPINBySecurityQuestionController(e,i,a)},function(e){a(e)},r)},function(e){a(e)})},function(e){a(e)},r))},e.ssoLogin=function(){var o=d;v.validateAndCall(function(){var e=y.options.customDomain||y.options.appName+"."+LoginRadiusDefaults.hubDomain;T.ajaxCall("get","https://"+e+"/ssologin/login","",function(t){t.isauthenticated&&(y.loginRadiusHtml5PassToken?y.loginRadiusHtml5PassToken(t.token):(y.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,t.token),y.options.tokenType&&"jwt"===y.options.tokenType.toLowerCase()?(LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterTokenResponse={},v.getJwtToken(t.token,function(e){o(t.token,e)})):o(t.token)))})})},e.logout=function(){v.logout(d)},e.ssoNotLoginThenLogout=function(){var o=m,n=d;v.validateAndCall(function(){var e=y.options.customDomain||y.options.appName+"."+LoginRadiusDefaults.hubDomain;T.ajaxCall("get","https://"+e+"/ssologin/login","",function(t){var e;t.isauthenticated?(void 0!==(e=LRNameSpace.cookies.getItem(LoginRadiusDefaults.tokenCookie))&&null!=e||(v.setToken(t.token),e=LRNameSpace.cookies.getItem(LoginRadiusDefaults.tokenCookie)),e&&e!==t.token?(v.setToken(t.token),n(t.token)):(y.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,t.token),y.options.tokenType&&"jwt"===y.options.tokenType.toLowerCase()?(LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterTokenResponse={},v.getJwtToken(t.token,function(e){n(t.token,e)})):n(t.token))):(LRNameSpace.cookies.removeItem(LoginRadiusDefaults.tokenCookie,y.options.appPath),o())})})},e.pinreauthentication=function(){var e=g,t=d,o=m,n=f,i=[];y.pinLoginFormSchema&&((i=y.pinLoginFormSchema.slice()).rules="required"),i.length?v.createForm(i,"pinreauthentication",e,function(e){C.pinReauthController(e,t,o)},function(e){o(e)},n):y.log("Pin schema is not defined")},e.customeventconsent=function(){var o=g,n=s.event,i=d,a=m,r=f;y.getConsentConfiguration(function(e){var t=[],e=v.createConsentInterface(e["custom_"+n]);""!==e&&(t.push({html:e,name:"consent",type:"html"}),v.createForm(t,"customeventconsent",o,function(e){var t=v.consentValidation(e,"custom_"+n);0<t.length?a(t):(t=[],e=v.mapRegistrationSchema(null,e).Consents,t.push({Event:n,IsCustom:!0}),e.Events=t,C.customEventConsentController(e,i,a))},function(e){a(e)},r))})},e.consenteditor=function(){r(g,d,m,f)},e.instantLinkLogin=t,e.passwordlessLoginValidate=t,e.autoLogin=n,e.smartLogin=n,e.noRegistrationPasswordLessLogin=o,e.onetouchLogin=o,e.default=function(){y.log("This action is not valid.")},(e[i]||e.default)()})}return this.trackEvent=function(){y.options.debugMode&&console.warn("Anonymous login feature has been deprecated")},T.unLinkAccount=function(e,t,o,n){var i;o=o||function(){},n=n||function(){},e&&t&&(i={provider:e,providerid:t},(t=y.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName))?T.ajaxCall("delete",LoginRadiusDefaults.apiDomain+"/auth/socialIdentity?apiKey="+y.options.apiKey+"&access_token="+t,i,function(e){e.ErrorCode?n(v.loginRadiusErrorTojsError(e)):o(e,i)},"unLinkAccount"):n([v.setMappedMessage(h.tokenValid)]))},LoginRadiusHooksModel(y),setLoginRadiusModuleFunctions(y,o),y.init=function(e,t){y.useraction=e,o.maskSensitiveInput?y.otpSchema=[{type:"password",name:"otp",display:"Verification Code",rules:"required",permission:"r"}]:y.otpSchema=[{type:"string",name:"otp",display:"Verification Code",rules:"required",permission:"r"}],"required"===o.twoFactorAuthentication?(o.twoFactorAuthentication=!0,o.optionalTwoFactorAuthentication=!1):"optional"===o.twoFactorAuthentication&&(o.twoFactorAuthentication=!1,o.optionalTwoFactorAuthentication=!0),"ssoLogin"!==e&&"logout"!==e&&"ssoNotLoginThenLogout"!==e||LoginRadiusDefaults.isSSOInitFired||(LoginRadiusDefaults.isSSOInitFired=!0,y.SSOinitFired=!0),o.appName||y.log("SSO will not work, please set option.appName for SSO"),o.formRenderDelay=o.formRenderDelay||0,o.apiKey?0<o.formRenderDelay?setTimeout(function(){n(e,t)},o.formRenderDelay):n(e,t):y.log("API key must be set.")},setLoginRadiusDefaultSchema(y),y.api=new LoginRadiusApiFramework(y,C),y};
