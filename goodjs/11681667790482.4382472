define(["require","exports","tslib","modules/clean/ux_analytics/lazy_ux_analytics","modules/clean/ux_analytics/dispatch_custom_event"],function(t,s,e,a,n){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.installHistoryListeners=s.lib=s.SPA_HISTORY_STATE_CHANGE=void 0,n=e.__importStar(n),s.SPA_HISTORY_STATE_CHANGE="SPAHistoryStateChange";function i(t){var e={detail:{eventSource:t}};a.runAfterUxaListening(function(){n.dispatchCustomEvent(s.SPA_HISTORY_STATE_CHANGE,e)})}function l(t){i("popState")}var o=history.pushState,e=history.replaceState;s.lib={oldReplaceState:e,oldPushState:o,resetHistoryListenersInstalled:function(){self._DBX_UXA_historyListenersInstalled=!1},getHistoryListenersInstalled:function(){return self._DBX_UXA_historyListenersInstalled},installPushStateMonkeyPatch:function(){Object.defineProperty(history,"pushState",{value:function(t,e,a){var n=location.pathname+location.hash;s.lib.oldPushState.call(history,t,e,a),n!==location.pathname+location.hash&&i("pushState")}})},installReplaceStateMonkeyPatch:function(){Object.defineProperty(history,"replaceState",{value:function(t,e,a){var n=location.pathname+location.hash;s.lib.oldReplaceState.call(history,t,e,a),n!==location.pathname+location.hash&&i("replaceState")}})}},s.installHistoryListeners=function(){self._DBX_UXA_historyListenersInstalled||(s.lib.installPushStateMonkeyPatch(),s.lib.installReplaceStateMonkeyPatch(),window.addEventListener("popstate",l),self._DBX_UXA_historyListenersInstalled=!0)}});
