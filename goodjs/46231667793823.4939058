!function(e){("object"!=typeof exports||"undefined"==typeof module)&&"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";function e(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})}var t=setTimeout;function o(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(e,this)}function r(n,o){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn(function(){var e,t=1===n._state?o.onFulfilled:o.onRejected;if(null!==t){try{e=t(n._value)}catch(e){return void s(o.promise,e)}a(o.promise,e)}else(1===n._state?a:s)(o.promise,n._value)})):n._deferreds.push(o)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void l(t);if("function"==typeof n)return void c((o=n,r=e,function(){o.apply(r,arguments)}),t)}t._state=1,t._value=e,l(t)}catch(e){s(t,e)}var o,r}function s(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)r(e,e._deferreds[t]);e._deferreds=null}function u(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function c(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,s(t,e))})}catch(e){if(n)return;n=!0,s(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(o);return r(this,new u(e,t,n)),n},i.prototype.finally=e,i.all=function(t){return new i(function(r,i){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var a=Array.prototype.slice.call(t);if(0===a.length)return r([]);var s=a.length;for(var e=0;e<a.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var o=e.then;if("function"==typeof o)return o.call(e,function(e){t(n,e)},i),0}a[n]=e,0==--s&&r(a)}catch(e){i(e)}}(e,a[e])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(n){return new i(function(e,t){t(n)})},i.race=function(r){return new i(function(e,t){for(var n=0,o=r.length;n<o;n++)r[n].then(e,t)})},i._immediateFn="function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){t(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();"Promise"in n?n.Promise.prototype.finally||(n.Promise.prototype.finally=e):n.Promise=i}),function(n,a){var o,d,e,r,i,t,s,l,u,c,f,m,p,v,g,h,y,_,T="MINIJQ";function E(){if(!d.dom.isReady){try{o.documentElement.doScroll("left")}catch(e){return void setTimeout(E,1)}w()}}function w(){if(!d.dom.isReady){if(!o.body)return setTimeout(w,13);if(d.dom.isReady=!0,l){for(var e=-1,t=l.length;++e<t;)l[e].call(o,d);l=null}}}function N(e,t,n){if(this.className){for(var o=" "+this.className+" ",r=-1;++r<t;)-1===o.indexOf(" "+e[r]+" ")&&(o+=e[r]+" ");this.className=o.trim()}else this.className=n}function C(e,t,n){switch(this.className){case n:this.className="";break;case"":return;default:for(var o=" "+this.className+" ",r=-1;++r<t;)o=o.replace(" "+e[r]+" "," ");this.className=o.trim()}}function S(e,t){if(""===this.style.cssText&&"string"==typeof t)this.style.cssText=t;else for(var n in e)this.style[n]!==a&&(this.style[n]=e[n])}function A(e,t,n){var o=this;t=d.event.delegate(o,e,t,n),o.attachEvent?o.attachEvent("on"+e,t):o.addEventListener&&o.addEventListener(e,t,!1)}function b(e,t){var n=this;t=d.event.getDelegate(n,e,t),n.detachEvent?n.detachEvent("on"+e,t):n.removeEventListener&&n.removeEventListener(e,t,!1)}n[T]&&"1.0"<=n[T].version||(n._$,o=n.document,d=n[T]=n._$=function(e,t){return e&&function(e){if(e&&!e[T])if(e.nodeType){if("unknown"!=typeof e.getAttribute)for(var t in d.element)a===e[t]&&(e[t]=d.element[t])}else e=d.util.extend(d.util.toArray(e),d.element);return e}(e="string"==typeof e?function(e,t,n){e=r.exec(e,t||o);if(n!==a)if(e){t=d.util.isArray(e);if(1===n&&t)return e[0];if(0===n&&!t)return[e]}else if(0===n)return[];return e}(e,t):e)},n.NTESCommonNavigator=n.NTESCommonNavigator||{},d.version="1.0",(e=o.createElement("div")).innerHTML="<p class='TEST'></p>",r={SPACE:/\s*([\s>~+,])\s*/g,ISSIMPLE:/^#?[\w\u00c0-\uFFFF_-]+_$/,IMPLIEDALL:/([>\s~\+,]|^)([#\.\[:])/g,ATTRVALUES:/=(["'])([^'"]*)\1]/g,ATTR:/\[\s*([\w\u00c0-\uFFFF_-]+)\s*(?:(\S?\=)\s*(.*?))?\s*\]/g,PSEUDOSEQ:/\(([^\(\)]*)\)_$/g,BEGINIDAPART:/^(?:\*#([\w\u00c0-\uFFFF_-]+))/,STANDARD:/^[>\s~\+:]/,STREAM:/[#\.>\s\[\]:~\+]+|[^#\.>\s\[\]:~\+]+/g,ISINT:/^\d+_$/,enableQuerySelector:e.querySelectorAll&&0<e.querySelectorAll(".TEST").length,tempAttrValues:[],tempAttrs:[],idName:T+"UniqueId",id:0,exec:function(e,t){var n,o,r,i,a,s,l,u,c,f,m=this;if(""!==(e=e.trim())){if(m.ISSIMPLE.test(e)){if(0===e.indexOf("#")&&void 0!==t.getElementById)return m.getElemById(t,e.substr(1));if(void 0!==t.getElementsByTagName)return d.util.toArray(t.getElementsByTagName(e))}if(m.enableQuerySelector&&t.nodeType)try{return d.util.toArray(t.querySelectorAll(e))}catch(e){}for(t=t.nodeType?[t]:d.util.toArray(t),r=(o=e.replace(m.SPACE,"_$1").replace(m.ATTRVALUES,m.analyzeAttrValues).replace(m.ATTR,m.analyzeAttrs).replace(m.IMPLIEDALL,"_$1*_$2").split(",")).length,i=-1,n=[];++i<r;){if(s=t,e=o[i],m.BEGINIDAPART.test(e))if(void 0!==t[0].getElementById){if(!(s=[m.getElemById(t[0],RegExp._$1)])[0])continue;e=RegExp.rightContext}else e=o[i];if(""!==e)for(u=(l=(e=!m.STANDARD.test(e)?" "+e:e).match(m.STREAM)||[]).length,a=0;a<u&&(c=l[a++],f=l[a++],0!==(s=m.operators[c]?m.operators[c](s,f):[]).length););d.util.merge(n,s)}return m.tempAttrValues.length=m.tempAttrs.length=0,1<n.length?m.unique(n):n}},analyzeAttrs:function(e,t,n,o){return"[]"+(r.tempAttrs.push([t,n,o])-1)},analyzeAttrValues:function(e,t,n){return"="+(r.tempAttrValues.push(n)-1)+"]"},generateId:function(t){var n,o=this.idName;try{n=t[o]=t[o]||new Number(++this.id)}catch(e){(n=t.getAttribute(o))||(n=new Number(++this.id),t.setAttribute(o,n))}return n.valueOf()},unique:function(e){for(var t,n,o=[],r=0,i={};t=e[r++];)1===t.nodeType&&(i[n=this.generateId(t)]||(i[n]=!0,o.push(t)));return o},attrMap:{class:"className",for:"htmlFor"},getElemById:function(e,t){var n=e.getElementById(t);if(!n||n.id===t||!e.all)return n;if(n=e.all[t]){n.nodeType&&(n=[n]);for(var o=0;o<n.length;o++)if(this.getAttribute(n[o],"id")===t)return n[o]}},getElemsByTagName:function(e,t,n,o,r){var i,a,s,l=[],u=-1,c=e.length;for("*"!==o&&(s=o.toUpperCase());++u<c;)for(i=e[u][t],a=0;i&&(!r||a<r);)1===i.nodeType&&(i.nodeName.toUpperCase()!==s&&s||l.push(i),a++),i=i[n];return l},operators:{"#":function(e,t){return r.getElemsByAttribute(e,["id","=",t])},".":function(e,t){return r.getElemsByAttribute(e,["class","~=",t])},">":function(e,t){return r.getElemsByTagName(e,"firstChild","nextSibling",t)}}},d.element={get:function(e){return this.nodeType===a?this[e]:0==e?this:a},_$:function(e){return d("number"==typeof e?this.get(e):e,this)},hasClass:function(e){return d.style.hasClass(this,e)},addClass:function(e){return d.style.addClass(this,e)},removeClass:function(e){return d.style.removeClass(this,e)},addEvent:function(e,t,n){return d.event.addEvent(this,e,t,n)},removeEvent:function(e,t){return d.event.removeEvent(this,e,t)},each:function(e){return d.dom.eachNode(this,e)},show:function(){this&&this[0]&&(this[0].style.display="block")},hide:function(){this&&this[0]&&(this[0].style.display="none")}},d.element[T]=d.element._$,n.addEvent=o.addEvent=d.element.addEvent,n.removeEvent=o.removeEvent=d.element.removeEvent,i=Array.prototype.slice,t=Object.prototype.toString,d.util={isArray:function(e){return"[object Array]"===t.call(e)},isFunction:function(e){return"[object Function]"===t.call(e)},toArray:function(t){if(d.util.isArray(t))return t;try{n=i.call(t)}catch(e){for(var n=[],o=t.length;o;)n[--o]=t[o]}return n},merge:function(e,t){for(var n=t.length,o=e.length;0<=--n;)e[o+n]=t[n];return e},extend:function(e,t){for(var n in t)e[n]=t[n];return e},each:function(e,t,n){var o=-1,r=e.length,i=r===a||d.util.isFunction(e);if(n)if(i){for(o in e)if(!1===t.apply(e[o],n))break}else for(;++o<r&&!1!==t.apply(e[o],n););else if(i){for(o in e)if(!1===t.call(e[o],o,e[o]))break}else for(;++o<r&&!1!==t.call(e[o],o,e[o]););return e}},l=[],o.addEventListener||o.attachEvent,d.dom={wrapByArray:function(e){if(e){if(e.nodeType!==a||e.setInterval)return[e];if(e.length)return d.util.toArray(e)}return[]},eachNode:function(e,t,n){return d.util.each(d.dom.wrapByArray(e),t,n),e},ready:function(e){if(!s){if("complete"===o.readyState)return w();if(o.addEventListener)o.addEventListener("DOMContentLoaded",w,!1),n.addEventListener("load",w,!1);else if(o.attachEvent){var t;o.attachEvent("onreadystatechange",w),n.attachEvent("onload",w);try{t=null==n.frameElement}catch(e){}o.documentElement.doScroll&&t&&E()}return s=!0,d.dom.isReady?e.call(o,d):l.push(e),this}}},d.ready=d.dom.ready,u=/\s*([:;])\s*/g,c=/[^:;]+?(?=:)/g,f=/[^:;]+/g,m=/[^\s]+/g,p=/-([a-z])/gi,v=e.style.styleFloat!==a?"styleFloat":"cssFloat",g=/^float_$/i,d.style={fixStyleName:function(e){return g.test(e)?v:e.replace(p,function(e,t){return t.toUpperCase()})},hasClass:function(e,t){var n=(e=d.dom.wrapByArray(e)).length;if(0<n)for(t=" "+t+" ";0<=--n;)if(0<=(" "+e[n].className+" ").indexOf(t))return!0;return!1},parse:function(e){if("string"!=typeof e)return e;var t=0<=e.indexOf(";"),n=0<=e.indexOf(":");if(t||n){var o={},r=(e=e.trim().replace(u,"_$1").replace(n?c:f,d.style.fixStyleName).match(f)).length,i=0;if(n){if(r%2!=0)throw"invalid inline style";for(;i<r;)o[e[i++]]=e[i++]}else for(;i<r;)o[e[i++]]=""}else o=e.match(m)||[];return o},addClass:function(e,t){if(e){var n=d.style.parse(t);return d.util.isArray(n)?d.dom.eachNode(e,N,[n,n.length,t]):d.dom.eachNode(e,S,[n,t]),e}},removeClass:function(e,t){var n=d.style.parse(t);return d.util.isArray(n)?d.dom.eachNode(e,C,[n,n.length,t]):d.dom.eachNode(e,S,[n,t]),e}},h=/\s*,\s*/,y=0,d.event={idName:T+"EventId",eventSpace:T+"Events",addEvent:function(e,t,n,o){for(var r=(t=t.split(h)).length;0<=--r;)d.dom.eachNode(e,A,[t[r],n,o]);return e},removeEvent:function(e,t,n){for(var o=(t=t.split(h)).length;0<=--o;)d.dom.eachNode(e,b,[t[o],n]);return e},delegate:function(n,e,o,r){var i=d.event,t=n[i.eventSpace]=n[i.eventSpace]||{},a=o[i.idName]=o[i.idName]||++y;t[e]=t[e]||{};var s=t[e][a];return s||(s=function(e){e=i.fix(e);var t=o.call(n,e,r);return!1===t&&e.preventDefault(),t},t[e][a]=s),s},getDelegate:function(e,t,n){var o=d.event;try{return e[o.eventSpace][t][n[o.idName]]}catch(e){}return n},fix:function(e){var t,n;return e.target||(e.target=e.srcElement||o),3==e.target.nodeType&&(e.target=e.target.parentNode),null==e.timeStamp&&(e.timeStamp=Date.now()),e.preventDefault=e.preventDefault||function(){this.returnValue=!1},e.stopPropagation=e.stopPropagation||function(){this.cancelBubble=!0},a===e.pageX&&a!==e.clientX&&(t=o.documentElement,n=o.body,e.pageX=e.clientX+(t.scrollLeft||n.scrollLeft||0)-(t.clientLeft||0),e.pageY=e.clientY+(t.scrollTop||n.scrollTop||0)-(t.clientTop||0)),!e.which&&(e.charCode||0===e.charCode?e.charCode:e.keyCode)&&(e.which=e.charCode||e.keyCode),e.which||e.button===a||(e.which=1&e.button?1:2&e.button?3:4&e.button?2:0),e}},_=/^\s+|\s+$/g,String.prototype.trim||(String.prototype.trim=function(){return this.replace(_,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n=this.length;for((t=(t=Number(t)||0)<0?Math.ceil(t):Math.floor(t))<0&&(t+=n);t<n;t++)if(this[t]===e)return t;return-1}))}(window),NTESCommonNavigator.loginConfig={PATH:{WB_PATH:"http://t.163.com/service/newMessage/",DEFAULT_MAIL_PATH:"http://email.163.com#from=163nav_icon",LOG_IN_OUT_URL:"https://reg.163.com/Logout.jsp"},DOMAIN_API:{"126.com":"mail.126.com","yeah.net":"mail.yeah.net","163.com":"mail.163.com","188.com":"mail.188.com","vip.163.com":"vip.163.com","vip.126.com":"vip.126.com"},PRODUCTS:{reg:{name:"网易帐号中心",url:"http://reg.163.com/Main.jsp?username=pInfo"},"163.com":{name:"我的邮箱",url:"https://mail.163.com/entry/cgi/ntesdoor?t=1&verifycookie=1&lightweight=1&df=163navi"},"126.com":{name:"我的邮箱",url:"https://mail.126.com/entry/cgi/ntesdoor?t=1&verifycookie=1&lightweight=1&style=-1&df=163navi"},"vip.126.com":{name:"我的邮箱",url:"http://reg.vip.126.com/enterMail.m"},"yeah.net":{name:"我的邮箱",url:"https://mail.yeah.net/entry/cgi/ntesdoor?t=1&verifycookie=1&lightweight=1&style=-1&def=163navi"},"188.com":{name:"我的邮箱",url:"http://reg.mail.188.com/servlet/enter"},"vip.163.com":{name:"我的邮箱",url:"http://reg.vip.163.com/enterMail.m?enterVip=true-----------"},lofter:{name:"我的LOFTER",url:"http://www.lofter.com/?act=qb163rk_20141031_02"},yuehui:{name:"我的同城约会",url:"http://yuehui.163.com/"},ht:{name:"我的花田",url:"http://love.163.com?keyfrom=163site.mynavi"},note:{name:"我的云笔记",url:"http://note.youdao.com/web?entry=163.com"},easyread:{name:"网易云阅读",url:"http://yuedu.163.com/#f=topnav"},yunketang:{name:"云课堂",url:"http://study.163.com/?utm_source=163.com&utm_medium=web_ursproduct&utm_campaign=business"}},DEFAULT_PRODUCTS:["lofter","ht","yuehui","note","easyread","yunketang"],COOKIES:{huatian:"n_ht_s"}},NTESCommonNavigator.productConfig={LOFTER:{PATH:"http://www.lofter.com/entry?act=qb163sydl_20140917_01&from=163top",POPLIST:[{url:"http://www.lofter.com/entry?act=qb163sydl_20140917_03&from=163top",name:"进入LOFTER"},{url:"http://www.lofter.com/entry?act=qb163sydl_20140917_04&from=163top&target=http://www.lofter.com/activity",name:"热门话题"},{url:"http://www.lofter.com/selections?act=qb163sydl_20140917_05",name:"专题精选"},{url:"http://www.lofter.com/entry?act=qb163sydl_20140917_06&from=163top&target=http://www.lofter.com/app",name:"下载LOFTER客户端"}]}},NTESCommonNavigator.base={each:function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)},extend:function(e){if(null==e)throw new Error("target cannot be null");for(var t,n,o=0,r=arguments.length;++o<r;)if(null!=(n=arguments[o]))for(t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e},isDate:function(e){return"[object Date]"===toString.call(e)},isObject:function(e){return"[object Object]"===toString.call(e)},noop:function(){},count:0},NTESCommonNavigator.cookie=function(){var o=NTESCommonNavigator.base;return{set:function(e,t,n){t=encodeURIComponent(e)+"="+encodeURIComponent(t);null!=n.expires&&(t+="; expires="+(o.isDate(n.expires)?n.expires:timespan.addToDate(new Date,n.expires)).toUTCString()),n.path&&(t+="; path="+n.path),n.domain&&(t+="; domain="+n.domain),!0===n.secure&&(t+="; secure"),document.cookie=t},get:function(e,t){e="; "+decodeURIComponent(e)+"=";var n="; "+document.cookie,o=n.indexOf(e);if(-1===o)return null;o+=e.length;e=n.indexOf(";",o);return-1===e&&(e=n.length),decodeURIComponent(n.substring(o,e))},remove:function(e,t){var n="__jraiser__test__cookie__";document.cookie=n+"=1",document.cookie=n+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT",get(n)&&set(e,"",t),(t=t||{}).expires=new Date(0),NTESCommonNavigator.cookie.set(e,"",t)}}}(),NTESCommonNavigator.utils=function(){var c=NTESCommonNavigator.base;return{encode:function(e){var t={"&":"&amp;","'":"&#39;",'"':"&quot;","<":"&lt;",">":"&gt;"};return e.replace(/[&"'<>]/g,function(e){return t[e]})},fixMsgNum:function(e){return 99<(e=parseInt(e))?e="99+":e<0&&(e=0),e},isElemHasShow:function(e){return"none"!==e[0].style.display},mousenterSupport:function(){return document.createElement("div"),!1},throttle:function(e,t,n,o){new Date;function r(){c=l,e.apply(a,s)}var i,a,s,l,u=0,c=0,f=null;return function(){l=+new Date,a=this,s=arguments,i=l-(o?u:c)-t,clearTimeout(f),o?n?f=setTimeout(r,t):0<=i&&r():0<=i?r():n&&(f=setTimeout(r,-i)),u=l}},jsonp:function(e,t,n){"function"==typeof t&&(n=t,t={}),t=t||{};var o,r,i="NTESCommonNavigator"+(new Date).getTime(),a=t.prefix||i,s=t.name||a+c.count++,l=t.param||"callback",i=null!=t.timeout?t.timeout:6e4,a=encodeURIComponent,t=document.getElementsByTagName("script")[0]||document.head;function u(){o.parentNode&&o.parentNode.removeChild(o),window[s]=c.noop,r&&clearTimeout(r)}return i&&(r=setTimeout(function(){u(),n&&n(new Error("Timeout"))},i)),window[s]=function(e){u(),n&&n(e)},e=(e+=(~e.indexOf("?")?"&":"?")+l+"="+a(s)).replace("?&","?"),(o=document.createElement("script")).src=e,t.parentNode.insertBefore(o,t),function(){window[s]&&u()}},ajax:function(n){(n=n||{}).type=(n.type||"GET").toUpperCase(),n.dataType=n.dataType||"json",n.async=n.async||!0,n.timeout=n.timeout||8e3;var o,r=function(e){var t,n=[];for(t in e)n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.join("&")}(n.data),i=this;(o=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).onreadystatechange=function(){var e,t;"json"===n.dataType?4==o.readyState&&(window.clearTimeout(i.timeoutFlag),200<=(e=o.status)&&e<300?n.success&&n.success(o.responseText,o.responseXML):n.fail&&n.fail(e)):4==xmlHttp.readyState&&200==xmlHttp.status&&(window.clearTimeout(i.timeoutFlag),t=document.createElement("script"),document.body.appendChild(t),t.src=n.url+"?"+r+"&callback=ajaxCallBack",window.ajaxCallBack=function(e){n.success(e),document.body.removeChild(t)})},"GET"==n.type?(o.withCredentials=!0,o.open("GET",n.url+"?"+r,n.async),o.send(null)):"POST"==n.type&&(o.withCredentials=!0,o.open("POST",n.url,n.async),"undefined"==n.contentType||null==n.contentType?(o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(r)):(o.setRequestHeader("Content-Type",n.contentType),o.send(JSON.stringify(n.data)))),this.timeoutFlag=window.setTimeout(function(){window.clearTimeout(i.timeoutFlag),n.fail("ajax timeout"),o.abort()}.bind(this),n.timeout)}}}(),NTESCommonNavigator.login=function(){var l=NTESCommonNavigator.loginConfig,u=NTESCommonNavigator.utils,c=NTESCommonNavigator.base,f=NTESCommonNavigator.cookie,m=l.PRODUCTS,d=l.PATH.DEFAULT_MAIL_PATH,p=(l.PATH.LOG_IN_OUT_URL,l.DEFAULT_PRODUCTS),v=l.DOMAIN_API,g=/ipad/i.test(navigator.userAgent),h="",y="",_=NTESCommonNavigator.loginConfig.DOMAIN_API,T={userInfo:{userLogined:!1}};return{collectLoginSuccessCallback:function(e){e&&"[object Function]"==={}.toString.call(e)&&NTESCommonNavigator.login.CALLBACKLIST.push(e)},CALLBACKLIST:[],checkLogin:function(){return T.userInfo&&T.userInfo.userLogined},getUserInfo:function(){return T.userInfo},loginUpdate:function(s){new Promise(function(e,t){e(T.userInfo)}).then(function(e){if(e.userLogined){T.userInfo=e;for(var t=0,n=NTESCommonNavigator.login.CALLBACKLIST.length;t<n;t++){var o=NTESCommonNavigator.login.CALLBACKLIST[t];o&&"[object Function]"==={}.toString.call(o)&&o(e)}(function(e){for(var t,n=T.userInfo,o=[],r=0,i=(o.length>p.length?p:o).length,a=["reg"];r<i;r++)m[t=o[r]]&&a.push(t);1===a.length&&(a=a.concat(p)),v[n.userDomain]&&a.splice(1,0,n.userDomain);var s=[];c.each(a,function(e,t){e=c.extend({},m[e]);e.url=e.url.replace(/pInfo/g,u.encode(n.userMail)),s.push(e)});var l="",i=s.length;c.each(s,function(e,t){l+='<li class="'+(t===i-1?"last":"")+'">      <a href="'+e.url+'" target="_blank">        <span>'+e.name+"</span>      </a>    </li>"}),document.getElementById("js_logined_suggest").innerHTML=l,e&&(g||(_$("#js_login_suggest_wrap").show(),setTimeout(function(){_$("#js_login_suggest_wrap")[0].style.display=""},4e3)))})(s),function(e){_$("#js_N_navLoginBefore").hide(),_$("#js_N_navLoginAfter").show(),_$("#js_N_navUsername")[0].innerText=e.userMail;e=l.PATH.LOG_IN_OUT_URL+"?username="+(e.userName||e.userMail.split("@")[0])+"&url="+u.encode(location.href);document.getElementById("js_N_navLogout").setAttribute("href",e)}(e);var r=e.userMail;i=e.userDomain,e.userName,a={newCount:0,totalCount:0,userName:""},r&&(y=r),_[h=i?i:h],new Promise(function(e,t){var n=_[h];e(n?{mailInfo:a,mailPath:"//msg."+n+"/cgi/mc?funcid=getusrnewmsgcnt&product=index163&template=newmsgres_setcookie.htm&username="+y}:{mailInfo:a})}).then(function(e){!function(e){e=e.mailPath;e&&u.jsonp(e,{},function(e){var t=u.fixMsgNum(e),e=document.getElementById("js_N_navMailMsg");t?(e.style.display="block",document.getElementById("js_N_navMailMsgNum").innerHTML=t):e.style.display="none";e=T.userInfo.userDomain,e=(e=m[e]?m[e].url:d).replace(/&df=163navi/i,"&df=163nav_icon");document.getElementById("js_mail_url").setAttribute("href",e)})}(e)})}var i,a})},loginSuccessCallback:function(r){var e,t,n,o,i,a,s=this,l=r?!0:!1;"Microsoft Internet Explorer"==navigator.appName&&parseInt(navigator.appVersion.split(";")[1].replace(/[ ]/g,"").replace("MSIE",""))<10?(e=f.get("P_INFO"),t=f.get("S_INFO"),n=f.get("NTES_PASSPORT"),i=[],o="",i={userName:(o=(i=e?e.split("|"):i).length?i[0]||"":o).split("@")[0],userMail:o,userDomain:o?o.split("@")[1]:"",userIp:f.get("USERTRACK")||"",userLogined:!(!o||!t&&!n),userProduct:i[7]||""},T.userInfo=i,s.loginUpdate(r)):(a=function(e){for(var t="",n=e,o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],r=0;r<n;r++)t+=o[Math.round(Math.random()*(o.length-1))];return t+(new Date).getTime()}(11),u.ajax({url:"https://gw.m.163.com/commons-user-main/api/v1/commons/user/pc/getUserByCookie",type:"GET",async:!0,timeout:3e3,data:{isbtn:l,trace_id:a},success:function(e,t){var n,o=JSON.parse(e);0==o.code&&1==o.data.userLogined?(e=o.data,T.userInfo={userName:e.userName,userMail:e.userMail,userDomain:e.userDomain,userLogined:!0},s.loginUpdate(r)):0!=o.code&&(console.log(o.message),null!=window.NTESAntAnalysis)&&(n={val_nm:"urs_error",val_act:"ursinfo_error",projectid:"NTM-LEST41Y4-58",info:{modelid:a}},window.NTESAntAnalysis.sendData(n)),1==r&&0==o.data.userLogined&&(console.log("登录按钮成功，但是返回结果未登录",o.message),null!=window.NTESAntAnalysis)&&(n={val_nm:"login_error",val_act:"ursinfo_error",projectid:"NTM-LEST41Y4-58",info:{modelid:a}},window.NTESAntAnalysis.sendData(n))},fail:function(e){console.log("requestUserInfo请求失败，状态码为："+e),null!=window.NTESAntAnalysis&&window.NTESAntAnalysis.sendData({val_nm:"userapi_fail",val_act:"ursinfo_error",projectid:"NTM-LEST41Y4-58",info:{modelid:a,userapi_errordetail:e}})}}))}}}(),NTESCommonNavigator.URS=function(t){var n=NTESCommonNavigator.login;return{loadURS:function(e){new t.URS({autoSuffix:1,needUrsBgp:1,skin:0,product:"163",promark:"MODXOXd",productKey:"5092c4b74f2a3fbfe2216e18ebe7ff8d",swidth:"190",hintTxt:"按住滑块 拖动完成拼图",version:3,newCDN:1,mode:"embed",host:"www.163.com",includeBox:e||"js_N_login_wrap",isHttps:1,page:"login",placeholder:{account:"网易邮箱/常用邮箱",pwd:"请输入密码"},needUnLogin:1,defaultUnLogin:0,needPrepare:1,toolName:"自定义扫码App",toolUrl:"https://mail.163.com/dashi/?from=urs",notFastReg:0,single:1,cssDomain:"https://temp.163.com/special/00804C4H/",cssFiles:"urs_style_2019.css?t=20190527",frameSize:{width:260,height:214},logincb:function(e){n.loginSuccessCallback(!0)},regcb:function(){}})}}}(window),function(t,n){var e,o,r,i,a,s,l,u,c,f,m,d,p=NTESCommonNavigator.utils,v=NTESCommonNavigator.URS,g=!1,h=!1,y=null,_=!1,T=!1,E="",w="ntes-nav-select-unfold",N=/ipad/i.test(navigator.userAgent.toLowerCase());function C(){y&&(clearTimeout(y),y=null)}function S(){_||(v.loadURS(),_=!0),s.show(),g=!0,i.addClass("ntes-nav-login-active").removeClass("ntes-nav-login-normal"),s.addClass("ue-animation")}function A(){s.hide(),g=!1,i.addClass("ntes-nav-login-normal").removeClass("ntes-nav-login-active"),s.removeClass("ue-animation"),E&&s.removeClass(E)}function b(){u.hasClass("ntes-nav-quick-navigation-active")&&(u.removeClass("ntes-nav-quick-navigation-active"),c.hide())}var I="ntes-nav-wrap-resize1024";function L(){var e;e=0,n.documentElement&&n.documentElement.clientHeight?(e=n.documentElement.clientWidth,n.documentElement.clientHeight):n.body&&n.body.clientHeight?(e=n.body.clientWidth,n.body.clientHeight):t.innerHeight&&(e=t.innerWidth,t.innerHeight),e<1200?r.addClass(I):r.removeClass(I)}function x(e){for(;e;){if(_$(e).hasClass("ntes-nav-select"))return e;e=e.parentNode}}function j(e){_$(e).removeClass(w),d&&_$(d).removeClass(w)}_$((e=(f=p.mousenterSupport())?"mouseenter":"mouseover",o=f?"mouseleave":"mouseout",r=_$(".ntes_nav_wrap"),i=_$("#js_N_navHighlight"),l=_$("#js_N_logined_warp"),a=_$("#js_N_nav_login_title"),s=_$("#js_N_login_wrap"),g=p.isElemHasShow(s),a.addEvent("click",function(){return(p.isElemHasShow(s)?A:S)(),!1}),a.addEvent(e,function(){C(),S()}),a.addEvent(o,function(){var e;C(),e=function(){A()},y=setTimeout(function(){e&&e()},250)}),s.addEvent(e,function(){C()}),u=_$(".ntes-nav-quick-navigation-btn"),c=_$(".ntes-quicknav-pop"),u.addEvent("click",function(){u.hasClass("ntes-nav-quick-navigation-active")?(u.removeClass("ntes-nav-quick-navigation-active").addClass("ntes-nav-quick-navigation-unactive"),h=!1,c.hide()):(u.removeClass("ntes-nav-quick-navigation-unactive").addClass("ntes-nav-quick-navigation-active"),h=!0,c.show())}),u.addClass("ntes-nav-quick-navigation-init"),L(),_$(n.body).addEvent("click",function(e){!function(e){if(g){for(var t=e.target||e.srcElement,n=s[0],o=a[0];t;){if(t==n||t==o)return;t=t.parentNode}A()}}(e),function(e){if(h){for(var t=e.target||e.srcElement,n=u[0],o=c[0];t;){if(t==n||t==o)return;t=t.parentNode}b()}}(e)}),_$(t).addEvent("scroll",p.throttle(function(e){0<n.body.scrollTop+n.documentElement.scrollTop?T||(i.addClass("ntes-nav-login-scroll"),l.addClass("ntes-nav-logined-scroll"),T=!0):T&&(i.removeClass("ntes-nav-login-scroll"),l.removeClass("ntes-nav-logined-scroll"),T=!1),g&&A(),h&&b()},300,!0,!1)),_$(t).addEvent("resize",p.throttle(L,50,!0,!1)),(f=_$(".js_N_navSelect")).addEvent(e,function(e){var t;N||(t=x((e||event).target),clearTimeout(m),m=m&&d===t?void 0:setTimeout(function(){var e;t.focus(),e=t,d&&_$(d).removeClass(w),_$(e).addClass(w),d=e,m=void 0},250))}),f.addEvent(o,function(e){var t;N||(t=x((e||event).target),clearTimeout(m),m=m&&d===t?void 0:setTimeout(function(){t.blur(),j(t),m=void 0},100))}),void f.addEvent("click",function(e){N||(e=x((e||event).target),_$(e).hasClass(w)?_$(e).removeClass(w):_$(e).addClass(w),j(e))}))),NTESCommonNavigator.event={showPop:S}}(window,document),function(){var e={platform:""};({detect:function(){if(-1<navigator.platform.indexOf("Win"))e.platform="ua-win";else if(-1<navigator.platform.indexOf("Mac"))e.platform="ua-mac";else{if(!(-1<navigator.platform.indexOf("iPad")||-1<navigator.platform.indexOf("iPhone")))return!1;e.platform="ua-ios"}},init:function(){this.detect(),e.platform&&(document.getElementsByTagName("html")[0].className+=" "+e.platform)}}).init(),NTESCommonNavigator.utils,NTESCommonNavigator.cookie;var t=NTESCommonNavigator.login;_$.ready(function(){t.loginSuccessCallback(!1)})}();
