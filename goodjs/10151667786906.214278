define(["OK/utils/dom"],function(n){"use strict";var e="toolbar_dropdown_w_hover";function t(){}return t.prototype.closeDropdown=function(){window.setTimeout(function(){this.element.classList.remove(e),document.removeEventListener("mousedown",this.boundDocumentClick,!1)}.bind(this),this.closeTimeout)},t.prototype.documentClick=function(e){var t=!1;(t=!this.element.contains(e.target)||n.parent(e.target,"u-menu_a",this.element,!0)?!0:t)&&this.closeDropdown()},t.prototype.cardClick=function(){this.element.classList.contains(e)?this.closeDropdown():(this.element.classList.add(e),document.addEventListener("mousedown",this.boundDocumentClick,!1)),this.isBubbleHidden||(this.isBubbleHidden=!0,window.navigateOnUrlFromJS(this.closeBubbleHandle))},t.prototype.mouseEnterHandler=function(){window.clearTimeout(this.timeoutHandle)},t.prototype.mouseLeaveHandler=function(){window.clearTimeout(this.timeoutHandle),this.timeoutHandle=window.setTimeout(this.boundCloseDropdown,700)},t.prototype.activate=function(e){this.element=e,this.closeTimeout=parseInt(this.element.getAttribute("data-timeout"),10),this.card=n.firstByClass(this.element,"js-toolbar-menu"),this.timeoutHandle=null,this.dropdown=n.firstByClass(this.element,"toolbar_dropdown"),this.closeBubbleHandle=this.element.getAttribute("data-hide-dropdown"),this.isBubbleHidden=!this.closeBubbleHandle,this.boundDocumentClick=this.documentClick.bind(this),this.boundCardClick=this.cardClick.bind(this),this.boundCloseDropdown=this.closeDropdown.bind(this),this.boundMouseEnter=this.mouseEnterHandler.bind(this),this.boundMouseLeave=this.mouseLeaveHandler.bind(this),this.card.addEventListener("click",this.boundCardClick,!1),this.element.addEventListener("mouseenter",this.boundMouseEnter,!1),this.element.addEventListener("mouseleave",this.boundMouseLeave,!1)},t.prototype.deactivate=function(){this.card.removeEventListener("click",this.boundCardClick),document.removeEventListener("mousedown",this.boundDocumentClick),this.element.removeEventListener("mouseenter",this.boundMouseEnter),this.element.removeEventListener("mouseleave",this.boundMouseLeave)},new t});
