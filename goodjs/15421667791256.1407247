!function(o){function i(t){t.css("cssText",(t.css("cssText")||"")+"; display:none!important;")}var d,t,n=o.jQuery;"function"==typeof n&&n.RJS_Helpers&&n.fn.RJS_Slideshow&&(d="日,月,火,水,木,金,土".split(","),t=function(t){var m=this;n.extend(m,{slideshow:null,settings:{rjs:{maxitem:[4,"Int"],pagespeed:[100,"Range","0,9999"],opacityspeed:[100,"Range","0,9999"],autoslidetime:[2,"Range","1,10000"],autoslideflag:["next","Str","^(next|prev)$"],autoslide:[0,"Int","^[0-1]$"],autoresize:[1,"Int","^[0-1]$"],verticalmode:[0,"Int","^[0-1]$"],indicator:[0,"Int","^[0-1]$"],indicatoralign:[0,"Int","^[0-1]$"]},common:{noready:[0,"Int","^[0-1]$"],url:["","Str","^https?.*$"],maxcount:[1e3,"Range","1,10000"],mincount:[3,"Range","1,10000"],ajaxtimer:[3,"Range","1,99"],pagenumber:[0,"Int","^[0-1]$"],sid:["","Str","^[a-zA-Z0-9_\\-]{3,64}$"],impvar:["","Str","^[a-zA-Z0-9_]{3,64}$"],impdisp:["","Str","^[a-zA-Z0-9_]{3,64}$"],impnodisp:["","Str","^[a-zA-Z0-9_]{3,64}$"],rataccountid:[456,"Int"],ratserviceid:[1,"Int"],ratpagetype:["","Str"],ratoptions:["url,ua","Str"],shoplogo:[1,"Int","^[0-2]$"],shoplogosize:["130x28","Str","^[1-9][0-9]{1,2}x[1-9][0-9]{1,2}"],keywordid:["","Str"],imagesize:["80x80","Str","^[1-9][0-9]{1,2}x[1-9][0-9]{1,2}"],omitname:[20,"Range","0,100"]}},eobj:{reco:{config:t.find(".smart-coupon-slideshow-config"),prevButton:t.find(".smart-coupon-slideshow-prev"),nextButton:t.find(".smart-coupon-slideshow-next"),proto:t.find(".smart-coupon-slideshow-proto"),frame:t.find(".smart-coupon-slideshow-frame"),existItem:t,itemsDisplay:t.find(".smart-coupon-slideshow-body"),altContents:t.find(".smart-coupon-slideshow-altered-contents"),loadingContents:t.find(".smart-coupon-slideshow-loading"),indicatorDisplay:t.find(".smart-coupon-slideshow-indicator-area"),endTimeDisplay:t.find(".smart-coupon-slideshow-endtime-area")},indicator:{proto:t.find(".smart-coupon-slideshow-indicator-proto")}},props:{reco:{items:[],proto:{html:"",height:0,width:0,identifiers:{itemImage:['<img src="',/#ITEMIMAGE#/g,'" alt="#ITEMNAME#">'],itemName:["",/#ITEMNAME#/g,""],itemPrice:["",/#ITEMPRICE#/g,""],itemUrl:["",/#ITEMURL#/g,""],discountAmount:["",/#DISCOUNTAMOUNT#/g,""],discountType:["",/#DISCOUNTTYPE#/g,""],discountPrice:["",/#DISCOUNTPRICE#/g,""],discountClass:["",/#DISCOUNTCLASS#/g,""],shopName:["",/#SHOPNAME#/g,""],shopUrl:["",/#SHOPURL#/g,""],shopImage:["",/#SHOPIMAGE#/g,""],shopImageClass:["",/#SHOPIMAGECLASS#/g,""],endMonth:["",/#MON#/g,""],endDate:["",/#DATE#/g,""],endWeekDay:["",/#WDAY#/g,""],endHour:["",/#HOUR#/g,""],endMinute:["",/#MIN#/g,""]}}},indicator:{proto:{html:"",width:0,height:0}}},loadSettings:function(){return i(m.eobj.reco.proto),!(m.eobj.reco.config.size()<1)&&(m.settings.rjs=n.RJS_Helpers.readAttr(m.eobj.reco.config,m.settings.rjs),m.settings.common=n.RJS_Helpers.readAttr(m.eobj.reco.config,m.settings.common),""!==m.settings.common.url&&0!==m.eobj.reco.proto.length&&(m.eobj.reco.config.remove(),!0))},initialize:function(){if(!m.loadSettings())return!1;var t;!function(t){for(var t=t.split(/; */),e=0;t.length>e;e++){var o=t[e].split("=");if("Rz"===o[0]&&""!==o[1])return 1}}(document.cookie)?m.addImpressionCode(m.settings.common.impnodisp):(t=function(){var t=m.settings.common.keywordid,e=null!=(t=n(""===t?null:"#"+t).val())?{query:t}:{};m.RAT.setCommonParams(t);var o=setTimeout(function(){o=null},1e3*m.settings.common.ajaxtimer);n.ajax({url:m.settings.common.url,cache:!1,data:e,dataType:"jsonp",scriptCharset:"utf-8",success:function(t){o&&(clearTimeout(o),m.prepareData(t))},error:function(){}})},1==m.settings.common.noready?t():n(t))},prepareData:function(t){if(!t||"ok"!==t.status||!t.items)return!1;var e=m.settings.common;if(m.RAT.setItemParams(t.items),(o=t.items.length)<e.mincount)return m.addImpressionCode(e.impnodisp),m.RAT.send(),!1;for(var o=Math.min(o,e.maxcount),i=[],n=0,r=function(){var t=this.item;i[this.i]={itemName:m.editItemName(t.item_name,e.omitname),itemPrice:m.editItemPrice(t.item_price),itemImage:m.editImageUrl(t.item_image_url,e.imagesize),itemUrl:m.editItemUrl(t.redirect_url,e.sid),discountAmount:m.editItemPrice(t.discount_amount),discountType:m.editDiscountType(t.discount_type),discountPrice:1==t.discount_type?m.editItemPrice(t.item_price-t.discount_amount):"",discountClass:1==t.discount_type?"smart-coupon-discount-yes":"smart-coupon-discount-no",shopName:m.editItemName(t.shop_name,e.omitname),shopUrl:m.editShopUrl(t.shop_mng_id),shopImage:this.width<=1?t.shop_name:m.editShopImage(this.src,t.shop_name),shopImageClass:this.width<=1?"smart-coupon-shop-text":"smart-coupon-shop-image"},++n==o&&(m.props.reco.items=i,m.props.recoItemNum=o,m.displayData(m.props,m.eobj,m.settings.rjs))},s=[],a=0;a<o;a++){var c=t.items[a];s[a]=new Image,s[a].onload=s[a].onerror=r,s[a].item=c,s[a].i=a,i[a]=null,2==e.shoplogo?(s[a].width=1,s[a].onload()):s[a].src="//thumbnail.image.rakuten.co.jp/@0_mall/"+c.shop_mng_id+"/logo/logo2"+(1==e.shoplogo?"n":"")+".jpg?_ex="+e.shoplogosize}r=m.eobj.reco.endTimeDisplay.html(),r=t.items[0]&&t.items[0].end_time&&r?(t=t.items[0].end_time.split(/\D/),s=d[new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5]).getDay()],(r=(r=(r=(r=r.replace(/#MON#/g,+t[1])).replace(/#DATE#/g,+t[2])).replace(/#HOUR#/g,+t[3])).replace(/#MIN#/g,t[4])).replace(/#WDAY#/g,s)):"",m.eobj.reco.endTimeDisplay.html(r)},displayData:function(t,e,o){if(0===e.reco.proto.length)return!1;if(t.reco.proto.width=e.reco.proto.outerWidth(),0==t.reco.proto.width&&(t.reco.proto.width=e.reco.proto.css("width").replace("px","")),t.reco.proto.height=e.reco.proto.outerHeight(),t.reco.proto.html=e.reco.proto.html(),""==t.reco.proto.html)return!1;if(i(e.reco.proto),e.reco.itemsDisplay.empty(),o.indicator){if(0===e.indicator.proto.length)return!1;if(t.indicator.proto.width=e.indicator.proto.outerWidth(),0==t.indicator.proto.width&&(t.indicator.proto.width=e.indicator.proto.css("width").replace("px","")),t.indicator.proto.height=e.indicator.proto.outerHeight(),t.indicator.proto.html=e.indicator.proto.html(),""==t.indicator.proto.html)return!1;i(e.indicator.proto),e.reco.indicatorDisplay.empty()}i(e.reco.altContents),m.eobj.reco.loadingContents.show(),m.eobj.reco.existItem.show(),e.reco.itemsDisplay.RJS_Slideshow(m,{settings:o,itemPrototype:t.reco.proto,indicatorPrototype:t.indicator.proto,eobj:e.reco,items:t.reco.items,events:{beforeFirstRender:function(t,e){e.eobj.reco.prevButton.show(),e.eobj.reco.nextButton.show()},afterFirstRender:function(t,e){e.eobj.reco.loadingContents.hide(),e.eobj.reco.existItem.show(),e.eobj.reco.itemsDisplay.show(),e.eobj.reco.frame.show()}}}),m.addImpressionCode(m.settings.common.impdisp),m.RAT.send()},addImpressionCode:function(t){return void 0===o[m.settings.common.impvar]||""==t?"":o[m.settings.common.impvar]=t},editItemName:function(t,e){return n.RJS_Helpers.omitStr(t,e,"…")},editItemPrice:function(t){return"number"==typeof t?(t+"").replace(/(\d)(?=(?:\d\d\d)+$)/g,"$1,"):""},editImageUrl:function(t,e){return t?n.RJS_Helpers.urlParameter(t,{_ex:e}):""},editItemUrl:function(t,e,o){return t=""!=e?o?n.RJS_Helpers.urlR2Parameter(t,{"s-id":e},!1):n.RJS_Helpers.urlParameter(t,{"s-id":e},!1):t},editDiscountType:function(t){return["円","%","P","倍"][t-1]||""},editShopUrl:function(t){return"http://www.rakuten.co.jp/"+t+"/"},editShopImage:function(t,e){return'<img src="'+t+'" alt="'+e+'">'},RAT:{pData:{},setCommonParams:function(t){null!=t&&(m.RAT.pData.sq=t),""!==m.settings.common.ratpagetype&&(m.RAT.pData.pgt=m.settings.common.ratpagetype)},setItemParams:function(t){for(var e=[],o=0;t.length>o;o++)e.push(t[o].shop_id+"/"+t[o].item_id);m.RAT.pData.itemid=e,t[0]&&null!=t[0].sc_clid&&(m.RAT.pData.cc=t[0].sc_clid)},send:function(){n(function(){var t=o.RAT,e=m.settings.common;t&&"function"==typeof t.addCustomEvent&&t.addCustomEvent({accountId:e.rataccountid,serviceId:e.ratserviceid,options:e.ratoptions.split(","),pData:m.RAT.pData})})}}})},n("#smart-coupon").find("div.smart-coupon-slideshow-display").each(function(){new t(n(this)).initialize()}))}(this);
